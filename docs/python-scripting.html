<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html>
<head>
   <title></title>
   <title>SPIDER: Using Python for Scripting</title>
   <link rel='stylesheet' type='text/css' href='./buttons.css' />

</head>

<body>
<!-- Begin Buttons -->
<table>
<tr>
  <td><a href="./spider.html"                 id="spider">    </a></td>
  <td><a href="./user_doc.html"               id="work">      </a></td>
  <td><a href="./operations_doc.html"         id="index">     </a></td>
  <td><a href="./documents.html"              id="help">      </a></td>
  <td><a href="./faq.html"                    id="faq">       </a></td>
  <td><a href="./documents.html#2D"           id="techs">     </a></td>
  <td><a href="./techs/recon1a/Docs/mr1.html" id="recon">     </a></td>
  <td><a href="./formats.html"                id="menu">      </a></td>
  <td><a href="./installation.html"           id="install">   </a></td>
  <td><a href="./release.html"                id="new">       </a></td>
  <td><a href="https://spider-em.github.io/Web" id="web"> </a></td> 
</tr>
</table>
<br><hr>
<!-- End Buttons -->


<h1 align="center">Using Python for SPIDER Scripting</h1>

<p>
   <a href="www.python.org"><i>Python</i></a> programs can be used to control 
    a SPIDER session. The module <a href="../proc/spyder.py">spyder.py</a> 
    provides an interface to the SPIDER operations for external scripting   
    (described on the <a href="scripting.html">Perl scripting</a> page). </p>

<p> Your program, or script, must import the spyder module. Then start a SPIDER 
   session by creating a session object, called, conveniently, a SpiderSession, 
   using the dot notation. You can give it any name (here it is called "spy"). 
   You need to give it two bits of information: the full path to the SPIDER 
   executable, and the data extension. </p>

<p>
<pre>
 import spyder

 spy = spyder.SpiderSession(spiderexec="/usr/local/bin/spider", dataext="dat")
</pre>
</p>

<p> There are 2 access functions, <br />

<code>toSpider</code> sends text to the SPIDER session as if it were typed 
      at SPIDER's .OPERATION: prompt. <br />

<code>getreg</code> gets the value of a register that was previously set. 
</p>

<p><a href="../proc/b01.py">b01.py</a> : a demonstration python script   <br /><br />
   <a href="../proc/spyder.py">spyder.py</a> : module with the SpiderSession object 
   for interfacing Python to SPIDER. This has to be in the same directory as your script.</p>

<hr>

<p></p>

<h3>Functions of the SpiderSession object in spyder.py</h3>

<p><i>string</i> refers to any text (strings of characters). In
   Python, these are always enclosed in quotes. They can be replaced
   by string variables - see Python documentation.</p>

<p>
<dl>
<dt><b>SpiderSession</b> (<i>spiderexec, dataext</i>)</dt>

<dd> <i>spiderexec</i> is the full path to the executable SPIDER program. 
    The Unix command <code>"which spider"</code> may be helpful. If this argument is left blank, 
    the SpiderSession checks if the SPIDER_LOC environmental variable is set. </dd>
<dd> <i>dataext</i> is the 3-letter SPIDER data extension. </dd>

<pre>
 spy = SpiderSession(spiderexec="/usr/local/bin/spider", dataext="gt2")
</pre>
   This requires that the spyder.py module has already been imported, e.g.,
<pre>
from spyder import SpiderSession
</pre>
</p>

<p>
<dt><b>toSpider</b> (<i>string, string, ...</i>)</dt>

<dd>Input consists of a variable number of text strings,
    representing any SPIDER operation and its arguments. SPIDER operations 
    and their arguments may be put on separate lines:
<pre>
 spy.toSpider("MO")
 spy.toSpider("tmp001")
 spy.toSpider("64,64")
 spy.toSpider("T")
</pre>
   or in a single call, separated by commas:
<pre>
 spy.toSpider("MO", "tmp001", "64,64", "T")
</pre>
</dd>

</p>

<p>
<dt><b>getreg</b> (<i>varname</i>)</dt>

<dd>Gets the value of the specified register that was set in an earlier operation, e.g.,
<pre>
 spy.toSpider("[i] = 23.7")    # sets the variable [i]

 x = spy.getreg("i")    # Gets the floating point number from SPIDER
</pre>

 <i>varname</i> may be with or without the enclosing square brackets.
</dd>
</p>

<p>
<dt><b>close</b> ()</dt>

<dd>No input. Ends the SPIDER session and deletes the fifo pipe created by SpiderSession.</dd>

<dd>
</p>
</dl>

<hr>

<p>
<b>Python dot notation</b>  <br />
   <code><b>something.x</b></code> means <code>'x'</code> belongs to <code>'something'</code>.</p>

<p><b>Making your Python program executable</b>       <br />
   Put the following as the first line of the script: <br />
   <code><b>#!/usr/bin/env python</b></code>          <br />
   Save your file, then make it executable with the Unix 
   <code>chmod</code> command:                        <br />
   <code><b>[Unix prompt] chmod 775 yourscript.py</b></code> <br />
</p>

<hr>

<p><small>Source: scripting2.html &nbsp;&nbsp;&nbsp; 
          Last update: 28 September 2007 &nbsp;&nbsp;&nbsp; 
          Bill Baxter</small></p>

</body>
</html>

</html>