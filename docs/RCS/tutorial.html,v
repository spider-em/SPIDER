head	1.19;
access;
symbols;
locks;
comment	@# @;


1.19
date	2012.01.06.17.39.49;	author leith;	state Exp;
branches;
next	1.18;

1.18
date	2006.09.13.13.14.04;	author leith;	state Exp;
branches;
next	1.17;

1.17
date	2005.12.12.19.53.02;	author leith;	state Exp;
branches;
next	1.16;

1.16
date	2005.05.23.15.07.30;	author bimal;	state Exp;
branches;
next	1.15;

1.15
date	2004.07.29.14.07.55;	author leith;	state Exp;
branches;
next	1.14;

1.14
date	2004.07.29.14.07.47;	author leith;	state Exp;
branches;
next	1.13;

1.13
date	2002.06.28.18.14.30;	author leith;	state Exp;
branches;
next	1.12;

1.12
date	2002.01.30.16.13.08;	author leith;	state Exp;
branches;
next	1.11;

1.11
date	2000.09.05.17.58.06;	author leith;	state Exp;
branches;
next	1.10;

1.10
date	2000.08.31.13.21.47;	author leith;	state Exp;
branches;
next	1.9;

1.9
date	99.11.04.17.27.22;	author leith;	state Exp;
branches;
next	1.8;

1.8
date	99.09.22.18.22.59;	author leith;	state Exp;
branches;
next	1.7;

1.7
date	98.10.21.15.59.17;	author leith;	state Exp;
branches;
next	1.6;

1.6
date	98.04.10.20.11.11;	author pawel;	state Exp;
branches;
next	1.5;

1.5
date	98.03.06.14.53.38;	author leith;	state Exp;
branches;
next	1.4;

1.4
date	98.03.02.13.32.41;	author leith;	state Exp;
branches;
next	1.3;

1.3
date	98.02.23.13.33.06;	author leith;	state Exp;
branches;
next	1.2;

1.2
date	98.02.09.13.47.00;	author leith;	state Exp;
branches;
next	1.1;

1.1
date	97.12.22.20.57.37;	author leith;	state Exp;
branches;
next	;


desc
@@


1.19
log
@nx
@
text
@<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html>
<head>
   <title>Tutorial: SPIDER Image Manipulation</title>
</head>

<body background="bgpink.gif" vlink="#ff000">

<h2 align="center"><a name="user_guider">Tutorial: SPIDER Image Manipulation</a></h2>

<br>

<hr>

<center>by Louis M. Miranda, Yiwei Chen</center>
<center>and</center>
<center>Joachim Frank</center>
<center>Laboratory of Computational Biology and Molecular Imaging</center>
<center>Wadsworth Center</center>
<center>New York State Department of Health</center>

<br>
<hr>
<dl>
<dd>
<p></p>
</dd>

<dt><b><a href="#introduction">INTRODUCTION</a></b></dt>

<dt><b><a href="#start1">1. STARTING A SPIDER SESSION</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#start1.1">1.1 Starting SPIDER</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#start1.2">1.2 Looking at
Images with WEB</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#start1.3">1.3
Two-dimensional (2D) and three-dimensional (3D) images in
SPIDER</a></b></dt>

<dt><b><a href="#processing2">2. PROCESSING PREVIOUSLY CREATED
IMAGES</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#processing2.1">2.1 The
Masking Operation</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#processing2.2">2.2 The
Interpolation Operation</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#processing2.3">2.3 The
Rotate Operation</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#processing2.4">2.4 The Shift
Operation</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#processing2.5">2.5 The RT SQ
Operation</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#processing2.6">2.6 The
Windowing Operation</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#processing2.7">2.7 The
Padding Operation</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#processing2.8">2.8 The
Mirroring Operation</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#processing2.9">2.9 The
Box-Convolution Operation</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#processing2.10">2.10 The
Contrast Enhancement Operation</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#processing2.11">2.11 The
Edge Detection Operation</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#processing2.12">2.12 The
Average + Variance Operation</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#processing2.13">2.13 The
File Contour Operation</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#processing2.14">2.14 The
Subtract-Images Operation</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#processing2.15">2.15 The
Multiply-Images Operation</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#processing2.16">2.16 The
Square-Image Operation</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#processing2.17">2.17 The
Cross-Correlation Operation</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#processing2.18">2.18 The
Autocorrelation Operation</a></b></dt>

<dt><b><a href="#fourier3">3. THE FOURIER TRANSFORM</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#fourier3.1">3.1 The Montage
Operation With Scaling Option</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#fourier3.2">3.2 The Fourier
Transform Operation</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#fourier3.3">3.3 The Power
Spectrum Operation</a></b></dt>

<dt><b><a href="#creating4">4. CREATING AND EDITING
IMAGES</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#creating4.1">4.1 The
Modelling Operation</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#creating4.2">4.2 The
Create-Blank Operation</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#creating4.3">4.3 The Insert
Operation</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#creating4.4">4.4 The Patch
Operation</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#creating4.5">4.5 The
Threshold Operation</a></b></dt>

<dt><b><a href="#processing5">5. PROCESSING OF 3D DATA</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#processing5.1">5.1
MA</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#processing5.2">5.2
IP</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#processing5.3">5.3 RT
3D</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#processing5.4">5.4
SH</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#processing5.5">5.5
WI</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#processing5.6">5.6
PD</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#processing5.7">5.7
MR</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#processing5.8">5.8
BC</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#processing5.9">5.9
CE</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#processing5.10">5.10
ED</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#processing5.11">5.11 AS
R</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#processing5.12">5.12
FC</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#processing5.13">5.13
SU</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#processing5.14">5.14
MU</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#processing5.15">5.15
SQ</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#processing5.16">5.16 CC
N</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#processing5.17">5.17
AL</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#processing5.18">5.18 MN
S</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#processing5.19">5.19
FT</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#processing5.20">5.20
PW</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#processing5.21">5.21 MO
3</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#processing5.22">5.22
BL</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#processing5.23">5.23
IN</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#processing5.24">5.24
PA</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#processing5.25">5.25
TH</a></b></dt>

<dt><b><a href="#procedure6">6. PROCEDURE MODE OF
PROCESSING</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#procedure6.1">6.1 Procedure
versus Interactive Sessions</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#procedure6.2">6.2 How to
Create a Procedure File</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#procedure6.3">6.3 Preparing
and Running a Simple Procedure File</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#procedure6.4">6.4 Use of
Temporary In-core Files</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#procedure6.5">6.5 DO-LOOPS
and Run-time Designation of File Names</a></b></dt>

<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#procedure6.6">6.6 Variables,
Arithmetic Expressions, and Computed Goto Statements</a></b></dt>

<dt><b><a href="#appendix">APPENDIX</a></b></dt>

<dd>
<hr>
</dd>

<dt><br>
</dt>
</dl>

<center><a name="introduction">INTRODUCTION</a></center>

<dl>
<dd><br>
<p>Welcome to the SPIDER Tutorial. The following pages will take
you on a brief self-guided tour of the image-manipulating abilities
of the SPIDER image processing software program. Each operation is
documented here with both a step-by-step procedure and the images
produced by it. By creating the image that is documented in the <a
href="#appendix">Appendix</a>, you can start right away--no other
images are necessary for most operations documented here.</p>

For more information on the specific options and choices of
parameters within each operation, use the 
<a href= "operations_doc.html">"Manual of Spider Operations"</a>.<br>
 
<hr>

<p>1. <a name="start1">STARTING A SPIDER SESSION</a></p>

<p>1.1 <a name="start1.1">Starting SPIDER</a></p>

<p>SPIDER is a command-driven program. To start a session, open a
window and type "spider". A Welcome notice appears which defines
the exact version and release of the program you are running. Next,
you will see the query</p>

.PROJECT/DATA CODE: SEC/80S 

<p><i>[Please note that the query by the computer is always
preceded by a period, so that it's easily distinguished from other
messages. The interpretation of the user response, in this case
"SEC/80S" is usually case sensitive.]</i></p>

<p>The codes are used to define the files that will be accessible
by the program in this session. The DATA CODE is a three-letter
sequence that will be the assumed default extension of image files
(or document files, i.e., files containing lists of important
numbers to be "transported" from one operation to another). These
may either be input files, or newly created output files. For
example, an existing file named RAW004.80S can be referred to in
above session as "RAW004". If the user types "WIN004" in response
to the question "OUTPUT FILE:", then a file named "WIN004.80S" will
be created.</p>

<p>[You can skip the following explanation of the project code in
the initial training session. It will have no importance until you
come to Section 6. For the time being, just enter the data code
only -- the project code will be the same by default.]</p>

<p>Similarly, the PROJECT CODE is a three-letter sequence that will
be used as default extension of files that define an entire batch
of operations: these are called "procedure files". In the above
example, "SEC" might be a mnemonic referring to a project that
seeks to reconstruct the 80S ribosome-Sec61 complex.  If operations to
perform two-dimensional alignment are stored in a file named
"ALIGN.SEC", then simply typing "@@ALIGN" will refer to the desired
file, and will be understood as a request to execute operations
stored there.</p>

<p><i>[Note that there is a way to switch to another choice of
"DATA CODE" and "PROJECT CODE": at any ".OPERATION:" prompt, just
type "NC" (for "New Codes"), and the program will come back to the
initial prompt ".ENTER PROJECT/DATA CODE:".]</i></p>

<p>After the DATA CODE (and the PROJECT CODE) have been entered,
the system comes back with the standard prompt ".OPERATION:". Here
it expects one of the operations listed in the SPIDER manual defining
image processing operations.</p>

1.2 <a name="start1.2">Looking at the Image with WEB</a><br>
<br>
 

<p>In the course of the session, you need to look at the resulting
images. For this purpose, you open another window on your terminal.
Position and size the SPIDER window and the WEB window in such a
way that you can see them both without obstruction. Now start WEB
for the particular image data you want to view by typing "web 80s
&amp;", i.e., "web" followed by the DATA CODE defined at the
beginning of the SPIDER session. This operation starts the WEB
graphics user interface, that will allow you to display images
using self-explanatory point-and-click operations. However, a help
function is also available to explain the more complex interactive
operations of <a href="../../web/docs/web.html">WEB</a> in
detail.</p>

<center><img width="75" height="75" src="./img/sam001.gif"> <img
width="75" height="75" src="./img/sam002.gif"></center>

<center><tt>SAM001 &nbsp; SAM002</tt></center>

<br>
 FIGURE 1. The original images (dimensions 75X75) to be
manipulated. SAM001 (left) was created from the example procedure
in the Appendix. SAM002 (right) is an image of the 70S ribosome
from <i>E. coli</i> obtained by cryo-electron microscopy. You may
substitute it by your own image.<br>
<p>1.3 <a name="start1.3">Two-dimensional (2D) and
three-dimensional (3D) images in SPIDER</a></p>

<p>SPIDER can operate on both 2D and 3D images. The file formats
permits creation of one-dimensional (1D) images as well, but there
are very few operations that operate on 1D data, thus they will not
be discussed in this tutorial. A 2D image is defined by its x,y
dimensions. x, the width of the image, is stored as the number of
sampling points and is always refered to as NX. y, the height of
the image, is stored as the number of horizontal rows and is
refered to as NY. A 3D image can be thought of as a stack of 2D
images (or slices), and the 2 dimension is stored as the number of
slices and refered to as NZ.</p>

<p>Section 2, 3 and 4 of this tutorial are devoted to processing of
2D imagaes. In section 5 all operations introduced so far are
reviewed for suitability in three dimensions and if a given operation
has a different meaning or a different version for 3D data, it is
decribed in more details.</p>

<p><a href="#user_guider">(Back to the front page)</a></p>

<p>2. <a name="processing2">PROCESSING PREVIOUSLY CREATED
IMAGES</a><br>
<br>
 2.1 <a name="processing2.1" href=
"man/ma.html">'MA'</a> --The Masking
Operation<br>
<br>
</p>

<p>Masking allows superfluous information in the image, normally at
the periphery, to be deleted. 'MA' applies a circular mask, but
there is also an option that allows an arbitrary shape to be used
as mask.</p>

<p>2.1.1 External masking</p>

<pre>
                 EXAMPLE:  Masking an Image

    .OPERATION: MA                ;Use the MA operation
    .INPUT  FILE: SAM002          ;Image to be masked
    .OUTPUT FILE: MAS002          ;Name of masked image
    .OUTER &amp;INNER RADII: 25,0     ;Radii, in pixels, 
                                  ;beyond which image 
                                  ;will be masked
    .(D)ISK,(G)AUSSIAN OR 
     (T)RUE GAUSSIAN: G           ;Type of mask used
    .(A)V, (P)REC AV, (C)IRCUMF,
     OR (E)XTERNAL: P         ;Type of background
    .MASK CENTER COOS: 38,38      ;Coordinates of the
                                  ;mask center
    .HALFWIDTH: 5                 ;Halfwidth for Gaussian
                                  ;mask only
</pre>

<p>The preceding procedure will create the masked image seen in
figure 2a. Note the soft transition created by the Gaussian
falloff.</p>

<center><img width="75" height="75" src=
"./img/mas002.gif"></center>

<center>MAS002</center>

<br>
 

<center>FIGURE 2a. Result of external masking operation.</center>

<br>
 

<p>2.1.2 Internal masking</p>

<pre>
                 EXAMPLE:  Masking an Image

    .OPERATION: MA                ;Use the MA operation
    .INPUT  FILE: SAM002          ;Image to be masked
    .OUTPUT FILE: MIN002          ;Name of masked image
    .OUTER &amp;INNER RADII: 0,25     ;Radii, in pixels, 
                                  ;beyond which image 
                                  ;will be masked
    .(D)ISK,(G)AUSSIAN OR 
     (T)RUE GAUSSIAN: G           ;Type of mask used
    .(A)V, (P)REC AV, (C)IRCUMF,
     OR (E)XTERNAL: P         ;Type of background
    .MASK CENTER COOS: 38,38      ;Coordinates of the
                                  ;mask center
    .HALFWIDTH: 5                 ;Halfwidth for Gaussian
                                  ;mask only
</pre>

<center><img width="75" height="75" src=
"./img/min002.gif"></center>

<center>MIN002</center>

<br>
 

<center>FIGURE 2b. Result of internal masking operation.</center>

<br>
 

<p>2.2 <a name="processing2.2" href=
"man/ip.html">'IP'</a>--The Interpolation
Operation<br>
<br>
</p>

<p>An image can be enlarged or reduced for clarity of display by
interpolating it onto a grid with different dimensions. For this
Guide, the two sample images were enlarged so that the processing
performed on them would be seen more clearly. 'IP' is especially
useful for enlarged display of images that result from
averaging.</p>

<pre>
   
            EXAMPLE:  Interpolating an Image

    .OPERATION: IP                  ;Use the IP operation
    .INPUT FILE1: SAM001            ;Image to be enlarged
                                    ;or reduced
    .OUTPUT FILE: INT001            ;Name of new image
    .ENTER DIMS NX,NY: 128,128  ;Size of output image

</pre>

[Here, DIMS refers to the dimensions of the image which are
expressed as NX, NY. This corresponds to the size of the image
in pixels: NX = the number of sampling points, or vertical
columns (i.e., the width of the image); NY = the number of
horizontal rows (i.e., the height of the image). For example, an
image of dimensions NX = 40, NY = 50 corresponds to a rectangle
with a width of 40 and a height of 50.]<br>
<br>
<center><img width="128" height="128" src="./img/int001.gif"> <img
width="128" height="128" src="./img/int002.gif"></center>

<center><tt>INT001 &nbsp; &nbsp; &nbsp; &nbsp; INT002</tt></center>

<br>
 FIGURE 3. The original 75X75 pixel images shown in Fig. 1 have
been enlarged. When the images are enlarged by a non-integer ratio,
as in this example, partial loss of information will occur. When
the image size is reduced, some information will be always lost.
For an integer enlargement of images, operation <a href=
"man/fp.html">'FP'</a> is recommended.
INT002 was computed from SAM002, the same way as INT001 was from
SAM001.<br>
<br>
 2.3 <a name="processing2.3" href=
"man/rt.html">'RT'</a>--The Rotate
Operation<br>
<br>
<p>This operation allows the image to be rotated within the frame.
By default, rotation is with respect to a center at (NX/2 + 1,
NY/2 + 1). Rotation angles can be positive or negative: the
positive direction is considered counterclockwise, by convention;
the negative direction is clockwise.</p>

<p>During the course of an alignment procedure, the 'RT' operation
will utilize the rotation angles obtained by orientation search to
rotate the particles into alignment with the reference.</p>

<pre>
                 EXAMPLE:  Rotating an Image

    .OPERATION: RT                ;Use the RT operation
    .INPUT  FILE: INT001          ;Image to be rotated
    .OUTPUT FILE: ROT001          ;Name of new image
    .ROTATION ANGLE: 130          ;Angle of rotation in
                                  ;degrees (+/-)

</pre>

<center><img width="128" height="128" src="./img/rot001.gif"> <img
width="128" height="128" src="./img/rot002.gif"></center>

<center><tt>ROT001 &nbsp; &nbsp; &nbsp; &nbsp; ROT002</tt></center>

<br>
 FIGURE 4. Rotated images. Note that a "new" background is
automatically created to replace the voids in the four corners
created by rotating the image. That background will have a value
equal to the mean of all pixels of the unrotated image. However,
note that there is also an option that allows you to specify the
background value (by <a href= "man/rtb.html">'RT B'</a>).<br>
<br>
 2.4 <a name="processing2.4" href="man/sh.html">'SH'</a>--The Shift Operation<br>
<br>
<p>The image is shifted with respect to the frame of reference. The
amount and direction of shift is specified by the x and y
components of the shift vector. Shift vector components can be
either positive or negative. According to the coordinate system
convention, the origin is at the upper left, so positive
x-direction is to the right, positive y-direction is down.</p>

<pre>
                                                    
             EXAMPLE:  Shifting an Image

    .OPERATION: SH                ;Use the SH operation
    .INPUT  FILE: ROT001          ;Image to be shifted
    .OUTPUT FILE: SHF001          ;Name of new image
    .SHIFT COMPONENTS: -15,-10    ;X- and Y- components of the
                                  ;shift vector, (+/-)
</pre>

<i>NOTE: <a href="man/shf.html">'SH F'</a> option allows non-integer shift vectors to be
applied.</i><br>
<br>
 

<center><img width="128" height="128" src="./img/shf001.gif"> <img width="128" height="128" src="./img/shf002.gif"></center>

<center><tt>SHF001 &nbsp; &nbsp; &nbsp; &nbsp; SHF002</tt></center>

<br>
 FIGURE 5a. Shifted Images. Notice that shifted image data "wrap
around" to the opposite sides of the image.<br>
<br>
 

<p>2.5 <a name="processing2.5" href="man/rtsq.html">'RT SQ'</a>-- Rotate -
image or volume, Shift, use Quadratic interpolation<br>
<br>
</p>

<p>Changes the scale, rotates and shifts image circularly. Rotates
a picture counter-clockwise around the center (NX/2 + 1, NY/2 +
1). (Negative angles = clockwise).</p>

<pre>
            EXAMPLE:  Rotating and Shifting an Image

    .OPERATION: RT SQ             ;Use the RT SQ operation
    .INPUT  FILE: INT001          ;Image to be rotated
    .OUTPUT FILE: RTS001          ;Name of new image
    .ROTATION ANGLE, SCALE: 130   ;Angle of rotation in
                                  ;degrees (+/-)
    .SHIFTS IN X AND Y:-15,-10    ;the X and Y shift values
</pre>

<center><img width="128" height="128" src=
"./img/rst001.gif"><tt>&nbsp;</tt> <img width="128" height="128"
src="./img/rst002.gif"></center>

<center><tt>RST001 &nbsp; &nbsp; &nbsp; &nbsp; RST002</tt></center>

<br>
 FIGURE 5b. The result of 'RT SQ' operation. Notice that the
difference between the 'RT SQ' operation and the 'RT', 'SH'
operations is that in the image resulting from the 'RT SQ'
operation no "new" background is created.<br>
<br>
 2.6 <a name="processing2.6" href= "man/wi.html">'WI'</a>--The Windowing Operation<br>
<br>
<p>Images may have to be windowed (i.e., a portion cut out) at
several stages of an investigation: the particle of interest is
windowed from a large field; once masked and aligned, it could
again be windowed to save computer storage space; or a large image
may have to be windowed to a size appropriate for certain
operations. For example, Fourier operations use a mixed-radix
algorithm, and dimensions that involve large prime numbers may
present a problem (see <a href=
"man/ft.html">'FT'</a> manual for
details).</p>

<pre>
                                              
              EXAMPLE:  Windowing an Image

    .OPERATION: WI                  ;Use the WI operation
    .INPUT  FILE: SHF001            ;Image to be windowed
    .OUTPUT FILE: WIN001            ;Name of new image
    .ENTER DIMS NX,NY: 110,110  ;Size of windowed area
    .TOP LEFT COOS: 2,2             ;Coordinates where the
                                    ;top left corner of the
                                    ;new image will be
    
    .OPERATION: WI                  ;Use the WI operation
    .INPUT FILE: SHF002            ;Image to be windowed
    .OUTPUT FILE: WIN002            ;Name of new image
    .ENTER DIMS NX,NY: 110,110  ;Size of windowed area
    .TOP LEFT COOS: 2,9             ;Coordinates of the point 
                    ;in the old image where 
                                    ;the top left corner of 
                                    ;the new image will be
</pre>

<i>NOTE: The top left corner of an image has coordinates 1,1 (not
0,0 !) by convention.<br>
<br>
</i> 

<center><img width="110" height="110" src=
"./img/win001.gif"><tt>&nbsp;</tt> <img width="110" height="110"
src="./img/win002.gif"></center>

<center><tt>WIN001
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspWIN002</tt></center>

<br>
 

<center>FIGURE 6. Result obtained by application of the 'WI'
operation.</center>

<br>
 2.7 <a name="processing2.7" href= "man/pd.html">'PD'</a>--The Padding Operation<br>
<br>
<p>Padding an image places the image into a larger field of
user-specified dimensions and background. This would be useful, for
example, in preparing the image for cross correlation with another
image, so as to avoid wrap-around overlaps.</p>

<pre>
                   EXAMPLE:  Padding an Image

    .OPERATION: PD                  ;Use the PD operation
    .INPUT  FILE: SAM001            ;Image to be padded
    .OUTPUT FILE: PAD001            ;Name of new image
    .ENTER DIMS NX,NY: 150,150  ;Size of final image
    .AVERAGE(Y/N),(C)IRC OP: Y      ;Choice of background
                                    ;density: use average
    .TOP LEFT COOS: 38,38           ;Coordinates of image
                                    ;placement within
                                    ;padded image
   
</pre>

<center><img width="150" height="150" src="./img/pad001.gif"> <img
width="150" height="150" src="./img/pad002.gif"></center>

<center><tt>PAD001 &nbsp; &nbsp; &nbsp; &nbsp; PAD002</tt></center>

<br>
 FIGURE 7. Here, padding has been used to produce an image twice
the size of the original. By placing the average of the windowed
area into the region around it, we have minimized the density step
at the border. This choice of background prevents artifacts from
occurring in the Fourier transform of the padded image. (By
answering 'N' to the question "average (Y/N)" you would indicate
that you wish to supply the background value yourself -- in that
case a solicitation for that value would follow.)<br>
<br>
 2.8 <a name="processing2.8" href= "man/mr.html">'MR'</a>--The Mirroring Operation<br>
<br>
<p>By this operation, a mirror-image of the input image is created.
The image is reflected across the vertical line or the horizontal
line running through the image center at (75,75). This might be
useful if the handedness is not certain.</p>

<pre>
              EXAMPLE:  Mirroring an Image

    .OPERATION: MR                ;Use the MR operation
    .INPUT  FILE: PAD001          ;Image to be mirrored
    .OUTPUT FILE: MIR001          ;Name of new image
    .MIRROR AT (X) OR (Y)-AXIS    ;the mirror axis. X = interchange
     (DEF=Y): Y                   ;rows, Y=interchange columns  
 
</pre>

<center><img width="150" height="150" src="./img/mir001.gif"> <img
width="150" height="150" src="./img/mir002.gif"></center>

<center><tt>MIR001 &nbsp; &nbsp; &nbsp; &nbsp; MIR002</tt></center>

<br>
 FIGURE 8. This picture is simply a mirror-reflection of the
previous picture with respect to a line parallel to Y running
through the point ((INT(NX/2) + 1, INT(NY/2) + 1).<br>
<br>
 2.9 <a name="processing2.9" href= "man/bc.html">'BC'</a>--The Box-Convolution Operation<br>
<br>
<p>Central to the box convolution operation is an algorithm that
replaces the value of each pixel by the average of a small
rectangular area around it. If the 'L' (low-pass filtering) option
is chosen, 'BC' results in an image that is a mixture between the
box-convolved image and the original image. If the 'H' option is
chosen, 'BC' subtracts the box-convolved image from the original
image. The resulting image is a high-pass filtered version of the
input image. It can again be mixed with the input image.</p>

<p>The filter weight is used to specify the proportion of the
filtered to the unfiltered image to be mixed to form the output
image. Filter weight = 1 means output is the pure filtered
image.</p>

<pre>
             EXAMPLE:  Box-Convoluting an Image

    .OPERATION: BC                  ;Use the BC operation
    .INPUT FILE: INT002            ;Image to be convoluted
    .OUTPUT FILE: BOX002            ;Name of new image
    .(H)IGH-PASS/(L)OW-PASS/(T)HRES/(D)IVIS/(V)AR: L
                                    ;Type of filtration, in
                                    ;this case low-pass
    .LOCAL AREA SIZE COL,ROW: 5,6   ;Size of convolution box
    .FILTER WEIGHT (0.0-&amp;gt1.0): 1    ;Mixing factor
</pre>

<center><img width="128" height="128" src="./img/box001.gif"> <img
 width="128" height="128" src="./img/box002.gif"></center>

<center><tt>BOX001 &nbsp; &nbsp; &nbsp; &nbsp; BOX002</tt></center>

<br>
 FIGURE 9. Note the fuzziness of the image. Fine detail and
surrounding noise are suppressed, but the particle stands up better
from the background.<br>

<br>
 2.10 <a name="processing2.10" href= "man/ce.html">'CE'</a>--The Contrast Enhancement Operation<br>

<br>
<p>'CE' operates by stretching the density variations on the basis
of the image histogram. Hence, this operation can be used to
enhance the overall contrast, by sacrificing the exact
representation of features whose densities are in the top or bottom
range. The output image will always be in the range 0...2.</p>

<pre>
             EXAMPLE:  Enhancing Contrast of an Image

    .OPERATION: CE                ;Use the CE operation
    .INPUT  FILE: BOX001          ;Image to be enhanced
    .OUTPUT FILE: CON001          ;Name of new image
    .(S)TRETCH, (H)ISTOGRAM EQUALIZE OR 
      (L)OCAL? (S/H/L): S         ;Choice of contrast                 
                                  ;enhancement algorithm,
                                  ;in this case linear 
                                  ;contrast stretching. 
    .(S)INGLE/(A)UTOMATIC/(D)OUBLE MAPPING: A
                                  ;Stretching mode.
                                  ;Automatic means that the
                                  ;top and bottom cutoff
                                  ;points are determined
                                  ;from the percentage of
                                  ;pixels specified.
    .INTEGRAL THRESHOLD PERC.: .5 ;Percent of pixels to be
                                  ;chopped off at top and
                                  ;bottom of histogram
    .PLOT RESULT HISTOGRAM: Y     ;If yes, the histogram of the stretched 
                  ;image is to be computed
    .BOTTOM DENSITY VALUE: .5     ;density value to be mapped to 0.0
    .TOP DENSITY VALUE: 1.2       ;density value to be mapped to 2.0
  
</pre>

<center><img width="128" height="128" src="./img/con001.gif"> <img
width="128" height="128" src="./img/con002.gif"></center>

<center><tt>CON001 &nbsp; &nbsp; &nbsp; &nbsp; CON002</tt></center>

<br>
 FIGURE 10. While Box Convolution was seen to be effective, a much
more dramatic effect was achieved here with contrast enhancement.
The particle stands out definitively against the background, albeit
with a complete loss of information in the areas affected by the
density truncation. Note, for instance, that the fringe surrounding
the particle (which is caused by the contrast transfer function of
the elecetron microscope) has become uniformly black.<br>
<br>
 2.11 <a name="processing2.11" href= "man/ed.html">'ED'</a>--The Edge Detection Operation<br>
<br>
 This operation will create a file containing only lines
delineating edges detected in the image. This is similar to the 
<a href="man/fc.html">'FC'</a> (file
contour) operation, except that the contours represent lines of steep
density changes, not lines of equal density.<br>
<pre>
           EXAMPLE:  Detecting Edges in Images

    .OPERATION: ED                ;Use the ED operation
    .INPUT  FILE: CON001          ;Image to which edge  
                                  ;detection should be 
                  ;applied
    .OUTPUT FILE: EDG001          ;Name of new image
                                  ;containing contours
    .FILTER NUMBER (1/2/3/4): 4   ;Specify type of filter
                                  ;(see note)
    .THRESHOLD (1)LOW/(2)MEDIUM/(3)HIGH: 3
                                  ;Density variation
                                  ;threshold                                                                
</pre>

NOTE: Type of filter varies with different images, depending on the
S/N (signal-to-noise) ratio and the crowdedness of edges:<br>
<pre>
       Filter 1--very high S/N ratio (typical for images resulting
                 from averaging low-pass filtering).
       Filter 2--medium S/N ratio, many edges expected.
       Filter 3--medium S/N ratio, few edges expected.
       Filter 4--low S/N ratio (typical for raw data).
</pre>

<center><img width="128" height="128" src="./img/edg001.gif"> <img
width="128" height="128" src="./img/edg002.gif"></center>

<center><tt>EDG001 &nbsp; &nbsp; &nbsp; &nbsp; EDG002</tt></center>

<br>
FIGURE 11. Compare this to the input images CON001 and CON002 in
Figure 10. Lines along which the density gradient is steepest are
computed by the program.<br>
<br>
 2.12 <a name="processing2.12" href= "man/asr.html">'AS R'</a>--The Average + Variance Operation<br>
<br>
<p>'AS R' computes the average image and variance image from two or
more original images. The variance image shows the areas where
pixels vary strongest among the image set. This is useful in
determining how uniform the particles are, and how significant
certain ultrastructural features are that show up in the average
image.</p>

<p>It is important to remember that all of the files must begin
with the same file series name, e.g. SAM001, SAM002, ..., SAM009,
SAM010. Also, even though the name of the first image is given
after the prompt ".FIRST FILE:", it must also be included as part
of the file numbers given in answer to ".ENTER FILE NUMBERS:",
otherwise it will be skipped in the computation of average and
variance images.</p>

<p>In the following example the set of images used is from an
experiment in which 70S ribosomes are visualized.</p>

<pre>
             EXAMPLE:  Averaging A Series of Images

    .OPERATION: AS R                 ;Use the AS operation
    .FILE PREFIX OR TEMPLATE: SAM*** ;First image of series
    .ENTER FILE NUMBERS: 2-10        ;Numbers in a series
                                     ;to be averaged
    .ALL, ODD-EVEN (A/O):A           ;all images will be added   
    .AVERAGE FILE: AVG002            ;Name of average file to
                                     ;be computed
    .VARIANCE FILE: VAR002           ;Name of variance file 
</pre>

<p><i>NOTE:</i></p>

<p><i>(1) If the average file already exists, then the system will
assume that you want to add the current image set to this file, and
will ask for the number of images already summed.</i></p>

<p><i>(2) If the ODD-EVEN option is selected, two average images
and corresponding variance images are created, one for the
odd-numbered, one for the even-numbered files. This option is used
for resolution tests where two independent averages are
compared.</i></p>

<p><i>(3) For negatively stained data the mean of images is
irrelevant. In this case operation <a href=
"man/as.html">'AS'</a> can be used. It
subtracts the mean from every image in the input series before
calculation of the average map. Thus the average map produced by
'AS' will have a zero mean.</i></p>

<p><i>If 'AS' is applied to images with relevant average the
resulting variance map will be incorrect (the variance values will
be too small).</i></p>

<center><img width="675" height="90" src=
"./img/ser002.gif"></center>

<br>
<center><img width="75" height="75" src="./img/avg002.gif"> <img
width="75" height="75" src="./img/var002.gif"></center>

<center><tt>AVG002 &nbsp; VAR002</tt></center>

<br>
 FIGURE 12. Average image and Variance map resulting from averaging
the 9 images in the top row. The average image (left) has
considerably less detail than any of its constituent images, but it
is more representative of a "typical" particle. The variance image
(right) shows specks of high variance within the area of the
particle. These may indicate regions most strongly affected by the
variation in projection direction, or actual changes in molecular
conformation.<br>
<br>
 2.13 <a name="processing2.13" href= "man/fc.html">'FC'</a>--The File Contour
Operation<br>
<br>
<p>Contouring an image creates isolines at discrete density values
within an image. These are generated with a user-specified number
of levels. The actual contouring levels used are generated by the
program. The <a href="man/fce.html">'FC
E'</a> operation allows the user to specify both the base density and
the density increment between successive contour lines. Note that
for 'FC E', contouring does NOT occur at densities less than zero.
The <a href="man/ar.html">'AR'</a>
operation may be used to make the image definitely positive by adding
a constant to each pixel (see the SPIDER documentation for more
information).</p>

<p>As a preparation for 'FC', the image must be expanded since the
contour lines occupy entire pixels. Otherwise the contours will
look very ragged.</p>

<pre>
           EXAMPLE:  Contouring an Image


    .OPERATION: IP                ;Use the IP operation
    .INPUT FILE1: AVG002          ;Image to be enlarged
    .OUTPUT FILE: IPL002          ;Name of new image
    .ENTER DIMS NX,NY: 200,200;Size of output image

    .OPERATION: FC                ;Use the FC operation
    .INPUT  FILE: IPL002          ;Image to be contoured
    .OUTPUT FILE: FIC002          ;Name of new image
    .NO. OF CONTOUR LEVELS: 4     ;Number of density 
                                  ;levels delineated
    .OVERWRITE (Y/N): Y           ;Superimposes contours
                                  ;onto image
    .(W)HITE,(B)LACK,OR (A)DJUSTED CONTOURS: A
                                  ;Appearance of contour
                                  ;lines (adjusted means the
                                  ;appearance switches from 
                                  ;lines on black background, 
                                  ;black on white background)
</pre>

<p><i>NOTE:</i></p>

<p><i>(1) Rule of thumb: for the image expansion by 'IP', use a
factor of 3 to 4, depending on the complexity of features.</i></p>

<p><i>(2) In the simple 'FC' operation, the points of highest and
lowest density are both counted as contour levels. In the above
example, only 2 contour lines are visible even though 4 was
specified as the number. The pixels at either extreme of the
density range show up as single "contour points".</i></p>

<center><img width="200" height="200" src=
"./img/fic002.gif"></center>

<center>FIC002</center>

<br>
FIGURE 13. A contoured image. This operation is especially useful
for the display of average images.<br>
<br>
 2.14 <a name="processing2.14" href= "man/su.html">'SU'</a>--The Subtract-Images Operation<br>
<br>
<p>One or more images may be subtracted from an initial image pixel
by pixel, using this operation. To end the subtraction series, place
an asterisk (*) in response to the recurring prompt ".SUBTRACTED
FILE:" .</p>

<pre>
        EXAMPLE:  Subtracting and Copying Images

    .OPERATION: SU            ; Use the SU operation
    .INPUT  FILE: CON001      ;   Name of image from which other 
                              ;   image will be subtracted
    .SUBTRACTED FILE: CON002  ; Name of image to be subtracted
    .OUTPUT FILE: SUB001      ; Output file
    .SUBTRACTED FILE: *       ; Terminates solicitation
                              ;   of additional images
                              ;   to be subtracted
</pre>

<center><img width="128" height="128" src=
"./img/sub001.gif"></center>

<center>SUB001</center>

<br>
FIGURE 14. The image CON002 was subtracted pixel-by-pixel from
CON001 (see Fig 10). In a real-world application of 'SU', one image
might be the average of particles labeled with a small ligand, the
other the average of unlabeled control particles. In that case, the
positive difference would show the position of the ligand
molecule.<br>
<br>
 2.15 <a name="processing2.15" href= "man/mu.html">'MU'</a>--The Multiply-Images Operation<br>
<br>
<p>The image created by 'MU' has each pixel from one image
multiplied by the corresponding pixel from the other image(s).
Thus, the resultant image appears very similar to one image where
the pixels have a value of 1 in the other image.</p>

<p>A whole series of images can be multiplied together; the '*'
inserted after the ".MULTIPLIER FILE:" prompt ends the MU
operation.</p>

<pre>
             EXAMPLE:  Multiplying Images

    .OPERATION: MU            ; Use the MU operation
    .INPUT FILE: CON001       ; Name of first image
    .MULTIPLIER  FILE: CON002 ; Name of second image
    .OUTPUT FILE: MUL001      ; Output file
    .MULTIPLIER FILE: *       ; Terminates solicitation
                              ;   of additional images
                              ;   to be multiplied
</pre>

<center><img width="128" height="128" src=
"./img/mul001.gif"></center>

<center>MUL001</center>

<br>
FIGURE 15. Result of Multiplying images. Note the extreme effect of
multiplying where the density in one image is very low ("absolute
veto effect").<br>
<br>
 2.16 <a name="processing2.16" href= "man/sq.html">'SQ'</a>--The Square-Image Operation<br>
<br>
<p>This operation mathematically squares the value of each pixel in
the image, and has a non-linear contrast-enhancing effect areas
with high density (white in our display) are enhanced, those with
low density (dark) remain unchanged and those with medium density
(grey) are pushed more toward low density.</p>

<pre>
          EXAMPLE:  Squaring Images

    .OPERATION: SQ            ;Use the SQ operation
    .INPUT  FILE: CON002          ;File to be squared
    .OUTPUT FILE: SQR002          ;Name of squared image
</pre>

<center><img width="128" height="128" src="./img/con002.gif"> <img
width="128" height="128" src="./img/sqr002.gif"></center>

<center><tt>CON002 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
SQR001</tt></center>

<br>
FIGURE 16. The contrast is selectively increased when the file is
squared; small density variations are accentuated when they occur
in the high density range.<br>
<br>
 2.17 <a name="processing2.17" href= "man/cc.html">'CC N'</a>--The Cross-Correlation Operation<br>
<br>
 

<p>The 'CC N' operation computes the normalized cross-correlation
function of two pictures by using the Fourier-transform
relationship. The dimensions of the two pictures must be the same;
however, the dimensions need not be powers of two (see <a href=
"man/ft.html">'FT'</a> for
restrictions).</p>

<p>The CCF is a measure of the degree of match (integrated
cross-product) of two images as a function of their relative
translation. For example, when two squares are superimposed, they
match perfectly. As they are moved farther and farther apart, in
any direction, the degree of match decreases. Their
cross-correlation will vary continuously and its value will depend
on the distance, and the direction in which they are separated. The
two images will be totally unmatched when no part of either square
is superposed upon the other.</p>

<p>In the example, we use two images of the ribosome, PAD002 (see
Section 2.6) and PAD003. The image PAD003 was created by padding
the image SAM003 in to a (150,150) image using 50,30 as top left
coordiates; i.e., shifted off the center by +12,-8. .</p>

<pre>
           EXAMPLE:  The Cross-correlation Function

    .OPERATION: CC N          ;Cross Correlation
    .INPUT FILE: PAD002           ;the first ribosome picture
    .REFERENCE FILE: PAD003       ;the second ribosome picture,  
                  ;which is used as the reference
    .OUTPUT FILE: CCF002          ;the file which will contain 
                  ;cross-correlation function
</pre>

<center><img width="150" height="150" src="./img/pad002.gif"> <img
width="150" height="150" src="./img/pad003.gif"> <img width="150"
height="150" src="./img/ccf002.gif"></center>

<center><tt>PAD002 &nbsp; &nbsp;&nbsp;&nbsp;&nbsp; PAD003
&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; CCF002</tt></center>

<br>
FIGURE 17. Display of cross-correlation function computed in above
example. The peak (indicating highest correlation) is seen to be
shifted by -12, +8, indicating the relative shift of the input
images. Note: The sign of shifts convention in section 6.6.<br>
<br>
 2.18 <a name="processing2.18" href= "man/ac.html">'AC'</a>--The Autocorrelation Operation<br>
<br>
<p>The 'AC' operation computes the autocorrelation function of a
picture by using the Fourier transform relationship.</p>

<p>The ACF is simply defined as the CCF of an image with itself.
Thus, any inherent symmetry and internal structure of a particle
seen in an image will be reflected by its ACF. The ACF pattern is
independent of the location of the particle in the image; therefore
it allows the relative orientation of particles to be found before
their relative shift is accurately known. This, in fact, is how
some alignment procedures are designed (see "Single Particle
Alignment Using SPIDER").</p>

<pre>
       EXAMPLE:  Computing the Autocorrelation Function

    .OPERATION: AC        ;Autocorrelation operation
    .INPUT FILE: PAD002           ;Image to be auto-correlated
    .OUTPUT FILE: ACF002      ;the file which will contain 
                      ;the auto-correlation coefficients.
</pre>

<center><img width="150" height="150" src=
"./img/acf002.gif"></center>

<center>ACF002</center>

<br>
FIGURE 18. Display of the autocorrelation function computed in
above example. Values of high correlation are shown in white. Due
to the inherent peak in the center (that is due to the perfect
match of an image with itself for zero shift), contrast is
noticeably reduced, and features of the ACF relating to
intramolecular vectors are virtually invisible.<br>
<br>
<p>Often, the center of the ACF produced by 'AC' will be an
extremely high-density area. An extreme contrast situation such as
this will obliterate any small density variations elsewhere in the
image. Masking the interior will remove these upper-extreme density
values, concomitantly mapping the much smaller density variations
in the remaining area into the full display range, and thereby
enhance the visual data in the periphery of the image. [Masks with
arbitrary shapes can be created by using the <a href=
"man/thm.html">'TH M'</a> operation and
applied with the 'MM' operation, see manual chapters on <a href=
"man/th.html">'TH'</a> and <a href=
"man/mm.html">'MM'</a>.]</p>

<pre>
 
          EXAMPLE:  Inside Masking of an Image 
  
    .OPERATION: MA                ;Mask operation 
    .INPUT  FILE: ACF002          ;Image to be masked 
    .OUTPUT FILE: MAI002          ;Name of masked image 
    .OUTER &amp; INNER RADII: 76,7    ;Radii the outer and inner 
                  ;mask circles, in pixels 
    .(D)ISK, (G)AUSSIAN EDGE, OR (T)RUE GAUSSIAN: G     
                  ;Type of mask edge: sharp
                                  ;cutoff (D), piecewise 
                                  ;Gaussian(G), or true Gaussian(T) 
     .(A)V, (P)REC AV, (C)IRCUMF, OR (E)XTERNAL: P 
                                  ;the background is to be the 
                  ;average after masking 
     .MASK CENTER COOS: 76,76     ;Coordinates of the 
                                  ;center of the mask 
    
 
</pre>

<center><img width="150" height="150" src=
"./img/mai002.gif"></center>

<center>MAI002</center>

<br>
FIGURE 19. Here, by eliminating the peak at the origin, we have
made the important features of the antocorrelation function better
visible. Compare to Figure 18.<br>
<br>
 

<p><a href="#user_guider">(Back to the front page)</a></p>

<p>3. <a name="fourier3">THE FOURIER TRANSFORM</a><br>
<br>
</p>

<p>In this section, the Fourier transform will be introduced. A
comparison will be made between the transforms of 1) a montage of
nine images, and 2) the average of those images padded to the size
of that montage. This comparison will demonstrate the convolution
theorem and the origin of reflections formed in the Fourier
transform of a crystal lattice.</p>

<p>The first operation illustrated in this section will be the
montage operation. It is not normally needed for Fourier operations,
but this is an appropriate place to illustrate its function.</p>

3.1 <a name="fourier3.1" href= "man/mns.html">'MN S'</a>--The Montage Operation With Scaling Option<br>
<br>
<p>Images of a series (i.e., whose names start with the same
prefix) can be "bundled up" into a gallery, or montage. The 'MN S'
operation not only arranges the images in a gallery, but also scales
them so that they will all be in the same density range 0...2. This
is particularly important for the display of images of widely
differing contrasts and offsets.</p>

<p>Montaging can be accomplished with no space between the images,
or with a user-specified space between them. The density of this
optional space can also be specified; but it should be between 0
and 2.</p>

<pre>
              EXAMPLE:  Montaging an Image Series

    .OPERATION: MN S             ;Use the MN S operation
    .ENTER PREFIX OF FILE SERIES: SAM    ;File prefix of images
                             ;to be montaged
    .ENTER FILE NUMBERS: 2-10            ;Numbers of images in
                         ;file series to be 
                         ;placed in montage
    .NUMBER OF PICTURES PER ROW, MARGIN: 3,0   
                     ;Number of images per
                         ;horizontal row, size of
                         ;optional margin space
    .ENTER MARGIN  VALUE: .1             ;value to be put in margins 
    .OUTPUT FILE: MON001             ;Name of montage created   
</pre>

<center><img width="225" height="225" src=
"./img/mon001.gif"></center>

<center>MON001</center>

<br>
FIGURE 20a. A montage of the images used to create the average
image in Figure 12. In this case, no margin was specified (0
pixels) in the 'MN S' operation.<br>
<br>
<center><img width="225" height="225" src=
"./img/big002.gif"></center>

<center>BIG002</center>

<br>
 FIGURE 20b. The average image (Fig. 12) has been padded here to
the same size as the montage (Fig. 20a). Figures 21a &amp; b are
the Fourier transforms of the images in Figures 20a &amp; 20b,
respectively, displayed as power spectra.<br>
<br>
 3.2 <a name="fourier3.2" href= "man/ft.html">'FT'</a>--The Fourier Transform Operation<br>
<br>
<p>The 'FT' operation uses a mathematical expression termed a
Fourier series to create a representation of the image in Fourier
space. This representation employs a series of sinusoidal waves
characterized by their amplitudes and phases. To display a Fourier
transform in pictorial form, the <a href=
"man/pw.html">'PW'</a> operation (see
below) has to be used: this extracts the amplitudes of the
transform and arranges them in their logical two-dimensional order
according to their spatial frequencies (reciprocal wavelengths in
x- and y- direction). Note, however, that the phases of the Fourier
transform are lost in this representation.</p>

<p>The Fourier transform operation is useful in many steps of image
processing. When performed on a micrograph, the 'FT' operation
followed by 'PW' is equivalent to the use of an optical
diffractometer and so can yield information on the quality of the
micrograph. It is also useful in elucidating image symmetry and
presence of order in ultrastructural studies. An image of a crystal
with poor S/N ratio can be Fourier transformed, and the Fourier
components representing the repeated structure (reflections) can
then be separately back-transformed to generate a relatively
noise-free image of the crystal.</p>

<p>In the demonstration examples here, two images are Fourier
transformed: the montage of 9 particles (Fig 20a), and a padded
version of the image created by averaging those 9 particles (Fig
20b). By making the padded image the same size(225,225) as the
montage, a comparison can be made between the transform of the
single (average) image and that of a "crystal" (the montage) formed
by the images used in the averaging.</p>

<pre>
            EXAMPLE: Padding and Fourier-Transforming an Image

    .OPERATION: FT              ;Use the FT operation
    .INPUT FILE: MON001                 ;Image to be Fourier
                        ;transformed
    .OUTPUT FILE: FOU001        ;output file which will 
                                        ;contain the transformed image.

       (FOURIER TRANSFORMATION OF THE AVERAGE IMAGE)

    .OPERATION: PD          ;Pad image to make it
                    ;Fourier-transformable
    .INPUT  FILE: AVG002        ;Image to be padded     
    .OUTPUT FILE: BIG002        ;Padded image ready to
                    ;be transformed
    .ENTER DIMS, NX,NY: 225,225 ;Dimensions of padded image
    .AVERAGE (Y/N), (C)IRCULAR OPTION: Y;Average of image used for
                                        ;padding background
    .ENTER TOP LEFT COOS: 76,76     ;Coordinates of padded image 
                                        ;where smaller image is to be
                                        ;placed (arbitrary, as long
                                        ;as the Fourier phases
                                        ;are not considered)

    .OPERATION: FT              ;Use the FT operation
    .INPUT FILE: BIG002                 ;Image to be Fourier
                        ;transformed
    .OUTPUT FILE: FOU002        ;output file which will 
                                        ;contain the transformed image.
</pre>

<p><i>Note that the Fourier transform of an image is
complex-valued, so it cannot be represented in real space.
Therefore no image is displayed here.</i></p>

<p>To display the amplitudes of the Fourier transform, the 'PW'
operation is used.</p>

3.3 <a name="fourier3.3" href= "man/pw.html">'PW'</a>--The Power Spectrum Operation<br>
<br>
<p>'PW' is a companion operation to 'FT': it allows the visual
display of the amplitudes in the Fourier transform of an image. The
"power spectrum" is normally defined as the square of the
amplitudes; in SPIDER, 'PW' creates an image that contains the
unsquared amplitudes. The 'PW' operation can only be performed on
Fourier data.</p>

<p>In the following example, the two Fourier transforms generated
above were both subjected to the power spectrum operation. The two
resulting power spectra (Figs. 21a,b) are quite different: the one
relating to the single particle image (Fig. 21b) is continuous, the
one relating to the montage discontinuous. In the latter case, the
discrete amplitudes are seen to lie on a square grid. Closer
inspection shows that in these points, both power spectra are in
fact identical.</p>

<p>This phenomenon can be explained in terms of the convolution
theorem: apart from variations that can be regarded as noise, the
montage is the convolution of the averaged particle image with a
square grid of single points. Consequently, its Fourier transform
is the product of the single-image Fourier transform (Fig. 21b)
with the Fourier transform of the single-point lattice, which is
again a 2D point lattice (the "reciprocal lattice").</p>

<pre>
      EXAMPLE:  The Power Spectrum of a Fourier Transform

    .OPERATION: PW            ;Use the PW operation
    .INPUT FILE: FOU001           ;Fourier data to be converted
    .OUTPUT FILE: POW001          ;Name of new image

    .OPERATION: MA            ;Inside mask is used in
                      ;order to suppress the central
                  ;term  better and thus  
                      ;visualize the  diffraction 
                  ;peaks
    .INPUT  FILE: POW001          ;Image to be masked
    .OUPUT FILE: MAI001           ;Name of masked image
    .OUTER &amp; INNER RADII:112,3    ;Radius of circular mask
    .(D)ISK, (G)AUSSIAN EDGE, OR (T)RUE GAUSSIAN: D     
                  ;Type of mask edge
    .(A)V,(P)REC AV,(C)IRCUMF,OR (E)XTERNAL: E
                      ;Put user-whose background
                      ;value in  masked area
    .ENTER BACKGROUND: 0.00
    .MASK CENTER COOS: 113,113    ;Coordinates of the
                      ;center of the mask


    .OPERATION: PW
    .INPUT FILE: FOU002
    .OUTPUT FILE: POW002
</pre>

<p>To see the result clearly, you can use the 
<a href="man/wi.html">"WI"</a> operation to window
the central part of the power spectrum.</p>

<pre>
    .OPERATION: WI                 ;Use the WI operation
    .INPUT  FILE: MAI001           ;Image to be windowed
    .OUTPUT FILE: WMA001           ;Name of new image
    .ENTER DIMS NX,NY: 120,120 ;Size of windowed area
    .TOP LEFT COOS: 53,53        ;Coordinates where the
                                   ;top left corner of the
                                   ;new image will be
    

    .OPERATION: WI                 ;Use the WI operation
    .INPUT  FILE: POW002           ;Image to be windowed
    .OUTPUT FILE: WPO002           ;Name of new image
    .ENTER DIMS NX,NY: 120,120 ;Size of windowed area
    .TOP LEFT COOS: 53,53        ;Coordinates where the
                                   ;top left corner of the
                                   ;new image will be   
</pre>

<center><img width="120" height="120" src=
"./img/wma001.gif"></center>

<center>WMA001</center>

<br>
FIGURE 21a. WMA001--Central part of power spectrum of the montage
in Fig 20a. Note the discontinuity of the image, compared to Figure
21b.<br>
<br>
 

<center><img width="120" height="120" src=
"./img/wpo002.gif"></center>

<center>WPO002</center>

<br>
 FIGURE 21b. WPO002--Central part of power spectrum of the
Fourier-transformed padded average image in Fig 20b. Here the
density variations are continuous, yet agree exactly with those of
Figure 21a in the discrete lattice points ("reciprocal
lattice").<br>
<br>
 

<p><a href="#user_guider">(Back to the front page)</a></p>

<p>4. <a name="creating4">CREATING AND EDITING IMAGES</a><br>
<br>
 4.1 <a name="creating4.1" href="man/mo.html">'MO'</a>--The Modelling Operation<br>
<br>
</p>

<p><i>Note that another example for the use of this operation is
documented in the Appendix.</i><br>
 For the next series of images, a base image was created using the
'MO' operation. The image was specified to be of random densities,
between 0 and 1.</p>

<pre>
           EXAMPLE:  Creating a Random Image

    .OPERATION: Mo               ;Use the MO operation
    .OUTPUT FILE: MOD001             ;Name of file created
    .ENTER DIMS (NX,NY): 128,128 ;Size of image
    .(T)(S)(C)(W)(R)(P): R           ;Type of image, random
    .GAUSSIAN DIST.? (Y/N): N        ;Type of distribution
                         ;of pixel values; N results 
                         ;in a uniform distribution
                         ;between 0 and 1
</pre>

<center><img width="128" height="128" src=
"./img/mod001.gif"></center>

<center>MOD001</center>

<br>
<center>FIGURE 22. An image composed of completely random pixel
densities.</center>

<br>
 4.2 <a name="creating4.2" href= "man/bl.html">'BL'</a>--The Create-Blank Operation<br>
<br>
<p>A blank image is an image with a background of uniform density.
There is no inter-pixel variation as there is with the random 'MO'
image. This particular blank image was created to demonstrate the
following operations: 'IN' and 'PA'.</p>

<pre>
      EXAMPLE:  Creating a Blank (Constant Value) Image

    .OPERATION: BL            ;Use the BL operation
    .OUTPUT FILE: BLA001          ;Name of file created
    .ENTER DIMS NX,NY: 30,30  ;Dimensions of file
                          ;to be created
    .AVERAGE? (Y/N): N        ;Type of background
                      ;(Y allows average of
                      ;another, specified
                      ;image to be used)
    .BACKGROUND: .5           ;Background density,                  
</pre>

<p><i>Note: Because of their inherent lack of any density
variation, blank images cannot be displayed; attempts to rescale it
into the range 0...2 would result in division by 0.</i></p>

4.3 <a name="creating4.3" href= "man/in.html">'IN'</a>--The Insert Operation<br>
<br>
<p>One image can be inserted into another, larger, image by using
'IN'. The smaller image simply takes the place of the pixels in the
larger image.</p>

<p><i>Note that the new image REPLACES the old pixels--it is not
added to them, as in 'PA'. Also, the final image with the insert
replaces the original image, so if the original is to be saved, it
must be copied first.</i></p>

<pre>
       EXAMPLE:  Inserting an Image Into Another

    .OPERATION: CP            ;Copy large image
    .INPUT  FILE: MOD001          ;Image to be copied
    .OUTPUT FILE: INS001          ;Name of new image

    .OPERATION: IN            ;Use the IN operation
    .SMALL INPUT FILE: BLA001     ;Image to be inserted
    .LARGE INPUT (OVERWRITTEN!) FILE: INS001        
                      ;Final image with the
                      ;inserted blank
    .ENTER TOP LEFT COOS: 35,35   ;Coordinates of large
                      ;image where blank is
                      ;to be inserted   
</pre>

<center><img width="128" height="128" src=
"./img/ins001.gif"></center>

<center>INS001</center>

<br>
FIGURE 23. A small blank image (upper left) inserted into a larger
image. Note its homogeneity--the pixels of the inserted image
replace those of the larger one.<br>
<br>
 4.4 <a name="creating4.4" href= "man/pa.html">'PA'</a>--The Patch Operation<br>
<br>
 

<p>Patching an image is similar to inserting an image, in that a
smaller picture is placed into a larger one. The main difference,
however, which is quite important, is that while 'IN' REPLACES the
pixel-densities of the large picture with the smaller one, 'PA'
ADDS the pixel-densities of both images together. This can be
clearly seen in PAT001 which has an inserted image at the top left,
and a patched image at the lower right. Again, the new image
overwrites the old one, and therefore it is a good idea to copy the
original image before using it.</p>

<pre>
              EXAMPLE:  Patching an Image 
 
    .OPERATION: CP                ;Copy the large image 
    .INPUT  FILE: INS001          ;File to be copied 
    .OUTPUT FILE: PAT001          ;Name of copied image 
 
    .OPERATION: PA                ;Use the PA operation 
    .SMALL INPUT FILE: BLA001     ;Image to be patched 
    .LARGE INPUT (OVERWRITTEN!) FILE: PAT001      
                          ;Image to receive patch 
    .TOP LEFT COOS: 90,90         ;Coordinates of large 
                                  ;image where small one 
                                  ;is to be patched 
</pre>

<center><img width="128" height="128" src=
"./img/pat001.gif"></center>

<center>PAT001</center>

<br>
 FIGURE 24. The same small blank image (now lower right) patched
into a larger image. 

<p><i>Note that the pixels from both images were added, resulting
in a lighter overall appearance.</i></p>

4.5 <a name="creating4.5" href= "man/th.html">'TH'</a>--The Threshold Operation<br>
<br>
 

<p>An image that is subjected to the 'TH' operation has any
densities beyond a user-determined value set equal to the
threshold. Either an upper or a lower boundary or both can be
set.</p>

<pre>
            EXAMPLE:  Thresholding Images 
 
    .OPERATION: TH                ;Use the TH operation 
    .INPUT FILE: PAT001           ;Image to be thresholded 
    .OUTPUT FILE: THR001          ;Image with thresholded 
                                  ;density values 
    .ALTER (A)BOVE THRESHOLD, (B)ELOW, OR  
     (C)BOTH SIDES (A/B/C): C     ;Thresholding to be done 
                                  ;on both sides of the 
                                  ;density range 
    .UPPER,LOWER THRESHOLD: .6,.4 ;Upper and lower threshold 
                                  ;to be specified       
</pre>

<center><img width="128" height="128" src=
"./img/thr001.gif"></center>

<center>THR001</center>

<br>
 

<center>FIGURE 25. The result of 'TH' operation.</center>

<br>
<br>
 

<p><a href="#user_guider">(Back to the front page)</a></p>

<p>5. <a name="processing5">PROCESSING OF 3D DATA</a></p>

<p>5.1 <a name="processing5.1" href= "man/ma.html">MA</a></p>

<p>Operation works for both 2D and 3D images.</p>

<p>5.2 <a name="processing5.2" href= "man/ip.html">IP</a></p>

<p>Operation works for both 2D and 3D images.</p>

<p>5.3 <a name="processing5.3" href= "man/rt3d.html">RT 3D</a></p>

<p>This operation allows the volume to be rotated within the frame.
By default, rotation is with respect to a center at
((INT(NX/2)+1, INT(NY/2)+1, INT(NZ/2)+1). The related
operation <a href="man/rt3a.html">'RT
3A'</a> allows rotation of of a volume around an arbitrary center.
The rotation is specicified by three <a href="euler.html">Euler
angles</a>.</p>

<p>5.4 <a name="processing5.4" href= "man/sh.html">SH</a></p>

<p>Operation works for both 2D and 3D images.</p>

<p>5.5 <a name="processing5.5" href= "man/wi.html">WI</a></p>

<p>Operation works for both 2D and 3D images.</p>

<p>5.6 <a name="processing5.6" href= "man/pd.html">PD</a></p>

<p>Operation works for both 2D and 3D images.</p>

<p>5.7 <a name="processing5.7" href= "man/mr.html">MR</a></p>

<p>Operation works for both 2D and 3D images.</p>

<p>5.8 <a name="processing5.8" href= "man/bc.html">BC</a></p>

<p>Operation works for both 2D and 3D images.</p>

<p>5.9 <a name="processing5.9" href= "man/ce.html">CE</a></p>

<p>Operation does not work for 3D data.</p>

<p>5.10 <a name="processing5.10" href= "man/ed.html">ED</a></p>

<p>Operation does not work for 3D data.</p>

<p>5.11 <a name="processing5.11" href= "man/asr.html">AS R</a></p>

<p>Operation works for both 2D and 3D images.</p>

<p>5.12 <a name="processing5.12" href= "man/fc.html">FC</a></p>

<p>Operation does not work for 3D data.</p>

<p>5.13 <a name="processing5.13" href= "man/su.html">SU</a></p>

<p>Operation works for both 2D and 3D images.</p>

<p>5.14 <a name="processing5.14" href= "man/mu.html">MU</a></p>

<p>Operation works for both 2D and 3D images.</p>

<p>5.15 <a name="processing5.15" href= "man/sq.html">SQ</a></p>

<p>Operation works for both 2D and 3D images.</p>

<p>5.16 <a name="processing5.16" href= "man/ccn.html">CC N</a></p>

<p>Operation works for both 2D and 3D images.</p>

<p>5.17 <a name="processing5.17" href= "man/al.html">AL</a></p>

<p>Operation works for both 2D and 3D images.</p>

<p>5.18 <a name="processing5.18" href= "man/mns.html">MN S</a></p>

<p>Operation does not work for 3D data.</p>

<p>5.19 <a name="processing5.19" href= "man/ft.html">FT</a></p>

<p>Operation works for both 2D and 3D images.</p>

<p>5.20 <a name="processing5.20" href= "man/pw.html">PW</a></p>

<p>Operation works for both 2D and 3D images.</p>

<p>5.21 <a name="processing5.21" href= "man/mo3.html">MO 3</a></p>

<p>Creates a 3-D model density distribution.</p>

<pre>
.MENU: 

     (B)LANK -- CONSTANT DENSITY 
     (C)YLINDER -- SET OF CYLINDERS 
     (H)ELIX -- HELIX OF SPHERES 
     (HA) -- HELIX OF SPHERES, ADD DENSITITY 
     (NUM)BERS -- LINE NUMBERS 
     (Q)UICK -- RANDOM UNIFORM/GAUSSIAN STATISTICS 
     (R)ANDOM -- RANDOM UNIFORM/GAUSSIAN STATISTICS 
     (S)INE -- SET OF SINE WAVES 
     (SP)HERE -- SET OF SPHERES 
     (SPA) -- SET OF SPHERES, ADD DENSITIES 
     (SPV) -- SET OF SPHERES, VARIABLE DENSITIES 
     (T)EST -- 3D SINE WAVE 
     (W)EDGE -- DENSITY WEDGE
</pre>

<p>5.22 <a name="processing5.22" href= "man/bl.html">BL</a></p>

<p>Operation does not work for 3D data, but a blank volume can be
created using <a href="man/mo3.html">MO 3</a> operation.</p>

<p>5.23 <a name="processing5.23" href= "man/in.html">IN</a></p>

<p>Operation does not work for 3D data.</p>

<p>5.24 <a name="processing5.24" href= "man/pa.html">PA</a></p>

<p>Operation does not work for 3D data.</p>

<p>5.25 <a name="processing5.25" href= "man/th.html">TH</a></p>

<p>Operation works for both 2D and 3D images.</p>

<p><a href="#user_guider">(Back to the front page)</a></p>

6. <a name="procedure6">PROCEDURE MODE OF PROCESSING</a>

<p>6.1 <a name="procedure6.1" href=
"user_doc.html#procedure">Procedure</a> versus <a href=
"user_doc.html#interactive">Interactive</a> Sessions</p>

<p>In the interactive sesssion, you are able to verify the
different processing steps, try out choices of various parameters,
and make sure all questions are answered.</p>

<p>For any large-scale project, however, many such steps are
required, often to be repeated over a large number of image files.
This is no longer practical in the interactive mode. Instead,
operations along with answers to the queries are stored in operation
files and submitted in the procedure mode of processing.</p>

<p>A "procedure file" is flexible as it allows run-time
replacements. In the following section, we will provide an
introduction in writing both procedure files. In the course of this
introduction, many new features will be covered that have no
relevance or importance in the interactive mode of SPIDER covered
so far: <a href= "man/do.html">DO-LOOP</a>s, computed <a
href="man/goto.html">GOTO</a>s,
register variables, arithmetic expressions, run-time construction of file
names, document files, and string variables.</p>

<p>6.2 <a name="procedure6.2">How to Create a Procedure
File</a></p>

<p>Choose a text editor and prepare a file that contains the
operation stream to be processed sequentially by SPIDER. It is good
practice to choose a filename that is descriptive; e.g. ALIGN for a
procedure designed to align an image set. Note that the file name
extention of this and other operation files should be three
characters; it is called PROJECT CODE, and is set at the beginning
of the SPIDER session. So a valid name would be 'ALIGN.SEC' if
'SEC' is chosen as project code.</p>

<p><i>The first lines may be used as comment line. In SPIDER,
comment lines are started with ';'. To keep your procedure files
organized, put the file name, a short description of its purpose
and the date of creation into a comment line. (If necessary, you
can continue with additional comment lines, all started with
';'.)</i></p>

<p><i>6.3 <a name="procedure6.3">Preparing and Running a Simple
Procedure File</a></i></p>

<p><i>In the first example, we combine the operations from two
earlier examples in the interactive session, illustrating the use
of the 'IP' and 'RT' operations. We create a file named
'IPRT.SEC'.</i></p>

<pre>
<i>    ;IPRT.SEC 1/5/98 interpolate and rotate
    IP
    SAM001
    INT001
    128,128
    RT
    INT001
    ROT001
    130.
    EN
</i>
</pre>

<p><i>This sequence is identical to the sequence of
computer-solicited text input in the combined examples in earlier
sections 2.2 and 2.3, with the exception of the comment line and
the <a href="man/en.html">'EN'</a>
operation.</i></p>

<p><i>To execute the command file, simply type @@IPRT at the
operation prompt. SPIDER then accepts its operations from the file
'IPRT.SEC' until it encounters the 'EN' operation. After execution of
the procedure file, you will be able to verify that the new files
INT001 and ROT001 have been created, and that they are identical to
those shown in Figs 3 and 4.</i></p>

<p><i>6.4 <a name="procedure6.4">Use of Temporary In-core
Files</a></i></p>

<p><i>In the foregoing example, there may be only an interest in
obtaining the final output file, ROT001, while the "intermediate"
file INT001 is discarded. In that case, it is not necessary to
create a file on disk (which delays the processing because of the
input/output operations involved). Instead, a temporary area in
menory can be used. Here is the re-written procedure file, making
use of the "file" mapped in the core area 1:</i></p>

<pre>
<i>    ;IPRT1.SEC 1/5/98 interpolate and rotate
    IP
    SAM001
    _1
    128,128
    RT
    _1
    ROT001
    130.
    EN
</i>
</pre>

<p><i>Ten such areas can be used simultaneouly (_1 through _10),
but there are some restrictions on their size. See the detailed <a
href="user_doc.html#file_inline">user
documentation</a>.</i></p>

<p><i>6.5 <a name="procedure6.5">DO-LOOPS and Run-time Designation
of File Names</a></i></p>

<p><i>We may wish to apply above operations to a whole series of
images, for example the series used before, SAM002, ..., SAM010.
This is very easy, and the appropriate procedure file may be
created from 'IPRT.SEC' by editing:</i></p>

<pre>
<i>    ;IPRT2.SEC 1/5/98 interpolate and rotate image series
    DO LB1 [iter]=2,10
       IP
       SAM{***[iter]}
       _1
       (128,128)
       RT
       _1
       ROT{***[iter]}
       (130.)
    LB1
    EN
</i>
</pre>

<p><i>The file differs from the file created before by the addition
of two lines, 'DO LB1 [iter]=2,10' and 'LB1'. In addition, the file
names, both for input and output, now use a register variable index
'[iter]'.</i></p>

<p><i>The lines 'DO LB1 [iter]=2,10' and 'LB1' demarcate a segment of
the procedure file that is supposed to be repeated, giving the
values 2-10 successively to the index '[iter]'. Since index [iter] appears in
two file names, those file names are constructed with different
numbers each time, from SAM002 and ROT002 to SAM010 and
ROT010.</i></p>

<p><i>Another change you will notice is the parenthesis around the
numbers '128,128' and '130.'. This is a way of indicating "use the
same values each time round". Alternatively, different values could
be given for each round, by giving the explicit list. In the
following example, it is assumed that the target dimensions of the
output file of operation <a href= "man/ip.html">'IP'</a> are the same
throughout, but that the rotation angle is different for each
image:</i></p>

<pre>
<i>    ;IPRT3.SEC 1/5/98 interpolate and rotate image series
    DO LB1 [iter]=2,10
    IP
       SAM{***[iter]}
       _1
       (128,128)
       RT
       _1
       ROT{***[iter]}
       130.,10.,-30.,45.,15.,-8.5,34.,46.,170.
    LB1
    EN
</i>
</pre>

<p><i>6.6 <a name="procedure6.6" href="user_doc.html#variables">Variables</a>,
Arithmetic Expressions, and Computed Goto Statements</i></p>

<p><i>The sequence of operations in the procedure file can be
regarded as a "program" whose elements are entire images. The
DO-LOOP introduced in the the previous section is a feature that
reinforces this view. We now come to additional elements and
operations that bring out the program character even more. </i></p>

<p><i>Register Variables are reserved places in memory that can be used to
store numbers. They are represented with a alphanumerical name surrounded
by '[]' brackets. There are different ways to fill a
register variable: </i></p>

<p><pre>
       [size] = 5
</pre></p>

<p>would mean "store the number 5 in variable named 'size'". Alternatively,
variables could be specified in an output position of a operation. For example,
the peak search operation <a href="man/pk.html">'PK'</a>:</p>

<p><pre>
       PK [x],[y]
</pre></p>

<p>will locate the position of a peak in the cross-correlation
image given as input and store its value and its x- and y-
components in [x], and [y], respectively. Another way to assign
a value to a variable will become clear in the next subsection. The
numbers stored in the variables will remain available throughout
the session, or until overwritten.</p>
 
<p>How are register variables used? They can be used anywhere in operations
requiring numerical input. For example, when the cross-correlation
peak is found in the position -12, 8, it implies that the two
images being compared must be shifted relative to one another by
the inverse of that vector, to obtain optimum superimposition. Thus
the shift vector components to be used in a subsequent 
<a href= "man/sh.html">'SH'</a> operation would be12, -8.</p>

<p>Now if the values -12, 8 were stored in [x]and [y], as a result of
the 'PK [x],[y]' operation described above, then the input to
the 'SH' operation would be -[x], -[y]. <i>Thus, variabless can be
used in any position where numerical input is expected.</i></p>

<p>Here is the complete SPIDER "program" that performs peak search
and subsequent corrective shift by the amount necessary to bring
two images in superimposition. We start with the cross-correlation
function obtained in Section 2.16, CCF002:</p>

<pre>
    PK [x],[y]
    CCF002
    1,0  ; The first number is the number of peaks to be
         ; searched for, the second number means: use the default origin 
         ; position at the picture's center (NX/2+1, NY/2+1)
    SH
    PAD002
    SHI002
    -[x],-[y]
</pre>

<p>After execution of this little program, the image SHI002 is
exactly aligned with PAD003 (see Fig 26).</p>

<center><img width="150" height="150" src="./img/shi002.gif"> <img
width="150" height="150" src="./img/pad003.gif"></center>

<center><tt>SHI002 &nbsp; &nbsp; PAD003</tt></center>

<br>
<center>FIGURE 26. The result of the above program.</center>
<br>
<br>

<p><a href="#user_guider">(Back to the front page)</a></p>

<hr>
<br>

<center><a name="appendix">APPENDIX</a></center>

<br>
<hr>
This appendix is meant as a guide both to create test images, for
whatever reason, and to create sample images for the SPIDER
Tutorial as previously described. If no other images are
immediately available to you, it is a good idea to create this
image to use as a sample, in order to follow the stepwise
instructions of the <a href="#user_guider">Tutorial</a>.<br>
<br>
<a href="man/mo.html">'MO'</a>--The MODEL
operation<br>
<br>
 The following procedure will create a sample image, the one seen
at the beginning of the Tutorial. It will be a 75X75 pixel image,
composed of a diagonal sine wave with two full periods.<br>
<pre>
           EXAMPLE:  Sample Image Using 'MO'

    .OPERATION: MO                ; Use the MO operation
    .OUTPUT FILE: SAM001          ; "Sample image #1"
    .ENTER DIMS NX,NY: 75,75  ; Dimensions of image: 75x75 pixels
    .(T)(S)(C)(W)(R)(G): T        ; Generate test sine wave image
</pre>

After creating the above image, which should resemble figure 1
below, you may proceed with the beginning of the SPIDER Tutorial.<br>

<br>
<center><img width="75" height="75" src="./img/sam001.gif"></center>

<center>SAM001</center>

<br>
<center>FIGURE A1. The resultant image after following the above
example.</center>

<p><a href="#user_guider">(Back to the front page)</a></p>
</dd>
</dl>
</body>
</html>

@


1.18
log
@procedure
@
text
@d342 1
a342 1
sampling points and is always refered to as NSAM. y, the height of
d344 1
a344 1
refered to as NROW. A 3D image can be thought of as a stack of 2D
d346 1
a346 1
slices and refered to as NSLICE.</p>
d463 1
a463 1
    .ENTER DIMS NSAM,NROW: 128,128  ;Size of output image
d468 3
a470 3
expressed as NSAM, NROW. This corresponds to the size of the image
in pixels: NSAM = the number of sampling points, or vertical
columns (i.e., the width of the image); NROW = the number of
d472 1
a472 1
image of dimensions NSAM = 40, NROW = 50 corresponds to a rectangle
d495 2
a496 2
By default, rotation is with respect to a center at (NSAM/2 + 1,
NROW/2 + 1). Rotation angles can be positive or negative: the
d569 1
a569 1
a picture counter-clockwise around the center (NSAM/2 + 1, NROW/2 +
d615 1
a615 1
    .ENTER DIMS NSAM,NROW: 110,110  ;Size of windowed area
d623 1
a623 1
    .ENTER DIMS NSAM,NROW: 110,110  ;Size of windowed area
d662 1
a662 1
    .ENTER DIMS NSAM,NROW: 150,150  ;Size of final image
d712 1
a712 1
through the point ((INT(NSAM/2) + 1, INT(NROW/2) + 1).<br>
d949 1
a949 1
    .ENTER DIMS NSAM,NROW: 200,200;Size of output image
d1330 1
a1330 1
    .ENTER DIMS, NSAM,NROW: 225,225 ;Dimensions of padded image
d1417 1
a1417 1
    .ENTER DIMS NSAM,NROW: 120,120 ;Size of windowed area
d1426 1
a1426 1
    .ENTER DIMS NSAM,NROW: 120,120 ;Size of windowed area
d1477 1
a1477 1
    .ENTER DIMS (NSAM,NROW): 128,128 ;Size of image
d1507 1
a1507 1
    .ENTER DIMS NSAM,NROW: 30,30  ;Dimensions of file
d1654 1
a1654 1
((INT(NSAM/2)+1, INT(NROW/2)+1, INT(NSLICE/2)+1). The related
d1996 1
a1996 1
         ; position at the picture's center (NSAM/2+1, NROW/2+1)
d2043 1
a2043 1
    .ENTER DIMS NSAM,NROW: 75,75  ; Dimensions of image: 75x75 pixels
@


1.17
log
@named variables used.
@
text
@a3 1
   <meta name="generator" content="HTML Tidy, see www.w3.org">
d242 1
a242 1
of the SPIDER image processing software program. Each command is
d249 1
a249 1
parameters within each command, use the 
d288 1
a288 1
of commands: these are called "procedure files". In the above
d290 1
a290 1
seeks to reconstruct the 80S ribosome-Sec61 complex.  If commands to
d293 1
a293 1
file, and will be understood as a request to execute commands
d303 1
a303 1
it expects one of the commands listed in the SPIDER manual defining
d316 1
a316 1
beginning of the SPIDER session. This command starts the WEB
d339 1
a339 1
are very few commands that operate on 1D data, thus they will not
d349 2
a350 2
2D imagaes. In section 5 all commands introduced so far are
reviewed for suitability in three dimensions and if a given command
d375 1
a375 1
    .OPERATION: MA                ;Use the MA command
d413 1
a413 1
    .OPERATION: MA                ;Use the MA command
d459 1
a459 1
    .OPERATION: IP                  ;Use the IP command
d500 1
a500 1
<p>During the course of an alignment procedure, the 'RT' command
d507 1
a507 1
    .OPERATION: RT                ;Use the RT command
d541 1
a541 1
    .OPERATION: SH                ;Use the SH command
d575 1
a575 1
    .OPERATION: RT SQ             ;Use the RT SQ command
d612 1
a612 1
    .OPERATION: WI                  ;Use the WI command
d620 1
a620 1
    .OPERATION: WI                  ;Use the WI command
d646 1
a646 1
command.</center>
d659 1
a659 1
    .OPERATION: PD                  ;Use the PD command
d696 1
a696 1
    .OPERATION: MR                ;Use the MR command
d733 1
a733 1
    .OPERATION: BC                  ;Use the BC command
d766 1
a766 1
    .OPERATION: CE                ;Use the CE command
d808 3
a810 3
delineating edges detected in the image. This is similar to the <a
href="man/fc.html">'FC'</a> (file
contour) command, except that the contours represent lines of steep
d815 1
a815 1
    .OPERATION: ED                ;Use the ED command
d871 1
a871 1
    .OPERATION: AS R                 ;Use the AS command
d894 1
a894 1
irrelevant. In this case command <a href=
d930 1
a930 1
E'</a> command allows the user to specify both the base density and
d934 1
a934 1
command may be used to make the image definitely positive by adding
d946 1
a946 1
    .OPERATION: IP                ;Use the IP command
d951 1
a951 1
    .OPERATION: FC                ;Use the FC command
d989 1
a989 1
by pixel, using this command. To end the subtraction series, place
d996 1
a996 1
    .OPERATION: SU            ; Use the SU command
d1028 1
a1028 1
command.</p>
d1033 1
a1033 1
    .OPERATION: MU            ; Use the MU command
d1063 1
a1063 1
    .OPERATION: SQ            ;Use the SQ command
d1083 1
a1083 1
<p>The 'CC N' command computes the normalized cross-correlation
d1131 1
a1131 1
<p>The 'AC' command computes the autocorrelation function of a
d1146 1
a1146 1
    .OPERATION: AC        ;Autocorrelation command
d1182 1
a1182 1
    .OPERATION: MA                ;Mask command 
d1225 2
a1226 2
<p>The first command illustrated in this section will be the
montage command. It is not normally needed for Fourier operations,
d1233 1
a1233 1
command not only arranges the images in a gallery, but also scales
d1246 1
a1246 1
    .OPERATION: MN S             ;Use the MN S command
d1288 1
a1288 1
"man/pw.html">'PW'</a> command (see
d1317 1
a1317 1
    .OPERATION: FT              ;Use the FT command
d1339 1
a1339 1
    .OPERATION: FT              ;Use the FT command
d1351 1
a1351 1
command is used.</p>
d1355 1
a1355 1
<p>'PW' is a companion command to 'FT': it allows the visual
d1382 1
a1382 1
    .OPERATION: PW            ;Use the PW command
d1410 1
a1410 1
<a href="man/wi.html">"WI"</a> command to window
d1414 1
a1414 1
    .OPERATION: WI                 ;Use the WI command
d1423 1
a1423 1
    .OPERATION: WI                 ;Use the WI command
d1466 1
a1466 1
<p><i>Note that another example for the use of this command is
d1469 1
a1469 1
'MO' command. The image was specified to be of random densities,
d1475 1
a1475 1
    .OPERATION: Mo               ;Use the MO command
d1500 1
a1500 1
following commands: 'IN' and 'PA'.</p>
d1505 1
a1505 1
    .OPERATION: BL            ;Use the BL command
d1538 1
a1538 1
    .OPERATION: IN            ;Use the IN command
d1579 1
a1579 1
    .OPERATION: PA                ;Use the PA command 
d1612 1
a1612 1
    .OPERATION: TH                ;Use the TH command 
d1655 1
a1655 1
command <a href="man/rt3a.html">'RT
d1753 1
a1753 1
created using <a href="man/mo3.html">MO 3</a> command.</p>
d1782 1
a1782 1
commands along with answers to the queries are stored in command
d1799 1
a1799 1
command stream to be processed sequentially by SPIDER. It is good
d1802 1
a1802 1
extention of this and other command files should be three
d1808 1
a1808 1
comment lines are started with ';'. To keep your command files
d1819 1
a1819 1
of the 'IP' and 'RT' commands. We create a file named
d1840 1
a1840 1
command.</i></p>
d1843 2
a1844 2
operation prompt. SPIDER then accepts its commands from the file
'IPRT.SEC' until it encounters the 'EN' command. After execution of
d1882 1
a1882 1
<p><i>We may wish to apply above command file to a whole series of
d1943 1
a1943 1
<p><i>The sequence of commands in the procedure file can be
d1959 2
a1960 2
variables could be specified in an output position of a command. For example,
the peak search command <a href="man/pk.html">'PK'</a>:</p>
d2033 1
a2033 1
command<br>
d2041 1
a2041 1
    .OPERATION: MO                ; Use the MO command
@


1.16
log
@corrected typo for rotation convention
@
text
@d4 2
a5 2
<meta name="generator" content="HTML Tidy, see www.w3.org">
<title>Tutorial: SPIDER Image Manipulation</title>
d7 1
d9 2
a10 4
<center>
<h2><a name="user_guider">Tutorial: SPIDER Image
Manipulation</a></h2>
</center>
d13 1
d15 1
a16 1

a17 1

d19 1
a19 4

<center>Laboratory of Computational Biology and Molecular
Imaging</center>

a20 1

d32 1
a32 2
<dt><b><a href="#start1">1. STARTING THE SPIDER
SESSION</a></b></dt>
d34 1
a34 2
<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#start1.1">1.1 Starting
SPIDER</a></b></dt>
d47 1
a47 1
Masking Command</a></b></dt>
d50 1
a50 1
Interpolation Command</a></b></dt>
d53 1
a53 1
Rotate Command</a></b></dt>
d56 1
a56 1
Command</a></b></dt>
d59 1
a59 1
Command</a></b></dt>
d62 1
a62 1
Windowing Command</a></b></dt>
d65 1
a65 1
Padding Command</a></b></dt>
d68 1
a68 1
Mirroring Command</a></b></dt>
d71 1
a71 1
Box-Convolution Command</a></b></dt>
d74 1
a74 1
Contrast Enhancement Command</a></b></dt>
d77 1
a77 1
Edge Detection Command</a></b></dt>
d80 1
a80 1
Average + Variance Command</a></b></dt>
d83 1
a83 1
File Contour Command</a></b></dt>
d86 1
a86 1
Subtract-Images Command</a></b></dt>
d89 1
a89 1
Multiply-Images Command</a></b></dt>
d92 1
a92 1
Square-Image Command</a></b></dt>
d95 1
a95 1
Cross-Correlation Command</a></b></dt>
d98 1
a98 1
Autocorrelation Command</a></b></dt>
d103 1
a103 1
Command With Scaling Option</a></b></dt>
d106 1
a106 1
Transform Command</a></b></dt>
d109 1
a109 1
Spectrum Command</a></b></dt>
d115 1
a115 1
Modelling Command</a></b></dt>
d118 1
a118 1
Create-Blank Command</a></b></dt>
d121 1
a121 1
Command</a></b></dt>
d124 1
a124 1
Command</a></b></dt>
d127 1
a127 1
Threshold Command</a></b></dt>
d224 1
a224 1
<dt><b><tt>&nbsp;&nbsp;</tt> <a href="#procedure6.6">6.6 Registers,
d250 2
a251 3
parameters within each command, use the <a href=
"../../../usr1/spider/docs/operations_doc.html">"Manual of Spider
Operations"</a>.<br>
d253 1
d255 4
a258 6
<hr>
<br>
 1. <a name="start1">STARTING THE SPIDER SESSION</a><br>
<br>
 1.1 <a name="start1.1">Starting SPIDER</a><br>
<br>
d260 1
a260 1
window and type "SPIDER". A Welcome notice appears which defines
d269 1
a269 1
"SEC/80S" IS case sensitive.]</i></p>
d291 1
a291 1
seeks to reconstruct the 80S ribosome-Sec61 complex. If commands to
d321 1
a321 1
operations of <a href="../../../usr1/web/docs/web.html">WEB</a> in
d361 2
a362 2
"../../../usr1/spider/docs/man/ma.html">'MA'</a> --The Masking
Command<br>
d444 2
a445 2
"../../../usr1/spider/docs/man/ip.html">'IP'</a>--The Interpolation
Command<br>
d487 1
a487 1
"../../../usr1/spider/docs/man/fp.html">'FP'</a> is recommended.
d492 2
a493 2
"../../../usr1/spider/docs/man/rt.html">'RT'</a>--The Rotate
Command<br>
d527 1
a527 2
background value (by <a href=
"../../../usr1/spider/docs/man/rtb.html">'RT B'</a>).<br>
d529 1
a529 3
 2.4 <a name="processing2.4" href=
"../../../usr1/spider/docs/man/sh.html">'SH'</a>--The Shift
Command<br>
d549 1
a549 2
<i>NOTE: <a href="../../../usr1/spider/docs/man/shf.html">'SH
F'</a> option allows non-integer shift vectors to be
d554 1
a554 2
<center><img width="128" height="128" src="./img/shf001.gif"> <img
width="128" height="128" src="./img/shf002.gif"></center>
d564 1
a564 2
<p>2.5 <a name="processing2.5" href=
"../../../usr1/spider/docs/man/rtsq.html">'RT SQ'</a>-- Rotate -
d596 1
a596 3
 2.6 <a name="processing2.6" href=
"../../../usr1/spider/docs/man/wi.html">'WI'</a>--The Windowing
Command<br>
d606 1
a606 1
"../../../usr1/spider/docs/man/ft.html">'FT'</a> manual for
d650 1
a650 3
 2.7 <a name="processing2.7" href=
"../../../usr1/spider/docs/man/pd.html">'PD'</a>--The Padding
Command<br>
d687 1
a687 3
 2.8 <a name="processing2.8" href=
"../../../usr1/spider/docs/man/mr.html">'MR'</a>--The Mirroring
Command<br>
d715 1
a715 3
 2.9 <a name="processing2.9" href=
"../../../usr1/spider/docs/man/bc.html">'BC'</a>--The
Box-Convolution Command<br>
d745 1
a745 1
width="128" height="128" src="./img/box002.gif"></center>
d753 1
d755 2
a756 3
 2.10 <a name="processing2.10" href=
"../../../usr1/spider/docs/man/ce.html">'CE'</a>--The Contrast
Enhancement Command<br>
d806 1
a806 3
 2.11 <a name="processing2.11" href=
"../../../usr1/spider/docs/man/ed.html">'ED'</a>--The Edge
Detection Command<br>
d810 1
a810 1
href="../../../usr1/spider/docs/man/fc.html">'FC'</a> (file
d849 1
a849 3
 2.12 <a name="processing2.12" href=
"../../../usr1/spider/docs/man/asr.html">'AS R'</a>--The Average +
Variance Command<br>
d896 1
a896 1
"../../../usr1/spider/docs/man/as.html">'AS'</a> can be used. It
d924 2
a925 3
 2.13 <a name="processing2.13" href=
"../../../usr1/spider/docs/man/fc.html">'FC'</a>--The File Contour
Command<br>
d930 1
a930 1
program. The <a href="../../../usr1/spider/docs/man/fce.html">'FC
d934 1
a934 1
The <a href="../../../usr1/spider/docs/man/ar.html">'AR'</a>
d987 1
a987 3
 2.14 <a name="processing2.14" href=
"../../../usr1/spider/docs/man/su.html">'SU'</a>--The
Subtract-Images Command<br>
d997 8
a1004 8
    .OPERATION: SU            ;Use the SU command
    .INPUT  FILE: CON001          ;Name of image from which other 
                      ;image will be subtracted
    .SUBTRACTED FILE: CON002      ;Name of image to be subtracted
    .OUTPUT FILE: SUB001      ;output file
    .SUBTRACTED FILE: *       ;Terminates solicitation
                      ;of additional images
                      ;to be subtracted
d1020 1
a1020 3
 2.15 <a name="processing2.15" href=
"../../../usr1/spider/docs/man/mu.html">'MU'</a>--The
Multiply-Images Command<br>
d1034 7
a1040 7
    .OPERATION: MU            ;Use the MU command
    .INPUT FILE: CON001           ;Name of first image
    .MULTIPLIER  FILE: CON002     ;Name of second image
    .OUTPUT FILE: MUL001      ;output file
    .MULTIPLIER FILE: *           ;Terminates solicitation
                      ;of additional images
                      ;to be multiplied
d1053 1
a1053 3
 2.16 <a name="processing2.16" href=
"../../../usr1/spider/docs/man/sq.html">'SQ'</a>--The Square-Image
Command<br>
d1080 1
a1080 3
 2.17 <a name="processing2.17" href=
"../../../usr1/spider/docs/man/cc.html">'CC N'</a>--The
Cross-Correlation Command<br>
d1088 1
a1088 1
"../../../usr1/spider/docs/man/ft.html">'FT'</a> for
d1130 1
a1130 3
 2.18 <a name="processing2.18" href=
"../../../usr1/spider/docs/man/ac.html">'AC'</a>--The
Autocorrelation Command<br>
d1174 1
a1174 1
"../../../usr1/spider/docs/man/thm.html">'TH M'</a> operation and
d1176 2
a1177 2
"../../../usr1/spider/docs/man/th.html">'TH'</a> and <a href=
"../../../usr1/spider/docs/man/mm.html">'MM'</a>.]</p>
d1230 1
a1230 3
3.1 <a name="fourier3.1" href=
"../../../usr1/spider/docs/man/mns.html">'MN S'</a>--The Montage
Command With Scaling Option<br>
d1282 1
a1282 3
 3.2 <a name="fourier3.2" href=
"../../../usr1/spider/docs/man/ft.html">'FT'</a>--The Fourier
Transform Command<br>
d1289 1
a1289 1
"../../../usr1/spider/docs/man/pw.html">'PW'</a> command (see
d1354 1
a1354 3
3.3 <a name="fourier3.3" href=
"../../../usr1/spider/docs/man/pw.html">'PW'</a>--The Power
Spectrum Command<br>
d1410 2
a1411 2
<p>To see the result clearly, you can use the <a href=
"../../../usr1/spider/docs/man/wi.html">"WI"</a> command to window
d1463 1
a1463 3
 4.1 <a name="creating4.1" href=
"../../../usr1/spider/docs/man/mo.html">'MO'</a>--The Modelling
Command<br>
d1496 1
a1496 3
 4.2 <a name="creating4.2" href=
"../../../usr1/spider/docs/man/bl.html">'BL'</a>--The Create-Blank
Command<br>
d1521 1
a1521 3
4.3 <a name="creating4.3" href=
"../../../usr1/spider/docs/man/in.html">'IN'</a>--The Insert
Command<br>
d1559 1
a1559 3
 4.4 <a name="creating4.4" href=
"../../../usr1/spider/docs/man/pa.html">'PA'</a>--The Patch
Command<br>
d1601 1
a1601 3
4.5 <a name="creating4.5" href=
"../../../usr1/spider/docs/man/th.html">'TH'</a>--The Threshold
Command<br>
d1643 1
a1643 2
<p>5.1 <a name="processing5.1" href=
"../../../usr1/spider/docs/man/ma.html">MA</a></p>
d1647 1
a1647 2
<p>5.2 <a name="processing5.2" href=
"../../../usr1/spider/docs/man/ip.html">IP</a></p>
d1651 1
a1651 2
<p>5.3 <a name="processing5.3" href=
"../../../usr1/spider/docs/man/rt3d.html">RT 3D</a></p>
d1656 1
a1656 1
command <a href="../../../usr1/spider/docs/man/rt3a.html">'RT
d1661 1
a1661 2
<p>5.4 <a name="processing5.4" href=
"../../../usr1/spider/docs/man/sh.html">SH</a></p>
d1665 1
a1665 2
<p>5.5 <a name="processing5.5" href=
"../../../usr1/spider/docs/man/wi.html">WI</a></p>
d1669 1
a1669 2
<p>5.6 <a name="processing5.6" href=
"../../../usr1/spider/docs/man/pd.html">PD</a></p>
d1673 1
a1673 2
<p>5.7 <a name="processing5.7" href=
"../../../usr1/spider/docs/man/mr.html">MR</a></p>
d1677 1
a1677 2
<p>5.8 <a name="processing5.8" href=
"../../../usr1/spider/docs/man/bc.html">BC</a></p>
d1681 1
a1681 2
<p>5.9 <a name="processing5.9" href=
"../../../usr1/spider/docs/man/ce.html">CE</a></p>
d1685 1
a1685 2
<p>5.10 <a name="processing5.10" href=
"../../../usr1/spider/docs/man/ed.html">ED</a></p>
d1689 1
a1689 2
<p>5.11 <a name="processing5.11" href=
"../../../usr1/spider/docs/man/asr.html">AS R</a></p>
d1693 1
a1693 2
<p>5.12 <a name="processing5.12" href=
"../../../usr1/spider/docs/man/fc.html">FC</a></p>
d1697 1
a1697 2
<p>5.13 <a name="processing5.13" href=
"../../../usr1/spider/docs/man/su.html">SU</a></p>
d1701 1
a1701 2
<p>5.14 <a name="processing5.14" href=
"../../../usr1/spider/docs/man/mu.html">MU</a></p>
d1705 1
a1705 2
<p>5.15 <a name="processing5.15" href=
"../../../usr1/spider/docs/man/sq.html">SQ</a></p>
d1709 1
a1709 2
<p>5.16 <a name="processing5.16" href=
"../../../usr1/spider/docs/man/ccn.html">CC N</a></p>
d1713 1
a1713 2
<p>5.17 <a name="processing5.17" href=
"../../../usr1/spider/docs/man/al.html">AL</a></p>
d1717 1
a1717 2
<p>5.18 <a name="processing5.18" href=
"../../../usr1/spider/docs/man/mns.html">MN S</a></p>
d1721 1
a1721 2
<p>5.19 <a name="processing5.19" href=
"../../../usr1/spider/docs/man/ft.html">FT</a></p>
d1725 1
a1725 2
<p>5.20 <a name="processing5.20" href=
"../../../usr1/spider/docs/man/pw.html">PW</a></p>
d1729 1
a1729 2
<p>5.21 <a name="processing5.21" href=
"../../../usr1/spider/docs/man/mo3.html">MO 3</a></p>
d1751 1
a1751 2
<p>5.22 <a name="processing5.22" href=
"../../../usr1/spider/docs/man/bl.html">BL</a></p>
d1754 1
a1754 2
created using <a href="../../../usr1/spider/docs/man/mo3.html">MO
3</a> command.</p>
d1756 1
a1756 2
<p>5.23 <a name="processing5.23" href=
"../../../usr1/spider/docs/man/in.html">IN</a></p>
d1760 1
a1760 2
<p>5.24 <a name="processing5.24" href=
"../../../usr1/spider/docs/man/pa.html">PA</a></p>
d1764 1
a1764 2
<p>5.25 <a name="processing5.25" href=
"../../../usr1/spider/docs/man/th.html">TH</a></p>
d1770 1
a1770 1
6. <a name="procedure6">PROCEDURE MODE OF PROCESSING</a> 
d1773 2
a1774 4
"../../../usr1/spider/docs/user_doc.html#procedure">Procedure</a>
versus <a href=
"../../../usr1/spider/docs/user_doc.html#interactive">Interactive</a>
Sessions</p>
d1791 4
a1794 5
so far: <a href=
"../../../usr1/spider/docs/man/do.html">DO-LOOP</a>s, computed <a
href="../../../usr1/spider/docs/man/goto.html">GOTO</a>s,
registers, arithmetic expressions, run-time construction of file
names, document files, and symbolic parameters.</p>
d1840 1
a1840 1
the <a href="../../../usr1/spider/docs/man/en.html">'EN'</a>
d1877 1
a1877 1
href="../../../usr1/spider/docs/user_doc.html#file_inline">user
d1890 9
a1898 9
    DO LB1 X10=2,10
    IP
    SAM{***X10}
    _1
    (128,128)
    RT
    _1
    ROT{***X10}
    (130.)
d1905 3
a1907 3
of two lines, 'DO LB1 X10=2,10' and 'LB1'. In addition, the file
names, both for input and output, now use a running index
'I'.</i></p>
d1909 1
a1909 1
<p><i>The lines 'DO LB1 X10=2,10' and 'LB1' demarcate a segment of
d1911 1
a1911 1
values 2-10 successively to the index 'I'. Since index I appears in
d1921 1
a1921 2
output file of operation <a href=
"../../../usr1/spider/docs/man/ip.html">'IP'</a> are the same
d1927 1
a1927 1
    DO LB1 X10=2,10
d1929 7
a1935 7
    SAM{***X10}
    _1
    (128,128)
    RT
    _1
    ROT{***X10}
    130.,10.,-30.,45.,15.,-8.5,34.,46.,170.
d1941 1
a1941 2
<p><i>6.6 <a name="procedure6.6" href=
"../../../usr1/spider/docs/user_doc.html#registers">Registers</a>,
d1948 1
a1948 20
operations that bring out the program character even more.<br>
</i></p>

<p><i>Registers are reserved places in memory that can be used to
store numbers. They are represented by the character 'X' followed
by a number between 0 an 99. There are different ways to fill a
register:<br>
</i></p>

<pre>
       X10=5
</pre>

would mean "store the number 5 in register #10". Alternatively,
registers could be in an output position of a command. For example,
the peak search command <a href=
"../../../usr1/spider/docs/man/pk.html">'PK'</a>:<br>
<pre>
       PK X20,X21,X22
</pre>
d1950 23
a1972 7
will locate the position of a peak in the cross-correlation
function given as input and store its value and its x- and y-
components in X20, X21 and X22, respectively. Another way to assign
a value to a register will become clear in the next subsection. The
numbers stored in the registers will remain available throughout
the session, or until overwritten.<br>
<br>
d1974 1
a1974 2

<p>How are registers used? They can be used anywhere in operations
d1979 6
a1984 7
the shift vector components to be used in a subsequent <a href=
"../../../usr1/spider/docs/man/sh.html">'SH'</a> operation would be
12, -8.</p>

<p>Now if the values -12, 8 were stored in X20, X21, as a result of
the 'PK X20,X21, X22' operation described above, then the input to
the 'SH' operation would be X20, -X21. <i>Thus, registers can be
d1993 1
a1993 1
    PK X20,X21,X22
d1995 3
a1997 4
    1,0     
    ;the first number is the number of peaks to be
    ;searched for, the second number means: use the default origin 
        ;position at the picture's center (NSAM/2+1, NROW/2+1)
d2001 1
a2001 1
    -X20,-X21
a2013 1

a2015 1
 
a2020 1
 
d2033 1
a2033 1
<a href="../../../usr1/spider/docs/man/mo.html">'MO'</a>--The MODEL
d2042 4
a2045 6
    .OPERATION: MO            ;Use the MO command
    .OUTPUT FILE: SAM001          ;"Sample image #1"
    .ENTER DIMS NSAM,NROW: 75,75  ;Dimensions of image:
                      ;75x75 pixels
    .(T)(S)(C)(W)(R)(G): T        ;Generate test sine
                      ;wave image
d2049 2
a2050 2
below, you may proceed with the beginning of the SPIDER
Tutorial.<br>
d2052 1
a2052 2
<center><img width="75" height="75" src=
"./img/sam001.gif"></center>
@


1.15
log
@xhtml
@
text
@d508 1
a508 1
the negative direction is counterclockwise.</p>
@


1.14
log
@HDR
@
text
@d1 1
a2 1

d4 2
a5 1
<title> Tutorial: SPIDER Image Manipulation</title>
d7 5
a12 3
<body   background ="bgpink.gif"  vlink ="#ff000">

<center><h2><a name="user_guider">Tutorial: SPIDER Image Manipulation</h2></center>
d15 8
a23 4
<center>by Louis M. Miranda, Yiwei Chen</center>
<center> and</center>
<center> Joachim Frank</center>
<center>Laboratory of Computational Biology and Molecular Imaging</center>
d25 1
d27 1
d31 240
a270 93
<p>
 <dt><B><a href="#introduction">INTRODUCTION</a>
 <dt><a href="#start1">1. STARTING THE SPIDER SESSION</a>
 <dt><tt>&nbsp&nbsp</tt><a href="#start1.1">1.1 Starting SPIDER</a>
 <dt><tt>&nbsp&nbsp</tt><a href="#start1.2">1.2 Looking at Images with WEB</a>
 <dt><tt>&nbsp&nbsp</tt><a href="#start1.3">1.3 Two-dimensional (2D) and three-dimensional (3D) images in SPIDER</a>
 <dt><a href="#processing2">2. PROCESSING PREVIOUSLY CREATED IMAGES</a>
 <dt><tt>&nbsp&nbsp</tt><a href="#processing2.1">2.1 The Masking Command</a>
 <dt><tt>&nbsp&nbsp</tt><a href="#processing2.2">2.2 The  Interpolation Command</a>
 <dt><tt>&nbsp&nbsp</tt><a href="#processing2.3">2.3 The  Rotate Command</a>
 <dt><tt>&nbsp&nbsp</tt><a href="#processing2.4">2.4 The Shift Command</a>
 <dt><tt>&nbsp&nbsp</tt><a href="#processing2.5">2.5 The RT SQ Command</a>
 <dt><tt>&nbsp&nbsp</tt><a href="#processing2.6">2.6 The Windowing Command</a>
 <dt><tt>&nbsp&nbsp</tt><a href="#processing2.7">2.7 The Padding Command</a>
 <dt><tt>&nbsp&nbsp</tt><a href="#processing2.8">2.8 The  Mirroring Command</a>
 <dt><tt>&nbsp&nbsp</tt><a href="#processing2.9">2.9 The Box-Convolution Command</a>
 <dt><tt>&nbsp&nbsp</tt><a href="#processing2.10">2.10 The Contrast Enhancement Command</a>
 <dt><tt>&nbsp&nbsp</tt><a href="#processing2.11">2.11 The Edge Detection Command</a>
 <dt><tt>&nbsp&nbsp</tt><a href="#processing2.12">2.12 The Average + Variance Command</a>
 <dt><tt>&nbsp&nbsp</tt><a href="#processing2.13">2.13 The File Contour Command</a>
 <dt><tt>&nbsp&nbsp</tt><a href="#processing2.14">2.14 The Subtract-Images Command</a>
 <dt><tt>&nbsp&nbsp</tt><a href="#processing2.15">2.15 The  Multiply-Images Command</a>
 <dt><tt>&nbsp&nbsp</tt><a href="#processing2.16">2.16 The Square-Image Command</a>
 <dt><tt>&nbsp&nbsp</tt><a href="#processing2.17">2.17 The  Cross-Correlation Command</a>
 <dt><tt>&nbsp&nbsp</tt><a href="#processing2.18">2.18 The Autocorrelation Command</a>
 <dt><a href="#fourier3">3. THE FOURIER TRANSFORM</a>
 <dt><tt>&nbsp&nbsp</tt><a href="#fourier3.1">3.1 The Montage Command With Scaling Option </a>
 <dt><tt>&nbsp&nbsp</tt><a href="#fourier3.2">3.2 The Fourier Transform Command </a>
 <dt><tt>&nbsp&nbsp</tt><a href="#fourier3.3">3.3 The Power Spectrum Command</a>
 <dt><a href="#creating4">4. CREATING AND EDITING IMAGES</a>
 <dt><tt>&nbsp&nbsp</tt><a href="#creating4.1">4.1 The Modelling Command</a>
 <dt><tt>&nbsp&nbsp</tt><a href="#creating4.2">4.2 The Create-Blank Command</a>
 <dt><tt>&nbsp&nbsp</tt><a href="#creating4.3">4.3 The Insert Command</a>
 <dt><tt>&nbsp&nbsp</tt><a href="#creating4.4">4.4 The Patch Command </a>
 <dt><tt>&nbsp&nbsp</tt><a href="#creating4.5">4.5 The Threshold Command</a>
 <dt><a href="#processing5">5.  PROCESSING OF 3D DATA</a>
 <dt><tt>&nbsp&nbsp</tt><a href="#processing5.1">5.1  MA</a>
 <dt><tt>&nbsp&nbsp</tt><a href="#processing5.2">5.2  IP</a>
<dt><tt>&nbsp&nbsp</tt><a href="#processing5.3">5.3  RT 3D</a>
 <dt><tt>&nbsp&nbsp</tt><a href="#processing5.4">5.4  SH</a>
 <dt><tt>&nbsp&nbsp</tt><a href="#processing5.5">5.5  WI</a>
 <dt><tt>&nbsp&nbsp</tt><a href="#processing5.6">5.6  PD</a>
 <dt><tt>&nbsp&nbsp</tt><a href="#processing5.7">5.7  MR</a>
 <dt><tt>&nbsp&nbsp</tt><a href="#processing5.8">5.8  BC</a>
 <dt><tt>&nbsp&nbsp</tt><a href="#processing5.9">5.9  CE</a>
 <dt><tt>&nbsp&nbsp</tt><a href="#processing5.10">5.10  ED</a>
 <dt><tt>&nbsp&nbsp</tt><a href="#processing5.11">5.11  AS R</a>
 <dt><tt>&nbsp&nbsp</tt><a href="#processing5.12">5.12  FC</a>
 <dt><tt>&nbsp&nbsp</tt><a href="#processing5.13">5.13  SU</a>
 <dt><tt>&nbsp&nbsp</tt><a href="#processing5.14">5.14  MU</a>
 <dt><tt>&nbsp&nbsp</tt><a href="#processing5.15">5.15  SQ</a>
 <dt><tt>&nbsp&nbsp</tt><a href="#processing5.16">5.16  CC N</a>
 <dt><tt>&nbsp&nbsp</tt><a href="#processing5.17">5.17  AL</a>
<dt><tt>&nbsp&nbsp</tt><a href="#processing5.18">5.18 MN S</a>
 <dt><tt>&nbsp&nbsp</tt><a href="#processing5.19">5.19  FT</a>
 <dt><tt>&nbsp&nbsp</tt><a href="#processing5.20">5.20  PW</a>
 <dt><tt>&nbsp&nbsp</tt><a href="#processing5.21">5.21  MO 3</a>
 <dt><tt>&nbsp&nbsp</tt><a href="#processing5.22">5.22  BL</a>
<dt><tt>&nbsp&nbsp</tt><a href="#processing5.23">5.23 IN</a>
<dt><tt>&nbsp&nbsp</tt><a href="#processing5.24">5.24 PA</a>
<dt><tt>&nbsp&nbsp</tt><a href="#processing5.25">5.25 TH</a>
<dt><a href="#procedure6">6.   PROCEDURE MODE OF PROCESSING</a>
<dt><tt>&nbsp&nbsp</tt><a href="#procedure6.1">6.1 Procedure versus Interactive Sessions</a>
<dt><tt>&nbsp&nbsp</tt><a href="#procedure6.2">6.2  How to Create a Procedure File</a>
<dt><tt>&nbsp&nbsp</tt><a href="#procedure6.3">6.3  Preparing and Running a Simple Procedure File</a>
<dt><tt>&nbsp&nbsp</tt><a href="#procedure6.4">6.4  Use of Temporary In-core Files</a>
<dt><tt>&nbsp&nbsp</tt><a href="#procedure6.5">6.5  DO-LOOPS and Run-time Designation of File Names </a>
<dt><tt>&nbsp&nbsp</tt><a href="#procedure6.6">6.6  Registers, Arithmetic Expressions, and Computed Goto Statements </a>
<dt><a href="#appendix">APPENDIX </B></a>
<hr><p>
       <center> <a name="introduction">INTRODUCTION</a></center><br>
<p> 
 Welcome to the  SPIDER  Tutorial.   The  following
 pages will take you on a   brief self-guided  tour  of  the
 image-manipulating abilities of the SPIDER image  processing
 software program.  Each command is documented here with both
 a step-by-step procedure and the images  produced
 by  it.   By  creating  the  image that is documented in the
  <a href="#appendix"> Appendix</a>, you can start  right  away--no 
 other  images  are necessary for most operations documented here.</p>

     For more information on  the  specific options and  choices of parameters
 within each  command,  use  the <a href="../../../usr1/spider/docs/operations_doc.html">
 "Manual of Spider Operations"</a>.<br>

<hr><br>
 1. <a name="start1">STARTING THE SPIDER SESSION</a><br><br>
 
1.1<a name="start1.1"> Starting SPIDER</a><br><br>
<p>
SPIDER is a command-driven program.  To start a session, open a window
and type "SPIDER".  A Welcome notice appears which defines the
exact version and release of the program you are running. Next,
d273 1
a273 17
.PROJECT/DATA CODE: SEC/80S
<p><i>
[Please note that the query by the computer is always preceded by
a period, so that it's easily distinguished from other messages.
The interpretation of 
the user response, in this case "SEC/80S" IS case sensitive.]</p></i>

<p>The codes are used to define the files that will be accessible by
the program in this session.  The DATA CODE is a three-letter
sequence that will be the assumed default extension of image
files (or document files, i.e., files containing lists of important
numbers to be "transported" from one operation to another).  These
may either be input files, or newly created output files.  
For example, an existing file named RAW004.80S can be referred to
in above session as "RAW004".  If the user types "WIN004" in response
to the question "OUTPUT FILE:", then a file named "WIN004.80S"
will be created.</p>
d275 16
d292 13
a304 14
the initial training session.  It will have no importance until
you come to Section 6.  For the time being,
just enter the data code only -- the project code will be the 
same by default.]</p>

<p>Similarly, the PROJECT CODE is a three-letter sequence that will be
used as default extension of files that define an entire batch of
commands: these are called "procedure files".
In the above example, "SEC" might be a mnemonic referring to a project
that seeks to reconstruct the 80S ribosome-Sec61 complex.  If
commands to perform two-dimensional alignment are stored in a
file named "ALIGN.SEC", then simply typing "@@ALIGN" will refer
to the desired file, and will be understood as a request to 
execute commands stored there.</p>
d307 8
a314 8
"DATA CODE" and "PROJECT CODE": at any ".OPERATION:" prompt,
just type "NC" (for "New Codes"), and the program will
come back to the initial prompt ".ENTER PROJECT/DATA CODE:".]</i></p>

<p>After the DATA CODE (and the PROJECT CODE) have been entered, 
the system comes back with the standard prompt ".OPERATION:".
Here it expects one of the commands listed in the SPIDER manual
defining image processing operations.</p>
d316 3
a318 1
1.2 <a name="start1.2">Looking at the Image with WEB</a><br><br>
d321 1
a321 1
images.  For this purpose, you open another window on your terminal.
d323 4
a326 4
way that you can see them both without obstruction.  Now start
WEB for the particular image data you want to view by typing 
"web 80s &", i.e., "web" followed by the DATA CODE defined at the
beginning of the SPIDER session.  This command starts the WEB
d328 35
a362 41
using self-explanatory point-and-click operations.  However, a
help function is also available to explain the more complex interactive
operations of <a href="../../../usr1/web/docs/web.html">WEB</a> in detail.</p>


<center><IMG WIDTH=75 HEIGHT=75  SRC="./img/sam001.gif">
<IMG WIDTH=75 HEIGHT=75  SRC="./img/sam002.gif"></center>
<center><tt>SAM001 &nbsp; SAM002</tt></center><br>

    FIGURE 1.  The original images (dimensions 75X75) to  be  manipulated.   SAM001
  (left)  was  created  from  the  example  procedure  in  the
  Appendix.  SAM002 (right) is an image  of  the 70S ribosome
  from  <i>E. coli</i> obtained by cryo-electron microscopy. You may 
  substitute it by your own image.<br><p>
                                                                 
1.3 <a name="start1.3">Two-dimensional (2D) and three-dimensional (3D) images in SPIDER</a></p>
<p>SPIDER can operate on both 2D and 3D images. The file formats permits 
creation of one-dimensional (1D) images as well, but there are very few
commands that operate on 1D data, thus they will not be discussed in
this tutorial. A 2D image is defined by its x,y dimensions. x, the width
of the image, is stored as the number of sampling points and is always
refered to as NSAM. y, the height of the image, is stored as the number
of horizontal rows and is refered to as NROW. A 3D image can be thought of as
a stack of 2D images (or slices), and the 2 dimension is stored as the
number of slices and refered to as NSLICE.</p>
<p> 
Section 2, 3 and 4 of this tutorial are devoted to processing of 2D
imagaes. In section 5 all commands introduced so far are reviewed for 
suitability in three dimensions and if a given command has a different 
meaning or a different version for 3D data, it is decribed in more details.</p>
<p><a href="#user_guider">(Back to the front  page)</a></p>
<p>
  2. <a name="processing2">PROCESSING PREVIOUSLY CREATED IMAGES</a><br><br>


 2.1 <a name="processing2.1"  href="../../../usr1/spider/docs/man/ma.html">'MA' </a>--The Masking Command<br><br>
<p>
    Masking allows superfluous information in the image, normally at 
  the periphery, to be  deleted.  'MA' applies a circular mask,
  but there is also an option that allows an arbitrary shape to be used 
  as mask.</p>
d364 16
d388 1
a388 1
    .OUTER &INNER RADII: 25,0     ;Radii, in pixels, 
d394 1
a394 1
     OR (E)XTERNAL: P		  ;Type of background
d401 16
a416 7
<p> The preceding procedure will create  the  masked  image
  seen  in  figure 2a.  Note the soft transition created by the 
Gaussian falloff.</p>
<center><IMG WIDTH=75 HEIGHT=75  SRC="./img/mas002.gif">
</center>
<center>MAS002</center><br>
  <center> FIGURE 2a.  Result of external masking operation.</center><br>
d419 1
d426 1
a426 1
    .OUTER &INNER RADII: 0,25     ;Radii, in pixels, 
d432 1
a432 1
     OR (E)XTERNAL: P		  ;Type of background
d438 26
a463 4
<center><IMG WIDTH=75 HEIGHT=75  SRC="./img/min002.gif">
</center>
<center>MIN002</center><br>
  <center> FIGURE 2b.  Result of internal masking operation.</center><br>
a464 9
<p>
   2.2 <a name="processing2.2" href="../../../usr1/spider/docs/man/ip.html">'IP'</a>--The Interpolation Command<br><br>
<p>
      An image can be enlarged  or  reduced  for  clarity  of
 display by interpolating it onto a grid with different dimensions.
 For this Guide, the two sample images were enlarged so that 
 the  processing  performed  on them  would  be  seen more clearly.
 'IP' is especially  useful for enlarged display of images that
 result from averaging.</p>
d476 11
a486 18
    [Here, DIMS refers to the dimensions of the image which
  are expressed as NSAM, NROW.  This corresponds to the size of
  the image in pixels:  NSAM = the number of sampling  points,
  or  vertical columns (i.e.,  the width of the image);  NROW =
  the number of horizontal  rows  (i.e.,   the  height  of  the
  image).   For  example,  an  image  of  dimensions  NSAM = 40,
  NROW = 50 corresponds to a rectangle with a width of 40 and  a
  height of 50.]<br><br>
<center><IMG WIDTH=128 HEIGHT=128  SRC="./img/int001.gif">
<IMG WIDTH=128 HEIGHT=128  SRC="./img/int002.gif"></center>
<center><tt>INT001 &nbsp;  &nbsp; &nbsp; &nbsp; INT002</tt></center><br>
 FIGURE 3.  The original 75X75 pixel  images shown in Fig. 1 have 
 been  enlarged. When the images are enlarged by a non-integer ratio,
 as in this example, partial loss of information will occur. When the image
 size is reduced, some information will be always  lost. For an integer 
 enlargement of images, operation <a href="../../../usr1/spider/docs/man/fp.html">'FP'</a>
 is recommended. INT002 was computed from 
 SAM002, the same way as INT001 was from SAM001.<br><br>
d488 1
d490 23
a513 12
   2.3 <a name="processing2.3" href="../../../usr1/spider/docs/man/rt.html">'RT'</a>--The Rotate Command<br><br>
<p>
     This operation allows the image to  be  rotated  within
 the  frame. By default, rotation is with respect to a center at 
(NSAM/2 + 1, NROW/2 +  1).   Rotation  angles  can  be  positive 
 or negative: the  positive direction is considered counterclockwise,
 by convention;  the negative direction is counterclockwise.</p>
<p>
    During the course of an alignment procedure,  the  'RT'
  command  will  utilize  the  rotation angles obtained by 
  orientation search to rotate the particles into alignment
  with  the  reference.</p>
d524 3
a526 11
<center><IMG WIDTH=128 HEIGHT=128  SRC="./img/rot001.gif">
<IMG WIDTH=128 HEIGHT=128  SRC="./img/rot002.gif"></center>
<center><tt>ROT001 &nbsp;  &nbsp; &nbsp; &nbsp; ROT002
</tt></center><br>
  FIGURE 4.  Rotated images.  Note that a "new" background  is
  automatically created  to replace the voids in the four corners 
  created by rotating the image. That background will
  have a value equal to the mean of all pixels of the unrotated 
  image. However, note that there is also an option that allows 
  you to specify the background value (by 
<a href="../../../usr1/spider/docs/man/rtb.html">'RT B'</a>).<br><br>
d528 1
d530 19
d550 2
a551 10
 2.4 <a name="processing2.4" href="../../../usr1/spider/docs/man/sh.html">'SH'</a>--The Shift Command<br><br>
<p>
  The image is shifted with respect to the frame of reference.
  The amount and direction of shift is specified by the x and 
  y components of the shift vector.
  Shift vector  components  can  be  either  positive  or
  negative.   According  to  the coordinate system convention,
  the origin is at the upper left, so positive x-direction  is  to
  the right, positive y-direction is down.</p>
          <pre>                                                    
d560 27
a586 2
     <i>NOTE: <a href="../../../usr1/spider/docs/man/shf.html">'SH F'</a> option allows non-integer  shift  vectors
  to be applied.</i><br><br>
a587 12
<center><IMG WIDTH=128 HEIGHT=128  SRC="./img/shf001.gif">
<IMG WIDTH=128 HEIGHT=128  SRC="./img/shf002.gif"></center>
<center><tt>SHF001 &nbsp;  &nbsp; &nbsp; &nbsp; SHF002
</tt></center><br>
  FIGURE 5a.  Shifted Images.  Notice that shifted  image  data
 "wrap around" to the opposite sides of the image.<br><br>

<p>2.5  <a name="processing2.5" href="../../../usr1/spider/docs/man/rtsq.html">'RT SQ'</a>--
Rotate - image or volume, Shift, use Quadratic interpolation<br><br>
<p>Changes the scale, rotates and shifts image circularly. Rotates a 
 picture counter-clockwise around the center (NSAM/2 + 1, NROW/2 + 1). 
 (Negative angles = clockwise).</p>
d598 30
a627 23
<center><IMG WIDTH=128 HEIGHT=128  SRC="./img/rst001.gif"><tt>
&nbsp;  </tt>
<IMG WIDTH=128 HEIGHT=128  SRC="./img/rst002.gif"></center>
<center><tt>RST001 &nbsp;  &nbsp; &nbsp; &nbsp; RST002
</tt></center><br>
  FIGURE 5b.  The result of 'RT SQ' operation. Notice that the difference 
  between the 'RT SQ' operation and the 'RT', 'SH' operations is that in the image
  resulting from the 'RT SQ' operation no "new" background is created.<br><br>


 2.6 <a name="processing2.6" href="../../../usr1/spider/docs/man/wi.html">'WI'</a>--The Windowing Command<br><br>
<p>
    Images  may have to  be  windowed (i.e., a portion cut out)
   at  several  stages  of   an investigation:   the  particle 
   of interest is windowed from  a  large  field;
   once masked and aligned, it could  again be  windowed  to
   save  computer  storage  space;   or  a large image may have
   to be windowed to a size appropriate for certain operations. 
   For example, Fourier operations use a mixed-radix algorithm,
   and dimensions that involve large prime numbers may present a problem
   (see <a href="../../../usr1/spider/docs/man/ft.html">'FT'</a> manual 
   for details).</p>
          <pre>                                              
d643 1
a643 1
				    ;in the old image where 
d647 5
a651 2
      <i>NOTE: The top left corner of an image has  coordinates  1,1 
  (not 0,0 !) by convention.<br><br></i>
d653 3
a655 7
    <center><IMG WIDTH=110 HEIGHT=110  SRC="./img/win001.gif"><tt>
&nbsp;  </tt>
<IMG WIDTH=110 HEIGHT=110  SRC="./img/win002.gif"></center>
  <center><tt>WIN001 &nbsp&nbsp&nbsp&nbsp&nbsp&nbspWIN002
</tt></center><br>      
  <center> FIGURE 6.  Result obtained by application of the 'WI' command.
</center><br>
d657 2
d660 15
a675 6
  2.7 <a name="processing2.7" href="../../../usr1/spider/docs/man/pd.html">'PD'</a>--The Padding Command<br><br>
<p>
      Padding an image places the image into a  larger  field
  of  user-specified dimensions and background.  This would be
  useful, for example, in preparing the image for cross correlation
  with another image, so as to avoid wrap-around overlaps.</p>
d688 26
a713 20
    </pre>
<center><IMG WIDTH=150 HEIGHT=150  SRC="./img/pad001.gif">
<IMG WIDTH=150 HEIGHT=150 SRC="./img/pad002.gif"></center>
<center><tt>PAD001 &nbsp;  &nbsp; &nbsp; &nbsp; PAD002
</tt></center><br>
   FIGURE 7.  Here, padding has been used to produce  an  image
 twice the size of the original.  By placing the average of the windowed
  area into the  region  around  it,  we  have  minimized  the
  density  step  at  the  border.   This  choice of background
  prevents artifacts from occurring in the  Fourier  transform
  of the padded image. (By answering 'N' to the question "average (Y/N)"
  you would indicate that you wish to supply the background value
  yourself -- in that case a solicitation for that value would follow.)<br><br>

  2.8 <a name="processing2.8" href="../../../usr1/spider/docs/man/mr.html">'MR'</a>--The Mirroring Command<br><br>
<p>
      By this operation, a mirror-image of the input  image  is
 created.   The  image is reflected across the  vertical line
 or the horizontal line  running through the image center at (75,75).
This might be  useful if the handedness is not certain.</p>
d723 5
a727 8
  </pre>
<center><IMG WIDTH=150 HEIGHT=150  SRC="./img/mir001.gif">
<IMG WIDTH=150 HEIGHT=150  SRC="./img/mir002.gif"></center>
<center><tt>MIR001 &nbsp;  &nbsp; &nbsp; &nbsp; MIR002
</tt></center><br>
 FIGURE 8.  This picture is simply a mirror-reflection of the
  previous picture with respect to a line parallel to Y running
  through the point ((INT(NSAM/2) + 1, INT(NROW/2) + 1).<br><br>
d729 1
d731 22
a753 17
 2.9 <a name="processing2.9" href="../../../usr1/spider/docs/man/bc.html">'BC'</a>--The Box-Convolution Command<br><br>
<p>
   Central to the box convolution operation is an algorithm that
replaces the value of each pixel by the average of a small 
rectangular area around it. If the 'L' (low-pass filtering)
option is chosen, 'BC' results in an image that is a mixture
between the box-convolved image and the original image. If the 
'H' option is chosen, 'BC' subtracts the box-convolved image 
from the original image. The resulting image is a high-pass 
filtered version of the input image. It can again be mixed
with the input image.  </p>

<p>   
 The filter weight is used to specify the proportion  of
  the filtered to the unfiltered image to be mixed to form the
  output image.  Filter weight = 1 means output  is  the  pure
  filtered image.</p>
d764 1
a764 1
    .FILTER WEIGHT (0.0-&gt1.0): 1    ;Mixing factor
a765 7
 <center>
<IMG WIDTH=128 HEIGHT=128  SRC="./img/box001.gif">
<IMG WIDTH=128 HEIGHT=128  SRC="./img/box002.gif"></center>
<center><tt>BOX001 &nbsp;  &nbsp; &nbsp; &nbsp BOX002</tt></center><br>
 FIGURE 9.  Note the fuzziness of the image.  Fine detail and
  surrounding noise are suppressed,  but  the particle stands up
  better from the background.<br><br>
d767 2
d770 1
d772 14
a785 8
  2.10 <a name="processing2.10" href="../../../usr1/spider/docs/man/ce.html">'CE'</a>--The Contrast Enhancement Command<br><br>
<p>
    'CE' operates by stretching the density  variations  on
  the  basis  of the image histogram.  Hence, this operation can 
  be used to enhance the overall contrast, by sacrificing the exact 
  representation of features whose densities are in the top or 
  bottom range. The output image will always be in the range 0...2.
  </p>
d794 1
a794 1
      (L)OCAL? (S/H/L): S   	  ;Choice of contrast				  
d809 1
a809 1
				  ;image is to be computed
d812 2
a813 13
   </pre>
<center><IMG WIDTH=128 HEIGHT=128  SRC="./img/con001.gif">
<IMG WIDTH=128 HEIGHT=128  SRC="./img/con002.gif"></center>
<center><tt>CON001 &nbsp;  &nbsp; &nbsp; &nbsp; CON002
</tt></center><br>
 FIGURE 10.  While Box Convolution was seen to be  effective,
  a  much more dramatic effect was achieved here with contrast
   enhancement.  The particle stands out  definitively  against
  the  background,  albeit with a complete loss of information
  in the areas affected by the density truncation.  Note,  for
  instance,  that  the fringe surrounding the particle (which is caused
  by the contrast transfer function of the elecetron microscope) has
   become uniformly black.<br><br>
d815 2
d818 1
d820 18
a837 7
2.11 <a name="processing2.11" href="../../../usr1/spider/docs/man/ed.html">'ED'</a>--The Edge Detection Command<br><br>

     This operation will create a file containing only lines
  delineating edges detected in the image.  This is similar
  to the <a href="../../../usr1/spider/docs/man/fc.html">'FC'</a> (file contour) command, except that the contours
  represent lines of steep density changes, not lines of equal
   density.<br>
d844 1
a844 1
				  ;applied
d854 3
a856 3
     NOTE:  Type of filter  varies  with  different  images,
    depending   on  the  S/N  (signal-to-noise)  ratio  and  the
    crowdedness of edges:<br><pre>
d863 21
a883 7
<center><IMG WIDTH=128 HEIGHT=128  SRC="./img/edg001.gif">
<IMG WIDTH=128 HEIGHT=128  SRC="./img/edg002.gif"></center>
<center><tt>EDG001 &nbsp;  &nbsp; &nbsp; &nbsp; EDG002
</tt></center><br>
FIGURE 11.  Compare this to the input images CON001 and CON002 
  in  Figure  10. Lines along which  the  density  gradient  is 
  steepest are computed by the program.<br><br>
d885 7
d893 2
a895 20
 2.12 <a name="processing2.12" href="../../../usr1/spider/docs/man/asr.html">'AS R'</a>--The Average + Variance Command<br><br>
<p>
  'AS R' computes the average image and variance image from two or
 more original images.   The variance image shows the areas where
 pixels vary strongest among the image set.  This is useful in 
 determining how uniform the particles are, and how  significant 
 certain ultrastructural features are that show up in the average 
 image.</p>
<p>
    It is important to remember that all of the files  must
  begin  with the same file series name, e.g.  SAM001, SAM002,
 ..., SAM009, SAM010.  Also, even though the name of the first 
 image  is given  after  the  prompt  ".FIRST  FILE:",  it must 
 also be included as part of the file numbers given in answer to
 ".ENTER  FILE NUMBERS:",  otherwise it will be skipped in the 
 computation of average and variance images.</p>
<p>
  In the following example the set of images used  is  from  an  experiment 
  in which 70S ribosomes are visualized.</p>
  
d908 2
a909 1
<p><i>
d911 20
d932 2
a933 31
     NOTE: <p> 
  (1) If the average file already exists, then the
  system  will  assume  that you want to add the current image
  set to this file, and will ask  for  the  number  of  images
  already summed.  </p> 
 <p>(2) If the ODD-EVEN option is selected, two average images and 
  corresponding variance images are created, one for the odd-numbered, 
  one for the even-numbered files. This option is used for resolution
  tests where two independent averages are compared.</p>
  <p>(3) For negatively stained data the mean of images is irrelevant. In
  this case command <a href="../../../usr1/spider/docs/man/as.html">'AS'</a>
  can be used. It subtracts the mean from every image in the input series before 
  calculation of the average map. Thus the average map produced by 'AS' 
  will have a zero mean.</p>
  <p>If 'AS' is applied to images with relevant average the resulting 
  variance map will be incorrect (the variance values will be too small).</i></p>

<center><IMG WIDTH=675 HEIGHT=90  SRC="./img/ser002.gif">
</center><br>
<center><IMG WIDTH=75 HEIGHT=75  SRC="./img/avg002.gif">
<IMG WIDTH=75 HEIGHT=75  SRC="./img/var002.gif"></center>
<center><tt>AVG002 &nbsp; VAR002
</tt></center><br>
    FIGURE 12.  Average image and Variance  map  resulting  from
  averaging the 9 images in the top row.   The  average image
  (left)  has considerably less detail than any of its constituent
  images, but  it  is  more  representative  of a "typical"
  particle.  The variance image (right) shows specks of high 
  variance within the area of  the particle. These may indicate regions
  most strongly affected by the variation in projection direction, or 
  actual changes in molecular conformation.<br><br>
d935 3
d939 1
d941 29
a969 18
  2.13 <a name="processing2.13" href="../../../usr1/spider/docs/man/fc.html">'FC'</a>--The File Contour Command<br><br>
<p>
  Contouring  an  image  creates  isolines  at   discrete
 density  values  within  an image.  These are generated with  a
 user-specified  number  of  levels.  The   actual
 contouring levels  used  are  generated  by the program.  The 
 <a href="../../../usr1/spider/docs/man/fce.html">'FC E'</a>
 command allows the user to specify both the base density and
 the  density  increment  between  successive  contour lines.
 Note that for 'FC E', contouring does NOT occur at densities
 less  than  zero.  The <a href="../../../usr1/spider/docs/man/ar.html">'AR'</a> 
 command may be used to make the image definitely positive  by 
 adding a  constant  to each pixel (see the SPIDER documentation 
 for more information).</p>
<p>
  As a preparation for 'FC', the image must be expanded since
  the contour lines occupy entire pixels. Otherwise the contours
  will look  very ragged.</p>
d994 14
a1007 15
<p><i>  
   NOTE:  
<p>(1) Rule of thumb: for the image expansion by 'IP', use  a  
factor  of  3  to  4,  depending  on  the complexity  of  
features.</p>  
<p>(2) In the simple 'FC' operation, the points of 
highest and lowest density are both counted as contour  levels.
In the above example, only 2 contour lines are visible even 
though 4 was specified as the number.  The pixels at either extreme of  
the  density  range  show up as single "contour points".</i></p>
<center><IMG WIDTH=200 HEIGHT=200 SRC="./img/fic002.gif"></center>
<center>FIC002</center><br>
FIGURE 13.  A contoured image.  This operation is especially
useful for the display of average  images.<br>
<br>
d1009 1
d1011 12
a1022 6
2.14 <a name="processing2.14" href="../../../usr1/spider/docs/man/su.html">'SU'</a>--The Subtract-Images Command<br><br>
<p>
     One or more images may be subtracted  from  an  initial
image pixel by pixel,  using  this  command.  
To  end  the  subtraction  series,  place an asterisk (*) in
response to the recurring prompt ".SUBTRACTED FILE:" .</p>
d1027 1
a1027 1
    .OPERATION: SU   		  ;Use the SU command
d1029 1
a1029 1
         			  ;image will be subtracted
d1031 13
a1043 8
    .OUTPUT FILE: SUB001	  ;output file
    .SUBTRACTED FILE: *   	  ;Terminates solicitation
         			  ;of additional images
         			  ;to be subtracted
</pre>
<center><IMG WIDTH=128 HEIGHT=128  SRC="./img/sub001.gif"></center>
<center>SUB001</center><br>
FIGURE 14. The image CON002 was  subtracted  pixel-by-pixel from
d1045 1
a1045 1
might be the average of particles labeled with a small ligand, the 
d1047 15
a1061 13
positive difference would show the position of the ligand molecule.<br><br>
      
2.15 <a name="processing2.15" href="../../../usr1/spider/docs/man/mu.html">'MU'</a>--The Multiply-Images Command<br><br>
<p>
     The image created by 'MU' has each pixel from one image
multiplied   by  the  corresponding  pixel  from  the  other
image(s).  Thus, the resultant image appears very similar to
one  image where the pixels have a value of 1 in the other
image.</p>
<p>
     A whole series of images can  be  multiplied  together;
the '*' inserted after the ".MULTIPLIER FILE:" prompt ends the MU
command.  </p>
d1066 1
a1066 1
    .OPERATION: MU    		  ;Use the MU command
d1069 5
a1073 18
    .OUTPUT FILE: MUL001	  ;output file
    .MULTIPLIER FILE: *       	  ;Terminates solicitation
         			  ;of additional images
         			  ;to be multiplied
</pre>
<center><IMG WIDTH=128 HEIGHT=128  SRC="./img/mul001.gif"></center>
<center>MUL001</center><br>
FIGURE 15. Result of Multiplying images.  Note the extreme  effect  of
multiplying  where  the density in one image is very low ("absolute veto 
effect").<br><br>
         
2.16 <a name="processing2.16" href="../../../usr1/spider/docs/man/sq.html">'SQ'</a>--The Square-Image Command<br><br>
<p>
     This operation mathematically squares the value  of  each
pixel  in  the  image,  and has a non-linear contrast-enhancing effect
areas with high density (white in our display) are enhanced, those 
with low density (dark) remain unchanged and those with medium
density (grey) are pushed more toward low density.</p>
d1075 20
d1096 1
a1096 1
 		  EXAMPLE:  Squaring Images
d1098 1
a1098 1
    .OPERATION: SQ    		  ;Use the SQ command
d1102 39
a1140 30
<center><IMG WIDTH=128 HEIGHT=128  SRC="./img/con002.gif">
<IMG WIDTH=128 HEIGHT=128  SRC="./img/sqr002.gif"></center>
<center><tt>CON002 &nbsp;  &nbsp; &nbsp; &nbsp; &nbsp; SQR001</tt></center><br>
FIGURE 16.  The contrast is selectively increased  when  the
file  is  squared;  small density variations are accentuated
when they occur in the high density range.<br><br>

2.17 <a name="processing2.17" href="../../../usr1/spider/docs/man/cc.html">'CC N'</a>--The  Cross-Correlation Command<br><br>

<p>The 'CC N' command computes the normalized cross-correlation 
function of two pictures by using the Fourier-transform relationship. 
The dimensions of the two pictures must be the same; however, the dimensions
need not be powers of two (see <a href="../../../usr1/spider/docs/man/ft.html">'FT'</a> 
for restrictions).</p>
<p> 
 The CCF is a measure of the degree of  match  (integrated  
cross-product)  of  two  images as a function of their relative 
translation.  For  example,  when two squares are superimposed, 
they match perfectly.  As they are moved farther and farther 
apart, in any  direction,  the degree  of match decreases.  
Their  cross-correlation  will  vary continuously and its value will 
depend on the distance, and the direction in which they are separated.  The 
two images will be totally unmatched when no part of either 
square is superposed upon the other.</p>
<p>
In the example, we use two images of the ribosome, PAD002 (see Section 2.6)
and PAD003. The image PAD003 was created by padding the image SAM003 in 
to a (150,150) image using 50,30 as top left coordiates; i.e., shifted off 
the center by +12,-8. 
.</p>
d1145 1
a1145 1
    .OPERATION: CC N     	  ;Cross Correlation
d1148 1
a1148 1
				  ;which is used as the reference
d1150 30
a1179 26
  				  ;cross-correlation function
</pre>   
<center><IMG WIDTH=150 HEIGHT=150 SRC="./img/pad002.gif">
<IMG WIDTH=150 HEIGHT=150 SRC="./img/pad003.gif">
<IMG WIDTH=150 HEIGHT=150 SRC="./img/ccf002.gif">
</center>
<center><tt> PAD002 &nbsp; &nbsp;&nbsp;&nbsp;&nbsp; PAD003 &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;
 CCF002</tt></center><br>
FIGURE 17.  Display of cross-correlation function computed
in above example. The peak (indicating  highest correlation) is
seen to be shifted  by -12, +8, indicating the  relative shift 
of the input images. Note: The sign of shifts convention in section 6.6. <br><br>

 2.18 <a name="processing2.18" href="../../../usr1/spider/docs/man/ac.html">'AC'</a>--The Autocorrelation Command<br><br>
<p>
The 'AC' command computes the autocorrelation function of a 
picture by using the Fourier transform relationship. </p>
<p> 
     The ACF is simply defined as the CCF of an image  with
itself.   Thus, any inherent symmetry and internal structure
of a particle seen in an image will be reflected by its ACF.
The  ACF  pattern  is  independent  of  the  location of the
particle in the image;  therefore  it  allows  the  relative
orientation  of  particles to be found before their relative
shift is  accurately  known.   This,  in  fact,  is  how some
alignment  procedures are designed (see "Single Particle
d1181 1
d1185 1
a1185 1
    .OPERATION: AC 	  	  ;Autocorrelation command
d1187 32
a1218 27
    .OUTPUT FILE: ACF002	  ;the file which will contain 
			          ;the auto-correlation coefficients.
</pre>    
<center><IMG WIDTH=150 HEIGHT=150 SRC="./img/acf002.gif"></center>
<center>ACF002</center><br>
FIGURE 18.  Display of the autocorrelation function computed
in above example.   Values of high correlation are shown in 
white.  Due to the inherent peak in the center (that is due 
to the perfect match of an image with itself for zero shift),
contrast  is  noticeably  reduced,  and
features  of  the ACF relating to intramolecular vectors are
virtually invisible.<br><br>
<p> 
 Often, the center of the 
 ACF produced by 'AC' will be an extremely high-density area. 
 An  extreme  contrast situation such as this will obliterate 
 any  small  density  variations  elsewhere  in  the   image. 
 Masking the interior will remove these upper-extreme density 
 values,  concomitantly  mapping  the  much  smaller  density 
 variations  in  the  remaining  area  into  the full display 
 range, and thereby enhance the visual data in the  periphery 
 of the image. [Masks  with  arbitrary  shapes  can  be  created 
 by using the <a href="../../../usr1/spider/docs/man/thm.html">'TH M'</a> 
 operation and applied with the 'MM' operation, see manual chapters on
 <a href="../../../usr1/spider/docs/man/th.html">'TH'</a>
 and <a href="../../../usr1/spider/docs/man/mm.html">'MM'</a>.] </p>
<pre> 
d1224 2
a1225 2
    .OUTER & INNER RADII: 76,7    ;Radii the outer and inner 
				  ;mask circles, in pixels 
d1227 1
a1227 1
				  ;Type of mask edge: sharp
d1232 1
a1232 1
				  ;average after masking 
d1236 30
a1265 20
  </pre>
<center><IMG WIDTH=150 HEIGHT=150 SRC="./img/mai002.gif">
</center>
<center>MAI002</center><br>
FIGURE 19.  Here, by eliminating the peak at the origin, we have
made the important features of the antocorrelation function better 
visible. Compare to  Figure 18. <br><br>
 <p><a href="#user_guider">(Back to the front  page)</a></p><p>
3.<a name="fourier3">  THE FOURIER TRANSFORM</a><br><br>
<p>
     In this section, the Fourier transform will be introduced.
A comparison will  be  made  between  the
transforms  of 1) a montage of nine images, and 2) the
average of those images padded to the size of  that  montage.
This comparison will demonstrate the convolution theorem and
the origin of reflections formed in  the Fourier transform  of  
a  crystal lattice. </p>  
<p> 
     The first command illustrated in this section will be the  
montage command.   It is not normally needed for Fourier operations,
d1268 16
a1283 13
3.1 <a name="fourier3.1" href="../../../usr1/spider/docs/man/mns.html">'MN S'</a>--The Montage Command With Scaling Option<br><br>
<p>
Images of a series (i.e., whose names start with the same 
prefix) can be "bundled up" into a gallery, or montage. The  'MN  S'  
command  not  only arranges  the  images  in a gallery, but 
also scales them so that  they  will  all  be in the same density
range 0...2.  This  is particularly important for the display of  images  
of  widely  differing contrasts and offsets.</p>
<p>
     Montaging can be accomplished with no space between the
images, or  with a user-specified space between them.  The density
of this optional space can also be specified; but it should  be
between  0  and  2.</p>
d1287 1
a1287 1
    .OPERATION: MN S  			 ;Use the MN S command
d1289 1
a1289 1
         			         ;to be montaged
d1291 2
a1292 2
          				 ;file series to be 
        				 ;placed in montage
d1294 63
a1356 52
					 ;Number of images per
         				 ;horizontal row, size of
         				 ;optional margin space
    .ENTER MARGIN  VALUE: .1   	         ;value to be put in margins 
    .OUTPUT FILE: MON001          	 ;Name of montage created   
</pre>
<center><IMG WIDTH=225 HEIGHT=225  SRC="./img/mon001.gif"></center>
<center>MON001</center><br>
FIGURE 20a.  A montage of the  images  used  to  create  the
average  image  in Figure 12. In this case, no margin was specified
(0 pixels) in the 'MN S' operation.<br><br>
<center><IMG WIDTH=225 HEIGHT=225  SRC="./img/big002.gif"></center>
<center>BIG002</center><br>
 FIGURE 20b.  The average image (Fig.  12)  has  been  padded
here  to  the same size as the montage (Fig.  20a).  Figures
21a & b are the Fourier transforms of the images in Figures 20a  &  20b,
respectively, displayed as power spectra.<br><br>


 3.2 <a  name="fourier3.2" href="../../../usr1/spider/docs/man/ft.html">'FT'</a>--The Fourier Transform Command<br><br>
<p>
     The 'FT' operation uses  a  mathematical  expression
termed a Fourier series to create a representation of the
image in Fourier space.  This representation employs a series 
of sinusoidal waves characterized by their  amplitudes  and  
phases.   To  display  a  Fourier transform  in  pictorial  form,
the <a href="../../../usr1/spider/docs/man/pw.html">'PW'</a> command (see below) has
to  be  used:   this  extracts  the amplitudes  of  the transform 
and arranges them in their logical two-dimensional order 
according to their spatial frequencies (reciprocal wavelengths
in x- and y- direction). Note, however, that the phases of the 
Fourier transform are lost in this representation. </p>
<p>
   The  Fourier transform  operation  is  useful in  many  steps
of  image  processing.   When performed on a micrograph, the 'FT'
operation followed by 'PW' is equivalent to the use of an optical 
diffractometer  and so  can  yield information on the quality of
the micrograph. It is also  useful  in  elucidating  image  
symmetry  and presence of order in ultrastructural studies.  An 
image of a crystal with poor S/N ratio can be Fourier transformed, 
and the  Fourier  components representing the repeated structure
(reflections) can then  be  separately  back-transformed  to
generate a relatively noise-free image of the crystal.</p>
<p>
     In the demonstration examples  here,  two  images  are
Fourier  transformed:  the   montage  of  9 particles (Fig 20a), 
and a padded version of the  image created by averaging  those 9 
particles (Fig 20b). By making the padded image the same size(225,225)
as the montage,  a comparison  can  be made
 between the transform of the single (average) image and that of 
a "crystal" (the montage) formed by the images used in the 
averaging.</p>
d1360 1
a1360 1
    .OPERATION: FT    		  	;Use the FT command
d1362 2
a1363 2
         			  	;transformed
    .OUTPUT FILE: FOU001		;output file which will 
d1368 6
a1373 6
    .OPERATION: PD			;Pad image to make it
					;Fourier-transformable
    .INPUT  FILE: AVG002		;Image to be padded		
    .OUTPUT FILE: BIG002		;Padded image ready to
					;be transformed
    .ENTER DIMS, NSAM,NROW: 225,225	;Dimensions of padded image
d1376 1
a1376 1
    .ENTER TOP LEFT COOS: 76,76		;Coordinates of padded image 
d1382 1
a1382 1
    .OPERATION: FT   		  	;Use the FT command
d1384 2
a1385 2
         			  	;transformed
    .OUTPUT FILE: FOU002		;output file which will 
d1388 36
a1423 35
  <p><i>
   Note that the Fourier transform of an image is complex-valued,
so it cannot be represented  in real space. Therefore no image is
 displayed  here.</i></p>
<p>
To display the amplitudes of the Fourier transform, the 'PW' command 
is used.</p>
    
 3.3 <a name="fourier3.3" href="../../../usr1/spider/docs/man/pw.html">'PW'</a>--The Power Spectrum Command<br><br>
<p>
     'PW' is a companion command to  'FT':   it  allows  the
visual  display  of  the amplitudes in the Fourier transform of an image.  The
"power spectrum" is normally defined as the square of the amplitudes;
in SPIDER, 'PW' creates an image that contains the unsquared 
amplitudes.  The 'PW' operation can only be performed on Fourier 
data.</p>
<p>     
     In the following example, the  two  Fourier  transforms
generated  above  were  both subjected to the power spectrum
operation.  The two resulting power spectra (Figs.  21a,b) are
quite  different:   the  one relating to the single particle
image (Fig.  21b) is continuous, the  one  relating  to  the
montage  discontinuous.   In  the  latter case, the discrete
amplitudes are  seen  to  lie  on  a  square  grid.   Closer
inspection  shows  that  in these points, both power spectra
are in fact identical.</p>
<p>
     This phenomenon  can  be  explained  in  terms  of  the
convolution  theorem: apart from variations that can be regarded
as noise,  the montage is the convolution of the
averaged particle image with a square grid of single points.
Consequently,  its  Fourier  transform is the product of the
single-image Fourier transform (Fig.  21b) with the  Fourier
transform of the single-point lattice, which is again a 2D point
lattice (the "reciprocal lattice").</p>
d1427 1
a1427 1
    .OPERATION: PW   		  ;Use the PW command
d1431 5
a1435 5
    .OPERATION: MA   		  ;Inside mask is used in
          			  ;order to suppress the central
				  ;term  better and thus  
          			  ;visualize the  diffraction 
				  ;peaks
d1438 1
a1438 1
    .OUTER & INNER RADII:112,3    ;Radius of circular mask
d1440 1
a1440 1
				  ;Type of mask edge
d1442 2
a1443 2
         			  ;Put user-whose background
          			  ;value in  masked area
d1446 1
a1446 1
         			  ;center of the mask
a1452 4
<p>
To see the result clearly, you can use the 
<a href="../../../usr1/spider/docs/man/wi.html">"WI"</a>
command to window the central part of the power spectrum.</p> 
d1454 4
d1476 42
a1517 15
     
<center><IMG WIDTH=120 HEIGHT=120  SRC="./img/wma001.gif"></center>
 <center>WMA001</center><br>
FIGURE 21a.  WMA001--Central part of power spectrum of the montage in Fig 20a.  Note
the discontinuity   of   the  image,  compared  to  Figure  21b.
<br><br>
 <center><IMG WIDTH=120 HEIGHT=120  SRC="./img/wpo002.gif"></center>
<center>WPO002</center><br>
 FIGURE 21b.  WPO002--Central part of power spectrum of the Fourier-transformed
 padded average  image in Fig 20b.  Here the density variations are continuous,
yet agree exactly with those of Figure 21a in  the  discrete
lattice points ("reciprocal lattice").<br><br>
    
<p><a href="#user_guider">(Back to the front  page)</a></p><p>
4.<a name="creating4">  CREATING AND EDITING  IMAGES</a><br><br>
a1518 7
 4.1 <a name="creating4.1" href="../../../usr1/spider/docs/man/mo.html">'MO'</a>--The Modelling Command<br><br>
<p>
     <i>Note  that  another  example for the use  of  this  command 
is documented  in the Appendix.</i> <br>
 For the next series of images, a base image was created using the 
'MO' command.  The  image was specified to be of random densities,
 between 0 and 1.</p>
d1522 1
a1522 1
    .OPERATION: Mo    		     ;Use the MO command
d1527 24
a1550 16
         			     ;of pixel values; N results 
        			     ;in a uniform distribution
        			     ;between 0 and 1
</pre>
<center><IMG WIDTH=128 HEIGHT=128  SRC="./img/mod001.gif"></center>
<center>MOD001</center><br>
<center> FIGURE 22.  An image composed  of  completely  random  pixel
densities.</center><br>

 4.2 <a name="creating4.2" href="../../../usr1/spider/docs/man/bl.html">'BL'</a>--The Create-Blank Command<br><br>
<p>
     A blank image is an image with a background of  uniform
density.  There is no inter-pixel variation as there is with the 
random 'MO' image.  This particular  blank image was  created  to
demonstrate the following commands:  'IN' and 'PA'.</p>
    
d1554 1
a1554 1
    .OPERATION: BL    		  ;Use the BL command
d1557 25
a1581 21
             			  ;to be created
    .AVERAGE? (Y/N): N		  ;Type of background
        			  ;(Y allows average of
        			  ;another, specified
        			  ;image to be used)
    .BACKGROUND: .5  		  ;Background density,         			
</pre>
<p><i>
   Note:  Because  of  their  inherent  lack   of   any   density
variation,   blank  images  cannot  be  displayed; attempts to 
rescale it into the range 0...2 would result in division by 0.</p></i>

 4.3 <a name="creating4.3" href="../../../usr1/spider/docs/man/in.html">'IN'</a>--The Insert Command<br><br>
<p>
     One image can be inserted into another,  larger,  image
by  using 'IN'.  The smaller image simply takes the place of
the pixels in the larger image. </p>
<p><i>Note  that  the  new  image REPLACES  the  old  pixels--it 
is  not added to them, as in 'PA'.  Also, the final image with the 
insert  replaces  the original  image,  so if the original is to be 
saved, it must be copied first.</p></i>
d1585 1
a1585 1
    .OPERATION: CP   		  ;Copy large image
d1589 1
a1589 1
    .OPERATION: IN   		  ;Use the IN command
d1592 2
a1593 2
     				  ;Final image with the
          			  ;inserted blank
d1595 18
a1612 21
        			  ;image where blank is
       				  ;to be inserted   
 </pre>
<center><IMG WIDTH=128 HEIGHT=128  SRC="./img/ins001.gif"></center>
<center>INS001</center><br>
FIGURE 23.  A small blank image (upper left) inserted into a 
larger  image.   Note  its  homogeneity--the  pixels  of the 
inserted image replace those of the larger one.<br><br> 
 
4.4 <a name="creating4.4" href="../../../usr1/spider/docs/man/pa.html">'PA'</a>--The Patch Command <br><br>
 <p>
      Patching an image is similar to inserting an image,  in 
 that  a  smaller  picture  is placed into a larger one.  The 
 main difference, however, which is quite important, is  that 
 while 'IN' REPLACES the pixel-densities of the large picture 
 with the smaller one, 'PA' ADDS the pixel-densities of  both 
 images  together.   This can be clearly seen in PAT001 which 
 has an inserted image at the top left, and a  patched  image  at 
 the lower  right.   Again, the new image overwrites the old one, 
 and therefore it is a good idea to  copy  the  original  image  before 
 using it. </p>
d1614 12
a1625 1
 <pre>
d1635 1
a1635 1
            	 		  ;Image to receive patch 
d1640 17
a1656 13
<center><IMG WIDTH=128 HEIGHT=128  SRC="./img/pat001.gif"></center>
<center>PAT001</center><br> 
FIGURE 24.  The same small blank  image  (now  lower  right) 
 patched into a larger image. 
<p><i>
 Note that the pixels from both images  were  added,  resulting 
 in   a   lighter   overall appearance. </i></p>
 
  4.5 <a name="creating4.5" href="../../../usr1/spider/docs/man/th.html">'TH'</a>--The Threshold Command<br><br> 
 <p>
    An image that is subjected to the 'TH' operation has any densities
 beyond a  user-determined value set equal to the threshold.  Either  
 an upper or a lower boundary or both can be set. </p>
d1658 7
a1664 1
 <pre>
d1677 22
a1698 9
 </pre>
  
<center><IMG WIDTH=128 HEIGHT=128 SRC="./img/thr001.gif">
</center>
<center>THR001</center><br> 
<center> FIGURE 25.  The result of 'TH' operation.</center><br><br>    
<p><a href="#user_guider">(Back to the front  page)</a></p>
<p>
5. <a name="processing5">PROCESSING OF 3D DATA</a></p>
a1699 1
<p>5.1 <a  name="processing5.1" href="../../../usr1/spider/docs/man/ma.html">MA</a></p>
d1701 4
a1704 1
<p>5.2 <a  name="processing5.2" href="../../../usr1/spider/docs/man/ip.html">IP</a></p>
d1706 3
a1708 6
<p>5.3 <a name="processing5.3" href="../../../usr1/spider/docs/man/rt3d.html">RT 3D</a></p>
<p>This operation allows the volume to be rotated within the frame. By default,
rotation is with respect to a center at ((INT(NSAM/2)+1, INT(NROW/2)+1, 
INT(NSLICE/2)+1). The related command <a href="../../../usr1/spider/docs/man/rt3a.html">'RT 3A'</a>
allows rotation of  of a volume around an arbitrary center. The rotation is 
specicified by three <a href="euler.html">Euler angles</a>. </p>
d1710 11
a1720 1
<p>5.4 <a name="processing5.4" href="../../../usr1/spider/docs/man/sh.html">SH</a></p>
d1722 4
a1725 1
<p>5.5 <a name="processing5.5" href="../../../usr1/spider/docs/man/wi.html">WI</a></p>
d1727 4
a1730 1
<p>5.6 <a name="processing5.6" href="../../../usr1/spider/docs/man/pd.html">PD</a></p>
d1732 4
a1735 1
<p>5.7 <a name="processing5.7" href="../../../usr1/spider/docs/man/mr.html">MR</a></p>
d1737 4
a1740 1
<p>5.8 <a name="processing5.8" href="../../../usr1/spider/docs/man/bc.html">BC</a></p>
d1742 4
a1745 1
<p>5.9 <a name="processing5.9" href="../../../usr1/spider/docs/man/ce.html">CE</a></p>
d1747 4
a1750 1
<p>5.10 <a name="processing5.10" href="../../../usr1/spider/docs/man/ed.html">ED</a></p>
d1752 4
a1755 1
<p>5.11 <a name="processing5.11" href="../../../usr1/spider/docs/man/asr.html">AS R</a></p>
d1757 4
a1760 1
<p>5.12 <a name="processing5.12" href="../../../usr1/spider/docs/man/fc.html">FC</a></p>
d1762 4
a1765 1
<p>5.13 <a name="processing5.13" href="../../../usr1/spider/docs/man/su.html">SU</a></p>
d1767 4
a1770 1
<p>5.14 <a name="processing5.14" href="../../../usr1/spider/docs/man/mu.html">MU</a></p>
d1772 4
a1775 1
<p>5.15 <a name="processing5.15" href="../../../usr1/spider/docs/man/sq.html">SQ</a></p>
d1777 4
a1780 1
<p>5.16 <a name="processing5.16" href="../../../usr1/spider/docs/man/ccn.html">CC N</a></p>
d1782 4
a1785 1
<p>5.17 <a name="processing5.17" href="../../../usr1/spider/docs/man/al.html">AL</a></p>
d1787 4
a1790 1
<p>5.18 <a name="processing5.18" href="../../../usr1/spider/docs/man/mns.html">MN S</a></p>
d1792 4
a1795 1
<p>5.19 <a name="processing5.19" href="../../../usr1/spider/docs/man/ft.html">FT</a></p>
d1797 4
a1800 1
<p>5.20 <a name="processing5.20" href="../../../usr1/spider/docs/man/pw.html">PW</a></p>
d1802 4
a1805 1
<p>5.21 <a name="processing5.21" href="../../../usr1/spider/docs/man/mo3.html">MO 3</a></p>
d1807 3
a1809 1
<pre>.MENU: 
d1824 8
a1831 4
 </pre>
<p>5.22 <a name="processing5.22" href="../../../usr1/spider/docs/man/bl.html">BL</a></p>
<p>Operation does not work for 3D data, but a blank volume can be created using 
<a href="../../../usr1/spider/docs/man/mo3.html">MO 3</a> command.</p>
d1833 3
a1835 1
<p>5.23 <a name="processing5.23" href="../../../usr1/spider/docs/man/in.html">IN</a></p>
d1837 4
a1840 1
<p>5.24 <a name="processing5.24" href="../../../usr1/spider/docs/man/pa.html">PA</a></p>
d1842 4
a1845 1
<p>5.25 <a name="processing5.25" href="../../../usr1/spider/docs/man/th.html">TH</a></p>
d1848 198
a2045 164
<p><a href="#user_guider">(Back to the front  page)</a></p>
6.<a name="procedure6"> PROCEDURE MODE OF PROCESSING</a>
<p>
6.1 <a  name="procedure6.1" href="../../../usr1/spider/docs/user_doc.html#procedure">Procedure</a> versus 
<a href="../../../usr1/spider/docs/user_doc.html#interactive">Interactive</a> Sessions
<p>
In the interactive sesssion, you are able to verify the different processing
steps, try out choices of various parameters, and make sure all questions are 
answered.
<p>
For any large-scale project, however, many such steps are required, often to 
be repeated over a large number of image files. This is no longer practical 
in the interactive mode. Instead, commands along with answers to the queries
are stored in command files and submitted in the procedure mode of
processing.
<p>
A "procedure file" is flexible as it allows run-time replacements. In the
following section, we will provide  an introduction in writing both
procedure files. In the course of this introduction, many new
features will be covered that have no relevance or importance  in the
interactive mode of SPIDER covered so far: <a href="../../../usr1/spider/docs/man/do.html">DO-LOOP</a>s, 
computed <a href="../../../usr1/spider/docs/man/goto.html">GOTO</a>s,
registers, arithmetic expressions, run-time construction of file names,
document files, and symbolic parameters.</p>
<p>

6.2<a name="procedure6.2"> How to Create a Procedure File</a>
<p>
Choose a text editor and prepare a file that contains the command stream to 
be processed sequentially by SPIDER. It is good practice to choose a
filename that is descriptive; e.g. ALIGN for a procedure designed to align
an image set. Note that the file name extention of this and other
command files should be three characters; it is called PROJECT CODE, and
is set at the beginning of the SPIDER session. So a valid name would
be 'ALIGN.SEC' if 'SEC' is chosen as project code.</p>
<p><i>

The first lines may be used as comment line. In SPIDER, comment lines
are started with ';'. To keep your command files organized, put  the
file name, a short description  of its purpose  and the date of creation
into a comment line. (If necessary, you can continue with additional comment
lines, all started with ';'.)
<p>
6.3 <a name="procedure6.3">Preparing and Running  a Simple Procedure File</a>
<p>
In the first example, we combine the operations from two earlier
examples in the interactive session, illustrating the use of the 'IP'
and 'RT' commands. We create a file named 'IPRT.SEC'.</p>
<pre>
	;IPRT.SEC 1/5/98 interpolate and rotate
	IP
	SAM001
	INT001
	128,128
	RT
	INT001
 	ROT001
	130.
	EN
</pre>
<p>
This sequence is identical to the sequence of computer-solicited text
input in the combined examples in earlier sections 2.2 and 2.3, with the
exception of the comment line and the <a href="../../../usr1/spider/docs/man/en.html">'EN'</a> command.</p>
<p>
To execute the command file, simply type @@IPRT at the operation prompt.
SPIDER then accepts its commands from the file 'IPRT.SEC' until it
encounters the 'EN' command.
After execution of the procedure file, you will be able to verify that the
new files INT001 and ROT001 have been created, and that they are 
identical to those shown in Figs 3 and 4.</p>
<p>
6.4 <a name="procedure6.4">Use of Temporary In-core Files</a>
<p>
In the foregoing example, there may be only an interest in obtaining the
final output file, ROT001, while the "intermediate" file INT001 is
discarded. In that case, it is not necessary to create a file on disk
(which delays the processing because of the input/output operations
involved). Instead, a temporary area in menory can be used. Here is the
re-written procedure file, making use of the "file" mapped in the core
area 1:</p>
 <pre>
	;IPRT1.SEC 1/5/98 interpolate and rotate
	IP
	SAM001
	_1
	128,128
	RT
	_1
 	ROT001
	130.
	EN
</pre>
<p>
Ten such areas can be used simultaneouly (_1 through _10), but
there are some restrictions on their size. See the detailed 
<a href="../../../usr1/spider/docs/user_doc.html#file_inline">user documentation</a>.
<p>
6.5 <a name="procedure6.5">DO-LOOPS and Run-time Designation of File Names</a>
<p>
We may wish to  apply above command file to a whole series of images,
for example the series used before, SAM002, ..., SAM010. This is very
easy, and the appropriate procedure file may be created from 'IPRT.SEC' by 
editing:
<pre>
	;IPRT2.SEC 1/5/98 interpolate and rotate image series
	DO LB1 X10=2,10
	IP
	SAM{***X10}
	_1
	(128,128)
	RT
	_1
 	ROT{***X10}
	(130.)
	LB1
	EN
</pre>
<p>
The file differs from the file created before by the addition of two
lines, 'DO LB1 X10=2,10' and 'LB1'. In addition, the file names, both for
input and output, now use a running index 'I'.</p>
<p>
The lines 'DO LB1 X10=2,10' and 'LB1' demarcate a segment of the procedure
file that is supposed to be repeated, giving  the values 2-10
successively to the index 'I'. Since index I appears in two file names,
those file names are constructed with different numbers each time, from
SAM002 and ROT002 to SAM010 and ROT010.</p>
<p>
Another change you will notice is the parenthesis around the numbers
'128,128' and '130.'. This is a way of indicating "use the same values
each time round". Alternatively, different values could be given for 
each round, by giving the explicit list. In the following example, it is
assumed that the target dimensions of the output file of operation 
<a href="../../../usr1/spider/docs/man/ip.html">'IP'</a> are the same throughout, but
that the rotation angle is different for each image:</p>
<pre>
	;IPRT3.SEC 1/5/98 interpolate and rotate image series
	DO LB1 X10=2,10
	IP
	SAM{***X10}
	_1
	(128,128)
	RT
	_1
 	ROT{***X10}
	130.,10.,-30.,45.,15.,-8.5,34.,46.,170.
	LB1
	EN
</pre>
<p>
6.6 <a name="procedure6.6" href="../../../usr1/spider/docs/user_doc.html#registers">Registers</a>,
 Arithmetic Expressions, and Computed Goto Statements
<p>
The sequence of commands in the procedure file can be regarded as a
"program" whose elements are entire images. The DO-LOOP introduced in
the the previous section is a feature that reinforces this view. We now
come to additional elements and operations that bring out the program
character even more.<br>
<p><i>
Registers</i> are reserved places in memory that can be used to store
numbers. They are represented by the character 'X' followed by a number
between 0 an 99. There are different ways to fill a register:<br>
<pre>		X10=5</pre>
d2047 23
a2069 17
registers could be in an output position of a command. For example, the
peak search command <a href="../../../usr1/spider/docs/man/pk.html">'PK'</a>:<br>
<pre>		PK X20,X21,X22</pre>
will locate the position of a peak in the cross-correlation function
given as input and store its value and its x- and y- components in
X20, X21 and X22, respectively.
Another way to assign a value to a register will become clear in the next
subsection.
The numbers stored in the registers will remain available throughout the
session, or until overwritten.</p>
<p>
How are registers used? They can be used anywhere in operations
requiring numerical input. For example, when the cross-correlation peak
is found in the position -12, 8, it implies that the two images being
compared must be shifted relative to one another by the inverse of that
vector, to obtain optimum superimposition. Thus the shift vector
components to be used in a subsequent <a href="../../../usr1/spider/docs/man/sh.html">'SH'</a> operation would be
d2071 17
a2087 16
<p>
Now if the values -12, 8 were stored in X20, X21, as a result of the 'PK
X20,X21, X22' operation described above, then the input to the 'SH'
operation would be X20, -X21. <i>Thus, registers can be used in any position
where numerical input is expected.</i></p>
<p>
Here is the complete SPIDER "program" that performs peak search and
subsequent corrective shift by the amount necessary to bring two images
in superimposition. We start with the cross-correlation function
obtained in Section 2.16, CCF002:</p>
<pre>
	PK X20,X21,X22
	CCF002
 	1,0    	
	;the first number is the number of peaks to be
	;searched for, the second number means: use the default origin 
d2089 20
a2108 13
	SH
	PAD002
	SHI002
	-X20,-X21
</pre>
<p>
After execution of this little program, the image SHI002 is exactly
aligned with PAD003 (see Fig 26).<p>
<center><IMG WIDTH=150 HEIGHT=150  SRC="./img/shi002.gif">
<IMG WIDTH=150 HEIGHT=150  SRC="./img/pad003.gif"></center>
<center><tt>SHI002 &nbsp &nbsp PAD003</tt></center><br>
<center> FIGURE 26.  The result of the above program.</center><br><br>    
<p><a href="#user_guider">(Back to the front  page)</a></p>
d2110 2
d2114 5
a2118 1
    <center><a name="appendix">APPENDIX</a></center><br>
d2120 9
a2128 8
 This appendix is meant as a guide both to  create  test
images, for whatever reason, and to create sample images for
the SPIDER Tutorial  as  previously  described.   If  no
other  images are immediately available to you, it is a good
idea to create this image to use as a sample,  in  order  to
follow the stepwise instructions of the 
<a href="#user_guider">Tutorial</a>.<br>

d2130 3
a2132 6
<a href="../../../usr1/spider/docs/man/mo.html">'MO'</a>--The MODEL command<br>
<br>
     The following procedure will create a sample image, the
one seen at the beginning of the Tutorial.  It will be a
75X75 pixel image, composed of a diagonal sine wave with two
full periods.<br>
d2136 1
a2136 1
    .OPERATION: MO    		  ;Use the MO command
d2139 1
a2139 1
         			  ;75x75 pixels
d2141 1
a2141 1
         			  ;wave image
d2143 12
a2154 6
     After creating the above image, which  should  resemble
figure  1  below,  you may proceed with the beginning of the
SPIDER Tutorial.<br><br>
<center><img width="75" height="75"  src="./img/sam001.gif"></center>
<center>SAM001</center><br>
<center>FIGURE A1.  The resultant image after  following  the  above
a2155 1
<p><a href="#user_guider">(Back to the front  page)</a></p>
d2157 3
d2162 1
@


1.13
log
@cosmetic
@
text
@a7 1
<hdr>
a1606 1
<HDR>      
@


1.12
log
@euler link
@
text
@d1420 1
d1432 1
a1432 1
The first line may be used as comment line. In SPIDER, comment lines
d1435 1
a1435 1
into this line. (If necessary, you can continue with additional comment
@


1.11
log
@batch
@
text
@d1 94
a94 92
<HTML>
<HEAD>
<TITLE> Tutorial: SPIDER Image Manipulation</TITLE>
</HEAD>

<BODY   BACKGROUND ="bgpink.gif"  VLINK ="#ff000">
<HDR>

<CENTER><H2><A NAME="user_guider">Tutorial: SPIDER Image Manipulation</H2></CENTER>
<BR>
<HR>

<CENTER>by Louis M. Miranda, Yiwei Chen</CENTER>
<CENTER> and</CENTER>
<CENTER> Joachim Frank</CENTER>
<CENTER>Laboratory of Computational Biology and Molecular Imaging</CENTER>
<CENTER>Wadsworth Center</CENTER>
<CENTER>New York State Department of Health</CENTER>
<BR>
<HR>
<DL><P>
 <DT><B><A HREF="#introduction">INTRODUCTION</A>
 <DT><A HREF="#start1">1. STARTING THE SPIDER SESSION</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#start1.1">1.1 Starting SPIDER</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#start1.2">1.2 Looking at Images with WEB</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#start1.3">1.3 Two-dimensional (2D) and three-dimensional (3D) images in SPIDER</A>
 <DT><A HREF="#processing2">2. PROCESSING PREVIOUSLY CREATED IMAGES</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing2.1">2.1 The Masking Command</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing2.2">2.2 The  Interpolation Command</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing2.3">2.3 The  Rotate Command</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing2.4">2.4 The Shift Command</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing2.5">2.5 The RT SQ Command</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing2.6">2.6 The Windowing Command</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing2.7">2.7 The Padding Command</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing2.8">2.8 The  Mirroring Command</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing2.9">2.9 The Box-Convolution Command</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing2.10">2.10 The Contrast Enhancement Command</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing2.11">2.11 The Edge Detection Command</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing2.12">2.12 The Average + Variance Command</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing2.13">2.13 The File Contour Command</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing2.14">2.14 The Subtract-Images Command</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing2.15">2.15 The  Multiply-Images Command</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing2.16">2.16 The Square-Image Command</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing2.17">2.17 The  Cross-Correlation Command</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing2.18">2.18 The Autocorrelation Command</A>
 <DT><A HREF="#fourier3">3. THE FOURIER TRANSFORM</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#fourier3.1">3.1 The Montage Command With Scaling Option </A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#fourier3.2">3.2 The Fourier Transform Command </A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#fourier3.3">3.3 The Power Spectrum Command</A>
 <DT><A HREF="#creating4">4. CREATING AND EDITING IMAGES</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#creating4.1">4.1 The Modelling Command</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#creating4.2">4.2 The Create-Blank Command</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#creating4.3">4.3 The Insert Command</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#creating4.4">4.4 The Patch Command </A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#creating4.5">4.5 The Threshold Command</A>
 <DT><A HREF="#processing5">5.  PROCESSING OF 3D DATA</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing5.1">5.1  MA</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing5.2">5.2  IP</A>
<DT><tt>&nbsp&nbsp</tt><A HREF="#processing5.3">5.3  RT 3D</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing5.4">5.4  SH</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing5.5">5.5  WI</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing5.6">5.6  PD</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing5.7">5.7  MR</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing5.8">5.8  BC</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing5.9">5.9  CE</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing5.10">5.10  ED</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing5.11">5.11  AS R</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing5.12">5.12  FC</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing5.13">5.13  SU</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing5.14">5.14  MU</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing5.15">5.15  SQ</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing5.16">5.16  CC N</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing5.17">5.17  AL</A>
<DT><tt>&nbsp&nbsp</tt><A HREF="#processing5.18">5.18 MN S</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing5.19">5.19  FT</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing5.20">5.20  PW</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing5.21">5.21  MO 3</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing5.22">5.22  BL</A>
<DT><tt>&nbsp&nbsp</tt><A HREF="#processing5.23">5.23 IN</A>
<DT><tt>&nbsp&nbsp</tt><A HREF="#processing5.24">5.24 PA</A>
<DT><tt>&nbsp&nbsp</tt><A HREF="#processing5.25">5.25 TH</A>
<DT><A HREF="#procedure6">6.   PROCEDURE MODE OF PROCESSING</A>
<DT><tt>&nbsp&nbsp</tt><A HREF="#procedure6.1">6.1 Procedure versus Interactive Sessions</A>
<DT><tt>&nbsp&nbsp</tt><A HREF="#procedure6.2">6.2  How to Create a Procedure File</A>
<DT><tt>&nbsp&nbsp</tt><A HREF="#procedure6.3">6.3  Preparing and Running a Simple Procedure File</A>
<DT><tt>&nbsp&nbsp</tt><A HREF="#procedure6.4">6.4  Use of Temporary In-core Files</A>
<DT><tt>&nbsp&nbsp</tt><A HREF="#procedure6.5">6.5  DO-LOOPS and Run-time Designation of File Names </A>
<DT><tt>&nbsp&nbsp</tt><A HREF="#procedure6.6">6.6  Registers, Arithmetic Expressions, and Computed Goto Statements </A>
 <DT><A HREF="#appendix">APPENDIX </B></A>
<HR><P>
       <CENTER> <A NAME="introduction">INTRODUCTION</A></CENTER><BR>
<P> 
d101 2
a102 2
  <A HREF="#appendix"> Appendix</A>, you can start  right  away--no 
 other  images  are necessary for most operations documented here.</P>
d105 2
a106 2
 within each  command,  use  the <A HREF="../../../usr1/spider/docs/operations_doc.html">
 "Manual of Spider Operations"</A>.<BR>
d108 2
a109 2
<HR><BR>
 1. <A NAME="start1">STARTING THE SPIDER SESSION</A><BR><BR>
d111 2
a112 2
1.1<A NAME="start1.1"> Starting SPIDER</A><BR><BR>
<P>
d116 1
a116 1
you will see the query</P>
d119 1
a119 1
<P><I>
d123 1
a123 1
the user response, in this case "SEC/80S" IS case sensitive.]</P></I>
d125 1
a125 1
<P>The codes are used to define the files that will be accessible by
d134 1
a134 1
will be created.</P>
d136 1
a136 1
<P>[You can skip the following explanation of the project code in
d140 1
a140 1
same by default.]</P>
d142 1
a142 1
<P>Similarly, the PROJECT CODE is a three-letter sequence that will be
d150 1
a150 1
execute commands stored there.</P>
d152 1
a152 1
<P><I>[Note that there is a way to switch to another choice of
d155 1
a155 1
come back to the initial prompt ".ENTER PROJECT/DATA CODE:".]</I></P>
d157 1
a157 1
<P>After the DATA CODE (and the PROJECT CODE) have been entered, 
d160 1
a160 1
defining image processing operations.</P>
d162 1
a162 1
1.2 <A NAME="start1.2">Looking at the Image with WEB</A><BR><BR>
d164 1
a164 1
<P>In the course of the session, you need to look at the resulting
d174 1
a174 1
operations of <A HREF="../../../usr1/web/docs/web.html">WEB</A> in detail.</P>
d177 3
a179 3
<CENTER><IMG WIDTH=75 HEIGHT=75  SRC="./img/sam001.gif">
<IMG WIDTH=75 HEIGHT=75  SRC="./img/sam002.gif"></CENTER>
<CENTER><tt>SAM001 &nbsp; SAM002</tt></CENTER><BR>
d184 2
a185 2
  from  <I>E. coli</I> obtained by cryo-electron microscopy. You may 
  substitute it by your own image.<BR><P>
d187 2
a188 2
1.3 <A NAME="start1.3">Two-dimensional (2D) and three-dimensional (3D) images in SPIDER</A></P>
<P>SPIDER can operate on both 2D and 3D images. The file formats permits 
d196 2
a197 2
number of slices and refered to as NSLICE.</P>
<P> 
d201 4
a204 4
meaning or a different version for 3D data, it is decribed in more details.</P>
<P><A HREF="#user_guider">(Back to the front  page)</A></P>
<P>
  2. <A NAME="processing2">PROCESSING PREVIOUSLY CREATED IMAGES</A><BR><BR>
d207 2
a208 2
 2.1 <A NAME="processing2.1"  HREF="../../../usr1/spider/docs/man/ma.html">'MA' </A>--The Masking Command<BR><BR>
<P>
d212 1
a212 1
  as mask.</P>
d214 1
a214 1
<P>2.1.1 External masking</P>
d216 1
a216 1
<PRE>
d233 3
a235 2
</PRE>
<P> The preceding procedure will create  the  masked  image
d237 5
a241 5
Gaussian falloff.</P>
<CENTER><IMG WIDTH=75 HEIGHT=75  SRC="./img/mas002.gif">
</CENTER>
<CENTER>MAS002</CENTER><BR>
  <CENTER> FIGURE 2a.  Result of external masking operation.</CENTER><BR>
d243 2
a244 2
<P>2.1.2 Internal masking</P>
<PRE>
d261 9
a269 9
</PRE>
<CENTER><IMG WIDTH=75 HEIGHT=75  SRC="./img/min002.gif">
</CENTER>
<CENTER>MIN002</CENTER><BR>
  <CENTER> FIGURE 2b.  Result of internal masking operation.</CENTER><BR>

<P>
   2.2 <A NAME="processing2.2" HREF="../../../usr1/spider/docs/man/ip.html">'IP'</A>--The Interpolation Command<BR><BR>
<P>
d275 2
a276 2
 result from averaging.</P>
<PRE>
d286 1
a286 1
</PRE>
d294 4
a297 4
  height of 50.]<BR><BR>
<CENTER><IMG WIDTH=128 HEIGHT=128  SRC="./img/int001.gif">
<IMG WIDTH=128 HEIGHT=128  SRC="./img/int002.gif"></CENTER>
<CENTER><tt>INT001 &nbsp;  &nbsp; &nbsp; &nbsp; INT002</tt></CENTER><BR>
d302 1
a302 1
 enlargement of images, operation <A HREF="../../../usr1/spider/docs/man/fp.html">'FP'</A>
d304 1
a304 1
 SAM002, the same way as INT001 was from SAM001.<BR><BR>
d308 2
a309 2
   2.3 <A NAME="processing2.3" HREF="../../../usr1/spider/docs/man/rt.html">'RT'</A>--The Rotate Command<BR><BR>
<P>
d314 2
a315 2
 by convention;  the negative direction is counterclockwise.</P>
<P>
d319 2
a320 2
  with  the  reference.</P>
<PRE>
d329 5
a333 5
</PRE>
<CENTER><IMG WIDTH=128 HEIGHT=128  SRC="./img/rot001.gif">
<IMG WIDTH=128 HEIGHT=128  SRC="./img/rot002.gif"></CENTER>
<CENTER><tt>ROT001 &nbsp;  &nbsp; &nbsp; &nbsp; ROT002
</tt></CENTER><BR>
d340 1
a340 1
<A HREF="../../../usr1/spider/docs/man/rtb.html">'RT B'</A>).<BR><BR>
d344 2
a345 2
 2.4 <A NAME="processing2.4" HREF="../../../usr1/spider/docs/man/sh.html">'SH'</A>--The Shift Command<BR><BR>
<P>
d352 2
a353 2
  the right, positive y-direction is down.</P>
          <PRE>                                                    
d361 8
a368 8
</PRE>
     <I>NOTE: <A HREF="../../../usr1/spider/docs/man/shf.html">'SH F'</A> option allows non-integer  shift  vectors
  to be applied.</I><BR><BR>

<CENTER><IMG WIDTH=128 HEIGHT=128  SRC="./img/shf001.gif">
<IMG WIDTH=128 HEIGHT=128  SRC="./img/shf002.gif"></CENTER>
<CENTER><tt>SHF001 &nbsp;  &nbsp; &nbsp; &nbsp; SHF002
</tt></CENTER><BR>
d370 1
a370 1
 "wrap around" to the opposite sides of the image.<BR><BR>
d372 3
a374 3
<P>2.5  <A NAME="processing2.5" HREF="../../../usr1/spider/docs/man/rtsq.html">'RT SQ'</A>--
Rotate - image or volume, Shift, use Quadratic interpolation<BR><BR>
<P>Changes the scale, rotates and shifts image circularly. Rotates a 
d376 2
a377 2
 (Negative angles = clockwise).</P>
<PRE>
d386 2
a387 2
</PRE>
<CENTER><IMG WIDTH=128 HEIGHT=128  SRC="./img/rst001.gif"><tt>
d389 3
a391 3
<IMG WIDTH=128 HEIGHT=128  SRC="./img/rst002.gif"></CENTER>
<CENTER><tt>RST001 &nbsp;  &nbsp; &nbsp; &nbsp; RST002
</tt></CENTER><BR>
d394 1
a394 1
  resulting from the 'RT SQ' operation no "new" background is created.<BR><BR>
d397 2
a398 2
 2.6 <A NAME="processing2.6" HREF="../../../usr1/spider/docs/man/wi.html">'WI'</A>--The Windowing Command<BR><BR>
<P>
d407 3
a409 3
   (see <A HREF="../../../usr1/spider/docs/man/ft.html">'FT'</A> manual 
   for details).</P>
          <PRE>                                              
d428 3
a430 3
</PRE>
      <I>NOTE: The top left corner of an image has  coordinates  1,1 
  (not 0,0 !) by convention.<BR><BR></I>
d432 1
a432 1
    <CENTER><IMG WIDTH=110 HEIGHT=110  SRC="./img/win001.gif"><tt>
d434 5
a438 5
<IMG WIDTH=110 HEIGHT=110  SRC="./img/win002.gif"></CENTER>
  <CENTER><tt>WIN001 &nbsp&nbsp&nbsp&nbsp&nbsp&nbspWIN002
</tt></CENTER><BR>      
  <CENTER> FIGURE 6.  Result obtained by application of the 'WI' command.
</CENTER><BR>
d442 2
a443 2
  2.7 <A NAME="processing2.7" HREF="../../../usr1/spider/docs/man/pd.html">'PD'</A>--The Padding Command<BR><BR>
<P>
d447 2
a448 2
  with another image, so as to avoid wrap-around overlaps.</P>
<PRE>
d460 5
a464 5
    </PRE>
<CENTER><IMG WIDTH=150 HEIGHT=150  SRC="./img/pad001.gif">
<IMG WIDTH=150 HEIGHT=150 SRC="./img/pad002.gif"></CENTER>
<CENTER><tt>PAD001 &nbsp;  &nbsp; &nbsp; &nbsp; PAD002
</tt></CENTER><BR>
d472 1
a472 1
  yourself -- in that case a solicitation for that value would follow.)<BR><BR>
d474 2
a475 2
  2.8 <A NAME="processing2.8" HREF="../../../usr1/spider/docs/man/mr.html">'MR'</A>--The Mirroring Command<BR><BR>
<P>
d479 1
a479 1
This might be  useful if the handedness is not certain.</P>
d481 1
a481 1
<PRE>
d489 5
a493 5
  </PRE>
<CENTER><IMG WIDTH=150 HEIGHT=150  SRC="./img/mir001.gif">
<IMG WIDTH=150 HEIGHT=150  SRC="./img/mir002.gif"></CENTER>
<CENTER><tt>MIR001 &nbsp;  &nbsp; &nbsp; &nbsp; MIR002
</tt></CENTER><BR>
d496 1
a496 1
  through the point ((INT(NSAM/2) + 1, INT(NROW/2) + 1).<BR><BR>
d500 2
a501 2
 2.9 <A NAME="processing2.9" HREF="../../../usr1/spider/docs/man/bc.html">'BC'</A>--The Box-Convolution Command<BR><BR>
<P>
d510 1
a510 1
with the input image.  </P>
d512 1
a512 1
<P>   
d516 2
a517 2
  filtered image.</P>
<PRE>
d528 2
a529 2
</PRE>
 <CENTER>
d531 2
a532 2
<IMG WIDTH=128 HEIGHT=128  SRC="./img/box002.gif"></CENTER>
<CENTER><tt>BOX001 &nbsp;  &nbsp; &nbsp; &nbsp BOX002</tt></CENTER><BR>
d535 1
a535 1
  better from the background.<BR><BR>
d539 2
a540 2
  2.10 <A NAME="processing2.10" HREF="../../../usr1/spider/docs/man/ce.html">'CE'</A>--The Contrast Enhancement Command<BR><BR>
<P>
d546 1
a546 1
  </P>
d548 1
a548 1
<PRE>
d573 5
a577 5
   </PRE>
<CENTER><IMG WIDTH=128 HEIGHT=128  SRC="./img/con001.gif">
<IMG WIDTH=128 HEIGHT=128  SRC="./img/con002.gif"></CENTER>
<CENTER><tt>CON001 &nbsp;  &nbsp; &nbsp; &nbsp; CON002
</tt></CENTER><BR>
d585 1
a585 1
   become uniformly black.<BR><BR>
d589 1
a589 1
2.11 <A NAME="processing2.11" HREF="../../../usr1/spider/docs/man/ed.html">'ED'</A>--The Edge Detection Command<BR><BR>
d593 1
a593 1
  to the <A HREF="../../../usr1/spider/docs/man/fc.html">'FC'</A> (file contour) command, except that the contours
d595 2
a596 2
   density.<BR>
<PRE>
d610 1
a610 1
</PRE>
d614 1
a614 1
    crowdedness of edges:<BR><PRE>
d620 5
a624 5
</PRE>
<CENTER><IMG WIDTH=128 HEIGHT=128  SRC="./img/edg001.gif">
<IMG WIDTH=128 HEIGHT=128  SRC="./img/edg002.gif"></CENTER>
<CENTER><tt>EDG001 &nbsp;  &nbsp; &nbsp; &nbsp; EDG002
</tt></CENTER><BR>
d627 1
a627 1
  steepest are computed by the program.<BR><BR>
d631 2
a632 2
 2.12 <A NAME="processing2.12" HREF="../../../usr1/spider/docs/man/asr.html">'AS R'</A>--The Average + Variance Command<BR><BR>
<P>
d638 2
a639 2
 image.</P>
<P>
d646 2
a647 2
 computation of average and variance images.</P>
<P>
d649 1
a649 1
  in which 70S ribosomes are visualized.</P>
d651 1
a651 1
<PRE>
d662 2
a663 2
</PRE>
<P><I>
d666 1
a666 1
     NOTE: <P> 
d670 2
a671 2
  already summed.  </P> 
 <P>(2) If the ODD-EVEN option is selected, two average images and 
d674 3
a676 3
  tests where two independent averages are compared.</P>
  <P>(3) For negatively stained data the mean of images is irrelevant. In
  this case command <A HREF="../../../usr1/spider/docs/man/as.html">'AS'</A>
d679 10
a688 10
  will have a zero mean.</P>
  <P>If 'AS' is applied to images with relevant average the resulting 
  variance map will be incorrect (the variance values will be too small).</I></P>

<CENTER><IMG WIDTH=675 HEIGHT=90  SRC="./img/ser002.gif">
</CENTER><BR>
<CENTER><IMG WIDTH=75 HEIGHT=75  SRC="./img/avg002.gif">
<IMG WIDTH=75 HEIGHT=75  SRC="./img/var002.gif"></CENTER>
<CENTER><tt>AVG002 &nbsp; VAR002
</tt></CENTER><BR>
d696 1
a696 1
  actual changes in molecular conformation.<BR><BR>
d700 2
a701 2
  2.13 <A NAME="processing2.13" HREF="../../../usr1/spider/docs/man/fc.html">'FC'</A>--The File Contour Command<BR><BR>
<P>
d706 1
a706 1
 <A HREF="../../../usr1/spider/docs/man/fce.html">'FC E'</A>
d710 1
a710 1
 less  than  zero.  The <A HREF="../../../usr1/spider/docs/man/ar.html">'AR'</A> 
d713 1
a713 1
 for more information).</P>
d717 1
a717 1
  will look  very ragged.</P>
d719 1
a719 1
<PRE>
d741 2
a742 2
</PRE>
<P><I>  
d744 1
a744 1
<P>(1) Rule of thumb: for the image expansion by 'IP', use  a  
d746 2
a747 2
features.</P>  
<P>(2) In the simple 'FC' operation, the points of 
d751 3
a753 3
the  density  range  show up as single "contour points".</I></P>
<CENTER><IMG WIDTH=200 HEIGHT=200 SRC="./img/fic002.gif"></CENTER>
<CENTER>FIC002</CENTER><BR>
d755 2
a756 2
useful for the display of average  images.<BR>
<BR>
d759 2
a760 2
2.14 <A NAME="processing2.14" HREF="../../../usr1/spider/docs/man/su.html">'SU'</A>--The Subtract-Images Command<BR><BR>
<P>
d764 1
a764 1
response to the recurring prompt ".SUBTRACTED FILE:" .</P>
d766 1
a766 1
<PRE>
d777 3
a779 3
</PRE>
<CENTER><IMG WIDTH=128 HEIGHT=128  SRC="./img/sub001.gif"></CENTER>
<CENTER>SUB001</CENTER><BR>
d784 1
a784 1
positive difference would show the position of the ligand molecule.<BR><BR>
d786 2
a787 2
2.15 <A NAME="processing2.15" HREF="../../../usr1/spider/docs/man/mu.html">'MU'</A>--The Multiply-Images Command<BR><BR>
<P>
d792 2
a793 2
image.</P>
<P>
d796 1
a796 1
command.  </P>
d798 1
a798 1
<PRE>
d808 3
a810 3
</PRE>
<CENTER><IMG WIDTH=128 HEIGHT=128  SRC="./img/mul001.gif"></CENTER>
<CENTER>MUL001</CENTER><BR>
d813 1
a813 1
effect").<BR><BR>
d815 2
a816 2
2.16 <A NAME="processing2.16" HREF="../../../usr1/spider/docs/man/sq.html">'SQ'</A>--The Square-Image Command<BR><BR>
<P>
d821 1
a821 1
density (grey) are pushed more toward low density.</P>
d823 1
a823 1
<PRE>
d829 4
a832 4
</PRE>
<CENTER><IMG WIDTH=128 HEIGHT=128  SRC="./img/con002.gif">
<IMG WIDTH=128 HEIGHT=128  SRC="./img/sqr002.gif"></CENTER>
<CENTER><tt>CON002 &nbsp;  &nbsp; &nbsp; &nbsp; &nbsp; SQR001</tt></CENTER><BR>
d835 1
a835 1
when they occur in the high density range.<BR><BR>
d837 1
a837 1
2.17 <A NAME="processing2.17" HREF="../../../usr1/spider/docs/man/cc.html">'CC N'</A>--The  Cross-Correlation Command<BR><BR>
d839 1
a839 1
<P>The 'CC N' command computes the normalized cross-correlation 
d842 3
a844 3
need not be powers of two (see <A HREF="../../../usr1/spider/docs/man/ft.html">'FT'</A> 
for restrictions).</P>
<P> 
d853 2
a854 2
square is superposed upon the other.</P>
<P>
d859 1
a859 1
.</P>
d861 1
a861 1
<PRE>
d870 2
a871 2
</PRE>   
<CENTER><IMG WIDTH=150 HEIGHT=150 SRC="./img/pad002.gif">
d874 3
a876 3
</CENTER>
<CENTER><tt> PAD002 &nbsp; &nbsp;&nbsp;&nbsp;&nbsp; PAD003 &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;
 CCF002</tt></CENTER><BR>
d880 1
a880 1
of the input images. Note: The sign of shifts convention in section 6.6. <BR><BR>
d882 2
a883 2
 2.18 <A NAME="processing2.18" HREF="../../../usr1/spider/docs/man/ac.html">'AC'</A>--The Autocorrelation Command<BR><BR>
<P>
d885 2
a886 2
picture by using the Fourier transform relationship. </P>
<P> 
d895 2
a896 2
Alignment Using SPIDER").</P>
<PRE>
d903 3
a905 3
</PRE>    
<CENTER><IMG WIDTH=150 HEIGHT=150 SRC="./img/acf002.gif"></CENTER>
<CENTER>ACF002</CENTER><BR>
d912 2
a913 2
virtually invisible.<BR><BR>
<P> 
d923 1
a923 1
 by using the <A HREF="../../../usr1/spider/docs/man/thm.html">'TH M'</A> 
d925 3
a927 3
 <A HREF="../../../usr1/spider/docs/man/th.html">'TH'</A>
 and <A HREF="../../../usr1/spider/docs/man/mm.html">'MM'</A>.] </P>
<PRE> 
d945 4
a948 4
  </PRE>
<CENTER><IMG WIDTH=150 HEIGHT=150 SRC="./img/mai002.gif">
</CENTER>
<CENTER>MAI002</CENTER><BR>
d951 4
a954 4
visible. Compare to  Figure 18. <BR><BR>
 <P><A HREF="#user_guider">(Back to the front  page)</A></P><P>
3.<A NAME="fourier3">  THE FOURIER TRANSFORM</A><BR><BR>
<P>
d961 2
a962 2
a  crystal lattice. </P>  
<P> 
d965 1
a965 1
but this is an appropriate place to illustrate its function.</P>
d967 2
a968 2
3.1 <A NAME="fourier3.1" HREF="../../../usr1/spider/docs/man/mns.html">'MN S'</A>--The Montage Command With Scaling Option<BR><BR>
<P>
d974 2
a975 2
of  widely  differing contrasts and offsets.</P>
<P>
d979 2
a980 2
between  0  and  2.</P>
<PRE>
d995 3
a997 3
</PRE>
<CENTER><IMG WIDTH=225 HEIGHT=225  SRC="./img/mon001.gif"></CENTER>
<CENTER>MON001</CENTER><BR>
d1000 3
a1002 3
(0 pixels) in the 'MN S' operation.<BR><BR>
<CENTER><IMG WIDTH=225 HEIGHT=225  SRC="./img/big002.gif"></CENTER>
<CENTER>BIG002</CENTER><BR>
d1006 1
a1006 1
respectively, displayed as power spectra.<BR><BR>
d1009 2
a1010 2
 3.2 <A  NAME="fourier3.2" HREF="../../../usr1/spider/docs/man/ft.html">'FT'</A>--The Fourier Transform Command<BR><BR>
<P>
d1016 1
a1016 1
the <A HREF="../../../usr1/spider/docs/man/pw.html">'PW'</A> command (see below) has
d1021 2
a1022 2
Fourier transform are lost in this representation. </P>
<P>
d1032 2
a1033 2
generate a relatively noise-free image of the crystal.</P>
<P>
d1041 2
a1042 2
averaging.</P>
<PRE>
d1072 2
a1073 2
</PRE>
  <P><I>
d1076 2
a1077 2
 displayed  here.</I></P>
<P>
d1079 1
a1079 1
is used.</P>
d1081 2
a1082 2
 3.3 <A NAME="fourier3.3" HREF="../../../usr1/spider/docs/man/pw.html">'PW'</A>--The Power Spectrum Command<BR><BR>
<P>
d1088 2
a1089 2
data.</P>
<P>     
d1098 2
a1099 2
are in fact identical.</P>
<P>
d1107 2
a1108 2
lattice (the "reciprocal lattice").</P>
<PRE>
d1136 2
a1137 2
</PRE>
<P>
d1139 2
a1140 2
<A HREF="../../../usr1/spider/docs/man/wi.html">"WI"</A>
command to window the central part of the power spectrum.</P> 
d1142 1
a1142 1
<PRE>
d1159 1
a1159 1
</PRE>
d1161 2
a1162 2
<CENTER><IMG WIDTH=120 HEIGHT=120  SRC="./img/wma001.gif"></CENTER>
 <CENTER>WMA001</CENTER><BR>
d1165 3
a1167 3
<BR><BR>
 <CENTER><IMG WIDTH=120 HEIGHT=120  SRC="./img/wpo002.gif"></CENTER>
<CENTER>WPO002</CENTER><BR>
d1171 1
a1171 1
lattice points ("reciprocal lattice").<BR><BR>
d1173 2
a1174 2
<P><A HREF="#user_guider">(Back to the front  page)</A></P><P>
4.<A NAME="creating4">  CREATING AND EDITING  IMAGES</A><BR><BR>
d1176 4
a1179 4
 4.1 <A NAME="creating4.1" HREF="../../../usr1/spider/docs/man/mo.html">'MO'</A>--The Modelling Command<BR><BR>
<P>
     <I>Note  that  another  example for the use  of  this  command 
is documented  in the Appendix.</I> <BR>
d1182 2
a1183 2
 between 0 and 1.</P>
<PRE>
d1194 5
a1198 5
</PRE>
<CENTER><IMG WIDTH=128 HEIGHT=128  SRC="./img/mod001.gif"></CENTER>
<CENTER>MOD001</CENTER><BR>
<CENTER> FIGURE 22.  An image composed  of  completely  random  pixel
densities.</CENTER><BR>
d1200 2
a1201 2
 4.2 <A NAME="creating4.2" HREF="../../../usr1/spider/docs/man/bl.html">'BL'</A>--The Create-Blank Command<BR><BR>
<P>
d1205 1
a1205 1
demonstrate the following commands:  'IN' and 'PA'.</P>
d1207 1
a1207 1
<PRE>
d1219 2
a1220 2
</PRE>
<P><I>
d1223 1
a1223 1
rescale it into the range 0...2 would result in division by 0.</P></I>
d1225 2
a1226 2
 4.3 <A NAME="creating4.3" HREF="../../../usr1/spider/docs/man/in.html">'IN'</A>--The Insert Command<BR><BR>
<P>
d1229 2
a1230 2
the pixels in the larger image. </P>
<P><I>Note  that  the  new  image REPLACES  the  old  pixels--it 
d1233 2
a1234 2
saved, it must be copied first.</P></I>
<PRE>
d1249 3
a1251 3
 </PRE>
<CENTER><IMG WIDTH=128 HEIGHT=128  SRC="./img/ins001.gif"></CENTER>
<CENTER>INS001</CENTER><BR>
d1254 1
a1254 1
inserted image replace those of the larger one.<BR><BR> 
d1256 2
a1257 2
4.4 <A NAME="creating4.4" HREF="../../../usr1/spider/docs/man/pa.html">'PA'</A>--The Patch Command <BR><BR>
 <P>
d1267 1
a1267 1
 using it. </P>
d1269 1
a1269 1
 <PRE>
d1283 3
a1285 3
</PRE>
<CENTER><IMG WIDTH=128 HEIGHT=128  SRC="./img/pat001.gif"></CENTER>
<CENTER>PAT001</CENTER><BR> 
d1288 1
a1288 1
<P><I>
d1290 1
a1290 1
 in   a   lighter   overall appearance. </I></P>
d1292 2
a1293 2
  4.5 <A NAME="creating4.5" HREF="../../../usr1/spider/docs/man/th.html">'TH'</A>--The Threshold Command<BR><BR> 
 <P>
d1296 1
a1296 1
 an upper or a lower boundary or both can be set. </P>
d1298 1
a1298 1
 <PRE>
d1311 1
a1311 1
 </PRE>
d1313 14
a1326 14
<CENTER><IMG WIDTH=128 HEIGHT=128 SRC="./img/thr001.gif">
</CENTER>
<CENTER>THR001</CENTER><BR> 
<CENTER> FIGURE 25.  The result of 'TH' operation.</CENTER><BR><BR>    
<P><A HREF="#user_guider">(Back to the front  page)</A></P>
<P>
5. <A NAME="processing5">PROCESSING OF 3D DATA</A></P>

<P>5.1 <A  NAME="processing5.1" HREF="../../../usr1/spider/docs/man/ma.html">MA</A></P>
<P>Operation works for both 2D and 3D images.</P>
<P>5.2 <A  NAME="processing5.2" HREF="../../../usr1/spider/docs/man/ip.html">IP</A></P>
<P>Operation works for both 2D and 3D images.</P>
<P>5.3 <A NAME="processing5.3" HREF="../../../usr1/spider/docs/man/rt3d.html">RT 3D</A></P>
<P>This operation allows the volume to be rotated within the frame. By default,
d1328 1
a1328 1
INT(NSLICE/2)+1). The related command <A HREF="../../../usr1/spider/docs/man/rt3a.html">'RT 3A'</A>
d1330 1
a1330 41
specicified by three Eulerian angles. For the definition of these angles, 
see page 186 of "Three-Dimensional Electron Microscopy of Macromolecular Assemblies"
by Joachim Frank.</P>

<P>5.4 <A NAME="processing5.4" HREF="../../../usr1/spider/docs/man/sh.html">SH</A></P>
<P>Operation works for both 2D and 3D images.</P>
<P>5.5 <A NAME="processing5.5" HREF="../../../usr1/spider/docs/man/wi.html">WI</A></P>
<P>Operation works for both 2D and 3D images.</P>
<P>5.6 <A NAME="processing5.6" HREF="../../../usr1/spider/docs/man/pd.html">PD</A></P>
<P>Operation works for both 2D and 3D images.</P>
<P>5.7 <A NAME="processing5.7" HREF="../../../usr1/spider/docs/man/mr.html">MR</A></P>
<P>Operation works for both 2D and 3D images.</P>
<P>5.8 <A NAME="processing5.8" HREF="../../../usr1/spider/docs/man/bc.html">BC</A></P>
<P>Operation works for both 2D and 3D images.</P>
<P>5.9 <A NAME="processing5.9" HREF="../../../usr1/spider/docs/man/ce.html">CE</A></P>
<P>Operation does not work for 3D data.</P>
<P>5.10 <A NAME="processing5.10" HREF="../../../usr1/spider/docs/man/ed.html">ED</A></P>
<P>Operation does not work for 3D data.</P>
<P>5.11 <A NAME="processing5.11" HREF="../../../usr1/spider/docs/man/asr.html">AS R</A></P>
<P>Operation works for both 2D and 3D images.</P>
<P>5.12 <A NAME="processing5.12" HREF="../../../usr1/spider/docs/man/fc.html">FC</A></P>
<P>Operation does not work for 3D data.</P>
<P>5.13 <A NAME="processing5.13" HREF="../../../usr1/spider/docs/man/su.html">SU</A></P>
<P>Operation works for both 2D and 3D images.</P>
<P>5.14 <A NAME="processing5.14" HREF="../../../usr1/spider/docs/man/mu.html">MU</A></P>
<P>Operation works for both 2D and 3D images.</P>
<P>5.15 <A NAME="processing5.15" HREF="../../../usr1/spider/docs/man/sq.html">SQ</A></P>
<P>Operation works for both 2D and 3D images.</P>
<P>5.16 <A NAME="processing5.16" HREF="../../../usr1/spider/docs/man/ccn.html">CC N</A></P>
<P>Operation works for both 2D and 3D images.</P>
<P>5.17 <A NAME="processing5.17" HREF="../../../usr1/spider/docs/man/al.html">AL</A></P>
<P>Operation works for both 2D and 3D images.</P>
<P>5.18 <A NAME="processing5.18" HREF="../../../usr1/spider/docs/man/mns.html">MN S</A></P>
<P>Operation does not work for 3D data.</P>
<P>5.19 <A NAME="processing5.19" HREF="../../../usr1/spider/docs/man/ft.html">FT</A></P>
<P>Operation works for both 2D and 3D images.</P>
<P>5.20 <A NAME="processing5.20" HREF="../../../usr1/spider/docs/man/pw.html">PW</A></P>
<P>Operation works for both 2D and 3D images.</P>
<P>5.21 <A NAME="processing5.21" HREF="../../../usr1/spider/docs/man/mo3.html">MO 3</A></P>
<P>Creates a 3-D model density distribution.</P>
<PRE>.MENU: 
d1332 38
d1383 18
a1400 18
 </PRE>
<P>5.22 <A NAME="processing5.22" HREF="../../../usr1/spider/docs/man/bl.html">BL</A></P>
<P>Operation does not work for 3D data, but a blank volume can be created using 
<A HREF="../../../usr1/spider/docs/man/mo3.html">MO 3</A> command.</P>

<P>5.23 <A NAME="processing5.23" HREF="../../../usr1/spider/docs/man/in.html">IN</A></P>
<P>Operation does not work for 3D data.</P>
<P>5.24 <A NAME="processing5.24" HREF="../../../usr1/spider/docs/man/pa.html">PA</A></P>
<P>Operation does not work for 3D data.</P>
<P>5.25 <A NAME="processing5.25" HREF="../../../usr1/spider/docs/man/th.html">TH</A></P>
<P>Operation works for both 2D and 3D images.</P>

<P><A HREF="#user_guider">(Back to the front  page)</A></P>
6.<A NAME="procedure6"> PROCEDURE MODE OF PROCESSING</A>
<P>
6.1 <A  NAME="procedure6.1" HREF="../../../usr1/spider/docs/user_doc.html#procedure">Procedure</A> versus 
<A HREF="../../../usr1/spider/docs/user_doc.html#interactive">Interactive</A> Sessions
<P>
d1404 1
a1404 1
<P>
d1410 1
a1410 1
<P>
d1415 2
a1416 2
interactive mode of SPIDER covered so far: <A HREF="../../../usr1/spider/docs/man/do.html">DO-LOOP</A>s, 
computed <A HREF="../../../usr1/spider/docs/man/goto.html">GOTO</A>s,
d1418 4
a1421 4
document files, and symbolic parameters.</P>
<P>
6.2<A NAME="procedure6.2"> How to Create a Procedure File</A>
<P>
d1428 2
a1429 2
be 'ALIGN.SEC' if 'SEC' is chosen as project code.</P>
<P><I>
d1436 3
a1438 3
<P>
6.3 <A NAME="procedure6.3">Preparing and Running  a Simple Procedure File</A>
<P>
d1441 2
a1442 2
and 'RT' commands. We create a file named 'IPRT.SEC'.</P>
<PRE>
d1453 2
a1454 2
</PRE>
<P>
d1457 2
a1458 2
exception of the comment line and the <A HREF="../../../usr1/spider/docs/man/en.html">'EN'</A> command.</P>
<P>
d1464 4
a1467 4
identical to those shown in Figs 3 and 4.</P>
<P>
6.4 <A NAME="procedure6.4">Use of Temporary In-core Files</A>
<P>
d1474 2
a1475 2
area 1:</P>
 <PRE>
d1486 2
a1487 2
</PRE>
<P>
d1490 4
a1493 4
<A HREF="../../../usr1/spider/docs/user_doc.html#file_inline">user documentation</A>.
<P>
6.5 <A NAME="procedure6.5">DO-LOOPS and Run-time Designation of File Names</A>
<P>
d1498 1
a1498 1
<PRE>
d1511 2
a1512 2
</PRE>
<P>
d1515 2
a1516 2
input and output, now use a running index 'I'.</P>
<P>
d1521 2
a1522 2
SAM002 and ROT002 to SAM010 and ROT010.</P>
<P>
d1528 3
a1530 3
<A HREF="../../../usr1/spider/docs/man/ip.html">'IP'</A> are the same throughout, but
that the rotation angle is different for each image:</P>
<PRE>
d1543 3
a1545 3
</PRE>
<P>
6.6 <A NAME="procedure6.6" HREF="../../../usr1/spider/docs/user_doc.html#registers">Registers</A>,
d1547 1
a1547 1
<P>
d1552 3
a1554 3
character even more.<BR>
<P><I>
Registers</I> are reserved places in memory that can be used to store
d1556 2
a1557 2
between 0 an 99. There are different ways to fill a register:<BR>
<PRE>		X10=5</PRE>
d1560 2
a1561 2
peak search command <A HREF="../../../usr1/spider/docs/man/pk.html">'PK'</A>:<BR>
<PRE>		PK X20,X21,X22</PRE>
d1568 2
a1569 2
session, or until overwritten.</P>
<P>
d1575 3
a1577 3
components to be used in a subsequent <A HREF="../../../usr1/spider/docs/man/sh.html">'SH'</A> operation would be
12, -8.</P>
<P>
d1580 3
a1582 3
operation would be X20, -X21. <I>Thus, registers can be used in any position
where numerical input is expected.</I></P>
<P>
d1586 2
a1587 2
obtained in Section 2.16, CCF002:</P>
<PRE>
d1598 2
a1599 2
</PRE>
<P>
d1601 6
a1606 6
aligned with PAD003 (see Fig 26).<P>
<CENTER><IMG WIDTH=150 HEIGHT=150  SRC="./img/shi002.gif">
<IMG WIDTH=150 HEIGHT=150  SRC="./img/pad003.gif"></CENTER>
<CENTER><tt>SHI002 &nbsp &nbsp PAD003</tt></CENTER><BR>
<CENTER> FIGURE 26.  The result of the above program.</CENTER><BR><BR>    
<P><A HREF="#user_guider">(Back to the front  page)</A></P>
d1609 4
a1612 4
<HR>
<BR>
    <CENTER><A NAME="appendix">APPENDIX</A></CENTER><BR>
<HR>
d1619 1
a1619 1
<A HREF="#user_guider">Tutorial</A>.<BR>
d1621 3
a1623 3
<BR>
<A HREF="../../../usr1/spider/docs/man/mo.html">'MO'</A>--The MODEL command<BR>
<BR>
d1627 2
a1628 2
full periods.<BR>
<PRE>
d1637 1
a1637 1
</PRE>
d1640 9
a1648 7
SPIDER Tutorial.<BR><BR>
<CENTER><IMG WIDTH=75 HEIGHT=75  SRC="./img/sam001.gif"></CENTER>
<CENTER>SAM001</CENTER><BR>
<CENTER>FIGURE A1.  The resultant image after  following  the  above
example.</CENTER>
<P><A HREF="#user_guider">(Back to the front  page)</A></P></BODY>
</HTML>
@


1.10
log
@spelling
@
text
@d57 3
a59 3
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing5.1">5.1 MA</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing5.2">5.2 IP</A>
<DT><tt>&nbsp&nbsp</tt><A HREF="#processing5.3">5.3 RT 3D</A>
d61 1
a61 1
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing5.5">5.5 WI</A>
d63 3
a65 3
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing5.7">5.7 MR</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing5.8">5.8 BC</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing5.9">5.9 CE</A>
d67 1
a67 1
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing5.11">5.11 AS R</A>
d69 1
a69 1
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing5.13">5.13 SU</A>
d71 2
a72 2
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing5.15">5.15 SQ</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing5.16">5.16 CC N</A>
d77 1
a77 1
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing5.21">5.21 MO 3</A>
d80 9
a88 9
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing5.24">5.24 PA</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#processing5.25">5.25 TH</A>
 <DT><A HREF="#batch6">6.   BATCH MODE OF PROCESSING</A>
 <DT><tt>&nbsp&nbsp</tt><A HREF="#batch6.1">6.1  Batch versus Interactive Sessions</A>
<DT><tt>&nbsp&nbsp</tt><A HREF="#batch6.2">6.2 How to Create a Batch File</A>
<DT><tt>&nbsp&nbsp</tt><A HREF="#batch6.3">6.3  Preparing and Running a Simple Batch File</A>
<DT><tt>&nbsp&nbsp</tt><A HREF="#batch6.4">6.4   Use of Temporary In-core Files</A>
<DT><tt>&nbsp&nbsp</tt><A HREF="#batch6.5">6.5   DO-LOOPS and Run-time Designation of File Names </A>
<DT><tt>&nbsp&nbsp</tt><A HREF="#batch6.6">6.6  Registers, Arithmetic Expressions, and Computed Goto Statements </A>
d142 1
a142 1
commands: these are called "batch files" or "procedure files".
d1395 1
a1395 1
6.<A NAME="batch6"> BATCH MODE OF PROCESSING</A>
d1397 2
a1398 1
6.1 <A  NAME="batch6.1" HREF="../../../usr1/spider/docs/user_doc.html#batch">Batch</A> versus <A HREF="../../../usr1/spider/docs/user_doc.html#interactive">Interactive</A> Sessions
d1407 1
a1407 1
are stored in command files and submitted in the batch mode of
d1410 1
a1410 5
There are two kinds of command files: one ("batch file"), which 
contains commands and expected inputs to the corresponding operations, 
just as they
would be typed in the interactive mode. The other kind ("procedure
file") is more flexible as it allows run-time replacements. In the
d1412 1
a1412 1
batch and procedure files. In the course of this introduction, many new
d1419 1
a1419 1
6.2<A NAME="batch6.2"> How to Create a Batch File</A>
d1429 1
a1429 6
[Note that according to an old SPIDER convention, batch files names have 
3 characters and start with 'B'. The two remaining characters represent a 
number between 1 and 99. Thus 'B91.SEC' would be a valid name. When this 
naming convention is followed, the '@@' sign may be omitted in entering 
the batch file name on the command prompt; see below.] </P></I>
<P>
d1436 1
a1436 1
6.3 <A NAME="batch6.3">Preparing and Running  a Simple Batch File</A>
d1461 1
a1461 1
After execution of the batch file, you will be able to verify that the
d1465 1
a1465 1
6.4 <A NAME="batch6.4">Use of Temporary In-core Files</A>
d1472 1
a1472 1
re-written batch file, making use of the "file" mapped in the core
d1491 1
a1491 1
6.5 <A NAME="batch6.5">DO-LOOPS and Run-time Designation of File Names</A>
d1495 1
a1495 1
easy, and the appropriate batch file may be created from 'IPRT.SEC' by 
d1516 1
a1516 1
The lines 'DO LB1 X10=2,10' and 'LB1' demarcate a segment of the batch
d1544 1
a1544 1
6.6 <A NAME="batch6.6" HREF="../../../usr1/spider/docs/user_doc.html#registers">Registers</A>,
d1547 1
a1547 1
The sequence of commands in the batch file can be regarded as a
@


1.9
log
@do i=  ---> do x10
@
text
@d1429 1
a1429 1
is set at the begining of the SPIDER session. So a valid name would
d1432 1
a1432 1
[Note that according to an older SPIDER convention, batch files names have 
d1438 1
a1438 1
The first line should be used as comment line. In SPIDER, comment lines
@


1.8
log
@00I --> {***i}
@
text
@d86 1
a86 1
<DT><tt>&nbsp&nbsp</tt><A HREF="#batch6.4">6.4   Use of Temporay In-core Files</A>
d218 1
a218 1
    .INPUT1 FILE: SAM002          ;Image to be masked
d245 1
a245 1
    .INPUT1 FILE: SAM002          ;Image to be masked
d321 1
a321 1
    .INPUT1 FILE: INT001          ;Image to be rotated
d354 1
a354 1
    .INPUT1 FILE: ROT001          ;Image to be shifted
d378 1
a378 1
    .INPUT1 FILE: INT001          ;Image to be rotated
d410 1
a410 1
    .INPUT1 FILE: SHF001            ;Image to be windowed
d418 1
a418 1
    .INPUT1 FILE: SHF002            ;Image to be windowed
d449 1
a449 1
    .INPUT1 FILE: SAM001            ;Image to be padded
d482 1
a482 1
    .INPUT1 FILE: PAD001          ;Image to be mirrored
d518 1
a518 1
    .INPUT1 FILE: INT002            ;Image to be convoluted
d549 1
a549 1
    .INPUT1 FILE: BOX001          ;Image to be enhanced
d597 1
a597 1
    .INPUT1 FILE: CON001          ;Image to which edge  
d652 1
a652 1
    .FILE PREFIX OR TEMPLATE:SAM***  ;First image of series
d656 1
a656 1
    .AVRGE FILE: AVG002              ;Name of average file to
d658 1
a658 1
    .VARIAN FILE: VAR002             ;Name of variance file 
d726 1
a726 1
    .INPUT1 FILE: IPL002          ;Image to be contoured
d767 1
a767 1
    .FIRST INPUT1 FILE: CON001    ;Name of image from which other 
d824 1
a824 1
    .INPUT1 FILE: CON002          ;File to be squared
d863 1
a863 1
    .REFER FILE: PAD003		  ;the second ribosome picture,  
d928 1
a928 1
    .INPUT1 FILE: ACF002          ;Image to be masked 
d1052 1
a1052 1
    .INPUT1 FILE: AVG002		;Image to be padded		
d1117 1
a1117 1
    .INPUT1 FILE: POW001          ;Image to be masked
d1141 1
a1141 1
    .INPUT1 FILE: MAI001           ;Image to be windowed
d1150 1
a1150 1
    .INPUT1 FILE: POW002           ;Image to be windowed
d1235 1
a1235 1
    .INPUT1 FILE: MOD001          ;Image to be copied
d1270 1
a1270 1
    .INPUT1 FILE: INS001          ;File to be copied 
d1409 3
a1411 2
There are two kinds of command files: one ("batch file"), which contains
commands and expectd inputs to the corresponding operations, just as they
d1473 1
a1473 1
6.4 <A NAME="batch6.4">Use of Temporay In-core Files</A>
d1507 1
a1507 1
	DO LB1 I=2,10
d1509 1
a1509 1
	SAM{***I}
d1514 1
a1514 1
 	ROT{***I}
d1521 1
a1521 1
lines, 'DO LB1 I=2,10' and 'LB1'. In addition, the file names, both for
d1524 1
a1524 1
The lines 'DO LB1 I=2,10' and 'LB1' demarcate a segment of the batch
d1539 1
a1539 1
	DO LB1 I=2,10
d1541 1
a1541 1
	SAM{***I}
d1546 1
a1546 1
 	ROT{***I}
@


1.7
log
@bad spelling of notwork
@
text
@d1508 1
a1508 1
	SAM00I
d1513 1
a1513 1
 	ROT00I
d1540 1
a1540 1
	SAM00I
d1545 1
a1545 1
 	ROT00I
@


1.6
log
@changed PROJECT to "IS case sensitive"
@
text
@d1342 1
a1342 1
<P>Operation does notwork for 3D data.</P>
d1344 1
a1344 1
<P>Operation does notwork for 3D data.</P>
d1348 1
a1348 1
<P>Operation does notwork for 3D data.</P>
d1360 1
a1360 1
<P>Operation does notwork for 3D data.</P>
d1384 1
a1384 1
<P>Operation does notwork for 3D data, but a blank volume can be created using 
d1388 1
a1388 1
<P>Operation does notwork for 3D data.</P>
d1390 1
a1390 1
<P>Operation does notwork for 3D data.</P>
@


1.5
log
@renamed from newspi.html
@
text
@d121 1
a121 3
the user response, in this case "SEC/80S" is NOT case sensitive.  
However, for the purpose of this Tutorial, all examples for 
user responses are set in upper case.]</P></I>
@


1.4
log
@changes
@
text
@d2 3
a4 1
<HEAD>        <TITLE> Tutorial: SPIDER Image Manipulation</TITLE>
a5 1
</HEAD>
@


1.3
log
@*** empty log message ***
@
text
@d137 1
a137 1
you come to the second part of this manual.  For the time being,
d161 1
a161 1
1.2 <A NAME="start1.2">Looking at Image with WEB</A><BR><BR>
d172 1
a172 1
help function is available to explain the more complex interactive
d187 1
a187 1
<P>SPIDER can operate on both 2D and 3D images. the file formats permits 
d190 2
a191 2
this tutorial. 2D images is defined by its x,y dimensions. x, the width
of the image, is stored as the number of sampling points and always
d193 2
a194 2
of horizontal rows and refered to as NROW. 3D image can be thought of as
a stack of 2D images (or slices), and the 2 dimensional is stored as the
d198 4
a201 4
imagaes. In section 5 introduced commands are reviewed and if a given
command has different meaning or different version for 3D data, it is
decribed in more details.</P>
<P><A HREF="#user_guider">Back to the front  page</A></P>
d234 1
a234 1
  seen  in  figure 2.  Note the soft transition created by the 
d299 2
a300 2
 size is reduced, information will be always partially lost. For an integer 
 enlargement of images, operation <A HREF="../../../usr1/spider/docs/man/fp.html">FP</A>
d311 1
a311 1
 or negative: the  positive direction is considered clockwise,
d371 1
a371 1
RoTate - image or volume, Shift, use Quadratic interpolation<BR><BR>
d390 3
a392 3
  FIGURE 5b.  The result of RT SQ command. Notice that the difference 
  between RT SQ command and RT, SH commands is that in the result image of 
  RT SQ command there is no "new" background created.<BR><BR>
d398 1
a398 1
   at  several  stages  of   an investigation:   the  particles 
d400 1
a400 1
   once masked and aligned, a particle  could  be  windowed  to
d404 1
a404 1
   and dimensions that are large prime numbers may present a problem
d474 1
a474 1
      By this command, a mirror-image of the input  image  is
d477 1
a477 1
This is useful if the handedness is not certain.</P>
d581 2
a582 1
  instance,  that  the fringe surrounding the particle has
d643 2
a644 1
 ".ENTER  FILE NUMBERS:",  otherwise it will be skipped.</P>
d674 3
a676 3
  this case command <A HREF="../../../usr1/spider/docs/man/as.html">AS</A>
  can be used. It subtracts the mean from every image in input series before 
  calculation of the average map. Thus the average map produced by AS 
d678 1
a678 1
  <P>If AS is applied to images with relevant average the resulting 
d692 3
a694 1
  variance within the area of  the particle.<BR><BR>
d703 1
a703 1
 densities  used  are  generated  by the program.  The 
d742 1
a742 1
<P>(1) Rule of thumb: for the image expansion, use  a  
d748 1
a748 1
though 4 was specified.  The pixels at either extreme of  
d762 1
a762 1
response to the prompt ".SUBTRACTED FILE:" .</P>
d815 3
a817 3
     This command mathematically squares the value  of  each
pixel  in  the  image,  and has a contrast-enhancing effect:
non-linear areas with high density (white in our display) are enhanced, those 
d837 5
a841 6
<P>The 'CC N' command
 computes the normalized cross-correlation function of two pictures by
 using the Fourier transform relationship. The dimensions of the
 two pictures must be the same; however, the dimensions
 need not be powers of two (see <A HREF="../../../usr1/spider/docs/man/ft.html">'FT'</A> 
 for restrictions).</P>
d848 2
a849 2
Depending upon the distance, and the direction in which they are 
moved,  their  cross-correlation  will  vary continuously.  The 
d882 1
a882 1
The 'AC' command computes the auto correlation function of a 
d922 3
a924 1
 operation, see manual chapter on <A HREF="../../../usr1/spider/docs/man/th.html">'TH'</A>] </P>
d950 1
a950 1
 <P><A HREF="#user_guider">Back to the front  page</A></P><P>
d971 1
a971 1
range 0...2.  This  is particularly   important  for  images  
d1018 2
a1019 1
in x- and y- direction).</P>
d1082 1
a1082 1
visual  display  of  the Fourier transform of an image.  The
d1085 1
a1085 1
amplitudes.  This operation can only be performed on Fourier 
d1099 2
a1100 1
convolution  theorem:  the montage is the convolution of the
d1104 1
a1104 1
transform of the single-point lattice, which is again a point
d1171 1
a1171 1
<P><A HREF="#user_guider">Back to the front  page</A></P><P>
d1201 1
a1201 1
density.  There is no inter-point variation as there is with
d1228 4
a1231 5
<P><I>Note  that  the  new  image
REPLACES  the  old  pixels--it  is  not added to them, as in
'PA'.  Also, the final image with the  insert  replaces  the
original  image,  so if the original is to be saved, it must
be copied.</P></I>
d1262 3
a1264 3
 has an inserted image at top left, and a  patched  image  at 
 lower  right.   Again, the new image overwrites the old one, 
 and it is a good idea to  copy  the  original  image  before 
d1292 3
a1294 3
    An image that is thresholded has any densities beyond a 
 user-determined value set equal to the threshold.  Either or 
 both an upper and a lower boundary can be set. </P>
d1315 1
a1315 1
<P><A HREF="#user_guider">Back to the front  page</A></P>
d1318 1
d1326 1
a1326 1
INT(NSLICE/2)+1). Related command <A HREF="../../../usr1/spider/docs/man/rt3a.html">RT 3A</A>
d1328 3
a1330 1
specicified by those Eulerian angles. </P>
d1343 1
a1343 1
<P>This command does not work for 3D data.</P>
d1345 1
a1345 1
<P>This command does not work for 3D data.</P>
d1349 1
a1349 1
<P>This command does not work for 3D data.</P>
d1361 1
a1361 1
<P>This command does not work for 3D data.</P>
d1385 1
a1385 1
<P>This command does not work for 3D data, but a blank volume can be created using 
d1389 1
a1389 1
<P>This command does not work for 3D data.</P>
d1391 1
a1391 1
<P>This command does not work for 3D data.</P>
d1395 1
a1395 1
<P><A HREF="#user_guider">Back to the front  page</A></P>
d1613 1
a1613 1
<P><A HREF="#user_guider">Back to the front  page</A></P>
d1652 1
a1652 1
<P><A HREF="#user_guider">Back to the front  page</A></P></BODY>
@


1.2
log
@*** empty log message ***
@
text
@d20 71
a90 4



       <CENTER> INTRODUCTION</CENTER><BR>
d104 1
d106 1
a106 1
 1. STARTING THE SPIDER SESSION<BR><BR>
d108 1
a108 1
1.1 Starting SPIDER<BR><BR>
d161 1
a161 1
1.2 Looking at Image with WEB<BR><BR>
d186 1
a186 1
1.3 Two-dimensional (2D) and three-dimensional (3D) images in SPIDER</P>
d201 1
d203 1
a203 1
  2. PROCESSING PREVIOUSLY CREATED IMAGES<BR><BR>
d206 1
a206 1
 2.1 <A HREF="../../../usr1/spider/docs/man/ma.html">'MA' </A>--The Masking Command<BR><BR>
d213 1
a213 1
<P>2.1.1 External masing</P>
d266 1
a266 1
   2.2 <A HREF="../../../usr1/spider/docs/man/ip.html">'IP'</A>--The Interpolation Command<BR><BR>
d306 1
a306 1
   2.3 <A HREF="../../../usr1/spider/docs/man/rt.html">'RT'</A>--The Rotate Command<BR><BR>
d342 1
a342 1
 2.4 <A HREF="../../../usr1/spider/docs/man/sh.html">'SH'</A>--The Shift Command<BR><BR>
d370 1
a370 1
<P>  <A HREF="../../../usr1/spider/docs/man/rtsq.html">'RT SQ'</A>--
d395 1
a395 1
 2.5 <A HREF="../../../usr1/spider/docs/man/wi.html">'WI'</A>--The Windowing Command<BR><BR>
d440 1
a440 1
  2.6 <A HREF="../../../usr1/spider/docs/man/pd.html">'PD'</A>--The Padding Command<BR><BR>
d472 1
a472 1
  2.7 <A HREF="../../../usr1/spider/docs/man/mr.html">'MR'</A>--The Mirroring Command<BR><BR>
d476 2
a477 1
 or the horizontal line  running through the image center at (75,75).</P>
d498 1
a498 1
 2.8 <A HREF="../../../usr1/spider/docs/man/bc.html">'BC'</A>--The Box-Convolution Command<BR><BR>
d528 1
d530 1
a530 1
<CENTER>BOX002</CENTER><BR>
d537 1
a537 1
  2.9 <A HREF="../../../usr1/spider/docs/man/ce.html">'CE'</A>--The Contrast Enhancement Command<BR><BR>
d586 1
a586 1
2.10 <A HREF="../../../usr1/spider/docs/man/ed.html">'ED'</A>--The Edge Detection Command<BR><BR>
d628 1
a628 1
 2.11 <A HREF="../../../usr1/spider/docs/man/asr.html">'AS R'</A>--The Average + Variance Command<BR><BR>
d694 1
a694 1
  2.12 <A HREF="../../../usr1/spider/docs/man/fc.html">'FC'</A>--The File Contour Command<BR><BR>
d753 1
a753 1
2.13 <A HREF="../../../usr1/spider/docs/man/su.html">'SU'</A>--The Subtract-Images Command<BR><BR>
d780 1
a780 1
2.14 <A HREF="../../../usr1/spider/docs/man/mu.html">'MU'</A>--The Multiply-Images Command<BR><BR>
d809 1
a809 1
2.15 <A HREF="../../../usr1/spider/docs/man/sq.html">'SQ'</A>--The Square-Image Command<BR><BR>
d831 1
a831 1
2.16 <A HREF="../../../usr1/spider/docs/man/cc.html">'CC N'</A>--The  Cross-Correlation Command<BR><BR>
d877 1
a877 1
 2.17 <A HREF="../../../usr1/spider/docs/man/ac.html">'AC'</A>--The Autocorrelation Command<BR><BR>
d945 2
a946 2
 
3.  THE FOURIER TRANSFORM <BR><BR>
d960 1
a960 1
3.1 <A HREF="../../../usr1/spider/docs/man/mns.html">'MN S'</A>--The Montage Command With Scaling Option<BR><BR>
d1002 1
a1002 1
 3.2 <A HREF="../../../usr1/spider/docs/man/ft.html">'FT'</A>--The Fourier Transform Command<BR><BR>
d1073 1
a1073 1
 3.3 <A HREF="../../../usr1/spider/docs/man/pw.html">'PW'</A>--The Power Spectrum Command<BR><BR>
d1164 2
d1167 1
a1167 3
4.  CREATING AND EDITING  IMAGES<BR><BR>

 4.1 <A HREF="../../../usr1/spider/docs/man/mo.html">'MO'</A>--The Modelling Command<BR><BR>
d1191 1
a1191 1
 4.2 <A HREF="../../../usr1/spider/docs/man/bl.html">'BL'</A>--The Create-Blank Command<BR><BR>
d1216 1
a1216 1
 4.3 <A HREF="../../../usr1/spider/docs/man/in.html">'IN'</A>--The Insert Command<BR><BR>
d1248 1
a1248 1
4.4 <A HREF="../../../usr1/spider/docs/man/pa.html">'PA'</A>--The Patch Command <BR><BR>
d1284 1
a1284 1
  4.5 <A HREF="../../../usr1/spider/docs/man/th.html">'TH'</A>--The Threshold Command<BR><BR> 
d1309 1
d1311 2
a1312 2
5. PROCESSING OF 3D DATA</P>
<P>5.1 <A HREF="../../../usr1/spider/docs/man/ma.html">MA</A></P>
d1314 1
a1314 1
<P>5.2 <A HREF="../../../usr1/spider/docs/man/ip.html">IP</A></P>
d1316 1
a1316 1
<P>5.3 <A HREF="../../../usr1/spider/docs/man/rt3d.html">RT 3D</A></P>
d1323 1
a1323 1
<P>5.4 <A HREF="../../../usr1/spider/docs/man/sh.html">SH</A></P>
d1325 1
a1325 1
<P>5.5 <A HREF="../../../usr1/spider/docs/man/wi.html">WI</A></P>
d1327 1
a1327 1
<P>5.6 <A HREF="../../../usr1/spider/docs/man/pd.html">PD</A></P>
d1329 1
a1329 1
<P>5.7 <A HREF="../../../usr1/spider/docs/man/mr.html">MR</A></P>
d1331 1
a1331 1
<P>5.8 <A HREF="../../../usr1/spider/docs/man/bc.html">BC</A></P>
d1333 1
a1333 1
<P>5.9 <A HREF="../../../usr1/spider/docs/man/ce.html">CE</A></P>
d1335 1
a1335 1
<P>5.10 <A HREF="../../../usr1/spider/docs/man/ed.html">ED</A></P>
d1337 1
a1337 1
<P>5.11 <A HREF="../../../usr1/spider/docs/man/asr.html">AS R</A></P>
d1339 1
a1339 1
<P>5.12 <A HREF="../../../usr1/spider/docs/man/fc.html">FC</A></P>
d1341 1
a1341 1
<P>5.13 <A HREF="../../../usr1/spider/docs/man/su.html">SU</A></P>
d1343 1
a1343 1
<P>5.14 <A HREF="../../../usr1/spider/docs/man/mu.html">MU</A></P>
d1345 1
a1345 1
<P>5.15 <A HREF="../../../usr1/spider/docs/man/sq.html">SQ</A></P>
d1347 1
a1347 1
<P>5.16 <A HREF="../../../usr1/spider/docs/man/ccn.html">CC N</A></P>
d1349 1
a1349 1
<P>5.17 <A HREF="../../../usr1/spider/docs/man/al.html">AL</A></P>
d1351 1
a1351 1
<P>5.18 <A HREF="../../../usr1/spider/docs/man/mns.html">MN S</A></P>
d1353 1
a1353 1
<P>5.19 <A HREF="../../../usr1/spider/docs/man/ft.html">FT</A></P>
d1355 1
a1355 1
<P>5.20 <A HREF="../../../usr1/spider/docs/man/pw.html">PW</A></P>
d1357 1
a1357 1
<P>5.22 <A HREF="../../../usr1/spider/docs/man/mo3.html">MO 3</A></P>
d1375 1
a1375 1
<P>5.22 <A HREF="../../../usr1/spider/docs/man/bl.html">BL</A></P>
d1379 1
a1379 1
<P>5.23 <A HREF="../../../usr1/spider/docs/man/in.html">IN</A></P>
d1381 1
a1381 1
<P>5.24 <A HREF="../../../usr1/spider/docs/man/pa.html">PA</A></P>
d1383 1
a1383 1
<P>5.25 <A HREF="../../../usr1/spider/docs/man/th.html">TH</A></P>
d1386 2
a1387 4



6. BATCH MODE OF PROCESSING
d1389 1
a1389 1
6.1 <A HREF="../../../usr1/spider/docs/user_doc.html#batch">Batch</A> versus <A HREF="../../../usr1/spider/docs/user_doc.html#interactive">Interactive</A> Sessions
d1413 1
a1413 1
6.2 How to Create a Batch File
d1435 1
a1435 1
6.3 Preparing and Running  a Simple Batch File
d1464 1
a1464 1
6.4 Use of Temporay In-core Files
d1490 1
a1490 1
6.5 DO-LOOPS and Run-time Designation of File Names
d1543 1
a1543 1
6.6 <A HREF="../../../usr1/spider/docs/user_doc.html#registers">Registers</A>,
d1604 1
a1604 1

d1643 1
a1643 1
</BODY>
@


1.1
log
@Initial revision
@
text
@d5 1
a5 1
<BODY   BACKGROUND ="./img/bgpink.gif"  VLINK ="#ff000">
d12 1
a12 2
<CENTER>by Louis M. Miranda</CENTER>
<BR>
a13 1
<BR>
d15 3
d29 1
a29 1
 a step-by-step procedure and the resultant  images  produced
d34 74
a107 4
     For more information on  the  specific  choices  within
 each  command,  use  the <A HREF="../../../usr1/spider/docs/operations_doc.html">"Manual of
 Spider Operation"</A>.<BR>
<HR>
d112 1
a112 1
    FIGURE 1.  The original images to  be  manipulated.   SAM001
d115 2
a116 1
  from  <I>E. coli</I> obtained by cryo-electron microscopy.<BR><BR>
d118 17
a134 1

a135 1
  1. PROCESSING PREVIOUSLY CREATED IMAGES<BR><BR>
d137 1
a137 2

 1.1 <A HREF="../../../usr1/spider/docs/man/ma.html">'MA' </A>--The Masking Command<BR><BR>
d144 2
d170 25
a194 1
  <CENTER> FIGURE 2.  Result of masking operation.</CENTER><BR>
a195 1
   1.2 <A HREF="../../../usr1/spider/docs/man/ip.html">'IP'</A>--The Interpolation Command<BR><BR>
d197 2
d228 5
a232 2
 been  enlarged. No information is lost when enlarging images, 
 yet there is no gain in resolution. INT002 was computed from 
d237 1
a237 1
   1.3 <A HREF="../../../usr1/spider/docs/man/rt.html">'RT'</A>--The Rotate Command<BR><BR>
d267 3
a269 1
  image.<BR><BR>
d273 1
a273 1
 1.4 <A HREF="../../../usr1/spider/docs/man/sh.html">'SH'</A>--The Shift Command<BR><BR>
d291 1
a291 1
     <I>NOTE: 'SH F' option allows non-integer  shift  vectors
d298 1
a298 1
  FIGURE 5.  Shifted Images.  Notice that shifted  image  data
d301 23
d326 1
a326 1
 1.5 <A HREF="../../../usr1/spider/docs/man/wi.html">'WI'</A>--The Windowing Command<BR><BR>
d333 5
a337 3
   to be windowed to a size appropriate for certain operations,  e.g.
   some Fourier operations, necessitating image dimensions that are
   powers of two.</P>
d361 2
a362 1
    <CENTER><IMG WIDTH=110 HEIGHT=110  SRC="./img/win001.gif">
d371 1
a371 1
  1.6 <A HREF="../../../usr1/spider/docs/man/pd.html">'PD'</A>--The Padding Command<BR><BR>
d381 1
a381 1
    .INPUT1 FILE: WIN001            ;Image to be padded
d383 1
a383 1
    .ENTER DIMS NSAM,NROW: 128,128  ;Size of final image
d386 1
a386 1
    .TOP LEFT COOS: 10,10           ;Coordinates of image
d390 2
a391 2
<CENTER><IMG WIDTH=128 HEIGHT=128  SRC="./img/pad001.gif">
<IMG WIDTH=128 HEIGHT=128 SRC="./img/pad002.gif"></CENTER>
d395 1
a395 3
  with   the   smallest  power-of-two  dimensions  that  fully
  contains the windowed area (in our example, we are  back  to
  the  previous size in Fig. 5).  By placing the average of the windowed
d399 3
a401 1
  of the padded image.<BR><BR>
d403 1
a403 1
  1.7 <A HREF="../../../usr1/spider/docs/man/mr.html">'MR'</A>--The Mirroring Command<BR><BR>
d407 1
a407 1
 or the horizontal line  running through the image center at (65,65).</P>
d418 2
a419 2
<CENTER><IMG WIDTH=128 HEIGHT=128  SRC="./img/mir001.gif">
<IMG WIDTH=128 HEIGHT=128  SRC="./img/mir002.gif"></CENTER>
d424 1
a424 1
  through the point (NSAM/2 + 1, NROW/2 + 1).<BR><BR>
d428 1
a428 1
 1.8 <A HREF="../../../usr1/spider/docs/man/bc.html">'BC'</A>--The Box-Convolution Command<BR><BR>
d455 1
a455 1
    .FILTER WEIGHT 0.&ltF&lt1.: 1       ;Mixing factor
d466 1
a466 1
  1.9 <A HREF="../../../usr1/spider/docs/man/ce.html">'CE'</A>--The Contrast Enhancement Command<BR><BR>
d496 2
a497 2
    .PLOT RESULT HISTOGRAM: Y     ;If yes, prints out 
                                  ;histogram of resulting image
d515 1
a515 1
1.10 <A HREF="../../../usr1/spider/docs/man/ed.html">'ED'</A>--The Edge Detection Command<BR><BR>
d557 1
a557 1
 1.11 <A HREF="../../../usr1/spider/docs/man/as.html">'AS'</A>--The Average + Variance Command<BR><BR>
d559 1
a559 1
  'AS' computes the average image and variance image from two or
d567 2
a568 2
  begin  with the same file series name, e.g.  CON001, CON002,
 ..., CON009, CON010.  Also, even though the name of the first 
d571 1
a571 1
 ".ENTER  FILE NUMBERS:",  otherwise  the  it will be skipped.</P>
d573 2
a574 5
  The following example is the only  deviation  from  our
  original  intention  of  using only easily-created examples.
  The set of images used  is  from  an  experiment in which
  70S ribosomes are visualized.   In order to show a meaningful example
  of the Averaging operation, real-world images had to be used.</P>
d579 8
a586 8
    .OPERATION: AS                ;Use the AS command
    .FILE PREFIX OR TEMPLATE:SAM  ;First image of series
    .ENTER FILE NUMBERS: 2-10     ;Numbers in a series
                                  ;to be averaged
    .ALL, ODD-EVEN (A/O):A        ;all images will be added   
    .AVRGE FILE: AVG002           ;Name of average file to
                                  ;be computed
    .VARIAN FILE: VAR002          ;Name of variance file 
d589 4
a592 1
     NOTE:  (1) If the average file already exists, then the
d595 15
a609 9
  already summed.   (2)  The  average file produced by AS will
  have a zero mean.  To obtain the true average, you must  add
  the  offset  listed  at  the end of the AS operation to each
  pixel, using the AR operation.  (For display  purposes,  the
  exact value of the offset is of no consequence.)  (3) If the
  ODD-EVEN option is selected, two average images and corresponding
  variance images are created, one for the odd-numbered,  one
  for the even-numbered files. This option is used for resolution
  tests where two independent averages are compared.</I></P>
d615 1
a615 1
  averaging  9 files (shown in FIGURE 20a).   The  average image
d623 1
a623 1
  1.12 <A HREF="../../../usr1/spider/docs/man/fc.html">'FC'</A>--The File Contour Command<BR><BR>
d634 1
a634 1
 command may be used to make the image positive definite by 
a647 1
                                  ;or reduced
d666 2
a667 1
   NOTE:  (1) Rule of thumb: for the image expansion, use  a  
d669 2
a670 1
features.  (2) In the simple 'FC' operation, the points of 
d682 1
a682 1
1.13 <A HREF="../../../usr1/spider/docs/man/su.html">'SU'</A>--The Subtract-Images Command<BR><BR>
d693 3
a695 5
    .FIRST INPUT1 FILE: CON001    ;Name of image from 
         			  ;which other image 
         			  ;will be subtracted
    .SUBTRACTED FILE: CON002      ;Name of image to be
          			  ;subtracted
d704 1
a704 1
CON001 (see Fig 10). In a practical application of 'SU', one image
d707 1
a707 1
difference would show the position of the ligand molecule.<BR><BR>
d709 1
a709 3


          1.14 <A HREF="../../../usr1/spider/docs/man/mu.html">'MU'</A>--The Multiply-Images Command<BR><BR>
d734 3
a736 3
FIGURE 15.  Multiplied images.  Note the extreme  effect  of
multiplying  where  the density in one image is very
high or very low.<BR><BR>
d738 1
a738 3


1.15 <A HREF="../../../usr1/spider/docs/man/sq.html">'SQ'</A>--The Square-Image Command<BR><BR>
d742 1
a742 1
non-linear areas with high density (white) are enhanced, those 
d760 1
a760 1
1.16 <A HREF="../../../usr1/spider/docs/man/cc.html">'CC'</A>--The  Cross Correlation Command<BR><BR>
d762 2
a763 2
<P>The 'CC' command
 computes the cross-correlation function of two pictures by
d779 5
a783 2
In the example, we use two images of the ribosome, SAM002 and SAM003 
(see first two images in Montage, Fig 20a).</P>
d788 3
a790 3
    .OPERATION: CC      	  ;Cross Correlation
    .INPUT FILE: SAM002           ;the first ribosome picture
    .REFER FILE: SAM003		  ;the second ribosome picture,  
d795 3
a797 1
<CENTER><IMG WIDTH=75 HEIGHT=75 SRC="./img/ccf002.gif">
d799 11
a809 9
<CENTER>CCF002</CENTER><BR>
FIGURE 17.  Display of an cross correlation function computed
in above example.<BR><BR>

 1.17 <A HREF="../../../usr1/spider/docs/man/ac.html">'AC'</A>--The Autocorrelation Command<BR><BR>
<P>
The 'AC' commamd Computes the auto-correlation function of a 
picture by using the Fourier transform relationship. The dimension 
of the picture need not be a power of two.</P>
d811 1
a811 1
     The ACF is simply defined as the CCF of one image  with
d817 3
a819 3
shift is  accurately  known.   This,  in  fact,  is  how  an
alignment  procedure  is run in SPIDER (see "Single Particle
Alignment Using SPIDER" by Joachim Frank).</P>
d821 1
a821 1
       EXAMPLE:  Computing The Autocorrelation Function
d824 1
a824 1
    .INPUT FILE: AVG002           ;Image to be auto-correlated
d828 2
a829 2
<CENTER><IMG WIDTH=75 HEIGHT=75 SRC="./img/acf002.gif"></CENTER>
<CENTER>ACF001</CENTER><BR>
d833 1
a833 1
to the perfect match of an image with itselff for zero shift),
d847 2
a848 2
 by using the <A HREF="../../../usr1/spider/docs/man/th.html">'TH'</A> 
 operation, see section 3.5.] </P>
d855 1
a855 1
    .OUTER & INNER RADII: 37,7    ;Radii the outer and inner 
d861 4
a864 7
     .(A)V, (P)REC AV, (C)IRCUMF, OR (E)XTERNAL: E 
                                  ;Background in density  
                                  ;specification for masked area;   
                                  ;E is to specify value for 
                                  ;background EXTERNALLY.
     .BACKGROUND: 0.00            ;Background density = 0 
     .MASK CENTER COOS: 38.5,38.5 ;Coordinates of the 
d866 1
a866 3
     .HALFWIDTH: 2                ;1/e falloff distance; 
                                  ;only needed for piecewise
                                  ;or true Gaussian falloff 
d868 1
a868 1
<CENTER><IMG WIDTH=75 HEIGHT=75 SRC="./img/mai002.gif">
d871 1
a871 1
FIGURE 19.  Here, by eliminating the peak at the orgin, we have
d875 1
a875 1
2.  THE FOURIER TRANSFORM <BR><BR>
d889 1
a889 1
2.1 <A HREF="../../../usr1/spider/docs/man/mns.html">'MN S'</A>--The Montage Command With Scaling Option<BR><BR>
d923 2
a924 2
<CENTER><IMG WIDTH=225 HEIGHT=225  SRC="./img/avg202.gif"></CENTER>
<CENTER>AVG002</CENTER><BR>
d928 1
a928 1
respectively.<BR><BR>
d931 1
a931 1
 2.2 <A HREF="../../../usr1/spider/docs/man/ft.html">'FT'</A>--The Fourier Transform Command<BR><BR>
d941 1
a941 1
according to their spatial frequencies (reciprocal wavelength's
d958 2
a959 1
particles(Fig 20b).   In  this  way,  a comparison  can  be made
d964 1
a964 1
            EXAMPLE:  Fourier Transforming an Image
a965 17
    .OPERATION: PD    			;Pad image to make it
         			        ;Fourier-transformable
    .INPUT1 FILE: MON001          	;Image to be padded
    .OUTPUT FILE: FOU001          	;Padded image ready to
          				;be transformed
    .ENTER DIMS NSAM,NROW: 512,512	;Dimensions of padded
         	         		;image
    .AVERAGE (Y/N),(C)IRCULAR OPTION: Y ;Average of image
         			  	;used for padding
          			  	;background
    .ENTER TOP LEFT COOS: 128,128 	;Coordinates of padded
          			  	;image where smaller
         			  	;image is to be placed
         			  	;(arbitrary, as long as
         			  	;the Fourier phases are
        			  	;not considered)

d967 1
a967 1
    .INPUT FILE: FOU001                 ;Image to be Fourier
d969 1
a969 1
    .OUTPUT FILE: FOU101		;output file which will 
d974 13
a986 6
    .OPERATION: PD
    .INPUT1 FILE: AVG002
    .OUTPUT FILE: FOU002
    .ENTER DIMS, NSAM,NROW: 512,512
    .AVERAGE (Y/N), (C)IRCULAR OPTION: Y
    .ENTER TOP LEFT COOS: 225,225
d989 1
a989 1
    .INPUT FILE: FOU002                 ;Image to be Fourier
d991 1
a991 1
    .OUTPUT FILE: FOU202		;output file which will 
d1002 1
a1002 1
 2.3 <A HREF="../../../usr1/spider/docs/man/pw.html">'PW'</A>--The Power Spectrum Command<BR><BR>
d1032 1
a1032 1
    .INPUT FILE: FOU101           ;Fourier data to be converted
d1042 1
a1042 1
    .OUTER & INNER RADII:256,3    ;Radius of circular mask
d1049 1
a1049 1
    .MASK CENTER COOS: 257,257    ;Coordinates of the
d1054 1
a1054 1
    .INPUT FILE: FOU202
d1066 2
a1067 2
    .ENTER DIMS NSAM,NROW: 128,128 ;Size of windowed area
    .TOP LEFT COOS: 192,192        ;Coordinates where the
d1075 2
a1076 2
    .ENTER DIMS NSAM,NROW: 128,128 ;Size of windowed area
    .TOP LEFT COOS: 192,192        ;Coordinates where the
d1081 1
a1081 1
<CENTER><IMG WIDTH=128 HEIGHT=128  SRC="./img/wma001.gif"></CENTER>
d1083 1
a1083 1
FIGURE 21a.  WMA001--power spectrum of the montage in Fig 20a.  Note
d1086 1
a1086 1
 <CENTER><IMG WIDTH=128 HEIGHT=128  SRC="./img/wpo002.gif"></CENTER>
d1088 1
a1088 1
 FIGURE 21b.  WPO002--power spectrum of the Fourier-transformed
d1094 1
a1094 1
3.  CREATING AND MANIPULATING  IMAGES<BR><BR>
d1096 1
a1096 1
 3.1 <A HREF="../../../usr1/spider/docs/man/mo.html">'MO'</A>--The Modelling Command<BR><BR>
d1100 1
a1100 1
 For the next series of images,a base image was created using the 
d1120 1
a1120 1
 3.2 <A HREF="../../../usr1/spider/docs/man/bl.html">'BL'</A>--The Create-Blank Command<BR><BR>
d1145 1
a1145 1
 3.3 <A HREF="../../../usr1/spider/docs/man/in.html">'IN'</A>--The Insert Command<BR><BR>
d1177 1
a1177 1
3.4 <A HREF="../../../usr1/spider/docs/man/pa.html">'PA'</A>--The Patch Command <BR><BR>
d1213 1
a1213 1
  3.5 <A HREF="../../../usr1/spider/docs/man/th.html">'TH'</A>--The Threshold Command<BR><BR> 
d1238 297
@
