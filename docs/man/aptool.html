<head>
<title>SPIDER: AP TOOL (Alignment - Tool for evaluating parameters ||)</title>
   <link rel='stylesheet' href='niceman.css' type='text/css' />
   <link rel='stylesheet' type='text/css' href='../buttons.css' />

</head>

<body>
<!-- Begin Buttons -->
<table>
<tr>
  <td><a href="../spider.html"                 id="spider">    </a></td>
  <td><a href="../user_doc.html"               id="work">      </a></td>
  <td><a href="../operations_doc.html"         id="index">     </a></td>
  <td><a href="../documents.html"              id="help">      </a></td>
  <td><a href="../faq.html"                    id="faq">       </a></td>
  <td><a href="../documents.html#2D"           id="techs">     </a></td>
  <td><a href="../techs/recon1a/Docs/mr1.html" id="recon">     </a></td>
  <td><a href="../formats.html"                id="menu">      </a></td>
  <td><a href="../installation.html"           id="install">   </a></td>
  <td><a href="../release.html"                id="new">       </a></td>
  <td><a href="https://spider-em.github.io/Web" id="web"> </a></td> 
</tr>
</table>
<br><hr>
<!-- End Buttons -->

<h2>AP TOOL - Alignment - Tool for evaluating parameters ||</h2>
<em>(1/14/11)</em><br />
<p>
<dl><dt><strong>PURPOSE</strong>
<p>
<dd>Compares a series of experimental images with a series of reference
images. For each experimental image, it finds the in-plane Euler
rotation angle, and X, Y translational shifts which align the image with the
most-similar reference image.
</dl>
<p>
<dl><dt><strong>SEE ALSO</strong>
<p>
<dd><table><tr><td><a href="apsh.html"><strong>AP SH</strong></a></td><td> [Alignment - multi-reference, exhaustive rotation & shift ||*]</td></tr>
<tr><td><a href="apshc.html"><strong>AP SHC</strong></a></td><td> [Alignment - multi-reference, fast exhaustive rotation & shift ||]</td></tr>
</table></dl>
<p>
<dl><dt><strong>USAGE</strong></dt>
<p>
<dd>.OPERATION: AP TOOL<br />
<p>
<dd>.EVALUATE SHIFT OR RINGS (SH/RI): SHIFTS<br />
<p>
.TEMPLATE FOR REFERENCE IMAGES: REF***<br />
[Give the template for the name of the existing file series of 2D
reference images (typically projections).]
<p>
.FILE NUMBERS OR SELECTION DOC. FILE NAME: SELECTREF<br />
[Enter numbers of reference files. The file numbers can also
be read from a selection document file where file numbers
are contained in the first register (not the keys).]
<p>
</dd> <dt>If evaluating shifts the following prompt occurs:
<dd><br />.MAX TRANSLATION SEARCH RANGE: 14<br />
[The search for translation parameters will be restricted to
+/- search range, performed every "step size" pixel. <br />
<p>
</dd> <dt>Otherwise if evaluating Rings the following prompt occurs:
<dd><br />.TRANSLATION SEARCH RANGE: 14<br />
[The search for translation parameters will be restricted to
+/- search range, performed every "step size" pixel. <br />
<p>
</dd> <dt>If evaluating shifts the following prompt occurs:
<dd><br />.FIRST, LAST RING, RING STEP &amp; RAY STEP: 5,176,1,1<br />
[The search for rotational alignment will be restricted to
pixels with radii in the specified range (Here: 5-176),
performed every 'ring step' radius and on every 'ray step'
radial ray. <br />
<p>
</dd> <dt>Otherwise if evaluating rings the following prompt occurs:
<dd><br />.FIRST, LAST RING: 5,176<br />
[The search for rotational alignment will be restricted to
pixels with radii in the specified range (Here: 5-176). <br />
<p>
.REFERENCE IMAGES ANGLES DOCUMENT FILE: Refangles<br />
[Enter the name of the document file containing Eulerian
angles for the reference images: Psi, Theta, Phi.]
<p>
.TEMPLATE FOR IMAGE SERIES TO BE ALIGNED: DAT***<br />
[Give the template name of the existing file series of
experimental images. These images will be checked for
alignment versus the reference images.]
<p>
.FILE NUMBERS OR SELECTION DOC. FILE NAME: 1-2100<br />
[Enter numbers of experimental files. The file numbers can also
be read from a selection document file where file numbers are
contained in the first register (not the keys).]
<p>
.CHECK MIRRORED POSITIONS (0=NOCHECK / 1=CHECK)?: 1<br />
[Optional check of the mirrored reference image. By using this check and
only providing reference images from one hemisphere of projection
directions, speed can be doubled. See note: 1 below.
<p>
.OUTPUT ALIGNMENT DOCUMENT FILE: PARM101<br />
[This is the only output produced by this operation.
(Will append to existing output file of same name).
It contains 15 register columns. See
<a href="apsh.html">'AP SH'</a> for details.
<p>
<p>
</dl>
<p>
<strong>NOTES</strong>
<ol>
<p>
<li>The main take-away-message from experimentation with use
of this operation is that
the alignment operation does not need the 'best'
match to give decent reconstructions. Due to the high levels
of noise common in cryo-em
images, reconstruction is a 'statistical' summation and
sub-maximal alignments combine to still give decent
reconstructions.
<p>
<li>Explanation of output for shift analysis.
<table border="1" cellpadding="3">
<tr>
<th>SHIFT RANGE </th>
<th>STEP VALUE </th>
<th>#BEST FOUND </th>
<th>%BEST FOUND </th>
<th>%BEST CC </th>
<th>%ON BORDER </th>
<th>TIME </th> </tr>
<tr>
<td>Shift range</td>
<td>Step size </td>
<td>Number of best CC matches found</td>
<td>% of best CC matches found</td>
<td>% of best CC</td>
<td>% of best CC matches occurring on border of shift range</td>
<td>Relative run time</td>
</tr>
</table>
<p>
<li>Explanation of location of maximum matches<br />
Number of times best match for each expermental
images occurs at each shift location.
<p>
<li>Explanation of output for ring skip analysis.
<table border="1" cellpadding="3">
<tr>
<th>SKIP AMOUNT </th>
<th>#BEST FOUND </th>
<th>%BEST FOUND </th>
<th>%BEST CC </th>
<th>RELATIVE TIME</th> </tr>
<tr>
<td>Skip value</td>
<td>Number of best CC matches found</td>
<td>% of best CC matches found</td>
<td>% of best CC</td>
<td>Relative run time</td>
</tr>
</table>
<p>
<li>Output document file produced by this operation contains
15 register columns. The contents are the same as
operation: 'AP SH' except for the following:
<ul>
<li>Cumulative X shift. <br />
This is the sum of any shift from the 'experimental
images align. document file' and any current shift. <br />
The shifts reported here have <b>NOT</b> been adjusted
to compensate for any rotation, so that they are
not appropriate for use with SPIDER operations such as
'RT SQ'. </li>
<li>Cumulative Y shift. <br />
This is the sum of any shift from the 'experimental
images align. document file' and any current shift. <br />
The shifts reported here have <b>NOT</b> been adjusted
to compensate for any rotation, so that they are
not appropriate for use with SPIDER operations such as
'RT SQ'. </li>
<li>Current X shift. <br />
X shift necessary to align the experimental
image with the current reference projection.
The shifts reported here have <b>NOT</b> been adjusted
to compensate for any rotation, so that they are
not appropriate for use with SPIDER operations such as
'RT SQ'. </li>
<li>Current Y shift. <br />
Y shift necessary to align the experimental
image with the current reference projection. </li>
The shifts reported here have <b>NOT</b> been adjusted
to compensate for any rotation, so that they are
not appropriate for use with SPIDER operations such as
'RT SQ'. </li>
</ol>
</ol>
<p>
<dl><dt><strong>SUBROUTINES</strong>
<p>
<dd><a href="../../src/apsh_tool.f">APSH_TOOL</a>, <a href="../../src/aprings.f">APRINGS</a>, <a href="../../src/normasc.f">NORMASC</a>, <a href="../../src/crosrng_2.f">CROSRNG_2</a>, <a href="../../src/frngs.f">FRNGS</a>, <a href="../../src/ap_stat.f">AP_STAT</a>, <a href="../../src/ringwe.f">RINGWE</a>, <a href="../../src/applyws.f">APPLYWS</a></dl>
<p>
<dl><dt><strong>CALLER</strong>
<p>
<dd><a href="../../src/util4.f">UTIL4</a> 
</dl>
</body>
</html>