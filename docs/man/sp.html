<head>
<title>SPIDER: SP (Find info on diffraction pattern spots)</title>
   <link rel='stylesheet' href='niceman.css' type='text/css' />
   <link rel='stylesheet' type='text/css' href='../buttons.css' />

</head>

<body>
<!-- Begin Buttons -->
<table>
<tr>
  <td><a href="../spider.html"                 id="spider">    </a></td>
  <td><a href="../user_doc.html"               id="work">      </a></td>
  <td><a href="../operations_doc.html"         id="index">     </a></td>
  <td><a href="../documents.html"              id="help">      </a></td>
  <td><a href="../faq.html"                    id="faq">       </a></td>
  <td><a href="../documents.html#2D"           id="techs">     </a></td>
  <td><a href="../techs/recon1a/Docs/mr1.html" id="recon">     </a></td>
  <td><a href="../formats.html"                id="menu">      </a></td>
  <td><a href="../installation.html"           id="install">   </a></td>
  <td><a href="../release.html"                id="new">       </a></td>
  <td><a href="https://spider-em.github.io/Web" id="web"> </a></td> 
</tr>
</table>
<br><hr>
<!-- End Buttons -->

<h2>SP - Find info on diffraction pattern spots</h2>
<em>(9/25/06)</em><br />
<p>
<dl><dt><strong>PURPOSE</strong>
<p>
<dd>Finds the intensities at all the points of a lattice or at
a single point or finds the center and radius of a ring,
e.g. of spots from a powder diffraction pattern.
</dl>
<p>
<dl><dt><strong>USAGE</strong></dt>
<p>
<dd>.OPERATION: SP<br />
<p>
<dd>.OPTION L/S/R:<br />
[Enter
'L' to find the lattice parameters and the intensities
of all the spots in a lattice, <br />
'S' to find the intensities of one or more spots
one-at-a-time, or <br />
'R' to find the radius and center of a ring, e.g. for
a powder pattern. <br />
Entering a character other than 'L', 'S' or 'R' ends the operation.]
<p>
.SIZE FACTOR: 4<br />
[Enter the reduction factor used to create the reflection
document file in WEB (see Note 2). Entering a value of
0 ends the operation.]
<p>
.INPUT: LAT001<br />
[Enter the name of the image file with the spots to be
measured.]
<p>
.REFLECTION LIST: WIN001<br />
[Enter the name of a document file to be used for selecting the
spot(s) to be measured.]
<p>
.FIRST KEY FOR REFL LIST (0 TO RETURN): 3<br />
[Enter the key corresponding to the index of the first spot you
want to measure--it is helpful to have a printed output of the
window file.]
<p>
.MODE: MAX(1)/CNTR OF DEN(2)//NO BK CORR(-): 2<br />
[Choose the method used to determine the intensities. Either the
position of the maximum value or the center of gravity within the
window is used to calculate the subsequent window positions. If
MODE &gt; 0, a linear background subtraction is performed before
the calculations; if MODE &lt; 0, no background is subtracted.]
<p>
.WINDOW SIZE(ODD #): 25,35<br />
[Enter two numbers (odd works best, but is not necessary) for the
size of the window you wish to use. If the second number is 0,
it is reset equal to the first, i.e. a square window. The intensity
is calculated for the mode and window size chosen; then you are
prompted for a new window size. To find the intensity of another
reflection, enter '0' as the first number.]
<p>
NEXT KEY FOR REFL LIST (0 TO RETURN): 5
[Enter the next key number. Continue in this fashion until you
have measured all the spots you want at each of the window sizes
you want; then enter '0' to return.]
<p>
.SIZE FACTOR: 4<br />
[Enter the reduction factor used to create the reflection
document file in WEB (see Note 2). Entering a value of
'0' ends the operation.]
<p>
.INPUT: LAT001<br />
[Enter the name of the image file with the spots to be
measured.]
<p>
.DO YOU WANT A WINDOW POSITION DOCUMENT? (Y/N): Y<br />
[If you want to examine windows around one or more of the
measured spots, enter 'Y'. If you will want to use the
'S' option to measure the intensities of individual spots,
enter 'Y'.]
<p>
.DO YOU WANT A PATTERSON FUNCTION DOCUMENT? (Y/N): Y<br />
[If you want to list the intensities for H and K less than
or equal to 16, answer 'Y'. A procedure has been written to
produce a 33-by-33 image from such a document. The
operation 'PW' can then be used to produce a Patterson function.]
<p>
.WINDOW SIZE: 41,41<br />
[Enter NX,NY for the width and height of windows within
which the intensities will be measured. If one number is
entered, the window will be NX by NY. If no numbers are
entered, or if the first number entered is 0, you are returned
to ".OPERATION:".]
<p>
.MODE: MAX(1)/CNTR OF DEN(2)//NO BK CORR(-): 2<br />
[Choose the method used to determine the lattice vectors and
the intensities. Either the position of the maximum value or
the center of gravity within the window is used to calculate
the lattice parameters. If MODE &gt; 0, a linear background
subtraction is performed before the calculations; if MODE &lt; 0,
no background is subtracted.]
<p>
.REFLECTION DOC.: RFL001<br />
[Enter the name of the document file in which you have stored
the indices and positions of three reflections to be used to
calculate the lattice parameters.]
<p>
.MAX RADIUS,MIN RADIUS: 1500,50<br />
[Enter the largest distance from the lattice center to which
you want to extend the measurement and the closest such distance.
If the first value entered is less than the second, the
message 'MAX RADIUS LESS THAN MIN RADIUS; TRY AGAIN!' appears,
and you must re-enter the two values.]
<p>
.REFLN. INDEX FOR REL. INT.: 8,4<br />
[Enter the H- and K-indices of a spot which will be divided into
the measured intensities to give relative values.]
<p>
.DOCUMENT FILE: WIN001<br />
[If you answered Y to the window position query, enter the name
of the document file in which you want to store the information
about the positions and sizes of the windows used to determine the
lattice and measure the intensities. At the conclusion of the
operation, the total number of window positions listed will be
put into register X34.]
<p>
.DOCUMENT FILE: PAT001<br />
[If you answered 'Y' to the Patterson function document query, enter
the name of the document file in which you want to store the
intensity data for producing the image for which PW will give the
Patterson function.]
<p>
.NUMBER OF SPOTS (3&lt;M&lt;21): 5<br />
[Enter the number of spots to be used in calculating the center and
radius of the ring.]
<p>
SPOT DOCUMENT: RFL001
[Enter the name of the document file in which you have stored
the indices and positions of reflections to be used to calculate
the center and radius of the ring. This document file must be
in the same format as that produced by the REFLECTION command
in the program WEB: a heading record and three records with
the key (integer), 5, key (floating), H-index, K-index, SAM
position, ROW position (all floating).]
<p>
This option makes one calculation and then exits the operation.
<p>
</dl>
<p>
<strong>NOTES</strong>
<ol>
<p>
<li>The reflection and spot document files must be in the same format
as that produced by the REFLECTION command in the program WEB:
a heading record and three records with the key (integer), 5, key
(floating), H-index, K-index, X-position, Y-position (all
floating).
<p>
<li>The reflection list format must be the same as that of the
window document produced by the 'L' option: a heading record
and document records with a key (integer), 6, H-index, K-index,
X-position, Y-position and NX and NY window sizes (all
floating). N.b. the window positions are the upper left
coordinates of a window centered on the H,K spot.
<p>
<li>The reflection list document file is searched sequentially,
so you will encounter an error if the keys are not entered
in ascending order.
<p>
<li>If fewer than three spots are to be used in option 'R', you are
returned to ".OPERATION:"; if there are three spots, the appropriate
equations are solved exactly; if there are more than three and
fewer than twenty spots, a circle is least-squares-fitted to the
coordinates of the spots; and if there are more than twenty spots,
only the first twenty are used.
<p>
<li>This operation has not been used here in years. If you have problems please
contact us.
</ol>
<p>
<dl><dt><strong>SUBROUTINES</strong>
<p>
<dd><a href="../../src/latice.f">LATICE</a>, <a href="../../src/solve.f">SOLVE</a>, <a href="../../src/spotwt.f">SPOTWT</a>, <a href="../../src/plnedg.f">PLNEDG</a>, <a href="../../src/single.f">SINGLE</a>, <a href="../../src/wftcirc.f">WFTCIRC</a></dl>
<p>
<dl><dt><strong>CALLER</strong>
<p>
<dd><a href="../../src/diff1o.f">DIFF1O</a> 
</dl>
</body>
</html>