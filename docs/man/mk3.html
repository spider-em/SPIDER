<head>
<title>SPIDER: MK 3 (Marker based alignment - double tilted images)</title>
   <link rel='stylesheet' href='niceman.css' type='text/css' />
   <link rel='stylesheet' type='text/css' href='../buttons.css' />

</head>

<body>
<!-- Begin Buttons -->
<table>
<tr>
  <td><a href="../spider.html"                 id="spider">    </a></td>
  <td><a href="../user_doc.html"               id="work">      </a></td>
  <td><a href="../operations_doc.html"         id="index">     </a></td>
  <td><a href="../documents.html"              id="help">      </a></td>
  <td><a href="../faq.html"                    id="faq">       </a></td>
  <td><a href="../documents.html#2D"           id="techs">     </a></td>
  <td><a href="../techs/recon1a/Docs/mr1.html" id="recon">     </a></td>
  <td><a href="../formats.html"                id="menu">      </a></td>
  <td><a href="../installation.html"           id="install">   </a></td>
  <td><a href="../release.html"                id="new">       </a></td>
  <td><a href="https://spider-em.github.io/Web" id="web"> </a></td> 
</tr>
</table>
<br><hr>
<!-- End Buttons -->

<h2>MK 3 - Marker based alignment - double tilted images</h2>
<em>(9/29/06)</em><br />
<p>
<dl><dt><strong>PURPOSE</strong>
<p>
<dd>Determine shift parameters to align a two sets of tilt
images (double tilt) based on coordinates of markers on
the images.
&nbsp; <a href="../exa/mk3.html">Example</a>.
</dl>
<p>
<dl><dt><strong>SEE ALSO</strong>
<p>
<dd><table><tr><td><a href="mk.html"><strong>MK</strong></a></td><td> [Marker based alignment - single tilted images]</td></tr>
<tr><td><a href="rtsq.html"><strong>RT SQ</strong></a></td><td> [Rotate and Shift - image, Quadratic interpolation ||]</td></tr>
<tr><td><a href="vora.html"><strong>VO RA</strong></a></td><td> [Vector Operation - Rotate Angular doc file]</td></tr>
</table></dl>
<p>
<dl><dt><strong>USAGE</strong></dt>
<p>
<dd>.OPERATION: MK 3<br />
<p>
<dd>.FIRST SERIES MARKER INPUT DOC FILE: CRA002<br />
[Enter the name of the document file in which the 3-D marker
coordinates (X,Y,Z) for the first single-tilt series are
stored. This will be reference model.]
<p>
.SECOND SERIES MARKER INPUT DOC FILE: CRB002<br />
[Enter the name of the document file in which the 3-D marker
coordinates (X,Y,Z) for the second single-tilt series are
stored. This model will be aligned to the first and the
corresponding new <a href="../euler.html">Eulerian angles</a> will be written to the
file below.]
<p>
.NAME FOR OUTPUT CORRECTIONS DOC FILE: C3C202<br />
[Enter the name of the output document file in which
the <a href="../euler.html">Eulerian angles</a> and scale needed to merge the two tilt
series will be stored (see note 2).]
<p>
.SECOND SERIES ANGULAR INPUT DOC FILE: ANG002<br />
[Enter the name of the document file with the original
tilt angles from the second series. If the angles were
refined when using MK, enter instead the name of the
document file with the corrections (e.g. CCB002). Only the
second column, which contains the tilt angle (theta), is
used.]
<p>
.CORRECTED ANGULAR OUTPUT DOC FILE: ANGLES_SECOND<br />
[Enter the name of the output angular document file in which
the modified <a href="../euler.html">Eulerian angles</a> for the images in the second
tilt series will be stored.
These angles are the same as would result from application
of the 'VO RA' command using the <a href="../euler.html">Eulerian angles</a> between
the two tilt series, as found by the current run of 'MK 3'.
<br />
Enter "*" if you do not want this file to be produced.]
<p>
.ALIGNMENT/ERRORS OUTPUT FILE: ERRORS_BOTH<br />
[Enter the name of the output document file in which the
X,Y,Z coordinates of the aligned markers will be stored.
In the fourth column, the error of each marker is stored.
In addition, under key "-1", the total error is stored.
<br />
Enter "*" if you do not want this file to be produced.]
<p>
</dl>
<p>
<strong>NOTES</strong>
<ol>
<p>
<li>Input document files must have 3D marker coordinates stored
X - first column, Y - second column, Z - third column.
The number of markers has to be exactly the same in both the
input document files.
The order of marker coordinates has to be the same in both
the input document files (marker #3 in the first file has to
correspond to the marker #3 in the second file).
Both sets of markers should have their centers of gravity
at point (0,0,0).
<p>
<li>The document file with corrections has the following
format: <br />
Key=1 : <a href="../euler.html">Eulerian angles</a> psi, theta, phi. <br /> <br />
Key=2 : scale, xshift, yshift, zshift <br />
<br />
The <a href="../euler.html">Eulerian angles</a> stored at Key=1 are used to modify
the <a href="../euler.html">Eulerian angles</a> of the second-series angular document
file, as in the command 'VO RA'.
<br />
The scale stored at Key=2 has to be used to modify the input
images from the second series to adjust their scale to the
first series (using command 'RT SQ'). <br />
The shifts stored at Key=2 are all zero (shift calculation
has never been implemented).
<p>
<li>Written by: Paul A. Penczek
</ol>
<p>
<dl><dt><strong>SUBROUTINES</strong>
<p>
<dd><a href="../../src/mrk3.f">MRK3</a>, <a href="../../src/mrcg3.f">MRCG3</a>, <a href="../../src/mrquater.f">MRQUATER</a>, <a href="../../src/mrrotate.f">MRROTATE</a>, <a href="../../src/mrscale3.f">MRSCALE3</a>, <a href="../../src/mrerror.f">MRERROR</a>, <a href="../../src/mrdoccor.f">MRDOCCOR</a>, <a href="../../src/mrnewangle.f">MRNEWANGLE</a>, <a href="../../src/cald.f">CALD</a></dl>
<p>
<dl><dt><strong>CALLER</strong>
<p>
<dd><a href="../../src/util3.f">UTIL3</a> 
</dl>
</body>
</html>