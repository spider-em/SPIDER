<head>
<title>SPIDER: FF PLOT (Fourier - Filter design)</title>
   <link rel='stylesheet' href='niceman.css' type='text/css' />
   <link rel='stylesheet' type='text/css' href='../buttons.css' />

</head>

<body>
<!-- Begin Buttons -->
<table>
<tr>
  <td><a href="../spider.html"                 id="spider">    </a></td>
  <td><a href="../user_doc.html"               id="work">      </a></td>
  <td><a href="../operations_doc.html"         id="index">     </a></td>
  <td><a href="../documents.html"              id="help">      </a></td>
  <td><a href="../faq.html"                    id="faq">       </a></td>
  <td><a href="../documents.html#2D"           id="techs">     </a></td>
  <td><a href="../techs/recon1a/Docs/mr1.html" id="recon">     </a></td>
  <td><a href="../formats.html"                id="menu">      </a></td>
  <td><a href="../installation.html"           id="install">   </a></td>
  <td><a href="../release.html"                id="new">       </a></td>
  <td><a href="https://spider-em.github.io/Web" id="web"> </a></td> 
</tr>
</table>
<br><hr>
<!-- End Buttons -->

<h2>FF PLOT - Fourier - Filter design</h2>
<em>(04/14/95)</em><br />
<p>
<dl><dt><strong>PURPOSE</strong>
<p>
<dd>Designs optimal 2-D or 3-D filters in Fourier or real space
by the use of Remez exchange algorithm and subsequent
McClellan transform. Plots Remez, Gauss or Fermi type filters.
</dl>
<p>
<dl><dt><strong>SEE ALSO</strong>
<p>
<dd><table><tr><td><a href="ff.html"><strong>FF</strong></a></td><td> [Filter - Fourier]</td></tr>
<tr><td><a href="fq.html"><strong>FQ</strong></a></td><td> [Filter - Quick Fourier, High, low pass, etc., Padded ||]</td></tr>
<tr><td><a href="rc.html"><strong>RC</strong></a></td><td> [Real Convolution ||]</td></tr>
</table></dl>
<p>
<dl><dt><strong>USAGE</strong></dt>
<p>
<dd>.OPERATION: FF PLOT<br />
<p>
<dd>.(F)ERMI, (G)AUSS, (B)UTTER OR (R)EMEZ FILTER? (F/G/B/R): R<br />
[Enter the name of the filter to be designed. The first three
options produce the drawing of the filter for the
given set of parameters.]
<p>
</dd> <dt>For Fermi Filter SPIDER asks:
</dd> <dd><div class="opt_inp">
<p>
.PLOT X-DIMENSION:<br />
[Enter vertical length of the plot.]
<p>
.(L)OWPASS, (H)IGHPASS, OR (B)ANDPASS? (L/H/B):<br />
[Enter type of the filter to be plotted]
<p>
.FERMI CUTOFF RADIUS, TEMP. FACTOR:<br />
[Enter cutoff frequency and temperature factor.]
</div>
<p>
</dd> <dt>For Bandpass filter SPIDER asks:
</dd> <dd><div class="opt_inp">
<p>
.FERMI CUTOFF RADIUS.,TEMP.FACTOR:<br />
[Enter cutoff frequency and temperature factor for the second
cutoff.]
</div>
<p>
</dd> <dt>For Gaussian Filter SPIDER asks:
</dd> <dd><div class="opt_inp">
<p>
.PLOT X-DIMENSION:<br />
[Enter vertical length of the plot.]
<p>
.(L)OWPASS, (H)IGHPASS, OR (B)ANDPASS? (L/H/B): B<br />
[Enter type of the filter to be plotted]
<p>
.RADIUS:<br />
[Enter cutoff frequency]
<p>
.(M)ULTIPLICATIVE, (A)DDITIVE:<br />
[Enter type of the filter.]
</div>
<p>
</dd> <dt>For Butterworth filter SPIDER asks:
</dd> <dd><div class="opt_inp">
<p>
.PLOT X-DIMENSION:<br />
[Enter vertical length of the plot.]
<p>
.(L)OWPASS, (H)IGHPASS (L/H):<br />
[Enter type of the filter to be plotted.]
<p>
.PASS-BAND AND STOP-BAND FREQUENCY:<br />
[Enter the two frequencies.]
<p>
.LIKE AN EXAMPLE WITH STEP FUNCTION??(Y/N):<br />
[If answer is "Y" then it gives the plot of a step function
and how it looks like when it is filtered using the
Butterworth filter with the given parameters.
NOTE: This currently works only for dimension (of plot)
equal to powers of two only.
If answer is "N" then you are back to operation command].
</div>
<p>
</dd> <dt>For Remez filter SPIDER asks:
</dd> <dd><div class="opt_inp">
<p>
.IMPULSE RESPONSE LENGTH: 17<br />
[Enter the impulse response length. It should be odd, not larger
then 59, and never larger than the actual size of Fourier space
filter or smaller than 3.]
<p>
.NUMBER OF BANDS: 3<br />
[Enter the number of pass- or stop- bands in freq. space
for a filter to be designed (at least 2).]
<p>
.BAND # i - LOWER AND UPPER EDGES: 0.1,0.14<br />
[Enter the edges boundaries for each band.]
<p>
.BAND # i - DESIRED VALUE: 2.3<br />
[Enter the desired filter for each band (e.g. 0.0 or 0.5 or
1.0 or 3.0).]
<p>
.BAND # i - WEIGHTING: 1<br />
[Enter the weight for each band; this specifies the relative
error of approximation allowed in a given band]
<p>
.PLOT FREQUENCY RESPONSE (Y/N): Y<br />
[Enter 'Y' if you want the plot of frequency response]
<p>
.DO YOU LIKE YOUR FILTER (Y/N): Y<br />
[Enter 'Y' if you are satisfied with approximation obtained.
Otherwise you go back to the first step.]
<p>
.FILTER FILE: FIL001<br />
[Enter name of file where filter is to be stored.]
<p>
.FILTER DIMENSIONS (NX,NY): 128,64<br />
[Enter dimensions of resulting filter in Fourier space.
If 0 then PSF is stored to be subsequently used in
'RC' operation for real space filtering.]
<p>
.NUMBER OF SLICES (NZ): 32<br />
[Enter number of slices for 3-D filter file. If 0 then a 2-D
filter is produced, if &gt;0 then a 3-D filter.]
</div>
<p>
</dd> <dt>If you answered RETURN for (NX,NY) SPIDER asks:
</dd> <dd><div class="opt_inp">
<p>
.PRODUCE 2-D OR 3-D PSF (2/3)?: 3<br />
[Enter 2 or 3, and the file containing Point Spread Function
of the appropriate dimensions is stored (to be used for
filtering with RC).
</div>
<p>
</dl>
<p>
<strong>NOTES</strong>
<ol>
<p>
<li>Frequency units are absolute units (independent of image size)
in the range 0.0 &lt;= f &lt;= 0.5 (0.5 is the highest value).
The following two equations can be used to convert frequency
units into pixel units for (p=0 ... (nx/2) ): <br />
p = 2 * f * (NX / 2) <br />
f = 0.5 * p / (NX / 2) <br />
<p>
<li>For description of the Remez exchange algorithm see any book
on digital filter design.
<p>
<li>For the description of 2-D McClellan
transformation algorithm see: <i>'Digital filters and their
applications'</i> Cappellini V., Constantinides A.G., Emiliani P.
<p>
<li>For the description of the Butterworth filter see
<i>Signal processing algorithms</i> Samuel D.Stearns, Ruth A.David.
<p>
<li>Remez option implemented by: Paul Penczek.
</ol>
<p>
<dl><dt><strong>SUBROUTINES</strong>
<p>
<dd><a href="../../src/filtplot.f">FILTPLOT</a>, <a href="../../src/fermp.f">FERMP</a>, <a href="../../src/gaussp.f">GAUSSP</a>, <a href="../../src/buterp.f">BUTERP</a>, <a href="../../src/remezp.f">REMEZP</a>, <a href="../../src/mrkur3.f">MRKUR3</a>, <a href="../../src/rot_p.f">ROT_P</a>, <a href="../../src/opsf_p.f">OPSF_P</a>, <a href="../../src/rot3_p.f">ROT3_P</a>, <a href="../../src/opsf3_p.f">OPSF3_P</a>, <a href="../../src/inf_q.f">INF_Q</a>, <a href="../../src/inf3_p.f">INF3_P</a>, <a href="../../src/fmrs_2.f">FMRS_2</a>, <a href="../../src/fmrs_3.f">FMRS_3</a></dl>
<p>
<dl><dt><strong>CALLER</strong>
<p>
<dd><a href="../../src/four1.f">FOUR1</a> 
</dl>
</body>
</html>