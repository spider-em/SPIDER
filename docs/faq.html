<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html>
<head>
   <title>FAQ : SPIDER &amp; WEB</title>
   <style type="text/css">
      code { font-weight:normal; }
      pre  { font-weight:normal; }
      kbd  {font-family:Courier,"Courier New",monospace;}
   </style>

   <link rel='stylesheet' type='text/css' href='./buttons.css' />

</head>
<body>
<!-- Begin Buttons -->
<table>
<tr>
  <td><a href="./spider.html"                 id="spider">    </a></td>
  <td><a href="./user_doc.html"               id="work">      </a></td>
  <td><a href="./operations_doc.html"         id="index">     </a></td>
  <td><a href="./documents.html"              id="help">      </a></td>
  <td><a href="./faq.html"                    id="faq">       </a></td>
  <td><a href="./documents.html#2D"           id="techs">     </a></td>
  <td><a href="./techs/recon1a/Docs/mr1.html" id="recon">     </a></td>
  <td><a href="./formats.html"                id="menu">      </a></td>
  <td><a href="./installation.html"           id="install">   </a></td>
  <td><a href="./release.html"                id="new">       </a></td>
  <td><a href="https://spider-em.github.io/Web" id="web"> </a></td> 
</tr>
</table>
<br><hr>
<!-- End Buttons -->


<h1 align="center">FAQ : SPIDER &amp; WEB</h1>

<hr />
<h3 align="center">Contents</h3>

<ul>

<li><big>Why is <a href="#toomany"> SPIDER slow when accessing lots of windowed images</a>/
    </big></li>

<li><big>Howto <a href="#contour"> generate a contour plot of an image?</a>
    </big></li>

<li><big>Howto  
    <a href="#protocol"> prevent poll: protocol failure</a> when using PubSub?
    </big></li>

<li><big>What <a href="#2gb">about large (>2GB) stacks in SPIDER</a>
   ?</big></li>

<li><big>Howto <a href="#vol">obtain the volume of a density map
   displayed with a given threshold</a> ?</big></li>

<li><big>Howto <a href="./fftw.html">use FFTW (Fastest Fourier
   Transform in the West)</a> with SPIDER?</big></li>

<li><big>Howto <a href="#processors">set number of processors
   SPIDER uses</a> on OMP machines?</big></li>

<li><big>Howto <a href="#GATAN">import images from GATAN CCD
   camera</a> into SPIDER?</big></li>

<li><big>Howto <a href="#import">import TIFF images</a> into
   SPIDER?</big></li>

<li><big>Howto <a href="#use">use a reference to align my 2-D
   images?</a></big></li>

<li><big>Howto <a href="#compare">compare a simple 3-D model for my
   molecule</a> with my SPIDER model?</big></li>

<li><big>Howto <a href="#determine">determine the resolution of a
   reconstruction?</a></big></li>

<li><big>Howto <a href="#correct">correct averaged images from two
   different defoci?</a></big></li>

<li><big>Why <a href="#rt3d">doesn't 'RT 3D' rotate boundary
   areas?</a></big></li>

<li><big>Why does <a href="#rt3da">'RT SQ' produce an
   "artefact"</a> in slices for some angles.</big></li>

<li><big>Howto <a href="#surface">create surface models of SPIDER
   volumes?</a></big></li>

<li><big>Howto <a href="#shadow">improve shadowed
   images?</a></big></li>

<li><big>Is there a problem with <a href="#contrast">differential
   contrast</a> of DNA and protein in SPIDER
   reconstructions?</big></li>

<li><big>Howto <a href="#ccp4">convert CCP4</a> files to SPIDER
   format?</big></li>

<li><big>Is SPIDER useful in image averaging and <a href=
   "#afm1">3-D reconstruction for AFM?</a></big></li>

<li><big>What are <a href="#definitions">definitions of astigmatism
   and azimuth</a> in the 'TF' operation?</big></li>

<li><big>Is there any operation which <a href=
   "#normalized">normalizes images at slightly different
   magnifications</a> before image averaging?</big></li>

<li><big>How does <a href="#align">alignment with 'AP SH' or 
   'AP MD' work with negative pixel values?</a></big></li>

<li><big>Howto <a href="#ar">rescale an image's range to 0 - 255
   using 'AR'?</a></big></li>

<li><big>Howto <a href="#drift">correct for drift in images</a> by
   Wiener filtering for example?</big></li>

<li><big>Howto <a href="#missing">deal with missing markers when
   using the 'MK' operation</a> for alignment in tomographic
   reconstructions?</big></li>

<li><big>Howto <a href="#x">use WEB to represent surfaces from
   crystallographic maps?</a></big></li>

<li><big>What is <a href="#pdb">position of a location in a SPIDER
   volume made from a PDB map?</a></big></li>

<li><big>What does <a href="#casi">CA SI do?</a></big></li>

<li><big>Howto <a href="#color">set color of the menu text and
   background in WEB?</a></big></li>

<li><big>Howto <a href="#pick">pick particles in
   SPIDER/WEB?</a></big></li>

<li><big>Howto <a href="#view">view particles from low defocus
   micrographs using WEB?</a></big></li>

<li><big>Howto <a href="#work">use 8 bit WEB on Linux</a> without
   permanently switching your only display to 8 bit mode?</big></li>

<li><big>Howto <a href="#viewimg">view SPIDER images</a> without
   using <i>Web</i>?</big></li>
</ul>

<hr />

<dl>



<p><a name="toomany"></a></p>
</dd>
<dt>QUESTION</dt>
<dd>Why is SPIDER slow with lots of windowed images?</dd>
<dt>ANSWER</dt>

<dd>If you have over a few thousand windowed images then you <b>SHOULD</b>
    always place the images in a 
    <a href="./user_doc.html#file_stack">SPIDER stack file</a>. 
    <br />
    otherwise there will be severe thrashing of the file system leading
    to very poor performance of <b>any</b> system operation, e.g. <i>ls</i>, 
    and poor performance of SPIDER.  This is not a SPIDER issue, it it a
    filesystem isssue.
</dd>

<p><a name="contour"></a></p>
<dt>QUESTION</dt>
<dd>Howto generate a contour plot?</dd>
<dt>ANSWER</dt>

<dd>Using the operation <a href="./man/co.html">CO</a> you choose
levels and increments according to the information you are trying to
get.  The smaller the increments, the more finely you get a sense of
the density distribution in your image.  Contouring raw,
noisy images makes no sense -- you should only apply contouring to
average images or highly low-pass-filtered images.  You want to pick
start and end level normally as the lowest and highest value occurring
in the image, so the contour diagram will give you information about
the entire value range, unless you want to suppress some of that
range. Note also that there is an option to create contouring directly
overlayed on the image -- the <a href="./man/fc.html">FC</a> operation.
This produces more informative and esthetically pleasing contour maps.  
To use this option, you must first create a large version of the image 
using the <a href="./man/ip.html">IP</a>IP
operation, otherwise the contours will look very pixelated.</dd> 

<p><a name="2gb"></a></p>
<dt>QUESTION</dt>
<dd>What about large (>2GB) stacks or voumes in SPIDER</dd>
<dt>ANSWER</dt>

<dd>With most compilations, SPIDER can create and
    access disk based files > 2GB.  Some compilations on a 32 bit OS
    may be limited to these small volumes.  I suggest you switch to a
    64 bit OS if you are having troubles. </dd> 
   

<p><a name="vol"></a></p>
<dt>QUESTION</dt>
<dd>Howto obtain the volume of a density map displayed with a given
   threshold?</dd>
<dt>ANSWER</dt>
<dd>Use the <a href="./man/hir.html">HI R</a> operation and set
   lower range desired threshold THRESH and upper range byond the file
   maximum. The number of PIXELS IN HISTOGRAM is the volume VOLP in
   units of pixel**3. To obtain the actual volume, multiply VOLP with
   the volume of a voxel, which is the (Angstroms per pixel)**3. Note
   that everytime you change the theshold THRESH, you have to repeat
   this analysis.</dd>




<p><a name="processors"></a></p>
</dd>
<dt>QUESTION</dt>
<dd>How do I set the number of processors SPIDER uses on a
    SMP multiprocessor machine using OMP?</dd>
<dt>ANSWER</dt>

<dd>Number of processors is set before (or during) a run. There are
    two methods you can use to control this.<br />
   <ul>
   <li>The Environment variables: MP_SET-NUMTHREADS and 
   MP-SUGNUMTHD can be used to control number of processors. </li>
   <li>SPIDER
   has suboption to the <a href="./man/md.html">MD</a> operation
   called:. "SET MP" to allow fine control of number of processors
   during the run. See Unix man for <i>mp_set_numthreads</i> for more
   info.</li>
   </ul></dd>

<p><a name="GATAN"></a></p>
<dt>QUESTION</dt>
<dd>How to import images from GATAN CCD camera into SPIDER?</dd>
<dt>ANSWER</dt>

<dd>
; -- Procedure to import images from GATAN to SPIDER 
<table>
<tr><td>DO  [num]=1,7</td>                   <td> ; LOOPs over the micrograph number </td></tr>
<tr><td>&nbsp;&nbsp CP FROM RAW </td>        <td> ; Copy operation </td></tr>
<tr><td>&nbsp;&nbsp;  (16) </td>             <td> ; How many bits </td></tr>
<tr><td>&nbsp;&nbsp;  mic/mic{***[num]}</td> <td> ; Input file name, indexed by counter </td></tr>
<tr><td>&nbsp;&nbsp;  (1024 1024) </td>      <td> ; Input file dimensions </td></tr>
<tr><td>&nbsp;&nbsp;  (8)  </td>             <td> ; Skip header bytes </td></tr>
<tr><td>&nbsp;&nbsp;  (1) </td>              <td> ; Most significant byte </td></tr>                                 
<tr><td>&nbsp;&nbsp;  N   </td>              <td> ; Do not fold negatives  </td></tr>             
<tr><td>&nbsp;&nbsp;  mic/spi{***[num]} </td><td> ; Output file name, indexed by counter </td></tr>
<tr><td>ENDDO</td>                           <td> ; End of LOOP</td></tr>
<tr><td>EN</td>                              <td> ; End of procedure </td></tr>
</table>
</dd>


<p><a name="use"></a>/p>
<dt>QUESTION</dt>
<dd>How do I use a single reference to align my 2-D images?</dd>
<dt>ANSWER</dt>

<dd>There are two operations in SPIDER that can be used for a
   reference-based alignment. Their original purpose was
   multi-reference alignment, but by limiting the number of reference
   images to one one can perform a reference-based alignment of 2D
   data. The operations are called <a href="./man/apsh.html">AP SH</a>
   and <a href="./man/apmr.html">OR SH</a>. 
   Both operations are very simple and
   they do not require any procedure programs. The alignment
   parameters found can be applied to the data using procedure
   programs included in the respective manual chapters.</dd>


<p><a name="compare"></a></p>
<dt>QUESTION</dt>
<dd>I have a simple 3-D model for my molecule. How can I compare
   this model with my SPIDER model?</dd>
<dt>ANSWER</dt>

<dd>This is done using a 3D projection alignment procedure. It is
   based on operation <a href="./man/apmd.html">AP MD</a>. The
   corresponding manual chapter contains an example of the whole
   procedure. It assumes that a SPIDER volume containing a reference
   structure is available.</dd>


<p><a name="determine"></a></p>
<dt>QUESTION</dt>
<dd>How to Determine the resolution of a reconstruction.</dd>
<dt>ANSWER</dt>

<dd>Using operation <a href="./man/asr.html">AS R</a> one can
   obtain averages corresponding to odd- and even-numbered images.
   (sample procedure file:)   <br />
   <dl><kbd>
   <dd>AS R</dd>
   <dd>data/my_images****</dd>
   <dd>1-2200</dd>
   <dd>O</dd>
   <dd>aveodd001</dd>
   <dd>varodd001</dd>
   <dd>aveven001</dd>
   <dd>vaeven001</dd>
   <dd>EN</dd>
   <kbd></dl>

  The averages can be compared using operation <a href="./man/rf.html">"RF"</a>.
  This operation will produce a document file with R-factor, 
  phase residual, and Fourier ring correlation measures.

<p>Alternatively, operation <a href="./man/rfsn.html">"RF SN"</a> can be used 
   on the image series
   to obtain spectral-signal-to-noise-ratio measure of the resolution
   (sample procedure file:)  <br />
   <dl><kbd>
   <dd>RF SN               </dd>
   <dd>ddata/my_images**** </dd>
   <dd>select &nbsp;&nbsp;  ; Selection document file, see the manual file</dd>
   <dd>mask   &nbsp;&nbsp;  ; Mask image fine defining region of interest</dd>
   <dd>0.5        </dd>
   <dd>ssnr_doc   </dd>
   <kbd></dl>
</p>
</dd>

<p><a name="correct"></a></p>
<dt>QUESTION</dt>
<dd>I have two averaged images that are at two different defoci.
    How do I correct one to match the other?</dd>
<dt>ANSWER</dt>

<dd>Due to a low SNR in 2D image data we do not apply CTF
   correction on these images. Instead, we correct for the CTF final
   3D reconstructions. This is done (for any number of volumes) using
   <a href="./man/tfctf.html">TF CTF</a> operation. Fourier volumes
   containing CTFs for all the defocus sets are needed and they can be
   created using operation: <a href="./man/tfc3.html">TF C3</a>. Other
   CTF operations are grouped under operation "TF".</dd>


<p><a name="rt3d"></a></p>
<dt>QUESTION</dt>
<dd>When the <a href="./man/rt3d.html">RT 3D</a> operation rotates
   a volume by 45,0,0 degrees (phi, theta, psi), why isn't the last
   Z-slice rotated?</dd>

<dt>ANSWER</dt>

<dd>This is not an error, it is supposed to work this way. To
   rotate the volume one has to interpolate it. The 'tri-linear'
   interpolation requires that for a voxel (i,j,k) the neighbouring
   voxels are available as well, i.e., voxels (i+1,j,k), (i,j+1,k),...
   ,(i+1,j+1,k+1). If the neighbouring voxels are unavailable (they
   are outside of the field or in the corners) the current voxel is
   left unchanged. Thus, to rotate last slice, k=NSLICE, one would
   need values at NSLICE+1, which are unavailable. Thus, the last
   slice is left without change.<br />
   If you want to rotate volume around Z axis (angles=(psi,0,0)) you
   can use the operation <a href="./man/rt3q.html">RT 3Q</a>, which
   will rotate all the slices by the same angle around Z axis.</dd>


<p><a name="rt3da"></a></p>
<dt>QUESTION</dt>
<dd>Why does <a href="./man/rtsq.html">RT SQ</a> produce an
   "artifact" in slices for some angles.</dd>
<dt>ANSWER</dt>

<dd>The 'RT SQ' operation assumes that the 2D image (in your case
   it is a volume, but 'RT SQ' operates on Z-slices independently, so
   we can discuss 2D case only) is "circularly closed", or "wrapped
   around". Assume that pixels are numbered from -N to N (this you can
   always do by subtracting image center). Thus, according to RT SQ
   pixels number -N-1 is equivalent to pixel +N. In case of corner
   pixels and rotation angles close to 45 degrees the corners upon
   rotation will end up close to the center (if you rotate point (N,N)
   by 45 degrees it will have coordinates (1.41*N,0), and according to
   the rule described (-0.41*N,0) - close to the center).

<p>Command "RT SQ" was designed to work for objects that are
   surrounded by noise. In this case it makes sense to put noise in
   the corners. For model objects, such as yours, it will create
   "artifacts". Since upon rotation the corners always stick out
   beyond the image frame one is free to decide what should be put
   there.</p>

<p>In the manual, each rotation operation has a remark stating
   which convention was used. <a href="./man/rt3d.html">RT 3D</a>, for
   example, leaves corners intact and will work better for your
   object. <a href="./man/rtb.html">RT B</a> leaves you a possibility
   to supply your own value that will fill the corners. Please note
   that only "RT SQ" uses quadratic interpolation.</p>
</dd>


<p><a name="shadow"></a></p>
<dt>QUESTION</dt>
<dd>I have a collection of high-resolution rotary shadowed images
   of various proteins. Can I use SPIDER image processing and analysis
   to improve the data gained from these images?.</dd>
<dt>ANSWER</dt>

<dd>On the basis of the fact that all images represent equally and
   isotropically treated particles, it should be possible to use
   alignment algorithms provided in SPIDER, and obtain a 2D average.
   However, 3D information cannot be retrieved -- the retrieval of the
   3D profile would require unidirectional shadowing and the use of a
   filter that Smith and Kistler developed several years ago. This
   filter is not implemented in SPIDER, but it could be added. <br />
   <p>Other than that, SPIDER could be used for all kinds of more or
   less cosmetic operations such as contrast enhancement and high- or
   low-pass filtration.</p>
</dd>

<p><a name="contrast"></a></p>
<dt>QUESTION</dt>
<dd>We have come across a curious phenomenon in imaging nucleosomes
   using cryo-EM. Images of unstained frozen hydrated nucleosomes are
   dominated by contrast from the peripheral (~100KDa) DNA component,
   while the central protein assembly (also ~100KDa, but occupying a
   smaller volume) has a density very close to the background ice. CTF
   correction has little effect on the contrast.   
 
<p>I had assumed that the differential contrast was related to the
   high <i>P</i> content of the DNA, but have now used the nucleosome
   X-ray coordinates and SPIDER's <a href="./man/cpfrompdb.html">'CP
   from PDB'</a> to simulate projection images. These show strong, and
   approximately equal, contrast from both the DNA and protein
   components, in other words, no differential contrast is
   observed.</p>
</dd>
<dt>ANSWER</dt>
<dd>Currently SPIDER uses only the phase contrast component,
   transferred with sin(gamma), for simulations of EM images from
   atomic coordinates. The differential contrast between DNA and
   protein core in nucleosomes that you see with cryo-EM is produced
   by the increased amplitude contrast ("anomalous scattering") of the
   P atoms. When we have a chance to incorporate both amplitude and
   phase contrast in the modeling procedure, I'm sure you will find a
   close match between theory and experiment.</dd>


<p><a name="ccp4"></a></p>
<dt>QUESTION</dt>
<dd>How to convert CCP4 files to SPIDER format?</dd>
<dt>ANSWER</dt>
<dd>Use <a href="./man/cpfromccp4.html">COPY FROM CCP4</a>.</dd>

<p><a name="afm1"></a></p>
<dt>QUESTION</dt>
<dd>Is SPIDER useful in image averaging and 3-D reconstruction for
   AFM? If I imaged molecules in different orientations on a surface
   and I could deconvolute the effect of my AFM tip from the image,
   can I use SPIDER in any way to help to 3-D average or reconstruct
   the imaged molecules?</dd>
<dt>ANSWER</dt>

<dd>There are operations in SPIDER that you can use for averaging
   or deconvolution. What you get from AFM is surface topology; i.e.,
   a segment of the molecular surface. At best, you can put the entire
   molecular surface back together from such segments, if you 1) have
   copies of the same molecule lying in different orientations and 2)
   have a way to quantitatively determine these orientations. This
   would be a process similar to putting the shell of an Easter egg
   together from its pieces. (I'm saying Easter egg, since the normal
   egg is quite symmetric, but the Easter egg fits the analogy better
   since it is painted with a hopefully asymmetric pattern).<br />
<br />
   But you should note that all operations in SPIDER that are related
   to the determination of orientations or 3D reconstruction address
   an entirely different problem, namely to interpret and make use of
   2D projections of a 3D density distribution.<br />
<br />
   Therefore, the answer to your question is: yes, you will find
   SPIDER quite useful in helping you to analyze and process images,
   but no, it will not help you with the specific problem of Easter
   egg-type 3D reconstruction.</dd>


<p><a name="definitions"></a></p>
<dt>QUESTION</dt>
<dd>I want to make astigmatic CTF functions, and am confused by
   your definitions of "astigmatism and azimuth". The definition of
   astigmatism that I know has a long and a short axis which define
   the ellipse, and an angle that defines the orientation of the long
   dimension of the ellipse relative to your X and Y axes. I don't
   understand how this relates to the azimuth in your operations which
   is defined as "the angle, in degrees, that characterizes the
   direction of astigmatism. The angle defines the origin direction
   where the astigmatism has no effect."<br />
   What are definitions of astigmatism and azimuth in the <a href=
   "./man/tf.html">TF</a> operation?.</dd>

<dt>ANSWER</dt>

   <dd>In the SPIDER operation, the zero azimuth points into the
   direction where the astigmatic focus difference has no effect;
   i.e., 45 degrees away from your definition. This is practical as a
   definition , since in this case the astigmatism term simply adds to
   the mean defocus.</dd>


<p><a name="align"></a></p>
<dt>QUESTION</dt>
<dd>I am aligning particles using either <a href=
   "./man/apmd.html">AP MD</a> or <a href="./man/apsh.html">AP SH</a>.
   The protein is "white" and there are nanogold labels on the protein
   that are "black" (essential negative pixel values). My
   understanding is that SPIDER alignments only pay attention to the
   white or positive pixel values and not the black negative pixel
   values? As long as I normalize the images (avg=0, sd=1), is this
   truly the case? Will I have alignment difficulties from alignment
   of the small nanogold dots to each other?</dd>
<dt>ANSWER</dt>

<dd>That's incorrect. Alignment algorithms take into account the
   whole density range, without paying attention to the (arbitrary)
   polarity. Such dots would tend to align to each other, compromising
   the overall alignment of the protein part.</dd>


<p><a name="normalized"></a></p>
<dt>QUESTION</dt>
<dd>Is there any operation in SPIDER which allows images at
   slightly different magnifications to be normalized with respect to
   each other before image averaging?</dd>
<dt>ANSWER</dt>

<dd>Operation <a href="./man/ip.html">'IP'</a> will re-interpolate
   an image onto a new grid, so it will help re-scale to make up for a
   magnification change. Combine it with either <a href=
   "./man/pd.html">'PD'</a> (pad) or <a href="./man/wi.html">'WI'</a>
   (window) to get back to the same dimensions. However, we don't have
   a single operation that will let you <b>DETERMINE</b> the
   magnification change. The corresponding mathematical operation is
   the Mellon transform, which is not implemented. You can however
   write a simple procedure with a do-loop trying out different scale
   changes (using 'IP', etc. as explained above) followed by a 'CC C'
   operation, taking care that you keep the images centered, and that
   you only compare non-padded portions of the images.</dd>


<p><a name="import"></a></p>
<dt>QUESTION</dt>
<dd>How to import TIFF images into SPIDER?</dd>
<dt>ANSWER</dt>

<dd>Many black and white TIFF files consist of 8 or 16 bit raw data
   preceeded by a fixed length (often 1024 byte) header. They can
   sometimes be converted to SPIDER format using the 
   <a href= "./man/cpfromraw.html">CP FROM RAW</a> operation. 

   <table><kbd>
   <tr><td>CP FROM RAW</td>  <td> ; Copy operation</td></tr> 
   <tr><td>8</td>            <td> ; How many bits </td></tr>
   <tr><td>imgin</td>        <td> ; Input file name </td></tr>
   <tr><td>512 512</td>      <td> ; Input file dimensions </td></tr>
   <tr><td>1024</td>         <td> ; Skip header bytes </td></tr>
   <tr><td>imgout</td>       <td> ; Output file name </td></tr>
</kbd></table>
</dd>


<p><a name="ar"></a></p>
<dt>QUESTION</dt>
<dd>How to rescale an image's range to 0 - 255 using 
<a href="./man/ar.html">AR</a>?</dd>
<dt>ANSWER</dt>
<dd>Use <a href="./man/arsca.html">AR SCA</a> instead.</dd>

<p><a name="casi"></a></p>
<dt>QUESTION</dt>
<dd>What did <a href="./man/cas.html">'CA SI'</a> do?</dd>
<dt>ANSWER</dt>

<dd>CA SI read in the images and passed them through the mask -- it
   put the passed pixels into one single array (lexicographically
   ordered), which becomes one record of a sequential file. This
   sequential file is subsequently used by <a href=
   "./man/cas.html">'CA S'</a> to do the analysis. As of SPIDER
   version 10.0 this is all done within: <a href="./man/cas.html">'CA
   S'</a> and 'CA SI' is no longer used.</dd>


<p><a name="drift"></a></p>
<dt>QUESTION</dt>
<dd>Howto correct for drift in images by Wiener filtering for
   example?</dd>
<dt>ANSWER</dt>

<dd>It isn't worth the effort. The zeros mean that parts of the
   transform are completely lost. One could of course think of
   combining pictures that have undergone different amounts (and
   directions) of drift, to cover all zeros, but it is much easier to
   do the experiment right and discard the images affected by
   drift.<br />
    I'm not aware of any efforts in the EM field, for the reasons
   stated. However, I've seen literature on successful drift
   correction in general image processing applications, but note that
   in those applications the SNR is normally much higher than in EM
   images, meaning that more info can be recovered in the vicinity of
   the zeros.</dd>



<p><a name="missing"></a></p>
<dt>QUESTION</dt>
<dd>When using SPIDER marker <a href="./man/mk.html">MK</a>
   operation as part of a tomographic reconstruction proceedure, how
   do I deal with a marker that is not visible in a given projection?
   Can one just not enter data for that particular marker in the
   offending projection?</dd>
<dt>ANSWER</dt>

<dd>Sometimes it is OK to leave a marker out on one or two images,
   but in that case you must edit the marker document files so that
   the key number for the markers correspond to same gold particles on
   all the images. Either renumber the keys or pick a "dummy" for the
   missing marker, then delete that line.<br />
    It is better not to try and get by with missing markers,
   however.</dd>


<p><a name="protocol"></a></p>
<dt>QUESTION</dt>
<dd>When using PubSub I sometimes get following message and it
   quits running:<br />
<i>poll: protocol failure during circuit creation</i> What can I
   do to prevent this?</dd>
<dt>ANSWER</dt>

<dd>You may see this
   message if you attempt to run too many rsh processes. Depending on
   the particular Linux distribution, there may be a limit
   of as few as 40 processes per minute. It is possible to exceed this
   limit.<br />
    To fix this, you can do one of the following: 
    <p>
    1. Wait a few seconds between running parallel jobs. You may need
      to wait up to a minute. 
    </p>
    <p>
   2. If your system uses:/etc/inetd.conf,  modify /etc/inetd.conf to allow more
     processes per minute for rsh. For example, change: <br />
     <i>shell stream tcp nowait root /etc/tcpd2 in.rshd</i><br />
   to:<br />
    <i>shell stream tcp nowait.200 root /etc/tcpd2 in.rshd</i><br />
    </p>
    <p>
   3. If your system uses xinetd, you probably need to set the "cps" 
    field of:&nbsp;&nbsp;&nbsp;/etc/xinetd.d/rsh &nbsp;&nbsp;&nbsp; 
    to a large value such as "200 5" for xinet to handle the 
    expected traffic. We haven't tested this, but here's 
    two fields that: &nbsp;&nbsp;&nbsp;/etc/xinetd.d/rsh &nbsp;&nbsp;&nbsp; 
    should contain:<br />

   <br />
   service shell <br />
   { <br />
   cps    &nbsp; &nbsp;     = 1000 10<br />
   disable  &nbsp; &nbsp;    = no<br />
   }<br />
   <br />

After modifying this file, you'll need to restart <i>xinetd</i>
   using <i>"/etc/rc.d/init.d/xinetd restart"</i>.    
</p>
</dd>


<p><a name="x"></a></p>
<dt>QUESTION</dt>
<dd>I'am trying to fit a high-resolution X-ray model into a low
   resolution EM map. It appears that SPIDER'S WEB is capable of
   representing surfaces from maps? If so, what kind of map formats
   does WEB accept? Do you provide software for map conversion, etc?
   My maps are in 'crystallographer-friendly' formats such as CCP4 and
   XPLOR.</dd>
<dt>ANSWER</dt>

<dd>Yes, but WEB doesn't allow you to do interactive fits. You'd be
   better off using the package "O", which we use all the time. What
   we do is make preliminary displays using WEB, then prepare the
   volume using low-pass filtration as appropriate, then use an
   operation in SPIDER that makes a "map" file out of it compatible
   with "O", then display the map in "O" along with structures
   directly imported from "pdb". We also routinely import "pdb"
   structures into SPIDER and convert them to densities, then low-pass
   filter (and, if applicable, apply "CTF") them, and go the same
   route as for the cryo-volume into "O", if we want to simulate the
   appearance of the structure as seen in the microscope, and compare
   it with what we see as extra density.<br />
   Yes, both CCP4 and XPLOR data can be imported.</dd>


<p><a name="surface"></a></p>
<dt>QUESTION</dt>
<dd>How can I create a surface model from a SPIDER volume.</dd>
<dt>ANSWER</dt>

<dd>One way of visualizing surfaces contained in a SPIDER volume is
  <td><a href="https://spider-em.github.io/Web" id="web"> </a></td> 
   operation. This allows the user to generate a shaded rendering at a 
   particular threshold level within the volume.<br />

<p>To make a surface model our usual procedure is to use 
   <a href= "http://www.nag.com">NAG's Iris Explorer</a> to read SPIDER
   volumes, threshold the volume, and create a surface model in
   Inventor format. We then use a rendering viewer available in Iris
   Explorer to render the surface models. This method requires the
   Explorer module for reading SPIDER images which is free from us. It
   also requires that you purchase Iris Explorer from NAG.</p>

<p>Another user suggests converting the SPIDER volume to SGI-RGB
   images with the SPIDER operations <a href="./man/psz.html">PS Z</a>
   and <a href="./man/psz.html">CP TO SGI</a> and then importing the
   volumes images into  
   <a href=" http://www-ncmir.ucsd.edu/index.html#SP ">SYNU</a> for surface
   rendering.</p>
</dd>


<p><a name="pick"></a></p>
<dt>QUESTION</dt>
<dd>How to pick particles in SPIDER/WEB?</dd>
<dt>ANSWER</dt>
<p><dd>See: <a href="partpick.html">particle picking</a> techniques page for
    recent info.  The following older info may also be of some interest:
</dd></p>

<ol>
<li> Low pass filter the particles beforehand, with pfilt.spi</li>
<p></p>

<li>
Make sure you have previously run pnums.spi and have the doc file <b>order</b> handy. 
It lists the number of particles in each micrograph:
<kbd style="font-weight:normal;">
 ;spi/hcc   05-AUG-2004 AT 13:08:03   order.hcc  <br />
 ; / &nbsp; CUM.TOTAL, &nbsp; # PART, &nbsp; MICROGRAPH &nbsp;FIRST &nbsp; LAST   <br /> 
    1 &nbsp; 5 &nbsp; 1659.0 &nbsp; &nbsp; 1659.0  &nbsp; &nbsp;  1.0000 &nbsp; 1.0000 &nbsp; 1659.0  <br />   
    2 &nbsp; 5 &nbsp; 3585.0 &nbsp; &nbsp; 1926.0  &nbsp; &nbsp;  3.0000 &nbsp; 1660.0 &nbsp; 3585.0  <br />    
    3 &nbsp; 5 &nbsp; 5233.0 &nbsp; &nbsp; 1648.0  &nbsp; &nbsp;  4.0000 &nbsp; 3586.0 &nbsp; 5233.0  <br />    
    4 &nbsp; 5 &nbsp; 6903.0 &nbsp; &nbsp; 1670.0  &nbsp; &nbsp;  6.0000 &nbsp; 5234.0 &nbsp; 6903.0  <br />    
</kbds>
</li>

<p></p>
<li> Create the directory /Particles/good</li> 

<p></p>
<li>run <b>WEB</b>

<ol type="a">
    <p></p>
    <li><i>Command/Categorize from sequential montage</i><br />
    input file: <b>Don't use the filter!</b> It will try to read in 
    tens of thousands of filenames. Instead, go to the bottom line and type
    in the file name: <code>....../Particles/win/ser00001.acn</code><br />
    last file: should be the first file number + about 50 (a screenful of particles).
    </li>
    <li>(then the particles load)</li>

    <li>
    When it asks for a document file, enter <code>"good/good015"</code>,
    where 015 is the micrograph number.
    </li>

    <li>
    For each new good doc file (i.e. when you start the next micrograph), 
    the particle number starts at 1.
    </li>


    <li>
    Then pick particles by clicking. If you make a mistake you have to later
    edit the good*** document file.
    </li>

    <li>When you're done : click the right mouse button.</li>
</ol>
<p>
some useful options:<br />
Options/Image/size reduction x2 <br />
Options/Color/Foreground = green <br />
Options/Contrast - adjust to see particles better <br />
<p>
Then for the next set of 50 particles,
<ol start=7 type="a">
    <li><i>Command/Clear</i></li>
    <li><i>Command/Categorize from sequential montage</i></li>
    <li>Add 1 to the start number</li>
    <li>Add 50 to the last number</li>
</ol>
Keep going until you reach the number of particles in that doc file 
(e.g. 1659 in the first micrograph above). Then start a new doc file 
with the startkey reset to 1. But the first particle file should be 
(last file + 1, e.g., 1660 above).
<p>
Check the startkey - reset it to 1 if you're starting a new document file.
</li>
</ol>
<p>
<dd>
<u>Notes</u>:
<P>
WEB determines the max & min of the file and writes these values to the header, 
so you need write permissions on the win/ser* particle files.
<p>
The document file produced by WEB has a key column + 2 data columns:  <br />

<kbd style="font-weight:normal;">

 ; acn/acn  good/good001.acn   Fri Sep 29 09:52:15 2000 <br />
 ;key &nbsp; &nbsp; -  &nbsp; &nbsp;particle# &nbsp; &nbsp; category# (1 = good particle) <br />
 0001 &nbsp; &nbsp; 2 &nbsp; &nbsp;  1.000000 &nbsp; &nbsp; 1.000000 <br />
 0002 &nbsp; &nbsp; 2 &nbsp; &nbsp;  3.000000 &nbsp; &nbsp; 1.000000 <br />
 0003 &nbsp; &nbsp; 2 &nbsp; &nbsp;  5.000000 &nbsp; &nbsp; 1.000000 <br />
 0004 &nbsp; &nbsp; 2 &nbsp; &nbsp;  7.000000 &nbsp; &nbsp; 1.000000 <br />
 0005 &nbsp; &nbsp; 2 &nbsp; &nbsp;  9.000000 &nbsp; &nbsp; 1.000000 <br />
 0006 &nbsp; &nbsp; 2 &nbsp; &nbsp; 11.000000 &nbsp; &nbsp; 1.000000 <br />
 0007 &nbsp; &nbsp; 2 &nbsp; &nbsp; 13.000000 &nbsp; &nbsp; 1.000000 <br />
 0008 &nbsp; &nbsp; 2 &nbsp; &nbsp; 15.000000 &nbsp; &nbsp; 1.000000 <br />
 0009 &nbsp; &nbsp; 2 &nbsp; &nbsp; 17.000000 &nbsp; &nbsp; 1.000000 <br />
 0010 &nbsp; &nbsp; 2 &nbsp; &nbsp; 19.000000 &nbsp; &nbsp; 1.000000 <br />
 0011 &nbsp; &nbsp; 2 &nbsp; &nbsp; 21.000000 &nbsp; &nbsp; 1.000000 <br />
 0012 &nbsp; &nbsp; 2 &nbsp; &nbsp; 22.000000 &nbsp; &nbsp; 1.000000 <br />
</kbd>
The key is numbered consecutively (= number of lines = N Particles) 
while the particle numbers skip over the nonselected particles
</dd>


<p><a name="view"></a></p>
<dt>QUESTION</dt>
<dd>Howto view picked particles from low defocus micrographs using
    WEB?</dd>
<dt>ANSWER</dt>

<dd>Confirming particles in a gallery of raw windowed files is a
   pain at low defocus. I suggest using the <a href=
   "./man/fq.html">FQ</a> operation (with filter option: 7) on the raw
   files first, and play around with various filter parameters. We use
   the parameters: passband 0.005, stopband 0.30. This results in
   better visibility, for particle picking. The optimum parameters
   will probably vary depending on microscope, scanning, and
   defocus.</dd>


<p><a name="color"></a></p>
<dt>QUESTION</dt>
<dd>We have a problem with the color display of menu text in WEB,
   because the menu text and background are often almost totally
   illegible - ie two very similar shades of green, or light yellow on
   white. Do you have any way of controlling the text and background
   colour of the menus in WEB on SGI machines (Indy, Indigo2, O2) and
   on X terminal displays to these machines?</dd>
<dt>ANSWER</dt>

<dd>WEB accepts standard Xt 
   <a href= "../../web/docs/webopt.html">Command line Arguments</a> Arguments
   and uses the <a href="../../web/docs/webopt.html#resouces">Xt
   resource file</a> (typically the <i>.Xdefaults</i> file in your
   home directory). Some of these variables can be used to set
   forground and background for various widgets in WEB. I suggest that
   you experiment with resource settings in your <i>.Xdefaults</i> file: <br />
 
<kbd style="font-weight:normal;">
e.g.<br />
   Web*background :    green   <br />
   Web*foreground :    red     <br />
<br />
or with <i>Web</i> command line options:  <br />

   web -bg       Background-color DAT <br />
   web -bd       Border-color     DAT <br />
   web -fg       Foreground-color DAT <br />
<br />
e.g. <br />
   web -bg green DAT <br />
   web -bg purple -fg red DAT <br />
</kbd>
</dd>


<p><a name="work"></a></p>
<dt>QUESTION</dt>
<dd>Howto use 8 bit WEB on Linux without permanently switching your
    only display to run in 8 bit mode?</dd>
<dt>ANSWER</dt>

<dd> <p>Dr. David Bhella (MRC Virology Unit,Glasgow) suggested a
   work-around for using <i>Web</i> that allows full operation. Basically 
   it specifies a virtual terminal with an 8-bit display and one with a 
   24-bit display that can be switched between using 
   <i>ctrl-alt-f8 &amp; ctrl-altf7</i>.
   Configuration is fairly straight forward and works on some flavors
   of GNU/Linux. <a href="../../web/docs/web8onlinux.html">Instructions</a>.</p>
</dd>

<p><a name="viewimg"></a></p>
<dt>QUESTION</dt>
<dd>Howto view SPIDER format images without using <i>Web</i>?</dd>
<dt>ANSWER</dt>

<dd> <p>
   You might be able to use the 
   <a href="man/cptoraw.html">"CP TO RAW"</a> operation in SPIDER to convert
   a SPIDER format image to a 8-bit "raw" image. Most imaging softwares allow 
   you to input a "raw" image if you specify the image
   size. If you choose to do this, you can deal with basic display
   functions <em>but may not easily emulate many interactive functions
   contained within <i>Web</i></em>.</p>
</dd>

</dl>

<hr />
<small>Source file: faq.html   &nbsp;&nbsp;&nbsp; 
       Updated: 21 Jan 2010   &nbsp;&nbsp;&nbsp; 
       ArDean Leith
</small>
</body>
</html>

</html>