head	1.8;
access;
symbols;
locks; strict;
comment	@# @;


1.8
date	2016.07.11.14.50.33;	author leith;	state Exp;
branches;
next	1.7;

1.7
date	2016.07.05.15.02.04;	author leith;	state Exp;
branches;
next	1.6;

1.6
date	2013.11.21.17.35.56;	author leith;	state Exp;
branches;
next	1.5;

1.5
date	2013.11.20.14.47.50;	author leith;	state Exp;
branches;
next	1.4;

1.4
date	2013.10.31.18.32.29;	author leith;	state Exp;
branches;
next	1.3;

1.3
date	2013.08.27.17.55.06;	author leith;	state Exp;
branches;
next	1.2;

1.2
date	2012.08.02.03.02.35;	author tapu;	state Exp;
branches;
next	1.1;

1.1
date	2012.08.02.03.01.57;	author tapu;	state Exp;
branches;
next	;


desc
@New file
@


1.8
log
@renamed
@
text
@<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html>

<head>
  <title>Classification-based verification</title> 
  <link rel='stylesheet' href='mrstyle2.css' type='text/css' />

  <style>
  <!--
  div.left{
     margin-left    : 0px;
     //padding      : 5px 10px 5px 12px; 
     //font-size    : 40px;
     //font-weight  : bold;
     //font-family    : sans-serif;
     }

  div.right {
     margin-left    : 12px;
     padding        : 20px 3px 20px 8px;
     vertical-align : top;
     line-height    : 120%;
     }
  -->
  </style>

</head>

<body link="#0000ee" vlink="#0000ee" alink="#ff0000" bgcolor="#cccccc">

<br />
<!-- ------------------- Particle verification ------------------- -->

<a name="Verify"></a>
<table class="heading" width="100%" >
   <tr> <td>    <br />
   <h3 class="heading">Classification-based verification</h3>

   <p class="explain">Aligned particles are subjected to multivariate data analysis 
     and K-means classification</p>

   <p>These procedures should be run in the <i>Averages/</i> directory.
   In filenames below, '###' denotes view number and '???' denotes class number.</p>
   
   </td> </tr>
</table>

   <ul>
   
   <li><p class="action">Classify particles corresponding to each reference projection</p>

   <p>
   <a class="project" href="../Procs/verify-class-byview.spi">verify-class-byview.spi</a> reads:
 
   <font class="input">views/prj###/sel_proj    </font>, 
   <font class="input">views/prj###/stkfilt     </font>,
   <font class="input">views/prj###/sel_part_byv</font> and 
   <font class="input">views/prj###/filtavg     </font>.</p>
 
   <p>Make sure that the <i>[reduction]</i> parameter is the same as was entered in 
   <a class="project" href="../Procs/avg-filt-byview.spi">avg-filt-byview.spi</a>.</p>

   The procedure classifies the particles corresponding to each reference projection.
   The idea is that good particles will fall into discrete classes, and 
   non-particles will fall into different classes. Notable outputs include: </p>

    <table class="outs">
      <tr valign="top"><td>&curren;                                         </td>
          <td><span class="nobreak"><font class="output">views/prj###/sel_part_byclass_???</font>:</span></td>
          <td>Doc file listing particles belonging to a particular class.   </td></tr>

      <tr valign="top"><td>&curren;                                         </td>
          <td><span class="nobreak"><font class="output">views/prj###/listclasses</font>:</span>         </td>
          <td>Doc file listing classes and average CCC value of 
              particles belonging to that class.                            </td></tr>

      <tr valign="top"><td>&curren;                                         </td>
          <td><span class="nobreak"><font class="output">views/prj###/classavg###</font>:</span>         </td>
          <td>Average image of particles belonging to a particular class.   </td></tr>
   </table>
   

   <li><p class="action">Verify particles</p>
   
   <p>For each each reference projection, the aligned particles will have been 
   assigned to classes, and sorted by cross-correlation coefficient.  
   Ideally, the good particles will fall into discrete classes, and
   non-particles into different discrete classes.  
   Outliers can be added or removed individually.</p>
   
   <p>Different levels of control over the particles kept are offered.  
   Recommended is to open each montage of particles belonging to each class, 
   and select good particles. The fastest method is to select entire classes of particles.  
   In between the two, in terms of control, would be to manually select only the 
   particles with the highest CCC values.
   </p>
   
   There are two display options:
   <ol class="choice">
      <li> Use:
          <a href="../../../../spire/spire_linux-1.5.5/guitools/verifybyview.py">
          <font class="guitool">verifybyview.py</font></a> -- 
          <a href="../../../../spire/doc/guitools/verifybyview.html">Documentation</a>.                  <br />
          The simplest way to start it would be to, from the <i>Averages/</i> directory, type:<br />
             <code class="snippet">verifybyview</code>                                      <br />
          Adjust the parameters in the initial popup window, click <i>Continue</i>, and 
          a montage of class windows will appear.  Prior installation of 
          <a href="../../../../spire/doc/index.html"> <font class="guitool">SPIRE</font></a> 
          is required.    </li>
           
      <li>
          <a href="../../../../../web/docs/web.html"><font class="guitool">WEB</font></a> -- 
             <a href="../../verify/batch/instr-apsh.htm#web">Documentation</a>    </li>
   </ol> <br />
   
   Whichever display option chosen will read: 
   <font class="input">views/prj###/listclasses         </font>, 
   <font class="input">views/prj###/sel_part_byclass_???</font>,
   <font class="input">views/prj###/classavg???         </font>,  &amp;
   <font class="input">views/prj###/avgfilt             </font>. It creates:

   <table class="outs">
      <tr valign="top"><td>&curren;                                         </td>
          <td> <span class="nobreak"><font class="output">views/prj###/sel_class_good</font>:</span>     </td>
          <td>List of classes containing good particles.                    </td></tr>

      <tr valign="top"><td>&curren;</td>
          <td> <span class="nobreak"><font class="output">views/prj###/sel_part_byhand###</font>:</span> </td>
          <td>For each class, a list of good particles.                     </td></tr>
   </table>
   
   <p>Verify particles in each of the reference view and 
      don't forget to save <font class="output">views/prj###/sel_class_good</font>.</p>
   </li>

   <li><p class="action">Combine particles from good classes</p>
   
   <a class="project" href="../Procs/verify-combine-classes.spi">verify-combine-classes.spi</a> 
   reads: 
   <font class="input">views/prj###/sel_proj            </font>,  
   <font class="input">views/prj###/sel_class_good      </font>,  
   <font class="input">views/prj###/sel_part_byv        </font>,
   <font class="input">views/prj###/sel_part_byclass_???</font>, &amp;
   <font class="input">views/prj###/sel_part_byhand     </font> <br />

   It collects and formats the information in the form of 
   <font class="input">prj###/sel_part_byclass</font>. It creates:

   <table class="outs">
      <tr valign="top"><td>&curren;                                      </td>
         <td><span class="nobreak"><font class="output">views/prj###/sel_part_byv_good</font>:</span> </td>
         <td>For each view, a list of selected particles.                </td></tr>

      <tr valign="top"><td>&curren;                                      </td>
         <td><span class="nobreak"><font class="output">views/prj###/sel_part_byv_bad</font>:</span>  </td>
         <td>For each view, a list of deselected particles.              </td></tr>

      <tr valign="top"><td>&curren;                                      </td>
         <td><span class="nobreak"><font class="output">views/parts_vsview_good</font>:</span>        </td>
         <td>Summary of particles kept for each view.                    </td></tr>
   </table>
   </li>
 

  
<li><p class="action"><b>[Optional]</b> Re-screen the particles by view</p>

   <p>For an additional layer of quality control, the newly created lists of 
      good and bad particles by class can be re-screened for outliers.  <p>
   
   <p>To look for bad particles in the selection file, in the directory: <i>Averages/Views</i>, 
     type (with the appropriate extension):                        <br />
     <code class="snippet">montagefromdoc.py &nbsp; prj001/sel_part_byv_bad.dat &nbsp; prj001/avgfilt.dat</code> <br />
   There should be a settings file, <a href="../Procs/Averages/.montagefromdoc">.montagefromdoc</a>, 
   present with reasonable settings. 
   Select only the bad particles, and write the selection file to: 
      <font class="output">views/prj###/sel_part_byv_notgood</font>.   </p>
   
   <p>Conversely, to look for good particles among the de-selected particles, 
   in the directory:<i>Averages/Views</i>, type (with the appropriate extension):         <br />
     <code class="snippet">montagefromdoc.py &nbsp; prj001/sel_part_byv_good.dat &nbsp; prj001/avgfilt.dat</code> <br />
   Select only the good particles, and write the selection to:  
     <font class="output">views/prj###/sel_part_byv_notbad</font>.     </p>
   
   <p>Both of the above two steps are optional, <i>i.e.</i>, you can perform one or the other, or both. 
   If you run either one, you'll need to run the following procedure. </p>
   
   To update the lists of particles, run <a class="project" href="../Procs/verify-recheck.spi">verify-recheck.spi</a>.
   Among other files it reads:  
   <font class="output">views/prj###/sel_part_byv_good</font>,
   <font class="output">views/prj###/sel_part_byv_bad </font>,
   <font class="output">views/prj###/sel_part_byv_notbad </font> [optional], and 
   <font class="output">views/prj###/sel_part_byv_notgood</font> [optional]. 
   It creates:
   
   <table class="outs">
      <tr valign="top"><td>&curren;                                      </td>
         <td><span class="nobreak"><font class="output">views/prj###/sel_part_byv_goodB</font>:</span></td>
         <td>An updated list of selected particles, for each view.       </td></tr>

      <tr valign="top"><td>&curren;                                      </td>
         <td><span class="nobreak"><font class="output">views/prj###/sel_part_byv_badB</font>:</span> </td>
         <td>An updated list of deselected particles, for each view.     </td></tr>

      <tr valign="top"><td>&curren;                                      </td>
         <td><span class="nobreak"><font class="output">summary_recheckB</font>:</span>               </td>
         <td>Summary of particles kept for each view.                    </td></tr>
   </table>
   
   <p>If this step is performed, remember in later steps to substitute 
      <font class="output">views/prj###/sel_part_byv_goodB</font> where appropriate.</p>
   </li>
  
 


<li><p class="action">Create a histogram that plots the number of 'good' particles 
     vs the cross correlation value </p>

   <a class="project" href="../Procs/plot-cc-vs-view.spi">plot-cc-vs-view.spi</a>  reads:   
   <font class="input">sel_proj                       </font>,  
   <font class="input">views/prj###/sel_part_byv_good </font>, (or edit to use) 
   <font class="input">views/prj###/sel_part_byv_goodB</font>).  It creates:

   <table class="outs">
      <tr valign="top"><td>&curren;                                                            </td>
          <td><span class="nobreak"><font class="output">sel_part_combined_good</font>:</span> </td> 
          <td>Combined doc file of the same format as 
          <font class="input">views/prj###/sel_part_byv</font>.                                </td></tr>

      <tr valign="top"><td>&curren;                                                            </td>
          <td><span class="nobreak"><font class="output">cc_vsview_good</font>:</span>         </td>
          <td>Histogram doc file of cross correlation values.                                  </td></tr>

      <tr valign="top"><td>&curren;                                                            </td>
          <td><span class="nobreak"><font class="output">cc_vsview_good.gnu</font>:</span>     </td> 
          <td>Gnuplot script for plotting the correlation histogram.                           </td></tr>
   </table>
   
   <table>
      <tr valign="top">
        <!-- ====================== left ============ -->
        <td>
          <div class="left">

          <p>The output Gnuplot script <font class="output">cc_vs_view.gnu</font>
             will overlay the correlation histogram of the particle images 
             with a Gaussian profile. The  histogram plot should be displayed 
             automatically, if not  <a href="gnuplot.html?file=cc_vs_view.gnu">click here</a>.</p>
        <td>
        <!-- ====================== right ============ -->
        <td>
          <div class="right">

          <a href="pics/cc_vsview_good.jpg"
             <img src="pics/small_cc_vsview_good.jpg"></img></a>.
        <td>
      </tr > 
   </table>

</li>


<li><p class="action">[Optional] Compare number of particles before and after verification 
      as a function of defocus level.</p>

   <p> With micrographs from all defocus values combined, 
   it is possible that close-to-focus images may be discriminated against, 
   for example because of lower CC values or simply being harder to see. </p>
   
   <a class="project" href="../Procs/good-parts-bymic.spi">good-parts-bymic.spi</a> 
   sorts the micrographs by estimated defocus and tabulates number of particles retained.  
   It reads:
   <font class="input">../Power_Spectra/defocus       </font>, 
   <font class="input"> sel_part_combined_good        </font>, 
   <font class="input">../Particles/win/glonum2micwin </font>, and creates:
   
   <table class="outs">
      <tr valign="top"><td>&curren;                                                      </td>
          <td><span class="nobreak"><font class="output">Micrographs/sel_goodpart_bymic_****</font>:</span>           </td>
          <td>Updated list of selected particles, for each micrograph.                   </td></tr>

      <tr valign="top"><td>&curren;                                                      </td>
          <td><span class="nobreak"><font class="output">good_parts_vsmic</font>:</span>                              </td>
          <td>Summary file listing the number of particles before and after verification.</td></tr>

      <tr valign="top"><td>&curren;                                                      </td>
          <td><span class="nobreak"><font class="output">good_parts_vsmic.gnu</font>:</span>                          </td> 
          <td>Gnuplot script for plotting particles kept as a function of defocus.       </td></tr>
   </table>
   </p>

   <p>
   <table> <tr valign="top">
     <td align="top">
     <p>The output Gnuplot script <font class="output">good_parts_vsmic.gnu</font>
      will overlay the number of particles before and after verification.
      The  histogram plot should be displayed 
      automatically, if not  <a href="gnuplot.html?file=good_parts_vsmic.gnu">click here</a>.
      See example on right:         <br /> </p></td>

      <td> <a href="pics/parts_vs_defocus.gif">
           <img width="200" height="150" src="./pics/parts_vs_defocus.gif"></a></td>
   </tr> <table>

</p>

   <p>Note that, depending on the origin of the 
   <font class="input">../Particles/good/sel_part_****</font> files, 
   the quality of the "initial" particles may or may not be meaningful.  
   For example, if no screening was done following 
   <a class="project" href="../Procs/lfc_pick.spi">lfc_pick.spi</a>, 
   there may be a large excess of non-particles in the  
   <font class="input">../Particles/good/sel_part_****</font> files.
   </p>
</li>



<li><p class="action">[<b>Optional</b>] Check the spatial distribution of views 
   (angular directions) for the reconstruction     </p>

   <p>The following two procedures are same as those run previously, except for 
   the input setting used.</p>
   
   <p>  
   <a class="project" href="../Procs/plot-ref-views.spi">plot-ref-views.spi</a> reads:  
   <font class="input">views/parts_vsview_good</font>. 
   It creates a script file with gnuplot commands: <br />

   <table class="outs">
      <tr valign="top"><td>&curren;</td>
          <td> <span class="nobreak"><font class="output">parts_vsview_good.gnu</font></span></td>
          <td> Gnuplot script to plot histogram of number of particles vs projection view.</td></tr>
   </table>

   <p />

    <table>
      <tr valign="top">
        <!-- ====================== left ============ -->
        <td>
          <div class="left">

          <p>The output Gnuplot script <font class="output">parts_vsview_good.gnu</font>
          will plot number of particles vs view after verification.
          The  histogram plot should be displayed 
          automatically, if not  <a href="gnuplot.html?file=parts_vsview_good.gnu">click here</a>.
          <p />
        <td>
        <!-- ====================== right ============ -->
        <td>
          <div class="right">

          <a href="pics/parts_vsview_good.jpg"
             <img src="pics/small_parts_vsview_good.jpg"></img></a>.
        <td>
      </tr > 
   </table>



  <p>The output Gnuplot script <font class="output">parts_vsview_good.gnu</font>
      will plot number of particles vs viewafter verification.
      The  histogram plot should be displayed 
      automatically, if not  <a href="gnuplot.html?file=good_parts_vsmic.gnu">click here</a>.
   <p />



  <a class="project" href="../Procs/show-ref-views.spi">show-ref-views.spi</a> reads:  
   <font class="input">../Alignment/refangles</font>, and 
   <font class="input">views/part_vsview_good</font>. It creates: <br />

   <table class="outs">
      <tr valign="top"><td>&curren;</td>
          <td> <span class="nobreak"><span class="nobreak"><font class="output">show_ref_views_good</font>: </td> 
          <td>SPIDER image showing distribution of sample images 
             among the various reference projections. </td></tr>
   </table> 

   <table>
      <tr valign="top">
        <td> <!-- ====================== left ============ -->
          <div class="left">

          <p>This image shows the various angular reference groups represented by small 
          circles. The radii of these circles are proportional to the number of 
          particles in each group. 
          Display the image in: <a href="../../../../../web/docs/web.html">
          <font class="guitool">WEB</font></a> or
          <a href="../../../../spire/doc/guitools/qview.html">
          <font class="guitool">qview.py</font></a>.</p>
        <td>
        <td> <!-- ====================== right ============ -->
          <div class="right">

          <a href="pics/show_ref_views_good.jpg"
             <img src="pics/small_show_ref_views_good.jpg"></img></a>.
        <td>
      </tr > 
   </table>



</li>

<li>Now, resume the "normal" flow of operations, starting with 
    <a href="mr1.html#best-imgs">best-imgs.spi</a>. 
    Remember to set it to select the "good" particles.
</li>

<br />

<hr />

<a name="RRRRRRR"></a> 
<table class="heading" width="100%"><tr><td> <br />
   <h3> References</h3>
   </td></tr>
</table>

<ol>
   <li>Shaikh TR, Trujillo R, LeBarron JS, Baxter WT, Frank J. (2008) &nbsp;&nbsp;
   Particle-verification for single-particle, reference-based-reconstruction
   using multivariate data analysis and classification
   <i>Journal of Structural Biology</i>, Volume 164, Pages 41-48.</li>
</ol>

<hr />

<p>

<small>
  Page updated: 2013/11/11         &nbsp;&nbsp;&nbsp;
  Author:       Tapu Shaikh
  Enquiries: <address><a href= "mailto:spider@@wadsworth.org">spider@@wadsworth.org</a> </address>
</small>

</body>
</html>
@


1.7
log
@cosmetic
@
text
@d174 1
a174 1
   There should be a settings file, <a href="../Averages/.montagefromdoc">.montagefromdoc</a>, 
d409 1
a409 1
    <a href="mr.html#best-imgs">best-imgs.spi</a>. 
@


1.6
log
@improved
@
text
@d101 3
a103 2
          <a href="../Procs/verifybyview.py"><font class="guitool">verifybyview.py</font></a> -- 
          <a href="verifybyview.html">Documentation</a>.                  <br />
d105 1
a105 1
             <code class="snippet">verifybyview.py</code>                                      <br />
a381 7
   <p>This image shows the various angular reference groups represented by small 
   circles. The radii of these circles are proportional to the number of 
   particles in each group. 
   Display the image in: <a href="../../../../../web/docs/web.html">
   <font class="guitool">WEB</font></a> or
   <a href="../../../../spire/doc/guitools/qview.html"><font class="guitool">qview.py</font></a>.</p>

a434 1
  Source:       mr1verify.html     &nbsp;&nbsp;&nbsp; 
@


1.5
log
@gnuplot links, cosmetic
@
text
@d7 20
a31 1
<hr />
d60 1
a60 1
   <p>Of the parameters, make sure that <i>[reduction]</i> is the same as was entered in 
d63 1
a63 1
   It classifies the particles corresponding to each reference projection.
d101 2
a102 2
          <a href="../verifybyview.py"><font class="guitool">verifybyview.py</font></a> -- 
          <a href="../../verify/VerifyDocs/interface.htm">Documentation</a>.                  <br />
d123 1
a123 1
          <td> <font class="output">views/prj###/sel_class_good</font>:     </td>
d127 1
a127 1
          <td> <font class="output">views/prj###/sel_part_byhand###</font>: </td>
d150 1
a150 1
         <td><font class="output">views/prj###/sel_part_byv_good</font>: </td>
d154 1
a154 1
         <td><font class="output">views/prj###/sel_part_byv_bad</font>:  </td>
d158 1
a158 1
         <td><font class="output">views/parts_vsview_good</font>:        </td>
d197 1
a197 1
         <td><font class="output">views/prj###/sel_part_byv_goodB</font>:</td>
d201 1
a201 1
         <td><font class="output">views/prj###/sel_part_byv_badB</font>: </td>
d205 1
a205 1
         <td><font class="output">summary_recheckB</font>:               </td>
d225 2
a226 2
      <tr valign="top"><td>&curren;                                 </td>
          <td><font class="output">sel_part_combined_good</font>:   </td> 
d228 1
a228 1
          <font class="input">views/prj###/sel_part_byv</font>.     </td></tr>
d230 7
a236 7
      <tr valign="top"><td>&curren;                                 </td>
          <td><font class="output">cc_vsview_good</font>:           </td>
          <td>Histogram doc file of cross correlation values.       </td></tr>

      <tr valign="top"><td>&curren;                                 </td>
          <td><font class="output">cc_vsview.gnu</font>:           </td> 
          <td>Gnuplot script for plotting the correlation histogram.</td></tr>
d239 20
a258 5

   <p>The output Gnuplot script <font class="output">cc_vs_view.gnu</font>
      will overlay the correlation histogram of the particle images 
      with a Gaussian profile. The  histogram plot should be displayed 
      automatically, if not  <a href="gnuplot.html?file=cc_vs_view.gnu">click here</a>.</p>
d275 1
a275 2
   <font class="input">../Particles/win/glonum2micwin </font>, and
   and creates:
d279 1
a279 1
          <td><font class="output">Micrographs/sel_goodpart_bymic_****</font>:           </td>
d283 1
a283 1
          <td><font class="output">good_parts_vsmic</font>:                              </td>
d287 1
a287 1
          <td><font class="output">good_parts_vsmic.gnu</font>:                          </td> 
d301 1
a301 1
      <td> <a href="pics/parts_vs_defocus/.gif">
d332 2
a333 2
          <td> <font class="output">parts_vsview_good.gnu</font></td>
          <td> Gnuplot script to plot a histogram of number of particles vs projection view.</td></tr>
d338 25
a362 1
   <p>The output Gnuplot script <font class="output">parts_vsview_good.gnu</font>
d376 1
a376 1
          <td> <font class="output">show_ref_views_good</font>: </td> 
d387 25
d415 2
a416 3
    <a href="mr.html#bestim">bestim.spi</a>. 
    Remember to substitute: <font class="input">views/prj###/sel_part_byv_good</font>  for: 
                            <font class="input">views/prj###/sel_part_sort</font>.
a427 1
<p />
@


1.4
log
@updated filenames
@
text
@d24 1
a24 1
   In filenames below, '???' denotes view number and '###' denotes class number.</p>
d33 1
a33 1
   <p>The procedure
d36 9
a44 3
   <font class="input">views/prj???/sel_part_byv</font> and 
   <font class="input">views/prj???/stkfilt</font> and
   classifies the particles corresponding to each reference projection.
d48 7
a54 3
   <table class="outs">
      <tr valign="top"><td>&curren;                                </td>
          <td><font class="output">views/prj???/listclasses</font>:</td>
d56 1
a56 5
              particles belonging to that class.                   </td></tr>

      <tr valign="top"><td>&curren;                                       </td>
          <td><font class="output">views/prj???/classavg###</font>:       </td>
          <td>Average image of particles belonging to a particular class. </td></tr>
d59 2
a60 2
          <td><font class="output">views/prj???/sel_part_byclass_###</font>:</td>
          <td>Doc file listing particles belonging to a particular class.   </td></tr>
a62 3
   <p>Of the parameters, make sure that <i>[reduce-factor]</i> is the same as was entered in 
   <a class="project" href="../Procs/avg-filt-byview.spi">avg-filt-byview.spi</a>.</p></li>
   
d83 1
a83 1
            <a href="../../verify/VerifyDocs/interface.htm">Documentation</a>.                  <br />
d97 4
a100 4
   <font class="input">views/prj???/listclasses</font>, 
   <font class="input">views/prj???/classavg###</font>, 
   <font class="input">views/prj???/sel_part_byclass_###</font>, &amp;
   <font class="input">views/prj???/stkfilt</font> and create:
d103 3
a105 3
      <tr valign="top"><td>&curren;                                     </td>
          <td> <font class="output">views/prj???/sel_class_good</font>: </td>
          <td>List of classes containing good particles.                </td></tr>
d108 1
a108 1
          <td> <font class="output">views/prj???/sel_part_byhand###</font>: </td>
d113 1
a113 1
      don't forget to save <font class="output">views/prj???/sel_class_good</font>.</p>
d119 6
a124 5
   will read: 
   <font class="input">views/prj???/sel_class_good   </font>,  
   <font class="input">views/prj???/sel_part_byv     </font>,
   <font class="input">views/prj???/sel_part_class   </font>, &amp;
   <font class="input">views/prj???/sel_part_byhand  </font> <br />
d126 2
a127 2
   and collect and format the information in the form of 
   <font class="input">prj???/sel_part_byclass</font>. Output created includes:
a129 1

d131 1
a131 1
         <td><font class="output">views/prj???/sel_part_byv_good</font>: </td>
d135 1
a135 1
         <td><font class="output">views/prj???/sel_part_byv_bad</font>:  </td>
d139 1
a139 1
         <td><font class="output">views/parts_per_view_good</font>:      </td>
d148 2
a149 4
   <p>For an additional layer of quality control, the newly created: 
   <font class="input">views/prj???/sel_part_byv_good</font>  &amp; 
   <font class="input">views/prj???/sel_part_byv_bad</font> files 
   can be re-screened for outliers.  <p>
d151 1
a151 1
   <p>To look for bad particles in the selection file, in <i>Averages/Views</i>, 
d153 1
a153 1
     <code class="snippet">montagefromdoc.py prj001/sel_part_byv_bad.dat prj001/stkfilt.dat</code> <br />
d157 1
a157 1
      <font class="output">views/prj???/sel_part_byv_notgood</font>.   </p>
d159 3
a161 3
   <p>Conversely, to look for good particles among the deselected particles, 
   in <i>Averages/Views</i>, type (with the appropriate extension):         <br />
     <code class="snippet">montagefromdoc.py prj001/sel_part_byv_good.dat prj001/stkfilt.dat</code> <br />
d163 1
a163 1
     <font class="output">views/prj???/sel_part_byv_notbad</font>.     </p>
d169 6
a174 6
   It reads:  
   <font class="output">views/prj???/sel_part_byv_good</font>,
   <font class="output">views/prj???/sel_part_byv_bad </font>,
   <font class="output">views/prj???/sel_part_byv_notbad </font> [optional], and 
   <font class="output">views/prj???/sel_part_byv_notgood</font> [optional]. 
   The procedure creates:
d177 3
a179 3
      <tr valign="top"><td>&curren;</td>
         <td><font class="output">views/prj???/sel_part_byv_goodB</font>: </td>
         <td>An updated list of selected particles, for each view.</td></tr>
d181 3
a183 3
      <tr valign="top"><td>&curren;</td>
         <td><font class="output">views/prj???/sel_part_byv_badB</font>: </td>
         <td>An updated list of deselected particles, for each view.</td></tr>
d185 3
a187 3
      <tr valign="top"><td>&curren;</td>
         <td><font class="output">how_many_recheckB</font>: </td>
         <td>Summary of particles kept for each view.</td></tr>
d191 1
a191 1
      <font class="output">views/prj???/sel_part_byv_goodB</font> where appropriate.</p>
d198 1
a198 1
    vs. the cross correlation value    </p>
d200 4
a203 4
   <a class="project" href="../Procs/histcc.spi">histcc.spi</a>  with:
   <i>[want-good-yn] = 1</i> reads:   
   <font class="input">views/prj???/sel_part_byv_good</font> (or 
   <font class="input">views/prj???/sel_part_byv_goodB</font>) to create:
d206 4
a209 3
      <tr valign="top"><td>&curren;</td>
          <td><font class="output">histcc_good</font>: </td>
          <td>Histogram doc file of cross correlation values.</td></tr>
d211 3
a213 4
      <tr valign="top"><td>&curren;</td>
          <td><font class="output">sel_part_combined_good</font>: </td> 
          <td>Combined doc file of the same format as 
          <font class="input">views/prj???/sel_part_byv_sort</font>.</td></tr>
d215 2
a216 2
      <tr valign="top"><td>&curren;</td>
          <td><font class="output">fit-good.gnu</font>: </td> 
d220 2
a221 1
   <p>The output Gnuplot script <font class="output">fit-good.gnu</font>
d223 2
a224 3
      with a Gaussian profile.</p>
   
   To view the histogram plot, either:
a225 18
   <ol class="choice">
   <li>In the procedure file <a class="project" href="../Procs/histcc.spi">histcc.spi</a>,
       leave the parameter <i>[viewplot-yn]</i> as 1 (the default).  
       A Gnuplot window will pop up automatically. 
       <br />(NOTE: This may not work if <font class="output">fit_good.gnu</font> 
       is not in the same directory as the procedure file.)</li>

   <li>From the command line, type:
       <br /><code class="snippet">gnuplot -persist fit-good.gnu</code> <br /></li>

   <li>Start Gnuplot by typing from the command line:
       <br /><code class="snippet">gnuplot</code> <br />
       And from the Gnuplot prompt, type:
       <br /><code class="snippet">load 'fit-good.gnu'</code> <br />
       Remember to include the quotes. 
       Running Gnuplot interactively will alow you to adjust the Gaussian parameters 
       without opening a new plot each time.</li>
   </ol>
a228 1

d230 1
a230 1
      as a function of defocus.</p>
d236 1
a236 1
   The procedure <a class="project" href="../Procs/good-parts-bymic.spi">good-parts-bymic.spi</a> 
d238 1
a238 1
   The procedure reads:
d240 3
a242 4
   <font class="input"> sel_part_combined             </font>, 
   <font class="input">../Alignment/global2group      </font>, and
   <font class="input">../Particles/good/sel_part_****</font>, 
   and writes:
d246 1
a246 1
          <td><font class="output">Micrographs/sel_part_bymic_****</font>:               </td>
d250 1
a250 1
          <td><font class="output">summary_goodparts_bymic</font>:                       </td>
d254 1
a254 1
          <td><font class="output">parts_vs_defocus.gnu</font>:                          </td> 
d257 14
a270 4
   
   The output Gnuplot script <font class="output">parts_vs_defocus.gnu</font>
   will overlay the number of particles before and after verification.
   To view the overall histogram plot, either:
d272 1
a272 21
   <ol class="choice">
   <li>In the procedure 
       <a class="project" href="../Procs/good-parts-bymic.spi">good-parts-bymic.spi</a> ,
       leave the parameter <i>[viewplot-yn]</i> as 1 (the default).  
       A Gnuplot window will pop up automatically. 
       (NOTE: This may not work if <font class="output">parts_vs_defocus.gnu</font> 
       is not in the same directory as the procedure file.)</li>

   <li>From the command line, type:<br />
       <code class="snippet">gnuplot -persist parts_vs_defocus.gnu</code> <br /></li>

   <li>Start Gnuplot by typing from the command line:<br />
         <code class="snippet">gnuplot</code> <br />
       And from the Gnuplot prompt, type:<br />
         <code class="snippet">load 'parts_vs_defocus.gnu'</code> <br />
       Remember to include the quotes. </li>
   </ol>
   
   <p>See the following example:         <br />
       <a href="pics/parts_vs_defocus/.gif">
       <img width="200" height="150" src="./pics/parts_vs_defocus.gif"></a></p>
d292 4
a295 5
   <p> The procedure: 
   <a class="project" href="../Procs/plot-ref-views.spi">plot-ref-views.spi</a> with:
   <i>[want-good-yn] = 1</i> reads:  
   <font class="input">views/part_per_view_good</font>, and
   creates script files of gnuplot commands: <br />
d299 1
a299 1
          <td> <font class="output">gnuplot_view_good.gnu</font></td>
d305 9
a313 2
  <a class="project" href="../Procs/show-ref-views.spi">show-ref-views.spi</a> with:
   <i>[want-good-yn] = 1</i> reads:  
d315 1
a315 1
   <font class="input">views/part_per_view_good</font> to create: <br />
d321 1
a321 1
             among the various reference projections for all groups. </td></tr>
d327 1
a327 1
   Display the image in <a href="../../../../../web/docs/web.html">
d334 2
a335 2
    Remember to substitute: <font class="input">views/prj???/sel_part_byv_good</font>  for: 
                           <font class="input">views/prj???/sel_part_sort</font>.
d361 2
a362 2
  Source:       mr1verify.html        &nbsp;&nbsp;&nbsp; 
  Page updated: 2013/10/23 &nbsp;&nbsp;&nbsp;
@


1.3
log
@*** empty log message ***
@
text
@d20 2
a21 1
   <p class="explain">Aligned particles are subjected to multivariate data analysis and K-means classification</p>
d24 1
a24 1
   In filenames below, '###' denotes class number.</p>
d31 1
a31 1
   <li><p class="action">Run classification on particles corresponding to each reference projection</p>
d34 4
a37 3
   <a class="project" href="../Averages/classifybyview.spi">classifybyview.spi</a> reads 
   <font class="input">Views/sel???</font> and 
   <font class="input">Views/prj???/stkfilt</font> and
d40 1
a40 2
   non-particles will fall into different classes.
   Notable outputs include: </p>
d43 12
a54 10
      <tr valign="top"><td>&curren;</td>
          <td><font class="output">Views/prj???/listclasses</font>:</td>
          <td>Doc file listing classes and 
          the average CCC value of particles belonging to that class. </td> </tr>
      <tr valign="top"><td>&curren;</td>
          <td><font class="output">Views/prj???/classavg###</font>:</td>
          <td>Average of particles belonging to a particular class. </td> </tr>
      <tr valign="top"><td>&curren;</td>
          <td><font class="output">Views/prj???/docclass###</font>:</td>
          <td>Doc file listing particles belonging to a particular class. </td> </tr>
d57 2
a58 2
   <P>Of the parameters, make sure that <I>[reduce-factor]</I> is the same as was entered in 
   <a class="project" href="../Averages/avgfilterbyview.spi">avgfilterbyview.spi</a>.</P></li>
d60 1
d63 2
a64 2
   <P>For each each reference projection, the aligned particles will have been assigned to classes, and 
   sorted by cross-correlation coefficient.  
d67 1
a67 1
   Outliers can be added or removed individually.</P>
d69 3
a71 3
   <P>Different levels of control over the particles kept are offered.  
   Recommended is to open each montage of particles belonging to each class, and select good particles.  
   The fastest method is to select entire classes of particles.  
d74 1
a74 1
   </P>
d76 11
a86 11
   <br>There are two display options:
       <ol class="choice">
           <LI><a href="../verifybyview.py"><font class="guitool">verifybyview.py</font></a> -- 
           Documentation can be found 
           <a href="../../../../techs/verify/VerifyDocs/interface.htm">here</a>
           <BR>The simplest way to start it would be to, from the <I>Averages/</I> directory, type:
           <BR><code class="snippet">verifybyview.py</code><BR>
           Adjust the parameters in the initial popup window, click <I>Continue</I>, and 
           a montage of class windows will appear. 
           Prior installation of <a href="../../../../../spire/doc/index.html">
           <font class="guitool">SPIRE</font></a> is required.</LI>
d88 10
a97 10
           <LI><a href="../../../../../../web/docs/web.html"><font class="guitool">WEB</font></a> -- 
           Documentation can be found <a href="../../../../techs/verify/../instr-apsh.htm#web">here</a></LI>
       </ol>
   
   <br>Whichever display option chosen will read 
   <font class="input">Views/prj???/listclasses</font>, 
   <font class="input">Views/prj???/classavg###</font>, 
   <font class="input">Views/prj???/docclass###</font>, and
   <font class="input">Views/prj???/stkfilt</font>. 
   Outputs will include:
d100 4
d105 2
a106 5
          <td> <font class="output">Views/prj???/goodclasses</font>: </td>
          <td>List of classes containing good particles.</td></tr>
      <tr valign="top"><td>&curren;</td>
          <td> <font class="output">Views/prj???/byhand###</font>: </td>
          <td>For each class, a list of good particles.</td></tr>
d109 2
a110 2
   <p>Verify particles in each reference view (<I>e.g.,</I> 1 through 83), and 
   don't forget to save <font class="output">Views/prj???/goodclasses</font>.</P>
d115 10
a124 7
   The batch file <a class="project" href="../Averages/combinegoodclasses.spi">combinegoodclasses.spi</a> 
   will take the information in 
   <font class="input">Views/prj???/goodclasses</font> and 
   <font class="input">Views/prj???/byhand###</font>, 
   and collect and format the information in the form of
   <font class="input">Views/sel???</font>.
   Outputs include:
d126 12
a137 9
      <tr valign="top"><td>&curren;</td>
         <td><font class="output">Views/prj???/goodsel</font>: </td>
         <td>For each view, a list of selected particles.</td></tr>
      <tr valign="top"><td>&curren;</td>
         <td><font class="output">Views/prj???/badsel</font>: </td>
         <td>For each view, a list of deselected particles.</td></tr>
      <tr valign="top"><td>&curren;</td>
         <td><font class="output">how_many-good</font>: </td>
         <td>Summary of particles kept for each view.</td></tr>
d140 4
a143 2
   
<li><p class="action"><B>[Optional]</B> Re-screen the particles by view</p>
d145 8
a152 7
   <P>For an additional layer of quality control, the newly created
   <font class="input">Views/prj???/goodsel</font> and <font class="input">Views/prj???/badsel</font> files 
   can be re-screened for outliers.  <P>
   
   <P>To look for bad particles in the selection file, 
   in <I>Averages/Views</I>, type (with the approriate extension):
   <BR><code class="snippet">montagefromdoc.py prj001/goodsel.dat prj001/stkfilt.dat</code> <br>
d155 2
a156 1
   Select only the bad particles, which will be written to <font class="output">Views/prj???/notgood</font>.</P>
d158 16
a173 15
   <P>Conversely, to look for good particles among the deselected particles, 
   in <I>Averages/Views</I>, type (with the approriate extension):
   <BR><code class="snippet">montagefromdoc.py prj001/badsel.dat prj001/stkfilt.dat</code> <br>
   Select only the good particles, and write them to to <font class="output">Views/prj???/notbad</font>.</P>
   
   <P>Both of the above two steps are optional, <I>i.e.</I>, you can one or the other or both. 
   If you run either one, you'll need to run the following batch file. </P>
   
   To update the lists of particles, run <a class="project" href="../Averages/recheck.spi">recheck.spi</a>.
   It reads 
   <font class="output">Views/prj???/goodsel</font>,
   <font class="output">Views/prj???/badsel</font>,
   <font class="output">Views/prj???/notbad</font> [optional], and 
   <font class="output">Views/prj???/goodsel</font> [optional]. 
   The batch file writes out:
d177 1
a177 1
         <td><font class="output">Views/prj???/goodselB</font>: </td>
d179 1
d181 1
a181 1
         <td><font class="output">Views/prj???/badselB</font>: </td>
d183 1
d185 1
a185 1
         <td><font class="output">how_many-recheckB</font>: </td>
d189 2
a190 2
   <P>If this step is performed, remember in later steps to substitute <font class="output">Views/prj???/goodselB</font>
   where appropriate.</P>
d192 6
a197 3
   
<li><p class="action">Create a histogram that plots the number of particles 
    vs. the cross correlation value</p>
d199 4
a202 3
   <a class="project" href="../Averages/histgoodcc.spi">histgoodcc.spi</a> reads 
   <font class="input">Views/prj???/goodsel</font> (or <font class="input">Views/prj???/goodselB</font>) to
   to create:
d206 1
a206 1
          <td><font class="output">histcccgood</font>: </td>
d208 1
d210 1
a210 1
          <td><font class="output">combinedgood</font>: </td> 
d212 2
a213 1
          <font class="input">Views/prj???/sortsel</font>.</td></tr>
d220 2
a221 2
   will overlay the correlation histogram of the particle images 
   with a Gaussian profile.</p>
d223 1
a223 1
   To view the overall histogram plot, either:
d226 2
a227 2
   <li>In the batch file <a class="project" href="../Averages/histallcc.spi">histgoodcc.spi</a>,
       leave the parameter <I>[viewplot-yn]</I> as 1 (the default).  
d229 3
a231 2
       <BR>(NOTE: This may not work if <font class="output">fit-good.gnu</font> 
       is not in the same directory as the batch file.)</li>
d233 2
a234 1
       <BR><code class="snippet">gnuplot -persist fit-good.gnu</code> <BR></li>
d236 1
a236 1
       <BR><code class="snippet">gnuplot</code> <BR>
d238 1
a238 1
       <BR><code class="snippet">load 'fit-good.gnu'</code> <BR>
a244 2
<li><p class="action"><B>[Optional]</B> Compare number of particles before and after verification 
as a function of defocus.</p>
d246 5
a250 1
   <P>With micrographs from all defocus values combined, 
d252 1
a252 1
   for example because of lower CC values or simply being harder to see.  </P>
d254 7
a260 8
   The batch file <a class="project" href="../Averages/goodpartsbymic.spi">goodpartsbymic.spi</a> 
   sorts the micrographs by estimated defocus and 
   tabulates the number of particles retained.  
   The batch file reads
   <font class="input">../Power_Spectra/defocus</font>, 
   <font class="input">combinedgood</font>, 
   <font class="input">../Alignment/global2group</font>, and
   <font class="input">../Particles/good/ngood****</font>, 
d264 11
a274 9
      <tr valign="top"><td>&curren;</td>
          <td><font class="output">Micrographs/ngood****</font>: </td>
          <td>An updated list of selected particles, for each micrograph.</td></tr>
      <tr valign="top"><td>&curren;</td>
          <td><font class="output">summary-goodpartsbymic</font>: </td>
          <td>A summary file listing the number of particles before and after verification.</td></tr>
      <tr valign="top"><td>&curren;</td>
          <td><font class="output">partsbydf.gnu</font>: </td> 
          <td>Gnuplot script for plotting particles kept as a function of defocus.</td></tr>
d277 1
a277 1
   <br>The output Gnuplot script <font class="output">partsbydf.gnu</font>
d282 3
a284 2
   <li>In the batch file <a class="project" href="../Averages/goodpartsbymic.spi">goodpartsbymic.spi</a> ,
       leave the parameter <I>[viewplot-yn]</I> as 1 (the default).  
d286 10
a295 8
       <BR>(NOTE: This may not work if <font class="output">partsbydf.gnu</font> 
       is not in the same directory as the batch file.)</li>
   <li>From the command line, type:
       <BR><code class="snippet">gnuplot -persist partsbydf.gnu</code> <BR></li>
   <li>Start Gnuplot by typing from the command line:
       <BR><code class="snippet">gnuplot</code> <BR>
       And from the Gnuplot prompt, type:
       <BR><code class="snippet">load 'partsbydf.gnu'</code> <BR>
d299 3
a301 2
   <p>See the following example:<BR>
       <a href="pics/partsbydf.gif"><img width="200" height="150" src="./pics/partsbydf.gif"></a></p>
d303 2
a304 1
   <P>Note that, depending on the origin of the <font class="input">../Particles/good/ngood****</font> files, 
d306 5
a310 3
   For example, if no screening was done following <a class="project" href="../Particles/lfc_pick.spi">lfc_pick.spi</a>, 
   there may be a large excess of non-particles in the <font class="input">../Particles/good/ngood****</font> files.
   </P>
d313 2
d318 2
a319 2
   <P>The following two batch files are copies of those run previously, except for 
   the inputs used.</P>
d321 4
a324 2
   <p> <a class="project" href="../Averages/plotrefviews-good.spi">plotrefviews-good.spi</a> reads  
   <font class="input">how_many-good</font>, and
d329 1
a329 1
          <td> <font class="output">gnuplot_view-good</font></td>
d335 2
a336 1
   <a class="project" href="../Averages/display-good.spi">display-good.spi</a> reads 
d338 1
a338 1
   <font class="input">how_many-good</font> to create: <br />
d342 3
a344 4
          <td> <font class="output">cndis-good</font>: </td> 
          <td>SPIDER image file showing distribution of sample images 
             among various reference projections for all groups. </td></tr>

d347 1
a347 1
   <P>This image show the various angular reference groups represented by small 
d350 1
a350 1
   Display the image in <a href="../../../../../../web/docs/web.html">
d352 1
a352 1
   <a href="../../../../../spire/doc/guitools/qview.html"><font class="guitool">qview.py</font></a>.</P>
d355 5
a359 3
<LI>Now, resume the "normal" flow of operations, starting with <a href="mr.html#bestim">bestim.spi</a>. 
    Remember to substitute <font class="input">Views/prj???/goodsel</font> for <font class="input">Views/prj???/sortsel</font>.
</LI>
d361 1
a361 1
<BR>
d384 4
a387 4
Source:       mr.html        &nbsp;&nbsp;&nbsp; 
Page updated: 2013/08/27 &nbsp;&nbsp;&nbsp;
Author:       Tapu Shaikh
Enquiries: <address><a href= "mailto:spider@@wadsworth.org">spider@@wadsworth.org</a> </address>
@


1.2
log
@Changed extension '.ext' to '.dat' for consistency with mr.html
@
text
@d12 1
a12 1
<HR>
d76 1
a76 1
           <a href="http://www.wadsworth.org/spider_doc/spider/docs/techs/verify/VerifyDocs/interface.htm">here</a>
d81 1
a81 1
           Prior installation of <a href="http://www.wadsworth.org/spider_doc/spire/doc/index.html">
d84 2
a85 2
           <LI><a href="http://www.wadsworth.org/spider_doc/web/docs/web.html"><font class="guitool">WEB</font></a> -- 
           Documentation can be found <a href="http://www.wadsworth.org/spider_doc/spider/docs/techs/verify/../instr-apsh.htm#web">here</a></LI>
d310 1
a310 1
   Display the image in <a href="http://www.wadsworth.org/spider_doc/web/docs/web.html">
d312 1
a312 1
   <a href="http://www.wadsworth.org/spider_doc/spire/doc/guitools/qview.html"><font class="guitool">qview.py</font></a>.</P>
d321 1
a321 1
<hr>
d325 1
a325 1
   <h3 > References</h3>
a337 1
<small>
a339 4
Source: mr.html        &nbsp;&nbsp;&nbsp; 
Page updated: 2012/08/01 &nbsp;&nbsp;&nbsp;
Tapu Shaikh
</p>
d341 5
a345 5
<p>
<address>&copy; <a href="http://www.wadsworth.org/spider_doc/spider/docs/copyright.html">Copyright notice</a> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
Enquiries: <a href= "mailto:spider@@wadsworth.org">spider@@wadsworth.org</a>
</address>
</p>
@


1.1
log
@Initial revision
@
text
@d138 1
a138 1
   <BR><code class="snippet">montagefromdoc.py prj001/goodsel.ext prj001/stkfilt.ext</code> <br>
d145 1
a145 1
   <BR><code class="snippet">montagefromdoc.py prj001/badsel.ext prj001/stkfilt.ext</code> <br>
d342 1
a342 1
Page updated: 2012/06/08 &nbsp;&nbsp;&nbsp;
@
