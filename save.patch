diff --git src/LABLOCK.INC src/LABLOCK.INC
old mode 100755
new mode 100644
index 074adc87..bfeeeea6
--- src/LABLOCK.INC
+++ src/LABLOCK.INC
@@ -2,11 +2,11 @@
 C       LABNEW     COMMON BLOCK FOR FILE HEADER VARIABLES
 C                  USED IN OPENFIL, FILDAT, LUNSETHDR, OPENINSTK, TILT
 
-        INTEGER  :: LABLEN,IANGLE
+        INTEGER  :: LABLEN,IANGLE,KANGLE
         REAL     :: HDR_VALS(64)
 
         REAL     :: PHI,THETA,PSI,XOFF,YOFF,ZOFF,
-     &              SCALE,FLAG,KANGLE,PHI2,THETA2,PSI2,PHI1,
+     &              SCALE,FLAG,PHI2,THETA2,PSI2,PHI1,
      &              THETA1,PSI1 
 
         COMMON/LABNEW/LABLEN,IANGLE,PHI,THETA,PSI,XOFF,YOFF,ZOFF,
diff --git src/Makefile.inc src/Makefile.inc
index 9e8702a5..bfe758f5 100644
--- src/Makefile.inc
+++ src/Makefile.inc
@@ -3,12 +3,16 @@
 #        This is the definitive source listing for source files
 #        compiled into SPIDER. Additional objects are also found
 #        within the corresponding source files.
- 
+#        First time run as is, then invert: lunsetmrchdr.o and lunsethdr.o
+#        and run again.  This may work?
+# 
+# $(LIB)(lunsetmrchdr.o) \
+
 ELEMENTS =  \
- $(LIB)(spider.o)    \
- $(LIB)(openinln.o)  \
  $(LIB)(lunsethdr.o) \
  $(LIB)(lunsetmrchdr.o) \
+ $(LIB)(spider.o)    \
+ $(LIB)(openinln.o)  \
  $(LIB)(fftw3.o)     \
  $(LIB)(lundoc.o)    \
  $(LIB)(apsh_tool.o) \
@@ -158,11 +162,9 @@ ELEMENTS =  \
  $(LIB)(copyf.o)   \
  $(LIB)(copyfromnik.o) \
  $(LIB)(copyfromtif.o) \
- $(LIB)(copyfromxplo.o)\
  $(LIB)(copypos.o)     \
  $(LIB)(copytojpg.o)   \
  $(LIB)(copytostk.o)   \
- $(LIB)(copytoxplor.o) \
  $(LIB)(copytovol.o)   \
  $(LIB)(copyr.o) \
  $(LIB)(copyu.o) \
@@ -342,7 +344,6 @@ ELEMENTS =  \
  $(LIB)(getdocdat.o)  \
  $(LIB)(getdoclist.o) \
  $(LIB)(getfilenum.o) \
- $(LIB)(gethedccp4.o) \
  $(LIB)(getima_q.o) \
  $(LIB)(getlbno.o)  \
  $(LIB)(getlab.o)   \
diff --git src/Makefile_linux src/Makefile_linux
old mode 100755
new mode 100644
diff --git src/Makefile_linux.gfort src/Makefile_linux.gfort
old mode 100755
new mode 100644
diff --git src/Makefile_linux_intel_27.gfort src/Makefile_linux_intel_27.gfort
new file mode 100644
index 00000000..6d73427a
--- /dev/null
+++ src/Makefile_linux_intel_27.gfort
@@ -0,0 +1,118 @@
+# 
+# PURPOSE:  MAKEFILE FOR creating Linux SPIDER using FFTW3 using single processor compiled with gfortran
+#
+# USING:             Gnu Fortran compiler
+# TARGET:            Same machine as compiled on
+# IMAGES:            Optimal SPIDER image byte order: Native to machine
+ 
+# CREATE EXECUTABLE: make -f Makefile_linux_intel_27.gfort
+ 
+#        ANOTHER:    make -f Makefile_linux_mp_intel_27.gfort
+
+#        ANOTHER:    make -f Makefile_linux_intel_backtrace_27.gfort
+
+ 
+# EXECUTABLE:        spider_linux_intel_gfort_27 
+ 
+# NOTE:     Since .MOD files are not compatible with those prepared by
+#           other compilers be sure and compile in a clean directory!!!
+#           \rm spider_linux_intel_backtrace_gfort_27.a  *.mod
+#           See note on compilation order in: Makefile.inc
+#
+# NOTE:     Uses FFTW3 configured with: --enable-float --enable-openmp  
+#                                       --enable-threads
+#
+# NOTE:     You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
+#
+# FOR INITIAL USE:  \rm spider_linux_intel_gfort_27.a  *.mod
+#                   See note on compilation order in: Makefile.inc
+#
+# SOME GFORTRAN COMPILE/LINK FLAGS
+# -cpp                      : Use C preprocesor
+# -fopenmp                  : Invokes multi processor support
+# -Ofast                    : Selects fast set of flags for this architecture 
+# -Og                       : Few optimizations (faster than -0 , for debug use) 
+# -O0                       : No optimizations  (slow, for debug use)
+# -g                        : For use with in interactive debugger
+# -fallow-argument-mismatch : Needed for conflation of COMPLEX/REAL
+# -funroll-loops            : Sets optimization of loop unrolling
+# -finline-limit=600        : Sets limit on the number of inlined instructions 
+# -fwrapv                   : Wraps signed int overflow (Needed by: bpcg.f)
+# -fcheck=all               : Enables runtime tests, e.g. array bounds 
+# -fbacktrace               : To list location after crash
+# -fbounds-check            : Slow but lists array overflow
+# -fno-strict-aliasing      : No strict-aliasing warning
+# -Wall                     : Enable reporting of possible errors
+# -Wno-unused-parameter     : Stops nag about unused parameters
+# -Wno-unused-label         : Stops nag about unused statement labels
+# -Wno-unused-variable      : Stops nag about unused variables
+# -Wno-unused-dummy-argument: Stops nag about unused args in subroutine call
+# -Wno-conversion           : Stops nag about integer value = real value
+
+
+SHELL    = /bin/sh
+
+AFLAGS   = r
+
+# Location of Fortran compiler
+COMP     = /usr/bin/gfortran-13
+
+PGM      = spider
+
+WHICH    = linux_intel_gfort
+
+SUFFIX   = 27
+
+LIB      = $(PGM)_$(WHICH)_$(SUFFIX).a
+
+EXE      = $(PGM)_$(WHICH)_$(SUFFIX)
+
+LF       = $(QLFLAGS)  
+
+FFLAGS   = -cpp -Ofast -funroll-loops -finline-limit=600 -fno-strict-aliasing -fwrapv  -fallow-argument-mismatch -DSP_LIBFFTW3 -DSP_GFORTRAN -c   
+
+FFTWLIBDIR = /home/dean/Software/spider-2026/fftw/fftw3310-intel-gfort/lib/
+
+LINKLIBS   = $(FFTWLIBDIR)/libfftw3f.a  $(FFTWLIBDIR)/libfftw3f_threads.a 
+
+.PRECIOUS :  $(EXE) $(LIB) 
+
+include Makefile.inc
+
+$(EXE) : $(LIB)
+	@echo "        "
+	@echo "        Linking now:  $(COMP) $(LF)  $(LIB) $(LINKLIBS) -o $(EXE)"
+	$(COMP) $(LF)  $(LIB) $(LINKLIBS) -o $(EXE)
+	@echo "Created: $(EXE)"
+	@echo " "
+
+$(LIB) : $(ELEMENTS)
+	@echo "         "
+	@echo "        Compiling and archiving $(COMP) $(FFLAGS) $< now ----"
+	@echo "         "
+.f.a:
+	@echo "         "
+	@echo "        Compiling $< now ----"
+	$(COMP) $(FFLAGS) $<
+	$(AR) $(AFLAGS) $(LIB) $*.o
+	@\rm $*.o
+
+
+#SRCS = $(patsubst %.f, %.o, $(filter-out $(EXCLUDE), $(wildcard *.f)))
+
+clean:
+	rm -f *.mod *.MOD *.a
+
+# Tapu's: FFLAGS = -cpp -Ofast -funroll-loops -finline-limit=600 -DSP_LIBFFTW3 -DSP_GFORTRAN -fno-strict-aliasing -fwrapv -fallow-argument-mismatch -c
+#  
+# Static link with static FFTW3 libraries 
+# Tapu's: FFTWLIBDIR = ../fftw/fftw-3.3.10/lib
+#         FFTWLIBDIR = ../../fftw/fftw3-opt64-gfort/lib
+#         FFTWLIBDIR = ../../fftw/fftw321-intel/lib
+#         FFTWLIBDIR = ../../fftw/fftw3-opt64-gfort/lib
+#
+#         FFTWLIBDIR = fftw321-opt64/       NO
+#         FFTWLIBDIR = fftw321-intel/       BAD  ARCH
+#         FFTWLIBDIR = fftw337-intel64-icc/ NO INTEL...
+#
+#LINKLIBS  = -L$(FFTWLIBDIR) -llibfftw3f.a -llibfftw3f_threads.a -llibfftw3f_omp.a
diff --git src/Makefile_linux_intel_backtrace_27.gfort src/Makefile_linux_intel_backtrace_27.gfort
new file mode 100644
index 00000000..59a9875b
--- /dev/null
+++ src/Makefile_linux_intel_backtrace_27.gfort
@@ -0,0 +1,110 @@
+
+# PURPOSE:  MAKEFILE For Linux SPIDER using FFTW3 using single processor.
+#           Compiled with gfortran  for use in tracing crashes
+#
+# USING:             Gnu Fortran compiler
+# TARGET:            Same machine as compiled on
+# IMAGES:            Optimal SPIDER image byte order:    Native to machine
+# CREATE EXECUTABLE: make -f Makefile_linux_intel_backtrace_27.gfort
+
+#        ANOTHER:    make -f Makefile_linux_intel_27.gfort
+ 
+#        ANOTHER:    make -f Makefile_linux_mp_intel_27.gfort
+ 
+# RUN EXECUTABLE:    spider_linux_intel_backtrace_gfort_27 
+ 
+# NOTE:     Since .MOD files are not compatible with those prepared by
+#           other compilers be sure and compile in a clean directory!!!
+#           \rm spider_linux_intel_backtrace_gfort_27.a  *.mod
+#           See note on compilation order in: Makefile.inc
+#
+# NOTE:     Uses FFTW3 configured with: --enable-float --enable-openmp  
+#                                       --enable-threads
+#
+# NOTE:     You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
+#
+# Some gfortran compile/link flags
+# -cpp                      : Use C preprocesor
+# -fopenmp                  : Invokes multi processor support
+# -Ofast                    : Selects fast set of flags for this architecture 
+# -Og                       : Few optimizations (faster than -0 , for debug use) 
+# -O0                       : No optimizations  (slow, for debug use)
+# -g                        : For use with in interactive debugger
+# -fallow-argument-mismatch : Needed for conflation of COMPLEX/REAL
+# -funroll-loops            : Sets optimization of loop unrolling
+# -finline-limit=600        : Sets limit on the number of inlined instructions 
+# -fwrapv                   : Wraps signed int overflow (Needed by: bpcg.f)
+# -fcheck=all               : Enables runtime tests, e.g. array bounds 
+# -fbacktrace               : To list location after crash
+# -fbounds-check            : Slow but lists array overflow
+# -fno-strict-aliasing      : No strict-aliasing warning
+# -Wall                     : Enable reporting of possible errors
+# -Wno-unused-parameter     : Stops nag about unused parameters
+# -Wno-unused-label         : Stops nag about unused statement labels
+# -Wno-unused-variable      : Stops nag about unused variables
+# -Wno-unused-dummy-argument: Stops nag about unused args in subroutine call
+# -Wno-conversion           : Stops nag about integer value = real value
+
+
+SHELL    = /bin/sh
+
+AFLAGS   = r
+
+# Location of Fortran compiler
+COMP     = /usr/bin/gfortran-13
+
+PGM      = spider
+
+WHICH    = linux_intel_backtrace_gfort
+
+SUFFIX   = 27
+
+LIB      = $(PGM)_$(WHICH)_$(SUFFIX).a
+
+EXE      = $(PGM)_$(WHICH)_$(SUFFIX)
+
+LF       = $(QLFLAGS)
+
+LIB      = $(EXE).a
+
+FFLAGS   = -cpp -Ofast -funroll-loops -finline-limit=600 -fno-strict-aliasing -fwrapv -g -O0   -fallow-argument-mismatch -fcheck=all -fbacktrace -Wall -Wno-unused-variable -Wno-unused-dummy-argument -Wno-conversion -DSP_LIBFFTW3 -DSP_GFORTRAN  -DSP_DBUGIO -c
+
+#-DSP_GFORTRAN -DSP_BACK -DSP_DEBUG -DSP_DBUGIO -c
+
+
+# Static link with static FFTW3 libraries
+FFTWLIBDIR = /home/dean/Software/spider-2026/fftw/fftw3310-intel-gfort/lib/
+
+LINKLIBS   = $(FFTWLIBDIR)/libfftw3f.a  $(FFTWLIBDIR)/libfftw3f_threads.a $(FFTWLIBDIR)/libfftw3f_omp.a
+
+.PRECIOUS :  ../bin/$(EXE) $(LIB)
+
+include Makefile.inc
+
+$(EXE) : $(LIB)
+	@echo "        "
+	@echo "        Linking now:  $(COMP) $(LF)  $(LIB) $(LINKLIBS) -o $(EXE)"
+	$(COMP) $(LF)  $(LIB) $(LINKLIBS) -o $(EXE)
+	@echo "Created: $(EXE)"
+	@echo " "
+
+$(LIB) : $(ELEMENTS)
+	@echo "         "
+	@echo "        Compiling and archiving $(COMP) $(FFLAGS) $< now ----"
+	@echo "         "
+.f.a:
+	@echo "         "
+	@echo "        Compiling $< now ----"
+	$(COMP) $(FFLAGS) $<
+	$(AR) $(AFLAGS) $(LIB) $*.o
+	@\rm $*.o
+
+#SRCS = $(patsubst %.f, %.o, $(filter-out $(EXCLUDE), $(wildcard *.f)))
+
+clean:
+	rm -f *.mod *.MOD *.a
+
+
+# FFLAGS   = -cpp -Ofast -funroll-loops -finline-limit=600 -DSP_LIBFFTW3 
+#            -DSP_GFORTRAN -fno-strict-aliasing -fwrapv  -g -O0 -fcheck=all -fbacktrace 
+#            -fallow-argument-mismatch
diff --git src/Makefile_linux_mp src/Makefile_linux_mp
old mode 100755
new mode 100644
diff --git src/Makefile_linux_mp.gfort src/Makefile_linux_mp.gfort
index 552cc73e..b7bfa8f0 100644
--- src/Makefile_linux_mp.gfort
+++ src/Makefile_linux_mp.gfort
@@ -6,6 +6,10 @@
 # IMAGES:   Optimal SPIDER image byte order:    native to machine 
 # USAGE:    To create executable: make -f Makefile_linux_mp.gfort
 #
+#
+# FOR INITIAL USE:  \rm spider_linux_intel_gfort_27.a  *.mod
+#                   See note on compilation order in: Makefile.inc
+#
 # NOTE:     Uses FFTW3 configured with: --enable-float --enable-openmp
 # NOTE:     You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
 #
@@ -24,7 +28,7 @@ SHELL    = /bin/sh
 AFLAGS   = r
 
 # Location of Fortran compiler
-COMP     = /usr/bin/gfortran
+COMP     = /usr/bin/gfortran-13
 
 PGM      = spider_linux_mp_gfort
 
diff --git src/Makefile_linux_mp_backtrace.gfort src/Makefile_linux_mp_backtrace.gfort
new file mode 100644
index 00000000..4bd9d026
--- /dev/null
+++ src/Makefile_linux_mp_backtrace.gfort
@@ -0,0 +1,67 @@
+# 
+# PURPOSE:  MAKEFILE FOR GNU/Linux SPIDER using FFTW3 using multiple processors. Compiled with gfortran
+#
+# USING:    Gnu Fortran compiler!!
+# TARGET:   Same machine as compiled on  
+# IMAGES:   Optimal SPIDER image byte order:    native to machine 
+# USAGE:    To create executable: make -f Makefile_linux_mp.gfort
+#
+# NOTE:     Uses FFTW3 configured with: --enable-float --enable-openmp --enable-threads
+# NOTE:     You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
+#
+# NOTE:     SINCE .MOD FILES ARE NOT COMPATIBLE WITH THOSE PREPARED BY
+#           OTHER COMPILERS BE SURE AND COMPILE IN A CLEAN DIRECTORY!!!
+#
+# Some gfortran compile/link flags
+# -fopenmp                   : Invokes multi processor support
+# -Ofast                     : Selects fast set of flags for this architecture usually including:
+# -fwrapv                    : Wrapping of underflow/overflow  (needed for correct results in: bpcg.f)
+# -fno-strict-aliasing       :
+# -Wall                      : Report possible errors
+# -fallow-argument-mismatch' : Needed for conflation of COMPLEX/REAL
+
+SHELL    = /bin/sh
+
+AFLAGS   = r
+
+# Location of Fortran compiler
+COMP     = /usr/bin/gfortran
+
+PGM      = spider
+
+WHICH    = mp_gfort_backtrace
+
+EXE      = $(PGM)_linux_$(WHICH)$(SUFFIX)
+
+FFLAGS   = -cpp -Ofast -funroll-loops -finline-limit=600 -DSP_LIBFFTW3 -DSP_GFORTRAN -fno-strict-aliasing -fwrapv -fopenmp -g -O0 -fcheck=all -fbacktrace -DSP_MP -fallow-argument-mismatch -c
+
+LF       = -fopenmp $(QLFLAGS)
+
+LIB      = $(EXE).a
+
+# Static link with static FFTW3 libraries
+FFTWLIBDIR = ../fftw/fftw-3.3.10/lib
+LINKLIBS   = -L$(FFTWLIBDIR) -lfftw3f -lfftw3f_threads
+
+.PRECIOUS :  ../bin/$(EXE) $(LIB)
+
+include Makefile.inc
+
+$(EXE) : $(LIB)
+	$(COMP) $(LF)  $(LIB) $(LINKLIBS) -o ../bin/$(EXE)
+	@echo "Created: $(EXE)"
+	@echo " "
+
+$(LIB) : $(ELEMENTS)
+	@echo "        linking $(EXE) now ----"
+.f.a:
+	$(COMP) $(FFLAGS) $<
+	$(AR) $(AFLAGS) $(LIB) $*.o
+	@\rm $*.o
+
+
+#SRCS = $(patsubst %.f, %.o, $(filter-out $(EXCLUDE), $(wildcard *.f)))
+
+clean:
+	rm -f *.mod *.MOD *.a
+
diff --git src/Makefile_linux_mp_intel src/Makefile_linux_mp_intel
old mode 100755
new mode 100644
diff --git src/Makefile_linux_mp_intel_27.gfort src/Makefile_linux_mp_intel_27.gfort
new file mode 100644
index 00000000..cdf056e5
--- /dev/null
+++ src/Makefile_linux_mp_intel_27.gfort
@@ -0,0 +1,122 @@
+# 
+# PURPOSE:  MAKEFILE FOR Linux SPIDER using FFTW3 using multiple processors. 
+#           Compiled with gfortran
+#
+# USING:             Gnu Fortran compiler
+# TARGET:            Same machine as compiled on  
+# IMAGES:            Optimal SPIDER image byte order:    native to machine 
+# CREATE EXECUTABLE: make -f Makefile_linux_mp_intel_27.gfort
+
+#        ANOTHER:    make -f Makefile_linux_intel_27.gfort
+ 
+#        ANOTHER:    make -f Makefile_linux_intel_backtrace_27.gfort
+
+# RUN EXECUTABLE:    spider_linux_mp_intel_gfort_27 
+ 
+# NOTE:     Since .MOD files are not compatible with those prepared by
+#           other compilers be sure and compile in a clean directory!!!
+#           \rm spider_linux_mp_intel_gfort_27.a   *.mod
+#           See note on compilation order in: Makefile.inc
+#
+# NOTE:     Uses FFTW3 configured with: --enable-float --enable-openmp  
+#                                       --enable-threads
+#
+# NOTE:     You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
+#
+# Some gfortran compile/link flags
+# -cpp                      : Use C preprocesor
+# -fopenmp                  : Invokes multi processor support
+# -Ofast                    : Selects fast set of flags for this architecture 
+# -Og                       : Few optimizations (faster than -0 , for debug use) 
+# -O0                       : No optimizations  (slow, for debug use)
+# -g                        : For use with in interactive debugger
+# -fallow-argument-mismatch : Needed for conflation of COMPLEX/REAL
+# -funroll-loops            : Sets optimization of loop unrolling
+# -finline-limit=600        : Sets limit on the number of inlined instructions 
+# -fwrapv                   : Wraps signed int overflow (Needed by: bpcg.f)
+# -fcheck=all               : Enables runtime tests, e.g. array bounds 
+# -fbacktrace               : To list location after crash
+# -fbounds-check            : Slow but lists array overflow
+# -fno-strict-aliasing      : No strict-aliasing warning
+# -Wall                     : Enable reporting of possible errors
+# -Wno-unused-parameter     : Stops nag about unused parameters
+# -Wno-unused-label         : Stops nag about unused statement labels
+# -Wno-unused-variable      : Stops nag about unused variables
+# -Wno-unused-dummy-argument: Stops nag about unused args in subroutine call
+# -Wno-conversion           : Stops nag about integer value = real value
+#
+# FOR INITIAL USE:   \rm spider_linux_mp_intel_gfort_27.a  *.mod
+#                    See note on compilation order in: Makefile.inc
+#
+# NOTE:     Uses FFTW3 configured with: --enable-float --enable-openmp
+# NOTE:     You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
+#
+
+SHELL    = /bin/sh
+
+AFLAGS   = r
+
+# Location of Fortran compiler
+COMP     = /usr/bin/gfortran-13
+
+PGM      = spider
+
+WHICH    = linux_mp_intel_gfort
+
+SUFFIX   = 27
+
+LIB      = $(PGM)_$(WHICH)_$(SUFFIX).a
+
+EXE      = $(PGM)_$(WHICH)_$(SUFFIX)
+
+LF       = -fopenmp $(QLFLAGS)  
+
+FFLAGS    = -cpp -Ofast -funroll-loops -finline-limit=600 -fno-strict-aliasing -fwrapv -fopenmp -fallow-argument-mismatch -DSP_MP -DSP_LIBFFTW3 -DSP_GFORTRAN -c   
+
+FFTWLIBDIR = /home/dean/Software/spider-2026/fftw/fftw3310-intel-gfort/lib/
+#            /home/dean/Software/spider-github-2026/fftw/fftw3310-intel-gfort/lib/
+
+LINKLIBS   = $(FFTWLIBDIR)/libfftw3f.a  $(FFTWLIBDIR)/libfftw3f_threads.a $(FFTWLIBDIR)/libfftw3f_omp.a
+
+.PRECIOUS :  $(EXE) $(LIB) 
+
+include Makefile.inc
+
+$(EXE) : $(LIB)
+	@echo "        "
+	@echo "        Linking now:  $(COMP) $(LF)  $(LIB) $(LINKLIBS) -o $(EXE)"
+	$(COMP) $(LF)  $(LIB) $(LINKLIBS) -o $(EXE)
+	@echo "Created: $(EXE)"
+	@echo " "
+
+$(LIB) : $(ELEMENTS)
+	@echo "         "
+	@echo "        Compiling and archiving $(COMP) $(FFLAGS) $< now ----"
+	@echo "         "
+.f.a:
+	@echo "         "
+	@echo "        Compiling $< now ----"
+	$(COMP) $(FFLAGS) $<
+	$(AR) $(AFLAGS) $(LIB) $*.o
+	@\rm $*.o
+
+
+#SRCS = $(patsubst %.f, %.o, $(filter-out $(EXCLUDE), $(wildcard *.f)))
+
+clean:
+	rm -f *.mod *.MOD *.a
+
+#FFLAGS   = -cpp -Ofast -funroll-loops -finline-limit=600 -DSP_MP -DSP_LIBFFTW3 #-DSP_GFORTRAN  -fno-strict-aliasing -fwrapv -fopenmp -Wno-argument-mismatch -c    
+# Tapu's: FFLAGS   = -cpp -Ofast -funroll-loops -finline-limit=600 -DSP_LIBFFTW3 -DSP_GFORTRAN -fno-strict-aliasing -fwrapv -fallow-argument-mismatch -c
+#
+# Static link with static FFTW3 libraries 
+# Tapu's: FFTWLIBDIR = ../fftw/fftw-3.3.10/lib
+#         FFTWLIBDIR = ../../fftw/fftw3-opt64-gfort/lib
+#         FFTWLIBDIR = ../../fftw/fftw321-intel/lib
+#         FFTWLIBDIR = ../../fftw/fftw3-opt64-gfort/lib
+#
+#         FFTWLIBDIR = fftw321-opt64/       NO
+#         FFTWLIBDIR = fftw321-intel/       BAD ARCH
+#         FFTWLIBDIR = fftw337-intel64-icc/ NO INTEL...
+
+#LINKLIBS  = -L$(FFTWLIBDIR) -llibfftw3f.a -llibfftw3f_threads.a -llibfftw3f_omp.a
diff --git src/Makefile_samples/Makefile_NT src/Makefile_samples/Makefile_NT
old mode 100755
new mode 100644
diff --git src/Makefile_samples/Makefile_ibm src/Makefile_samples/Makefile_ibm
old mode 100755
new mode 100644
diff --git src/Makefile_samples/Makefile_ibmmp src/Makefile_samples/Makefile_ibmmp
old mode 100755
new mode 100644
diff --git src/Makefile_samples/Makefile_linux src/Makefile_samples/Makefile_linux
old mode 100755
new mode 100644
diff --git src/Makefile_samples/Makefile_linux.gfort src/Makefile_samples/Makefile_linux.gfort
old mode 100755
new mode 100644
diff --git src/Makefile_samples/Makefile_linux_mp src/Makefile_samples/Makefile_linux_mp
old mode 100755
new mode 100644
diff --git src/Makefile_samples/Makefile_linux_mp.ifort src/Makefile_samples/Makefile_linux_mp.ifort
old mode 100755
new mode 100644
diff --git src/Makefile_samples/Makefile_linux_mp_intel src/Makefile_samples/Makefile_linux_mp_intel
old mode 100755
new mode 100644
diff --git src/Makefile_samples/Makefile_linux_mp_intel64.ifort src/Makefile_samples/Makefile_linux_mp_intel64.ifort
old mode 100755
new mode 100644
diff --git src/Makefile_samples/Makefile_linux_mp_intel_nat src/Makefile_samples/Makefile_linux_mp_intel_nat
old mode 100755
new mode 100644
diff --git src/Makefile_samples/RCS/Makefile,v src/Makefile_samples/RCS/Makefile,v
deleted file mode 100644
index 8396c936..00000000
--- src/Makefile_samples/RCS/Makefile,v
+++ /dev/null
@@ -1,1943 +0,0 @@
-head	1.43;
-access;
-symbols
-	pre_fftwrings:1.37
-	pre_opfiles:1.37
-	src:1.37
-	best-code:1.36
-	x-named-regs:1.36
-	x:1.36
-	v13-00:1.36
-	pre_GPL:1.33
-	prec_CA:1.28
-	noindx:1.19
-	Bproc:1.16
-	oct21:1.16
-	last77:1.15;
-locks; strict;
-comment	@# @;
-
-
-1.43
-date	2011.03.14.14.57.44;	author leith;	state Exp;
-branches;
-next	1.42;
-
-1.42
-date	2011.03.03.18.37.42;	author leith;	state Exp;
-branches;
-next	1.41;
-
-1.41
-date	2009.05.12.17.37.16;	author leith;	state Exp;
-branches;
-next	1.40;
-
-1.40
-date	2009.05.06.18.18.31;	author leith;	state Exp;
-branches;
-next	1.39;
-
-1.39
-date	2008.11.06.16.33.28;	author leith;	state Exp;
-branches;
-next	1.38;
-
-1.38
-date	2008.11.03.15.23.17;	author leith;	state Exp;
-branches;
-next	1.37;
-
-1.37
-date	2006.07.26.17.46.27;	author leith;	state Exp;
-branches;
-next	1.36;
-
-1.36
-date	2005.10.20.13.58.51;	author leith;	state Exp;
-branches;
-next	1.35;
-
-1.35
-date	2005.10.19.19.52.01;	author leith;	state Exp;
-branches;
-next	1.34;
-
-1.34
-date	2005.10.19.18.43.07;	author leith;	state Exp;
-branches;
-next	1.33;
-
-1.33
-date	2005.04.29.17.41.27;	author leith;	state Exp;
-branches;
-next	1.32;
-
-1.32
-date	2004.07.08.19.10.43;	author leith;	state Exp;
-branches;
-next	1.31;
-
-1.31
-date	2004.06.10.13.29.15;	author leith;	state Exp;
-branches;
-next	1.30;
-
-1.30
-date	2004.05.12.19.03.35;	author leith;	state Exp;
-branches;
-next	1.29;
-
-1.29
-date	2004.01.06.14.46.05;	author leith;	state Exp;
-branches;
-next	1.28;
-
-1.28
-date	2003.06.13.14.08.12;	author leith;	state Exp;
-branches;
-next	1.27;
-
-1.27
-date	2003.06.13.13.26.19;	author leith;	state Exp;
-branches;
-next	1.26;
-
-1.26
-date	2003.04.07.19.03.51;	author leith;	state Exp;
-branches;
-next	1.25;
-
-1.25
-date	2003.03.25.15.18.15;	author leith;	state Exp;
-branches;
-next	1.24;
-
-1.24
-date	2003.02.14.15.06.41;	author leith;	state Exp;
-branches;
-next	1.23;
-
-1.23
-date	2003.02.14.15.02.50;	author leith;	state Exp;
-branches;
-next	1.22;
-
-1.22
-date	2003.02.13.15.54.51;	author leith;	state Exp;
-branches;
-next	1.21;
-
-1.21
-date	2003.02.04.15.11.26;	author leith;	state Exp;
-branches;
-next	1.20;
-
-1.20
-date	2003.02.03.18.47.57;	author leith;	state Exp;
-branches;
-next	1.19;
-
-1.19
-date	2001.01.26.14.58.16;	author leith;	state Exp;
-branches;
-next	1.18;
-
-1.18
-date	2001.01.26.13.59.23;	author leith;	state Exp;
-branches;
-next	1.17;
-
-1.17
-date	2001.01.25.20.29.32;	author leith;	state Exp;
-branches;
-next	1.16;
-
-1.16
-date	99.06.03.15.56.23;	author leith;	state Exp;
-branches;
-next	1.15;
-
-1.15
-date	98.03.03.16.14.51;	author leith;	state Exp;
-branches;
-next	1.14;
-
-1.14
-date	98.02.17.18.22.39;	author pawel;	state Exp;
-branches;
-next	1.13;
-
-1.13
-date	98.01.30.17.01.03;	author pawel;	state Exp;
-branches;
-next	1.12;
-
-1.12
-date	97.07.30.18.08.11;	author leith;	state Exp;
-branches;
-next	1.11;
-
-1.11
-date	97.07.30.15.31.20;	author leith;	state Exp;
-branches;
-next	1.10;
-
-1.10
-date	97.07.29.19.52.02;	author leith;	state Exp;
-branches;
-next	1.9;
-
-1.9
-date	97.07.29.18.01.58;	author leith;	state Exp;
-branches;
-next	1.8;
-
-1.8
-date	97.07.29.16.00.11;	author leith;	state Exp;
-branches;
-next	1.7;
-
-1.7
-date	97.07.23.19.11.01;	author pawel;	state Exp;
-branches;
-next	1.6;
-
-1.6
-date	95.02.01.10.45.59;	author leith;	state Exp;
-branches;
-next	1.5;
-
-1.5
-date	95.01.30.15.54.59;	author leith;	state Exp;
-branches;
-next	1.4;
-
-1.4
-date	95.01.30.13.29.46;	author leith;	state Exp;
-branches;
-next	1.3;
-
-1.3
-date	95.01.27.16.38.59;	author leith;	state Exp;
-branches;
-next	1.2;
-
-1.2
-date	95.01.26.13.07.18;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	94.07.14.11.26.50;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.43
-log
-@removed _linux_mp_opt64s
-@
-text
-@#! /bin/sh Makefile
-# On GNU/Linux you must: alias make "/bin/sh Makefile $1" for this to work!!
-#
-# PURPOSE:      Chooses specific Makefile      
-#
-# NORMAL USAGE: make [version-selector]
-#
-# SAMPLE USAGE: make 
-#               make [mp][f][d] e.g. 
-#               on Linux
-#                  make mp (to create spider_linux_mp)
-#                  make all (to create all current executables)
-#                  make new (to update all current executables version)
-
-TARGET="$1"
-echo TARGET: $TARGET
-
-DEST="DEST=_tmp"
-
-DEBUG=
-
-if expr "$TARGET" : '.*d' > /dev/null
-then # Want debugger suitable output, set flags & edit TARGET
-  DEBUG="QFFLAGS=-g QLFLAGS=-g SUFFIX=d"
-  # echo DEBUG: $DEBUG
-  TARGET=`echo $TARGET | tr -d 'd'`
-fi
-
-UNAME=`uname`
-#echo UNAME: $UNAME
-UNAMEm=`uname -m`
-#echo UNAMEm: $UNAMEm
-
-case "$UNAME" in
-#  Find current operating system
-   Linux)  
-      PLATFORM=_linux 
-      VERSIONS=" _linux _linux_mp_opt64  _linux_mp_intel _linux_mpi_opt64 _linux_mp_intel64 " 
-     
-      if expr "$TARGET" : '.*mp' > /dev/null
-      then #  Want mp with  version
-         WHICH="mp"
-      else
-         if expr "$TARGET" : '.*f' > /dev/null
-         then #  Want  version
-            WHICH=""
-         fi
-      fi;;
-esac
-
-
-case "$TARGET" in
-   new) # Update all VERSIONS to Next highest version number
-
-        for SELECT in $VERSIONS
-        do
-           FILE=../bin/spider$SELECT"_tmp"
-           if [ -e $FILE ] 
-           then
-              echo "Creating: `./Nextversion ../bin/spider$SELECT`"
-              cp $FILE ../bin/`./Nextversion ../bin/spider$SELECT`
-           else
-              echo No: $FILE
-           fi
-        done
-        exit ;;
-
-   all) # Make all spiders to _tmp
-
-        for SELECT in $VERSIONS
-        do
-           echo Running: make -f Makefile$SELECT $DEST
-           make -f Makefile$SELECT $DEST
-           echo " "
-        done
-        exit ;;
-esac
-
-#echo WHICH: $WHICH
- 
-# echo WHICH makefile selection to screen
-echo Running: make -f Makefile$WHICH $DEBUG $DEST
-
-# activate proper Makefile
-make -f Makefile$WHICH $DEBUG $DEST
-
-exit
-
-
-
-
-
-
-@
-
-
-1.42
-log
-@for 11
-@
-text
-@d38 1
-a38 1
-      VERSIONS=" _linux _linux_mp_opt64 _linux_mp_opt64s _linux_mp_intel _linux_mpi_opt64 _linux_mp_intel64 " 
-@
-
-
-1.41
-log
-@_linux_mp_intel64
-@
-text
-@d4 1
-a4 1
-# Chooses specific Makefile      
-d6 1
-a6 1
-# normal usage: make [version-selector]
-d8 1
-a8 1
-# sample usage: make 
-a13 4
-#               on Altix
-#                  make mp (to create spider_linux_mp)
-#                  make all (to create all current executables)
-#                  make new (to update all current executables version)
-d38 1
-a38 7
-      VERSIONS=" _linux _linux_mp_opt64 _linux_mp_intel _linux_mpi_opt64 _linux_mp_intel64 " 
-
-      if expr "$UNAMEm" : 'ia64' > /dev/null
-      then #  Want Altix version
-         VERSIONS="_linux_mp_altix" 
-         WHICH=   
-      fi
-d82 1
-a82 1
-echo Running: make -f Makefile$PLATFORM$WHICH $DEBUG $DEST
-d85 1
-a85 1
-make -f Makefile$PLATFORM$WHICH $DEBUG $DEST
-@
-
-
-1.40
-log
-@intel64
-@
-text
-@d42 1
-a42 1
-      VERSIONS=" _linux _linux_mp_opt64 _linux_mp_intel _linux_mpi_opt64 -linux_mp_intel64 " 
-@
-
-
-1.39
-log
-@*** empty log message ***
-@
-text
-@d42 1
-a42 1
-      VERSIONS=" _linux _linux_mp_opt64 _linux_mp_intel _linux_mpi_opt64 " 
-@
-
-
-1.38
-log
-@*** empty log message ***
-@
-text
-@d42 1
-a42 1
-      VERSIONS=" _linux_fftw _linux_mpfftw_opt64 _linux_mpfftw_intel _linux_mpi_opt64 " 
-d46 1
-a46 1
-         VERSIONS="_linux_mpfftw_altix" 
-d51 1
-a51 1
-      then #  Want mp with fftw version
-d55 2
-a56 2
-         then #  Want fftw version
-            WHICH="fftw"
-@
-
-
-1.37
-log
-@linux_mpfftw_opt64
-@
-text
-@a9 4
-#               on SGI
-#                  make 4   (to create spider4)
-#                  make all (to create all current executables)
-#                  make new (to update all current executables version)
-a39 8
-   IRIX*)  
-      PLATFORM=  
-      VERSIONS="3 4mp 5mp"
-      WHICH=4   
-      case "$TARGET" in
-         ?*) WHICH=$TARGET;;
-      esac
-      ;;
-d42 1
-a42 1
-      VERSIONS=" _linux_fftw _linux_mpfftw_opt64 _linux_mpfftw_intel " 
-@
-
-
-1.36
-log
-@*** empty log message ***
-@
-text
-@d54 1
-a54 1
-      VERSIONS=" _linux_mpfftw  _linux_mpfftw_intel " 
-a61 6
-      if expr "$UNAMEm" : 'x86_64' > /dev/null
-      then #  Want Opt64 version
-         VERSIONS="_linux_mpfftw_opt64" 
-         WHICH=   
-      fi
-     
-@
-
-
-1.35
-log
-@linux_fftw added
-@
-text
-@d54 1
-a54 1
-      VERSIONS=" _linux_mpfftw  _linux_mpfftw_intel _linux_fftw" 
-@
-
-
-1.34
-log
-@for opt64 all
-@
-text
-@d54 1
-a54 1
-      VERSIONS=" _linux_mpfftw  _linux_mpfftw_intel" 
-@
-
-
-1.33
-log
-@./Nextversion
-@
-text
-@d54 1
-a54 1
-      VERSIONS="_linux_mp _linux_mpfftw _linux_mpfftw_rh7 _linux_mpfftw_intel" 
-a57 1
-         PLATFORM= 
-d62 6
-@
-
-
-1.32
-log
-@for linux
-@
-text
-@d24 1
-a24 1
-#echo TARGET: $TARGET
-d83 2
-a84 2
-              echo "Creating: `Nextversion ../bin/spider$SELECT`"
-              cp $FILE ../bin/`Nextversion ../bin/spider$SELECT`
-@
-
-
-1.31
-log
-@opteron added
-@
-text
-@d54 1
-a54 1
-      VERSIONS="_linux_mp _linux_mpfftw _linux_other _linux_mpfftw_intel _linux_mpfftw_opt" 
-d59 1
-a59 1
-         VERSIONS="_altix" 
-@
-
-
-1.30
-log
-@*** empty log message ***
-@
-text
-@d54 1
-a54 1
-      VERSIONS="_linux_mp _linux_mpfftw _linux_other _linux_mpfftw_intel" 
-@
-
-
-1.29
-log
-@removed spider4 spider5
-@
-text
-@d18 4
-d39 2
-d55 7
-@
-
-
-1.28
-log
-@changed to only 4 linux now
-@
-text
-@d40 1
-a40 1
-      VERSIONS="3 4 4mp 5 5mp"
-@
-
-
-1.27
-log
-@non-mp not necessary on linux
-@
-text
-@d48 1
-a48 1
-      VERSIONS="_linux _linux_mpfftw _linux_other _linux_mpfftw_intel" 
-@
-
-
-1.26
-log
-@intel
-@
-text
-@d48 1
-a48 1
-      VERSIONS="_linux _linux_fftw _linux_mpfftw _linux_other _linux_mpfftw_intel" 
-@
-
-
-1.25
-log
-@*** empty log message ***
-@
-text
-@d48 1
-a48 1
-      VERSIONS="_linux _linux_fftw _linux_mp _linux_mpfftw _linux_other" 
-@
-
-
-1.24
-log
-@other
-@
-text
-@d48 1
-a48 1
-      VERSIONS="_linux _linuxfftw _linuxmp _linuxmpfftw _linuxother" 
-@
-
-
-1.23
-log
-@_others on linux
-@
-text
-@d48 1
-a48 1
-      VERSIONS="_linux _linuxfftw _linuxmp _linuxmpfftw _other" 
-@
-
-
-1.22
-log
-@linuxmpfftw
-@
-text
-@d48 1
-a48 1
-      VERSIONS="_linux _linuxfftw _linuxmp _linuxmpfftw" 
-@
-
-
-1.21
-log
-@*** empty log message ***
-@
-text
-@d48 1
-a48 1
-      VERSIONS="_linux _linuxfftw _linuxmp" 
-@
-
-
-1.20
-log
-@*** empty log message ***
-@
-text
-@d2 1
-a2 1
-# On GNU/LinuZ you must: alias make "/bin/sh Makefile $1" for this to work!!
-d20 1
-a20 1
-echo TARGET: $TARGET
-a30 1
-  # echo TARGnow: $TARGET
-d38 1
-a38 1
-   IRIX)  
-d64 1
-d67 2
-a68 1
-           if [ -e ../bin/spider$SELECT_tmp ] 
-d71 1
-a71 1
-              cp ../bin/spider$SELECT_tmp ../bin/`Nextversion ../bin/spider$SELECT`
-d73 1
-a73 1
-               echo "No: ../bin/spider$SELECT_tmp"
-d82 2
-a83 2
-           echo "Making: Makefile$SELECT"
-           make -f Makefile$SELECT
-d92 1
-a92 1
-echo make -f Makefile$PLATFORM$WHICH $DEBUG $DEST
-d95 1
-a95 1
-#make -f Makefile$PLATFORM$WHICH $DEBUG $DEST
-@
-
-
-1.19
-log
-@*** empty log message ***
-@
-text
-@d2 1
-d4 1
-a4 1
-# Chooses correct Makefile for this OS version and host     
-d9 51
-a59 11
-#               make [one of 2, 3, 4, 4mp, 5, 5mp] e.g.
-#               make mp
-#         or    make all to create current executables
-#         or    make new to update current executables
-
-case "$1" in
-#   update all spiders to Nextversion
-    new)  Makenew
-          exit ;;
-    all)  Makeall
-          exit ;;
-d62 14
-a75 2
-which=`whichspider $1`
-#echo which: $which
-d77 1
-a77 2
-# echo target makefile selection to screen
-echo make -f Makefile$which 
-d79 14
-d94 6
-a99 1
-make -f Makefile$which AFLAGS=r
-a100 18
-# consolidated into respective makefiles 3/02/98 al
-# case "$which" in
-#    2)    ;;
-#    3)    bflags="BFLAGS=-DSP_LIBFFT"
-#          linklibs="LINKLIBS=-lcomplib.sgimath";;
-#    4)    bflags="BFLAGS=-DSP_LIBFFT"
-#          linklibs="LINKLIBS=-lcomplib.sgimath";; 
-#    4ns)  ;; 
-#    4mp)  bflags="BFLAGS=-DSP_LIBFFT"
-#          linklibs="LINKLIBS=-lcomplib.sgimath_mp";; 
-#    O3mp) bflags="BFLAGS=-DSP_LIBFFT"
-#          linklibs="LINKLIBS=-lcomplib.sgimath_mp";; 
-#    64 | 5 | 5mp)   bflags="BFLAGS=-DSP_LIBFFT"
-#          linklibs="LINKLIBS=-lcomplib.sgimath";; 
-#    *)    exit;; 
-# esac
-# 
-# make -f Makefile$which AFLAGS=r $bflags $linklibs
-@
-
-
-1.18
-log
-@spider5
-@
-text
-@d10 1
-@
-
-
-1.17
-log
-@64
-@
-text
-@d8 1
-a8 1
-#               make [one of 2, 3, 4, 4mp, 64] e.g.
-d16 2
-d41 1
-a41 1
-#    64)   bflags="BFLAGS=-DSP_LIBFFT"
-@
-
-
-1.16
-log
-@makes _tmp file now not Nextversion
-@
-text
-@d8 1
-a8 1
-#               make [one of 2, 3, 4, 4mp] e.g.
-d34 1
-d39 1
-a39 1
-#    4O3)  bflags="BFLAGS=-DSP_LIBFFT"
-@
-
-
-1.15
-log
-@moved libfft selector to respective makefiles
-@
-text
-@d10 1
-d12 5
-@
-
-
-1.14
-log
-@libfft for #4
-@
-text
-@d8 1
-a8 1
-#               make [one of 2, 3, 4, 4mp, 6, O3mp] e.g.
-d15 1
-a15 1
-# activate target makefile
-d18 2
-a19 2
-# select proper linking flags for OS
-# some routines have different names in spider2 library for libblas
-d21 17
-a37 16
-case "$which" in
-   2)    ;;
-   3)    bflags="BFLAGS=-DSP_LIBFFT"
-         linklibs="LINKLIBS=-lcomplib.sgimath";;
-   4)    bflags="BFLAGS=-DSP_LIBFFT"
-         linklibs="LINKLIBS=-lcomplib.sgimath";; 
-   4mp)  bflags="BFLAGS=-DSP_LIBFFT"
-         linklibs="LINKLIBS=-lcomplib.sgimath_mp";; 
-   O3mp) bflags="BFLAGS=-DSP_LIBFFT"
-         linklibs="LINKLIBS=-lcomplib.sgimath_mp";; 
-   4O3)  bflags="BFLAGS=-DSP_LIBFFT"
-         linklibs="LINKLIBS=-lcomplib.sgimath";; 
-   *)    exit;; 
-esac
-
-make -f Makefile$which AFLAGS=r $bflags $linklibs
-@
-
-
-1.13
-log
-@*** empty log message ***
-@
-text
-@d25 2
-a26 3
-   4)    ;;
-#   4)    bflags="BFLAGS=-DSP_LIBFFT"
-#         linklibs="LINKLIBS=-lcomplib.sgimath";; 
-@
-
-
-1.12
-log
-@added exit for which failure
-@
-text
-@d25 3
-a27 2
-   4)    bflags="BFLAGS=-DSP_LIBFFT"
-         linklibs="LINKLIBS=-lcomplib.sgimath";; 
-@
-
-
-1.11
-log
-@spelling error in ake --> make
-@
-text
-@d33 1
-@
-
-
-1.10
-log
-@*** empty log message ***
-@
-text
-@d35 1
-a35 1
-ake -f Makefile$which AFLAGS=r $bflags $linklibs
-@
-
-
-1.9
-log
-@used non liblas for spider2
-@
-text
-@d18 1
-a18 2
-if [ $which -ne 2 ] 
-then
-d20 16
-a35 5
-bflags="BFLAGS=-DSP_LIBFFT"
-#echo bflags:$bflags
-fi
- 
-make -f Makefile$which AFLAGS=r $bflags LINKLIBS=-lcomplib.sgimath
-@
-
-
-1.8
-log
-@*** empty log message ***
-@
-text
-@d17 7
-d25 1
-a25 1
-make -f Makefile$which AFLAGS=r BFLAGS=-DSP_LIBFFT LINKLIBS=lcomplib.sgimath
-@
-
-
-1.7
-log
-@97
-@
-text
-@d18 2
-a19 1
-make -f Makefile$which AFLAGS=r 
-@
-
-
-1.6
-log
-@quit
-buggy
-@
-text
-@d3 1
-a3 1
-# Chooses correct Makefile for this OS version     
-d5 1
-a5 1
-# normal usage: make
-d7 10
-d18 1
-a18 2
-os=`uname -r | cut -c1`
-echo " Making: "spider$os
-a19 6
-# select proper file for OS
-case "$os" in
-   4) make -f Makefile4;; 
-   5) make -f Makefile5;; 
-   6) make -f Makefile6;; 
-esac
-@
-
-
-1.5
-log
-@fixed
-@
-text
-@d15 1
-a15 1
-   6) make -f Makefile6";; 
-a16 1
-
-@
-
-
-1.4
-log
-@*** empty log message ***
-@
-text
-@d1 1
-a1 1
-#! /bin/sh
-d9 1
-@
-
-
-1.3
-log
-@new
-@
-text
-@d5 1
-a5 1
-# normal usage: foc6 filename (without extension!)
-@
-
-
-1.2
-log
-@used different spiders based on OS
-@
-text
-@d1 6
-a6 9
-# 
-# ------ MAKEFILE FILE FOR MERGED SPIDER ----------------
-# 
-#  ArDean Leith -- 11 MAY 1994
-# 
-# ------ DEFINE SOME VARIABLES ------
-# 
-# 
-# ------ REDEFINE SOME OF THE BUILT-IN RULES AND MACROS ------
-d8 1
-a8 9
-FFLAGS = -static -O1 -DSP_UNIX -G 3 -old_rl -c
- 
-PGM   = spider4
- 
-LIB =  $(PGM).a
- 
-.PRECIOUS :   $(LIB) ../bin/$(PGM)
- 
-include Makefile.inc
-d10 7
-a16 9
-../bin/$(PGM) : $(PGM).o $(LIB)
-	@@echo linking $(PGM)
-	f77 $(PGM).o $(LIB) -o ../bin/$(PGM)
-	\cp ../bin/$(PGM) ../bin/`Nextversion ../bin/$(PGM)`
-  
-$(PGM).o  : spider.f
-	f77 -static -O1 -DSP_UNIX -G 3 -old_rl -c spider.f 
-  
-$(LIB) :  $(ELEMENTS)
-@
-
-
-1.1
-log
-@Initial revision
-@
-text
-@d13 1
-a13 1
-PGM   = spider
-d19 2
-a20 902
-ELEMENTS = \
- $(LIB)(dummy.o) \
- $(LIB)(dummyimsl.o) \
- $(LIB)(sixstrt.o) \
- $(LIB)(util5.o) \
- $(LIB)(reang.o) \
- $(LIB)(cang.o) \
- $(LIB)(bpcqp.o) \
- $(LIB)(bpcq.o) \
- $(LIB)(bpcmp.o) \
- $(LIB)(bpcm.o) \
- $(LIB)(ac3d.o) \
- $(LIB)(add.o) \
- $(LIB)(adds.o) \
- $(LIB)(adjust.o) \
- $(LIB)(al10.o) \
- $(LIB)(al3dcall.o) \
- $(LIB)(ali3d.o) \
- $(LIB)(alprbs.o) \
- $(LIB)(alrbs.o) \
- $(LIB)(alrosf.o) \
- $(LIB)(alrosi.o) \
- $(LIB)(alrq.o) \
- $(LIB)(amoeba.o) \
- $(LIB)(ang.o) \
- $(LIB)(angmor.o) \
- $(LIB)(angmr.o) \
- $(LIB)(applsh.o) \
- $(LIB)(arasq.o) \
- $(LIB)(arbre.o) \
- $(LIB)(arith.o) \
- $(LIB)(asta.o) \
- $(LIB)(astcyl.o) \
- $(LIB)(atiltax3.o) \
- $(LIB)(autcor.o) \
- $(LIB)(auxfil.o) \
- $(LIB)(auxopn.o) \
- $(LIB)(averg.o) \
- $(LIB)(averg3.o) \
- $(LIB)(bapi.o) \
- $(LIB)(bapi3a.o) \
- $(LIB)(bckc0.o) \
- $(LIB)(bckc2.o) \
- $(LIB)(bckcq.o) \
- $(LIB)(bcq.o) \
- $(LIB)(bess1.o) \
- $(LIB)(betacf.o) \
- $(LIB)(betai.o) \
- $(LIB)(bitrev.o) \
- $(LIB)(bitrv.o) \
- $(LIB)(blank.o) \
- $(LIB)(bldr.o) \
- $(LIB)(blob.o) \
- $(LIB)(bmax_c.o) \
- $(LIB)(bmax_s.o) \
- $(LIB)(bmin_c.o) \
- $(LIB)(bmin_s.o) \
- $(LIB)(borns.o) \
- $(LIB)(boxx.o) \
- $(LIB)(bprj2.o) \
- $(LIB)(bproj3.o) \
- $(LIB)(bproj4.o) \
- $(LIB)(bps2.o) \
- $(LIB)(bpwr.o) \
- $(LIB)(bpwr_q.o) \
- $(LIB)(ca3d.o) \
- $(LIB)(calcerr.o) \
- $(LIB)(cald.o) \
- $(LIB)(camap.o) \
- $(LIB)(camvt.o) \
- $(LIB)(cascengr.o) \
- $(LIB)(cc3d.o) \
- $(LIB)(cc3da.o) \
- $(LIB)(ccc.o) \
- $(LIB)(ccmr.o) \
- $(LIB)(ccmul.o) \
- $(LIB)(cengca.o) \
- $(LIB)(cengr3.o) \
- $(LIB)(cengra.o) \
- $(LIB)(cent.o) \
- $(LIB)(cent_3.o) \
- $(LIB)(cent_d.o) \
- $(LIB)(cgr_3.o) \
- $(LIB)(chava.o) \
- $(LIB)(chkinpq.o) \
- $(LIB)(chknumq.o) \
- $(LIB)(chkstrq.o) \
- $(LIB)(clast.o) \
- $(LIB)(clasym.o) \
- $(LIB)(clearcomm.o) \
- $(LIB)(cncalc.o) \
- $(LIB)(cndisp.o) \
- $(LIB)(cnfile.o) \
- $(LIB)(cngoul.o) \
- $(LIB)(cnhelp.o) \
- $(LIB)(cnint.o) \
- $(LIB)(cnint3.o) \
- $(LIB)(cnint4.o) \
- $(LIB)(cnmov.o) \
- $(LIB)(cnopn.o) \
- $(LIB)(cnpost.o) \
- $(LIB)(cnscan.o) \
- $(LIB)(cnstuff.o) \
- $(LIB)(cntekt.o) \
- $(LIB)(cnterm.o) \
- $(LIB)(cnthin.o) \
- $(LIB)(cntrce.o) \
- $(LIB)(cntrfl.o) \
- $(LIB)(cntur.o) \
- $(LIB)(combeul.o) \
- $(LIB)(combeul1.o) \
- $(LIB)(comp3d.o) \
- $(LIB)(comp3dmad.o) \
- $(LIB)(conf.o) \
- $(LIB)(conf1.o) \
- $(LIB)(convl.o) \
- $(LIB)(cool2.o) \
- $(LIB)(coorot.o) \
- $(LIB)(cop.o) \
- $(LIB)(copyd.o) \
- $(LIB)(copye.o) \
- $(LIB)(copyf.o) \
- $(LIB)(copyfsimple.o) \
- $(LIB)(copyjp.o) \
- $(LIB)(copymdt.o) \
- $(LIB)(copymdtr.o) \
- $(LIB)(copypos.o) \
- $(LIB)(copypos2.o) \
- $(LIB)(copypos3.o) \
- $(LIB)(copyr.o) \
- $(LIB)(copyu.o) \
- $(LIB)(copyvax.o) \
- $(LIB)(corin.o) \
- $(LIB)(corinr.o) \
- $(LIB)(corr1.o) \
- $(LIB)(corr1a.o) \
- $(LIB)(corr1b.o) \
- $(LIB)(corr1c.o) \
- $(LIB)(coupe.o) \
- $(LIB)(cppb.o) \
- $(LIB)(cproj.o) \
- $(LIB)(cr180_2.o) \
- $(LIB)(crcse1.o) \
- $(LIB)(crcsec.o) \
- $(LIB)(creaf3.o) \
- $(LIB)(creatf.o) \
- $(LIB)(criter.o) \
- $(LIB)(crosrmg.o) \
- $(LIB)(crosrng.o) \
- $(LIB)(crosrng_f.o) \
- $(LIB)(crsfn2.o) \
- $(LIB)(crsm_2.o) \
- $(LIB)(crtest.o) \
- $(LIB)(csaxis.o) \
- $(LIB)(csclip.o) \
- $(LIB)(cscmtx.o) \
- $(LIB)(csdelt.o) \
- $(LIB)(csdlbn.o) \
- $(LIB)(csect.o) \
- $(LIB)(csget.o) \
- $(LIB)(csgtbn.o) \
- $(LIB)(csgttx.o) \
- $(LIB)(cslice.o) \
- $(LIB)(csotcd.o) \
- $(LIB)(cspstx.o) \
- $(LIB)(cspush.o) \
- $(LIB)(csrdct.o) \
- $(LIB)(csrecv.o) \
- $(LIB)(csscalt.o) \
- $(LIB)(cstrap.o) \
- $(LIB)(csvms.o) \
- $(LIB)(d.o) \
- $(LIB)(d3dplt.o) \
- $(LIB)(dchist.o) \
- $(LIB)(defo001.o) \
- $(LIB)(defo003.o) \
- $(LIB)(defocus.o) \
- $(LIB)(deletes.o) \
- $(LIB)(deletf.o) \
- $(LIB)(dendro.o) \
- $(LIB)(dendro2.o) \
- $(LIB)(denlst.o) \
- $(LIB)(denov.o) \
- $(LIB)(denref.o) \
- $(LIB)(deucl.o) \
- $(LIB)(dfft.o) \
- $(LIB)(dhide.o) \
- $(LIB)(diff1o.o) \
- $(LIB)(dirfft.o) \
- $(LIB)(dist2d.o) \
- $(LIB)(dist3.o) \
- $(LIB)(dist_p.o) \
- $(LIB)(distlst.o) \
- $(LIB)(disttst.o) \
- $(LIB)(docent1.o) \
- $(LIB)(docorr3_s.o) \
- $(LIB)(docors3_s.o) \
- $(LIB)(domax3_s.o) \
- $(LIB)(domin3_s.o) \
- $(LIB)(dprofd.o) \
- $(LIB)(dprofl.o) \
- $(LIB)(dread.o) \
- $(LIB)(drev.o) \
- $(LIB)(driv1.o) \
- $(LIB)(driv2.o) \
- $(LIB)(driv3.o) \
- $(LIB)(dsfs.o) \
- $(LIB)(dsfs_p.o) \
- $(LIB)(dumptosun.o) \
- $(LIB)(dwrit.o) \
- $(LIB)(edge.o) \
- $(LIB)(eff.o) \
- $(LIB)(ehist.o) \
- $(LIB)(emtitle.o) \
- $(LIB)(endit.o) \
- $(LIB)(ener.o) \
- $(LIB)(enfr_2.o) \
- $(LIB)(enhanc.o) \
- $(LIB)(envir.o) \
- $(LIB)(envelope.o) \
- $(LIB)(epur4.o) \
- $(LIB)(erc.o) \
- $(LIB)(errf2.o) \
- $(LIB)(erri2.o) \
- $(LIB)(error.o) \
- $(LIB)(errt.o) \
- $(LIB)(evalnq.o) \
- $(LIB)(expos.o) \
- $(LIB)(expressq.o) \
- $(LIB)(exprq.o) \
- $(LIB)(f3od_p.o) \
- $(LIB)(factor.o) \
- $(LIB)(falb.o) \
- $(LIB)(falb_p.o) \
- $(LIB)(fclear.o) \
- $(LIB)(fcm.o) \
- $(LIB)(fcmtst.o) \
- $(LIB)(fcnq.o) \
- $(LIB)(fermp.o) \
- $(LIB)(ffind.o) \
- $(LIB)(ffind3.o) \
- $(LIB)(fftc_d.o) \
- $(LIB)(fftc_q.o) \
- $(LIB)(fftcop.o) \
- $(LIB)(fftmcf.o) \
- $(LIB)(fftr2_p.o) \
- $(LIB)(fftr2_q.o) \
- $(LIB)(fftr3_p.o) \
- $(LIB)(fftr_d.o) \
- $(LIB)(fftr_q.o) \
- $(LIB)(fftrs_q.o) \
- $(LIB)(fh.o) \
- $(LIB)(fht.o) \
- $(LIB)(filcad.o) \
- $(LIB)(filcan.o) \
- $(LIB)(fildat.o) \
- $(LIB)(filerd.o) \
- $(LIB)(filgen.o) \
- $(LIB)(filget.o) \
- $(LIB)(filseq.o) \
- $(LIB)(filseqp.o) \
- $(LIB)(filt2_q.o) \
- $(LIB)(filt3_p.o) \
- $(LIB)(filtb.o) \
- $(LIB)(filtg.o) \
- $(LIB)(filtm.o) \
- $(LIB)(filtplot.o) \
- $(LIB)(findfrq.o) \
- $(LIB)(findlbq.o) \
- $(LIB)(findmx.o) \
- $(LIB)(findmx_f.o) \
- $(LIB)(fint.o) \
- $(LIB)(fixrl.o) \
- $(LIB)(flist.o) \
- $(LIB)(fmax_c.o) \
- $(LIB)(fmax_q.o) \
- $(LIB)(fmax_s.o) \
- $(LIB)(fmin_c.o) \
- $(LIB)(fmin_q.o) \
- $(LIB)(fmin_s.o) \
- $(LIB)(fmr_1.o) \
- $(LIB)(fmr_2.o) \
- $(LIB)(fnrm.o) \
- $(LIB)(four1.o) \
- $(LIB)(four2.o) \
- $(LIB)(fouring.o) \
- $(LIB)(fq3_p.o) \
- $(LIB)(fq_q.o) \
- $(LIB)(fq_qr.o) \
- $(LIB)(freadl.o) \
- $(LIB)(frng.o) \
- $(LIB)(fromtoq.o) \
- $(LIB)(fshado.o) \
- $(LIB)(fsort.o) \
- $(LIB)(fstack.o) \
- $(LIB)(fstadd.o) \
- $(LIB)(fstext.o) \
- $(LIB)(fstflg.o) \
- $(LIB)(fstfou.o) \
- $(LIB)(fstint.o) \
- $(LIB)(fstlbl.o) \
- $(LIB)(fstpck.o) \
- $(LIB)(fstput.o) \
- $(LIB)(fstred.o) \
- $(LIB)(fstref.o) \
- $(LIB)(fstsc1.o) \
- $(LIB)(ftmr.o) \
- $(LIB)(funiq.o) \
- $(LIB)(fwind.o) \
- $(LIB)(fwritl.o) \
- $(LIB)(gali.o) \
- $(LIB)(gali_p.o) \
- $(LIB)(gammln.o) \
- $(LIB)(gaussp.o) \
- $(LIB)(gdstrt.o) \
- $(LIB)(gee.o) \
- $(LIB)(genw.o) \
- $(LIB)(genw3d.o) \
- $(LIB)(genw3e.o) \
- $(LIB)(get3_p.o) \
- $(LIB)(get_p.o) \
- $(LIB)(getang.o) \
- $(LIB)(getcoo.o) \
- $(LIB)(getcoo2.o) \
- $(LIB)(getcoot.o) \
- $(LIB)(getdump.o) \
- $(LIB)(getf3.o) \
- $(LIB)(getima.o) \
- $(LIB)(getlab.o) \
- $(LIB)(getnum.o) \
- $(LIB)(getunx.o) \
- $(LIB)(getv16.o) \
- $(LIB)(getvax.o) \
- $(LIB)(gksm.o) \
- $(LIB)(gktest.o) \
- $(LIB)(gnc.o) \
- $(LIB)(gnc2s.o) \
- $(LIB)(gongon.o) \
- $(LIB)(gp.o) \
- $(LIB)(graph.o) \
- $(LIB)(grapho.o) \
- $(LIB)(graphp.o) \
- $(LIB)(graphs.o) \
- $(LIB)(grgrey.o) \
- $(LIB)(grvt125.o) \
- $(LIB)(gsc.o) \
- $(LIB)(gsmod.o) \
- $(LIB)(gsmodl.o) \
- $(LIB)(gsort.o) \
- $(LIB)(hclp.o) \
- $(LIB)(hcls.o) \
- $(LIB)(hdls.o) \
- $(LIB)(help_fileon.o) \
- $(LIB)(hels.o) \
- $(LIB)(hismap.o) \
- $(LIB)(hismap4.o) \
- $(LIB)(hist.o) \
- $(LIB)(histc.o) \
- $(LIB)(histe.o) \
- $(LIB)(hsort.o) \
- $(LIB)(i2byte.o) \
- $(LIB)(i4byte.o) \
- $(LIB)(ib4flip.o) \
- $(LIB)(ibflip.o) \
- $(LIB)(imseq4.o) \
- $(LIB)(inbs_p.o) \
- $(LIB)(incor2.o) \
- $(LIB)(incor3.o) \
- $(LIB)(inf3_p.o) \
- $(LIB)(inf_q.o) \
- $(LIB)(infd3_p.o) \
- $(LIB)(inilun.o) \
- $(LIB)(inilunb.o) \
- $(LIB)(iniluni.o) \
- $(LIB)(initunix.o) \
- $(LIB)(inproj.o) \
- $(LIB)(inq.o) \
- $(LIB)(int2bs.o) \
- $(LIB)(int2bsf.o) \
- $(LIB)(interl.o) \
- $(LIB)(interp.o) \
- $(LIB)(interp3.o) \
- $(LIB)(intfn2.o) \
- $(LIB)(invdet.o) \
- $(LIB)(invgdist.o) \
- $(LIB)(invphi.o) \
- $(LIB)(irp3.o) \
- $(LIB)(ischar.o) \
- $(LIB)(isdigi.o) \
- $(LIB)(itpow.o) \
- $(LIB)(jblock.o) \
- $(LIB)(jpmsk.o) \
- $(LIB)(jpmsk1.o) \
- $(LIB)(jpmsk2.o) \
- $(LIB)(kmeans.o) \
- $(LIB)(lastoccur.o) \
- $(LIB)(latcen.o) \
- $(LIB)(latice.o) \
- $(LIB)(lhist.o) \
- $(LIB)(listdc.o) \
- $(LIB)(listim.o) \
- $(LIB)(lkupdc.o) \
- $(LIB)(lnblnk.o) \
- $(LIB)(local.o) \
- $(LIB)(log2.o) \
- $(LIB)(log2_p.o) \
- $(LIB)(logifq.o) \
- $(LIB)(longer.o) \
- $(LIB)(lookup.o) \
- $(LIB)(lpeak.o) \
- $(LIB)(lsthl.o) \
- $(LIB)(m_j.o) \
- $(LIB)(macf.o) \
- $(LIB)(macf_p.o) \
- $(LIB)(makef3_p.o) \
- $(LIB)(makef_q.o) \
- $(LIB)(malfi3.o) \
- $(LIB)(mark.o) \
- $(LIB)(marker.o) \
- $(LIB)(markit.o) \
- $(LIB)(martha.o) \
- $(LIB)(mask.o) \
- $(LIB)(maskmu.o) \
- $(LIB)(maxf.o) \
- $(LIB)(mcircl.o) \
- $(LIB)(md2.o) \
- $(LIB)(md3.o) \
- $(LIB)(md3_p.o) \
- $(LIB)(median.o) \
- $(LIB)(menulu.o) \
- $(LIB)(mhelp.o) \
- $(LIB)(mhelp_read.o) \
- $(LIB)(mhelp_sub.o) \
- $(LIB)(mirbp3a.o) \
- $(LIB)(mircol.o) \
- $(LIB)(mirqbxs.o) \
- $(LIB)(mirror.o) \
- $(LIB)(mjc.o) \
- $(LIB)(mlc.o) \
- $(LIB)(mline.o) \
- $(LIB)(mls.o) \
- $(LIB)(model.o) \
- $(LIB)(model3.o) \
- $(LIB)(modelh.o) \
- $(LIB)(mont.o) \
- $(LIB)(movipc.o) \
- $(LIB)(mpoint.o) \
- $(LIB)(mr2to3d.o) \
- $(LIB)(mr_p.o) \
- $(LIB)(mralign.o) \
- $(LIB)(mrand.o) \
- $(LIB)(mrang2.o) \
- $(LIB)(mrcalerr.o) \
- $(LIB)(mrcenti.o) \
- $(LIB)(mrcg3.o) \
- $(LIB)(mrcg3d.o) \
- $(LIB)(mrcp.o) \
- $(LIB)(mrdev.o) \
- $(LIB)(mrdoc.o) \
- $(LIB)(mrdoccor.o) \
- $(LIB)(mread.o) \
- $(LIB)(mrectl.o) \
- $(LIB)(mreigen.o) \
- $(LIB)(mrerr.o) \
- $(LIB)(mrerror.o) \
- $(LIB)(mrfei2.o) \
- $(LIB)(mrgaus2.o) \
- $(LIB)(mrget3d.o) \
- $(LIB)(mrgetinfo.o) \
- $(LIB)(mrgnorm.o) \
- $(LIB)(mrk.o) \
- $(LIB)(mrk3.o) \
- $(LIB)(mrkur2.o) \
- $(LIB)(mrkur3.o) \
- $(LIB)(mrlineplot.o) \
- $(LIB)(mrmamule.o) \
- $(LIB)(mrmat2.o) \
- $(LIB)(mrncolor.o) \
- $(LIB)(mrnewangle.o) \
- $(LIB)(mrnlstrt.o) \
- $(LIB)(mrproj.o) \
- $(LIB)(mrprrep.o) \
- $(LIB)(mrputinfo.o) \
- $(LIB)(mrquater.o) \
- $(LIB)(mrrefl.o) \
- $(LIB)(mrreplace.o) \
- $(LIB)(mrrline.o) \
- $(LIB)(mrrotate.o) \
- $(LIB)(mrrsurf.o) \
- $(LIB)(mrscale.o) \
- $(LIB)(mrscale3.o) \
- $(LIB)(mrshift.o) \
- $(LIB)(mrsurf.o) \
- $(LIB)(mrtheta.o) \
- $(LIB)(mrvari.o) \
- $(LIB)(mskdec.o) \
- $(LIB)(msum.o) \
- $(LIB)(mtflid.o) \
- $(LIB)(mtlab.o) \
- $(LIB)(mtlaba.o) \
- $(LIB)(mtread.o) \
- $(LIB)(mtrian.o) \
- $(LIB)(mtset.o) \
- $(LIB)(mtwedg.o) \
- $(LIB)(mtwrt.o) \
- $(LIB)(mulf3.o) \
- $(LIB)(mulfi3.o) \
- $(LIB)(narea.o) \
- $(LIB)(newkmeans.o) \
- $(LIB)(nextversion.o) \
- $(LIB)(nfft.o) \
- $(LIB)(nfq.o) \
- $(LIB)(ngq.o) \
- $(LIB)(nlclusrd.o) \
- $(LIB)(nlmconv.o) \
- $(LIB)(nlmrealstrt.o) \
- $(LIB)(nltfile.o) \
- $(LIB)(noise.o) \
- $(LIB)(nonlmap.o) \
- $(LIB)(norm.o) \
- $(LIB)(norm3.o) \
- $(LIB)(normas.o) \
- $(LIB)(normm.o) \
- $(LIB)(noyau.o) \
- $(LIB)(nrq.o) \
- $(LIB)(numchari4.o) \
- $(LIB)(numdig.o) \
- $(LIB)(numenu.o) \
- $(LIB)(od.o) \
- $(LIB)(openf.o) \
- $(LIB)(openfb.o) \
- $(LIB)(openol.o) \
- $(LIB)(opfil.o) \
- $(LIB)(opnpc3.o) \
- $(LIB)(opnpic.o) \
- $(LIB)(opnpicp.o) \
- $(LIB)(oprint.o) \
- $(LIB)(opsf3_p.o) \
- $(LIB)(opsf_p.o) \
- $(LIB)(ordere.o) \
- $(LIB)(ormd.o) \
- $(LIB)(ormd_p.o) \
- $(LIB)(ornts.o) \
- $(LIB)(orpks.o) \
- $(LIB)(ouch.o) \
- $(LIB)(outfn2.o) \
- $(LIB)(outim.o) \
- $(LIB)(outpr.o) \
- $(LIB)(outrng.o) \
- $(LIB)(parab1.o) \
- $(LIB)(parabl.o) \
- $(LIB)(parst.o) \
- $(LIB)(patch.o) \
- $(LIB)(pca_coorx.o) \
- $(LIB)(pca_cproj.o) \
- $(LIB)(pca_gsmod.o) \
- $(LIB)(pca_gsmodl.o) \
- $(LIB)(pca_incor3.o) \
- $(LIB)(pca_itpow.o) \
- $(LIB)(pca_main.o) \
- $(LIB)(pca_recdum.o) \
- $(LIB)(pca_remake.o) \
- $(LIB)(pca_srip2.o) \
- $(LIB)(pca_sripe.o) \
- $(LIB)(pca_stocha.o) \
- $(LIB)(pcascoor.o) \
- $(LIB)(pcaxcoor.o) \
- $(LIB)(pcaxpose.o) \
- $(LIB)(pcaxprod.o) \
- $(LIB)(pcount.o) \
- $(LIB)(pdates.o) \
- $(LIB)(pdpvax.o) \
- $(LIB)(permut.o) \
- $(LIB)(phaorg.o) \
- $(LIB)(picksl.o) \
- $(LIB)(picksv.o) \
- $(LIB)(piraddeg.o) \
- $(LIB)(pj3q.o) \
- $(LIB)(pksr3.o) \
- $(LIB)(plnedg.o) \
- $(LIB)(plot1.o) \
- $(LIB)(plot2.o) \
- $(LIB)(pocs.o) \
- $(LIB)(poem.o) \
- $(LIB)(polcbs.o) \
- $(LIB)(polfit.o) \
- $(LIB)(pollsq.o) \
- $(LIB)(postrt.o) \
- $(LIB)(pr3d.o) \
- $(LIB)(pr3db.o) \
- $(LIB)(pra.o) \
- $(LIB)(prb1d.o) \
- $(LIB)(prepcub_q.o) \
- $(LIB)(prepcub_s.o) \
- $(LIB)(prepsl_2.o) \
- $(LIB)(prepsl_s.o) \
- $(LIB)(previo.o) \
- $(LIB)(prjc0.o) \
- $(LIB)(prjc2.o) \
- $(LIB)(prjcq.o) \
- $(LIB)(prjs2.o) \
- $(LIB)(prntxx.o) \
- $(LIB)(prober.o) \
- $(LIB)(proj3.o) \
- $(LIB)(proj3e.o) \
- $(LIB)(prp_q.o) \
- $(LIB)(ps2ic.o) \
- $(LIB)(ps_ic_2d.o) \
- $(LIB)(ps_ic_3d.o) \
- $(LIB)(ps_od_3d.o) \
- $(LIB)(psicmr.o) \
- $(LIB)(psqod_2d.o) \
- $(LIB)(psr_p.o) \
- $(LIB)(pttern.o) \
- $(LIB)(put3_p.o) \
- $(LIB)(put_p.o) \
- $(LIB)(putf3.o) \
- $(LIB)(putpt.o) \
- $(LIB)(putpt2.o) \
- $(LIB)(qali.o) \
- $(LIB)(qali_p.o) \
- $(LIB)(qfact.o) \
- $(LIB)(qfact_p.o) \
- $(LIB)(qnr.o) \
- $(LIB)(qnrf.o) \
- $(LIB)(qstat.o) \
- $(LIB)(quadri.o) \
- $(LIB)(radav.o) \
- $(LIB)(radavi.o) \
- $(LIB)(ramp.o) \
- $(LIB)(ramp_p.o) \
- $(LIB)(ran.o) \
- $(LIB)(rand_p.o) \
- $(LIB)(random.o) \
- $(LIB)(rann.o) \
- $(LIB)(rathin.o) \
- $(LIB)(rawtospider.o) \
- $(LIB)(rcaver.o) \
- $(LIB)(rccang.o) \
- $(LIB)(rclu.o) \
- $(LIB)(rcnv2_p.o) \
- $(LIB)(rcnv3_p.o) \
- $(LIB)(rcon3e.o) \
- $(LIB)(rconv.o) \
- $(LIB)(rcvi.o) \
- $(LIB)(rdclus.o) \
- $(LIB)(rddoca2q.o) \
- $(LIB)(rddocq.o) \
- $(LIB)(rdf_q.o) \
- $(LIB)(rdfc.o) \
- $(LIB)(rdpa.o) \
- $(LIB)(rdpraf.o) \
- $(LIB)(rdprai.o) \
- $(LIB)(rdprf2.o) \
- $(LIB)(rdpric.o) \
- $(LIB)(rdpris.o) \
- $(LIB)(rdprm.o) \
- $(LIB)(rdprm2.o) \
- $(LIB)(rdprm2s.o) \
- $(LIB)(rdprmc.o) \
- $(LIB)(rdprmi.o) \
- $(LIB)(rdprmt.o) \
- $(LIB)(rdsl_p.o) \
- $(LIB)(readch.o) \
- $(LIB)(readf3.o) \
- $(LIB)(readpq.o) \
- $(LIB)(readrq.o) \
- $(LIB)(reads.o) \
- $(LIB)(readt.o) \
- $(LIB)(reatab.o) \
- $(LIB)(recdum.o) \
- $(LIB)(recons.o) \
- $(LIB)(redlin.o) \
- $(LIB)(redlin8.o) \
- $(LIB)(redpro2.o) \
- $(LIB)(redprq.o) \
- $(LIB)(reduc1.o) \
- $(LIB)(reduce.o) \
- $(LIB)(reform.o) \
- $(LIB)(reform0.o) \
- $(LIB)(remez.o) \
- $(LIB)(remezp.o) \
- $(LIB)(repr2_s.o) \
- $(LIB)(repr3_q.o) \
- $(LIB)(reprwb.o) \
- $(LIB)(reps.o) \
- $(LIB)(retir.o) \
- $(LIB)(rew.o) \
- $(LIB)(rfact.o) \
- $(LIB)(rfactsdo.o) \
- $(LIB)(rfft.o) \
- $(LIB)(rgri.o) \
- $(LIB)(rhist.o) \
- $(LIB)(rhobck.o) \
- $(LIB)(rmz_p.o) \
- $(LIB)(ro2test.o) \
- $(LIB)(rot.o) \
- $(LIB)(rot2bs.o) \
- $(LIB)(rot2qs.o) \
- $(LIB)(rot3.o) \
- $(LIB)(rot32.o) \
- $(LIB)(rot3_p.o) \
- $(LIB)(rot3co.o) \
- $(LIB)(rot_p.o) \
- $(LIB)(rotas3.o) \
- $(LIB)(rotbs.o) \
- $(LIB)(rotflt_bg.o) \
- $(LIB)(rotflt_fb.o) \
- $(LIB)(rotflt_filbes.o) \
- $(LIB)(rotflt_info.o) \
- $(LIB)(rotflt_lg.o) \
- $(LIB)(rotflt_lgout.o) \
- $(LIB)(rotflt_origin.o) \
- $(LIB)(rotflt_powspec.o) \
- $(LIB)(rotqs.o) \
- $(LIB)(rots3.o) \
- $(LIB)(roub2.o) \
- $(LIB)(rout.o) \
- $(LIB)(rprq.o) \
- $(LIB)(rtbs.o) \
- $(LIB)(rtq.o) \
- $(LIB)(rtqs.o) \
- $(LIB)(rwf3.o) \
- $(LIB)(saqb.o) \
- $(LIB)(saqb_f.o) \
- $(LIB)(saqb_p.o) \
- $(LIB)(savd.o) \
- $(LIB)(savdn1.o) \
- $(LIB)(savdocq.o) \
- $(LIB)(sclasf.o) \
- $(LIB)(sclassi.o) \
- $(LIB)(sclassy.o) \
- $(LIB)(scoran2.o) \
- $(LIB)(scoran3.o) \
- $(LIB)(sder.o) \
- $(LIB)(searchq.o) \
- $(LIB)(secnds.o) \
- $(LIB)(seigen.o) \
- $(LIB)(semis.o) \
- $(LIB)(sen.o) \
- $(LIB)(sen3a.o) \
- $(LIB)(setlab.o) \
- $(LIB)(setmode.o) \
- $(LIB)(setprm.o) \
- $(LIB)(setval.o) \
- $(LIB)(sfft.o) \
- $(LIB)(sgraf.o) \
- $(LIB)(sgraf1.o) \
- $(LIB)(sh180_2.o) \
- $(LIB)(shelk.o) \
- $(LIB)(shfc_2.o) \
- $(LIB)(shfi_2.o) \
- $(LIB)(shfm_2.o) \
- $(LIB)(shif3f.o) \
- $(LIB)(shift1.o) \
- $(LIB)(shift2.o) \
- $(LIB)(shift3.o) \
- $(LIB)(shift_3d.o) \
- $(LIB)(shift_pf.o) \
- $(LIB)(shiftr.o) \
- $(LIB)(shiftt.o) \
- $(LIB)(showmen.o) \
- $(LIB)(shr.o) \
- $(LIB)(shrinkq.o) \
- $(LIB)(single.o) \
- $(LIB)(sixout.o) \
- $(LIB)(slice.o) \
- $(LIB)(smt3.o) \
- $(LIB)(smt3_q.o) \
- $(LIB)(solv2d.o) \
- $(LIB)(solve.o) \
- $(LIB)(sort.o) \
- $(LIB)(sortdoc.o) \
- $(LIB)(sortint.o) \
- $(LIB)(sortz.o) \
- $(LIB)(sortz4.o) \
- $(LIB)(speak.o) \
- $(LIB)(speak3.o) \
- $(LIB)(speak3d.o) \
- $(LIB)(speakc.o) \
- $(LIB)(spool.o) \
- $(LIB)(spotwt.o) \
- $(LIB)(spout.o) \
- $(LIB)(squeez.o) \
- $(LIB)(srip2.o) \
- $(LIB)(sripe.o) \
- $(LIB)(sscla.o) \
- $(LIB)(ssdisp.o) \
- $(LIB)(ssfile.o) \
- $(LIB)(sslowcas.o) \
- $(LIB)(ssnr.o) \
- $(LIB)(ssnrb.o) \
- $(LIB)(ssnrms.o) \
- $(LIB)(ssopn.o) \
- $(LIB)(ssparm.o) \
- $(LIB)(ssplat.o) \
- $(LIB)(sspush.o) \
- $(LIB)(ssrdct.o) \
- $(LIB)(sstogl.o) \
- $(LIB)(sstrap.o) \
- $(LIB)(ssupcas.o) \
- $(LIB)(stabk.o) \
- $(LIB)(stack.o) \
- $(LIB)(stocha.o) \
- $(LIB)(strtdis.o) \
- $(LIB)(subaf.o) \
- $(LIB)(subkmeans.o) \
- $(LIB)(subkmns.o) \
- $(LIB)(sumali.o) \
- $(LIB)(sumap.o) \
- $(LIB)(tape1.o) \
- $(LIB)(tape8.o) \
- $(LIB)(tcnp.o) \
- $(LIB)(tdfrepl.o) \
- $(LIB)(tdlocal.o) \
- $(LIB)(tf.o) \
- $(LIB)(tfd.o) \
- $(LIB)(thresh.o) \
- $(LIB)(tilt.o) \
- $(LIB)(tiltang.o) \
- $(LIB)(tiltfd.o) \
- $(LIB)(title.o) \
- $(LIB)(tkstrt.o) \
- $(LIB)(tmstrt.o) \
- $(LIB)(totrec.o) \
- $(LIB)(tpeof.o) \
- $(LIB)(tperr.o) \
- $(LIB)(tpfile.o) \
- $(LIB)(tpinit.o) \
- $(LIB)(tpmidf.o) \
- $(LIB)(tprec.o) \
- $(LIB)(tpskp.o) \
- $(LIB)(tpwrt.o) \
- $(LIB)(traf.o) \
- $(LIB)(trafc.o) \
- $(LIB)(trafc3.o) \
- $(LIB)(trafd.o) \
- $(LIB)(trans3d.o) \
- $(LIB)(transpose.o) \
- $(LIB)(tridi.o) \
- $(LIB)(trinter.o) \
- $(LIB)(tswitch.o) \
- $(LIB)(ttest.o) \
- $(LIB)(tvwn1.o) \
- $(LIB)(tvwn3.o) \
- $(LIB)(unix32.o) \
- $(LIB)(unixtounix8.o) \
- $(LIB)(unixtovv.o) \
- $(LIB)(unsav.o) \
- $(LIB)(unsdal.o) \
- $(LIB)(unsdal2.o) \
- $(LIB)(updf.o) \
- $(LIB)(updtc.o) \
- $(LIB)(updtf.o) \
- $(LIB)(uqu.o) \
- $(LIB)(util1.o) \
- $(LIB)(util2.o) \
- $(LIB)(util3.o) \
- $(LIB)(util4.o) \
- $(LIB)(vax32.o) \
- $(LIB)(vax32u.o) \
- $(LIB)(vaxiobyte.o) \
- $(LIB)(vaxtounix.o) \
- $(LIB)(vectop.o) \
- $(LIB)(version.o) \
- $(LIB)(vismap.o) \
- $(LIB)(vms.o) \
- $(LIB)(voea.o) \
- $(LIB)(vomd.o) \
- $(LIB)(vora.o) \
- $(LIB)(vota.o) \
- $(LIB)(vprop.o) \
- $(LIB)(vtil2.o) \
- $(LIB)(vtil3.o) \
- $(LIB)(waits.o) \
- $(LIB)(wate.o) \
- $(LIB)(weifu.o) \
- $(LIB)(weifu3.o) \
- $(LIB)(weightc.o) \
- $(LIB)(weightf.o) \
- $(LIB)(wftcirc.o) \
- $(LIB)(wgbp2.o) \
- $(LIB)(whist.o) \
- $(LIB)(winave.o) \
- $(LIB)(winave2.o) \
- $(LIB)(window.o) \
- $(LIB)(winkel5.o) \
- $(LIB)(winkelt.o) \
- $(LIB)(wpro.o) \
- $(LIB)(wrars.o) \
- $(LIB)(writpro.o) \
- $(LIB)(writs.o) \
- $(LIB)(writt.o) \
- $(LIB)(wrsl_p.o) \
- $(LIB)(wrtarray.o) \
- $(LIB)(wrtlin.o) \
- $(LIB)(wrtlin8.o) \
- $(LIB)(x1yr.o) \
- $(LIB)(xyout.o) \
- $(LIB)(ycc.o) \
-enditdum
- 
-d23 1
-a23 1
-	f77 $(PGM).o $(LIB) -o ../bin/$(PGM)_temp
-a24 1
-	\mv ../bin/$(PGM)_temp $@@
-a29 3
-  
-enditdum : 
-  
-@
diff --git src/Makefile_samples/RCS/Makefile.inc,v src/Makefile_samples/RCS/Makefile.inc,v
deleted file mode 100644
index 8f86a64b..00000000
--- src/Makefile_samples/RCS/Makefile.inc,v
+++ /dev/null
@@ -1,3642 +0,0 @@
-head	1.141;
-access;
-symbols
-	pre_fftwrings:1.28
-	pre_opfiles:1.23
-	src:1.23
-	best-code:1.18
-	x-named-regs:1.11
-	x:1.11
-	v13-00:1.11
-	pre_GPL:1.8;
-locks; strict;
-comment	@# @;
-
-
-1.141
-date	2013.02.19.15.14.01;	author leith;	state Exp;
-branches;
-next	1.140;
-
-1.140
-date	2013.01.29.14.29.59;	author leith;	state Exp;
-branches;
-next	1.139;
-
-1.139
-date	2013.01.07.17.42.36;	author leith;	state Exp;
-branches;
-next	1.138;
-
-1.138
-date	2013.01.04.15.40.37;	author leith;	state Exp;
-branches;
-next	1.137;
-
-1.137
-date	2012.12.07.14.51.28;	author leith;	state Exp;
-branches;
-next	1.136;
-
-1.136
-date	2012.10.10.12.03.28;	author leith;	state Exp;
-branches;
-next	1.135;
-
-1.135
-date	2012.10.02.18.36.32;	author leith;	state Exp;
-branches;
-next	1.134;
-
-1.134
-date	2012.09.28.13.31.00;	author leith;	state Exp;
-branches;
-next	1.133;
-
-1.133
-date	2012.09.26.20.02.21;	author leith;	state Exp;
-branches;
-next	1.132;
-
-1.132
-date	2012.06.13.14.19.13;	author leith;	state Exp;
-branches;
-next	1.131;
-
-1.131
-date	2012.06.11.13.21.58;	author leith;	state Exp;
-branches;
-next	1.130;
-
-1.130
-date	2012.05.11.18.09.16;	author leith;	state Exp;
-branches;
-next	1.129;
-
-1.129
-date	2012.05.02.12.58.14;	author leith;	state Exp;
-branches;
-next	1.128;
-
-1.128
-date	2012.04.10.19.29.31;	author leith;	state Exp;
-branches;
-next	1.127;
-
-1.127
-date	2012.04.09.16.02.55;	author leith;	state Exp;
-branches;
-next	1.126;
-
-1.126
-date	2012.03.29.14.31.09;	author leith;	state Exp;
-branches;
-next	1.125;
-
-1.125
-date	2012.03.27.17.58.50;	author leith;	state Exp;
-branches;
-next	1.124;
-
-1.124
-date	2012.03.27.14.46.19;	author leith;	state Exp;
-branches;
-next	1.123;
-
-1.123
-date	2012.03.23.13.22.16;	author leith;	state Exp;
-branches;
-next	1.122;
-
-1.122
-date	2012.03.23.13.21.25;	author leith;	state Exp;
-branches;
-next	1.121;
-
-1.121
-date	2012.03.21.13.36.54;	author leith;	state Exp;
-branches;
-next	1.120;
-
-1.120
-date	2012.03.14.14.47.10;	author leith;	state Exp;
-branches;
-next	1.119;
-
-1.119
-date	2012.02.15.16.16.19;	author leith;	state Exp;
-branches;
-next	1.118;
-
-1.118
-date	2012.02.13.14.10.28;	author leith;	state Exp;
-branches;
-next	1.117;
-
-1.117
-date	2012.01.23.15.16.28;	author leith;	state Exp;
-branches;
-next	1.116;
-
-1.116
-date	2012.01.23.14.16.37;	author leith;	state Exp;
-branches;
-next	1.115;
-
-1.115
-date	2012.01.11.14.55.34;	author leith;	state Exp;
-branches;
-next	1.114;
-
-1.114
-date	2012.01.03.13.55.11;	author leith;	state Exp;
-branches;
-next	1.113;
-
-1.113
-date	2011.12.29.18.48.39;	author leith;	state Exp;
-branches;
-next	1.112;
-
-1.112
-date	2011.12.20.16.27.57;	author leith;	state Exp;
-branches;
-next	1.111;
-
-1.111
-date	2011.12.12.19.24.27;	author leith;	state Exp;
-branches;
-next	1.110;
-
-1.110
-date	2011.12.09.13.06.31;	author leith;	state Exp;
-branches;
-next	1.109;
-
-1.109
-date	2011.12.08.20.09.45;	author leith;	state Exp;
-branches;
-next	1.108;
-
-1.108
-date	2011.12.06.17.18.34;	author leith;	state Exp;
-branches;
-next	1.107;
-
-1.107
-date	2011.12.02.14.40.27;	author leith;	state Exp;
-branches;
-next	1.106;
-
-1.106
-date	2011.12.01.20.29.00;	author leith;	state Exp;
-branches;
-next	1.105;
-
-1.105
-date	2011.12.01.20.27.01;	author leith;	state Exp;
-branches;
-next	1.104;
-
-1.104
-date	2011.11.30.13.12.21;	author leith;	state Exp;
-branches;
-next	1.103;
-
-1.103
-date	2011.11.08.16.16.40;	author leith;	state Exp;
-branches;
-next	1.102;
-
-1.102
-date	2011.11.08.15.51.07;	author leith;	state Exp;
-branches;
-next	1.101;
-
-1.101
-date	2011.11.07.18.32.05;	author leith;	state Exp;
-branches;
-next	1.100;
-
-1.100
-date	2011.11.01.18.12.25;	author leith;	state Exp;
-branches;
-next	1.99;
-
-1.99
-date	2011.10.14.13.44.49;	author leith;	state Exp;
-branches;
-next	1.98;
-
-1.98
-date	2011.10.06.16.05.38;	author leith;	state Exp;
-branches;
-next	1.97;
-
-1.97
-date	2011.10.05.16.27.35;	author leith;	state Exp;
-branches;
-next	1.96;
-
-1.96
-date	2011.10.05.11.52.46;	author leith;	state Exp;
-branches;
-next	1.95;
-
-1.95
-date	2011.09.28.16.26.10;	author leith;	state Exp;
-branches;
-next	1.94;
-
-1.94
-date	2011.09.12.18.05.01;	author leith;	state Exp;
-branches;
-next	1.93;
-
-1.93
-date	2011.09.08.14.58.18;	author leith;	state Exp;
-branches;
-next	1.92;
-
-1.92
-date	2011.08.31.19.19.12;	author leith;	state Exp;
-branches;
-next	1.91;
-
-1.91
-date	2011.08.29.17.58.42;	author leith;	state Exp;
-branches;
-next	1.90;
-
-1.90
-date	2011.07.29.14.41.50;	author leith;	state Exp;
-branches;
-next	1.89;
-
-1.89
-date	2011.07.26.17.13.50;	author leith;	state Exp;
-branches;
-next	1.88;
-
-1.88
-date	2011.07.25.16.05.30;	author leith;	state Exp;
-branches;
-next	1.87;
-
-1.87
-date	2011.06.16.16.22.38;	author leith;	state Exp;
-branches;
-next	1.86;
-
-1.86
-date	2011.06.10.16.39.00;	author leith;	state Exp;
-branches;
-next	1.85;
-
-1.85
-date	2011.06.02.15.33.29;	author leith;	state Exp;
-branches;
-next	1.84;
-
-1.84
-date	2011.05.24.17.30.42;	author leith;	state Exp;
-branches;
-next	1.83;
-
-1.83
-date	2011.05.16.17.52.15;	author leith;	state Exp;
-branches;
-next	1.82;
-
-1.82
-date	2011.05.16.14.57.54;	author leith;	state Exp;
-branches;
-next	1.81;
-
-1.81
-date	2011.05.16.14.48.56;	author leith;	state Exp;
-branches;
-next	1.80;
-
-1.80
-date	2011.05.16.14.45.38;	author leith;	state Exp;
-branches;
-next	1.79;
-
-1.79
-date	2011.03.03.13.15.54;	author leith;	state Exp;
-branches;
-next	1.78;
-
-1.78
-date	2011.02.17.14.24.32;	author leith;	state Exp;
-branches;
-next	1.77;
-
-1.77
-date	2011.02.17.13.27.14;	author leith;	state Exp;
-branches;
-next	1.76;
-
-1.76
-date	2011.02.17.12.49.33;	author leith;	state Exp;
-branches;
-next	1.75;
-
-1.75
-date	2011.02.16.20.29.31;	author leith;	state Exp;
-branches;
-next	1.74;
-
-1.74
-date	2011.02.09.13.43.10;	author leith;	state Exp;
-branches;
-next	1.73;
-
-1.73
-date	2011.01.25.13.40.30;	author leith;	state Exp;
-branches;
-next	1.72;
-
-1.72
-date	2011.01.25.13.35.48;	author leith;	state Exp;
-branches;
-next	1.71;
-
-1.71
-date	2011.01.25.13.16.43;	author leith;	state Exp;
-branches;
-next	1.70;
-
-1.70
-date	2011.01.21.16.26.10;	author leith;	state Exp;
-branches;
-next	1.69;
-
-1.69
-date	2011.01.13.20.05.58;	author leith;	state Exp;
-branches;
-next	1.68;
-
-1.68
-date	2011.01.12.18.46.18;	author leith;	state Exp;
-branches;
-next	1.67;
-
-1.67
-date	2011.01.12.18.32.46;	author leith;	state Exp;
-branches;
-next	1.66;
-
-1.66
-date	2011.01.10.16.30.26;	author leith;	state Exp;
-branches;
-next	1.65;
-
-1.65
-date	2011.01.03.17.04.20;	author leith;	state Exp;
-branches;
-next	1.64;
-
-1.64
-date	2011.01.03.14.29.56;	author leith;	state Exp;
-branches;
-next	1.63;
-
-1.63
-date	2010.12.23.14.25.41;	author leith;	state Exp;
-branches;
-next	1.62;
-
-1.62
-date	2010.12.21.16.18.22;	author leith;	state Exp;
-branches;
-next	1.61;
-
-1.61
-date	2010.11.29.18.43.53;	author leith;	state Exp;
-branches;
-next	1.60;
-
-1.60
-date	2010.11.24.17.30.28;	author leith;	state Exp;
-branches;
-next	1.59;
-
-1.59
-date	2010.11.12.14.33.41;	author leith;	state Exp;
-branches;
-next	1.58;
-
-1.58
-date	2010.11.03.18.38.17;	author leith;	state Exp;
-branches;
-next	1.57;
-
-1.57
-date	2010.11.03.17.05.02;	author leith;	state Exp;
-branches;
-next	1.56;
-
-1.56
-date	2010.10.27.12.41.25;	author leith;	state Exp;
-branches;
-next	1.55;
-
-1.55
-date	2010.10.21.20.05.13;	author leith;	state Exp;
-branches;
-next	1.54;
-
-1.54
-date	2010.10.13.14.51.18;	author leith;	state Exp;
-branches;
-next	1.53;
-
-1.53
-date	2010.10.13.14.36.57;	author leith;	state Exp;
-branches;
-next	1.52;
-
-1.52
-date	2010.10.13.14.27.56;	author leith;	state Exp;
-branches;
-next	1.51;
-
-1.51
-date	2010.07.23.17.47.55;	author leith;	state Exp;
-branches;
-next	1.50;
-
-1.50
-date	2010.07.14.14.53.41;	author leith;	state Exp;
-branches;
-next	1.49;
-
-1.49
-date	2010.07.14.14.20.10;	author leith;	state Exp;
-branches;
-next	1.48;
-
-1.48
-date	2010.07.01.15.20.25;	author leith;	state Exp;
-branches;
-next	1.47;
-
-1.47
-date	2010.07.01.14.25.36;	author leith;	state Exp;
-branches;
-next	1.46;
-
-1.46
-date	2010.06.29.18.42.30;	author leith;	state Exp;
-branches;
-next	1.45;
-
-1.45
-date	2010.06.24.19.11.31;	author leith;	state Exp;
-branches;
-next	1.44;
-
-1.44
-date	2009.08.18.15.01.01;	author leith;	state Exp;
-branches;
-next	1.43;
-
-1.43
-date	2009.06.11.12.36.24;	author leith;	state Exp;
-branches;
-next	1.42;
-
-1.42
-date	2009.05.27.11.53.10;	author leith;	state Exp;
-branches;
-next	1.41;
-
-1.41
-date	2009.05.26.13.51.50;	author leith;	state Exp;
-branches;
-next	1.40;
-
-1.40
-date	2009.05.22.13.52.33;	author leith;	state Exp;
-branches;
-next	1.39;
-
-1.39
-date	2009.05.15.14.13.57;	author leith;	state Exp;
-branches;
-next	1.38;
-
-1.38
-date	2009.05.13.16.18.36;	author leith;	state Exp;
-branches;
-next	1.37;
-
-1.37
-date	2009.04.27.13.36.06;	author leith;	state Exp;
-branches;
-next	1.36;
-
-1.36
-date	2009.03.23.14.42.28;	author leith;	state Exp;
-branches;
-next	1.35;
-
-1.35
-date	2009.01.23.18.05.35;	author leith;	state Exp;
-branches;
-next	1.34;
-
-1.34
-date	2008.11.25.17.51.24;	author leith;	state Exp;
-branches;
-next	1.33;
-
-1.33
-date	2008.10.20.12.59.12;	author leith;	state Exp;
-branches;
-next	1.32;
-
-1.32
-date	2008.10.17.12.24.31;	author leith;	state Exp;
-branches;
-next	1.31;
-
-1.31
-date	2008.10.17.11.54.46;	author leith;	state Exp;
-branches;
-next	1.30;
-
-1.30
-date	2008.08.06.17.19.04;	author leith;	state Exp;
-branches;
-next	1.29;
-
-1.29
-date	2008.05.05.14.42.59;	author leith;	state Exp;
-branches;
-next	1.28;
-
-1.28
-date	2008.02.25.15.57.47;	author leith;	state Exp;
-branches;
-next	1.27;
-
-1.27
-date	2008.02.19.17.13.29;	author leith;	state Exp;
-branches;
-next	1.26;
-
-1.26
-date	2008.01.24.15.58.18;	author leith;	state Exp;
-branches;
-next	1.25;
-
-1.25
-date	2007.12.12.15.24.12;	author leith;	state Exp;
-branches;
-next	1.24;
-
-1.24
-date	2007.03.29.14.39.14;	author leith;	state Exp;
-branches;
-next	1.23;
-
-1.23
-date	2007.01.11.17.51.34;	author leith;	state Exp;
-branches;
-next	1.22;
-
-1.22
-date	2006.12.18.18.56.15;	author leith;	state Exp;
-branches;
-next	1.21;
-
-1.21
-date	2006.10.11.15.12.25;	author leith;	state Exp;
-branches;
-next	1.20;
-
-1.20
-date	2006.10.02.19.34.43;	author leith;	state Exp;
-branches;
-next	1.19;
-
-1.19
-date	2006.03.28.21.57.55;	author pawel;	state Exp;
-branches;
-next	1.18;
-
-1.18
-date	2006.03.07.19.54.46;	author leith;	state Exp;
-branches;
-next	1.17;
-
-1.17
-date	2006.01.09.20.56.58;	author leith;	state Exp;
-branches;
-next	1.16;
-
-1.16
-date	2005.12.19.18.14.59;	author leith;	state Exp;
-branches;
-next	1.15;
-
-1.15
-date	2005.12.19.15.39.07;	author leith;	state Exp;
-branches;
-next	1.14;
-
-1.14
-date	2005.12.14.16.35.53;	author leith;	state Exp;
-branches;
-next	1.13;
-
-1.13
-date	2005.12.14.16.20.02;	author leith;	state Exp;
-branches;
-next	1.12;
-
-1.12
-date	2005.12.12.16.02.24;	author leith;	state Exp;
-branches;
-next	1.11;
-
-1.11
-date	2005.11.09.17.13.06;	author bimal;	state Exp;
-branches;
-next	1.10;
-
-1.10
-date	2005.11.07.21.29.40;	author bimal;	state Exp;
-branches;
-next	1.9;
-
-1.9
-date	2005.10.18.21.06.01;	author leith;	state Exp;
-branches;
-next	1.8;
-
-1.8
-date	2005.10.03.19.34.57;	author leith;	state Exp;
-branches;
-next	1.7;
-
-1.7
-date	2005.08.26.16.00.44;	author leith;	state Exp;
-branches;
-next	1.6;
-
-1.6
-date	2005.08.26.15.34.33;	author leith;	state Exp;
-branches;
-next	1.5;
-
-1.5
-date	2005.08.24.19.43.21;	author leith;	state dead;
-branches;
-next	1.4;
-
-1.4
-date	2005.06.28.15.42.02;	author leith;	state Exp;
-branches;
-next	1.3;
-
-1.3
-date	2005.06.23.19.51.16;	author leith;	state Exp;
-branches;
-next	1.2;
-
-1.2
-date	2004.12.14.17.39.25;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	2004.11.04.15.48.39;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.141
-log
-@sphdecon
-@
-text
-@# 
-# ------ Lists SPIDER source files for use by Makefile  ------
-#        This is the definitive source listing for source files
-#        compiled into SPIDER. Additional objects are also found
-#        within the corresponding source files.
- 
-ELEMENTS =  \
- $(LIB)(spider.o)    \
- $(LIB)(openinln.o)  \
- $(LIB)(lunsethdr.o) \
- $(LIB)(fftw3.o)     \
- $(LIB)(lundoc.o)    \
- $(LIB)(apsh_tool.o) \
- $(LIB)(acrs_2.o)    \
- $(LIB)(acrs_2s.o)   \
- $(LIB)(acrs_3.o)    \
- $(LIB)(acrs_3s.o)   \
- $(LIB)(add.o)   \
- $(LIB)(ads.o)   \
- $(LIB)(addfac.o)\
- $(LIB)(adds.o)  \
- $(LIB)(adds_n.o)\
- $(LIB)(af.o)    \
- $(LIB)(afs.o)   \
- $(LIB)(akima.o) \
- $(LIB)(al10.o)  \
- $(LIB)(alphaint.o) \
- $(LIB)(alprbs.o)   \
- $(LIB)(alprbs_q.o) \
- $(LIB)(alrosf_q.o) \
- $(LIB)(alrosi_q.o) \
- $(LIB)(alrq.o)     \
- $(LIB)(alrqs.o)    \
- $(LIB)(alrq_m.o)   \
- $(LIB)(alrq_ms_quad.o) \
- $(LIB)(alrq_ms_fbs.o)  \
- $(LIB)(alrq_q.o) \
- $(LIB)(amoeba.o) \
- $(LIB)(ang.o)    \
- $(LIB)(ang_n.o)  \
- $(LIB)(angmor.o) \
- $(LIB)(aniso.o)  \
- $(LIB)(anisoe.o) \
- $(LIB)(anisof.o) \
- $(LIB)(anisof3.o)\
- $(LIB)(apcc.o)   \
- $(LIB)(apscc.o)  \
- $(LIB)(apshift.o)\
- $(LIB)(apshift_fou.o)\
- $(LIB)(ap_end.o)     \
- $(LIB)(apfou_patm.o) \
- $(LIB)(ap_getangas.o)\
- $(LIB)(ap_getdata.o) \
- $(LIB)(apref_p.o)    \
- $(LIB)(apref_pm.o)   \
- $(LIB)(apsh_cuda.o)  \
- $(LIB)(apsh_psc.o)   \
- $(LIB)(apsh_ps.o)    \
- $(LIB)(apsh_ss.o)    \
- $(LIB)(ap_stat.o)    \
- $(LIB)(apmaster.o)   \
- $(LIB)(apmaster_1.o) \
- $(LIB)(apmaster_tool.o)\
- $(LIB)(aprings.o)      \
- $(LIB)(aprings_patm.o) \
- $(LIB)(aprings_coef.o) \
- $(LIB)(aprings_trans.o)\
- $(LIB)(applyw.o)  \
- $(LIB)(applyws.o) \
- $(LIB)(arasq.o)   \
- $(LIB)(arith.o)   \
- $(LIB)(arithl.o)  \
- $(LIB)(arithsca.o)\
- $(LIB)(asta.o)    \
- $(LIB)(astcyl.o)  \
- $(LIB)(atit2.o)   \
- $(LIB)(atmc.o)  \
- $(LIB)(atpk.o)  \
- $(LIB)(atsa.o)  \
- $(LIB)(atwn.o)  \
- $(LIB)(averg.o) \
- $(LIB)(averg3.o)\
- $(LIB)(bckc0.o) \
- $(LIB)(bckc2.o) \
- $(LIB)(bckpj.o) \
- $(LIB)(bcq.o)   \
- $(LIB)(besi0.o) \
- $(LIB)(besi1.o) \
- $(LIB)(betai.o) \
- $(LIB)(bfact.o) \
- $(LIB)(bigalloc.o) \
- $(LIB)(bigended.o) \
- $(LIB)(blank.o)  \
- $(LIB)(bldr.o)   \
- $(LIB)(blob.o)   \
- $(LIB)(blob_q.o) \
- $(LIB)(bmax_c.o) \
- $(LIB)(bmax_s.o) \
- $(LIB)(bmin_c.o) \
- $(LIB)(bmin_s.o) \
- $(LIB)(borns.o)  \
- $(LIB)(boxx.o)   \
- $(LIB)(bpcm.o)   \
- $(LIB)(bpcmp.o)  \
- $(LIB)(bpcq.o)   \
- $(LIB)(bpcqp.o)  \
- $(LIB)(bprp.o)   \
- $(LIB)(bprp3.o)   \
- $(LIB)(bprj2.o)  \
- $(LIB)(bps2.o)   \
- $(LIB)(bpwr.o)   \
- $(LIB)(bpwr_q.o) \
- $(LIB)(builds.o) \
- $(LIB)(buildm.o) \
- $(LIB)(buterp.o) \
- $(LIB)(calc.o)   \
- $(LIB)(cald.o)   \
- $(LIB)(call3drminvn.o) \
- $(LIB)(callrmfiltern.o)\
- $(LIB)(callrminvn.o)   \
- $(LIB)(cang.o)     \
- $(LIB)(cc1gfilt.o) \
- $(LIB)(ccc.o)    \
- $(LIB)(ccff.o)   \
- $(LIB)(ccfm.o)   \
- $(LIB)(ccfr.o)   \
- $(LIB)(cconect.o)\
- $(LIB)(ccrd_2.o) \
- $(LIB)(ccrd_3.o) \
- $(LIB)(cnrd_2.o) \
- $(LIB)(cnrd_3.o) \
- $(LIB)(ccrs.o)   \
- $(LIB)(ccrs_2.o) \
- $(LIB)(ccrs_ph_3.o)\
- $(LIB)(cnrs_2.o)   \
- $(LIB)(cnrs_3.o)   \
- $(LIB)(cengr3.o)   \
- $(LIB)(cent_3ph.o) \
- $(LIB)(cent_ph.o)  \
- $(LIB)(cent_rod.o) \
- $(LIB)(cent_sym.o) \
- $(LIB)(cent_q.o)    \
- $(LIB)(cgr_3.o)     \
- $(LIB)(changeval.o) \
- $(LIB)(charinside.o)\
- $(LIB)(chava.o)   \
- $(LIB)(chisq.o)   \
- $(LIB)(chkinpq.o) \
- $(LIB)(chkstr.o)  \
- $(LIB)(chkstuff.o)\
- $(LIB)(clast.o)   \
- $(LIB)(clss.o)    \
- $(LIB)(clusterlst.o) \
- $(LIB)(cncalc.o) \
- $(LIB)(cnint3.o) \
- $(LIB)(cnscan.o) \
- $(LIB)(cnstuff.o)\
- $(LIB)(cntrce.o) \
- $(LIB)(cntrfl.o) \
- $(LIB)(cntur.o)  \
- $(LIB)(comp3d.o) \
- $(LIB)(comp3dmad.o) \
- $(LIB)(conf.o)  \
- $(LIB)(conf1.o) \
- $(LIB)(conint.o)\
- $(LIB)(cop.o)   \
- $(LIB)(copd.o)  \
- $(LIB)(copy1.o) \
- $(LIB)(copyangles.o)  \
- $(LIB)(copyangles_1.o)\
- $(LIB)(copybrix.o)\
- $(LIB)(copyccp4.o)\
- $(LIB)(copyemi.o) \
- $(LIB)(copyd.o)   \
- $(LIB)(copye.o)   \
- $(LIB)(copyf.o)   \
- $(LIB)(copyfromnik.o) \
- $(LIB)(copyfromxplo.o)\
- $(LIB)(copypos.o)     \
- $(LIB)(copytoxplor.o) \
- $(LIB)(copyr.o) \
- $(LIB)(copyu.o) \
- $(LIB)(corel.o) \
- $(LIB)(corr1.o) \
- $(LIB)(coupe.o) \
- $(LIB)(cppb.o)  \
- $(LIB)(cproj.o) \
- $(LIB)(cputrmn.o) \
- $(LIB)(cr180_2.o) \
- $(LIB)(crcse1.o)  \
- $(LIB)(crcse2.o)  \
- $(LIB)(crcse3.o)         \
- $(LIB)(crosrmg.o) \
- $(LIB)(crosrng.o) \
- $(LIB)(crosrng_2.o) \
- $(LIB)(crosrng_trans.o) \
- $(LIB)(crosrng_ds.o) \
- $(LIB)(crosrng_com.o) \
- $(LIB)(crosrng_ms.o) \
- $(LIB)(crosrng_q.o) \
- $(LIB)(crsm_2.o) \
- $(LIB)(cslice.o) \
- $(LIB)(csvms.o) \
- $(LIB)(ctffind3.o) \
- $(LIB)(cutxslice.o) \
- $(LIB)(cutyslice.o) \
- $(LIB)(cutzslice.o) \
- $(LIB)(date.o) \
- $(LIB)(date_2k.o) \
- $(LIB)(d3dplt.o) \
- $(LIB)(dchist.o) \
- $(LIB)(decimate.o) \
- $(LIB)(dee.o) \
- $(LIB)(defo001.o) \
- $(LIB)(defo003.o) \
- $(LIB)(defo1001.o) \
- $(LIB)(defo2001.o) \
- $(LIB)(defocus.o) \
- $(LIB)(deletf.o) \
- $(LIB)(dendro.o) \
- $(LIB)(denlst.o) \
- $(LIB)(denov.o) \
- $(LIB)(deucl.o) \
- $(LIB)(dhide.o) \
- $(LIB)(diff1o.o) \
- $(LIB)(dilation.o) \
- $(LIB)(dirnm.o) \
- $(LIB)(disc.o) \
- $(LIB)(discrim.o) \
- $(LIB)(dist1.o) \
- $(LIB)(dist2.o) \
- $(LIB)(dist4.o) \
- $(LIB)(dist_p.o) \
- $(LIB)(distest.o) \
- $(LIB)(divcr3.o) \
- $(LIB)(dust.o) \
- $(LIB)(dvcr.o) \
- $(LIB)(docorr3_s.o) \
- $(LIB)(docors3_s.o) \
- $(LIB)(docsub.o) \
- $(LIB)(docs1.o) \
- $(LIB)(domax3_s.o) \
- $(LIB)(domin3_s.o) \
- $(LIB)(dprofd.o) \
- $(LIB)(dprofl.o) \
- $(LIB)(driv1.o) \
- $(LIB)(driv2.o) \
- $(LIB)(driv3.o) \
- $(LIB)(edge.o) \
- $(LIB)(edm.o) \
- $(LIB)(eff.o) \
- $(LIB)(ehist.o) \
- $(LIB)(eigpercent.o) \
- $(LIB)(empsli.o) \
- $(LIB)(endit.o) \
- $(LIB)(ener.o) \
- $(LIB)(enfr_2.o) \
- $(LIB)(enhanc.o) \
- $(LIB)(entrop.o) \
- $(LIB)(envelope.o) \
- $(LIB)(epur4.o) \
- $(LIB)(erc.o) \
- $(LIB)(erosion.o) \
- $(LIB)(errf2.o) \
- $(LIB)(erri2.o) \
- $(LIB)(errt.o)  \
- $(LIB)(evalnq.o)\
- $(LIB)(evalsympar.o) \
- $(LIB)(express3q.o) \
- $(LIB)(exprq.o)  \
- $(LIB)(falb.o)   \
- $(LIB)(fallg.o)  \
- $(LIB)(fbs3.o) \
- $(LIB)(fbs2.o) \
- $(LIB)(fcnq.o)   \
- $(LIB)(fermp.o)  \
- $(LIB)(fftc_d.o) \
- $(LIB)(fftc_q.o) \
- $(LIB)(fftmcf.o) \
- $(LIB)(fftr_d.o) \
- $(LIB)(fftr_q.o) \
- $(LIB)(fgr.o) \
- $(LIB)(fhodt.o)  \
- $(LIB)(ffilts.o) \
- $(LIB)(fillbessi0.o) \
- $(LIB)(filcad.o) \
- $(LIB)(filcan.o) \
- $(LIB)(fildat.o) \
- $(LIB)(filelist.o) \
- $(LIB)(filerd.o) \
- $(LIB)(filgen.o) \
- $(LIB)(filget.o) \
- $(LIB)(filnamandext.o) \
- $(LIB)(filnamsub.o) \
- $(LIB)(filseqp.o) \
- $(LIB)(filsli.o) \
- $(LIB)(filtdoc.o) \
- $(LIB)(filter.o) \
- $(LIB)(filter_har.o) \
- $(LIB)(filtplot.o) \
- $(LIB)(findfrq.o) \
- $(LIB)(findcent.o) \
- $(LIB)(findlbq.o) \
- $(LIB)(findmx.o) \
- $(LIB)(findmx_f.o) \
- $(LIB)(findmx_q.o) \
- $(LIB)(fint.o) \
- $(LIB)(fint3.o) \
- $(LIB)(fitt.o) \
- $(LIB)(flushresults.o) \
- $(LIB)(flushfile.o) \
- $(LIB)(fmax_c.o) \
- $(LIB)(fmax_q.o) \
- $(LIB)(fmax_s.o) \
- $(LIB)(fmin_c.o) \
- $(LIB)(fmin_q.o) \
- $(LIB)(fmin_s.o) \
- $(LIB)(fmr_1.o) \
- $(LIB)(fmr_2.o) \
- $(LIB)(fmrs.o) \
- $(LIB)(fmrs_1.o) \
- $(LIB)(fmrs_1d.o) \
- $(LIB)(fmrs_2.o) \
- $(LIB)(fmrs_2dr.o) \
- $(LIB)(fmrs_2r.o) \
- $(LIB)(fmrs_3.o) \
- $(LIB)(fmrs_3r.o) \
- $(LIB)(fmrs_3dr.o) \
- $(LIB)(fnrm.o) \
- $(LIB)(four1.o) \
- $(LIB)(four1a.o) \
- $(LIB)(four1a_fp.o) \
- $(LIB)(four1b.o) \
- $(LIB)(four1c.o) \
- $(LIB)(fouradcalln.o) \
- $(LIB)(fouradinvcn.o) \
- $(LIB)(fouradinvn.o) \
- $(LIB)(fouradn.o) \
- $(LIB)(fouring.o) \
- $(LIB)(fouring_q.o) \
- $(LIB)(fq3_p.o) \
- $(LIB)(fq_q.o) \
- $(LIB)(frng.o) \
- $(LIB)(frngs.o) \
- $(LIB)(fromtoq.o) \
- $(LIB)(fsort.o) \
- $(LIB)(ftr.o) \
- $(LIB)(fv.o) \
- $(LIB)(gali.o) \
- $(LIB)(gam.o) \
- $(LIB)(gaussp.o) \
- $(LIB)(gee.o) \
- $(LIB)(getcoo.o) \
- $(LIB)(getcoot.o) \
- $(LIB)(getdefocus.o) \
- $(LIB)(getdocdat.o) \
- $(LIB)(getdoclist.o) \
- $(LIB)(getfilenum.o) \
- $(LIB)(gethedccp4.o) \
- $(LIB)(getima_q.o) \
- $(LIB)(getlbno.o) \
- $(LIB)(getlab.o) \
- $(LIB)(getnewstack.o) \
- $(LIB)(getnexttoken.o) \
- $(LIB)(getoldstack.o) \
- $(LIB)(getstack.o) \
- $(LIB)(getsym.o) \
- $(LIB)(getthreads.o) \
- $(LIB)(gnc.o) \
- $(LIB)(gnc2s.o) \
- $(LIB)(gotbranch.o) \
- $(LIB)(gp.o) \
- $(LIB)(gprp.o) \
- $(LIB)(graphp.o) \
- $(LIB)(graphs.o) \
- $(LIB)(gsmod.o) \
- $(LIB)(gsmodl.o) \
- $(LIB)(hali.o) \
- $(LIB)(hclp.o) \
- $(LIB)(hcls.o) \
- $(LIB)(hdiag.o) \
- $(LIB)(hdls.o) \
- $(LIB)(hels.o) \
- $(LIB)(hgr.o) \
- $(LIB)(hiang.o) \
- $(LIB)(hismap.o) \
- $(LIB)(hismap4.o) \
- $(LIB)(hisd.o) \
- $(LIB)(hist.o) \
- $(LIB)(histe.o) \
- $(LIB)(histod.o) \
- $(LIB)(histodc.o) \
- $(LIB)(hkmc.o) \
- $(LIB)(hotelling.o) \
- $(LIB)(hotm.o) \
- $(LIB)(iftorpn.o) \
- $(LIB)(imseq4.o) \
- $(LIB)(imsq.o) \
- $(LIB)(imstat.o) \
- $(LIB)(imtovol.o) \
- $(LIB)(incor3.o) \
- $(LIB)(incort.o) \
- $(LIB)(inf3_p.o) \
- $(LIB)(inf_q.o) \
- $(LIB)(initunix.o) \
- $(LIB)(inlnbuf.o) \
- $(LIB)(inquirealloc.o) \
- $(LIB)(inquirearch.o) \
- $(LIB)(inquirehead.o) \
- $(LIB)(inquireif.o) \
- $(LIB)(inquireif1.o) \
- $(LIB)(inquirereg.o) \
- $(LIB)(inquiresync.o) \
- $(LIB)(inttochar.o) \
- $(LIB)(interp.o) \
- $(LIB)(interps.o) \
- $(LIB)(interp3.o) \
- $(LIB)(interp_fbs3.o) \
- $(LIB)(interp_fbs.o) \
- $(LIB)(invbt.o) \
- $(LIB)(invgdist.o) \
- $(LIB)(ipalign64.o) \
- $(LIB)(irmrecord.o) \
- $(LIB)(irp3.o) \
- $(LIB)(ischar.o) \
- $(LIB)(isdigi.o) \
- $(LIB)(isbare.o) \
- $(LIB)(isdocincore.o) \
- $(LIB)(itpow.o) \
- $(LIB)(johist.o) \
- $(LIB)(johistf.o) \
- $(LIB)(jpmsk1.o) \
- $(LIB)(jpmsk2.o) \
- $(LIB)(jpmsk3.o) \
- $(LIB)(labelspi.o) \
- $(LIB)(lastoccur.o) \
- $(LIB)(latcen.o) \
- $(LIB)(latice.o) \
- $(LIB)(lenopenfile.o) \
- $(LIB)(listdc.o) \
- $(LIB)(listit.o) \
- $(LIB)(listitr.o) \
- $(LIB)(lmdif.o) \
- $(LIB)(lmdif1.o) \
- $(LIB)(lnblnk.o) \
- $(LIB)(lnblnkn.o) \
- $(LIB)(local.o) \
- $(LIB)(lhist.o) \
- $(LIB)(log2.o) \
- $(LIB)(logifq.o) \
- $(LIB)(longer.o) \
- $(LIB)(macf.o) \
- $(LIB)(macf_p.o) \
- $(LIB)(mahal.o) \
- $(LIB)(make_patm.o) \
- $(LIB)(make_close_list.o) \
- $(LIB)(maktab.o) \
- $(LIB)(malfi3.o) \
- $(LIB)(mapdist.o) \
- $(LIB)(mapdoc.o) \
- $(LIB)(mapfilt.o) \
- $(LIB)(mapim.o) \
- $(LIB)(mapstat.o) \
- $(LIB)(mask.o) \
- $(LIB)(maskmu.o) \
- $(LIB)(matinv.o) \
- $(LIB)(maxf.o) \
- $(LIB)(mccf.o) \
- $(LIB)(mccf_p.o) \
- $(LIB)(mcircl.o) \
- $(LIB)(md2.o) \
- $(LIB)(md3.o) \
- $(LIB)(meanshift.o) \
- $(LIB)(median.o) \
- $(LIB)(meed.o) \
- $(LIB)(mehist.o) \
- $(LIB)(mirror.o) \
- $(LIB)(mlc.o) \
- $(LIB)(mline.o) \
- $(LIB)(mline3.o) \
- $(LIB)(mod1.o) \
- $(LIB)(model.o) \
- $(LIB)(model3.o) \
- $(LIB)(mont.o) \
- $(LIB)(motif1.o) \
- $(LIB)(motif_init.o) \
- $(LIB)(motif_lsd.o) \
- $(LIB)(motif.o) \
- $(LIB)(mpi.o) \
- $(LIB)(mpoint.o) \
- $(LIB)(mr2to3d.o) \
- $(LIB)(mralign.o) \
- $(LIB)(mrand.o) \
- $(LIB)(mrang2.o) \
- $(LIB)(mrcalerr.o) \
- $(LIB)(mrcg3.o) \
- $(LIB)(mrcg3d.o) \
- $(LIB)(mrcp.o) \
- $(LIB)(mrdoc.o) \
- $(LIB)(mrdoccor.o) \
- $(LIB)(mread.o) \
- $(LIB)(mrectl.o) \
- $(LIB)(mreigen.o) \
- $(LIB)(mrerror.o) \
- $(LIB)(mrfft.o) \
- $(LIB)(mrfour1.o) \
- $(LIB)(mrgetinfo.o) \
- $(LIB)(mrk.o) \
- $(LIB)(mrk3.o) \
- $(LIB)(mrkur3.o) \
- $(LIB)(mrncolor.o) \
- $(LIB)(mrnewangle.o) \
- $(LIB)(mrproj.o)   \
- $(LIB)(mrprrep.o)  \
- $(LIB)(mrputinfo.o)\
- $(LIB)(mrquater.o) \
- $(LIB)(mrrefl.o)   \
- $(LIB)(mrreplace.o)\
- $(LIB)(mrrmake.o)  \
- $(LIB)(mrrotate.o) \
- $(LIB)(mrrsurf.o)  \
- $(LIB)(mrrt.o)     \
- $(LIB)(mrscale.o)  \
- $(LIB)(mrscale3.o)\
- $(LIB)(mrshift.o)\
- $(LIB)(mrsurf.o) \
- $(LIB)(mrtheta.o)\
- $(LIB)(msum.o)   \
- $(LIB)(mtnv.o)   \
- $(LIB)(mtpr.o)   \
- $(LIB)(mtrian.o) \
- $(LIB)(mult.o)   \
- $(LIB)(multishift.o) \
- $(LIB)(mx.o)       \
- $(LIB)(mygetenv.o) \
- $(LIB)(mymods.o) \
- $(LIB)(myread.o) \
- $(LIB)(mytime.o) \
- $(LIB)(mywr0.o)  \
- $(LIB)(mywr1.o)  \
- $(LIB)(mywr2.o)  \
- $(LIB)(narea.o)  \
- $(LIB)(negate.o) \
- $(LIB)(negati.o) \
- $(LIB)(newkmeans.o) \
- $(LIB)(nextversion.o) \
- $(LIB)(nn4.o) \
- $(LIB)(nn24.o) \
- $(LIB)(noise.o) \
- $(LIB)(norm3.o) \
- $(LIB)(normas.o) \
- $(LIB)(normasc.o) \
- $(LIB)(normm.o) \
- $(LIB)(norppf.o) \
- $(LIB)(noyau.o) \
- $(LIB)(nrml.o) \
- $(LIB)(numdig.o) \
- $(LIB)(od.o) \
- $(LIB)(oneline.o) \
- $(LIB)(opauxfile.o) \
- $(LIB)(openchk.o) \
- $(LIB)(opendoc.o) \
- $(LIB)(openfil.o) \
- $(LIB)(openinstk.o) \
- $(LIB)(openstk.o) \
- $(LIB)(opfilec.o) \
- $(LIB)(opfiles.o) \
- $(LIB)(opsf3_p.o) \
- $(LIB)(opsf_p.o) \
- $(LIB)(oracfmsk.o) \
- $(LIB)(oracfmskm.o) \
- $(LIB)(orcdf.o) \
- $(LIB)(orient.o) \
- $(LIB)(ormap.o) \
- $(LIB)(ormd.o) \
- $(LIB)(ormd_p.o) \
- $(LIB)(outim_q.o) \
- $(LIB)(outpr.o) \
- $(LIB)(outrng.o) \
- $(LIB)(parabl.o) \
- $(LIB)(parabld.o) \
- $(LIB)(parsesympar.o) \
- $(LIB)(parst.o) \
- $(LIB)(patch.o) \
- $(LIB)(pdates.o) \
- $(LIB)(pdb.o) \
- $(LIB)(picksl.o) \
- $(LIB)(picksv.o) \
- $(LIB)(pj3g.o) \
- $(LIB)(pj3_fbs.o) \
- $(LIB)(pj3_n.o) \
- $(LIB)(pj3q_n.o) \
- $(LIB)(pkd.o) \
- $(LIB)(pksr3.o) \
- $(LIB)(plnedg.o) \
- $(LIB)(plot1.o) \
- $(LIB)(plot2.o) \
- $(LIB)(polar_cc.o) \
- $(LIB)(polish.o) \
- $(LIB)(poj.o) \
- $(LIB)(polfit.o) \
- $(LIB)(pollsq.o) \
- $(LIB)(polqs.o) \
- $(LIB)(posaxis.o) \
- $(LIB)(postrt.o) \
- $(LIB)(proc_set.o) \
- $(LIB)(pr3d.o) \
- $(LIB)(pr3db.o) \
- $(LIB)(prb1d.o) \
- $(LIB)(prb1.o) \
- $(LIB)(prepcub.o) \
- $(LIB)(prepcub_s.o) \
- $(LIB)(prepsl_2.o) \
- $(LIB)(prjc0.o) \
- $(LIB)(prjc2.o) \
- $(LIB)(prjcq.o) \
- $(LIB)(prjs2.o) \
- $(LIB)(prober.o) \
- $(LIB)(prp.o) \
- $(LIB)(prt.o) \
- $(LIB)(pttern.o) \
- $(LIB)(pts_on_sphere.o) \
- $(LIB)(putlin.o) \
- $(LIB)(putpt.o) \
- $(LIB)(putpt1.o) \
- $(LIB)(putpt2.o) \
- $(LIB)(putrmn.o) \
- $(LIB)(putrmrealn.o) \
- $(LIB)(putyslice.o) \
- $(LIB)(putzslice.o) \
- $(LIB)(pw2sdr.o) \
- $(LIB)(pw2sr.o) \
- $(LIB)(pw3sdr.o) \
- $(LIB)(pw3sr.o) \
- $(LIB)(qali.o) \
- $(LIB)(qfact.o) \
- $(LIB)(qfact_p.o) \
- $(LIB)(qnrf.o) \
- $(LIB)(qphi.o) \
- $(LIB)(qstat.o) \
- $(LIB)(qtheta.o) \
- $(LIB)(quadri.o) \
- $(LIB)(quadri_q.o) \
- $(LIB)(rad2calln.o) \
- $(LIB)(radav.o) \
- $(LIB)(radavi.o) \
- $(LIB)(radcompleten.o) \
- $(LIB)(radon2en.o) \
- $(LIB)(radon3dn.o) \
- $(LIB)(radweight.o) \
- $(LIB)(ramp_p.o) \
- $(LIB)(rand_p.o) \
- $(LIB)(rann.o) \
- $(LIB)(rathin.o) \
- $(LIB)(rawtospider.o) \
- $(LIB)(rclu.o) \
- $(LIB)(rcnv2_p.o) \
- $(LIB)(rcnv3_p.o) \
- $(LIB)(rconv.o) \
- $(LIB)(rctf.o) \
- $(LIB)(rctfss.o) \
- $(LIB)(rctfone.o) \
- $(LIB)(rdclus.o) \
- $(LIB)(rddocn.o) \
- $(LIB)(udoc.o) \
- $(LIB)(rdpa.o) \
- $(LIB)(rdpr.o) \
- $(LIB)(rdpra.o) \
- $(LIB)(rdprai.o) \
- $(LIB)(rdpranc.o) \
- $(LIB)(rdprinc.o) \
- $(LIB)(rdpris.o) \
- $(LIB)(rdpri1s.o) \
- $(LIB)(rdpri2s.o) \
- $(LIB)(rdpri3s.o) \
- $(LIB)(rdprm.o)   \
- $(LIB)(rdprm2.o)  \
- $(LIB)(rdprm1s.o) \
- $(LIB)(rdprm2s.o) \
- $(LIB)(rdprm3s.o) \
- $(LIB)(rdprmc.o) \
- $(LIB)(rdprmi.o) \
- $(LIB)(rdprop.o) \
- $(LIB)(rdsl_p.o) \
- $(LIB)(readpdb.o) \
- $(LIB)(readrq.o) \
- $(LIB)(reads.o) \
- $(LIB)(readv.o) \
- $(LIB)(redhedmrc.o) \
- $(LIB)(regparse.o) \
- $(LIB)(reg_set.o) \
- $(LIB)(redlin.o) \
- $(LIB)(redlin8.o) \
- $(LIB)(rednpadvol.o) \
- $(LIB)(redpro2.o) \
- $(LIB)(redrec8.o) \
- $(LIB)(redvol.o) \
- $(LIB)(reform.o) \
- $(LIB)(reform0.o) \
- $(LIB)(remez.o) \
- $(LIB)(remezp.o) \
- $(LIB)(bpcg.o) \
- $(LIB)(repr2_s.o) \
- $(LIB)(reprwb.o) \
- $(LIB)(retir.o) \
- $(LIB)(reversebytes.o) \
- $(LIB)(rew.o) \
- $(LIB)(rewf.o) \
- $(LIB)(rfactsd2.o) \
- $(LIB)(rfactsdo.o) \
- $(LIB)(rgri.o) \
- $(LIB)(ringwe.o) \
- $(LIB)(rmfilterz.o) \
- $(LIB)(rmfilty.o) \
- $(LIB)(rmfiltz.o) \
- $(LIB)(rminvn.o) \
- $(LIB)(rmiwf.o) \
- $(LIB)(rmmakemask.o) \
- $(LIB)(rmrepl.o)     \
- $(LIB)(rmreset.o)    \
- $(LIB)(rmtransfer.o) \
- $(LIB)(rmz_p.o)      \
- $(LIB)(rotates.o)    \
- $(LIB)(rotates3l.o)  \
- $(LIB)(rotates3q.o)  \
- $(LIB)(rotatesl3q.o) \
- $(LIB)(rotates3fbs.o) \
- $(LIB)(rot32.o) \
- $(LIB)(rot3_p.o) \
- $(LIB)(rot_p.o) \
- $(LIB)(rotal3.o) \
- $(LIB)(rotas3.o) \
- $(LIB)(rotl3.o) \
- $(LIB)(rotl3q.o) \
- $(LIB)(rotqss.o) \
- $(LIB)(rots3.o) \
- $(LIB)(rots3q.o) \
- $(LIB)(rprq.o) \
- $(LIB)(rtsf.o) \
- $(LIB)(rtsq.o) \
- $(LIB)(rtq.o) \
- $(LIB)(rtq_q.o) \
- $(LIB)(rtqs_q.o) \
- $(LIB)(rys1.o) \
- $(LIB)(rys3.o) \
- $(LIB)(saqb.o) \
- $(LIB)(savd.o) \
- $(LIB)(savdn1.o) \
- $(LIB)(savdocq.o) \
- $(LIB)(sclassi.o) \
- $(LIB)(scoran3.o) \
- $(LIB)(searchq.o) \
- $(LIB)(secnds.o)  \
- $(LIB)(seedfill.o) \
- $(LIB)(seeds.o) \
- $(LIB)(sen3a.o) \
- $(LIB)(setenv.o) \
- $(LIB)(sethedccp4.o) \
- $(LIB)(sethead.o) \
- $(LIB)(setlab.o)  \
- $(LIB)(setmode.o) \
- $(LIB)(setnumrings.o) \
- $(LIB)(setpart.o) \
- $(LIB)(setprm.o)  \
- $(LIB)(setprmb.o) \
- $(LIB)(setsympar.o) \
- $(LIB)(setthreads.o) \
- $(LIB)(setval.o) \
- $(LIB)(sdocic.o) \
- $(LIB)(sgraf.o)  \
- $(LIB)(sh180_2.o) \
- $(LIB)(shelk.o)  \
- $(LIB)(shfc_2.o) \
- $(LIB)(shfi_2.o) \
- $(LIB)(shfi_q.o) \
- $(LIB)(shfm_2.o) \
- $(LIB)(shift1.o) \
- $(LIB)(shift2.o) \
- $(LIB)(shift3.o) \
- $(LIB)(shift_3d.o) \
- $(LIB)(shift_pf.o) \
- $(LIB)(shiftr.o) \
- $(LIB)(shifts.o) \
- $(LIB)(shiftt.o) \
- $(LIB)(shosli.o) \
- $(LIB)(shosli2.o) \
- $(LIB)(shrinkq.o) \
- $(LIB)(shuffledoc.o) \
- $(LIB)(single.o) \
- $(LIB)(sizchk.o) \
- $(LIB)(skeleton.o) \
- $(LIB)(slice.o)  \
- $(LIB)(smt3.o)   \
- $(LIB)(smt3_q.o) \
- $(LIB)(snrb.o)   \
- $(LIB)(snrf.o)   \
- $(LIB)(solv2d.o) \
- $(LIB)(solve.o)  \
- $(LIB)(sort.o)   \
- $(LIB)(sorti.o)  \
- $(LIB)(sortint.o)\
- $(LIB)(sortz.o)  \
- $(LIB)(spdtotiff.o) \
- $(LIB)(spca3.o)  \
- $(LIB)(speak.o)  \
- $(LIB)(speak3.o) \
- $(LIB)(speakc.o) \
- $(LIB)(speakm.o) \
- $(LIB)(speakr.o) \
- $(LIB)(sphdecon.o) \
- $(LIB)(spireout.o) \
- $(LIB)(spotwt.o) \
- $(LIB)(squeez.o) \
- $(LIB)(ssnrb.o)  \
- $(LIB)(ssnr3.o)  \
- $(LIB)(ssnr3dnn.o) \
- $(LIB)(sspush.o) \
- $(LIB)(sslowcas.o) \
- $(LIB)(ssupcas.o) \
- $(LIB)(stabk.o) \
- $(LIB)(stack.o) \
- $(LIB)(step.o) \
- $(LIB)(stepi.o) \
- $(LIB)(subaf.o) \
- $(LIB)(subchar.o) \
- $(LIB)(subkmeans.o) \
- $(LIB)(subkmns.o) \
- $(LIB)(subsympar.o) \
- $(LIB)(sumali.o) \
- $(LIB)(sumali3.o) \
- $(LIB)(sumap.o)     \
- $(LIB)(sumeuler.o)  \
- $(LIB)(sunonly.o)   \
- $(LIB)(surfarea.o)  \
- $(LIB)(surffit.o)   \
- $(LIB)(surfcomp.o)  \
- $(LIB)(surftovol.o) \
- $(LIB)(symang.o)  \
- $(LIB)(symangs.o) \
- $(LIB)(sympar.o)  \
- $(LIB)(symvol.o)  \
- $(LIB)(tcnp.o)    \
- $(LIB)(tf.o)      \
- $(LIB)(tfcrf.o)   \
- $(LIB)(tfd.o)     \
- $(LIB)(tfed.o)    \
- $(LIB)(tflm4.o)   \
- $(LIB)(tfsnr.o)   \
- $(LIB)(thresh.o)  \
- $(LIB)(tilt.o)    \
- $(LIB)(tiltfd.o)  \
- $(LIB)(tima.o)    \
- $(LIB)(title.o)   \
- $(LIB)(toma.o)    \
- $(LIB)(to_polar.o) \
- $(LIB)(tpaired.o) \
- $(LIB)(traf.o)    \
- $(LIB)(trafc.o)   \
- $(LIB)(trafc3.o)  \
- $(LIB)(trafct3.o) \
- $(LIB)(trafd.o)   \
- $(LIB)(trafl.o)   \
- $(LIB)(trafsim.o) \
- $(LIB)(transpose.o) \
- $(LIB)(tridi.o)   \
- $(LIB)(trinter.o) \
- $(LIB)(triquad.o) \
- $(LIB)(tswitch.o) \
- $(LIB)(ttest.o)   \
- $(LIB)(ttest1.o)  \
- $(LIB)(tvwn3.o)   \
- $(LIB)(udocic.o)  \
- $(LIB)(unixtounix8.o) \
- $(LIB)(unsav.o)    \
- $(LIB)(unsdal.o)   \
- $(LIB)(updf.o)     \
- $(LIB)(updtc.o)    \
- $(LIB)(updtf.o)    \
- $(LIB)(updtf_r.o)  \
- $(LIB)(uqu.o)      \
- $(LIB)(util1.o)    \
- $(LIB)(util2.o)    \
- $(LIB)(util2sup.o) \
- $(LIB)(util3.o)    \
- $(LIB)(util4.o)    \
- $(LIB)(util5.o)    \
- $(LIB)(util6.o)    \
- $(LIB)(util7.o)    \
- $(LIB)(util_1010.o) \
- $(LIB)(util_1011.o) \
- $(LIB)(util_1110.o) \
- $(LIB)(varf.o)      \
- $(LIB)(varf1.o)     \
- $(LIB)(var3r.o)     \
- $(LIB)(var3d.o)     \
- $(LIB)(vax32u.o)    \
- $(LIB)(vaxtounix.o) \
- $(LIB)(vismap.o) \
- $(LIB)(vms.o)    \
- $(LIB)(vms_cd.o) \
- $(LIB)(voda.o)   \
- $(LIB)(voea.o)   \
- $(LIB)(vonea.o)  \
- $(LIB)(voept.o)  \
- $(LIB)(voia.o)   \
- $(LIB)(vomd.o)   \
- $(LIB)(vomq.o)   \
- $(LIB)(vora.o)   \
- $(LIB)(vprop.o)  \
- $(LIB)(vtil2.o)  \
- $(LIB)(vtil3.o)  \
- $(LIB)(warp3.o)  \
- $(LIB)(wate.o)   \
- $(LIB)(watershed.o) \
- $(LIB)(watershd.o)  \
- $(LIB)(wftcirc.o) \
- $(LIB)(wgbp2.o)   \
- $(LIB)(winave.o)  \
- $(LIB)(winave2.o) \
- $(LIB)(window.o)  \
- $(LIB)(bp3f.o)    \
- $(LIB)(wiw3g.o)   \
- $(LIB)(bp32f.o)   \
- $(LIB)(wpdp.o)      \
- $(LIB)(wpro_n.o)    \
- $(LIB)(wpro_fbs.o)  \
- $(LIB)(writepict.o) \
- $(LIB)(writepictn.o)\
- $(LIB)(writev.o)    \
- $(LIB)(writpro_n.o) \
- $(LIB)(wrsl_p.o)    \
- $(LIB)(wrtarray.o)  \
- $(LIB)(wrthedmrc.o) \
- $(LIB)(wrtlin.o)    \
- $(LIB)(wrtlin8.o)   \
- $(LIB)(wrtseq8.o)   \
- $(LIB)(wrtvol.o)    \
- $(LIB)(wtf.o)       \
- $(LIB)(wtm.o)       \
- $(LIB)(xmipp.o)     \
- $(LIB)(xmselfile.o) 
-
-
-@
-
-
-1.140
-log
-@eigpercent added
-@
-text
-@d810 1
-@
-
-
-1.139
-log
-@setnumrings & ormap added
-@
-text
-@d253 1
-@
-
-
-1.138
-log
-@*** empty log message ***
-@
-text
-@d573 1
-d761 1
-@
-
-
-1.137
-log
-@removed hf
-@
-text
-@a917 1
- $(LIB)(bp3f_old.o)\
-a919 1
- $(LIB)(bp32f_old.o) \
-@
-
-
-1.136
-log
-@removed vota.f
-@
-text
-@a382 1
- $(LIB)(hf.o) \
-@
-
-
-1.135
-log
-@removed gammln.f betacf.f  (now in betai.f)
-@
-text
-@a905 1
- $(LIB)(vota.o)   \
-@
-
-
-1.134
-log
-@util_1010.f
-@
-text
-@a88 1
- $(LIB)(betacf.o)\
-a349 1
- $(LIB)(gammln.o) \
-@
-
-
-1.133
-log
-@*** empty log message ***
-@
-text
-@d830 6
-a835 6
- $(LIB)(sumap.o) \
- $(LIB)(sumeuler.o) \
- $(LIB)(sunonly.o) \
- $(LIB)(surfarea.o) \
- $(LIB)(surffit.o) \
- $(LIB)(surfcomp.o) \
-d837 1
-a837 1
- $(LIB)(symang.o) \
-d839 15
-a853 15
- $(LIB)(sympar.o) \
- $(LIB)(symvol.o) \
- $(LIB)(tcnp.o) \
- $(LIB)(tf.o) \
- $(LIB)(tfcrf.o) \
- $(LIB)(tfd.o) \
- $(LIB)(tfed.o) \
- $(LIB)(tflm4.o) \
- $(LIB)(tfsnr.o) \
- $(LIB)(thresh.o) \
- $(LIB)(tilt.o) \
- $(LIB)(tiltfd.o) \
- $(LIB)(tima.o) \
- $(LIB)(title.o) \
- $(LIB)(toma.o) \
-d856 3
-a858 3
- $(LIB)(traf.o) \
- $(LIB)(trafc.o) \
- $(LIB)(trafc3.o) \
-d860 2
-a861 2
- $(LIB)(trafd.o) \
- $(LIB)(trafl.o) \
-d864 1
-a864 1
- $(LIB)(tridi.o) \
-d868 4
-a871 4
- $(LIB)(ttest.o) \
- $(LIB)(ttest1.o) \
- $(LIB)(tvwn3.o) \
- $(LIB)(udocic.o) \
-d873 9
-a881 9
- $(LIB)(unsav.o) \
- $(LIB)(unsdal.o) \
- $(LIB)(updf.o) \
- $(LIB)(updtc.o) \
- $(LIB)(updtf.o) \
- $(LIB)(updtf_r.o) \
- $(LIB)(uqu.o) \
- $(LIB)(util1.o) \
- $(LIB)(util2.o) \
-d883 6
-a888 5
- $(LIB)(util3.o) \
- $(LIB)(util4.o) \
- $(LIB)(util5.o) \
- $(LIB)(util6.o) \
- $(LIB)(util7.o) \
-d891 5
-a895 5
- $(LIB)(varf.o)  \
- $(LIB)(varf1.o) \
- $(LIB)(var3r.o) \
- $(LIB)(var3d.o) \
- $(LIB)(vax32u.o) \
-d922 3
-a924 3
- $(LIB)(bp3f_old.o) \
- $(LIB)(wiw3g.o) \
- $(LIB)(bp32f.o) \
-d926 6
-a931 6
- $(LIB)(wpdp.o) \
- $(LIB)(wpro_n.o) \
- $(LIB)(wpro_fbs.o)   \
- $(LIB)(writepict.o)  \
- $(LIB)(writepictn.o) \
- $(LIB)(writev.o) \
-d933 2
-a934 2
- $(LIB)(wrsl_p.o) \
- $(LIB)(wrtarray.o) \
-d936 7
-a942 7
- $(LIB)(wrtlin.o) \
- $(LIB)(wrtlin8.o) \
- $(LIB)(wrtseq8.o) \
- $(LIB)(wrtvol.o) \
- $(LIB)(wtf.o) \
- $(LIB)(wtm.o) \
- $(LIB)(xmipp.o) \
-@
-
-
-1.132
-log
-@removed makepws
-@
-text
-@a50 1
- $(LIB)(apfou_p.o)    \
-@
-
-
-1.131
-log
-@removed ptrs patm stuff
-@
-text
-@a65 1
- $(LIB)(aprings_pws.o)  \
-a457 1
- $(LIB)(makepws.o) \
-@
-
-
-1.130
-log
-@added ctffind3
-@
-text
-@d52 1
-a52 1
- $(LIB)(apfou_ptrs.o) \
-d67 1
-a67 1
- $(LIB)(aprings_ptrs.o) \
-d460 1
-a460 1
- $(LIB)(make_ptrs.o) \
-@
-
-
-1.129
-log
-@removed unused normass
-@
-text
-@d207 1
-@
-
-
-1.128
-log
-@removed cent_symobj.o
-@
-text
-@a556 1
- $(LIB)(normass.o) \
-@
-
-
-1.127
-log
-@bprp3 added (temp)
-@
-text
-@a144 1
- $(LIB)(cent_symobj.o) \
-@
-
-
-1.126
-log
-@added: make_ptrs.f ..
-@
-text
-@d111 1
-@
-
-
-1.125
-log
-@*** empty log message ***
-@
-text
-@d52 1
-d67 1
-d136 4
-a139 4
- $(LIB)(ccrs_ph_3.o) \
- $(LIB)(cnrs_2.o) \
- $(LIB)(cnrs_3.o) \
- $(LIB)(cengr3.o) \
-d141 1
-a141 1
- $(LIB)(cent_ph.o) \
-d145 2
-a146 2
- $(LIB)(cent_q.o) \
- $(LIB)(cgr_3.o) \
-d148 3
-a150 3
- $(LIB)(charinside.o) \
- $(LIB)(chava.o) \
- $(LIB)(chisq.o) \
-d152 4
-a155 4
- $(LIB)(chkstr.o) \
- $(LIB)(chkstuff.o) \
- $(LIB)(clast.o) \
- $(LIB)(clss.o) \
-d160 1
-a160 1
- $(LIB)(cnstuff.o) \
-d163 1
-a163 1
- $(LIB)(cntur.o) \
-d166 1
-a166 1
- $(LIB)(conf.o) \
-d168 3
-a170 3
- $(LIB)(conint.o) \
- $(LIB)(cop.o) \
- $(LIB)(copd.o) \
-d172 4
-a175 4
- $(LIB)(copyangles.o) \
- $(LIB)(copyangles_1.o) \
- $(LIB)(copybrix.o) \
- $(LIB)(copyccp4.o) \
-d177 3
-a179 3
- $(LIB)(copyd.o) \
- $(LIB)(copye.o) \
- $(LIB)(copyf.o) \
-d181 2
-a182 2
- $(LIB)(copyfromxplo.o) \
- $(LIB)(copypos.o) \
-d189 1
-a189 1
- $(LIB)(cppb.o) \
-d193 3
-a195 3
- $(LIB)(crcse1.o) \
- $(LIB)(crcse2.o) \
- $(LIB)(crcse3.o) \
-d459 1
-d517 3
-a519 3
- $(LIB)(mrproj.o) \
- $(LIB)(mrprrep.o) \
- $(LIB)(mrputinfo.o) \
-d521 3
-a523 3
- $(LIB)(mrrefl.o) \
- $(LIB)(mrreplace.o) \
- $(LIB)(mrrmake.o) \
-d525 5
-a529 5
- $(LIB)(mrrsurf.o) \
- $(LIB)(mrrt.o) \
- $(LIB)(mrscale.o) \
- $(LIB)(mrscale3.o) \
- $(LIB)(mrshift.o) \
-d531 4
-a534 4
- $(LIB)(mrtheta.o) \
- $(LIB)(msum.o) \
- $(LIB)(mtnv.o) \
- $(LIB)(mtpr.o) \
-d536 1
-a536 1
- $(LIB)(mult.o) \
-d538 1
-a538 1
- $(LIB)(mx.o) \
-d543 4
-a546 4
- $(LIB)(mywr0.o) \
- $(LIB)(mywr1.o) \
- $(LIB)(mywr2.o) \
- $(LIB)(narea.o) \
-@
-
-
-1.124
-log
-@cent_3.o --> cent_3ph.o, added shifts.f
-@
-text
-@a137 1
- $(LIB)(cent.o)   \
-d301 1
-@
-
-
-1.123
-log
-@*** empty log message ***
-@
-text
-@d139 1
-a139 1
- $(LIB)(cent_3.o) \
-d783 1
-d889 1
-@
-
-
-1.122
-log
-@gali, saqb, cent_d renamed
-@
-text
-@a348 1
- $(LIB)(gali_p.o) \
-d379 1
-a379 1
-  $(LIB)(hclp.o) \
-a747 2
- $(LIB)(saqb_f.o) \
- $(LIB)(saqb_p.o) \
-@
-
-
-1.121
-log
-@hali_p.f now inside hali.f
-@
-text
-@d140 1
-a140 1
- $(LIB)(cent_d.o) \
-@
-
-
-1.120
-log
-@adds_n
-@
-text
-@d380 1
-a380 2
- $(LIB)(hali_p.o) \
- $(LIB)(hclp.o) \
-@
-
-
-1.119
-log
-@aded cent_symobj, util_1011, cent_rod
-@
-text
-@d11 2
-a12 2
- $(LIB)(fftw3.o)  \
- $(LIB)(lundoc.o) \
-d14 7
-a20 7
- $(LIB)(acrs_2.o)  \
- $(LIB)(acrs_2s.o) \
- $(LIB)(acrs_3.o)  \
- $(LIB)(acrs_3s.o) \
- $(LIB)(add.o) \
- $(LIB)(ads.o) \
- $(LIB)(addfac.o) \
-d22 1
-d28 1
-a28 1
- $(LIB)(alprbs.o) \
-d32 3
-a34 3
- $(LIB)(alrq.o)   \
- $(LIB)(alrqs.o)  \
- $(LIB)(alrq_m.o) \
-d36 1
-a36 1
- $(LIB)(alrq_ms_fbs.o) \
-d50 2
-a51 2
- $(LIB)(ap_end.o) \
- $(LIB)(apfou_p.o)\
-d53 9
-a61 9
- $(LIB)(ap_getdata.o)  \
- $(LIB)(apref_p.o)  \
- $(LIB)(apref_pm.o) \
- $(LIB)(apsh_cuda.o)\
- $(LIB)(apsh_psc.o) \
- $(LIB)(apsh_ps.o)  \
- $(LIB)(apsh_ss.o)  \
- $(LIB)(ap_stat.o)  \
- $(LIB)(apmaster.o) \
-d63 3
-a65 3
- $(LIB)(apmaster_tool.o) \
- $(LIB)(aprings.o) \
- $(LIB)(aprings_pws.o) \
-d67 2
-a68 2
- $(LIB)(aprings_trans.o) \
- $(LIB)(applyw.o) \
-d70 11
-a80 11
- $(LIB)(arasq.o) \
- $(LIB)(arith.o) \
- $(LIB)(arithl.o) \
- $(LIB)(arithsca.o) \
- $(LIB)(asta.o) \
- $(LIB)(astcyl.o) \
- $(LIB)(atit2.o) \
- $(LIB)(atmc.o) \
- $(LIB)(atpk.o) \
- $(LIB)(atsa.o) \
- $(LIB)(atwn.o) \
-d82 1
-a82 1
- $(LIB)(averg3.o) \
-d86 1
-a86 1
- $(LIB)(bcq.o) \
-d89 1
-a89 1
- $(LIB)(betacf.o) \
-d94 3
-a96 3
- $(LIB)(blank.o) \
- $(LIB)(bldr.o) \
- $(LIB)(blob.o) \
-d102 10
-a111 10
- $(LIB)(borns.o) \
- $(LIB)(boxx.o) \
- $(LIB)(bpcm.o) \
- $(LIB)(bpcmp.o) \
- $(LIB)(bpcq.o) \
- $(LIB)(bpcqp.o) \
- $(LIB)(bprp.o) \
- $(LIB)(bprj2.o) \
- $(LIB)(bps2.o) \
- $(LIB)(bpwr.o) \
-d116 2
-a117 2
- $(LIB)(calc.o) \
- $(LIB)(cald.o) \
-d119 3
-a121 3
- $(LIB)(callrmfiltern.o) \
- $(LIB)(callrminvn.o) \
- $(LIB)(cang.o) \
-d123 5
-a127 5
- $(LIB)(ccc.o) \
- $(LIB)(ccff.o) \
- $(LIB)(ccfm.o) \
- $(LIB)(ccfr.o) \
- $(LIB)(cconect.o) \
-d138 1
-a138 1
- $(LIB)(cent.o) \
-@
-
-
-1.118
-log
-@mv copymrc.f RCS/copymrc.f* Attic
-/
-@
-text
-@d140 1
-d142 1
-d890 1
-@
-
-
-1.117
-log
-@added cent_sym.f
-@
-text
-@a177 1
- $(LIB)(copymrc.o) \
-@
-
-
-1.116
-log
-@removed tvwn1.f
-@
-text
-@d140 1
-@
-
-
-1.115
-log
-@added rdpri2s.o
-@
-text
-@a869 1
- $(LIB)(tvwn1.o) \
-@
-
-
-1.114
-log
-@bckcq --> bckpj
-@
-text
-@d672 1
-d674 1
-a674 1
- $(LIB)(rdpris.o) \
-d676 2
-a677 2
- $(LIB)(rdprm.o) \
- $(LIB)(rdprm2.o) \
-@
-
-
-1.113
-log
-@rot2qs --> rtsq
-@
-text
-@d84 1
-a84 1
- $(LIB)(bckcq.o) \
-@
-
-
-1.112
-log
-@removed unused: redprq.f
-@
-text
-@a726 1
- $(LIB)(rot2qs.o)     \
-d739 1
-@
-
-
-1.111
-log
-@added wpro_fbs
-@
-text
-@a694 1
- $(LIB)(redprq.o) \
-@
-
-
-1.110
-log
-@fbs_fast --> fbs2
-@
-text
-@d926 2
-a927 1
- $(LIB)(writepict.o) \
-@
-
-
-1.109
-log
-@added pj3_fbs.f
-@
-text
-@d271 1
-a271 1
- $(LIB)(fbs_fast.o) \
-@
-
-
-1.108
-log
-@replaced nrms with normvalsp  (in norm3)
-@
-text
-@d590 1
-@
-
-
-1.107
-log
-@removed ap_getdats.f
-@
-text
-@a557 1
- $(LIB)(nrms.o) \
-@
-
-
-1.106
-log
-@removed ap_getdat.f
-@
-text
-@a52 1
- $(LIB)(ap_getdats.o) \
-@
-
-
-1.105
-log
-@removed dsgrs.f
-@
-text
-@a52 1
- $(LIB)(ap_getdat.o)  \
-@
-
-
-1.104
-log
-@removed sorti from voda
-@
-text
-@a248 1
- $(LIB)(dsgrs.o) \
-@
-
-
-1.103
-log
-@returned prepcub_s
-@
-text
-@d758 1
-a758 1
- $(LIB)(secnds.o) \
-d765 1
-a765 1
- $(LIB)(setlab.o) \
-d768 1
-a768 1
- $(LIB)(setprm.o) \
-d774 1
-a774 1
- $(LIB)(sgraf.o) \
-d776 1
-a776 1
- $(LIB)(shelk.o) \
-d795 2
-a796 2
- $(LIB)(slice.o) \
- $(LIB)(smt3.o) \
-d798 2
-a799 2
- $(LIB)(snrb.o) \
- $(LIB)(snrf.o) \
-d801 5
-a805 4
- $(LIB)(solve.o) \
- $(LIB)(sort.o) \
- $(LIB)(sortint.o) \
- $(LIB)(sortz.o) \
-d807 2
-a808 2
- $(LIB)(spca3.o) \
- $(LIB)(speak.o) \
-d816 2
-a817 2
- $(LIB)(ssnrb.o) \
- $(LIB)(ssnr3.o) \
-@
-
-
-1.102
-log
-@prepcub, pj3q ... removals
-@
-text
-@d615 1
-@
-
-
-1.101
-log
-@REMOVED 'PJ 3O' & 'PJ 3QO'
-@
-text
-@d614 1
-a614 3
- $(LIB)(prepcub_q.o) \
- $(LIB)(prepcub_q_n.o) \
- $(LIB)(prepcub_s.o) \
-d905 8
-a912 8
- $(LIB)(vomq.o) \
- $(LIB)(vora.o) \
- $(LIB)(vota.o) \
- $(LIB)(vprop.o) \
- $(LIB)(vtil2.o) \
- $(LIB)(vtil3.o) \
- $(LIB)(warp3.o) \
- $(LIB)(wate.o) \
-d914 1
-a914 1
- $(LIB)(watershd.o) \
-d916 2
-a917 2
- $(LIB)(wgbp2.o) \
- $(LIB)(winave.o) \
-d919 2
-a920 2
- $(LIB)(window.o) \
- $(LIB)(bp3f.o) \
-a925 1
- $(LIB)(wpro.o) \
-a929 1
- $(LIB)(writpro.o) \
-@
-
-
-1.100
-log
-@removed rdfc
-@
-text
-@a592 1
- $(LIB)(pj3.o) \
-a594 1
- $(LIB)(pj3q.o) \
-@
-
-
-1.99
-log
-@onelinem & onelinedel put in var3d
-@
-text
-@a671 1
- $(LIB)(rdfc.o) \
-@
-
-
-1.98
-log
-@fbs3.f
-@
-text
-@a564 2
- $(LIB)(onelinem.o) \
- $(LIB)(onelinedel.o) \
-@
-
-
-1.97
-log
-@rotates..
-@
-text
-@d273 1
-d736 1
-@
-
-
-1.96
-log
-@removed rot3.f
-@
-text
-@d727 2
-a728 2
- $(LIB)(rmrepl.o) \
- $(LIB)(rmreset.o) \
-d730 6
-a735 2
- $(LIB)(rmz_p.o) \
- $(LIB)(rot2qs.o) \
-@
-
-
-1.95
-log
-@removed *fbp* added interp_fbs3
-@
-text
-@a731 1
- $(LIB)(rot3.o) \
-@
-
-
-1.94
-log
-@apshift_fou added
-@
-text
-@a34 1
- $(LIB)(alrq_ms_fbp.o) \
-a272 1
- $(LIB)(fbp_fast.o) \
-d420 1
-a420 1
- $(LIB)(interp_fbp.o) \
-@
-
-
-1.93
-log
-@aprings_pws
-@
-text
-@d49 1
-@
-
-
-1.92
-log
-@apfou_p.o added
-@
-text
-@d66 1
-@
-
-
-1.91
-log
-@added makepws, ap_getdata, alrq_ms_quad renamed from _new
-@
-text
-@d50 1
-@
-
-
-1.90
-log
-@ccrs_ph_3 added
-@
-text
-@d34 1
-a34 1
- $(LIB)(alrq_ms_new.o) \
-d51 1
-d456 1
-@
-
-
-1.89
-log
-@interp_fbs missing
-@
-text
-@d132 1
-@
-
-
-1.88
-log
-@added fbs_fast
-@
-text
-@d418 1
-@
-
-
-1.87
-log
-@added fbp_fast
-@
-text
-@d36 1
-d270 1
-@
-
-
-1.86
-log
-@interp_fbp.o
-@
-text
-@d8 2
-a9 2
- $(LIB)(spider.o) \
- $(LIB)(openinln.o) \
-d11 1
-a11 1
- $(LIB)(fftw3.o) \
-d14 1
-a14 1
- $(LIB)(acrs_2.o) \
-d16 1
-a16 1
- $(LIB)(acrs_3.o) \
-d21 3
-a23 3
- $(LIB)(adds.o) \
- $(LIB)(af.o) \
- $(LIB)(afs.o) \
-d25 1
-a25 1
- $(LIB)(al10.o) \
-d31 2
-a32 2
- $(LIB)(alrq.o) \
- $(LIB)(alrqs.o) \
-d34 2
-a35 1
- $(LIB)(alrq_ms.o) \
-d38 2
-a39 2
- $(LIB)(ang.o) \
- $(LIB)(ang_n.o) \
-d41 1
-a41 1
- $(LIB)(aniso.o) \
-d44 4
-a47 4
- $(LIB)(anisof3.o) \
- $(LIB)(apcc.o) \
- $(LIB)(apscc.o) \
- $(LIB)(apshift.o) \
-d49 2
-a50 2
- $(LIB)(ap_getangas.o) \
- $(LIB)(ap_getdat.o) \
-d52 1
-a52 1
- $(LIB)(apref_p.o) \
-d54 1
-a54 1
- $(LIB)(apsh_cuda.o) \
-d56 3
-a58 3
- $(LIB)(apsh_ps.o) \
- $(LIB)(apsh_ss.o) \
- $(LIB)(ap_stat.o) \
-d261 2
-a262 2
- $(LIB)(errt.o) \
- $(LIB)(evalnq.o) \
-d265 6
-a270 5
- $(LIB)(exprq.o) \
- $(LIB)(falb.o) \
- $(LIB)(fallg.o) \
- $(LIB)(fcnq.o) \
- $(LIB)(fermp.o) \
-d277 1
-a277 1
- $(LIB)(fhodt.o) \
-@
-
-
-1.85
-log
-@rtksq --> rtsf
-@
-text
-@d413 1
-a413 1
- $(LIB)(interp_fbs.o) \
-@
-
-
-1.84
-log
-@added 'RTK SQ' and 'FT FS' routines
-@
-text
-@d735 1
-a735 1
- $(LIB)(rtksq.o) \
-@
-
-
-1.83
-log
-@reps --> bprp
-@
-text
-@d413 1
-d735 1
-@
-
-
-1.82
-log
-@returned onelinem.f code for var3d
-@
-text
-@d104 1
-a702 1
- $(LIB)(reps.o) \
-@
-
-
-1.81
-log
-@var3d not var3q
-@
-text
-@d553 1
-@
-
-
-1.80
-log
-@var3r & var3q
-@
-text
-@d883 1
-a883 1
- $(LIB)(var3q.o) \
-@
-
-
-1.79
-log
-@added meanshift
-@
-text
-@d880 1
-a880 1
- $(LIB)(varf.o) \
-d882 2
-d887 1
-a887 1
- $(LIB)(vms.o) \
-d889 6
-a894 6
- $(LIB)(voda.o) \
- $(LIB)(voea.o) \
- $(LIB)(vonea.o) \
- $(LIB)(voept.o) \
- $(LIB)(voia.o) \
- $(LIB)(vomd.o) \
-@
-
-
-1.78
-log
-@make_close_list
-@
-text
-@d464 1
-@
-
-
-1.77
-log
-@ap_getangas.f,v  -->  ap_getangas.f
-@
-text
-@d447 1
-@
-
-
-1.76
-log
-@apsh_tool.f,v  -->  apsh_tool.f
-@
-text
-@d48 1
-a48 1
- $(LIB)(ap_getanga.o) \
-@
-
-
-1.75
-log
-@ap_ref and ap_sh renamed
-@
-text
-@d13 1
-a13 1
- $(LIB)(ap_sh_tool.o) \
-@
-
-
-1.74
-log
-@removed ssnr.f
-@
-text
-@d51 6
-a56 4
- $(LIB)(ap_ref_p.o) \
- $(LIB)(ap_ref_pm.o) \
- $(LIB)(ap_sh_ps.o) \
- $(LIB)(ap_sh_ss.o) \
-a241 2
- $(LIB)(ap_ref_p.o) \
- $(LIB)(ap_ref_pm.o) \
-a516 4
- $(LIB)(ap_sh_cuda.o) \
- $(LIB)(ap_sh_ps.o) \
- $(LIB)(ap_sh_psc.o) \
- $(LIB)(ap_sh_ss.o) \
-@
-
-
-1.73
-log
-@ap_
-@
-text
-@a805 1
- $(LIB)(ssnr.o) \
-@
-
-
-1.72
-log
-@renamed mrqli & dsgr
-@
-text
-@d13 1
-a13 1
- $(LIB)(apsh_tool.o) \
-d520 1
-a520 1
- $(LIB)(apsh_ss.o) \
-@
-
-
-1.71
-log
-@docsub
-@
-text
-@d240 2
-a241 2
- $(LIB)(dsgr_p.o) \
- $(LIB)(dsgr_pm.o) \
-d517 4
-a520 4
- $(LIB)(mrqli_cuda.o) \
- $(LIB)(mrqli_ps.o) \
- $(LIB)(mrqli_psc.o) \
- $(LIB)(mrqli_ss.o) \
-@
-
-
-1.70
-log
-@ap_sh_.... renames
-@
-text
-@d231 1
-@
-
-
-1.69
-log
-@mrqli_tool --> apsh_tool
-@
-text
-@d51 4
-@
-
-
-1.68
-log
-@removed rotqs.o
-@
-text
-@d13 1
-a13 1
- $(LIB)(mrqli_tool.o) \
-@
-
-
-1.67
-log
-@repcg --> bpcg
-@
-text
-@a725 1
- $(LIB)(rotqs.o) \
-@
-
-
-1.66
-log
-@rename wiw??d > bp??f
-@
-text
-@d695 1
-a695 1
- $(LIB)(repcg.o) \
-@
-
-
-1.65
-log
-@added interps.f
-@
-text
-@d907 2
-a908 2
- $(LIB)(wiw3d.o) \
- $(LIB)(wiw3d_old.o) \
-d910 2
-a911 2
- $(LIB)(wiw32d.o) \
- $(LIB)(wiw32d_old.o) \
-@
-
-
-1.64
-log
-@sizck,xmipp, util7 added
-@
-text
-@d405 1
-@
-
-
-1.63
-log
-@removed totrec.f
-@
-text
-@d779 1
-d877 1
-d927 4
-a930 1
- $(LIB)(wtm.o)
-@
-
-
-1.62
-log
-@removed unixtovv.f
-@
-text
-@a843 1
- $(LIB)(totrec.o) \
-@
-
-
-1.61
-log
-@sethead.o added
-@
-text
-@a862 1
- $(LIB)(unixtovv.o) \
-@
-
-
-1.60
-log
-@removed shr.o
-@
-text
-@d750 1
-@
-
-
-1.59
-log
-@onelinem unused
-@
-text
-@a774 1
- $(LIB)(shr.o) \
-@
-
-
-1.58
-log
-@removed listregs
-@
-text
-@a549 1
- $(LIB)(onelinem.o) \
-@
-
-
-1.57
-log
-@mjc mls mulf2 mulf3 mulfc3 mulfi3 nfq ngq removed
-@
-text
-@a428 1
- $(LIB)(listregs.o) \
-@
-
-
-1.56
-log
-@removed sortdoc
-@
-text
-@a461 1
- $(LIB)(mjc.o) \
-a464 1
- $(LIB)(mls.o) \
-a519 4
- $(LIB)(mulf2.o) \
- $(LIB)(mulf3.o) \
- $(LIB)(mulfc3.o) \
- $(LIB)(mulfi3.o) \
-a534 2
- $(LIB)(nfq.o) \
- $(LIB)(ngq.o) \
-a546 2
- $(LIB)(nrq.o) \
- $(LIB)(nt32.o) \
-d655 1
-@
-
-
-1.55
-log
-@removed dorings.f
-@
-text
-@a798 1
- $(LIB)(sortdoc.o) \
-@
-
-
-1.54
-log
-@_tool must be early for module
-@
-text
-@a229 1
- $(LIB)(dorings.o) \
-d612 1
-@
-
-
-1.53
-log
-@added APMASTER_TOOL
-@
-text
-@d13 1
-a518 1
- $(LIB)(mrqli_tool.o) \
-@
-
-
-1.52
-log
-@dorings & mrqli_tool
-@
-text
-@d53 1
-@
-
-
-1.51
-log
-@dsfs_p.o removed
-@
-text
-@d228 1
-d517 1
-@
-
-
-1.50
-log
-@added spider.o
-@
-text
-@a232 1
- $(LIB)(dsfs_p.o) \
-@
-
-
-1.49
-log
-@aprings_trans added, aprings_coeft renamed to: aprings_coef
-@
-text
-@d8 1
-@
-
-
-1.48
-log
-@mrqli_cuda added
-@
-text
-@d53 2
-a54 1
- $(LIB)(aprings_coeft.o) \
-@
-
-
-1.47
-log
-@removed f3mr.f (unused)
-@
-text
-@d511 1
-@
-
-
-1.46
-log
-@crosrng_com <-- crosrng_e
-@
-text
-@a255 1
- $(LIB)(f3mr.o) \
-@
-
-
-1.45
-log
-@crosrng_2,.
-@
-text
-@d182 1
-a182 1
- $(LIB)(crosrng_e.o) \
-@
-
-
-1.44
-log
-@removed mhelp
-@
-text
-@d53 1
-d133 1
-d179 2
-d513 1
-@
-
-
-1.43
-log
-@removed arbre.f & dendro2.f
-@
-text
-@a454 2
- $(LIB)(mhelp.o) \
- $(LIB)(mhelp_sub.o) \
-@
-
-
-1.42
-log
-@maxmindoc
-@
-text
-@a55 1
- $(LIB)(arbre.o) \
-a199 1
- $(LIB)(dendro2.o) \
-@
-
-
-1.41
-log
-@maxmindoc
-@
-text
-@a448 1
- $(LIB)(maxmindoc.o) \
-@
-
-
-1.40
-log
-@removed spitosgi.f
-@
-text
-@d449 1
-@
-
-
-1.39
-log
-@added inquirehead
-@
-text
-@a804 1
- $(LIB)(spitosgi.o) \
-@
-
-
-1.38
-log
-@removed var3d var3disk var3c var3r buggy no man
-@
-text
-@d394 1
-@
-
-
-1.37
-log
-@ccfn and ccrs_3 removed
-@
-text
-@a884 4
- $(LIB)(var3c.o) \
- $(LIB)(var3d.o) \
- $(LIB)(var3disk.o) \
- $(LIB)(var3r.o) \
-@
-
-
-1.36
-log
-@copypds.f removed
-@
-text
-@a110 1
- $(LIB)(ccfn.o) \
-a118 1
- $(LIB)(ccrs_3.o) \
-@
-
-
-1.35
-log
-@*** empty log message ***
-@
-text
-@a163 1
- $(LIB)(copypds.o) \
-@
-
-
-1.34
-log
-@removed rtqs.f
-@
-text
-@d898 1
-@
-
-
-1.33
-log
-@mpi.o
-@
-text
-@a739 1
- $(LIB)(rtqs.o) \
-@
-
-
-1.32
-log
-@*** empty log message ***
-@
-text
-@d475 1
-@
-
-
-1.31
-log
-@*** empty log message ***
-@
-text
-@d923 1
-@
-
-
-1.30
-log
-@*** empty log message ***
-@
-text
-@d920 1
-@
-
-
-1.29
-log
-@*** empty log message ***
-@
-text
-@d471 4
-d692 1
-@
-
-
-1.28
-log
-@mrcenti.f unused
-@
-text
-@d2 4
-a5 4
-# ------ Lists SPIDER object files for use by Makefile  ------
-#        As of Aug 2005 this is the definitive source for
-#        objects (and thus source files) compiled into SPIDER
-#        src.txt is no longer in use for any purpose
-d10 1
-a10 1
- $(LIB)(fmrs_fftw3.o) \
-d42 2
-d118 1
-@
-
-
-1.27
-log
-@removed ccrs_ph..
-@
-text
-@a473 1
- $(LIB)(mrcenti.o) \
-@
-
-
-1.26
-log
-@fmrs.f
-@
-text
-@a113 2
- $(LIB)(ccrd_ph_2.o) \
- $(LIB)(ccrd_ph_3.o) \
-a117 2
- $(LIB)(ccrs_ph_2.o) \
- $(LIB)(ccrs_ph_3.o) \
-@
-
-
-1.25
-log
-@added fmrs_fftw3
-@
-text
-@d10 1
-d305 1
-a305 1
- $(LIB)(fmrs_fftw3.o) \
-@
-
-
-1.24
-log
-@pj3g, wiw3g, fillbessi0 added
-@
-text
-@d304 1
-@
-
-
-1.23
-log
-@opfiles.f
-@
-text
-@a256 2
- $(LIB)(extractplane.o) \
- $(LIB)(extractline.o) \
-d270 1
-d584 1
-a621 1
- $(LIB)(putline3.o) \
-d915 1
-@
-
-
-1.22
-log
-@rotqss.f
-@
-text
-@d563 1
-@
-
-
-1.21
-log
-@*** empty log message ***
-@
-text
-@d728 1
-@
-
-
-1.20
-log
-@hi_1d gone
-@
-text
-@d616 1
-d894 1
-@
-
-
-1.19
-log
-@*** empty log message ***
-@
-text
-@a372 1
- $(LIB)(hi_1d.o) \
-@
-
-
-1.18
-log
-@*** empty log message ***
-@
-text
-@d838 1
-@
-
-
-1.17
-log
-@indextoreg.f no longer used
-@
-text
-@d794 1
-@
-
-
-1.16
-log
-@rdpraf.f
-@
-text
-@a391 1
- $(LIB)(indextoreg.o) \
-@
-
-
-1.15
-log
-@add
-@
-text
-@a664 1
- $(LIB)(rdpraf.o) \
-@
-
-
-1.14
-log
-@rdpra.f
-@
-text
-@a664 1
- $(LIB)(rdpras.o) \
-@
-
-
-1.13
-log
-@rdpra.f
-@
-text
-@d664 1
-@
-
-
-1.12
-log
-@rdprop.f
-@
-text
-@d664 1
-@
-
-
-1.11
-log
-@deleted bank space
-@
-text
-@d678 1
-@
-
-
-1.10
-log
-@added trafsim.o
-@
-text
-@d853 1
-a853 1
- $(LIB)(trafsim.o) \ 
-@
-
-
-1.9
-log
-@reversegrid
-@
-text
-@d853 1
-@
-
-
-1.8
-log
-@*** empty log message ***
-@
-text
-@a701 2
- $(LIB)(reversegrid32.o) \
- $(LIB)(reversegrid.o) \
-@
-
-
-1.7
-log
-@*** empty log message ***
-@
-text
-@a149 1
- $(LIB)(convl.o) \
-a269 2
- $(LIB)(fh.o) \
- $(LIB)(fht.o) \
-a378 1
- $(LIB)(histc.o) \
-@
-
-
-1.6
-log
-@now under cvs
-@
-text
-@d2 4
-a5 3
-# 
-# ------ Lists SPIDER source files for use by Makefile  ------
-# 
-@
-
-
-1.5
-log
-@not in cvs
-@
-text
-@d69 1
-d257 2
-d625 1
-d705 2
-a734 1
- $(LIB)(rout.o) \
-d811 1
-@
-
-
-1.4
-log
-@*** empty log message ***
-@
-text
-@@
-
-
-1.3
-log
-@*** empty log message ***
-@
-text
-@d799 1
-@
-
-
-1.2
-log
-@*** empty log message ***
-@
-text
-@d45 1
-d160 1
-a161 1
- $(LIB)(copyfsimple.o) \
-d460 1
-d556 2
-d826 1
-d877 1
-d879 2
-@
-
-
-1.1
-log
-@needec
-@
-text
-@d892 1
-@
-
diff --git src/Makefile_samples/RCS/Makefile2,v src/Makefile_samples/RCS/Makefile2,v
deleted file mode 100644
index 559eb452..00000000
--- src/Makefile_samples/RCS/Makefile2,v
+++ /dev/null
@@ -1,275 +0,0 @@
-head	1.11;
-access;
-symbols
-	best-code:1.10
-	x-named-regs:1.10
-	x:1.10
-	v13-00:1.10
-	pre_GPL:1.10
-	prec_CA:1.10
-	noindx:1.10
-	Bproc:1.9
-	oct21:1.8
-	last77:1.7;
-locks; strict;
-comment	@# @;
-
-
-1.11
-date	2006.07.31.15.15.48;	author leith;	state dead;
-branches;
-next	1.10;
-
-1.10
-date	2002.06.05.20.15.36;	author leith;	state Exp;
-branches;
-next	1.9;
-
-1.9
-date	2000.04.18.20.28.38;	author leith;	state Exp;
-branches;
-next	1.8;
-
-1.8
-date	99.06.03.15.56.28;	author leith;	state Exp;
-branches;
-next	1.7;
-
-1.7
-date	99.03.29.15.01.26;	author leith;	state Exp;
-branches;
-next	1.6;
-
-1.6
-date	99.03.29.14.58.48;	author leith;	state Exp;
-branches;
-next	1.5;
-
-1.5
-date	99.03.19.15.39.16;	author leith;	state Exp;
-branches;
-next	1.4;
-
-1.4
-date	98.03.03.16.20.23;	author leith;	state Exp;
-branches;
-next	1.3;
-
-1.3
-date	98.02.12.14.56.42;	author leith;	state Exp;
-branches;
-next	1.2;
-
-1.2
-date	97.07.29.16.00.13;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	97.07.23.19.11.39;	author pawel;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.11
-log
-@obsolete
-@
-text
-@# 
-#  MAKEFILE FOR SGI SPIDER ------ spider2 (old spider5)
-#  (can not compile spider2 with f90 on sgi as compiler does not work)
-#
-#  ArDean Leith -- 11 MAY 1994
-#
-#  creates executable for: 
-#  processor      Irix versions  
-#  ---------    ---------------------------------------
-#   R4***      5.2, 5.3, & 6.2 (sub-optimal on Irix 6.2)
-#   R5000      5.3  6.2        (sub-optimal on Irix 6.2)
-#   R8000      6.0, 6.1, & 6.2 (sub-optimal)
-#   R10000     6.2             (sub-optimal)
-# 
-# Note:    You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
-#
- 
-SHELL  = /bin/sh
-
-COMP   = f77
-
-PGM    = spider
-
-EXE    = spider2$(SUFFIX)
-
-FFLAGS   = -mips2 -32 -O2 -old_rl $(QFFLAGS) -c
-
-LF       = -mips2 -32 $(QLFLAGS)
-
-LIB      = $(EXE).a
- 
-AFLAGS   = r
-
-.PRECIOUS :   $(LIB) ../bin/$(EXE)
- 
-include Makefile.inc
-
-include Makebody.inc 
-
-
-
-  
-  
-@
-
-
-1.10
-log
-@*** empty log message ***
-@
-text
-@@
-
-
-1.9
-log
-@SP_UNIX cpp variable no longer needed.
-@
-text
-@d18 8
-d30 1
-a30 3
-PGM      = spider2$(SUFFIX)
-
-LIB      = $(PGM).a
-a31 2
-SHELL    = /bin/sh
-
-d34 1
-a34 1
-.PRECIOUS :   $(LIB) ../bin/$(PGM)
-d38 1
-a38 1
-# include Makebody.inc (can not use as it is for F90 now)
-a39 13
-../bin/$(PGM) : $(PGM).o $(LIB)
-	f77 $(LF) $(PGM).o $(LIB) $(LINKLIBS) -o ../bin/$(PGM)_tmp 
-	@@chmod ug+w ../bin/$(PGM)_tmp
-
-$(PGM).o  : spider.f
-	f77 $(FFLAGS) -o $(PGM).o  spider.f 
-  
-$(LIB) : $(ELEMENTS)
-	@@echo "        linking $(PGM) now for F77 ----"
-.f.a:
-	f77 $(FFLAGS) $<
-	$(AR) $(AFLAGS) $(LIB) $*.o
-	@@\rm $*.o
-@
-
-
-1.8
-log
-@makes _tmp file now not Nextversion
-@
-text
-@d18 1
-a18 1
-FFLAGS   = -DSP_UNIX -mips2 -32 -O2 -old_rl $(QFFLAGS) -c
-@
-
-
-1.7
-log
-@put Makebody.inc inside for f77 use
-@
-text
-@a38 2
-	@@echo "Creating: `Nextversion ../bin/$(PGM)`"
-	@@\mv ../bin/$(PGM)_tmp ../bin/`Nextversion ../bin/$(PGM)`
-@
-
-
-1.6
-log
-@added note about f90
-@
-text
-@d34 17
-a50 1
-include Makebody.inc
-@
-
-
-1.5
-log
-@removed SP_ALLOC
-@
-text
-@d3 2
-a4 1
-# 
-@
-
-
-1.4
-log
-@moved libfft selector to respective makefiles
-@
-text
-@d17 1
-a17 1
-FFLAGS   = -DSP_UNIX -DSP_ALLOC -mips2 -32 -O2 -old_rl $(QFFLAGS) -c
-@
-
-
-1.3
-log
-@ignore qflags message
-@
-text
-@d14 1
-a14 1
-# Note:    You may ignore any undefined QFFLAGS or QLFLAGS
-d17 1
-a17 1
-FFLAGS   = -DSP_UNIX -DSP_ALLOC $(BFLAGS) -mips2 -32 -O2 -old_rl $(QFFLAGS) -c
-@
-
-
-1.2
-log
-@*** empty log message ***
-@
-text
-@d13 3
-@
-
-
-1.1
-log
-@Initial revision
-@
-text
-@d14 1
-a14 1
-FFLAGS = -DSP_UNIX -DSP_ALLOC -mips2 -32 -O2 -old_rl $(QFFLAGS) -c
-d16 1
-a16 1
-LF     = -mips2 -32 $(QLFLAGS)
-d18 1
-a18 1
-PGM    = spider2$(SUFFIX)
-d20 1
-a20 1
-LIB    = $(PGM).a
-d22 1
-a22 1
-SHELL  = /bin/sh
-d24 1
-a24 1
-AFLAGS = r
-@
diff --git src/Makefile_samples/RCS/Makefile3,v src/Makefile_samples/RCS/Makefile3,v
deleted file mode 100644
index 817d634f..00000000
--- src/Makefile_samples/RCS/Makefile3,v
+++ /dev/null
@@ -1,313 +0,0 @@
-head	1.14;
-access;
-symbols
-	pre_fftwrings:1.13
-	pre_opfiles:1.13
-	src:1.13
-	best-code:1.13
-	x-named-regs:1.13
-	x:1.13
-	v13-00:1.13
-	pre_GPL:1.13
-	prec_CA:1.13
-	noindx:1.13
-	Bproc:1.11
-	oct21:1.9
-	last77:1.9;
-locks; strict;
-comment	@# @;
-
-
-1.14
-date	2009.04.17.15.23.23;	author leith;	state dead;
-branches;
-next	1.13;
-
-1.13
-date	2002.06.14.16.32.45;	author leith;	state Exp;
-branches;
-next	1.12;
-
-1.12
-date	2002.06.05.20.15.36;	author leith;	state Exp;
-branches;
-next	1.11;
-
-1.11
-date	2000.04.24.20.35.51;	author leith;	state Exp;
-branches;
-next	1.10;
-
-1.10
-date	2000.04.18.20.23.54;	author leith;	state Exp;
-branches;
-next	1.9;
-
-1.9
-date	99.03.29.15.16.38;	author leith;	state Exp;
-branches;
-next	1.8;
-
-1.8
-date	99.03.19.15.39.27;	author leith;	state Exp;
-branches;
-next	1.7;
-
-1.7
-date	98.03.03.16.20.31;	author leith;	state Exp;
-branches;
-next	1.6;
-
-1.6
-date	98.02.12.14.56.50;	author leith;	state Exp;
-branches;
-next	1.5;
-
-1.5
-date	98.02.03.18.18.47;	author pawel;	state Exp;
-branches;
-next	1.4;
-
-1.4
-date	98.01.15.20.43.19;	author pawel;	state Exp;
-branches;
-next	1.3;
-
-1.3
-date	98.01.15.16.24.57;	author leith;	state Exp;
-branches;
-next	1.2;
-
-1.2
-date	97.07.29.16.17.59;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	97.07.23.19.11.58;	author pawel;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.14
-log
-@obsolete SGI
-@
-text
-@# 
-#  MAKEFILE FOR SGI SPIDER -- Makefile3
-# 
-#  ArDean Leith -- 11 MAY 1994
-#
-#  creates executable for:  
-#  processor      Irix versions              # of processors
-#  ---------    ------------------------    ---------------
-#   R4***      6.2                           >= 1
-#   R5000      6.2       (sub-optimal)       >= 1
-#   R8000      6.1 & 6.2 (sub-optimal)       >= 1
-#   R10000     6.2       (sub-optimal)       >= 1
-#
-# 
-# Note:    You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
-#
-#    
-SHELL  = /bin/sh
-
-COMP   = f90
-
-PGM    = spider
-
-EXE    = spider3$(SUFFIX)
-
-FFLAGS = -cpp -DSP_LIBFFT -OPT:Olimit=2500 -mips3 -n32 -O3 -bytereclen $(QFFLAGS) -c   
-
-LF     = -mips3 -n32 $(QLFLAGS) 
-
-LINKLIBS = -lcomplib.sgimath
-
-LIB    = $(EXE).a
- 
-AFLAGS = r
-
-.PRECIOUS :   $(LIB) ../bin/$(EXE)
- 
-include Makefile.inc
- 
-include Makebody.inc
- 
-@
-
-
-1.13
-log
-@*** empty log message ***
-@
-text
-@@
-
-
-1.12
-log
-@*** empty log message ***
-@
-text
-@d26 1
-a26 1
-FLAGS = -cpp -DSP_LIBFFT -OPT:Olimit=2500 -mips3 -n32 -O3 -bytereclen $(QFFLAGS) -c   
-@
-
-
-1.11
-log
-@removd -DSP_F90
-@
-text
-@d20 1
-a20 3
-#-multigot stopped compiling jan 90 al
-#FFLAGS = -DSP_LIBFFT -mips3 -n32 -O2 -bytereclen $(QFFLAGS) -c   
-#LF     = -mips3 -n32 -multigot $(QLFLAGS) 
-d22 1
-a22 1
-FFLAGS = -cpp -DSP_LIBFFT -OPT:Olimit=2500 -mips3 -n32 -O3 -bytereclen $(QFFLAGS) -c   
-d24 4
-d32 1
-a32 3
-PGM    = spider3$(SUFFIX)
-
-LIB    = $(PGM).a
-d36 1
-a36 1
-.PRECIOUS :   $(LIB) ../bin/$(PGM)
-@
-
-
-1.10
-log
-@removed SP_UNIX
-@
-text
-@d24 1
-a24 1
-FFLAGS = -cpp -DSP_F90 -DSP_LIBFFT -OPT:Olimit=2500 -mips3 -n32 -O3 -bytereclen $(QFFLAGS) -c   
-@
-
-
-1.9
-log
-@for f90
-@
-text
-@d21 1
-a21 1
-#FFLAGS = -DSP_UNIX -DSP_LIBFFT -mips3 -n32 -O2 -bytereclen $(QFFLAGS) -c   
-d24 1
-a24 1
-FFLAGS = -cpp -DSP_F90 -DSP_UNIX -DSP_LIBFFT -OPT:Olimit=2500 -mips3 -n32 -O3 -bytereclen $(QFFLAGS) -c   
-@
-
-
-1.8
-log
-@removed SP_ALLOC
-@
-text
-@d24 1
-a24 1
-FFLAGS = -DSP_UNIX -DSP_LIBFFT -mips3 -n32 -O3 -bytereclen $(QFFLAGS) -c   
-@
-
-
-1.7
-log
-@moved libfft selector to respective makefiles
-@
-text
-@d21 1
-a21 1
-#FFLAGS = -DSP_UNIX -DSP_ALLOC -DSP_LIBFFT -mips3 -n32 -O2 -bytereclen $(QFFLAGS) -c   
-d24 1
-a24 1
-FFLAGS = -DSP_UNIX -DSP_ALLOC -DSP_LIBFFT -mips3 -n32 -O3 -bytereclen $(QFFLAGS) -c   
-@
-
-
-1.6
-log
-@ignore qflags message
-@
-text
-@d15 1
-a15 1
-# Note:    You may ignore any undefined QFFLAGS or QLFLAGS
-d21 1
-a21 1
-#FFLAGS = -DSP_UNIX -DSP_ALLOC $(BFLAGS) -mips3 -n32 -O2 -bytereclen $(QFFLAGS) -c   
-d24 1
-a24 1
-FFLAGS = -DSP_UNIX -DSP_ALLOC $(BFLAGS) -mips3 -n32 -O3 -bytereclen $(QFFLAGS) -c   
-d27 2
-@
-
-
-1.5
-log
-@no xgot for #3
-@
-text
-@d14 3
-@
-
-
-1.4
-log
-@O3 for #3
-@
-text
-@d21 1
-a21 1
-FFLAGS = -DSP_UNIX -DSP_ALLOC $(BFLAGS) -xgot -mips3 -n32 -O3 -bytereclen $(QFFLAGS) -c   
-d23 1
-a23 1
-LF     = -mips3 -n32 -xgot $(QLFLAGS) 
-@
-
-
-1.3
-log
-@removed multigot
-@
-text
-@d21 1
-a21 1
-FFLAGS = -DSP_UNIX -DSP_ALLOC $(BFLAGS) -xgot -mips3 -n32 -O2 -bytereclen $(QFFLAGS) -c   
-@
-
-
-1.2
-log
-@*** empty log message ***
-@
-text
-@d17 3
-a19 1
-FFLAGS = -DSP_UNIX -DSP_ALLOC $(BFLAGS) -mips3 -n32 -O2 -bytereclen $(QFFLAGS) -c   
-d21 3
-a23 1
-LF     = -mips3 -n32 -multigot $(QLFLAGS) 
-@
-
-
-1.1
-log
-@Initial revision
-@
-text
-@d17 1
-a17 1
-FFLAGS = -DSP_UNIX -DSP_ALLOC -mips3 -n32 -O2 -bytereclen $(QFFLAGS) -c   
-@
diff --git src/Makefile_samples/RCS/Makefile4,v src/Makefile_samples/RCS/Makefile4,v
deleted file mode 100644
index 96989f44..00000000
--- src/Makefile_samples/RCS/Makefile4,v
+++ /dev/null
@@ -1,418 +0,0 @@
-head	1.19;
-access;
-symbols
-	pre_fftwrings:1.18
-	pre_opfiles:1.18
-	src:1.18
-	best-code:1.18
-	x-named-regs:1.18
-	x:1.18
-	v13-00:1.18
-	pre_GPL:1.18
-	prec_CA:1.17
-	noindx:1.17
-	Bproc:1.16
-	oct21:1.14
-	last77:1.14;
-locks; strict;
-
-
-1.19
-date	2009.04.17.15.23.30;	author leith;	state dead;
-branches;
-next	1.18;
-
-1.18
-date	2004.05.12.19.02.34;	author leith;	state Exp;
-branches;
-next	1.17;
-
-1.17
-date	2002.06.05.20.15.38;	author leith;	state Exp;
-branches;
-next	1.16;
-
-1.16
-date	2000.04.24.20.36.10;	author leith;	state Exp;
-branches;
-next	1.15;
-
-1.15
-date	2000.04.18.20.23.46;	author leith;	state Exp;
-branches;
-next	1.14;
-
-1.14
-date	99.03.29.15.53.23;	author leith;	state Exp;
-branches;
-next	1.13;
-
-1.13
-date	99.03.29.15.16.43;	author leith;	state Exp;
-branches;
-next	1.12;
-
-1.12
-date	99.03.19.15.39.33;	author leith;	state Exp;
-branches;
-next	1.11;
-
-1.11
-date	98.03.03.16.20.34;	author leith;	state Exp;
-branches;
-next	1.10;
-
-1.10
-date	98.02.12.14.56.57;	author leith;	state Exp;
-branches;
-next	1.9;
-
-1.9
-date	98.01.30.14.56.42;	author pawel;	state Exp;
-branches;
-next	1.8;
-
-1.8
-date	98.01.23.16.01.18;	author leith;	state Exp;
-branches;
-next	1.7;
-
-1.7
-date	98.01.23.15.57.28;	author leith;	state Exp;
-branches;
-next	1.6;
-
-1.6
-date	97.07.29.16.18.01;	author leith;	state Exp;
-branches;
-next	1.5;
-
-1.5
-date	97.07.23.19.09.14;	author pawel;	state Exp;
-branches;
-next	1.4;
-
-1.4
-date	95.08.09.14.09.49;	author leith;	state Exp;
-branches;
-next	1.3;
-
-1.3
-date	95.03.06.12.39.27;	author leith;	state Exp;
-branches;
-next	1.2;
-
-1.2
-date	95.02.01.10.46.20;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	95.01.27.15.03.01;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@for irix 4.0.5
-@
-
-
-1.19
-log
-@obsolete SGI
-@
-text
-@# 
-#  MAKEFILE FOR SGI SPIDER -- Makefile4
-# 
-#  ArDean Leith -- 3 Mar. 1997
-#
-#  creates executable for:  
-#  processor      Irix versions           # processors
-#  ---------    ---------------           --------------------
-#   R5000      6.2                        >= 1 (no parallel code)
-#   R8000      6.1 & 6.2                  >= 1 (no parallel code)
-#   R10000     6.2                        >= 1 (no parallel code)
-# 
-# Note:    You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
-#
- 
-SHELL  = /bin/sh
-
-SHELL  = /bin/sh
-
-COMP   = f90
-
-PGM    = spider
-
-EXE    = spider4$(SUFFIX)
-
-FFLAGS = -cpp -DSP_LIBFFT -DSP_LAPACK -OPT:Olimit=2500 -mips4 -n32 -O3 -bytereclen $(QFFLAGS) -c   
-
-LF     = -mips4 -n32 -multigot $(QLFLAGS)  
-
-LINKLIBS = -lcomplib.sgimath
-
-LIB    = $(EXE).a
- 
-AFLAGS = r
-
-.PRECIOUS :   $(LIB) ../bin/$(EXE)
- 
-include Makefile.inc
- 
-include Makebody.inc
- 
-@
-
-
-1.18
-log
-@lapack
-@
-text
-@@
-
-
-1.17
-log
-@*** empty log message ***
-@
-text
-@d26 1
-a26 1
-FFLAGS = -cpp -DSP_LIBFFT -OPT:Olimit=2500 -mips4 -n32 -O3 -bytereclen $(QFFLAGS) -c   
-@
-
-
-1.16
-log
-@removd -DSP_F90
-@
-text
-@d18 8
-d32 1
-a32 3
-PGM    = spider4$(SUFFIX)
-
-LIB    = $(PGM).a
-d36 1
-a36 1
-.PRECIOUS :   $(LIB) ../bin/$(PGM)
-@
-
-
-1.15
-log
-@removed SP_UNIX
-@
-text
-@d18 1
-a18 1
-FFLAGS = -cpp -DSP_F90 -DSP_LIBFFT -OPT:Olimit=2500 -mips4 -n32 -O3 -bytereclen $(QFFLAGS) -c   
-@
-
-
-1.14
-log
-@removed SP_R8000 flag
-@
-text
-@d18 1
-a18 1
-FFLAGS = -cpp -DSP_F90 -DSP_UNIX -DSP_LIBFFT -OPT:Olimit=2500 -mips4 -n32 -O3 -bytereclen $(QFFLAGS) -c   
-@
-
-
-1.13
-log
-@f90
-@
-text
-@d18 1
-a18 1
-FFLAGS = -cpp -DSP_F90 -DSP_UNIX -DSP_R8000 -DSP_LIBFFT -OPT:Olimit=2500 -mips4 -n32 -O3 -bytereclen $(QFFLAGS) -c   
-@
-
-
-1.12
-log
-@removed SP_ALLOC
-@
-text
-@d18 1
-a18 1
-FFLAGS = -DSP_UNIX -DSP_R8000 -DSP_LIBFFT -mips4 -n32 -O3 -bytereclen $(QFFLAGS) -c   
-@
-
-
-1.11
-log
-@moved libfft selector to respective makefiles
-@
-text
-@d18 1
-a18 1
-FFLAGS = -DSP_UNIX -DSP_ALLOC -DSP_R8000 -DSP_LIBFFT -mips4 -n32 -O3 -bytereclen $(QFFLAGS) -c   
-@
-
-
-1.10
-log
-@ignore qflags message
-@
-text
-@d13 1
-a13 1
-# Note:    You may ignore any undefined QFFLAGS or QLFLAGS
-d18 1
-a18 1
-FFLAGS = -DSP_UNIX -DSP_ALLOC -DSP_R8000 $(BFLAGS) -mips4 -n32 -O3 -bytereclen $(QFFLAGS) -c   
-d22 2
-a28 1
-
-@
-
-
-1.9
-log
-@O3
-@
-text
-@d12 3
-@
-
-
-1.8
-log
-@resotored multigot
-@
-text
-@d15 1
-a15 1
-FFLAGS = -DSP_UNIX -DSP_ALLOC -DSP_R8000 $(BFLAGS) -mips4 -n32 -O2 -bytereclen $(QFFLAGS) -c   
-@
-
-
-1.7
-log
-@used xgot
-@
-text
-@d15 1
-a15 3
-# changed Jan 23 98 al 
-#FFLAGS = -DSP_UNIX -DSP_ALLOC -DSP_R8000 $(BFLAGS) -mips4 -n32 -O2 -bytereclen $(QFFLAGS) -c   
-FFLAGS = -DSP_UNIX -DSP_ALLOC -DSP_R8000 $(BFLAGS) -xgot -mips4 -n32 -O2 -bytereclen $(QFFLAGS) -c   
-d17 1
-a17 2
-#LF     = -mips4 -n32 -multigot $(QLFLAGS) changed Jan 23 98 al 
-LF     = -mips4 -n32 -xgot $(QLFLAGS) 
-@
-
-
-1.6
-log
-@*** empty log message ***
-@
-text
-@d15 3
-a17 1
-FFLAGS = -DSP_UNIX -DSP_ALLOC -DSP_R8000 $(BFLAGS) -mips4 -n32 -O2 -bytereclen $(QFFLAGS) -c   
-d19 2
-a20 1
-LF     = -mips4 -n32 -multigot $(QLFLAGS) 
-@
-
-
-1.5
-log
-@97 version
-@
-text
-@d15 1
-a15 1
-FFLAGS = -DSP_UNIX -DSP_ALLOC -DSP_R8000 -mips4 -n32 -O2 -bytereclen $(QFFLAGS) -c   
-@
-
-
-1.4
-log
-@*** empty log message ***
-@
-text
-@d2 1
-a2 1
-# ------ MAKEFILE FILE FOR MERGED SPIDER ----------------
-d4 8
-a11 6
-#  ArDean Leith -- 11 MAY 1994
-# 
-# ------ DEFINE SOME VARIABLES ------
-# 
-# 
-# ------ REDEFINE SOME OF THE BUILT-IN RULES AND MACROS ------
-d13 9
-a21 1
-FFLAGS = -static -O1 -DSP_UNIX _DSP_ALLOC -G 3 -old_rl -c
-d23 2
-a24 1
-PGM    = spider4
-d26 1
-a26 1
-LIB    =  $(PGM).a
-a27 2
-.PRECIOUS : $(LIB) ../bin/$(PGM)
-
-d29 3
-a31 12
-
-../bin/$(PGM) : $(PGM).o $(LIB)
-	@@\rm -f  ../bin/$(PGM)
-	f77 $(PGM).o $(LIB) -o ../bin/$(PGM)
-	@@chmod ug+w ../bin/$(PGM)
-	@@echo linking $(PGM)
-	\cp ../bin/$(PGM) ../bin/`Nextversion ../bin/$(PGM)`
-  
-$(PGM).o  : spider.f
-	f77 $(FFLAGS) -o $(PGM).o spider.f 
-  
-$(LIB) :  $(ELEMENTS)
-@
-
-
-1.3
-log
-@*** empty log message ***
-@
-text
-@d11 1
-a11 1
-FFLAGS = -static -O1 -DSP_UNIX -G 3 -old_rl -c
-@
-
-
-1.2
-log
-@*** empty log message ***
-@
-text
-@d22 1
-d24 1
-@
-
-
-1.1
-log
-@Initial revision
-@
-text
-@d14 1
-a14 1
- 
-d17 2
-a18 2
-.PRECIOUS :   $(LIB) ../bin/$(PGM)
- 
-@
diff --git src/Makefile_samples/RCS/Makefile4fft,v src/Makefile_samples/RCS/Makefile4fft,v
deleted file mode 100755
index 66c8eb77..00000000
--- src/Makefile_samples/RCS/Makefile4fft,v
+++ /dev/null
@@ -1,131 +0,0 @@
-head	1.5;
-access;
-symbols
-	best-code:1.4
-	x-named-regs:1.4
-	x:1.4
-	v13-00:1.4
-	pre_GPL:1.4
-	prec_CA:1.4
-	noindx:1.4
-	Bproc:1.3;
-locks; strict;
-comment	@# @;
-
-
-1.5
-date	2006.07.31.15.16.56;	author leith;	state dead;
-branches;
-next	1.4;
-
-1.4
-date	2002.06.05.20.15.38;	author leith;	state Exp;
-branches;
-next	1.3;
-
-1.3
-date	2000.04.24.20.36.12;	author leith;	state Exp;
-branches;
-next	1.2;
-
-1.2
-date	2000.04.18.20.28.36;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	2000.04.18.20.23.33;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.5
-log
-@obsolete
-@
-text
-@# 
-#  MAKEFILE FOR SGI SPIDER -- Makefile4fft (no SGI libfft)
-# 
-#  ArDean Leith -- 3 Mar. 1997
-
-SHELL  = /bin/sh
-
-COMP   = f90
-
-PGM    = spider
-
-EXE    = spider4fft
-
-FFLAGS = -cpp -OPT:Olimit=2500 -mips4 -n32 -g -bytereclen $(QFFLAGS) -c   
-
-LF     = -mips4 -n32 -g -multigot   
-
-LIB    = $(EXE).a
- 
-AFLAGS = r
-
-.PRECIOUS : $(LIB) ../bin/$(EXE)
- 
-include Makefile.inc
- 
-include Makebody.inc
- 
-@
-
-
-1.4
-log
-@*** empty log message ***
-@
-text
-@@
-
-
-1.3
-log
-@removd -DSP_F90
-@
-text
-@d2 1
-a2 1
-#  MAKEFILE FOR SGI SPIDER -- Makefile4fft (no libfft)
-a5 2
-SUFFIX = fft
- 
-d8 6
-d18 1
-a18 3
-PGM    = spider4$(SUFFIX)
-
-LIB    = $(PGM).a
-d22 1
-a22 1
-.PRECIOUS : $(LIB) ../bin/$(PGM)
-@
-
-
-1.2
-log
-@SP_UNIX cpp variable no longer needed.
-@
-text
-@d10 1
-a10 1
-FFLAGS = -cpp -DSP_F90 -OPT:Olimit=2500 -mips4 -n32 -g -bytereclen $(QFFLAGS) -c   
-@
-
-
-1.1
-log
-@Initial revision
-@
-text
-@d10 1
-a10 1
-FFLAGS = -cpp -DSP_F90 -DSP_UNIX -OPT:Olimit=2500 -mips4 -n32 -g -bytereclen $(QFFLAGS) -c   
-@
diff --git src/Makefile_samples/RCS/Makefile4fftw,v src/Makefile_samples/RCS/Makefile4fftw,v
deleted file mode 100755
index d8430d3c..00000000
--- src/Makefile_samples/RCS/Makefile4fftw,v
+++ /dev/null
@@ -1,155 +0,0 @@
-head	1.6;
-access;
-symbols
-	best-code:1.5
-	x-named-regs:1.5
-	x:1.5
-	v13-00:1.5
-	pre_GPL:1.5
-	prec_CA:1.5
-	noindx:1.5
-	Bproc:1.4;
-locks; strict;
-comment	@# @;
-
-
-1.6
-date	2006.07.31.15.17.29;	author leith;	state dead;
-branches;
-next	1.5;
-
-1.5
-date	2002.06.05.20.15.40;	author leith;	state Exp;
-branches;
-next	1.4;
-
-1.4
-date	2000.05.05.18.06.41;	author leith;	state Exp;
-branches;
-next	1.3;
-
-1.3
-date	2000.04.24.20.36.13;	author leith;	state Exp;
-branches;
-next	1.2;
-
-1.2
-date	2000.04.18.20.23.38;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	2000.03.16.15.19.18;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.6
-log
-@obsolete
-@
-text
-@# 
-#  MAKEFILE FOR SGI SPIDER (USING FFTW FOR FOURIERS)-- Makefile4fftw
-# 
-#  ArDean Leith -- 16 Mar. 2000
-#
-#  creates executable for:  
-#  processor      Irix versions           # processors
-#  ---------    ---------------           --------------------
-#   R5000      6.*                        >= 1 (no parallel code)
-#   R8000      6.*                        >= 1 (no parallel code)
-#   R10000     6.*                        >= 1 (no parallel code)
-# 
-# Note:    You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
- 
-SHELL  = /bin/sh
-
-COMP   = f90
-
-PGM    = spider
-
-EXE    = spider4fftw$(SUFFIX)
-
-FFLAGS   = -cpp -DSP_LIBFFTW -OPT:Olimit=2500 -mips4 -n32 -O3 -bytereclen $(QFFLAGS) -c   
-
-LF       = -mips4 -n32 -multigot $(QLFLAGS)  
-
-LINKLIBS = librfftw_threads.a libfftw_threads.a librfftw.a libfftw.a -lm
-
-LIB      = $(EXE).a
- 
-AFLAGS   = r
-
-.PRECIOUS :   $(LIB) ../bin/$(EXE)
- 
-include Makefile.inc
- 
-include Makebody.inc
- 
-@
-
-
-1.5
-log
-@*** empty log message ***
-@
-text
-@@
-
-
-1.4
-log
-@*** empty log message ***
-@
-text
-@d15 1
-a15 1
-SHELL    = /bin/sh
-d17 6
-d29 1
-a29 3
-PGM      = spider4fftw$(SUFFIX)
-
-LIB      = $(PGM).a
-d33 1
-a33 1
-.PRECIOUS :   $(LIB) ../bin/$(PGM)
-@
-
-
-1.3
-log
-@removd -DSP_F90
-@
-text
-@d17 1
-a17 1
-FFLAGS   = -cpp -DSP_LIBFFT -DSP_LIBFFTW -OPT:Olimit=2500 -mips4 -n32 -O3 -bytereclen $(QFFLAGS) -c   
-@
-
-
-1.2
-log
-@removed SP_UNIX
-@
-text
-@d17 1
-a17 1
-FFLAGS   = -cpp -DSP_F90 -DSP_LIBFFT -DSP_LIBFFTW -OPT:Olimit=2500 -mips4 -n32 -O3 -bytereclen $(QFFLAGS) -c   
-@
-
-
-1.1
-log
-@Initial revision
-@
-text
-@d17 1
-a17 1
-FFLAGS   = -cpp -DSP_F90 -DSP_UNIX -DSP_LIBFFT -DSP_LIBFFTW -OPT:Olimit=2500 -mips4 -n32 -O3 -bytereclen $(QFFLAGS) -c   
-@
diff --git src/Makefile_samples/RCS/Makefile4mp,v src/Makefile_samples/RCS/Makefile4mp,v
deleted file mode 100644
index be587b83..00000000
--- src/Makefile_samples/RCS/Makefile4mp,v
+++ /dev/null
@@ -1,366 +0,0 @@
-head	1.17;
-access;
-symbols
-	pre_fftwrings:1.16
-	pre_opfiles:1.16
-	src:1.16
-	best-code:1.16
-	x-named-regs:1.16
-	x:1.16
-	v13-00:1.16
-	pre_GPL:1.16
-	prec_CA:1.15
-	noindx:1.15
-	Bproc:1.14
-	oct21:1.12
-	last77:1.10;
-locks; strict;
-comment	@# @;
-
-
-1.17
-date	2009.04.17.15.23.31;	author leith;	state dead;
-branches;
-next	1.16;
-
-1.16
-date	2004.05.12.19.02.30;	author leith;	state Exp;
-branches;
-next	1.15;
-
-1.15
-date	2002.06.05.20.15.42;	author leith;	state Exp;
-branches;
-next	1.14;
-
-1.14
-date	2000.04.24.20.36.15;	author leith;	state Exp;
-branches;
-next	1.13;
-
-1.13
-date	2000.04.18.20.23.57;	author leith;	state Exp;
-branches;
-next	1.12;
-
-1.12
-date	99.07.30.13.35.48;	author pawel;	state Exp;
-branches;
-next	1.11;
-
-1.11
-date	99.07.30.13.22.50;	author pawel;	state Exp;
-branches;
-next	1.10;
-
-1.10
-date	99.03.29.15.50.07;	author leith;	state Exp;
-branches;
-next	1.9;
-
-1.9
-date	99.03.29.15.16.46;	author leith;	state Exp;
-branches;
-next	1.8;
-
-1.8
-date	99.03.19.15.39.35;	author leith;	state Exp;
-branches;
-next	1.7;
-
-1.7
-date	98.03.03.16.27.43;	author leith;	state Exp;
-branches;
-next	1.6;
-
-1.6
-date	98.03.03.16.20.36;	author leith;	state Exp;
-branches;
-next	1.5;
-
-1.5
-date	98.02.17.19.52.28;	author leith;	state Exp;
-branches;
-next	1.4;
-
-1.4
-date	98.02.12.14.56.59;	author leith;	state Exp;
-branches;
-next	1.3;
-
-1.3
-date	98.01.23.16.02.48;	author leith;	state Exp;
-branches;
-next	1.2;
-
-1.2
-date	97.07.29.16.18.03;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	97.07.23.19.13.18;	author pawel;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.17
-log
-@obsolete SGI
-@
-text
-@# 
-#  MAKEFILE FOR SGI SPIDER -- Makefile4mp
-# 
-#  ArDean Leith -- 3 Mar. 1997
-#
-#  creates executable for:  
-#  processor      Irix versions           # processors
-#  ---------    ----------------          ------------
-#   R5000      6.2                        >= 2
-#   R8000      6.1 & 6.2                  >= 2
-#   R10000     6.2                        >= 2
-#
-# Warning: -O3 optimization gives wrong results on some calculations
-#          I suggest you do not increase the optimization level
-# 
-# Note:    You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
-#
-SHELL  = /bin/sh
-
-COMP   = f90
-
-PGM    = spider
-
-EXE    = spider4mp$(SUFFIX)
-
-FFLAGS = -cpp -DSP_MP -DSP_LIBFFT -DSP_LAPACK -OPT:Olimit=2500 -O2 -mp -mips4 -n32 -bytereclen $(QFFLAGS) -c   
-
-LF     = -mp -mips4 -n32 -multigot $(QLFLAGS) 
-
-LINKLIBS = -lcomplib.sgimath_mp 
- 
-LIB    = $(EXE).a
- 
-AFLAGS = r
-
-.PRECIOUS :   $(LIB) ../bin/$(EXE)
-
-include Makefile.inc
-
-include Makebody.inc
- 
-@
-
-
-1.16
-log
-@lapack
-@
-text
-@@
-
-
-1.15
-log
-@*** empty log message ***
-@
-text
-@d26 1
-a26 5
-##FFLAGS = -DSP_MP -DSP_LIBFFT -xgot -O2 -mp -mips4 -n32 -bytereclen $(QFFLAGS) -c   
-##LF     = -mp -mips4 -n32 -xgot $(QLFLAGS) 
-# multigot replaced  Feb 13 98 al
-
-FFLAGS = -cpp -DSP_MP -DSP_LIBFFT -OPT:Olimit=2500 -O2 -mp -mips4 -n32 -bytereclen $(QFFLAGS) -c   
-@
-
-
-1.14
-log
-@removd -DSP_F90
-@
-text
-@d20 1
-d22 4
-d36 1
-a36 3
-PGM    = spider4mp$(SUFFIX)
-
-LIB    = $(PGM).a
-d40 1
-a40 1
-.PRECIOUS :   $(LIB) ../bin/$(PGM)
-@
-
-
-1.13
-log
-@removed SP_UNIX
-@
-text
-@d25 1
-a25 1
-FFLAGS = -cpp -DSP_F90 -DSP_MP -DSP_LIBFFT -OPT:Olimit=2500 -O2 -mp -mips4 -n32 -bytereclen $(QFFLAGS) -c   
-@
-
-
-1.12
-log
-@O2
-@
-text
-@d21 1
-a21 1
-##FFLAGS = -DSP_UNIX -DSP_MP -DSP_LIBFFT -xgot -O2 -mp -mips4 -n32 -bytereclen $(QFFLAGS) -c   
-d25 1
-a25 1
-FFLAGS = -cpp -DSP_F90 -DSP_UNIX -DSP_MP -DSP_LIBFFT -OPT:Olimit=2500 -O2 -mp -mips4 -n32 -bytereclen $(QFFLAGS) -c   
-@
-
-
-1.11
-log
-@O3
-@
-text
-@d25 1
-a25 1
-FFLAGS = -cpp -DSP_F90 -DSP_UNIX -DSP_MP -DSP_LIBFFT -OPT:Olimit=2500 -O3 -mp -mips4 -n32 -bytereclen $(QFFLAGS) -c   
-@
-
-
-1.10
-log
-@R8000 removed
-@
-text
-@d25 1
-a25 1
-FFLAGS = -cpp -DSP_F90 -DSP_UNIX -DSP_MP -DSP_LIBFFT -OPT:Olimit=2500 -O2 -mp -mips4 -n32 -bytereclen $(QFFLAGS) -c   
-@
-
-
-1.9
-log
-@f90
-@
-text
-@d21 1
-a21 1
-##FFLAGS = -DSP_UNIX -DSP_R8000 -DSP_MP -DSP_LIBFFT -xgot -O2 -mp -mips4 -n32 -bytereclen $(QFFLAGS) -c   
-@
-
-
-1.8
-log
-@removed SP_ALLOC
-@
-text
-@d24 2
-a25 1
-FFLAGS = -DSP_UNIX -DSP_R8000 -DSP_MP -DSP_LIBFFT -O2 -mp -mips4 -n32 -bytereclen $(QFFLAGS) -c   
-@
-
-
-1.7
-log
-@typo
-@
-text
-@d21 1
-a21 1
-##FFLAGS = -DSP_UNIX -DSP_ALLOC -DSP_R8000 -DSP_MP -DSP_LIBFFT -xgot -O2 -mp -mips4 -n32 -bytereclen $(QFFLAGS) -c   
-d24 1
-a24 1
-FFLAGS = -DSP_UNIX -DSP_ALLOC -DSP_R8000 -DSP_MP -DSP_LIBFFT -O2 -mp -mips4 -n32 -bytereclen $(QFFLAGS) -c   
-@
-
-
-1.6
-log
-@moved libfft selector to respective makefiles
-@
-text
-@d24 1
-a24 1
-FFLAGS = -DSP_UNIX -DSP_ALLOC -DSP_R8000 -DSP_MP -DSP_LIBFFT$ -O2 -mp -mips4 -n32 -bytereclen $(QFFLAGS) -c   
-@
-
-
-1.5
-log
-@using -multigot again
-@
-text
-@d16 1
-a16 1
-# Note:    You may ignore any undefined QFFLAGS or QLFLAGS
-d20 3
-d24 2
-a25 1
-FFLAGS = -DSP_UNIX -DSP_ALLOC -DSP_R8000 -DSP_MP $(BFLAGS) -O2 -mp -mips4 -n32 -bytereclen $(QFFLAGS) -c   
-d28 2
-a29 3
-##FFLAGS = -DSP_UNIX -DSP_ALLOC -DSP_R8000 -DSP_MP $(BFLAGS) -xgot -O2 -mp -mips4 -n32 -bytereclen $(QFFLAGS) -c   
-##LF     = -mp -mips4 -n32 -xgot $(QLFLAGS) 
-
-@
-
-
-1.4
-log
-@ignore qflags message
-@
-text
-@d20 3
-a22 3
-# multigot removed Jan 23 98 al
-#FFLAGS = -DSP_UNIX -DSP_ALLOC -DSP_R8000 -DSP_MP $(BFLAGS) -O2 -mp -mips4 -n32 -bytereclen $(QFFLAGS) -c   
-#LF     = -mp -mips4 -n32 -multigot $(QLFLAGS) 
-d24 2
-a25 3
-FFLAGS = -DSP_UNIX -DSP_ALLOC -DSP_R8000 -DSP_MP $(BFLAGS) -xgot -O2 -mp -mips4 -n32 -bytereclen $(QFFLAGS) -c   
-
-LF     = -mp -mips4 -n32 -xgot $(QLFLAGS) 
-@
-
-
-1.3
-log
-@removed multigot , used xgot
-@
-text
-@d15 3
-a17 1
-
-@
-
-
-1.2
-log
-@*** empty log message ***
-@
-text
-@d18 3
-a20 1
-FFLAGS = -DSP_UNIX -DSP_ALLOC -DSP_R8000 -DSP_MP $(BFLAGS) -O2 -mp -mips4 -n32 -bytereclen $(QFFLAGS) -c   
-d22 3
-a24 1
-LF     = -mp -mips4 -n32 -multigot $(QLFLAGS) 
-@
-
-
-1.1
-log
-@Initial revision
-@
-text
-@d18 1
-a18 1
-FFLAGS = -DSP_UNIX -DSP_ALLOC -DSP_R8000 -DSP_MP -O2 -mp -mips4 -n32 -bytereclen $(QFFLAGS) -c   
-@
diff --git src/Makefile_samples/RCS/Makefile4mpfftw,v src/Makefile_samples/RCS/Makefile4mpfftw,v
deleted file mode 100755
index 450ab0cf..00000000
--- src/Makefile_samples/RCS/Makefile4mpfftw,v
+++ /dev/null
@@ -1,143 +0,0 @@
-head	1.5;
-access;
-symbols
-	pre_fftwrings:1.4
-	pre_opfiles:1.4
-	src:1.4
-	best-code:1.4
-	x-named-regs:1.4
-	x:1.4
-	v13-00:1.4
-	pre_GPL:1.4
-	prec_CA:1.4
-	noindx:1.4
-	Bproc:1.3;
-locks; strict;
-comment	@# @;
-
-
-1.5
-date	2009.04.17.15.23.32;	author leith;	state dead;
-branches;
-next	1.4;
-
-1.4
-date	2002.06.05.20.15.43;	author leith;	state Exp;
-branches;
-next	1.3;
-
-1.3
-date	2000.04.24.20.41.38;	author leith;	state Exp;
-branches;
-next	1.2;
-
-1.2
-date	2000.04.18.20.24.02;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	2000.03.16.15.19.20;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.5
-log
-@obsolete SGI
-@
-text
-@# 
-#  MAKEFILE FOR SGI SPIDER (USING FFTW FOR FOURIERS)-- Makefile4mpfftw
-# 
-#  ArDean Leith -- 16 Mar. 2000
-#
-#  creates executable for:  
-#  processor      Irix versions           # processors
-#  ---------    ----------------          ------------
-#   R5000      6.*                        >= 2
-#   R8000      6.*                        >= 2
-#   R10000     6.*                        >= 2
-#   R10000     6.*                        >= 2
-#
-# Warning: -O3 optimization gives wrong results on some calculations
-#          I suggest you do not increase the optimization level
-# 
-# Note:    You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
-#
-SHELL  = /bin/sh
-
-COMP   = f90
-
-PGM    = spider
-
-EXE    = spider4mpfftw$(SUFFIX)
-
-FFLAGS = -cpp -DSP_MP -DSP_LIBFFTWMP -OPT:Olimit=2500 -O2 -mp -mips4 -n32 -bytereclen $(QFFLAGS) -c   
-
-LF     = -mp -mips4 -n32 -multigot $(QLFLAGS) 
-
-LINKLIBS = librfftw_threads.a libfftw_threads.a librfftw.a libfftw.a -lm
- 
-LIB    = $(EXE).a
- 
-AFLAGS = r
-
-.PRECIOUS :   $(LIB) ../bin/$(EXE)
-
-include Makefile.inc
-
-include Makebody.inc
- 
-@
-
-
-1.4
-log
-@*** empty log message ***
-@
-text
-@@
-
-
-1.3
-log
-@f90 cpp remoed
-@
-text
-@d21 6
-d33 1
-a33 3
-PGM    = spider4mpfftw$(SUFFIX)
-
-LIB    = $(PGM).a
-d37 1
-a37 1
-.PRECIOUS :   $(LIB) ../bin/$(PGM)
-@
-
-
-1.2
-log
-@removed SP_UNIX
-@
-text
-@d21 1
-a21 1
-FFLAGS = -cpp -DSP_F90 -DSP_MP -DSP_LIBFFTWMP -OPT:Olimit=2500 -O2 -mp -mips4 -n32 -bytereclen $(QFFLAGS) -c   
-@
-
-
-1.1
-log
-@Initial revision
-@
-text
-@d21 1
-a21 1
-FFLAGS = -cpp -DSP_F90 -DSP_UNIX -DSP_MP -DSP_LIBFFTWMP -OPT:Olimit=2500 -O2 -mp -mips4 -n32 -bytereclen $(QFFLAGS) -c   
-@
diff --git src/Makefile_samples/RCS/Makefile4ns,v src/Makefile_samples/RCS/Makefile4ns,v
deleted file mode 100755
index 5ae0d172..00000000
--- src/Makefile_samples/RCS/Makefile4ns,v
+++ /dev/null
@@ -1,176 +0,0 @@
-head	1.7;
-access;
-symbols
-	pre_fftwrings:1.6
-	pre_opfiles:1.6
-	src:1.6
-	best-code:1.6
-	x-named-regs:1.6
-	x:1.6
-	v13-00:1.6
-	pre_GPL:1.6
-	prec_CA:1.6
-	noindx:1.6
-	Bproc:1.5
-	oct21:1.3
-	last77:1.2;
-locks; strict;
-comment	@# @;
-
-
-1.7
-date	2009.04.17.15.23.33;	author leith;	state dead;
-branches;
-next	1.6;
-
-1.6
-date	2002.06.05.20.15.44;	author leith;	state Exp;
-branches;
-next	1.5;
-
-1.5
-date	2000.04.24.20.36.17;	author leith;	state Exp;
-branches;
-next	1.4;
-
-1.4
-date	2000.04.18.20.28.29;	author leith;	state Exp;
-branches;
-next	1.3;
-
-1.3
-date	99.04.09.12.26.47;	author leith;	state Exp;
-branches;
-next	1.2;
-
-1.2
-date	99.03.19.15.39.37;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	98.03.04.15.25.42;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@new
-@
-
-
-1.7
-log
-@obsolete SGI
-@
-text
-@# 
-#  MAKEFILE FOR SGI SPIDER -- Makefile4ns (mips4 without complib)
-# 
-#  ArDean Leith -- 3 Mar. 1998
-#
-#  creates executable for (non libfft):  
-#  processor      Irix versions           # processors
-#  ---------    ---------------           --------------------
-#   R5000      6.2                        >= 1 (no parallel code)
-#   R8000      6.1 & 6.2                  >= 1 (no parallel code)
-#   R10000     6.2                        >= 1 (no parallel code)
-# 
-# Note:    You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
- 
-SHELL  = /bin/sh
-
-COMP   = f90
-
-PGM    = spider
-
-EXE    = spider4ns
-
-FFLAGS = -cpp -mips4 -n32 -O3 -bytereclen $(QFFLAGS) -c 
-
-LF     = -mips4 -n32 -multigot $(QLFLAGS) 
-
-LIB    = $(EXE).a
- 
-AFLAGS = r
-
-.PRECIOUS :   $(LIB) ../bin/$(EXE)
- 
-include Makefile.inc
- 
-include Makebody.inc
- 
-@
-
-
-1.6
-log
-@*** empty log message ***
-@
-text
-@@
-
-
-1.5
-log
-@removd -DSP_F90
-@
-text
-@a13 1
-#
-d17 6
-d27 1
-a27 3
-PGM    = spider4ns
-
-LIB    = $(PGM).a
-a28 1
-#AFLAGS = qz
-d31 1
-a31 1
-.PRECIOUS :   $(LIB) ../bin/$(PGM)
-@
-
-
-1.4
-log
-@SP_UNIX cpp variable no longer needed.
-@
-text
-@d18 1
-a18 1
-FFLAGS = -cpp -DSP_F90 -mips4 -n32 -O3 -bytereclen $(QFFLAGS) -c 
-@
-
-
-1.3
-log
-@f90
-@
-text
-@d18 1
-a18 1
-FFLAGS = -cpp -DSP_F90 -DSP_UNIX -mips4 -n32 -O3 -bytereclen $(QFFLAGS) -c 
-@
-
-
-1.2
-log
-@removed SP_ALLOC
-@
-text
-@d18 1
-a18 1
-FFLAGS = -DSP_UNIX -mips4 -n32 -O3 -bytereclen $(QFFLAGS) -c 
-@
-
-
-1.1
-log
-@Initial revision
-@
-text
-@d18 1
-a18 1
-FFLAGS = -DSP_UNIX -DSP_ALLOC -mips4 -n32 -O3 -bytereclen $(QFFLAGS) -c 
-@
diff --git src/Makefile_samples/RCS/Makefile5,v src/Makefile_samples/RCS/Makefile5,v
deleted file mode 100644
index 89584a03..00000000
--- src/Makefile_samples/RCS/Makefile5,v
+++ /dev/null
@@ -1,280 +0,0 @@
-head	1.9;
-access;
-symbols
-	pre_fftwrings:1.8
-	pre_opfiles:1.8
-	src:1.8
-	best-code:1.8
-	x-named-regs:1.8
-	x:1.8
-	v13-00:1.8
-	pre_GPL:1.8
-	prec_CA:1.8
-	noindx:1.8
-	Bproc:1.6
-	oct21:1.6
-	last77:1.6;
-locks; strict;
-
-
-1.9
-date	2009.04.17.15.23.34;	author leith;	state dead;
-branches;
-next	1.8;
-
-1.8
-date	2002.06.05.20.15.45;	author leith;	state Exp;
-branches;
-next	1.7;
-
-1.7
-date	2001.01.26.14.59.13;	author leith;	state Exp;
-branches;
-next	1.6;
-
-1.6
-date	95.08.09.14.09.51;	author leith;	state Exp;
-branches;
-next	1.5;
-
-1.5
-date	95.03.06.12.39.32;	author leith;	state Exp;
-branches;
-next	1.4;
-
-1.4
-date	95.02.01.21.38.41;	author pawel;	state Exp;
-branches;
-next	1.3;
-
-1.3
-date	95.02.01.21.37.02;	author pawel;	state Exp;
-branches;
-next	1.2;
-
-1.2
-date	95.01.26.13.07.41;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	95.01.25.11.36.14;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@used include file 
-@
-
-
-1.9
-log
-@obsolete SGI
-@
-text
-@# 
-#  MAKEFILE FOR SGI SPIDER -- Makefile5
-# 
-#  ArDean Leith -- 3 Mar. 1997
-#
-#  creates executable for 64 bit SPIDER for use on:  
-#  processor      Irix versions           # processors
-#  ---------    ---------------           --------------------
-#   R8000      6.*                  >= 1 (no parallel code)
-#   R10000     6.*                  >= 1 (no parallel code)
-#   R12000     6.*                  >= 1 (no parallel code)
-#   R14000     6.*                  >= 1 (no parallel code)
-# 
-# Note:    You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
-#
- 
-SHELL  = /bin/sh
-
-COMP   = f90
-
-PGM    = spider
-
-EXE    = spider5$(SUFFIX)
-
-FFLAGS = -cpp -DSP_LIBFFT -mips4 -64 -O3 -bytereclen $(QFFLAGS) -c   
-
-LF     = -mips4 -64 -multigot $(QLFLAGS)  
-
-LINKLIBS = -lcomplib.sgimath
-
-LIB    = $(EXE).a
- 
-AFLAGS = r
-
-.PRECIOUS :   $(LIB) ../bin/$(EXE)
- 
-include Makefile.inc
- 
-include Makebody.inc
- 
-@
-
-
-1.8
-log
-@*** empty log message ***
-@
-text
-@@
-
-
-1.7
-log
-@for 64 bit spider now
-@
-text
-@d19 6
-d31 1
-a31 3
-PGM    = spider5$(SUFFIX)
-
-LIB    = $(PGM).a
-d35 1
-a35 1
-.PRECIOUS :   $(LIB) ../bin/$(PGM)
-@
-
-
-1.6
-log
-@spalloc
-@
-text
-@d2 1
-a2 1
-# ------ MAKEFILE FILE FOR SGI SPIDER for Irix 5.* ----------------
-d4 12
-a15 2
-#  ArDean Leith -- 11 MAY 1994 
-#  
-d17 3
-a19 1
-FFLAGS = -DSP_UNIX -DSP_ALLOC -old_rl -O2 -mips2 -c
-d21 1
-a21 1
-LF     = -O2 -mips2
-d23 1
-a23 1
-PGM    = spider5
-d25 2
-d29 2
-a31 1
-SHELL  = /bin/sh
-d34 3
-a36 23
-
-../bin/$(PGM) : $(PGM).o $(LIB)
-	@@\rm -f  ../bin/$(PGM)
-	f77 $(LF) $(PGM).o $(LIB) -o ../bin/$(PGM)
-	@@chmod ug+w ../bin/$(PGM)
-	@@echo linking $(PGM)
-	\cp ../bin/$(PGM) ../bin/`Nextversion ../bin/$(PGM)`
-  
-$(PGM).o  : spider.f
-	f77 $(FFLAGS) -o $(PGM).o  spider.f 
-  
-$(LIB) :  $(ELEMENTS)
-	@@echo library filled
-.f.a:
-	@@if \grep CNO_SAVE $< 1>/dev/null ; then \
-	f77 $(FFLAGS)  $< ; echo "       compiled non-static" $< ; else \
-	f77 $(FFLAGS) -static  $< ; echo "        compiled" $<; fi
-	$(AR) r $(LIB) $*.o
-	@@\rm $*.o
-  
-  
-  
-  
-@
-
-
-1.5
-log
-@*** empty log message ***
-@
-text
-@d7 1
-a7 1
-FFLAGS = -DSP_UNIX -old_rl -O2 -mips2 -c
-@
-
-
-1.4
-log
-@tabs !
-@
-text
-@d21 1
-d23 1
-@
-
-
-1.3
-log
-@mips2 corrected
-@
-text
-@d21 3
-a23 3
-        f77 $(LF) $(PGM).o $(LIB) -o ../bin/$(PGM)
-        @@echo linking $(PGM)
-        \cp ../bin/$(PGM) ../bin/`Nextversion ../bin/$(PGM)`
-d26 1
-a26 1
-        f77 $(FFLAGS) -o $(PGM).o  spider.f 
-d29 1
-a29 1
-        @@echo library filled
-d31 5
-a35 5
-        @@if \grep CNO_SAVE $< 1>/dev/null ; then \
-        f77 $(FFLAGS)  $< ; echo "       compiled non-static" $< ; else \
-        f77 $(FFLAGS) -static  $< ; echo "        compiled" $<; fi
-        $(AR) r $(LIB) $*.o
-        @@\rm $*.o
-@
-
-
-1.2
-log
-@used different spiders based on OS
-@
-text
-@d7 1
-a7 1
-FFLAGS = -static -DSP_UNIX -old_rl -O1 -c
-d9 2
-d16 1
-d21 3
-a23 3
-	f77 $(LF) $(PGM).o $(LIB) -o ../bin/$(PGM)
-	@@echo linking $(PGM)
-	\cp ../bin/$(PGM) ../bin/`Nextversion ../bin/$(PGM)`
-d26 1
-a26 1
-	f77 $(FFLAGS) -o $(PGM).o  spider.f 
-d29 8
-@
-
-
-1.1
-log
-@Initial revision
-@
-text
-@d5 1
-a5 2
-# 
-# 
-d18 1
-a19 1
-	f77 $(LF) $(PGM).o $(LIB) -o ../bin/$(PGM)_temp
-a20 1
-	\mv ../bin/$(PGM)_temp $@@
-@
diff --git src/Makefile_samples/RCS/Makefile5mp,v src/Makefile_samples/RCS/Makefile5mp,v
deleted file mode 100755
index 277dbcfe..00000000
--- src/Makefile_samples/RCS/Makefile5mp,v
+++ /dev/null
@@ -1,148 +0,0 @@
-head	1.4;
-access;
-symbols
-	pre_fftwrings:1.3
-	pre_opfiles:1.3
-	src:1.3
-	best-code:1.3
-	x-named-regs:1.3
-	x:1.3
-	v13-00:1.3
-	pre_GPL:1.3
-	prec_CA:1.2
-	noindx:1.2;
-locks; strict;
-comment	@# @;
-
-
-1.4
-date	2009.04.17.15.23.35;	author leith;	state dead;
-branches;
-next	1.3;
-
-1.3
-date	2004.05.12.19.02.26;	author leith;	state Exp;
-branches;
-next	1.2;
-
-1.2
-date	2002.06.05.20.15.45;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	2001.01.26.15.00.13;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.4
-log
-@obsolete SGI
-@
-text
-@# 
-#  MAKEFILE FOR SGI SPIDER -- Makefile5mp
-# 
-#  ArDean Leith -- 25 Jan. 2001
-#
-#  creates 64 bit multi-proocessor SPIDER executable for use on:  
-#  processor      Irix versions           # processors
-#  ---------    ----------------          ------------
-#   R8000      6.*                        >= 2
-#   R10000     6.*                        >= 2
-#   R12000     6.*                        >= 2
-#   R14000     6.*                        >= 2
-#
-# Note:    You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
-#
-SHELL    = /bin/sh
-
-COMP     = f90
-
-PGM      = spider
-
-FFLAGS   = -cpp -DSP_MP -DSP_LIBFFT -DSP_LAPACK -O3 -mp -mips4 -64 -bytereclen $(QFFLAGS) -c   
-
-LF       = -mp -mips4 -64 -multigot $(QLFLAGS) 
-
-LINKLIBS = -lcomplib.sgimath_mp 
- 
-EXE      = spider5mp$(SUFFIX)
-
-LIB      = $(EXE).a
- 
-AFLAGS   = r
-
-.PRECIOUS :  $(LIB) ../bin/$(EXE)
-
-include Makefile.inc
-
-include Makebody.inc
- 
-@
-
-
-1.3
-log
-@lablas
-@
-text
-@@
-
-
-1.2
-log
-@*** empty log message ***
-@
-text
-@d6 1
-a6 1
-#  creates 64 bit multi-proocessor SPIDE executable for use on:  
-d16 1
-a16 1
-SHELL  = /bin/sh
-d18 1
-a18 1
-COMP   = f90
-d20 1
-a20 1
-PGM    = spider
-d22 1
-a22 1
-FFLAGS = -cpp -DSP_MP -DSP_LIBFFT -O3 -mp -mips4 -64 -bytereclen $(QFFLAGS) -c   
-d24 1
-a24 1
-LF     = -mp -mips4 -64 -multigot $(QLFLAGS) 
-d28 1
-a28 1
-EXE    = spider5mp$(SUFFIX)
-d30 1
-a30 1
-LIB    = $(EXE).a
-d32 1
-a32 1
-AFLAGS = r
-@
-
-
-1.1
-log
-@Initial revision
-@
-text
-@d18 4
-d28 1
-a28 1
-PGM    = spider5mp$(SUFFIX)
-d30 1
-a30 1
-LIB    = $(PGM).a
-d34 1
-a34 1
-.PRECIOUS :  $(LIB) ../bin/$(PGM)
-@
diff --git src/Makefile_samples/RCS/Makefile6,v src/Makefile_samples/RCS/Makefile6,v
deleted file mode 100644
index d60a229d..00000000
--- src/Makefile_samples/RCS/Makefile6,v
+++ /dev/null
@@ -1,250 +0,0 @@
-head	1.11;
-access;
-symbols
-	best-code:1.10
-	x-named-regs:1.10
-	x:1.10
-	v13-00:1.10
-	pre_GPL:1.10
-	prec_CA:1.10
-	noindx:1.10
-	Bproc:1.10
-	oct21:1.10
-	last77:1.10;
-locks; strict;
-
-
-1.11
-date	2006.07.31.15.18.54;	author leith;	state dead;
-branches;
-next	1.10;
-
-1.10
-date	95.08.11.17.46.30;	author leith;	state Exp;
-branches;
-next	1.9;
-
-1.9
-date	95.03.06.12.39.33;	author leith;	state Exp;
-branches;
-next	1.8;
-
-1.8
-date	95.03.02.11.01.52;	author leith;	state Exp;
-branches;
-next	1.7;
-
-1.7
-date	95.02.06.14.53.13;	author leith;	state Exp;
-branches;
-next	1.6;
-
-1.6
-date	95.02.06.14.42.12;	author leith;	state Exp;
-branches;
-next	1.5;
-
-1.5
-date	95.01.31.12.30.27;	author leith;	state Exp;
-branches;
-next	1.4;
-
-1.4
-date	95.01.27.16.32.07;	author leith;	state Exp;
-branches;
-next	1.3;
-
-1.3
-date	95.01.26.13.43.31;	author pawel;	state Exp;
-branches;
-next	1.2;
-
-1.2
-date	95.01.26.13.05.33;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	95.01.25.11.38.39;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@new
-@
-
-
-1.11
-log
-@obsolete
-@
-text
-@# 
-# ------ MAKEFILE FILE FOR SGI SPIDER Irix 6.* on R8000 
-#
-#  ArDean Leith -- 11 MAY 1994 
-# 
-# be sure to change flags in foc and focl  when changing FFLAGS
-#
-# be sure to change Makefile6send when altering this file !!!!!
- 
-SHELL  = /bin/sh
-
-FFLAGS = -DSP_UNIX -DSP_ALLOC -DSP_R8000 -DSP_MP -O3 -G 0 -mips4 -64  -old_rl -c -mp    
-
-LF     = -O3 -mips4 -64 -mp
-
-PGM    = spider6
-
-LIB    = $(PGM).a
- 
-.PRECIOUS : $(LIB) ../bin/$(PGM)
- 
-include Makefile.inc
- 
-../bin/$(PGM) : $(PGM).o $(LIB)
-	@@\rm -f  ../bin/$(PGM)
-	f77 $(LF) $(PGM).o $(LIB) -o ../bin/$(PGM)
-	@@chmod ug+w ../bin/$(PGM)
-	@@echo linking $(PGM)
-	\cp ../bin/$(PGM) ../bin/`Nextversion ../bin/$(PGM)`
-  
-$(PGM).o  : spider.f
-	f77 $(FFLAGS) -o $(PGM).o  spider.f 
-  
-$(LIB) : $(ELEMENTS)
-	@@echo library filled
-.f.a:
-	@@if \grep CNO_SAVE $< 1>/dev/null ; then \
-        f77 $(FFLAGS)  $< ; echo "       compiled non-static" $< ; else \
-        f77 $(FFLAGS) -static  $< ; echo "        compiled" $<; fi
-	$(AR) r $(LIB) $*.o
-	@@\rm $*.o
-@
-
-
-1.10
-log
-@alloc added
-@
-text
-@@
-
-
-1.9
-log
-@*** empty log message ***
-@
-text
-@d12 1
-a12 1
-FFLAGS = -DSP_UNIX -DSP_R8000 -DSP_MP -O3 -G 0 -mips4 -64  -old_rl -c -mp    
-@
-
-
-1.8
-log
-@cosmetic
-@
-text
-@d25 1
-@
-
-
-1.7
-log
-@bad chmod line
-@
-text
-@d6 3
-a8 1
-# be sure to change flags in foc6 when changing FFLAGS
-d10 2
-d20 1
-a20 1
-.PRECIOUS :   $(LIB) ../bin/$(PGM)
-a21 2
-SHELL  = /bin/sh
-
-@
-
-
-1.6
-log
-@added chmod
-@
-text
-@d24 1
-a24 1
-        @@chmod ug+w ../bin/$(PGM)
-@
-
-
-1.5
-log
-@*** empty log message ***
-@
-text
-@d24 1
-@
-
-
-1.4
-log
-@*** empty log message ***
-@
-text
-@d3 1
-a3 1
-# 
-@
-
-
-1.3
-log
-@DP_SPMP defined
-@
-text
-@d6 1
-d8 1
-a8 1
-FFLAGS = -static -DSP_UNIX -DSP_R8000 -DSP_MP -O3 -mips4 -64  -old_rl -c     
-d10 1
-a10 1
-LF     = -O3 -mips4 -64 
-d18 1
-a18 1
-#include Makefile.inc
-d20 2
-d23 1
-a24 1
-	f77 $(LF) $(PGM).o $(LIB) -o ../bin/$(PGM)
-d30 8
-a37 1
-$(LIB) :  $(ELEMENTS)
-@
-
-
-1.2
-log
-@*** empty log message ***
-@
-text
-@d7 1
-a7 1
-FFLAGS = -static -DSP_UNIX -DSP_R8000 -O3 -mips4 -64  -old_rl -c     
-@
-
-
-1.1
-log
-@Initial revision
-@
-text
-@d21 1
-a21 1
-	f77 $(LF) $(PGM).o $(LIB) -o ../bin/$(PGM)_temp
-a22 1
-	\mv ../bin/$(PGM)_temp $@@
-@
diff --git src/Makefile_samples/RCS/Makefile_NT,v src/Makefile_samples/RCS/Makefile_NT,v
deleted file mode 100755
index c2fbfcbf..00000000
--- src/Makefile_samples/RCS/Makefile_NT,v
+++ /dev/null
@@ -1,2045 +0,0 @@
-head	1.4;
-access;
-symbols
-	pre_fftwrings:1.4
-	pre_opfiles:1.4
-	src:1.4
-	best-code:1.4
-	x-named-regs:1.3
-	x:1.3
-	v13-00:1.3
-	pre_GPL:1.3
-	prec_CA:1.3
-	noindx:1.3
-	Bproc:1.3
-	oct21:1.2
-	last77:1.2;
-locks; strict;
-comment	@# @;
-
-
-1.4
-date	2006.01.19.18.26.40;	author leith;	state Exp;
-branches;
-next	1.3;
-
-1.3
-date	2000.04.18.20.28.09;	author leith;	state Exp;
-branches;
-next	1.2;
-
-1.2
-date	99.03.19.15.45.09;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	99.03.19.15.39.42;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@removed SP_ALLOC
-@
-
-
-1.4
-log
-@new
-@
-text
-@# Microsoft Developer Studio Generated NMAKE File, Based on spider.dsp
-
-!IF "$(OS)" == "Windows_NT"
-NULL=
-!ELSE 
-NULL=nul
-!ENDIF 
-
-F90=df.exe
-OUTDIR=.
-INTDIR=.
-
-ALL : "$(OUTDIR)\spider.exe" 
-	@@copy spider.exe ..\bin > nul
-
-F90_PROJ=/compile_only /include:"$(INTDIR)\\" /nologo /debug:full /optimize:0 /warn:nofileopt\
- /pdbfile:"DF50.PDB" /module:"/Program files/microsoft visual Studio/DF98/Include/."
-F90_OBJS=
-	
-LINK32=link.exe
-LINK32_FLAGS=kernel32.lib user32.lib gdi32.lib winspool.lib comdlg32.lib\
- advapi32.lib shell32.lib ole32.lib oleaut32.lib uuid.lib odbc32.lib\
- odbccp32.lib /nologo /subsystem:console /incremental:yes /stack:0x3b9aca00\
- /pdb:"$(OUTDIR)\spider.pdb" /debug /machine:I386 /out:"$(OUTDIR)\spider.exe"\
- /pdbtype:sept /libpath:"/Program files/Microsoft Visual Studio/DF98/lib/."
-LINK32_OBJS= \
-	"$(INTDIR)\acrs_2.obj" \
-	"$(INTDIR)\acrs_2s.obj" \
-	"$(INTDIR)\acrs_3.obj" \
-	"$(INTDIR)\acrs_3s.obj" \
-	"$(INTDIR)\add.obj" \
-	"$(INTDIR)\addfac.obj" \
-	"$(INTDIR)\adds.obj" \
-	"$(INTDIR)\ads.obj" \
-	"$(INTDIR)\af.obj" \
-	"$(INTDIR)\afs.obj" \
-	"$(INTDIR)\akima.obj" \
-	"$(INTDIR)\al10.obj" \
-	"$(INTDIR)\alphaint.obj" \
-	"$(INTDIR)\alprbs.obj" \
-	"$(INTDIR)\alprbs_q.obj" \
-	"$(INTDIR)\alrosf_q.obj" \
-	"$(INTDIR)\alrosi_q.obj" \
-	"$(INTDIR)\alrq.obj" \
-	"$(INTDIR)\alrq_m.obj" \
-	"$(INTDIR)\alrq_ms.obj" \
-	"$(INTDIR)\alrq_q.obj" \
-	"$(INTDIR)\alrqs.obj" \
-	"$(INTDIR)\amoeba.obj" \
-	"$(INTDIR)\ang.obj" \
-	"$(INTDIR)\ang_n.obj" \
-	"$(INTDIR)\angmor.obj" \
-	"$(INTDIR)\aniso.obj" \
-	"$(INTDIR)\anisoe.obj" \
-	"$(INTDIR)\anisof.obj" \
-	"$(INTDIR)\anisof3.obj" \
-	"$(INTDIR)\ap_end.obj" \
-	"$(INTDIR)\ap_getanga.obj" \
-	"$(INTDIR)\ap_getdat.obj" \
-	"$(INTDIR)\ap_getdats.obj" \
-	"$(INTDIR)\ap_stat.obj" \
-	"$(INTDIR)\apmaster.obj" \
-	"$(INTDIR)\apmaster_1.obj" \
-	"$(INTDIR)\applyw.obj" \
-	"$(INTDIR)\applyws.obj" \
-	"$(INTDIR)\aprings.obj" \
-	"$(INTDIR)\apshift.obj" \
-	"$(INTDIR)\arasq.obj" \
-	"$(INTDIR)\arbre.obj" \
-	"$(INTDIR)\arith.obj" \
-	"$(INTDIR)\arithl.obj" \
-	"$(INTDIR)\arithsca.obj" \
-	"$(INTDIR)\asta.obj" \
-	"$(INTDIR)\astcyl.obj" \
-	"$(INTDIR)\atit2.obj" \
-	"$(INTDIR)\atmc.obj" \
-	"$(INTDIR)\atpk.obj" \
-	"$(INTDIR)\atsa.obj" \
-	"$(INTDIR)\atwn.obj" \
-	"$(INTDIR)\averg.obj" \
-	"$(INTDIR)\averg3.obj" \
-	"$(INTDIR)\bckc0.obj" \
-	"$(INTDIR)\bckc2.obj" \
-	"$(INTDIR)\bckcq.obj" \
-	"$(INTDIR)\bcq.obj" \
-	"$(INTDIR)\besi0.obj" \
-	"$(INTDIR)\besi1.obj" \
-	"$(INTDIR)\betacf.obj" \
-	"$(INTDIR)\betai.obj" \
-	"$(INTDIR)\bfact.obj" \
-	"$(INTDIR)\bigalloc.obj" \
-	"$(INTDIR)\bigended.obj" \
-	"$(INTDIR)\blank.obj" \
-	"$(INTDIR)\bldr.obj" \
-	"$(INTDIR)\blob.obj" \
-	"$(INTDIR)\blob_q.obj" \
-	"$(INTDIR)\bmax_c.obj" \
-	"$(INTDIR)\bmax_s.obj" \
-	"$(INTDIR)\bmin_c.obj" \
-	"$(INTDIR)\bmin_s.obj" \
-	"$(INTDIR)\borns.obj" \
-	"$(INTDIR)\boxx.obj" \
-	"$(INTDIR)\bpcm.obj" \
-	"$(INTDIR)\bpcmp.obj" \
-	"$(INTDIR)\bpcq.obj" \
-	"$(INTDIR)\bpcqp.obj" \
-	"$(INTDIR)\bprj2.obj" \
-	"$(INTDIR)\bps2.obj" \
-	"$(INTDIR)\bpwr.obj" \
-	"$(INTDIR)\bpwr_q.obj" \
-	"$(INTDIR)\buildm.obj" \
-	"$(INTDIR)\builds.obj" \
-	"$(INTDIR)\buterp.obj" \
-	"$(INTDIR)\calc.obj" \
-	"$(INTDIR)\cald.obj" \
-	"$(INTDIR)\call3drminvn.obj" \
-	"$(INTDIR)\callrmfiltern.obj" \
-	"$(INTDIR)\callrminvn.obj" \
-	"$(INTDIR)\cang.obj" \
-	"$(INTDIR)\cc1gfilt.obj" \
-	"$(INTDIR)\ccc.obj" \
-	"$(INTDIR)\ccff.obj" \
-	"$(INTDIR)\ccfm.obj" \
-	"$(INTDIR)\ccfn.obj" \
-	"$(INTDIR)\ccfr.obj" \
-	"$(INTDIR)\cconect.obj" \
-	"$(INTDIR)\ccrd_2.obj" \
-	"$(INTDIR)\ccrd_3.obj" \
-	"$(INTDIR)\ccrd_ph_2.obj" \
-	"$(INTDIR)\ccrd_ph_3.obj" \
-	"$(INTDIR)\ccrs_2.obj" \
-	"$(INTDIR)\ccrs_3.obj" \
-	"$(INTDIR)\ccrs_ph_2.obj" \
-	"$(INTDIR)\ccrs_ph_3.obj" \
-	"$(INTDIR)\cengr3.obj" \
-	"$(INTDIR)\cent.obj" \
-	"$(INTDIR)\cent_3.obj" \
-	"$(INTDIR)\cent_d.obj" \
-	"$(INTDIR)\cent_q.obj" \
-	"$(INTDIR)\cgr_3.obj" \
-	"$(INTDIR)\changeval.obj" \
-	"$(INTDIR)\charinside.obj" \
-	"$(INTDIR)\chava.obj" \
-	"$(INTDIR)\chisq.obj" \
-	"$(INTDIR)\chkinpq.obj" \
-	"$(INTDIR)\chkstr.obj" \
-	"$(INTDIR)\clast.obj" \
-	"$(INTDIR)\clss.obj" \
-	"$(INTDIR)\clusterlst.obj" \
-	"$(INTDIR)\cncalc.obj" \
-	"$(INTDIR)\cnint3.obj" \
-	"$(INTDIR)\cnrd_2.obj" \
-	"$(INTDIR)\cnrd_3.obj" \
-	"$(INTDIR)\cnrs_2.obj" \
-	"$(INTDIR)\cnrs_3.obj" \
-	"$(INTDIR)\cnscan.obj" \
-	"$(INTDIR)\cnstuff.obj" \
-	"$(INTDIR)\cntrce.obj" \
-	"$(INTDIR)\cntrfl.obj" \
-	"$(INTDIR)\cntur.obj" \
-	"$(INTDIR)\comp3d.obj" \
-	"$(INTDIR)\comp3dmad.obj" \
-	"$(INTDIR)\conf.obj" \
-	"$(INTDIR)\conf1.obj" \
-	"$(INTDIR)\conint.obj" \
-	"$(INTDIR)\cop.obj" \
-	"$(INTDIR)\copd.obj" \
-	"$(INTDIR)\copy1.obj" \
-	"$(INTDIR)\copyangles.obj" \
-	"$(INTDIR)\copyangles_1.obj" \
-	"$(INTDIR)\copybrix.obj" \
-	"$(INTDIR)\copyccp4.obj" \
-	"$(INTDIR)\copyd.obj" \
-	"$(INTDIR)\copye.obj" \
-	"$(INTDIR)\copyemi.obj" \
-	"$(INTDIR)\copyf.obj" \
-	"$(INTDIR)\copyfromnik.obj" \
-	"$(INTDIR)\copyfromxplo.obj" \
-	"$(INTDIR)\copymrc.obj" \
-	"$(INTDIR)\copypds.obj" \
-	"$(INTDIR)\copypos.obj" \
-	"$(INTDIR)\copyr.obj" \
-	"$(INTDIR)\copytoxplor.obj" \
-	"$(INTDIR)\copyu.obj" \
-	"$(INTDIR)\corel.obj" \
-	"$(INTDIR)\corr1.obj" \
-	"$(INTDIR)\coupe.obj" \
-	"$(INTDIR)\cppb.obj" \
-	"$(INTDIR)\cproj.obj" \
-	"$(INTDIR)\cputrmn.obj" \
-	"$(INTDIR)\cr180_2.obj" \
-	"$(INTDIR)\crcse1.obj" \
-	"$(INTDIR)\crcse2.obj" \
-	"$(INTDIR)\crcse3.obj" \
-	"$(INTDIR)\crosrmg.obj" \
-	"$(INTDIR)\crosrng.obj" \
-	"$(INTDIR)\crosrng_ds.obj" \
-	"$(INTDIR)\crosrng_e.obj" \
-	"$(INTDIR)\crosrng_ms.obj" \
-	"$(INTDIR)\crosrng_q.obj" \
-	"$(INTDIR)\crsm_2.obj" \
-	"$(INTDIR)\cslice.obj" \
-	"$(INTDIR)\csvms.obj" \
-	"$(INTDIR)\cutxslice.obj" \
-	"$(INTDIR)\cutyslice.obj" \
-	"$(INTDIR)\cutzslice.obj" \
-	"$(INTDIR)\d3dplt.obj" \
-	"$(INTDIR)\date.obj" \
-	"$(INTDIR)\date_2k.obj" \
-	"$(INTDIR)\dchist.obj" \
-	"$(INTDIR)\decimate.obj" \
-	"$(INTDIR)\dee.obj" \
-	"$(INTDIR)\defo001.obj" \
-	"$(INTDIR)\defo003.obj" \
-	"$(INTDIR)\defo1001.obj" \
-	"$(INTDIR)\defo2001.obj" \
-	"$(INTDIR)\defocus.obj" \
-	"$(INTDIR)\deletf.obj" \
-	"$(INTDIR)\dendro.obj" \
-	"$(INTDIR)\dendro2.obj" \
-	"$(INTDIR)\denlst.obj" \
-	"$(INTDIR)\denov.obj" \
-	"$(INTDIR)\deucl.obj" \
-	"$(INTDIR)\dhide.obj" \
-	"$(INTDIR)\diff1o.obj" \
-	"$(INTDIR)\dilation.obj" \
-	"$(INTDIR)\dirnm.obj" \
-	"$(INTDIR)\disc.obj" \
-	"$(INTDIR)\discrim.obj" \
-	"$(INTDIR)\dist1.obj" \
-	"$(INTDIR)\dist2.obj" \
-	"$(INTDIR)\dist4.obj" \
-	"$(INTDIR)\dist_p.obj" \
-	"$(INTDIR)\distest.obj" \
-	"$(INTDIR)\divcr3.obj" \
-	"$(INTDIR)\docorr3_s.obj" \
-	"$(INTDIR)\docors3_s.obj" \
-	"$(INTDIR)\docs1.obj" \
-	"$(INTDIR)\domax3_s.obj" \
-	"$(INTDIR)\domin3_s.obj" \
-	"$(INTDIR)\dprofd.obj" \
-	"$(INTDIR)\dprofl.obj" \
-	"$(INTDIR)\driv1.obj" \
-	"$(INTDIR)\driv2.obj" \
-	"$(INTDIR)\driv3.obj" \
-	"$(INTDIR)\dsfs_p.obj" \
-	"$(INTDIR)\dsgr_p.obj" \
-	"$(INTDIR)\dsgr_pm.obj" \
-	"$(INTDIR)\dsgrs.obj" \
-	"$(INTDIR)\dust.obj" \
-	"$(INTDIR)\dvcr.obj" \
-	"$(INTDIR)\edge.obj" \
-	"$(INTDIR)\edm.obj" \
-	"$(INTDIR)\eff.obj" \
-	"$(INTDIR)\ehist.obj" \
-	"$(INTDIR)\empsli.obj" \
-	"$(INTDIR)\endit.obj" \
-	"$(INTDIR)\ener.obj" \
-	"$(INTDIR)\enfr_2.obj" \
-	"$(INTDIR)\enhanc.obj" \
-	"$(INTDIR)\entrop.obj" \
-	"$(INTDIR)\envelope.obj" \
-	"$(INTDIR)\epur4.obj" \
-	"$(INTDIR)\erc.obj" \
-	"$(INTDIR)\erosion.obj" \
-	"$(INTDIR)\errf2.obj" \
-	"$(INTDIR)\erri2.obj" \
-	"$(INTDIR)\errt.obj" \
-	"$(INTDIR)\evalnq.obj" \
-	"$(INTDIR)\evalsympar.obj" \
-	"$(INTDIR)\express3q.obj" \
-	"$(INTDIR)\exprq.obj" \
-	"$(INTDIR)\extractline.obj" \
-	"$(INTDIR)\extractplane.obj" \
-	"$(INTDIR)\f3mr.obj" \
-	"$(INTDIR)\falb.obj" \
-	"$(INTDIR)\fallg.obj" \
-	"$(INTDIR)\fcnq.obj" \
-	"$(INTDIR)\fermp.obj" \
-	"$(INTDIR)\ffilts.obj" \
-	"$(INTDIR)\fftc_d.obj" \
-	"$(INTDIR)\fftc_q.obj" \
-	"$(INTDIR)\fftmcf.obj" \
-	"$(INTDIR)\fftr_d.obj" \
-	"$(INTDIR)\fftr_q.obj" \
-	"$(INTDIR)\fgr.obj" \
-	"$(INTDIR)\fhodt.obj" \
-	"$(INTDIR)\filcad.obj" \
-	"$(INTDIR)\filcan.obj" \
-	"$(INTDIR)\fildat.obj" \
-	"$(INTDIR)\filelist.obj" \
-	"$(INTDIR)\filerd.obj" \
-	"$(INTDIR)\filgen.obj" \
-	"$(INTDIR)\filget.obj" \
-	"$(INTDIR)\filnamandext.obj" \
-	"$(INTDIR)\filnamsub.obj" \
-	"$(INTDIR)\filseqp.obj" \
-	"$(INTDIR)\filsli.obj" \
-	"$(INTDIR)\filtdoc.obj" \
-	"$(INTDIR)\filter.obj" \
-	"$(INTDIR)\filter_har.obj" \
-	"$(INTDIR)\filtplot.obj" \
-	"$(INTDIR)\findfrq.obj" \
-	"$(INTDIR)\findlbq.obj" \
-	"$(INTDIR)\findmx.obj" \
-	"$(INTDIR)\findmx_f.obj" \
-	"$(INTDIR)\findmx_q.obj" \
-	"$(INTDIR)\fint.obj" \
-	"$(INTDIR)\fint3.obj" \
-	"$(INTDIR)\fitt.obj" \
-	"$(INTDIR)\flushfile.obj" \
-	"$(INTDIR)\flushresults.obj" \
-	"$(INTDIR)\fmax_c.obj" \
-	"$(INTDIR)\fmax_q.obj" \
-	"$(INTDIR)\fmax_s.obj" \
-	"$(INTDIR)\fmin_c.obj" \
-	"$(INTDIR)\fmin_q.obj" \
-	"$(INTDIR)\fmin_s.obj" \
-	"$(INTDIR)\fmr_1.obj" \
-	"$(INTDIR)\fmr_2.obj" \
-	"$(INTDIR)\fmrs_1.obj" \
-	"$(INTDIR)\fmrs_1d.obj" \
-	"$(INTDIR)\fmrs_2.obj" \
-	"$(INTDIR)\fmrs_2dr.obj" \
-	"$(INTDIR)\fmrs_2r.obj" \
-	"$(INTDIR)\fmrs_3.obj" \
-	"$(INTDIR)\fmrs_3dr.obj" \
-	"$(INTDIR)\fmrs_3r.obj" \
-	"$(INTDIR)\fnrm.obj" \
-	"$(INTDIR)\four1.obj" \
-	"$(INTDIR)\four1a.obj" \
-	"$(INTDIR)\four1a_fp.obj" \
-	"$(INTDIR)\four1b.obj" \
-	"$(INTDIR)\four1c.obj" \
-	"$(INTDIR)\fouradcalln.obj" \
-	"$(INTDIR)\fouradinvcn.obj" \
-	"$(INTDIR)\fouradinvn.obj" \
-	"$(INTDIR)\fouradn.obj" \
-	"$(INTDIR)\fouring.obj" \
-	"$(INTDIR)\fouring_q.obj" \
-	"$(INTDIR)\fq3_p.obj" \
-	"$(INTDIR)\fq_q.obj" \
-	"$(INTDIR)\frng.obj" \
-	"$(INTDIR)\frngs.obj" \
-	"$(INTDIR)\fromtoq.obj" \
-	"$(INTDIR)\fsort.obj" \
-	"$(INTDIR)\ftr.obj" \
-	"$(INTDIR)\fv.obj" \
-	"$(INTDIR)\gali.obj" \
-	"$(INTDIR)\gali_p.obj" \
-	"$(INTDIR)\gam.obj" \
-	"$(INTDIR)\gammln.obj" \
-	"$(INTDIR)\gaussp.obj" \
-	"$(INTDIR)\gee.obj" \
-	"$(INTDIR)\getcoo.obj" \
-	"$(INTDIR)\getcoot.obj" \
-	"$(INTDIR)\getdefocus.obj" \
-	"$(INTDIR)\getdocdat.obj" \
-	"$(INTDIR)\getdoclist.obj" \
-	"$(INTDIR)\getfilenum.obj" \
-	"$(INTDIR)\gethedccp4.obj" \
-	"$(INTDIR)\getima_q.obj" \
-	"$(INTDIR)\getlab.obj" \
-	"$(INTDIR)\getlbno.obj" \
-	"$(INTDIR)\getnewstack.obj" \
-	"$(INTDIR)\getnexttoken.obj" \
-	"$(INTDIR)\getoldstack.obj" \
-	"$(INTDIR)\getstack.obj" \
-	"$(INTDIR)\getsym.obj" \
-	"$(INTDIR)\getthreads.obj" \
-	"$(INTDIR)\gnc.obj" \
-	"$(INTDIR)\gnc2s.obj" \
-	"$(INTDIR)\gotbranch.obj" \
-	"$(INTDIR)\gp.obj" \
-	"$(INTDIR)\gprp.obj" \
-	"$(INTDIR)\graphp.obj" \
-	"$(INTDIR)\graphs.obj" \
-	"$(INTDIR)\gsmod.obj" \
-	"$(INTDIR)\gsmodl.obj" \
-	"$(INTDIR)\hali.obj" \
-	"$(INTDIR)\hali_p.obj" \
-	"$(INTDIR)\hclp.obj" \
-	"$(INTDIR)\hcls.obj" \
-	"$(INTDIR)\hdiag.obj" \
-	"$(INTDIR)\hdls.obj" \
-	"$(INTDIR)\hels.obj" \
-	"$(INTDIR)\hf.obj" \
-	"$(INTDIR)\hgr.obj" \
-	"$(INTDIR)\hi_1d.obj" \
-	"$(INTDIR)\hiang.obj" \
-	"$(INTDIR)\hisd.obj" \
-	"$(INTDIR)\hismap.obj" \
-	"$(INTDIR)\hismap4.obj" \
-	"$(INTDIR)\hist.obj" \
-	"$(INTDIR)\histe.obj" \
-	"$(INTDIR)\histod.obj" \
-	"$(INTDIR)\histodc.obj" \
-	"$(INTDIR)\hkmc.obj" \
-	"$(INTDIR)\hotelling.obj" \
-	"$(INTDIR)\hotm.obj" \
-	"$(INTDIR)\iftorpn.obj" \
-	"$(INTDIR)\imseq4.obj" \
-	"$(INTDIR)\imsq.obj" \
-	"$(INTDIR)\imstat.obj" \
-	"$(INTDIR)\imtovol.obj" \
-	"$(INTDIR)\incor3.obj" \
-	"$(INTDIR)\incort.obj" \
-	"$(INTDIR)\inf3_p.obj" \
-	"$(INTDIR)\inf_q.obj" \
-	"$(INTDIR)\initunix.obj" \
-	"$(INTDIR)\inlnbuf.obj" \
-	"$(INTDIR)\inquirealloc.obj" \
-	"$(INTDIR)\inquirearch.obj" \
-	"$(INTDIR)\inquireif.obj" \
-	"$(INTDIR)\inquireif1.obj" \
-	"$(INTDIR)\inquirereg.obj" \
-	"$(INTDIR)\inquiresync.obj" \
-	"$(INTDIR)\interp.obj" \
-	"$(INTDIR)\interp3.obj" \
-	"$(INTDIR)\inttochar.obj" \
-	"$(INTDIR)\invbt.obj" \
-	"$(INTDIR)\invgdist.obj" \
-	"$(INTDIR)\ipalign64.obj" \
-	"$(INTDIR)\irmrecord.obj" \
-	"$(INTDIR)\irp3.obj" \
-	"$(INTDIR)\isbare.obj" \
-	"$(INTDIR)\ischar.obj" \
-	"$(INTDIR)\isdigi.obj" \
-	"$(INTDIR)\isdocincore.obj" \
-	"$(INTDIR)\itpow.obj" \
-	"$(INTDIR)\johist.obj" \
-	"$(INTDIR)\johistf.obj" \
-	"$(INTDIR)\jpmsk1.obj" \
-	"$(INTDIR)\jpmsk2.obj" \
-	"$(INTDIR)\jpmsk3.obj" \
-	"$(INTDIR)\labelspi.obj" \
-	"$(INTDIR)\lastoccur.obj" \
-	"$(INTDIR)\latcen.obj" \
-	"$(INTDIR)\latice.obj" \
-	"$(INTDIR)\lenopenfile.obj" \
-	"$(INTDIR)\lhist.obj" \
-	"$(INTDIR)\listdc.obj" \
-	"$(INTDIR)\listit.obj" \
-	"$(INTDIR)\listitr.obj" \
-	"$(INTDIR)\listregs.obj" \
-	"$(INTDIR)\lmdif.obj" \
-	"$(INTDIR)\lmdif1.obj" \
-	"$(INTDIR)\lnblnk.obj" \
-	"$(INTDIR)\lnblnkn.obj" \
-	"$(INTDIR)\local.obj" \
-	"$(INTDIR)\log2.obj" \
-	"$(INTDIR)\logifq.obj" \
-	"$(INTDIR)\longer.obj" \
-	"$(INTDIR)\lundoc.obj" \
-	"$(INTDIR)\lunsethdr.obj" \
-	"$(INTDIR)\macf.obj" \
-	"$(INTDIR)\macf_p.obj" \
-	"$(INTDIR)\mahal.obj" \
-	"$(INTDIR)\maktab.obj" \
-	"$(INTDIR)\malfi3.obj" \
-	"$(INTDIR)\mapdist.obj" \
-	"$(INTDIR)\mapdoc.obj" \
-	"$(INTDIR)\mapfilt.obj" \
-	"$(INTDIR)\mapim.obj" \
-	"$(INTDIR)\mapstat.obj" \
-	"$(INTDIR)\mask.obj" \
-	"$(INTDIR)\maskmu.obj" \
-	"$(INTDIR)\matinv.obj" \
-	"$(INTDIR)\maxf.obj" \
-	"$(INTDIR)\mccf.obj" \
-	"$(INTDIR)\mccf_p.obj" \
-	"$(INTDIR)\mcircl.obj" \
-	"$(INTDIR)\md2.obj" \
-	"$(INTDIR)\md3.obj" \
-	"$(INTDIR)\median.obj" \
-	"$(INTDIR)\meed.obj" \
-	"$(INTDIR)\mehist.obj" \
-	"$(INTDIR)\mhelp.obj" \
-	"$(INTDIR)\mhelp_sub.obj" \
-	"$(INTDIR)\mirror.obj" \
-	"$(INTDIR)\mjc.obj" \
-	"$(INTDIR)\mlc.obj" \
-	"$(INTDIR)\mline.obj" \
-	"$(INTDIR)\mline3.obj" \
-	"$(INTDIR)\mls.obj" \
-	"$(INTDIR)\mod1.obj" \
-	"$(INTDIR)\model.obj" \
-	"$(INTDIR)\model3.obj" \
-	"$(INTDIR)\mont.obj" \
-	"$(INTDIR)\mpoint.obj" \
-	"$(INTDIR)\mr2to3d.obj" \
-	"$(INTDIR)\mralign.obj" \
-	"$(INTDIR)\mrand.obj" \
-	"$(INTDIR)\mrang2.obj" \
-	"$(INTDIR)\mrcalerr.obj" \
-	"$(INTDIR)\mrcenti.obj" \
-	"$(INTDIR)\mrcg3.obj" \
-	"$(INTDIR)\mrcg3d.obj" \
-	"$(INTDIR)\mrcp.obj" \
-	"$(INTDIR)\mrdoc.obj" \
-	"$(INTDIR)\mrdoccor.obj" \
-	"$(INTDIR)\mread.obj" \
-	"$(INTDIR)\mrectl.obj" \
-	"$(INTDIR)\mreigen.obj" \
-	"$(INTDIR)\mrerror.obj" \
-	"$(INTDIR)\mrfft.obj" \
-	"$(INTDIR)\mrfour1.obj" \
-	"$(INTDIR)\mrgetinfo.obj" \
-	"$(INTDIR)\mrk.obj" \
-	"$(INTDIR)\mrk3.obj" \
-	"$(INTDIR)\mrkur3.obj" \
-	"$(INTDIR)\mrncolor.obj" \
-	"$(INTDIR)\mrnewangle.obj" \
-	"$(INTDIR)\mrproj.obj" \
-	"$(INTDIR)\mrprrep.obj" \
-	"$(INTDIR)\mrputinfo.obj" \
-	"$(INTDIR)\mrqli_ps.obj" \
-	"$(INTDIR)\mrqli_ss.obj" \
-	"$(INTDIR)\mrquater.obj" \
-	"$(INTDIR)\mrrefl.obj" \
-	"$(INTDIR)\mrreplace.obj" \
-	"$(INTDIR)\mrrmake.obj" \
-	"$(INTDIR)\mrrotate.obj" \
-	"$(INTDIR)\mrrsurf.obj" \
-	"$(INTDIR)\mrrt.obj" \
-	"$(INTDIR)\mrscale.obj" \
-	"$(INTDIR)\mrscale3.obj" \
-	"$(INTDIR)\mrshift.obj" \
-	"$(INTDIR)\mrsurf.obj" \
-	"$(INTDIR)\mrtheta.obj" \
-	"$(INTDIR)\msum.obj" \
-	"$(INTDIR)\mtnv.obj" \
-	"$(INTDIR)\mtpr.obj" \
-	"$(INTDIR)\mtrian.obj" \
-	"$(INTDIR)\mulf2.obj" \
-	"$(INTDIR)\mulf3.obj" \
-	"$(INTDIR)\mulfc3.obj" \
-	"$(INTDIR)\mulfi3.obj" \
-	"$(INTDIR)\mult.obj" \
-	"$(INTDIR)\multishift.obj" \
-	"$(INTDIR)\mx.obj" \
-	"$(INTDIR)\mygetenv.obj" \
-	"$(INTDIR)\mymods.obj" \
-	"$(INTDIR)\myread.obj" \
-	"$(INTDIR)\mytime.obj" \
-	"$(INTDIR)\mywr0.obj" \
-	"$(INTDIR)\mywr1.obj" \
-	"$(INTDIR)\mywr2.obj" \
-	"$(INTDIR)\narea.obj" \
-	"$(INTDIR)\negate.obj" \
-	"$(INTDIR)\negati.obj" \
-	"$(INTDIR)\newkmeans.obj" \
-	"$(INTDIR)\nextversion.obj" \
-	"$(INTDIR)\nfq.obj" \
-	"$(INTDIR)\ngq.obj" \
-	"$(INTDIR)\nn24.obj" \
-	"$(INTDIR)\nn4.obj" \
-	"$(INTDIR)\noise.obj" \
-	"$(INTDIR)\norm3.obj" \
-	"$(INTDIR)\normas.obj" \
-	"$(INTDIR)\normasc.obj" \
-	"$(INTDIR)\normass.obj" \
-	"$(INTDIR)\normm.obj" \
-	"$(INTDIR)\norppf.obj" \
-	"$(INTDIR)\noyau.obj" \
-	"$(INTDIR)\nrml.obj" \
-	"$(INTDIR)\nrms.obj" \
-	"$(INTDIR)\nrq.obj" \
-	"$(INTDIR)\nt32.obj" \
-	"$(INTDIR)\numdig.obj" \
-	"$(INTDIR)\od.obj" \
-	"$(INTDIR)\oneline.obj" \
-	"$(INTDIR)\onelinedel.obj" \
-	"$(INTDIR)\onelinem.obj" \
-	"$(INTDIR)\opauxfile.obj" \
-	"$(INTDIR)\openchk.obj" \
-	"$(INTDIR)\opendoc.obj" \
-	"$(INTDIR)\openfil.obj" \
-	"$(INTDIR)\openinln.obj" \
-	"$(INTDIR)\openinstk.obj" \
-	"$(INTDIR)\openstk.obj" \
-	"$(INTDIR)\opfilec.obj" \
-	"$(INTDIR)\opsf3_p.obj" \
-	"$(INTDIR)\opsf_p.obj" \
-	"$(INTDIR)\oracfmsk.obj" \
-	"$(INTDIR)\oracfmskm.obj" \
-	"$(INTDIR)\orcdf.obj" \
-	"$(INTDIR)\orient.obj" \
-	"$(INTDIR)\ormd.obj" \
-	"$(INTDIR)\ormd_p.obj" \
-	"$(INTDIR)\outim_q.obj" \
-	"$(INTDIR)\outpr.obj" \
-	"$(INTDIR)\outrng.obj" \
-	"$(INTDIR)\parabl.obj" \
-	"$(INTDIR)\parabld.obj" \
-	"$(INTDIR)\parsesympar.obj" \
-	"$(INTDIR)\parst.obj" \
-	"$(INTDIR)\patch.obj" \
-	"$(INTDIR)\pdates.obj" \
-	"$(INTDIR)\pdb.obj" \
-	"$(INTDIR)\picksl.obj" \
-	"$(INTDIR)\picksv.obj" \
-	"$(INTDIR)\pj3.obj" \
-	"$(INTDIR)\pj3_n.obj" \
-	"$(INTDIR)\pj3q.obj" \
-	"$(INTDIR)\pj3q_n.obj" \
-	"$(INTDIR)\pkd.obj" \
-	"$(INTDIR)\pksr3.obj" \
-	"$(INTDIR)\plnedg.obj" \
-	"$(INTDIR)\plot1.obj" \
-	"$(INTDIR)\plot2.obj" \
-	"$(INTDIR)\poj.obj" \
-	"$(INTDIR)\polar_cc.obj" \
-	"$(INTDIR)\polfit.obj" \
-	"$(INTDIR)\polish.obj" \
-	"$(INTDIR)\pollsq.obj" \
-	"$(INTDIR)\polqs.obj" \
-	"$(INTDIR)\posaxis.obj" \
-	"$(INTDIR)\postrt.obj" \
-	"$(INTDIR)\pr3d.obj" \
-	"$(INTDIR)\pr3db.obj" \
-	"$(INTDIR)\prb1d.obj" \
-	"$(INTDIR)\prepcub_q.obj" \
-	"$(INTDIR)\prepcub_q_n.obj" \
-	"$(INTDIR)\prepcub_s.obj" \
-	"$(INTDIR)\prepsl_2.obj" \
-	"$(INTDIR)\prjc0.obj" \
-	"$(INTDIR)\prjc2.obj" \
-	"$(INTDIR)\prjcq.obj" \
-	"$(INTDIR)\prjs2.obj" \
-	"$(INTDIR)\prober.obj" \
-	"$(INTDIR)\proc_set.obj" \
-	"$(INTDIR)\prp.obj" \
-	"$(INTDIR)\prt.obj" \
-	"$(INTDIR)\pttern.obj" \
-	"$(INTDIR)\putlin.obj" \
-	"$(INTDIR)\putline3.obj" \
-	"$(INTDIR)\putpt.obj" \
-	"$(INTDIR)\putpt1.obj" \
-	"$(INTDIR)\putpt2.obj" \
-	"$(INTDIR)\putrmn.obj" \
-	"$(INTDIR)\putrmrealn.obj" \
-	"$(INTDIR)\putyslice.obj" \
-	"$(INTDIR)\putzslice.obj" \
-	"$(INTDIR)\pw2sdr.obj" \
-	"$(INTDIR)\pw2sr.obj" \
-	"$(INTDIR)\pw3sdr.obj" \
-	"$(INTDIR)\pw3sr.obj" \
-	"$(INTDIR)\qali.obj" \
-	"$(INTDIR)\qfact.obj" \
-	"$(INTDIR)\qfact_p.obj" \
-	"$(INTDIR)\qnrf.obj" \
-	"$(INTDIR)\qphi.obj" \
-	"$(INTDIR)\qstat.obj" \
-	"$(INTDIR)\qtheta.obj" \
-	"$(INTDIR)\quadri.obj" \
-	"$(INTDIR)\quadri_q.obj" \
-	"$(INTDIR)\rad2calln.obj" \
-	"$(INTDIR)\radav.obj" \
-	"$(INTDIR)\radavi.obj" \
-	"$(INTDIR)\radcompleten.obj" \
-	"$(INTDIR)\radon2en.obj" \
-	"$(INTDIR)\radon3dn.obj" \
-	"$(INTDIR)\radweight.obj" \
-	"$(INTDIR)\ramp_p.obj" \
-	"$(INTDIR)\rand_p.obj" \
-	"$(INTDIR)\rann.obj" \
-	"$(INTDIR)\rathin.obj" \
-	"$(INTDIR)\rawtospider.obj" \
-	"$(INTDIR)\rclu.obj" \
-	"$(INTDIR)\rcnv2_p.obj" \
-	"$(INTDIR)\rcnv3_p.obj" \
-	"$(INTDIR)\rconv.obj" \
-	"$(INTDIR)\rctf.obj" \
-	"$(INTDIR)\rctfss.obj" \
-	"$(INTDIR)\rdclus.obj" \
-	"$(INTDIR)\rddocn.obj" \
-	"$(INTDIR)\rdfc.obj" \
-	"$(INTDIR)\rdpa.obj" \
-	"$(INTDIR)\rdpr.obj" \
-	"$(INTDIR)\rdpra.obj" \
-	"$(INTDIR)\rdprai.obj" \
-	"$(INTDIR)\rdpranc.obj" \
-	"$(INTDIR)\rdpri1s.obj" \
-	"$(INTDIR)\rdpri3s.obj" \
-	"$(INTDIR)\rdprinc.obj" \
-	"$(INTDIR)\rdpris.obj" \
-	"$(INTDIR)\rdprm.obj" \
-	"$(INTDIR)\rdprm1s.obj" \
-	"$(INTDIR)\rdprm2.obj" \
-	"$(INTDIR)\rdprm2s.obj" \
-	"$(INTDIR)\rdprm3s.obj" \
-	"$(INTDIR)\rdprmc.obj" \
-	"$(INTDIR)\rdprmi.obj" \
-	"$(INTDIR)\rdprop.obj" \
-	"$(INTDIR)\rdsl_p.obj" \
-	"$(INTDIR)\readpdb.obj" \
-	"$(INTDIR)\readrq.obj" \
-	"$(INTDIR)\reads.obj" \
-	"$(INTDIR)\readv.obj" \
-	"$(INTDIR)\redhedmrc.obj" \
-	"$(INTDIR)\redlin.obj" \
-	"$(INTDIR)\redlin8.obj" \
-	"$(INTDIR)\redpro2.obj" \
-	"$(INTDIR)\redprq.obj" \
-	"$(INTDIR)\redrec8.obj" \
-	"$(INTDIR)\redvol.obj" \
-	"$(INTDIR)\reform.obj" \
-	"$(INTDIR)\reform0.obj" \
-	"$(INTDIR)\reg_set.obj" \
-	"$(INTDIR)\regparse.obj" \
-	"$(INTDIR)\remez.obj" \
-	"$(INTDIR)\remezp.obj" \
-	"$(INTDIR)\repcg.obj" \
-	"$(INTDIR)\repr2_s.obj" \
-	"$(INTDIR)\reprwb.obj" \
-	"$(INTDIR)\reps.obj" \
-	"$(INTDIR)\retir.obj" \
-	"$(INTDIR)\reversebytes.obj" \
-	"$(INTDIR)\rew.obj" \
-	"$(INTDIR)\rewf.obj" \
-	"$(INTDIR)\rfactsd2.obj" \
-	"$(INTDIR)\rfactsdo.obj" \
-	"$(INTDIR)\rgri.obj" \
-	"$(INTDIR)\ringwe.obj" \
-	"$(INTDIR)\rmfilterz.obj" \
-	"$(INTDIR)\rmfilty.obj" \
-	"$(INTDIR)\rmfiltz.obj" \
-	"$(INTDIR)\rminvn.obj" \
-	"$(INTDIR)\rmiwf.obj" \
-	"$(INTDIR)\rmmakemask.obj" \
-	"$(INTDIR)\rmrepl.obj" \
-	"$(INTDIR)\rmreset.obj" \
-	"$(INTDIR)\rmtransfer.obj" \
-	"$(INTDIR)\rmz_p.obj" \
-	"$(INTDIR)\rot2qs.obj" \
-	"$(INTDIR)\rot3.obj" \
-	"$(INTDIR)\rot32.obj" \
-	"$(INTDIR)\rot3_p.obj" \
-	"$(INTDIR)\rot_p.obj" \
-	"$(INTDIR)\rotal3.obj" \
-	"$(INTDIR)\rotas3.obj" \
-	"$(INTDIR)\rotl3.obj" \
-	"$(INTDIR)\rotl3q.obj" \
-	"$(INTDIR)\rotqs.obj" \
-	"$(INTDIR)\rots3.obj" \
-	"$(INTDIR)\rots3q.obj" \
-	"$(INTDIR)\rprq.obj" \
-	"$(INTDIR)\rtq.obj" \
-	"$(INTDIR)\rtq_q.obj" \
-	"$(INTDIR)\rtqs.obj" \
-	"$(INTDIR)\rtqs_q.obj" \
-	"$(INTDIR)\rys1.obj" \
-	"$(INTDIR)\rys3.obj" \
-	"$(INTDIR)\saqb.obj" \
-	"$(INTDIR)\saqb_f.obj" \
-	"$(INTDIR)\saqb_p.obj" \
-	"$(INTDIR)\savd.obj" \
-	"$(INTDIR)\savdn1.obj" \
-	"$(INTDIR)\savdocq.obj" \
-	"$(INTDIR)\sclassi.obj" \
-	"$(INTDIR)\scoran3.obj" \
-	"$(INTDIR)\sdocic.obj" \
-	"$(INTDIR)\searchq.obj" \
-	"$(INTDIR)\secnds.obj" \
-	"$(INTDIR)\seedfill.obj" \
-	"$(INTDIR)\seeds.obj" \
-	"$(INTDIR)\sen3a.obj" \
-	"$(INTDIR)\setenv.obj" \
-	"$(INTDIR)\sethedccp4.obj" \
-	"$(INTDIR)\setlab.obj" \
-	"$(INTDIR)\setmode.obj" \
-	"$(INTDIR)\setpart.obj" \
-	"$(INTDIR)\setprm.obj" \
-	"$(INTDIR)\setprmb.obj" \
-	"$(INTDIR)\setsympar.obj" \
-	"$(INTDIR)\setthreads.obj" \
-	"$(INTDIR)\setval.obj" \
-	"$(INTDIR)\sgraf.obj" \
-	"$(INTDIR)\sh180_2.obj" \
-	"$(INTDIR)\shelk.obj" \
-	"$(INTDIR)\shfc_2.obj" \
-	"$(INTDIR)\shfi_2.obj" \
-	"$(INTDIR)\shfi_q.obj" \
-	"$(INTDIR)\shfm_2.obj" \
-	"$(INTDIR)\shift1.obj" \
-	"$(INTDIR)\shift2.obj" \
-	"$(INTDIR)\shift3.obj" \
-	"$(INTDIR)\shift_3d.obj" \
-	"$(INTDIR)\shift_pf.obj" \
-	"$(INTDIR)\shiftr.obj" \
-	"$(INTDIR)\shiftt.obj" \
-	"$(INTDIR)\shosli.obj" \
-	"$(INTDIR)\shosli2.obj" \
-	"$(INTDIR)\shr.obj" \
-	"$(INTDIR)\shrinkq.obj" \
-	"$(INTDIR)\shuffledoc.obj" \
-	"$(INTDIR)\single.obj" \
-	"$(INTDIR)\skeleton.obj" \
-	"$(INTDIR)\slice.obj" \
-	"$(INTDIR)\smt3.obj" \
-	"$(INTDIR)\smt3_q.obj" \
-	"$(INTDIR)\snrb.obj" \
-	"$(INTDIR)\snrf.obj" \
-	"$(INTDIR)\solv2d.obj" \
-	"$(INTDIR)\solve.obj" \
-	"$(INTDIR)\sort.obj" \
-	"$(INTDIR)\sortdoc.obj" \
-	"$(INTDIR)\sortint.obj" \
-	"$(INTDIR)\sortz.obj" \
-	"$(INTDIR)\spdtotiff.obj" \
-	"$(INTDIR)\speak.obj" \
-	"$(INTDIR)\speak3.obj" \
-	"$(INTDIR)\speakc.obj" \
-	"$(INTDIR)\speakm.obj" \
-	"$(INTDIR)\speakr.obj" \
-	"$(INTDIR)\spider.obj" \
-	"$(INTDIR)\spireout.obj" \
-	"$(INTDIR)\spitosgi.obj" \
-	"$(INTDIR)\spotwt.obj" \
-	"$(INTDIR)\squeez.obj" \
-	"$(INTDIR)\sslowcas.obj" \
-	"$(INTDIR)\ssnr.obj" \
-	"$(INTDIR)\ssnr3.obj" \
-	"$(INTDIR)\ssnr3dnn.obj" \
-	"$(INTDIR)\ssnrb.obj" \
-	"$(INTDIR)\sspush.obj" \
-	"$(INTDIR)\ssupcas.obj" \
-	"$(INTDIR)\stabk.obj" \
-	"$(INTDIR)\stack.obj" \
-	"$(INTDIR)\step.obj" \
-	"$(INTDIR)\stepi.obj" \
-	"$(INTDIR)\subaf.obj" \
-	"$(INTDIR)\subchar.obj" \
-	"$(INTDIR)\subkmeans.obj" \
-	"$(INTDIR)\subkmns.obj" \
-	"$(INTDIR)\subsympar.obj" \
-	"$(INTDIR)\sumali.obj" \
-	"$(INTDIR)\sumali3.obj" \
-	"$(INTDIR)\sumap.obj" \
-	"$(INTDIR)\sumeuler.obj" \
-	"$(INTDIR)\sunonly.obj" \
-	"$(INTDIR)\surfarea.obj" \
-	"$(INTDIR)\surfcomp.obj" \
-	"$(INTDIR)\surffit.obj" \
-	"$(INTDIR)\surftovol.obj" \
-	"$(INTDIR)\symang.obj" \
-	"$(INTDIR)\symangs.obj" \
-	"$(INTDIR)\sympar.obj" \
-	"$(INTDIR)\symvol.obj" \
-	"$(INTDIR)\tcnp.obj" \
-	"$(INTDIR)\tf.obj" \
-	"$(INTDIR)\tfcrf.obj" \
-	"$(INTDIR)\tfd.obj" \
-	"$(INTDIR)\tfed.obj" \
-	"$(INTDIR)\tfsnr.obj" \
-	"$(INTDIR)\thresh.obj" \
-	"$(INTDIR)\tilt.obj" \
-	"$(INTDIR)\tiltfd.obj" \
-	"$(INTDIR)\tima.obj" \
-	"$(INTDIR)\title.obj" \
-	"$(INTDIR)\to_polar.obj" \
-	"$(INTDIR)\toma.obj" \
-	"$(INTDIR)\totrec.obj" \
-	"$(INTDIR)\tpaired.obj" \
-	"$(INTDIR)\traf.obj" \
-	"$(INTDIR)\trafc.obj" \
-	"$(INTDIR)\trafc3.obj" \
-	"$(INTDIR)\trafct3.obj" \
-	"$(INTDIR)\trafd.obj" \
-	"$(INTDIR)\trafl.obj" \
-	"$(INTDIR)\trafsim.obj" \
-	"$(INTDIR)\transpose.obj" \
-	"$(INTDIR)\tridi.obj" \
-	"$(INTDIR)\trinter.obj" \
-	"$(INTDIR)\triquad.obj" \
-	"$(INTDIR)\tswitch.obj" \
-	"$(INTDIR)\ttest.obj" \
-	"$(INTDIR)\ttest1.obj" \
-	"$(INTDIR)\tvwn1.obj" \
-	"$(INTDIR)\tvwn3.obj" \
-	"$(INTDIR)\udoc.obj" \
-	"$(INTDIR)\udocic.obj" \
-	"$(INTDIR)\unixtounix8.obj" \
-	"$(INTDIR)\unixtovv.obj" \
-	"$(INTDIR)\unsav.obj" \
-	"$(INTDIR)\unsdal.obj" \
-	"$(INTDIR)\updf.obj" \
-	"$(INTDIR)\updtc.obj" \
-	"$(INTDIR)\updtf.obj" \
-	"$(INTDIR)\updtf_r.obj" \
-	"$(INTDIR)\uqu.obj" \
-	"$(INTDIR)\util1.obj" \
-	"$(INTDIR)\util2.obj" \
-	"$(INTDIR)\util2sup.obj" \
-	"$(INTDIR)\util3.obj" \
-	"$(INTDIR)\util4.obj" \
-	"$(INTDIR)\util5.obj" \
-	"$(INTDIR)\util6.obj" \
-	"$(INTDIR)\var3c.obj" \
-	"$(INTDIR)\var3d.obj" \
-	"$(INTDIR)\var3disk.obj" \
-	"$(INTDIR)\var3r.obj" \
-	"$(INTDIR)\varf.obj" \
-	"$(INTDIR)\varf1.obj" \
-	"$(INTDIR)\vax32u.obj" \
-	"$(INTDIR)\vaxtounix.obj" \
-	"$(INTDIR)\vismap.obj" \
-	"$(INTDIR)\vms.obj" \
-	"$(INTDIR)\voda.obj" \
-	"$(INTDIR)\voea.obj" \
-	"$(INTDIR)\voept.obj" \
-	"$(INTDIR)\voia.obj" \
-	"$(INTDIR)\vomd.obj" \
-	"$(INTDIR)\vomq.obj" \
-	"$(INTDIR)\vora.obj" \
-	"$(INTDIR)\vota.obj" \
-	"$(INTDIR)\vprop.obj" \
-	"$(INTDIR)\vtil2.obj" \
-	"$(INTDIR)\vtil3.obj" \
-	"$(INTDIR)\warp3.obj" \
-	"$(INTDIR)\wate.obj" \
-	"$(INTDIR)\watershd.obj" \
-	"$(INTDIR)\watershed.obj" \
-	"$(INTDIR)\wftcirc.obj" \
-	"$(INTDIR)\wgbp2.obj" \
-	"$(INTDIR)\winave.obj" \
-	"$(INTDIR)\winave2.obj" \
-	"$(INTDIR)\window.obj" \
-	"$(INTDIR)\wiw32d.obj" \
-	"$(INTDIR)\wiw3d.obj" \
-	"$(INTDIR)\wpdp.obj" \
-	"$(INTDIR)\wpro.obj" \
-	"$(INTDIR)\wpro_n.obj" \
-	"$(INTDIR)\writepict.obj" \
-	"$(INTDIR)\writepictn.obj" \
-	"$(INTDIR)\writev.obj" \
-	"$(INTDIR)\writpro.obj" \
-	"$(INTDIR)\writpro_n.obj" \
-	"$(INTDIR)\wrsl_p.obj" \
-	"$(INTDIR)\wrtarray.obj" \
-	"$(INTDIR)\wrthedmrc.obj" \
-	"$(INTDIR)\wrtlin.obj" \
-	"$(INTDIR)\wrtlin8.obj" \
-	"$(INTDIR)\wrtseq8.obj" \
-	"$(INTDIR)\wrtvol.obj" \
-	"$(INTDIR)\wtf.obj" \
-	"$(INTDIR)\wtm.obj"
-
-"$(OUTDIR)\spider.exe" : "$(OUTDIR)" $(DEF_FILE) $(LINK32_OBJS)
-    $(LINK32) @@<<
-  $(LINK32_FLAGS) $(LINK32_OBJS)
-<<
-
-.suffixes:.f .obj
-
-.f.obj:
-	@@fpp -PC -DSP_DISTRIB -DSP_F90 -DSP_UNIX -DSP_NT -DSP_32 -D__osf__ $< > temp.f
-	$(F90) $(F90_PROJ) /object $*.obj temp.f
-	@@copy temp.obj $*.obj > nul
-	@@erase temp.f
-	
-
-
-
-@
-
-
-1.3
-log
-@SP_UNIX cpp variable no longer needed.
-@
-text
-@d1 965
-a965 996
-# Microsoft Developer Studio Generated NMAKE File, Based on spider.dsp
-
-!IF "$(OS)" == "Windows_NT"
-NULL=
-!ELSE 
-NULL=nul
-!ENDIF 
-
-F90=df.exe
-OUTDIR=.
-INTDIR=.
-
-ALL : "$(OUTDIR)\spider.exe" "$(OUTDIR)\DF50.PDB"
-	@@copy spider.exe ..\bin > nul
-
-F90_PROJ=/compile_only /nologo /debug:full /optimize:0 /warn:nofileopt\
- /pdbfile:"DF50.PDB" 
-F90_OBJS=
-	
-LINK32=link.exe
-LINK32_FLAGS=kernel32.lib user32.lib gdi32.lib winspool.lib comdlg32.lib\
- advapi32.lib shell32.lib ole32.lib oleaut32.lib uuid.lib odbc32.lib\
- odbccp32.lib /nologo /subsystem:console /incremental:yes\
- /pdb:"$(OUTDIR)\spider.pdb" /debug /machine:I386 /out:"$(OUTDIR)\spider.exe"\
- /pdbtype:sept 
-LINK32_OBJS= \
-	"$(INTDIR)\acrs_2.obj" \
-	"$(INTDIR)\acrs_2r.obj" \
-	"$(INTDIR)\acrs_3.obj" \
-	"$(INTDIR)\acrs_3r.obj" \
-	"$(INTDIR)\add.obj" \
-	"$(INTDIR)\adds.obj" \
-	"$(INTDIR)\adjust.obj" \
-	"$(INTDIR)\af.obj" \
-	"$(INTDIR)\afs.obj" \
-	"$(INTDIR)\al10.obj" \
-	"$(INTDIR)\allocit.obj" \
-	"$(INTDIR)\alphaint.obj" \
-	"$(INTDIR)\alprbs.obj" \
-	"$(INTDIR)\alprbs_q.obj" \
-	"$(INTDIR)\alrosf.obj" \
-	"$(INTDIR)\alrosf_q.obj" \
-	"$(INTDIR)\alrosi.obj" \
-	"$(INTDIR)\alrosi_q.obj" \
-	"$(INTDIR)\alrosr.obj" \
-	"$(INTDIR)\alrq.obj" \
-	"$(INTDIR)\alrq_m.obj" \
-	"$(INTDIR)\alrq_q.obj" \
-	"$(INTDIR)\amoeba.obj" \
-	"$(INTDIR)\ang.obj" \
-	"$(INTDIR)\angmor.obj" \
-	"$(INTDIR)\applyw.obj" \
-	"$(INTDIR)\arasq.obj" \
-	"$(INTDIR)\arbre.obj" \
-	"$(INTDIR)\arith.obj" \
-	"$(INTDIR)\arithl.obj" \
-	"$(INTDIR)\asta.obj" \
-	"$(INTDIR)\astcyl.obj" \
-	"$(INTDIR)\atit.obj" \
-	"$(INTDIR)\atit2.obj" \
-	"$(INTDIR)\atpk.obj" \
-	"$(INTDIR)\atsa.obj" \
-	"$(INTDIR)\atwn.obj" \
-	"$(INTDIR)\auxfil.obj" \
-	"$(INTDIR)\auxfilerd.obj" \
-	"$(INTDIR)\auxopn.obj" \
-	"$(INTDIR)\averg.obj" \
-	"$(INTDIR)\averg3.obj" \
-	"$(INTDIR)\bapi.obj" \
-	"$(INTDIR)\bapi3a.obj" \
-	"$(INTDIR)\bckc0.obj" \
-	"$(INTDIR)\bckc2.obj" \
-	"$(INTDIR)\bckcq.obj" \
-	"$(INTDIR)\bcq.obj" \
-	"$(INTDIR)\bess1.obj" \
-	"$(INTDIR)\betacf.obj" \
-	"$(INTDIR)\betai.obj" \
-	"$(INTDIR)\bitrv.obj" \
-	"$(INTDIR)\blank.obj" \
-	"$(INTDIR)\bldr.obj" \
-	"$(INTDIR)\blob.obj" \
-	"$(INTDIR)\blob_q.obj" \
-	"$(INTDIR)\bmax_c.obj" \
-	"$(INTDIR)\bmax_s.obj" \
-	"$(INTDIR)\bmin_c.obj" \
-	"$(INTDIR)\bmin_s.obj" \
-	"$(INTDIR)\borns.obj" \
-	"$(INTDIR)\boxx.obj" \
-	"$(INTDIR)\bpcm.obj" \
-	"$(INTDIR)\bpcmp.obj" \
-	"$(INTDIR)\bpcq.obj" \
-	"$(INTDIR)\bpcqp.obj" \
-	"$(INTDIR)\bprj2.obj" \
-	"$(INTDIR)\bproj3.obj" \
-	"$(INTDIR)\bproj4.obj" \
-	"$(INTDIR)\bps2.obj" \
-	"$(INTDIR)\bpwr.obj" \
-	"$(INTDIR)\bpwr_q.obj" \
-	"$(INTDIR)\buterp.obj" \
-	"$(INTDIR)\ca3d.obj" \
-	"$(INTDIR)\calc.obj" \
-	"$(INTDIR)\cald.obj" \
-	"$(INTDIR)\callfitplane.obj" \
-	"$(INTDIR)\camap.obj" \
-	"$(INTDIR)\camvt.obj" \
-	"$(INTDIR)\cang.obj" \
-	"$(INTDIR)\cascengr.obj" \
-	"$(INTDIR)\cc3d.obj" \
-	"$(INTDIR)\ccc.obj" \
-	"$(INTDIR)\ccff.obj" \
-	"$(INTDIR)\ccfm.obj" \
-	"$(INTDIR)\ccfn.obj" \
-	"$(INTDIR)\ccfr.obj" \
-	"$(INTDIR)\cconect.obj" \
-	"$(INTDIR)\ccrd_2.obj" \
-	"$(INTDIR)\ccrd_2r.obj" \
-	"$(INTDIR)\ccrd_3.obj" \
-	"$(INTDIR)\ccrd_3r.obj" \
-	"$(INTDIR)\ccrs_2.obj" \
-	"$(INTDIR)\ccrs_2r.obj" \
-	"$(INTDIR)\ccrs_3.obj" \
-	"$(INTDIR)\ccrs_3r.obj" \
-	"$(INTDIR)\cengr3.obj" \
-	"$(INTDIR)\cengra.obj" \
-	"$(INTDIR)\cent.obj" \
-	"$(INTDIR)\cent_3.obj" \
-	"$(INTDIR)\cent_d.obj" \
-	"$(INTDIR)\cent_q.obj" \
-	"$(INTDIR)\cgr_3.obj" \
-	"$(INTDIR)\changeval.obj" \
-	"$(INTDIR)\charinside.obj" \
-	"$(INTDIR)\chava.obj" \
-	"$(INTDIR)\chisq.obj" \
-	"$(INTDIR)\chkinpq.obj" \
-	"$(INTDIR)\chkmem.obj" \
-	"$(INTDIR)\chknumq.obj" \
-	"$(INTDIR)\chkstrq.obj" \
-	"$(INTDIR)\clast.obj" \
-	"$(INTDIR)\clasym.obj" \
-	"$(INTDIR)\closefb.obj" \
-	"$(INTDIR)\clss.obj" \
-	"$(INTDIR)\clusterlst.obj" \
-	"$(INTDIR)\cncalc.obj" \
-	"$(INTDIR)\cndisp.obj" \
-	"$(INTDIR)\cnfile.obj" \
-	"$(INTDIR)\cngoul.obj" \
-	"$(INTDIR)\cnhelp.obj" \
-	"$(INTDIR)\cnint3.obj" \
-	"$(INTDIR)\cnint4.obj" \
-	"$(INTDIR)\cnmov.obj" \
-	"$(INTDIR)\cnopn.obj" \
-	"$(INTDIR)\cnpost.obj" \
-	"$(INTDIR)\cnrd_2.obj" \
-	"$(INTDIR)\cnrd_2r.obj" \
-	"$(INTDIR)\cnrd_3.obj" \
-	"$(INTDIR)\cnrd_3r.obj" \
-	"$(INTDIR)\cnrs_2.obj" \
-	"$(INTDIR)\cnrs_2r.obj" \
-	"$(INTDIR)\cnrs_3.obj" \
-	"$(INTDIR)\cnrs_3r.obj" \
-	"$(INTDIR)\cnscan.obj" \
-	"$(INTDIR)\cnstuff.obj" \
-	"$(INTDIR)\cnterm.obj" \
-	"$(INTDIR)\cntrce.obj" \
-	"$(INTDIR)\cntrfl.obj" \
-	"$(INTDIR)\cntur.obj" \
-	"$(INTDIR)\combeul.obj" \
-	"$(INTDIR)\combeul1.obj" \
-	"$(INTDIR)\comp3d.obj" \
-	"$(INTDIR)\comp3dmad.obj" \
-	"$(INTDIR)\conf.obj" \
-	"$(INTDIR)\conf1.obj" \
-	"$(INTDIR)\conint.obj" \
-	"$(INTDIR)\convl.obj" \
-	"$(INTDIR)\cool2.obj" \
-	"$(INTDIR)\coorot.obj" \
-	"$(INTDIR)\cop.obj" \
-	"$(INTDIR)\copd.obj" \
-	"$(INTDIR)\copy1.obj" \
-	"$(INTDIR)\copybrix.obj" \
-	"$(INTDIR)\copyd.obj" \
-	"$(INTDIR)\copye.obj" \
-	"$(INTDIR)\copyem.obj" \
-	"$(INTDIR)\copyf.obj" \
-	"$(INTDIR)\copyfromnt.obj" \
-	"$(INTDIR)\copyfsimple.obj" \
-	"$(INTDIR)\copymdt.obj" \
-	"$(INTDIR)\copymdtr.obj" \
-	"$(INTDIR)\copymrc.obj" \
-	"$(INTDIR)\copypds.obj" \
-	"$(INTDIR)\copypos.obj" \
-	"$(INTDIR)\copypos2.obj" \
-	"$(INTDIR)\copypos3.obj" \
-	"$(INTDIR)\copyr.obj" \
-	"$(INTDIR)\copyshort.obj" \
-	"$(INTDIR)\copytont.obj" \
-	"$(INTDIR)\copyu.obj" \
-	"$(INTDIR)\copyvax.obj" \
-	"$(INTDIR)\corel.obj" \
-	"$(INTDIR)\corr1.obj" \
-	"$(INTDIR)\coupe.obj" \
-	"$(INTDIR)\cppb.obj" \
-	"$(INTDIR)\cproj.obj" \
-	"$(INTDIR)\cr180_2.obj" \
-	"$(INTDIR)\crcse1.obj" \
-	"$(INTDIR)\crcse3.obj" \
-	"$(INTDIR)\criter.obj" \
-	"$(INTDIR)\crosrmg.obj" \
-	"$(INTDIR)\crosrmg_d.obj" \
-	"$(INTDIR)\crosrng.obj" \
-	"$(INTDIR)\crosrng_d.obj" \
-	"$(INTDIR)\crosrng_f.obj" \
-	"$(INTDIR)\crosrng_m.obj" \
-	"$(INTDIR)\crosrng_q.obj" \
-	"$(INTDIR)\crsm_2.obj" \
-	"$(INTDIR)\crtest.obj" \
-	"$(INTDIR)\csaxis.obj" \
-	"$(INTDIR)\csclip.obj" \
-	"$(INTDIR)\csget.obj" \
-	"$(INTDIR)\csgtbn.obj" \
-	"$(INTDIR)\csgttx.obj" \
-	"$(INTDIR)\cslice.obj" \
-	"$(INTDIR)\csotcd.obj" \
-	"$(INTDIR)\cspstx.obj" \
-	"$(INTDIR)\cspush.obj" \
-	"$(INTDIR)\csrdct.obj" \
-	"$(INTDIR)\csrecv.obj" \
-	"$(INTDIR)\csscalt.obj" \
-	"$(INTDIR)\cstrap.obj" \
-	"$(INTDIR)\csvms.obj" \
-	"$(INTDIR)\ctffil.obj" \
-	"$(INTDIR)\d3dplt.obj" \
-	"$(INTDIR)\date.obj" \
-	"$(INTDIR)\dattimtit.obj" \
-	"$(INTDIR)\dchist.obj" \
-	"$(INTDIR)\dee.obj" \
-	"$(INTDIR)\defo001.obj" \
-	"$(INTDIR)\defo003.obj" \
-	"$(INTDIR)\defo1001.obj" \
-	"$(INTDIR)\defo2001.obj" \
-	"$(INTDIR)\defocus.obj" \
-	"$(INTDIR)\deletf.obj" \
-	"$(INTDIR)\dendro.obj" \
-	"$(INTDIR)\dendro2.obj" \
-	"$(INTDIR)\denlst.obj" \
-	"$(INTDIR)\denov.obj" \
-	"$(INTDIR)\denref.obj" \
-	"$(INTDIR)\deucl.obj" \
-	"$(INTDIR)\dhide.obj" \
-	"$(INTDIR)\diff1o.obj" \
-	"$(INTDIR)\dirnm.obj" \
-	"$(INTDIR)\disc.obj" \
-	"$(INTDIR)\discrim.obj" \
-	"$(INTDIR)\dist1.obj" \
-	"$(INTDIR)\dist2.obj" \
-	"$(INTDIR)\dist2d.obj" \
-	"$(INTDIR)\dist4.obj" \
-	"$(INTDIR)\dist_p.obj" \
-	"$(INTDIR)\distest.obj" \
-	"$(INTDIR)\distlst.obj" \
-	"$(INTDIR)\disttst.obj" \
-	"$(INTDIR)\divcr3.obj" \
-	"$(INTDIR)\doccom.obj" \
-	"$(INTDIR)\docinfo.obj" \
-	"$(INTDIR)\docorr3_s.obj" \
-	"$(INTDIR)\docors3_s.obj" \
-	"$(INTDIR)\domax3_s.obj" \
-	"$(INTDIR)\domin3_s.obj" \
-	"$(INTDIR)\dprofd.obj" \
-	"$(INTDIR)\dprofl.obj" \
-	"$(INTDIR)\driv1.obj" \
-	"$(INTDIR)\driv2.obj" \
-	"$(INTDIR)\driv3.obj" \
-	"$(INTDIR)\dsfr.obj" \
-	"$(INTDIR)\dsfr_s.obj" \
-	"$(INTDIR)\dsfs.obj" \
-	"$(INTDIR)\dsfs_p.obj" \
-	"$(INTDIR)\dsgr.obj" \
-	"$(INTDIR)\dsgr_s.obj" \
-	"$(INTDIR)\dust.obj" \
-	"$(INTDIR)\dvcr.obj" \
-	"$(INTDIR)\edge.obj" \
-	"$(INTDIR)\eff.obj" \
-	"$(INTDIR)\ehist.obj" \
-	"$(INTDIR)\empsli.obj" \
-	"$(INTDIR)\endit.obj" \
-	"$(INTDIR)\ener.obj" \
-	"$(INTDIR)\enfr_2.obj" \
-	"$(INTDIR)\enhanc.obj" \
-	"$(INTDIR)\envelope.obj" \
-	"$(INTDIR)\epur4.obj" \
-	"$(INTDIR)\erc.obj" \
-	"$(INTDIR)\errf2.obj" \
-	"$(INTDIR)\erri2.obj" \
-	"$(INTDIR)\error.obj" \
-	"$(INTDIR)\errt.obj" \
-	"$(INTDIR)\evalnq.obj" \
-	"$(INTDIR)\express3q.obj" \
-	"$(INTDIR)\expressq.obj" \
-	"$(INTDIR)\exprq.obj" \
-	"$(INTDIR)\f3mr.obj" \
-	"$(INTDIR)\f3od_p.obj" \
-	"$(INTDIR)\factor.obj" \
-	"$(INTDIR)\falb.obj" \
-	"$(INTDIR)\falb_p.obj" \
-	"$(INTDIR)\fallg.obj" \
-	"$(INTDIR)\fcm.obj" \
-	"$(INTDIR)\fcmtst.obj" \
-	"$(INTDIR)\fcnq.obj" \
-	"$(INTDIR)\fermp.obj" \
-	"$(INTDIR)\ffilts.obj" \
-	"$(INTDIR)\fftc_d.obj" \
-	"$(INTDIR)\fftc_q.obj" \
-	"$(INTDIR)\fftmcf.obj" \
-	"$(INTDIR)\fftr2_p.obj" \
-	"$(INTDIR)\fftr2_q.obj" \
-	"$(INTDIR)\fftr3_p.obj" \
-	"$(INTDIR)\fftr_d.obj" \
-	"$(INTDIR)\fftr_q.obj" \
-	"$(INTDIR)\fftrs_q.obj" \
-	"$(INTDIR)\fgr.obj" \
-	"$(INTDIR)\fh.obj" \
-	"$(INTDIR)\fhodt.obj" \
-	"$(INTDIR)\fht.obj" \
-	"$(INTDIR)\filcad.obj" \
-	"$(INTDIR)\filcan.obj" \
-	"$(INTDIR)\fildat.obj" \
-	"$(INTDIR)\filerd.obj" \
-	"$(INTDIR)\filgen.obj" \
-	"$(INTDIR)\filget.obj" \
-	"$(INTDIR)\filnamsub.obj" \
-	"$(INTDIR)\filseqp.obj" \
-	"$(INTDIR)\filsli.obj" \
-	"$(INTDIR)\filt3_p.obj" \
-	"$(INTDIR)\filtdoc.obj" \
-	"$(INTDIR)\filtplot.obj" \
-	"$(INTDIR)\findfrq.obj" \
-	"$(INTDIR)\findlbq.obj" \
-	"$(INTDIR)\findmx.obj" \
-	"$(INTDIR)\findmx_f.obj" \
-	"$(INTDIR)\findmx_q.obj" \
-	"$(INTDIR)\fint.obj" \
-	"$(INTDIR)\fint3.obj" \
-	"$(INTDIR)\fitplane.obj" \
-	"$(INTDIR)\fitt.obj" \
-	"$(INTDIR)\fixrl.obj" \
-	"$(INTDIR)\flipbytes.obj" \
-	"$(INTDIR)\fmax_c.obj" \
-	"$(INTDIR)\fmax_q.obj" \
-	"$(INTDIR)\fmax_s.obj" \
-	"$(INTDIR)\fmin_c.obj" \
-	"$(INTDIR)\fmin_q.obj" \
-	"$(INTDIR)\fmin_s.obj" \
-	"$(INTDIR)\fmr_1.obj" \
-	"$(INTDIR)\fmr_2.obj" \
-	"$(INTDIR)\fmrs_1.obj" \
-	"$(INTDIR)\fmrs_1d.obj" \
-	"$(INTDIR)\fmrs_2.obj" \
-	"$(INTDIR)\fmrs_2d.obj" \
-	"$(INTDIR)\fmrs_2dr.obj" \
-	"$(INTDIR)\fmrs_2r.obj" \
-	"$(INTDIR)\fmrs_3.obj" \
-	"$(INTDIR)\fmrs_3d.obj" \
-	"$(INTDIR)\fmrs_3dr.obj" \
-	"$(INTDIR)\fmrs_3r.obj" \
-	"$(INTDIR)\fnrm.obj" \
-	"$(INTDIR)\four1.obj" \
-	"$(INTDIR)\four1a.obj" \
-	"$(INTDIR)\four1a_fp.obj" \
-	"$(INTDIR)\four1b.obj" \
-	"$(INTDIR)\four1c.obj" \
-	"$(INTDIR)\four2.obj" \
-	"$(INTDIR)\fouring.obj" \
-	"$(INTDIR)\fouring_q.obj" \
-	"$(INTDIR)\fq3_p.obj" \
-	"$(INTDIR)\fq_q.obj" \
-	"$(INTDIR)\frng.obj" \
-	"$(INTDIR)\fromtoq.obj" \
-	"$(INTDIR)\fsort.obj" \
-	"$(INTDIR)\funiq.obj" \
-	"$(INTDIR)\gali.obj" \
-	"$(INTDIR)\gali_p.obj" \
-	"$(INTDIR)\gam.obj" \
-	"$(INTDIR)\gammln.obj" \
-	"$(INTDIR)\gaussp.obj" \
-	"$(INTDIR)\gdstrt.obj" \
-	"$(INTDIR)\gee.obj" \
-	"$(INTDIR)\genw.obj" \
-	"$(INTDIR)\genw3e.obj" \
-	"$(INTDIR)\getang.obj" \
-	"$(INTDIR)\getcoo.obj" \
-	"$(INTDIR)\getcoo2.obj" \
-	"$(INTDIR)\getcoot.obj" \
-	"$(INTDIR)\getctf.obj" \
-	"$(INTDIR)\getdocdat.obj" \
-	"$(INTDIR)\getdump.obj" \
-	"$(INTDIR)\getima.obj" \
-	"$(INTDIR)\getima_q.obj" \
-	"$(INTDIR)\getlab.obj" \
-	"$(INTDIR)\getunx.obj" \
-	"$(INTDIR)\getv16.obj" \
-	"$(INTDIR)\getvax.obj" \
-	"$(INTDIR)\gksm.obj" \
-	"$(INTDIR)\gktest.obj" \
-	"$(INTDIR)\gnc.obj" \
-	"$(INTDIR)\gnc2s.obj" \
-	"$(INTDIR)\gotbranch.obj" \
-	"$(INTDIR)\gp.obj" \
-	"$(INTDIR)\graphp.obj" \
-	"$(INTDIR)\graphs.obj" \
-	"$(INTDIR)\gsc.obj" \
-	"$(INTDIR)\gsmod.obj" \
-	"$(INTDIR)\gsmodl.obj" \
-	"$(INTDIR)\hali.obj" \
-	"$(INTDIR)\hali_p.obj" \
-	"$(INTDIR)\hclp.obj" \
-	"$(INTDIR)\hcls.obj" \
-	"$(INTDIR)\hdiag.obj" \
-	"$(INTDIR)\hdls.obj" \
-	"$(INTDIR)\hels.obj" \
-	"$(INTDIR)\hf.obj" \
-	"$(INTDIR)\hgr.obj" \
-	"$(INTDIR)\hiang.obj" \
-	"$(INTDIR)\hisd.obj" \
-	"$(INTDIR)\hismap.obj" \
-	"$(INTDIR)\hismap4.obj" \
-	"$(INTDIR)\hist.obj" \
-	"$(INTDIR)\histc.obj" \
-	"$(INTDIR)\histe.obj" \
-	"$(INTDIR)\histod.obj" \
-	"$(INTDIR)\histodc.obj" \
-	"$(INTDIR)\hkmc.obj" \
-	"$(INTDIR)\hsort.obj" \
-	"$(INTDIR)\i2byte.obj" \
-	"$(INTDIR)\i4byte.obj" \
-	"$(INTDIR)\ib4flip.obj" \
-	"$(INTDIR)\ibflip.obj" \
-	"$(INTDIR)\iftorpn.obj" \
-	"$(INTDIR)\imseq4.obj" \
-	"$(INTDIR)\imstat.obj" \
-	"$(INTDIR)\imtovol.obj" \
-	"$(INTDIR)\incor3.obj" \
-	"$(INTDIR)\inf3_p.obj" \
-	"$(INTDIR)\inf_q.obj" \
-	"$(INTDIR)\inilun.obj" \
-	"$(INTDIR)\inilunb.obj" \
-	"$(INTDIR)\iniluni.obj" \
-	"$(INTDIR)\initinln.obj" \
-	"$(INTDIR)\initunix.obj" \
-	"$(INTDIR)\inlnbuf.obj" \
-	"$(INTDIR)\inproj.obj" \
-	"$(INTDIR)\inquireif.obj" \
-	"$(INTDIR)\inquireif1.obj" \
-	"$(INTDIR)\inquirereg.obj" \
-	"$(INTDIR)\interl.obj" \
-	"$(INTDIR)\interp.obj" \
-	"$(INTDIR)\interp3.obj" \
-	"$(INTDIR)\invbt.obj" \
-	"$(INTDIR)\invdet.obj" \
-	"$(INTDIR)\invgdist.obj" \
-	"$(INTDIR)\ipalign64.obj" \
-	"$(INTDIR)\irp3.obj" \
-	"$(INTDIR)\isbare.obj" \
-	"$(INTDIR)\ischar.obj" \
-	"$(INTDIR)\isdigi.obj" \
-	"$(INTDIR)\itpow.obj" \
-	"$(INTDIR)\jblock.obj" \
-	"$(INTDIR)\jpmsk.obj" \
-	"$(INTDIR)\jpmsk1.obj" \
-	"$(INTDIR)\jpmsk2.obj" \
-	"$(INTDIR)\lastoccur.obj" \
-	"$(INTDIR)\latcen.obj" \
-	"$(INTDIR)\latice.obj" \
-	"$(INTDIR)\lhist.obj" \
-	"$(INTDIR)\listdc.obj" \
-	"$(INTDIR)\listit.obj" \
-	"$(INTDIR)\listitr.obj" \
-	"$(INTDIR)\listregs.obj" \
-	"$(INTDIR)\lkupdc.obj" \
-	"$(INTDIR)\lmdif.obj" \
-	"$(INTDIR)\lmdif1.obj" \
-	"$(INTDIR)\lnblnk.obj" \
-	"$(INTDIR)\local.obj" \
-	"$(INTDIR)\log2.obj" \
-	"$(INTDIR)\log2_p.obj" \
-	"$(INTDIR)\logifq.obj" \
-	"$(INTDIR)\longer.obj" \
-	"$(INTDIR)\lookup.obj" \
-	"$(INTDIR)\m_j.obj" \
-	"$(INTDIR)\macf.obj" \
-	"$(INTDIR)\macf_p.obj" \
-	"$(INTDIR)\mahal.obj" \
-	"$(INTDIR)\makestack.obj" \
-	"$(INTDIR)\maktab.obj" \
-	"$(INTDIR)\malfi3.obj" \
-	"$(INTDIR)\mapdist.obj" \
-	"$(INTDIR)\mapdoc.obj" \
-	"$(INTDIR)\mapfilt.obj" \
-	"$(INTDIR)\mapim.obj" \
-	"$(INTDIR)\mapstat.obj" \
-	"$(INTDIR)\marker.obj" \
-	"$(INTDIR)\mask.obj" \
-	"$(INTDIR)\maskmu.obj" \
-	"$(INTDIR)\matinv.obj" \
-	"$(INTDIR)\maxf.obj" \
-	"$(INTDIR)\mcircl.obj" \
-	"$(INTDIR)\md2.obj" \
-	"$(INTDIR)\md3.obj" \
-	"$(INTDIR)\median.obj" \
-	"$(INTDIR)\meed.obj" \
-	"$(INTDIR)\mhelp.obj" \
-	"$(INTDIR)\mhelp_sub.obj" \
-	"$(INTDIR)\mirbp3a.obj" \
-	"$(INTDIR)\mircol.obj" \
-	"$(INTDIR)\mirqbxs.obj" \
-	"$(INTDIR)\mirror.obj" \
-	"$(INTDIR)\mjc.obj" \
-	"$(INTDIR)\mlc.obj" \
-	"$(INTDIR)\mline.obj" \
-	"$(INTDIR)\mline3.obj" \
-	"$(INTDIR)\mls.obj" \
-	"$(INTDIR)\mod1.obj" \
-	"$(INTDIR)\model.obj" \
-	"$(INTDIR)\model3.obj" \
-	"$(INTDIR)\modelh.obj" \
-	"$(INTDIR)\mont.obj" \
-	"$(INTDIR)\movipc.obj" \
-	"$(INTDIR)\mpoint.obj" \
-	"$(INTDIR)\mr2to3d.obj" \
-	"$(INTDIR)\mrali.obj" \
-	"$(INTDIR)\mrali_p.obj" \
-	"$(INTDIR)\mralign.obj" \
-	"$(INTDIR)\mrand.obj" \
-	"$(INTDIR)\mrang2.obj" \
-	"$(INTDIR)\mrcalerr.obj" \
-	"$(INTDIR)\mrcenti.obj" \
-	"$(INTDIR)\mrcg3.obj" \
-	"$(INTDIR)\mrcg3d.obj" \
-	"$(INTDIR)\mrcp.obj" \
-	"$(INTDIR)\mrdev.obj" \
-	"$(INTDIR)\mrdoc.obj" \
-	"$(INTDIR)\mrdoccor.obj" \
-	"$(INTDIR)\mread.obj" \
-	"$(INTDIR)\mrectl.obj" \
-	"$(INTDIR)\mreigen.obj" \
-	"$(INTDIR)\mrerr.obj" \
-	"$(INTDIR)\mrerror.obj" \
-	"$(INTDIR)\mrfei2.obj" \
-	"$(INTDIR)\mrgaus2.obj" \
-	"$(INTDIR)\mrget3d.obj" \
-	"$(INTDIR)\mrgetinfo.obj" \
-	"$(INTDIR)\mrgetz.obj" \
-	"$(INTDIR)\mrgetzd.obj" \
-	"$(INTDIR)\mrgnorm.obj" \
-	"$(INTDIR)\mrk.obj" \
-	"$(INTDIR)\mrk3.obj" \
-	"$(INTDIR)\mrkur2.obj" \
-	"$(INTDIR)\mrkur3.obj" \
-	"$(INTDIR)\mrmamule.obj" \
-	"$(INTDIR)\mrmat2.obj" \
-	"$(INTDIR)\mrncolor.obj" \
-	"$(INTDIR)\mrnewangle.obj" \
-	"$(INTDIR)\mrnlstrt.obj" \
-	"$(INTDIR)\mrproj.obj" \
-	"$(INTDIR)\mrprrep.obj" \
-	"$(INTDIR)\mrputinfo.obj" \
-	"$(INTDIR)\mrqli.obj" \
-	"$(INTDIR)\mrqli_p.obj" \
-	"$(INTDIR)\mrquater.obj" \
-	"$(INTDIR)\mrrefl.obj" \
-	"$(INTDIR)\mrreplace.obj" \
-	"$(INTDIR)\mrrotate.obj" \
-	"$(INTDIR)\mrrsurf.obj" \
-	"$(INTDIR)\mrrt.obj" \
-	"$(INTDIR)\mrscale.obj" \
-	"$(INTDIR)\mrscale3.obj" \
-	"$(INTDIR)\mrshift.obj" \
-	"$(INTDIR)\mrsurf.obj" \
-	"$(INTDIR)\mrtheta.obj" \
-	"$(INTDIR)\mrvari.obj" \
-	"$(INTDIR)\mskdec.obj" \
-	"$(INTDIR)\msum.obj" \
-	"$(INTDIR)\mtnv.obj" \
-	"$(INTDIR)\mtpr.obj" \
-	"$(INTDIR)\mtrian.obj" \
-	"$(INTDIR)\mulf2.obj" \
-	"$(INTDIR)\mulf3.obj" \
-	"$(INTDIR)\mulfc3.obj" \
-	"$(INTDIR)\mulfi3.obj" \
-	"$(INTDIR)\mult.obj" \
-	"$(INTDIR)\mygetenv.obj" \
-	"$(INTDIR)\mymods.obj" \
-	"$(INTDIR)\myread.obj" \
-	"$(INTDIR)\mywr0.obj" \
-	"$(INTDIR)\mywr1.obj" \
-	"$(INTDIR)\mywr2.obj" \
-	"$(INTDIR)\narea.obj" \
-	"$(INTDIR)\newkmeans.obj" \
-	"$(INTDIR)\nextimg.obj" \
-	"$(INTDIR)\nextversion.obj" \
-	"$(INTDIR)\nfq.obj" \
-	"$(INTDIR)\ngq.obj" \
-	"$(INTDIR)\nlclusrd.obj" \
-	"$(INTDIR)\nlmconv.obj" \
-	"$(INTDIR)\nlmrealstrt.obj" \
-	"$(INTDIR)\nltfile.obj" \
-	"$(INTDIR)\noise.obj" \
-	"$(INTDIR)\nonlmap.obj" \
-	"$(INTDIR)\norm3.obj" \
-	"$(INTDIR)\normas.obj" \
-	"$(INTDIR)\normm.obj" \
-	"$(INTDIR)\norppf.obj" \
-	"$(INTDIR)\noyau.obj" \
-	"$(INTDIR)\nrml.obj" \
-	"$(INTDIR)\nrms.obj" \
-	"$(INTDIR)\nrq.obj" \
-	"$(INTDIR)\nrqli.obj" \
-	"$(INTDIR)\nrqli_p.obj" \
-	"$(INTDIR)\nt32.obj" \
-	"$(INTDIR)\numchari4.obj" \
-	"$(INTDIR)\numdig.obj" \
-	"$(INTDIR)\od.obj" \
-	"$(INTDIR)\openall.obj" \
-	"$(INTDIR)\opendoc.obj" \
-	"$(INTDIR)\openf.obj" \
-	"$(INTDIR)\openfb.obj" \
-	"$(INTDIR)\openfil.obj" \
-	"$(INTDIR)\opengethdr.obj" \
-	"$(INTDIR)\openinfo.obj" \
-	"$(INTDIR)\openinln.obj" \
-	"$(INTDIR)\openinstk.obj" \
-	"$(INTDIR)\openstk.obj" \
-	"$(INTDIR)\opfil.obj" \
-	"$(INTDIR)\opsf3_p.obj" \
-	"$(INTDIR)\opsf_p.obj" \
-	"$(INTDIR)\orcdf.obj" \
-	"$(INTDIR)\ordere.obj" \
-	"$(INTDIR)\ormd.obj" \
-	"$(INTDIR)\ormd_p.obj" \
-	"$(INTDIR)\outim_q.obj" \
-	"$(INTDIR)\outpr.obj" \
-	"$(INTDIR)\outrng.obj" \
-	"$(INTDIR)\paged.obj" \
-	"$(INTDIR)\pagedhdr.obj" \
-	"$(INTDIR)\parabl.obj" \
-	"$(INTDIR)\parabld.obj" \
-	"$(INTDIR)\parst.obj" \
-	"$(INTDIR)\patch.obj" \
-	"$(INTDIR)\pca_coorx.obj" \
-	"$(INTDIR)\pca_cproj.obj" \
-	"$(INTDIR)\pca_gsmod.obj" \
-	"$(INTDIR)\pca_gsmodl.obj" \
-	"$(INTDIR)\pca_incor3.obj" \
-	"$(INTDIR)\pca_itpow.obj" \
-	"$(INTDIR)\pca_main.obj" \
-	"$(INTDIR)\pca_recdum.obj" \
-	"$(INTDIR)\pca_remake.obj" \
-	"$(INTDIR)\pca_srip2.obj" \
-	"$(INTDIR)\pca_sripe.obj" \
-	"$(INTDIR)\pca_stocha.obj" \
-	"$(INTDIR)\pcascoor.obj" \
-	"$(INTDIR)\pcaxcoor.obj" \
-	"$(INTDIR)\pcaxpose.obj" \
-	"$(INTDIR)\pcaxprod.obj" \
-	"$(INTDIR)\pdates.obj" \
-	"$(INTDIR)\permut.obj" \
-	"$(INTDIR)\picksl.obj" \
-	"$(INTDIR)\picksv.obj" \
-	"$(INTDIR)\pj3q.obj" \
-	"$(INTDIR)\pkd.obj" \
-	"$(INTDIR)\pksr3.obj" \
-	"$(INTDIR)\plnedg.obj" \
-	"$(INTDIR)\plot1.obj" \
-	"$(INTDIR)\plot2.obj" \
-	"$(INTDIR)\poem.obj" \
-	"$(INTDIR)\poj.obj" \
-	"$(INTDIR)\polfit.obj" \
-	"$(INTDIR)\polish.obj" \
-	"$(INTDIR)\pollsq.obj" \
-	"$(INTDIR)\polqs.obj" \
-	"$(INTDIR)\postrt.obj" \
-	"$(INTDIR)\pr3d.obj" \
-	"$(INTDIR)\pr3db.obj" \
-	"$(INTDIR)\prb1d.obj" \
-	"$(INTDIR)\prepcub_q.obj" \
-	"$(INTDIR)\prepcub_s.obj" \
-	"$(INTDIR)\prepsl_2.obj" \
-	"$(INTDIR)\prepsl_s.obj" \
-	"$(INTDIR)\previo.obj" \
-	"$(INTDIR)\prjc0.obj" \
-	"$(INTDIR)\prjc2.obj" \
-	"$(INTDIR)\prjcq.obj" \
-	"$(INTDIR)\prjs2.obj" \
-	"$(INTDIR)\prntxx.obj" \
-	"$(INTDIR)\prober.obj" \
-	"$(INTDIR)\proj3.obj" \
-	"$(INTDIR)\proj3e.obj" \
-	"$(INTDIR)\prp.obj" \
-	"$(INTDIR)\prt.obj" \
-	"$(INTDIR)\prt1.obj" \
-	"$(INTDIR)\pttern.obj" \
-	"$(INTDIR)\putlin.obj" \
-	"$(INTDIR)\putpt.obj" \
-	"$(INTDIR)\putpt1.obj" \
-	"$(INTDIR)\putpt2.obj" \
-	"$(INTDIR)\pw2s.obj" \
-	"$(INTDIR)\pw2sd.obj" \
-	"$(INTDIR)\pw2sdr.obj" \
-	"$(INTDIR)\pw2sr.obj" \
-	"$(INTDIR)\pw3s.obj" \
-	"$(INTDIR)\pw3sd.obj" \
-	"$(INTDIR)\pw3sdr.obj" \
-	"$(INTDIR)\pw3sr.obj" \
-	"$(INTDIR)\qali.obj" \
-	"$(INTDIR)\qali_p.obj" \
-	"$(INTDIR)\qfact.obj" \
-	"$(INTDIR)\qfact_p.obj" \
-	"$(INTDIR)\qnr.obj" \
-	"$(INTDIR)\qnrf.obj" \
-	"$(INTDIR)\qstat.obj" \
-	"$(INTDIR)\quadri.obj" \
-	"$(INTDIR)\quadri_q.obj" \
-	"$(INTDIR)\radav.obj" \
-	"$(INTDIR)\radavi.obj" \
-	"$(INTDIR)\ramp.obj" \
-	"$(INTDIR)\ramp_p.obj" \
-	"$(INTDIR)\rand_p.obj" \
-	"$(INTDIR)\random.obj" \
-	"$(INTDIR)\rann.obj" \
-	"$(INTDIR)\rathin.obj" \
-	"$(INTDIR)\rawtospider.obj" \
-	"$(INTDIR)\rcaver.obj" \
-	"$(INTDIR)\rccang.obj" \
-	"$(INTDIR)\rclu.obj" \
-	"$(INTDIR)\rcnv2_p.obj" \
-	"$(INTDIR)\rcnv3_p.obj" \
-	"$(INTDIR)\rconv.obj" \
-	"$(INTDIR)\rctfs.obj" \
-	"$(INTDIR)\rdclus.obj" \
-	"$(INTDIR)\rddoca2q.obj" \
-	"$(INTDIR)\rddocn.obj" \
-	"$(INTDIR)\rddocq.obj" \
-	"$(INTDIR)\rdfc.obj" \
-	"$(INTDIR)\rdpa.obj" \
-	"$(INTDIR)\rdpr.obj" \
-	"$(INTDIR)\rdpraf.obj" \
-	"$(INTDIR)\rdprai.obj" \
-	"$(INTDIR)\rdpri3s.obj" \
-	"$(INTDIR)\rdpris.obj" \
-	"$(INTDIR)\rdprj.obj" \
-	"$(INTDIR)\rdprm.obj" \
-	"$(INTDIR)\rdprm2.obj" \
-	"$(INTDIR)\rdprm2s.obj" \
-	"$(INTDIR)\rdprmc.obj" \
-	"$(INTDIR)\rdprmi.obj" \
-	"$(INTDIR)\rdsl_p.obj" \
-	"$(INTDIR)\readpdb.obj" \
-	"$(INTDIR)\readpq.obj" \
-	"$(INTDIR)\readrq.obj" \
-	"$(INTDIR)\reads.obj" \
-	"$(INTDIR)\readt.obj" \
-	"$(INTDIR)\reang.obj" \
-	"$(INTDIR)\reatab.obj" \
-	"$(INTDIR)\recdum.obj" \
-	"$(INTDIR)\recons.obj" \
-	"$(INTDIR)\redhed.obj" \
-	"$(INTDIR)\redhedmrc.obj" \
-	"$(INTDIR)\redlin.obj" \
-	"$(INTDIR)\redlin8.obj" \
-	"$(INTDIR)\redpro2.obj" \
-	"$(INTDIR)\redprq.obj" \
-	"$(INTDIR)\redrec8.obj" \
-	"$(INTDIR)\reform.obj" \
-	"$(INTDIR)\reform0.obj" \
-	"$(INTDIR)\remez.obj" \
-	"$(INTDIR)\remezp.obj" \
-	"$(INTDIR)\repc.obj" \
-	"$(INTDIR)\repcg.obj" \
-	"$(INTDIR)\repr2_s.obj" \
-	"$(INTDIR)\repr32_q.obj" \
-	"$(INTDIR)\repr3_q.obj" \
-	"$(INTDIR)\reprwb.obj" \
-	"$(INTDIR)\reps.obj" \
-	"$(INTDIR)\retir.obj" \
-	"$(INTDIR)\rew.obj" \
-	"$(INTDIR)\rfactsd2.obj" \
-	"$(INTDIR)\rfactsdo.obj" \
-	"$(INTDIR)\rgri.obj" \
-	"$(INTDIR)\rhobck.obj" \
-	"$(INTDIR)\ringwe.obj" \
-	"$(INTDIR)\rmz_p.obj" \
-	"$(INTDIR)\ro2test.obj" \
-	"$(INTDIR)\rot.obj" \
-	"$(INTDIR)\rot2qs.obj" \
-	"$(INTDIR)\rot3.obj" \
-	"$(INTDIR)\rot32.obj" \
-	"$(INTDIR)\rot3_p.obj" \
-	"$(INTDIR)\rot_p.obj" \
-	"$(INTDIR)\rotal3.obj" \
-	"$(INTDIR)\rotas3.obj" \
-	"$(INTDIR)\rotl3.obj" \
-	"$(INTDIR)\rotqs.obj" \
-	"$(INTDIR)\rots3.obj" \
-	"$(INTDIR)\roub2.obj" \
-	"$(INTDIR)\rout.obj" \
-	"$(INTDIR)\rprq.obj" \
-	"$(INTDIR)\rtq.obj" \
-	"$(INTDIR)\rtq_q.obj" \
-	"$(INTDIR)\rtqs.obj" \
-	"$(INTDIR)\rtqs_q.obj" \
-	"$(INTDIR)\rys1.obj" \
-	"$(INTDIR)\rys3.obj" \
-	"$(INTDIR)\saqb.obj" \
-	"$(INTDIR)\saqb_f.obj" \
-	"$(INTDIR)\saqb_p.obj" \
-	"$(INTDIR)\savd.obj" \
-	"$(INTDIR)\savdn1.obj" \
-	"$(INTDIR)\savdocq.obj" \
-	"$(INTDIR)\sclasf.obj" \
-	"$(INTDIR)\sclassi.obj" \
-	"$(INTDIR)\sclassy.obj" \
-	"$(INTDIR)\scoran3.obj" \
-	"$(INTDIR)\searchq.obj" \
-	"$(INTDIR)\secnds.obj" \
-	"$(INTDIR)\seedfill.obj" \
-	"$(INTDIR)\seeds.obj" \
-	"$(INTDIR)\seigen.obj" \
-	"$(INTDIR)\semis.obj" \
-	"$(INTDIR)\sen3a.obj" \
-	"$(INTDIR)\setlab.obj" \
-	"$(INTDIR)\setmode.obj" \
-	"$(INTDIR)\setprm.obj" \
-	"$(INTDIR)\setprmb.obj" \
-	"$(INTDIR)\setval.obj" \
-	"$(INTDIR)\sgraf.obj" \
-	"$(INTDIR)\sgraf1.obj" \
-	"$(INTDIR)\sh180_2.obj" \
-	"$(INTDIR)\shelk.obj" \
-	"$(INTDIR)\shfc_2.obj" \
-	"$(INTDIR)\shfi_2.obj" \
-	"$(INTDIR)\shfi_q.obj" \
-	"$(INTDIR)\shfm_2.obj" \
-	"$(INTDIR)\shift1.obj" \
-	"$(INTDIR)\shift2.obj" \
-	"$(INTDIR)\shift3.obj" \
-	"$(INTDIR)\shift_3d.obj" \
-	"$(INTDIR)\shift_pf.obj" \
-	"$(INTDIR)\shiftr.obj" \
-	"$(INTDIR)\shiftt.obj" \
-	"$(INTDIR)\shosli.obj" \
-	"$(INTDIR)\shosli2.obj" \
-	"$(INTDIR)\showmen.obj" \
-	"$(INTDIR)\shr.obj" \
-	"$(INTDIR)\shrinkq.obj" \
-	"$(INTDIR)\shuffledoc.obj" \
-	"$(INTDIR)\single.obj" \
-	"$(INTDIR)\slice.obj" \
-	"$(INTDIR)\smt3.obj" \
-	"$(INTDIR)\smt3_q.obj" \
-	"$(INTDIR)\solv2d.obj" \
-	"$(INTDIR)\solve.obj" \
-	"$(INTDIR)\sort.obj" \
-	"$(INTDIR)\sortdoc.obj" \
-	"$(INTDIR)\sortint.obj" \
-	"$(INTDIR)\sortz.obj" \
-	"$(INTDIR)\spdtotiff.obj" \
-	"$(INTDIR)\speak.obj" \
-	"$(INTDIR)\speak3.obj" \
-	"$(INTDIR)\speak3d.obj" \
-	"$(INTDIR)\speakc.obj" \
-	"$(INTDIR)\spider.obj" \
-	"$(INTDIR)\spitosgi.obj" \
-	"$(INTDIR)\spotwt.obj" \
-	"$(INTDIR)\squeez.obj" \
-	"$(INTDIR)\srip2.obj" \
-	"$(INTDIR)\sripe.obj" \
-	"$(INTDIR)\ssdisp.obj" \
-	"$(INTDIR)\sslowcas.obj" \
-	"$(INTDIR)\ssnr.obj" \
-	"$(INTDIR)\ssnrb.obj" \
-	"$(INTDIR)\ssparm.obj" \
-	"$(INTDIR)\sspush.obj" \
-	"$(INTDIR)\sstogl.obj" \
-	"$(INTDIR)\ssupcas.obj" \
-	"$(INTDIR)\stabk.obj" \
-	"$(INTDIR)\stack.obj" \
-	"$(INTDIR)\stackfix.obj" \
-	"$(INTDIR)\step.obj" \
-	"$(INTDIR)\stepi.obj" \
-	"$(INTDIR)\stocha.obj" \
-	"$(INTDIR)\strtdis.obj" \
-	"$(INTDIR)\subaf.obj" \
-	"$(INTDIR)\subkmeans.obj" \
-	"$(INTDIR)\subkmns.obj" \
-	"$(INTDIR)\subsp.obj" \
-	"$(INTDIR)\sumali.obj" \
-	"$(INTDIR)\sumap.obj" \
-	"$(INTDIR)\sunonly.obj" \
-	"$(INTDIR)\surfarea.obj" \
-	"$(INTDIR)\tcnp.obj" \
-	"$(INTDIR)\tf.obj" \
-	"$(INTDIR)\tfd.obj" \
-	"$(INTDIR)\thresh.obj" \
-	"$(INTDIR)\tilt.obj" \
-	"$(INTDIR)\tiltfd.obj" \
-	"$(INTDIR)\tima.obj" \
-	"$(INTDIR)\time.obj" \
-	"$(INTDIR)\title.obj" \
-	"$(INTDIR)\tmstrt.obj" \
-	"$(INTDIR)\toma.obj" \
-	"$(INTDIR)\totrec.obj" \
-	"$(INTDIR)\traf.obj" \
-	"$(INTDIR)\trafc.obj" \
-	"$(INTDIR)\trafc3.obj" \
-	"$(INTDIR)\trafct.obj" \
-	"$(INTDIR)\trafct3.obj" \
-	"$(INTDIR)\trafd.obj" \
-	"$(INTDIR)\transpose.obj" \
-	"$(INTDIR)\tridi.obj" \
-	"$(INTDIR)\trinter.obj" \
-	"$(INTDIR)\tswitch.obj" \
-	"$(INTDIR)\ttest.obj" \
-	"$(INTDIR)\tvwn1.obj" \
-	"$(INTDIR)\tvwn3.obj" \
-	"$(INTDIR)\unix32.obj" \
-	"$(INTDIR)\unixtounix8.obj" \
-	"$(INTDIR)\unixtovv.obj" \
-	"$(INTDIR)\unsav.obj" \
-	"$(INTDIR)\unsdal.obj" \
-	"$(INTDIR)\updf.obj" \
-	"$(INTDIR)\updtc.obj" \
-	"$(INTDIR)\updtf.obj" \
-	"$(INTDIR)\uqu.obj" \
-	"$(INTDIR)\util1.obj" \
-	"$(INTDIR)\util2.obj" \
-	"$(INTDIR)\util3.obj" \
-	"$(INTDIR)\util4.obj" \
-	"$(INTDIR)\util5.obj" \
-	"$(INTDIR)\util6.obj" \
-	"$(INTDIR)\vax32.obj" \
-	"$(INTDIR)\vax32u.obj" \
-	"$(INTDIR)\vaxtounix.obj" \
-	"$(INTDIR)\vectop.obj" \
-	"$(INTDIR)\version.obj" \
-	"$(INTDIR)\vismap.obj" \
-	"$(INTDIR)\vms.obj" \
-	"$(INTDIR)\voea.obj" \
-	"$(INTDIR)\vomd.obj" \
-	"$(INTDIR)\vora.obj" \
-	"$(INTDIR)\vota.obj" \
-	"$(INTDIR)\vprop.obj" \
-	"$(INTDIR)\vtil2.obj" \
-	"$(INTDIR)\vtil3.obj" \
-	"$(INTDIR)\wate.obj" \
-	"$(INTDIR)\weifu.obj" \
-	"$(INTDIR)\weifu3.obj" \
-	"$(INTDIR)\weightc.obj" \
-	"$(INTDIR)\weightf.obj" \
-	"$(INTDIR)\wftcirc.obj" \
-	"$(INTDIR)\wgbp2.obj" \
-	"$(INTDIR)\winave.obj" \
-	"$(INTDIR)\winave2.obj" \
-	"$(INTDIR)\window.obj" \
-	"$(INTDIR)\wiw32d.obj" \
-	"$(INTDIR)\wiw3d.obj" \
-	"$(INTDIR)\wpdp.obj" \
-	"$(INTDIR)\wpro.obj" \
-	"$(INTDIR)\writpro.obj" \
-	"$(INTDIR)\writs.obj" \
-	"$(INTDIR)\writt.obj" \
-	"$(INTDIR)\wrsl_p.obj" \
-	"$(INTDIR)\wrtarray.obj" \
-	"$(INTDIR)\wrthed.obj" \
-	"$(INTDIR)\wrthedmrc.obj" \
-	"$(INTDIR)\wrtlin.obj" \
-	"$(INTDIR)\wrtlin8.obj" \
-	"$(INTDIR)\wrtseq8.obj" \
-	"$(INTDIR)\wtf.obj" \
-	"$(INTDIR)\wtm.obj" \
-	"$(INTDIR)\x1yr.obj" \
-	"$(INTDIR)\xyout.obj"
-
-"$(OUTDIR)\spider.exe" : "$(OUTDIR)" $(DEF_FILE) $(LINK32_OBJS)
-    $(LINK32) @@<<
-  $(LINK32_FLAGS) $(LINK32_OBJS)
-<<
-
-.suffixes:.f .obj
-
-.f.obj:
-	@@cpp -PC -DSP_NT -D__osf__ $< > temp.f
-   	$(F90) $(F90_PROJ) /object $*.obj temp.f
-	@@copy temp.obj $*.obj > nul
-	@@erase temp.f
-	
-
-@
-
-
-1.2
-log
-@removed SP_ALLOC
-@
-text
-@d991 1
-a991 1
-	@@cpp -PC -DSP_UNIX -DSP_NT -D__osf__ $< > temp.f
-@
-
-
-1.1
-log
-@Initial revision
-@
-text
-@d991 1
-a991 1
-	@@cpp -PC -DSP_ALLOC -DSP_UNIX -DSP_NT -D__osf__ $< > temp.f
-@
diff --git src/Makefile_samples/RCS/Makefile_NT_Dec99,v src/Makefile_samples/RCS/Makefile_NT_Dec99,v
deleted file mode 100755
index 48762601..00000000
--- src/Makefile_samples/RCS/Makefile_NT_Dec99,v
+++ /dev/null
@@ -1,924 +0,0 @@
-head	1.2;
-access;
-symbols
-	best-code:1.1
-	x-named-regs:1.1
-	x:1.1
-	v13-00:1.1
-	pre_GPL:1.1
-	prec_CA:1.1
-	noindx:1.1
-	Bproc:1.1;
-locks; strict;
-comment	@# @;
-
-
-1.2
-date	2006.07.31.15.18.18;	author leith;	state dead;
-branches;
-next	1.1;
-
-1.1
-date	2000.04.25.14.22.34;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.2
-log
-@obsolete
-@
-text
-@# Microsoft Developer Studio Generated NMAKE File, Based on spider.dsp
-
-!IF "$(OS)" == "Windows_NT"
-NULL=
-!ELSE 
-NULL=nul
-!ENDIF 
-
-F90=df.exe
-OUTDIR=.
-INTDIR=.
-
-ALL : "$(OUTDIR)\spider.exe" "$(OUTDIR)\LUNHDR_INFO.MOD" "$(OUTDIR)\INLN_INFO.MOD"
-	@@copy spider.exe ..\bin > nul
-
-F90_PROJ=/compile_only /debug:full /include:"$(INTDIR)\\" /nologo /optimize:3 /traceback /warn:argument_checking /warn:nofileopt /module:"./" /object:"./" /pdbfile:"./DF60.PDB" 
-F90_OBJS=
-
-LINK32=link.exe
-LINK32_FLAGS=kernel32.lib user32.lib gdi32.lib winspool.lib comdlg32.lib advapi32.lib shell32.lib ole32.lib oleaut32.lib uuid.lib odbc32.lib odbccp32.lib /nologo /stack:0x3b9aca00 /subsystem:console /incremental:yes /pdb:"$(OUTDIR)\spider.pdb" /debug /machine:I386 /out:"$(OUTDIR)\spider.exe" /pdbtype:sept 
-LINK32_OBJS= \
-	"$(INTDIR)\acrs_2.obj" \
-	"$(INTDIR)\acrs_2r.obj" \
-	"$(INTDIR)\acrs_3.obj" \
-	"$(INTDIR)\acrs_3r.obj" \
-	"$(INTDIR)\add.obj" \
-	"$(INTDIR)\adds.obj" \
-	"$(INTDIR)\af.obj" \
-	"$(INTDIR)\afs.obj" \
-	"$(INTDIR)\al10.obj" \
-	"$(INTDIR)\allocit.obj" \
-	"$(INTDIR)\allocmem.obj" \
-	"$(INTDIR)\alphaint.obj" \
-	"$(INTDIR)\alprbs.obj" \
-	"$(INTDIR)\alprbs_q.obj" \
-	"$(INTDIR)\alrosf.obj" \
-	"$(INTDIR)\alrosf_q.obj" \
-	"$(INTDIR)\alrosi.obj" \
-	"$(INTDIR)\alrosi_q.obj" \
-	"$(INTDIR)\alrosr.obj" \
-	"$(INTDIR)\alrq.obj" \
-	"$(INTDIR)\alrq_m.obj" \
-	"$(INTDIR)\alrq_ms.obj" \
-	"$(INTDIR)\alrq_q.obj" \
-	"$(INTDIR)\alrqs.obj" \
-	"$(INTDIR)\amoeba.obj" \
-	"$(INTDIR)\ang.obj" \
-	"$(INTDIR)\angmor.obj" \
-	"$(INTDIR)\applyw.obj" \
-	"$(INTDIR)\applyws.obj" \
-	"$(INTDIR)\arasq.obj" \
-	"$(INTDIR)\arbre.obj" \
-	"$(INTDIR)\arith.obj" \
-	"$(INTDIR)\arithl.obj" \
-	"$(INTDIR)\asta.obj" \
-	"$(INTDIR)\astcyl.obj" \
-	"$(INTDIR)\atit2.obj" \
-	"$(INTDIR)\atpk.obj" \
-	"$(INTDIR)\atsa.obj" \
-	"$(INTDIR)\atwn.obj" \
-	"$(INTDIR)\averg.obj" \
-	"$(INTDIR)\averg3.obj" \
-	"$(INTDIR)\bckc0.obj" \
-	"$(INTDIR)\bckc2.obj" \
-	"$(INTDIR)\bckcq.obj" \
-	"$(INTDIR)\bcq.obj" \
-	"$(INTDIR)\betacf.obj" \
-	"$(INTDIR)\betai.obj" \
-	"$(INTDIR)\blank.obj" \
-	"$(INTDIR)\bldr.obj" \
-	"$(INTDIR)\blob.obj" \
-	"$(INTDIR)\blob_q.obj" \
-	"$(INTDIR)\bmax_c.obj" \
-	"$(INTDIR)\bmax_s.obj" \
-	"$(INTDIR)\bmin_c.obj" \
-	"$(INTDIR)\bmin_s.obj" \
-	"$(INTDIR)\borns.obj" \
-	"$(INTDIR)\boxx.obj" \
-	"$(INTDIR)\bpcm.obj" \
-	"$(INTDIR)\bpcmp.obj" \
-	"$(INTDIR)\bpcq.obj" \
-	"$(INTDIR)\bpcqp.obj" \
-	"$(INTDIR)\bprj2.obj" \
-	"$(INTDIR)\bps2.obj" \
-	"$(INTDIR)\bpwr.obj" \
-	"$(INTDIR)\bpwr_q.obj" \
-	"$(INTDIR)\buterp.obj" \
-	"$(INTDIR)\calc.obj" \
-	"$(INTDIR)\cald.obj" \
-	"$(INTDIR)\cang.obj" \
-	"$(INTDIR)\cc3d.obj" \
-	"$(INTDIR)\ccc.obj" \
-	"$(INTDIR)\ccff.obj" \
-	"$(INTDIR)\ccfm.obj" \
-	"$(INTDIR)\ccfn.obj" \
-	"$(INTDIR)\ccfr.obj" \
-	"$(INTDIR)\cconect.obj" \
-	"$(INTDIR)\ccrd_2.obj" \
-	"$(INTDIR)\ccrd_2r.obj" \
-	"$(INTDIR)\ccrd_3.obj" \
-	"$(INTDIR)\ccrd_3r.obj" \
-	"$(INTDIR)\ccrs_2.obj" \
-	"$(INTDIR)\ccrs_2r.obj" \
-	"$(INTDIR)\ccrs_3.obj" \
-	"$(INTDIR)\ccrs_3r.obj" \
-	"$(INTDIR)\cengr3.obj" \
-	"$(INTDIR)\cengra.obj" \
-	"$(INTDIR)\cent.obj" \
-	"$(INTDIR)\cent_3.obj" \
-	"$(INTDIR)\cent_d.obj" \
-	"$(INTDIR)\cent_q.obj" \
-	"$(INTDIR)\cgr_3.obj" \
-	"$(INTDIR)\changeval.obj" \
-	"$(INTDIR)\charinside.obj" \
-	"$(INTDIR)\chava.obj" \
-	"$(INTDIR)\chisq.obj" \
-	"$(INTDIR)\chkalloc.obj" \
-	"$(INTDIR)\chkinpq.obj" \
-	"$(INTDIR)\chkmem.obj" \
-	"$(INTDIR)\chkstr.obj" \
-	"$(INTDIR)\clast.obj" \
-	"$(INTDIR)\closefb.obj" \
-	"$(INTDIR)\clss.obj" \
-	"$(INTDIR)\clusterlst.obj" \
-	"$(INTDIR)\cncalc.obj" \
-	"$(INTDIR)\cnint3.obj" \
-	"$(INTDIR)\cnrd_2.obj" \
-	"$(INTDIR)\cnrd_2r.obj" \
-	"$(INTDIR)\cnrd_3.obj" \
-	"$(INTDIR)\cnrd_3r.obj" \
-	"$(INTDIR)\cnrs_2.obj" \
-	"$(INTDIR)\cnrs_2r.obj" \
-	"$(INTDIR)\cnrs_3.obj" \
-	"$(INTDIR)\cnrs_3r.obj" \
-	"$(INTDIR)\cnscan.obj" \
-	"$(INTDIR)\cnstuff.obj" \
-	"$(INTDIR)\cntrce.obj" \
-	"$(INTDIR)\cntrfl.obj" \
-	"$(INTDIR)\cntur.obj" \
-	"$(INTDIR)\comp3d.obj" \
-	"$(INTDIR)\comp3dmad.obj" \
-	"$(INTDIR)\conf.obj" \
-	"$(INTDIR)\conf1.obj" \
-	"$(INTDIR)\conint.obj" \
-	"$(INTDIR)\convl.obj" \
-	"$(INTDIR)\cop.obj" \
-	"$(INTDIR)\copd.obj" \
-	"$(INTDIR)\copy1.obj" \
-	"$(INTDIR)\copybrix.obj" \
-	"$(INTDIR)\copyd.obj" \
-	"$(INTDIR)\copye.obj" \
-	"$(INTDIR)\copyf.obj" \
-	"$(INTDIR)\copyfromnt.obj" \
-	"$(INTDIR)\copyfsimple.obj" \
-	"$(INTDIR)\copymdtr.obj" \
-	"$(INTDIR)\copymrc.obj" \
-	"$(INTDIR)\copypds.obj" \
-	"$(INTDIR)\copypos.obj" \
-	"$(INTDIR)\copyr.obj" \
-	"$(INTDIR)\copyshort.obj" \
-	"$(INTDIR)\copytont.obj" \
-	"$(INTDIR)\copytoxplor.obj" \
-	"$(INTDIR)\copyu.obj" \
-	"$(INTDIR)\corel.obj" \
-	"$(INTDIR)\corr1.obj" \
-	"$(INTDIR)\coupe.obj" \
-	"$(INTDIR)\cppb.obj" \
-	"$(INTDIR)\cproj.obj" \
-	"$(INTDIR)\cr180_2.obj" \
-	"$(INTDIR)\crcse1.obj" \
-	"$(INTDIR)\crcse3.obj" \
-	"$(INTDIR)\crosrmg_d.obj" \
-	"$(INTDIR)\crosrmg_ds.obj" \
-	"$(INTDIR)\crosrng.obj" \
-	"$(INTDIR)\crosrng_d.obj" \
-	"$(INTDIR)\crosrng_ds.obj" \
-	"$(INTDIR)\crosrng_f.obj" \
-	"$(INTDIR)\crosrng_m.obj" \
-	"$(INTDIR)\crosrng_ms.obj" \
-	"$(INTDIR)\crosrng_q.obj" \
-	"$(INTDIR)\crsm_2.obj" \
-	"$(INTDIR)\cslice.obj" \
-	"$(INTDIR)\csvms.obj" \
-	"$(INTDIR)\d3dplt.obj" \
-	"$(INTDIR)\date.obj" \
-	"$(INTDIR)\date_2k.obj" \
-	"$(INTDIR)\dchist.obj" \
-	"$(INTDIR)\deallocmem.obj" \
-	"$(INTDIR)\decimate.obj" \
-	"$(INTDIR)\dee.obj" \
-	"$(INTDIR)\defo001.obj" \
-	"$(INTDIR)\defo003.obj" \
-	"$(INTDIR)\defo1001.obj" \
-	"$(INTDIR)\defo2001.obj" \
-	"$(INTDIR)\defocus.obj" \
-	"$(INTDIR)\deletf.obj" \
-	"$(INTDIR)\dendro.obj" \
-	"$(INTDIR)\dendro2.obj" \
-	"$(INTDIR)\denlst.obj" \
-	"$(INTDIR)\denov.obj" \
-	"$(INTDIR)\denref.obj" \
-	"$(INTDIR)\deucl.obj" \
-	"$(INTDIR)\dhide.obj" \
-	"$(INTDIR)\diff1o.obj" \
-	"$(INTDIR)\dirnm.obj" \
-	"$(INTDIR)\disc.obj" \
-	"$(INTDIR)\discrim.obj" \
-	"$(INTDIR)\dist1.obj" \
-	"$(INTDIR)\dist2.obj" \
-	"$(INTDIR)\dist4.obj" \
-	"$(INTDIR)\dist_p.obj" \
-	"$(INTDIR)\distest.obj" \
-	"$(INTDIR)\divcr3.obj" \
-	"$(INTDIR)\docorr3_s.obj" \
-	"$(INTDIR)\docors3_s.obj" \
-	"$(INTDIR)\docs1.obj" \
-	"$(INTDIR)\domax3_s.obj" \
-	"$(INTDIR)\domin3_s.obj" \
-	"$(INTDIR)\dprofd.obj" \
-	"$(INTDIR)\dprofl.obj" \
-	"$(INTDIR)\driv1.obj" \
-	"$(INTDIR)\driv2.obj" \
-	"$(INTDIR)\driv3.obj" \
-	"$(INTDIR)\dsfr.obj" \
-	"$(INTDIR)\dsfs.obj" \
-	"$(INTDIR)\dsfs_p.obj" \
-	"$(INTDIR)\dsgr.obj" \
-	"$(INTDIR)\dust.obj" \
-	"$(INTDIR)\dvcr.obj" \
-	"$(INTDIR)\edge.obj" \
-	"$(INTDIR)\eff.obj" \
-	"$(INTDIR)\ehist.obj" \
-	"$(INTDIR)\empsli.obj" \
-	"$(INTDIR)\endit.obj" \
-	"$(INTDIR)\ener.obj" \
-	"$(INTDIR)\enfr_2.obj" \
-	"$(INTDIR)\enhanc.obj" \
-	"$(INTDIR)\envelope.obj" \
-	"$(INTDIR)\epur4.obj" \
-	"$(INTDIR)\erc.obj" \
-	"$(INTDIR)\errf2.obj" \
-	"$(INTDIR)\erri2.obj" \
-	"$(INTDIR)\errt.obj" \
-	"$(INTDIR)\evalnq.obj" \
-	"$(INTDIR)\express3q.obj" \
-	"$(INTDIR)\exprq.obj" \
-	"$(INTDIR)\f3mr.obj" \
-	"$(INTDIR)\falb.obj" \
-	"$(INTDIR)\falb_p.obj" \
-	"$(INTDIR)\fcnq.obj" \
-	"$(INTDIR)\fermp.obj" \
-	"$(INTDIR)\ffilts.obj" \
-	"$(INTDIR)\fftc_d.obj" \
-	"$(INTDIR)\fftc_q.obj" \
-	"$(INTDIR)\fftmcf.obj" \
-	"$(INTDIR)\fftr_d.obj" \
-	"$(INTDIR)\fftr_q.obj" \
-	"$(INTDIR)\fgr.obj" \
-	"$(INTDIR)\fh.obj" \
-	"$(INTDIR)\fhodt.obj" \
-	"$(INTDIR)\fht.obj" \
-	"$(INTDIR)\filcad.obj" \
-	"$(INTDIR)\filcan.obj" \
-	"$(INTDIR)\fildat.obj" \
-	"$(INTDIR)\filelist.obj" \
-	"$(INTDIR)\filerd.obj" \
-	"$(INTDIR)\filgen.obj" \
-	"$(INTDIR)\filget.obj" \
-	"$(INTDIR)\filnamandext.obj" \
-	"$(INTDIR)\filnamsub.obj" \
-	"$(INTDIR)\filseqp.obj" \
-	"$(INTDIR)\filsli.obj" \
-	"$(INTDIR)\filt3_p.obj" \
-	"$(INTDIR)\filtdoc.obj" \
-	"$(INTDIR)\filtplot.obj" \
-	"$(INTDIR)\findfrq.obj" \
-	"$(INTDIR)\findlbq.obj" \
-	"$(INTDIR)\findmx.obj" \
-	"$(INTDIR)\findmx_f.obj" \
-	"$(INTDIR)\findmx_q.obj" \
-	"$(INTDIR)\fint.obj" \
-	"$(INTDIR)\fint3.obj" \
-	"$(INTDIR)\fitt.obj" \
-	"$(INTDIR)\flipbytes.obj" \
-	"$(INTDIR)\fmax_c.obj" \
-	"$(INTDIR)\fmax_q.obj" \
-	"$(INTDIR)\fmax_s.obj" \
-	"$(INTDIR)\fmin_c.obj" \
-	"$(INTDIR)\fmin_q.obj" \
-	"$(INTDIR)\fmin_s.obj" \
-	"$(INTDIR)\fmr_1.obj" \
-	"$(INTDIR)\fmr_2.obj" \
-	"$(INTDIR)\fmrs_1.obj" \
-	"$(INTDIR)\fmrs_1d.obj" \
-	"$(INTDIR)\fmrs_2.obj" \
-	"$(INTDIR)\fmrs_2d.obj" \
-	"$(INTDIR)\fmrs_2dr.obj" \
-	"$(INTDIR)\fmrs_2r.obj" \
-	"$(INTDIR)\fmrs_3.obj" \
-	"$(INTDIR)\fmrs_3d.obj" \
-	"$(INTDIR)\fmrs_3dr.obj" \
-	"$(INTDIR)\fmrs_3r.obj" \
-	"$(INTDIR)\fnrm.obj" \
-	"$(INTDIR)\four1.obj" \
-	"$(INTDIR)\four1a.obj" \
-	"$(INTDIR)\four1a_fp.obj" \
-	"$(INTDIR)\four1b.obj" \
-	"$(INTDIR)\four1c.obj" \
-	"$(INTDIR)\fouring.obj" \
-	"$(INTDIR)\fouring_q.obj" \
-	"$(INTDIR)\fq3_p.obj" \
-	"$(INTDIR)\fq_q.obj" \
-	"$(INTDIR)\frng.obj" \
-	"$(INTDIR)\frngs.obj" \
-	"$(INTDIR)\fromtoq.obj" \
-	"$(INTDIR)\fsort.obj" \
-	"$(INTDIR)\funiq.obj" \
-	"$(INTDIR)\gali.obj" \
-	"$(INTDIR)\gali_p.obj" \
-	"$(INTDIR)\gam.obj" \
-	"$(INTDIR)\gammln.obj" \
-	"$(INTDIR)\gaussp.obj" \
-	"$(INTDIR)\gee.obj" \
-	"$(INTDIR)\getang.obj" \
-	"$(INTDIR)\getcoo.obj" \
-	"$(INTDIR)\getcoo2.obj" \
-	"$(INTDIR)\getcoot.obj" \
-	"$(INTDIR)\getctf.obj" \
-	"$(INTDIR)\getdocdat.obj" \
-	"$(INTDIR)\getima.obj" \
-	"$(INTDIR)\getima_q.obj" \
-	"$(INTDIR)\getlab.obj" \
-	"$(INTDIR)\getlbno.obj" \
-	"$(INTDIR)\getnewstack.obj" \
-	"$(INTDIR)\getoldstack.obj" \
-	"$(INTDIR)\getvoldat.obj" \
-	"$(INTDIR)\gnc.obj" \
-	"$(INTDIR)\gnc2s.obj" \
-	"$(INTDIR)\gotbranch.obj" \
-	"$(INTDIR)\gp.obj" \
-	"$(INTDIR)\graphp.obj" \
-	"$(INTDIR)\graphs.obj" \
-	"$(INTDIR)\gsmod.obj" \
-	"$(INTDIR)\gsmodl.obj" \
-	"$(INTDIR)\hali.obj" \
-	"$(INTDIR)\hali_p.obj" \
-	"$(INTDIR)\hclp.obj" \
-	"$(INTDIR)\hcls.obj" \
-	"$(INTDIR)\hdiag.obj" \
-	"$(INTDIR)\hdls.obj" \
-	"$(INTDIR)\hels.obj" \
-	"$(INTDIR)\hf.obj" \
-	"$(INTDIR)\hgr.obj" \
-	"$(INTDIR)\hiang.obj" \
-	"$(INTDIR)\hisd.obj" \
-	"$(INTDIR)\hismap.obj" \
-	"$(INTDIR)\hismap4.obj" \
-	"$(INTDIR)\hist.obj" \
-	"$(INTDIR)\histc.obj" \
-	"$(INTDIR)\histe.obj" \
-	"$(INTDIR)\histod.obj" \
-	"$(INTDIR)\histodc.obj" \
-	"$(INTDIR)\hkmc.obj" \
-	"$(INTDIR)\hsort.obj" \
-	"$(INTDIR)\iftorpn.obj" \
-	"$(INTDIR)\imseq4.obj" \
-	"$(INTDIR)\imsq.obj" \
-	"$(INTDIR)\imstat.obj" \
-	"$(INTDIR)\imtovol.obj" \
-	"$(INTDIR)\incor3.obj" \
-	"$(INTDIR)\indextoreg.obj" \
-	"$(INTDIR)\inf3_p.obj" \
-	"$(INTDIR)\inf_q.obj" \
-	"$(INTDIR)\initunix.obj" \
-	"$(INTDIR)\inlnbuf.obj" \
-	"$(INTDIR)\inquireif.obj" \
-	"$(INTDIR)\inquireif1.obj" \
-	"$(INTDIR)\inquirereg.obj" \
-	"$(INTDIR)\inquiresync.obj" \
-	"$(INTDIR)\interl.obj" \
-	"$(INTDIR)\interp.obj" \
-	"$(INTDIR)\interp3.obj" \
-	"$(INTDIR)\inttochar.obj" \
-	"$(INTDIR)\invbt.obj" \
-	"$(INTDIR)\ipalign64.obj" \
-	"$(INTDIR)\irp3.obj" \
-	"$(INTDIR)\isbare.obj" \
-	"$(INTDIR)\ischar.obj" \
-	"$(INTDIR)\isdigi.obj" \
-	"$(INTDIR)\itpow.obj" \
-	"$(INTDIR)\jpmsk1.obj" \
-	"$(INTDIR)\jpmsk2.obj" \
-	"$(INTDIR)\lastoccur.obj" \
-	"$(INTDIR)\latcen.obj" \
-	"$(INTDIR)\latice.obj" \
-	"$(INTDIR)\lenopenfile.obj" \
-	"$(INTDIR)\lhist.obj" \
-	"$(INTDIR)\listdc.obj" \
-	"$(INTDIR)\listit.obj" \
-	"$(INTDIR)\listitr.obj" \
-	"$(INTDIR)\listregs.obj" \
-	"$(INTDIR)\lmdif.obj" \
-	"$(INTDIR)\lmdif1.obj" \
-	"$(INTDIR)\lnblnk.obj" \
-	"$(INTDIR)\lnblnkn.obj" \
-	"$(INTDIR)\local.obj" \
-	"$(INTDIR)\log2.obj" \
-	"$(INTDIR)\log2_p.obj" \
-	"$(INTDIR)\logifq.obj" \
-	"$(INTDIR)\longer.obj" \
-	"$(INTDIR)\lundoc.obj" \
-	"$(INTDIR)\lunsethdr.obj" \
-	"$(INTDIR)\macf.obj" \
-	"$(INTDIR)\macf_p.obj" \
-	"$(INTDIR)\mahal.obj" \
-	"$(INTDIR)\makestack.obj" \
-	"$(INTDIR)\maktab.obj" \
-	"$(INTDIR)\malfi3.obj" \
-	"$(INTDIR)\mapdist.obj" \
-	"$(INTDIR)\mapdoc.obj" \
-	"$(INTDIR)\mapfilt.obj" \
-	"$(INTDIR)\mapim.obj" \
-	"$(INTDIR)\mapstat.obj" \
-	"$(INTDIR)\mask.obj" \
-	"$(INTDIR)\maskmu.obj" \
-	"$(INTDIR)\matinv.obj" \
-	"$(INTDIR)\maxf.obj" \
-	"$(INTDIR)\mcircl.obj" \
-	"$(INTDIR)\md2.obj" \
-	"$(INTDIR)\md3.obj" \
-	"$(INTDIR)\median.obj" \
-	"$(INTDIR)\meed.obj" \
-	"$(INTDIR)\mhelp.obj" \
-	"$(INTDIR)\mhelp_sub.obj" \
-	"$(INTDIR)\mirror.obj" \
-	"$(INTDIR)\mjc.obj" \
-	"$(INTDIR)\mlc.obj" \
-	"$(INTDIR)\mline.obj" \
-	"$(INTDIR)\mline3.obj" \
-	"$(INTDIR)\mls.obj" \
-	"$(INTDIR)\mod1.obj" \
-	"$(INTDIR)\model.obj" \
-	"$(INTDIR)\model3.obj" \
-	"$(INTDIR)\mont.obj" \
-	"$(INTDIR)\movipc.obj" \
-	"$(INTDIR)\mpoint.obj" \
-	"$(INTDIR)\mr2to3d.obj" \
-	"$(INTDIR)\mrali.obj" \
-	"$(INTDIR)\mrali_p.obj" \
-	"$(INTDIR)\mralign.obj" \
-	"$(INTDIR)\mrang2.obj" \
-	"$(INTDIR)\mrcalerr.obj" \
-	"$(INTDIR)\mrcenti.obj" \
-	"$(INTDIR)\mrcg3.obj" \
-	"$(INTDIR)\mrcg3d.obj" \
-	"$(INTDIR)\mrcp.obj" \
-	"$(INTDIR)\mrdoc.obj" \
-	"$(INTDIR)\mrdoccor.obj" \
-	"$(INTDIR)\mread.obj" \
-	"$(INTDIR)\mrectl.obj" \
-	"$(INTDIR)\mreigen.obj" \
-	"$(INTDIR)\mrerror.obj" \
-	"$(INTDIR)\mrget3d.obj" \
-	"$(INTDIR)\mrgetinfo.obj" \
-	"$(INTDIR)\mrk.obj" \
-	"$(INTDIR)\mrk3.obj" \
-	"$(INTDIR)\mrkur3.obj" \
-	"$(INTDIR)\mrncolor.obj" \
-	"$(INTDIR)\mrnewangle.obj" \
-	"$(INTDIR)\mrproj.obj" \
-	"$(INTDIR)\mrprrep.obj" \
-	"$(INTDIR)\mrputinfo.obj" \
-	"$(INTDIR)\mrqli.obj" \
-	"$(INTDIR)\mrquater.obj" \
-	"$(INTDIR)\mrrefl.obj" \
-	"$(INTDIR)\mrreplace.obj" \
-	"$(INTDIR)\mrrotate.obj" \
-	"$(INTDIR)\mrrsurf.obj" \
-	"$(INTDIR)\mrrt.obj" \
-	"$(INTDIR)\mrscale.obj" \
-	"$(INTDIR)\mrscale3.obj" \
-	"$(INTDIR)\mrshift.obj" \
-	"$(INTDIR)\mrsurf.obj" \
-	"$(INTDIR)\mrtheta.obj" \
-	"$(INTDIR)\mskdec.obj" \
-	"$(INTDIR)\msum.obj" \
-	"$(INTDIR)\mtnv.obj" \
-	"$(INTDIR)\mtpr.obj" \
-	"$(INTDIR)\mtrian.obj" \
-	"$(INTDIR)\mulf2.obj" \
-	"$(INTDIR)\mulf3.obj" \
-	"$(INTDIR)\mulfc3.obj" \
-	"$(INTDIR)\mulfi3.obj" \
-	"$(INTDIR)\mult.obj" \
-	"$(INTDIR)\mygetenv.obj" \
-	"$(INTDIR)\mymods.obj" \
-	"$(INTDIR)\myread.obj" \
-	"$(INTDIR)\mywr0.obj" \
-	"$(INTDIR)\mywr1.obj" \
-	"$(INTDIR)\mywr2.obj" \
-	"$(INTDIR)\narea.obj" \
-	"$(INTDIR)\negate.obj" \
-	"$(INTDIR)\negati.obj" \
-	"$(INTDIR)\newkmeans.obj" \
-	"$(INTDIR)\nextversion.obj" \
-	"$(INTDIR)\nfq.obj" \
-	"$(INTDIR)\ngq.obj" \
-	"$(INTDIR)\nlclusrd.obj" \
-	"$(INTDIR)\noise.obj" \
-	"$(INTDIR)\norm3.obj" \
-	"$(INTDIR)\normas.obj" \
-	"$(INTDIR)\normasc.obj" \
-	"$(INTDIR)\normass.obj" \
-	"$(INTDIR)\normm.obj" \
-	"$(INTDIR)\norppf.obj" \
-	"$(INTDIR)\noyau.obj" \
-	"$(INTDIR)\nrml.obj" \
-	"$(INTDIR)\nrms.obj" \
-	"$(INTDIR)\nrq.obj" \
-	"$(INTDIR)\nrqli.obj" \
-	"$(INTDIR)\nt32.obj" \
-	"$(INTDIR)\numdig.obj" \
-	"$(INTDIR)\od.obj" \
-	"$(INTDIR)\opauxfile.obj" \
-	"$(INTDIR)\openchk.obj" \
-	"$(INTDIR)\opendoc.obj" \
-	"$(INTDIR)\openf.obj" \
-	"$(INTDIR)\openfb.obj" \
-	"$(INTDIR)\openfil.obj" \
-	"$(INTDIR)\openinln.obj" \
-	"$(INTDIR)\openinstk.obj" \
-	"$(INTDIR)\openstk.obj" \
-	"$(INTDIR)\opfil.obj" \
-	"$(INTDIR)\opfile.obj" \
-	"$(INTDIR)\opsf3_p.obj" \
-	"$(INTDIR)\opsf_p.obj" \
-	"$(INTDIR)\orcdf.obj" \
-	"$(INTDIR)\ordere.obj" \
-	"$(INTDIR)\ormd.obj" \
-	"$(INTDIR)\ormd_p.obj" \
-	"$(INTDIR)\outim_q.obj" \
-	"$(INTDIR)\outpr.obj" \
-	"$(INTDIR)\outrng.obj" \
-	"$(INTDIR)\parabl.obj" \
-	"$(INTDIR)\parabld.obj" \
-	"$(INTDIR)\parst.obj" \
-	"$(INTDIR)\patch.obj" \
-	"$(INTDIR)\pca_coorx.obj" \
-	"$(INTDIR)\pca_cproj.obj" \
-	"$(INTDIR)\pca_gsmod.obj" \
-	"$(INTDIR)\pca_gsmodl.obj" \
-	"$(INTDIR)\pca_incor3.obj" \
-	"$(INTDIR)\pca_itpow.obj" \
-	"$(INTDIR)\pca_main.obj" \
-	"$(INTDIR)\pca_recdum.obj" \
-	"$(INTDIR)\pca_remake.obj" \
-	"$(INTDIR)\pca_srip2.obj" \
-	"$(INTDIR)\pca_sripe.obj" \
-	"$(INTDIR)\pca_stocha.obj" \
-	"$(INTDIR)\pcascoor.obj" \
-	"$(INTDIR)\pcaxcoor.obj" \
-	"$(INTDIR)\pcaxpose.obj" \
-	"$(INTDIR)\pcaxprod.obj" \
-	"$(INTDIR)\pdates.obj" \
-	"$(INTDIR)\permut.obj" \
-	"$(INTDIR)\picksl.obj" \
-	"$(INTDIR)\picksv.obj" \
-	"$(INTDIR)\pj3.obj" \
-	"$(INTDIR)\pj3q.obj" \
-	"$(INTDIR)\pkd.obj" \
-	"$(INTDIR)\pksr3.obj" \
-	"$(INTDIR)\plnedg.obj" \
-	"$(INTDIR)\plot1.obj" \
-	"$(INTDIR)\plot2.obj" \
-	"$(INTDIR)\poj.obj" \
-	"$(INTDIR)\polfit.obj" \
-	"$(INTDIR)\polish.obj" \
-	"$(INTDIR)\pollsq.obj" \
-	"$(INTDIR)\polqs.obj" \
-	"$(INTDIR)\posaxis.obj" \
-	"$(INTDIR)\postrt.obj" \
-	"$(INTDIR)\pr3d.obj" \
-	"$(INTDIR)\pr3db.obj" \
-	"$(INTDIR)\prb1d.obj" \
-	"$(INTDIR)\prepcub_q.obj" \
-	"$(INTDIR)\prepcub_s.obj" \
-	"$(INTDIR)\prepsl_2.obj" \
-	"$(INTDIR)\prepsl_s.obj" \
-	"$(INTDIR)\prjc0.obj" \
-	"$(INTDIR)\prjc2.obj" \
-	"$(INTDIR)\prjcq.obj" \
-	"$(INTDIR)\prjs2.obj" \
-	"$(INTDIR)\prntxx.obj" \
-	"$(INTDIR)\prober.obj" \
-	"$(INTDIR)\prp.obj" \
-	"$(INTDIR)\prt.obj" \
-	"$(INTDIR)\pttern.obj" \
-	"$(INTDIR)\putlin.obj" \
-	"$(INTDIR)\putpt.obj" \
-	"$(INTDIR)\putpt1.obj" \
-	"$(INTDIR)\putpt2.obj" \
-	"$(INTDIR)\pw2s.obj" \
-	"$(INTDIR)\pw2sd.obj" \
-	"$(INTDIR)\pw2sdr.obj" \
-	"$(INTDIR)\pw2sr.obj" \
-	"$(INTDIR)\pw3s.obj" \
-	"$(INTDIR)\pw3sd.obj" \
-	"$(INTDIR)\pw3sdr.obj" \
-	"$(INTDIR)\pw3sr.obj" \
-	"$(INTDIR)\qali.obj" \
-	"$(INTDIR)\qali_p.obj" \
-	"$(INTDIR)\qfact.obj" \
-	"$(INTDIR)\qfact_p.obj" \
-	"$(INTDIR)\qnr.obj" \
-	"$(INTDIR)\qnrf.obj" \
-	"$(INTDIR)\qstat.obj" \
-	"$(INTDIR)\quadri.obj" \
-	"$(INTDIR)\quadri_q.obj" \
-	"$(INTDIR)\radav.obj" \
-	"$(INTDIR)\radavi.obj" \
-	"$(INTDIR)\radweight.obj" \
-	"$(INTDIR)\ramp.obj" \
-	"$(INTDIR)\ramp_p.obj" \
-	"$(INTDIR)\rand_p.obj" \
-	"$(INTDIR)\rann.obj" \
-	"$(INTDIR)\rathin.obj" \
-	"$(INTDIR)\rawtospider.obj" \
-	"$(INTDIR)\rclu.obj" \
-	"$(INTDIR)\rcnv2_p.obj" \
-	"$(INTDIR)\rcnv3_p.obj" \
-	"$(INTDIR)\rconv.obj" \
-	"$(INTDIR)\rctfs.obj" \
-	"$(INTDIR)\rctfss.obj" \
-	"$(INTDIR)\rdclus.obj" \
-	"$(INTDIR)\rddoca2q.obj" \
-	"$(INTDIR)\rddocn.obj" \
-	"$(INTDIR)\rddocq.obj" \
-	"$(INTDIR)\rdfc.obj" \
-	"$(INTDIR)\rdpa.obj" \
-	"$(INTDIR)\rdpr.obj" \
-	"$(INTDIR)\rdpraf.obj" \
-	"$(INTDIR)\rdprai.obj" \
-	"$(INTDIR)\rdpranc.obj" \
-	"$(INTDIR)\rdpri1s.obj" \
-	"$(INTDIR)\rdpri3s.obj" \
-	"$(INTDIR)\rdprinc.obj" \
-	"$(INTDIR)\rdpris.obj" \
-	"$(INTDIR)\rdprj.obj" \
-	"$(INTDIR)\rdprm.obj" \
-	"$(INTDIR)\rdprm1s.obj" \
-	"$(INTDIR)\rdprm2.obj" \
-	"$(INTDIR)\rdprm2s.obj" \
-	"$(INTDIR)\rdprm3s.obj" \
-	"$(INTDIR)\rdprmc.obj" \
-	"$(INTDIR)\rdprmi.obj" \
-	"$(INTDIR)\rdsl_p.obj" \
-	"$(INTDIR)\readpdb.obj" \
-	"$(INTDIR)\readpq.obj" \
-	"$(INTDIR)\readrq.obj" \
-	"$(INTDIR)\reads.obj" \
-	"$(INTDIR)\readt.obj" \
-	"$(INTDIR)\readv.obj" \
-	"$(INTDIR)\reang.obj" \
-	"$(INTDIR)\recdum.obj" \
-	"$(INTDIR)\recons.obj" \
-	"$(INTDIR)\redhed.obj" \
-	"$(INTDIR)\redhedmrc.obj" \
-	"$(INTDIR)\redlin.obj" \
-	"$(INTDIR)\redlin8.obj" \
-	"$(INTDIR)\redpro2.obj" \
-	"$(INTDIR)\redprq.obj" \
-	"$(INTDIR)\redrec8.obj" \
-	"$(INTDIR)\reform.obj" \
-	"$(INTDIR)\reform0.obj" \
-	"$(INTDIR)\remez.obj" \
-	"$(INTDIR)\remezp.obj" \
-	"$(INTDIR)\repc.obj" \
-	"$(INTDIR)\repcg.obj" \
-	"$(INTDIR)\repr2_s.obj" \
-	"$(INTDIR)\repr32_q.obj" \
-	"$(INTDIR)\repr3_q.obj" \
-	"$(INTDIR)\reprwb.obj" \
-	"$(INTDIR)\reps.obj" \
-	"$(INTDIR)\retir.obj" \
-	"$(INTDIR)\rew.obj" \
-	"$(INTDIR)\rfactsd2.obj" \
-	"$(INTDIR)\rfactsdo.obj" \
-	"$(INTDIR)\rgri.obj" \
-	"$(INTDIR)\ringwe.obj" \
-	"$(INTDIR)\rmz_p.obj" \
-	"$(INTDIR)\rot.obj" \
-	"$(INTDIR)\rot2qs.obj" \
-	"$(INTDIR)\rot3.obj" \
-	"$(INTDIR)\rot32.obj" \
-	"$(INTDIR)\rot3_p.obj" \
-	"$(INTDIR)\rot_p.obj" \
-	"$(INTDIR)\rotal3.obj" \
-	"$(INTDIR)\rotas3.obj" \
-	"$(INTDIR)\rotl3.obj" \
-	"$(INTDIR)\rotqs.obj" \
-	"$(INTDIR)\rots3.obj" \
-	"$(INTDIR)\rout.obj" \
-	"$(INTDIR)\rprq.obj" \
-	"$(INTDIR)\rtq.obj" \
-	"$(INTDIR)\rtq_q.obj" \
-	"$(INTDIR)\rtqs.obj" \
-	"$(INTDIR)\rtqs_q.obj" \
-	"$(INTDIR)\rys1.obj" \
-	"$(INTDIR)\rys3.obj" \
-	"$(INTDIR)\saqb.obj" \
-	"$(INTDIR)\saqb_f.obj" \
-	"$(INTDIR)\saqb_p.obj" \
-	"$(INTDIR)\savd.obj" \
-	"$(INTDIR)\savdn1.obj" \
-	"$(INTDIR)\savdocq.obj" \
-	"$(INTDIR)\sclassi.obj" \
-	"$(INTDIR)\sclassy.obj" \
-	"$(INTDIR)\scoran3.obj" \
-	"$(INTDIR)\searchq.obj" \
-	"$(INTDIR)\secnds.obj" \
-	"$(INTDIR)\seedfill.obj" \
-	"$(INTDIR)\seeds.obj" \
-	"$(INTDIR)\semis.obj" \
-	"$(INTDIR)\sen3a.obj" \
-	"$(INTDIR)\setlab.obj" \
-	"$(INTDIR)\setmode.obj" \
-	"$(INTDIR)\setprm.obj" \
-	"$(INTDIR)\setprmb.obj" \
-	"$(INTDIR)\setval.obj" \
-	"$(INTDIR)\sgraf.obj" \
-	"$(INTDIR)\sh180_2.obj" \
-	"$(INTDIR)\shelk.obj" \
-	"$(INTDIR)\shfc_2.obj" \
-	"$(INTDIR)\shfi_2.obj" \
-	"$(INTDIR)\shfi_q.obj" \
-	"$(INTDIR)\shfm_2.obj" \
-	"$(INTDIR)\shift1.obj" \
-	"$(INTDIR)\shift2.obj" \
-	"$(INTDIR)\shift3.obj" \
-	"$(INTDIR)\shift_3d.obj" \
-	"$(INTDIR)\shift_pf.obj" \
-	"$(INTDIR)\shiftr.obj" \
-	"$(INTDIR)\shiftt.obj" \
-	"$(INTDIR)\shosli.obj" \
-	"$(INTDIR)\shosli2.obj" \
-	"$(INTDIR)\shr.obj" \
-	"$(INTDIR)\shrinkq.obj" \
-	"$(INTDIR)\shuffledoc.obj" \
-	"$(INTDIR)\single.obj" \
-	"$(INTDIR)\slice.obj" \
-	"$(INTDIR)\smt3.obj" \
-	"$(INTDIR)\smt3_q.obj" \
-	"$(INTDIR)\solv2d.obj" \
-	"$(INTDIR)\solve.obj" \
-	"$(INTDIR)\sort.obj" \
-	"$(INTDIR)\sortdoc.obj" \
-	"$(INTDIR)\sortint.obj" \
-	"$(INTDIR)\sortz.obj" \
-	"$(INTDIR)\spdtotiff.obj" \
-	"$(INTDIR)\speak.obj" \
-	"$(INTDIR)\speak3.obj" \
-	"$(INTDIR)\speak3d.obj" \
-	"$(INTDIR)\speakc.obj" \
-	"$(INTDIR)\spider.obj" \
-	"$(INTDIR)\spitosgi.obj" \
-	"$(INTDIR)\spotwt.obj" \
-	"$(INTDIR)\squeez.obj" \
-	"$(INTDIR)\srip2.obj" \
-	"$(INTDIR)\sripe.obj" \
-	"$(INTDIR)\sslowcas.obj" \
-	"$(INTDIR)\ssnr.obj" \
-	"$(INTDIR)\ssnrb.obj" \
-	"$(INTDIR)\sspush.obj" \
-	"$(INTDIR)\ssupcas.obj" \
-	"$(INTDIR)\stabk.obj" \
-	"$(INTDIR)\stack.obj" \
-	"$(INTDIR)\stackfix.obj" \
-	"$(INTDIR)\step.obj" \
-	"$(INTDIR)\stepi.obj" \
-	"$(INTDIR)\stocha.obj" \
-	"$(INTDIR)\subaf.obj" \
-	"$(INTDIR)\subkmeans.obj" \
-	"$(INTDIR)\subkmns.obj" \
-	"$(INTDIR)\subsp.obj" \
-	"$(INTDIR)\sumali.obj" \
-	"$(INTDIR)\sumali3.obj" \
-	"$(INTDIR)\sumap.obj" \
-	"$(INTDIR)\sumeuler.obj" \
-	"$(INTDIR)\sunonly.obj" \
-	"$(INTDIR)\surfarea.obj" \
-	"$(INTDIR)\surftovol.obj" \
-	"$(INTDIR)\tcnp.obj" \
-	"$(INTDIR)\tf.obj" \
-	"$(INTDIR)\tfd.obj" \
-	"$(INTDIR)\thresh.obj" \
-	"$(INTDIR)\tilt.obj" \
-	"$(INTDIR)\tiltfd.obj" \
-	"$(INTDIR)\tima.obj" \
-	"$(INTDIR)\time.obj" \
-	"$(INTDIR)\title.obj" \
-	"$(INTDIR)\toma.obj" \
-	"$(INTDIR)\totrec.obj" \
-	"$(INTDIR)\traf.obj" \
-	"$(INTDIR)\trafc.obj" \
-	"$(INTDIR)\trafc3.obj" \
-	"$(INTDIR)\trafct.obj" \
-	"$(INTDIR)\trafct3.obj" \
-	"$(INTDIR)\trafd.obj" \
-	"$(INTDIR)\transpose.obj" \
-	"$(INTDIR)\tridi.obj" \
-	"$(INTDIR)\trinter.obj" \
-	"$(INTDIR)\tswitch.obj" \
-	"$(INTDIR)\ttest.obj" \
-	"$(INTDIR)\tvwn1.obj" \
-	"$(INTDIR)\tvwn3.obj" \
-	"$(INTDIR)\unixtounix8.obj" \
-	"$(INTDIR)\unixtovv.obj" \
-	"$(INTDIR)\unsav.obj" \
-	"$(INTDIR)\unsdal.obj" \
-	"$(INTDIR)\updf.obj" \
-	"$(INTDIR)\updtc.obj" \
-	"$(INTDIR)\updtf.obj" \
-	"$(INTDIR)\uqu.obj" \
-	"$(INTDIR)\util1.obj" \
-	"$(INTDIR)\util2.obj" \
-	"$(INTDIR)\util2sup.obj" \
-	"$(INTDIR)\util3.obj" \
-	"$(INTDIR)\util4.obj" \
-	"$(INTDIR)\util5.obj" \
-	"$(INTDIR)\util6.obj" \
-	"$(INTDIR)\vax32u.obj" \
-	"$(INTDIR)\vaxtounix.obj" \
-	"$(INTDIR)\vismap.obj" \
-	"$(INTDIR)\vms.obj" \
-	"$(INTDIR)\voda.obj" \
-	"$(INTDIR)\voea.obj" \
-	"$(INTDIR)\vomd.obj" \
-	"$(INTDIR)\vomq.obj" \
-	"$(INTDIR)\vora.obj" \
-	"$(INTDIR)\vota.obj" \
-	"$(INTDIR)\vprop.obj" \
-	"$(INTDIR)\vtil2.obj" \
-	"$(INTDIR)\vtil3.obj" \
-	"$(INTDIR)\wate.obj" \
-	"$(INTDIR)\wftcirc.obj" \
-	"$(INTDIR)\wgbp2.obj" \
-	"$(INTDIR)\winave.obj" \
-	"$(INTDIR)\winave2.obj" \
-	"$(INTDIR)\window.obj" \
-	"$(INTDIR)\wiw32d.obj" \
-	"$(INTDIR)\wiw3d.obj" \
-	"$(INTDIR)\wpdp.obj" \
-	"$(INTDIR)\wpro.obj" \
-	"$(INTDIR)\writev.obj" \
-	"$(INTDIR)\writpro.obj" \
-	"$(INTDIR)\writs.obj" \
-	"$(INTDIR)\writt.obj" \
-	"$(INTDIR)\wrsl_p.obj" \
-	"$(INTDIR)\wrthed.obj" \
-	"$(INTDIR)\wrthedmrc.obj" \
-	"$(INTDIR)\wrtlin.obj" \
-	"$(INTDIR)\wrtlin8.obj" \
-	"$(INTDIR)\wrtseq8.obj" \
-	"$(INTDIR)\wtf.obj" \
-	"$(INTDIR)\wtm.obj"
-
-"$(OUTDIR)\spider.exe" : "$(OUTDIR)" $(DEF_FILE) $(LINK32_OBJS)
-    $(LINK32) @@<<
-  $(LINK32_FLAGS) $(LINK32_OBJS)
-<<
-
-.suffixes:.f .obj
-
-.f.obj:
-	@@fpp -PC -DSP_DISTRIB -DSP_UNIX -DSP_F90 -DSP_NT -D__osf__ $< > temp.f
-   	$(F90) $(F90_PROJ) /object $*.obj temp.f
-	@@copy temp.obj $*.obj > nul
-	@@erase temp.f
-
-@
-
-
-1.1
-log
-@Initial revision
-@
-text
-@@
-
diff --git src/Makefile_samples/RCS/Makefile_altix,v src/Makefile_samples/RCS/Makefile_altix,v
deleted file mode 100644
index 07b3f414..00000000
--- src/Makefile_samples/RCS/Makefile_altix,v
+++ /dev/null
@@ -1,215 +0,0 @@
-head	1.7;
-access;
-symbols
-	best-code:1.7
-	x-named-regs:1.7
-	x:1.7
-	v13-00:1.7
-	prec_CA:1.1;
-locks; strict;
-comment	@# @;
-
-
-1.7
-date	2005.06.28.15.41.38;	author leith;	state dead;
-branches;
-next	1.6;
-
-1.6
-date	2005.05.20.15.58.45;	author leith;	state Exp;
-branches;
-next	1.5;
-
-1.5
-date	2004.07.01.16.50.38;	author leith;	state Exp;
-branches;
-next	1.4;
-
-1.4
-date	2004.05.12.19.03.08;	author leith;	state Exp;
-branches;
-next	1.3;
-
-1.3
-date	2004.05.12.19.02.15;	author leith;	state Exp;
-branches;
-next	1.2;
-
-1.2
-date	2003.11.06.14.00.26;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	2003.05.07.13.30.29;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.7
-log
-@moved to Makefile_linux_mp_altix
-@
-text
-@# 
-#  MAKEFILE FOR SGI ALTIX SPIDER 
-# 
-#  PURPOSE: Creates 64 bit multi-processor SPIDER executable with FFTW for: SGI Altix 
-#           Output files have SGI native "byte order"
-#
-#  ArDean Leith -- 25 April 2003
-#
-#  NOTE:    You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
-#
-SHELL  = /bin/sh
-
-COMP   = /opt/intel_fc_80/bin/ifort   
-
-PGM    = spider
-
-FFLAGS = -ftz -assume byterecl -i4 -72 -convert big_endian -w90 -DSP_MP -openmp -cpp -DSP_IFC -DSP_LIBFFTW -DSP_LIBFFTWMP $(QFFLAGS) -c   
-
-# set location of fftw libraries and whether dynamic or static link
-#LF    =  -openmp -lifport  -L/net/bali/usr1/fftw-altix/lib/ $(QLFLAGS) 
-LF     =  -openmp -Bstatic -L/net/bali/usr1/fftw-altix/lib/ $(QLFLAGS) 
-
-# link with FFTW static libraries
-LINKLIBS = -Bstatic -lsfftw -lsrfftw -lsfftw_threads -lsrfftw_threads -Bdynamic -lm
- 
-EXE    = spider_linux_mpfftw_altix
-
-LIB    = $(EXE).a
- 
-AFLAGS = r
-
-.PRECIOUS :  $(LIB) ../bin/$(EXE)
-
-include Makefile.inc
-
-include Makebody.inc
-
-@
-
-
-1.6
-log
-@file name
-@
-text
-@@
-
-
-1.5
-log
-@update
-@
-text
-@d4 2
-a5 2
-#  PURPOSE: Creates 64 bit multi-proocessor SPIDER executable with FFTW for: SGI Altix 
-#           Output files have SGI "endedness"
-d21 1
-a21 1
-LF     =   -openmp -Bstatic -L/net/bali/usr1/fftw-altix/lib/ $(QLFLAGS) 
-d26 1
-a26 1
-EXE    = spider_altix
-@
-
-
-1.4
-log
-@*** empty log message ***
-@
-text
-@d2 1
-a2 1
-#  MAKEFILE FOR SGI ALTIX SPIDER -- Makefile
-d4 2
-a5 1
-#  ArDean Leith -- 25 April. 2004
-d7 1
-a7 1
-#  Creates 64 bit, multi-proocessor, FFTW SPIDER executable for use on: SGI Altix 
-d9 1
-a9 1
-# Note:    You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
-d17 1
-a17 1
-FFLAGS = -ftz -assume byterecl -Bdynamic -i4 -72 -convert big_endian -w90 -DSP_MP -openmp -cpp -DSP_IFC -DSP_LIBFFTW -DSP_LIBFFTWMP -DSP_LAPACK $(QFFLAGS) -c   
-d19 3
-a21 1
-LF     = -g -openmp -Bdynamic -lifport -L/usr/tmp/spider/fftw_altix/lib/ $(QLFLAGS) 
-d23 2
-a24 2
-# Link with shared FFTW libraries
-LINKLIBS = -lsfftw -lsrfftw -lsfftw_threads -lsrfftw_threads  -lm
-@
-
-
-1.3
-log
-@*** empty log message ***
-@
-text
-@d4 1
-a4 1
-#  ArDean Leith -- 25 April. 2003
-d6 1
-a6 2
-#  creates 64 bit multi-proocessor SPIDE executable for use on: SGI Altix 
-#  ---------    ----------------          ------------
-d16 1
-a16 3
-# removed -vms
-FFLAGS =  -ftz -assume byterecl -Bdynamic -i4 -72 -convert big_endian -w90 -DSP_MP -openmp -cpp -DSP_IFC -DSP_LIBFFTW -DSP_LIBFFTWMP   $(QFFLAGS) -c   
-#FFLAGS =  -g -assume byterecl -ftz -72 -w90 -cpp -DSP_IFC -DSP_LIBFFTW  $(QFFLAGS) -c   
-d18 1
-a18 2
-LF     = -g -openmp -Bdynamic -lifport -L/usr/tmp/spider/fftw_altix/local/lib/ $(QLFLAGS) 
-#LF     = -g -Vaxlib -L/usr/tmp/spider/fftw_altix/local/lib/ $(QLFLAGS) 
-d20 1
-a20 2
-#i# link with FFTW shared libraries
-#LINKLIBS = -lfftw -lm
-a21 1
-#LINKLIBS = -lsfftw -lsrfftw -lm
-@
-
-
-1.2
-log
-@-stack_temps
-@
-text
-@d13 1
-a13 1
-COMP   = efc   
-d17 3
-a19 1
-FFLAGS =  -zero -ftz -tpp2 -72 -vms -w90 -stack_temps -DSP_MP -openmp -cpp -Dosf_ieee -DSP_LINUX -DSP_IFC -O2  $(QFFLAGS) -c   
-d21 2
-a22 1
-LF     = -openmp -Vaxlib $(QLFLAGS) 
-d24 4
-a27 1
-LINKLIBS =  
-d29 1
-a29 1
-EXE    = spider
-@
-
-
-1.1
-log
-@Initial revision
-@
-text
-@d17 1
-a17 1
-FFLAGS =  -zero -ftz -tpp2 -72 -vms -w90 -DSP_MP -openmp -cpp -Dosf_ieee -DSP_LINUX -DSP_IFC -O2  $(QFFLAGS) -c   
-@
diff --git src/Makefile_samples/RCS/Makefile_dec,v src/Makefile_samples/RCS/Makefile_dec,v
deleted file mode 100644
index 355653e5..00000000
--- src/Makefile_samples/RCS/Makefile_dec,v
+++ /dev/null
@@ -1,551 +0,0 @@
-head	1.22;
-access;
-symbols
-	pre_fftwrings:1.21
-	pre_opfiles:1.21
-	src:1.21
-	best-code:1.21
-	x-named-regs:1.21
-	x:1.21
-	v13-00:1.21
-	pre_GPL:1.21
-	prec_CA:1.21
-	noindx:1.21
-	Bproc:1.21
-	oct21:1.15
-	last77:1.13;
-locks; strict;
-
-
-1.22
-date	2008.11.03.15.01.05;	author leith;	state dead;
-branches;
-next	1.21;
-
-1.21
-date	2000.05.25.12.37.53;	author leith;	state Exp;
-branches;
-next	1.20;
-
-1.20
-date	2000.05.24.15.15.50;	author leith;	state Exp;
-branches;
-next	1.19;
-
-1.19
-date	2000.04.25.14.22.22;	author leith;	state Exp;
-branches;
-next	1.18;
-
-1.18
-date	2000.04.24.20.36.19;	author leith;	state Exp;
-branches;
-next	1.17;
-
-1.17
-date	2000.04.18.20.31.20;	author leith;	state Exp;
-branches;
-next	1.16;
-
-1.16
-date	2000.02.24.19.10.20;	author leith;	state Exp;
-branches;
-next	1.15;
-
-1.15
-date	99.08.30.14.43.45;	author leith;	state Exp;
-branches;
-next	1.14;
-
-1.14
-date	99.03.30.18.22.04;	author leith;	state Exp;
-branches;
-next	1.13;
-
-1.13
-date	99.03.22.15.14.31;	author leith;	state Exp;
-branches;
-next	1.12;
-
-1.12
-date	99.03.19.15.39.44;	author leith;	state Exp;
-branches;
-next	1.11;
-
-1.11
-date	97.07.31.15.03.03;	author leith;	state Exp;
-branches;
-next	1.10;
-
-1.10
-date	97.07.11.19.04.40;	author leith;	state Exp;
-branches;
-next	1.9;
-
-1.9
-date	97.05.27.16.29.34;	author leith;	state Exp;
-branches;
-next	1.8;
-
-1.8
-date	97.05.27.15.36.17;	author leith;	state Exp;
-branches;
-next	1.7;
-
-1.7
-date	97.05.21.16.35.00;	author leith;	state Exp;
-branches;
-next	1.6;
-
-1.6
-date	96.11.22.19.42.20;	author leith;	state Exp;
-branches;
-next	1.5;
-
-1.5
-date	96.06.20.15.01.43;	author leith;	state Exp;
-branches;
-next	1.4;
-
-1.4
-date	96.06.19.19.39.45;	author leith;	state Exp;
-branches;
-next	1.3;
-
-1.3
-date	95.08.09.14.10.07;	author leith;	state Exp;
-branches;
-next	1.2;
-
-1.2
-date	95.01.25.14.38.20;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	95.01.25.11.36.08;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@used include file 
-@
-
-
-1.22
-log
-@obsolete
-@
-text
-@# 
-# ------ MAKEFILE FILE FOR DEC UNIX SPIDER -----------F90
-# 
-# Notes: 
-#
-#       Use cpp macro osf_ieee with compiler option "convert big_endian"
-#       to write in IEEE standard for portability to other unix
-#       machines (SGI, ...)
-#
-#       The commands for ELEMENTS are necessary, otherwise DEC-UNIX
-#       will not archive the object files in the library
-#
-#       To create  executable:   make -f Makefile_dec ../bin/spider_dec
-#       if you only type: make  , the make facility will compile 
-#       the source code but will not create the executable.
-#
-#
-# native mode on ALPHA/OSF1 (DEC Unix) machine
-FFLAGS = -automatic -c -fullwarn -cpp -col72 -O3
-
-PGM    = spider_dec
-
-LIB    = $(PGM).a
-
-SRC    = spider
-COMP   = f90
-
-.PRECIOUS :  ../bin/$(PGM) $(LIB) 
-
-include Makefile.inc
-
-../bin/$(PGM) : $(PGM).o $(LIB)
-	@@echo linking ../bin/$(PGM)
-	$(COMP) $(PGM).o $(LIB) -o ../bin/$(PGM)
-
-$(PGM).o  : $(SRC).f
-	$(COMP) $(FFLAGS) -o $(PGM).o  $(SRC).f 
-
-$(LIB) :  $(ELEMENTS)
-	@@echo all object files placed in library
-
-$(ELEMENTS) : 
-	$(COMP) $(FFLAGS) $<
-	$(AR) r $(LIB) $*.o
-	@@\rm $*.o
-@
-
-
-1.21
-log
-@O3
-@
-text
-@@
-
-
-1.20
-log
-@*** empty log message ***
-@
-text
-@d19 1
-a19 1
-FFLAGS = -automatic -c -fullwarn -cpp -col72 
-@
-
-
-1.19
-log
-@f90 flag removed for cpp
-@
-text
-@a3 2
-#  Mahieddine Ladjadj   1/25/95
-# 
-a17 5
-# To write floating point data in IEEE standard, use convert big_endian 
-# add cpp macro "osf_ieee" to write correct header (i.e flip alphanumerical)
-#FFLAGS = -automatic -c -fullwarn -cpp -col72 -convert big_endian -Dosf_ieee
-#PGM    = spider_decieee
-
-d25 3
-d34 1
-a34 1
-	f90 -g $(PGM).o $(LIB) -o ../bin/$(PGM)
-d36 2
-a37 2
-$(PGM).o  : spider.f
-	f90 $(FFLAGS) -o $(PGM).o  spider.f 
-d43 1
-a43 1
-	f90 $(FFLAGS) $<
-@
-
-
-1.18
-log
-@removd -DSP_F90
-@
-text
-@d22 1
-a22 1
-#FFLAGS = -automatic -DSP_F90 -c -fullwarn -cpp -col72 -convert big_endian -Dosf_ieee
-d25 1
-a25 1
-# native mode on ALPHA/OSF1 machine
-@
-
-
-1.17
-log
-@SP_UNIX cpp variable no longer needed.
-@
-text
-@d26 1
-a26 1
-FFLAGS = -automatic -DSP_F90 -c -fullwarn -cpp -col72 
-@
-
-
-1.16
-log
-@reversing  $(LIB) and $(PGM) in the makefile obviates make -f Makefile_dec
-@
-text
-@d12 1
-a12 1
-#       The commands for ELEMENTS are necessary, otherwise OSF-UNIX
-d22 1
-a22 1
-#FFLAGS = -automatic -DSP_F90 -DSP_UNIX -c -fullwarn -cpp -col72 -convert big_endian -Dosf_ieee
-d26 1
-a26 1
-FFLAGS = -automatic -DSP_F90 -DSP_UNIX -c -fullwarn -cpp -col72 
-@
-
-
-1.15
-log
-@ieee flags changed
-@
-text
-@d32 1
-a32 1
-.PRECIOUS :   $(LIB) ../bin/$(PGM)
-@
-
-
-1.14
-log
-@for f90
-@
-text
-@d22 1
-a22 1
-#FFLAGS = -DSP_UNIX  -c -fullwarn -cpp -col72 -convert big_endian -Dosf_ieee
-@
-
-
-1.13
-log
-@removed static
-@
-text
-@d2 1
-a2 1
-# ------ MAKEFILE FILE FOR DEC UNIX SPIDER -----------
-d20 1
-a20 1
-# To write the floating point data in IEEE standard, use convert big_endian 
-a24 1
-
-d26 1
-a26 1
-FFLAGS = -DSP_UNIX -c -fullwarn -cpp -col72 
-d38 1
-a38 1
-	f77 $(PGM).o $(LIB) -o ../bin/$(PGM)
-d41 1
-a41 1
-	f77 $(FFLAGS) -o $(PGM).o  spider.f 
-d47 1
-a47 1
-	f77 $(FFLAGS) $< 
-@
-
-
-1.12
-log
-@removed SP_ALLOC
-@
-text
-@d48 1
-a48 3
-	@@if \grep CNO_SAVE $< 1>/dev/null ; then \
-	echo "        f77 $(FFLAGS) $< ";f77 $(FFLAGS) $< ;  else \
-	echo "        f77 $(FFLAGS) -static $< ";f77 $(FFLAGS) -static $< ; fi
-@
-
-
-1.11
-log
-@rnamed osf --> dec
-@
-text
-@d27 1
-a27 1
-FFLAGS = -DSP_UNIX -DSP_ALLOC -c -fullwarn -cpp -col72 
-@
-
-
-1.10
-log
-@*** empty log message ***
-@
-text
-@d2 1
-a2 1
-# ------ MAKEFILE FILE FOR OSF UNIX SPIDER -----------
-d15 1
-a15 1
-#       To create  executable:   make -f Makefile_osf ../bin/spider_osf
-d23 1
-a23 1
-#PGM    = spider_osfieee
-d29 1
-a29 1
-PGM    = spider_osf
-@
-
-
-1.9
-log
-@*** empty log message ***
-@
-text
-@d15 1
-a15 1
-#       To create  executable::   make ../bin/spider_osf
-@
-
-
-1.8
-log
-@echos flags in use
-@
-text
-@d22 1
-a22 1
-#FFLAGS = -static -DSP_UNIX  -c -fullwarn -cpp -col72 -convert big_endian -Dosf_ieee
-d27 1
-a27 1
-FFLAGS = -static -DSP_UNIX -DSP_ALLOC -c -fullwarn -cpp -col72 
-d39 1
-a39 1
-        f77 $(PGM).o $(LIB) -o ../bin/$(PGM)
-@
-
-
-1.7
-log
-@*** empty log message ***
-@
-text
-@a5 1
-# 
-d8 1
-a8 1
-#       use cpp macro osf_ieee with compiler option "convert big_endian"
-d12 1
-a12 1
-#       the commands for ELEMENTS are necessary, otherwise OSF-UNIX
-d15 1
-a15 1
-#       to create  executable::   make ../bin/spider_osf
-d20 1
-a20 1
-# to write the floating point data in IEEE standard, use convert big_endian 
-d49 2
-a50 2
-	f77 $(FFLAGS)  $< ; echo "       compiled non-static" $< ; else \
-	f77 $(FFLAGS) -static  $< ; echo "        compiled" $<; fi
-@
-
-
-1.6
-log
-@*** empty log message ***
-@
-text
-@d16 1
-a16 1
-#       to create  executable::   make spider_osf
-@
-
-
-1.5
-log
-@updated
-@
-text
-@d34 1
-a34 1
-.PRECIOUS :   $(LIB) $(PGM)
-d38 3
-a40 3
-$(PGM) : $(PGM).o $(LIB)
-	@@echo linking $(PGM)
-	f77 $(PGM).o $(LIB) -o spider
-d46 1
-a46 1
-	@@echo library filled
-@
-
-
-1.4
-log
-@changed output name to _osf
-@
-text
-@d16 2
-a17 2
-#       to create  executable::   make spider
-#       if you only type:: make  , the make facility will compile 
-a46 5
-
-#$(ELEMENTS) :  
-#	f77 $(FFLAGS) $(?:.o=.f)
-#	$(AR) rv $(LIB) $@@
-#	\rm $@@
-@
-
-
-1.3
-log
-@sp_alloc
-@
-text
-@d24 1
-a27 1
-
-d30 1
-a30 1
-PGM    = spider
-d37 1
-a37 1
- 
-d41 1
-a41 1
-  
-d44 1
-a44 1
-  
-d46 13
-a58 8
-  
-$(ELEMENTS) :  
-	f77 $(FFLAGS) $(?:.o=.f)
-	$(AR) rv $(LIB) $@@
-	\rm $@@
-  
-  
- 
-@
-
-
-1.2
-log
-@fixed with flag explanation
-@
-text
-@d28 1
-a28 1
-FFLAGS = -static -DSP_UNIX -c -fullwarn -cpp -col72 
-@
-
-
-1.1
-log
-@Initial revision
-@
-text
-@d4 1
-a4 1
-#  ArDean Leith -- 11 MAY 1994 
-d7 17
-a23 3
-# ------ REDEFINE SOME OF THE BUILT-IN RULES AND MACROS ------
- 
-FFLAGS = -static -DSP_UNIX -c -cpp -col72 -convert big_endian Dosf_ieee     
-a24 1
-PGM    = spiderosf
-d26 6
-d33 4
-d38 1
-a38 5
-.PRECIOUS :   $(LIB) ../bin/$(PGM)
- 
-include Makefile.inc
-  
-../bin/$(PGM) : $(PGM).o $(LIB)
-d40 1
-a40 3
-	f77 $(LF) $(PGM).o $(LIB) -o ../bin/$(PGM)_temp
-	\cp ../bin/$(PGM) ../bin/`Nextversion ../bin/$(PGM)`
-	\mv ../bin/$(PGM)_temp $@@
-d48 1
-a48 1
-	f77 $(FFLAGS) $(?:.o=.c)
-d53 1
-@
diff --git src/Makefile_samples/RCS/Makefile_decd,v src/Makefile_samples/RCS/Makefile_decd,v
deleted file mode 100755
index 73d66409..00000000
--- src/Makefile_samples/RCS/Makefile_decd,v
+++ /dev/null
@@ -1,84 +0,0 @@
-head	1.2;
-access;
-symbols
-	best-code:1.1
-	x-named-regs:1.1
-	x:1.1
-	v13-00:1.1
-	pre_GPL:1.1
-	prec_CA:1.1
-	noindx:1.1
-	Bproc:1.1;
-locks; strict;
-comment	@# @;
-
-
-1.2
-date	2006.07.31.15.24.48;	author leith;	state dead;
-branches;
-next	1.1;
-
-1.1
-date	2000.06.30.18.17.25;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.2
-log
-@obsolete
-@
-text
-@# 
-# ------ MAKEFILE FILE FOR DEC UNIX SPIDER -----------
-# 
-# Notes: 
-#
-#       The commands for ELEMENTS are necessary, otherwise OSF-UNIX
-#       will not archive the object files in the library
-#
-#       To create  executable:   make -f Makefile_decd ../bin/spider_decd
-#       if you only type: make  , the make facility will compile 
-#       the source code but will not create the executable.
-#
-#
-# native mode on ALPHA/OSF1 machine
-FFLAGS = -g -automatic  -DSP_UNIX -c -fullwarn -cpp -col72 
-LFLAGS = -g
-
-PGM    = spider_decd
-
-LIB    = $(PGM).a
-
-.PRECIOUS :   $(LIB) ../bin/$(PGM)
-
-include Makefile.inc
-
-../bin/$(PGM) : $(PGM).o $(LIB)
-	@@echo linking ../bin/$(PGM) /* debug */
-	f90 $(LFLAGS) $(PGM).o $(LIB) -o ../bin/$(PGM)
-
-$(PGM).o  : spider.f
-	f90 $(FFLAGS) -o $(PGM).o  spider.f 
-
-$(LIB) :  $(ELEMENTS)
-	@@echo all object files placed in library
-
-$(ELEMENTS) : 
-	f90 $(FFLAGS) $<
-	$(AR) r $(LIB) $*.o
-	@@\rm $*.o
-@
-
-
-1.1
-log
-@Initial revision
-@
-text
-@@
-
diff --git src/Makefile_samples/RCS/Makefile_decfftw,v src/Makefile_samples/RCS/Makefile_decfftw,v
deleted file mode 100755
index c6127cfc..00000000
--- src/Makefile_samples/RCS/Makefile_decfftw,v
+++ /dev/null
@@ -1,107 +0,0 @@
-head	1.3;
-access;
-symbols
-	pre_fftwrings:1.2
-	pre_opfiles:1.2
-	src:1.2
-	best-code:1.2
-	x-named-regs:1.2
-	x:1.2
-	v13-00:1.2
-	pre_GPL:1.2
-	prec_CA:1.2
-	noindx:1.2
-	Bproc:1.2;
-locks; strict;
-comment	@# @;
-
-
-1.3
-date	2008.11.03.15.01.17;	author leith;	state dead;
-branches;
-next	1.2;
-
-1.2
-date	2000.05.25.15.17.02;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	2000.05.24.15.29.22;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.3
-log
-@obsolete
-@
-text
-@# 
-# ------ MAKEFILE FILE FOR DEC UNIX SPIDER with FFTW 
-# 
-# Notes: 
-#
-#       Use cpp macro osf_ieee with compiler option "convert big_endian"
-#       to write in IEEE standard for portability to other unix
-#       machines (SGI, ...)
-#
-#       The commands for ELEMENTS are necessary, otherwise DEC-UNIX
-#       will not archive the object files in the library
-#
-#       To create  executable:   make -f Makefile_decfftw ../bin/spider_decfftw
-#       if you only type: make  , the make facility will compile 
-#       the source code but will not create the executable.
-#
-#
-# native mode on ALPHA True 64 Unix machine
-
-FFLAGS   = -automatic -c -fullwarn -cpp -col72 
-PGM      = spider_decfftw
-SRC      = spider
-LIB      = $(PGM).a
-LINKLIBS = librfftw_threads_dec.a libfftw_threads_dec.a librfftw_dec.a libfftw_dec.a -lm
-COMP     = f90
-
-.PRECIOUS :  ../bin/$(PGM) $(LIB) 
-
-include Makefile.inc
-
-../bin/$(PGM) : $(PGM).o $(LIB)
-	@@echo linking ../bin/$(PGM)
-	$(COMP) $(PGM).o $(LIB) $(LINKLIBS) -o ../bin/$(PGM)
-
-$(PGM).o  : $(SRC).f
-	$(COMP) $(FFLAGS) -o $(PGM).o  $(SRC).f 
-
-$(LIB) :  $(ELEMENTS)
-	@@echo all object files placed in library
-
-$(ELEMENTS) : 
-	$(COMP) $(FFLAGS) $<
-	$(AR) r $(LIB) $*.o
-	@@\rm $*.o
-@
-
-
-1.2
-log
-@_dec on libfftw
-@
-text
-@@
-
-
-1.1
-log
-@Initial revision
-@
-text
-@d24 1
-a24 1
-LINKLIBS = librfftw_threads.a libfftw_threads.a librfftw.a libfftw.a -lm
-@
diff --git src/Makefile_samples/RCS/Makefile_decieee,v src/Makefile_samples/RCS/Makefile_decieee,v
deleted file mode 100755
index cd122e60..00000000
--- src/Makefile_samples/RCS/Makefile_decieee,v
+++ /dev/null
@@ -1,137 +0,0 @@
-head	1.4;
-access;
-symbols
-	pre_fftwrings:1.3
-	pre_opfiles:1.3
-	src:1.3
-	best-code:1.3
-	x-named-regs:1.3
-	x:1.3
-	v13-00:1.3
-	pre_GPL:1.3
-	prec_CA:1.3
-	noindx:1.3
-	Bproc:1.3;
-locks; strict;
-comment	@# @;
-
-
-1.4
-date	2008.11.03.15.01.29;	author leith;	state dead;
-branches;
-next	1.3;
-
-1.3
-date	2000.05.24.15.18.40;	author leith;	state Exp;
-branches;
-next	1.2;
-
-1.2
-date	2000.04.24.20.36.23;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	2000.04.18.20.31.36;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@SP_UNIX cpp variable no longer needed.
-@
-
-
-1.4
-log
-@obsolete
-@
-text
-@# 
-# ------ MAKEFILE FILE FOR DEC UNIX SPIDER -----------F90
-# 
-# Notes: 
-#
-#       Use cpp macro osf_ieee with compiler option "convert big_endian"
-#       to write in IEEE standard for portability to other unix
-#       machines (SGI, ...)
-#
-#       The commands for ELEMENTS are necessary, otherwise OSF-UNIX
-#       will not archive the object files in the library
-#
-#       To create  executable:   make -f Makefile_decieee ../bin/spider_decieee
-#       if you only type: make  , the make facility will compile 
-#       the source code but will not create the executable.
-#
-# To write floating point data in IEEE standard, use convert big_endian 
-# add cpp macro "osf_ieee" to write correct header (i.e flip alphanumerical)
-
-
-FFLAGS = -automatic -c -fullwarn -cpp -col72 -convert big_endian -Dosf_ieee
-
-PGM    = spider_decieee
-
-LIB    = $(PGM).a
-COMP   = f90
-SRC    = spider
-
-.PRECIOUS :   $(LIB) ../bin/$(PGM)
-
-include Makefile.inc
-
-../bin/$(PGM) : $(PGM).o $(LIB)
-	@@echo linking ../bin/$(PGM)
-	$(COMP) $(PGM).o $(LIB) -o ../bin/$(PGM)
-
-$(PGM).o  : $(SRC).f
-	$(COMP) $(FFLAGS) -o $(PGM).o  $(SRC).f 
-
-$(LIB) :  $(ELEMENTS)
-	@@echo all object files placed in library
-
-$(ELEMENTS) : 
-	$(COMP) $(FFLAGS) $<
-	$(AR) r $(LIB) $*.o
-	@@\rm $*.o
-@
-
-
-1.3
-log
-@*** empty log message ***
-@
-text
-@@
-
-
-1.2
-log
-@removd -DSP_F90
-@
-text
-@a3 2
-#  Mahieddine Ladjadj   1/25/95
-# 
-d26 2
-d35 1
-a35 1
-	f90 -g $(PGM).o $(LIB) -o ../bin/$(PGM)
-d37 2
-a38 2
-$(PGM).o  : spider.f
-	f90 $(FFLAGS) -o $(PGM).o  spider.f 
-d44 1
-a44 1
-	f90 $(FFLAGS) $<
-@
-
-
-1.1
-log
-@Initial revision
-@
-text
-@d23 1
-a23 1
-FFLAGS = -automatic -DSP_F90 -DSP_UNIX -c -fullwarn -cpp -col72 -convert big_endian -Dosf_ieee
-@
diff --git src/Makefile_samples/RCS/Makefile_ibm,v src/Makefile_samples/RCS/Makefile_ibm,v
deleted file mode 100755
index db260312..00000000
--- src/Makefile_samples/RCS/Makefile_ibm,v
+++ /dev/null
@@ -1,115 +0,0 @@
-head	1.3;
-access;
-symbols
-	pre_fftwrings:1.3
-	pre_opfiles:1.3
-	src:1.3
-	best-code:1.3
-	x-named-regs:1.3
-	x:1.3
-	v13-00:1.3
-	pre_GPL:1.3
-	prec_CA:1.3
-	noindx:1.3;
-locks; strict;
-comment	@# @;
-
-
-1.3
-date	2000.11.16.16.01.03;	author leith;	state Exp;
-branches;
-next	1.2;
-
-1.2
-date	2000.11.15.14.23.18;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	2000.11.09.20.12.54;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.3
-log
-@*** empty log message ***
-@
-text
-@# 
-#  MAKEFILE FOR IBM SPIDER (USING FFTW FOR FOURIERS)-- Makefile_ibmfftw
-# 
-#  ArDean Leith -- 5 Nov. 2000
-#
-# native mode on IBM SP machine with fftw (no parallel)
-#
-# 
-SHELL    = /bin/sh
-FFLAGS   = -qnosave -qfixed=72 -O3 -qarch=auto -qstrict -qtune=auto -c    
-
-LFLAGS   = -qarch=auto -bmaxdata:1000000000 -qnosave
-CPPFLAGS = -DSP_IBMSP3 -DSP_LIBFFTW
-COMP     = xlf90
-CPP      = /usr/ccs/lib/cpp
-
-PGM      = spider_ibmfftw
-LIB      = $(PGM).a
-SRC      = spider
-
-LINKLIBS = librfftw_threads.a libfftw_threads.a librfftw.a libfftw.a -lm
-
-ARFLAGS  = r
-
-.PRECIOUS :   $(LIB) ../bin/$(PGM)
- 
-include Makefile.inc
- 
-../bin/$(PGM) : $(PGM).o $(LIB)
-	@@echo linking ../bin/$(PGM)
-	$(COMP) $(LFLAGS) $(PGM).o $(LIB) $(LINKLIBS) -lc -o ../bin/$(PGM)
-
-$(PGM).o  : $(SRC).f
-	$(CPP)  $(CPPFLAGS) $(SRC).f $(SRC).F 
-	$(COMP) $(FFLAGS) -o $(PGM).o  $(SRC).F 
-
-$(LIB) :  $(ELEMENTS)
-	@@echo all object files placed in library
-
-$(ELEMENTS) : 
-	$(CPP) $(CPPFLAGS) $*.f $*.F 
-	$(COMP) $(FFLAGS) $*.F
-	$(AR) $(ARFLAGS) $(LIB) $*.o
-	@@\rm $*.o $*.F
- 
-@
-
-
-1.2
-log
-@*** empty log message ***
-@
-text
-@d10 2
-a11 1
-FFLAGS   = -qarch=auto -qfixed=72 -qnosave -c    
-@
-
-
-1.1
-log
-@Initial revision
-@
-text
-@d6 1
-a6 1
-# native mode on IBM SP machine with no parallel stuff
-a7 1
-# Note:    You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
-d10 1
-a10 1
-FFLAGS   = -qarch=auto -bmaxdata:1000000000 -qfixed=72 -qnosave -c    
-@
diff --git src/Makefile_samples/RCS/Makefile_ibm_mpi,v src/Makefile_samples/RCS/Makefile_ibm_mpi,v
deleted file mode 100644
index a66c627c..00000000
--- src/Makefile_samples/RCS/Makefile_ibm_mpi,v
+++ /dev/null
@@ -1,132 +0,0 @@
-head	1.2;
-access;
-symbols
-	pre_fftwrings:1.2
-	pre_opfiles:1.1
-	src:1.1
-	best-code:1.1
-	x-named-regs:1.1
-	x:1.1
-	v13-00:1.1
-	pre_GPL:1.1
-	prec_CA:1.1;
-locks; strict;
-comment	@# @;
-
-
-1.2
-date	2008.01.08.14.46.40;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	2003.09.24.17.17.28;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.2
-log
-@*** empty log message ***
-@
-text
-@# 
-# ------ MAKEFILE FILE FOR IBM Blue Gene Linux SPIDER WITH MPI -----------
-#        ArDean Leith   Sept. 2007
-#
-# Notes: 
-#   The commands for ELEMENTS may be necessary
-#   To create  executable:  make -f Makefile_linux_fftw_bg ../bin/spider_linux_fftw_bg
-#   May be necessary to remove all: *.F before starting compilation
-#
-# O2                  : optimization level
-# qstrict             : follow program semantics when optimizing
-# qipa                : inter procedural analysis
-# qfixed=72           : fixed line length
-# qarch=440           : target machine
-# qtune=440           : target machine
-#
-# Note: To have text of FORTRAN error messages displayed, specify  
-#       -env "NLSPATH=$NLSPATH" on your mpirun command  line.  
-
-FFLAGS   =  -O2 -qstrict -qarch=440d -qstrict -qipa -qtune=440 -qfixed=72 -qnosave -c    
-LFLAGS   =  -O2 -qarch=440d -qnosave
-
-CPPFLAGS = -DSP_IBMSP3 -DUSE_MPI -DMPI_DEBUG -DSP_LIBFFTW
-
-# F90 compiler location: /opt/ibmcmp/xlf/bg/10.1/bin/blrts_xlf
-COMP   = mpixlf90
-CPP    = /opt/ibmcmp/xlf/bg/10.1/exe/cpp
-
-PGM    = spider_linux_fftw_bg
-LIB    = $(PGM).a
-SRC    = spider
-
-# FFTW library location 
-FFTWLIBDIR = ../fftw/fftw-bg/lib 
-LINKLIBS   = -L $(FFTWLIBDIR) -lsrfftw -lsfftw
-
-.PRECIOUS : $(LIB) ../bin/$(PGM)
-
-include Makefile.inc
-
-../bin/$(PGM) : $(PGM).o $(LIB)
-	@@echo linking ../bin/$(PGM)
-	$(COMP) $(LFLAGS) $(PGM).o $(LIB) $(LINKLIBS) -lc -o ../bin/$(PGM)
-
-$(PGM).o  : $(SRC).f
-	$(CPP)  $(CPPFLAGS) $(SRC).f $(SRC).F 
-	$(COMP) $(FFLAGS) -o $(PGM).o  $(SRC).F 
-	@@\rm $(SRC).F
-
-$(LIB) :  $(ELEMENTS)
-	@@echo all object files placed in library
-
-$(ELEMENTS) : 
-	$(CPP) $(CPPFLAGS) $*.f $*.F 
-	$(COMP) $(FFLAGS) $*.F
-	$(AR) r $(LIB) $*.o
-	@@\rm $*.o $*.F
-@
-
-
-1.1
-log
-@Initial revision
-@
-text
-@d2 3
-a4 2
-# ------ MAKEFILE FILE FOR IBM SP UNIX SPIDER WITH MPI -----------F90
-# 
-d6 3
-d10 6
-a15 1
-#       The commands for ELEMENTS may be necessary
-d17 11
-a27 9
-#       To create  executable:   make -f Makefile_ibm ../bin/spider_ibm
-#
-#
-# native mode on IBM SP machine with no parallel stuff
-FFLAGS   =  -O3 -qarch=pwr3 -qstrict -qipa -qtune=pwr3 -bmaxdata:1000000000 -qfixed=72 -qnosave -c    
-LFLAGS   =  -O3 -qarch=pwr3 -bmaxdata:1000000000 -qnosave
-CPPFLAGS = -DSP_IBMSP3 -DUSE_MPI -DMPI_DEBUG
-COMP     = mpxlf90
-CPP      = /usr/ccs/lib/cpp
-d29 1
-a29 1
-PGM    = spider_mpi
-d33 5
-a37 1
-.PRECIOUS :   $(LIB) ../bin/$(PGM)
-d43 1
-a43 1
-	$(COMP) $(LFLAGS) $(PGM).o $(LIB) -lc -o ../bin/$(PGM)
-d48 1
-@
-
diff --git src/Makefile_samples/RCS/Makefile_ibmmp,v src/Makefile_samples/RCS/Makefile_ibmmp,v
deleted file mode 100755
index 4946b1f8..00000000
--- src/Makefile_samples/RCS/Makefile_ibmmp,v
+++ /dev/null
@@ -1,129 +0,0 @@
-head	1.3;
-access;
-symbols
-	pre_fftwrings:1.3
-	pre_opfiles:1.3
-	src:1.3
-	best-code:1.3
-	x-named-regs:1.3
-	x:1.3
-	v13-00:1.3
-	pre_GPL:1.3
-	prec_CA:1.3
-	noindx:1.3;
-locks; strict;
-comment	@# @;
-
-
-1.3
-date	2000.11.16.16.01.03;	author leith;	state Exp;
-branches;
-next	1.2;
-
-1.2
-date	2000.11.14.16.29.57;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	2000.11.09.20.13.12;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.3
-log
-@*** empty log message ***
-@
-text
-@# 
-#  MAKEFILE FOR IBM SPIDER (USING FFTW & OMP)-- Makefile_ibmmpfftw
-# 
-#  ArDean Leith -- 5 Nov. 2000
-#
-#  To create executable:   make -f Makefile_ibmmpfftw
-#
-# native mode on IBM SP machine with OMP parallel stuff and FFTW
-#
-SHELL    = /bin/sh
-CPP      = /usr/ccs/lib/cpp
-CPPFLAGS = -DSP_IBMSP3 -DSP_MP -DSP_LIBFFTW -DSP_LIBFFTWMP
-
-COMP     = xlf90_r
-FFLAGS   = -qnosave -qsmp=omp -qfixed=72 -O3 -qarch=auto -qstrict -qtune=auto -c    
-
-LFLAGS   = -qarch=auto -bmaxdata:1000000000 -qnosave -qsmp=omp
-LINKLIBS = librfftw_threads.a libfftw_threads.a librfftw.a libfftw.a -lm
-
-PGM      = spider_ibmmpfftw
-LIB      = $(PGM).a
-SRC      = spider
-
-ARFLAGS  = r
-
-.PRECIOUS :   $(LIB) ../bin/$(PGM)
- 
-include Makefile.inc
- 
-../bin/$(PGM) : $(PGM).o $(LIB)
-	@@echo linking ../bin/$(PGM)
-	$(COMP) $(LFLAGS) $(PGM).o $(LIB) $(LINKLIBS) -lc -o ../bin/$(PGM)
-
-$(PGM).o  : $(SRC).f
-	$(CPP)  $(CPPFLAGS) $(SRC).f $(SRC).F 
-	$(COMP) $(FFLAGS) -o $(PGM).o  $(SRC).F 
-
-$(LIB) :  $(ELEMENTS)
-	@@echo all object files placed in library
-
-$(ELEMENTS) : 
-	$(CPP) $(CPPFLAGS) $*.f $*.F 
-	$(COMP) $(FFLAGS) $*.F
-	$(AR) $(ARFLAGS) $(LIB) $*.o
-	@@\rm $*.o $*.F
- 
-@
-
-
-1.2
-log
-@*** empty log message ***
-@
-text
-@d15 1
-a15 1
-FFLAGS   = -qarch=auto -bmaxdata:1000000000 -qnosave -qsmp=omp -qfixed=72  -c    
-@
-
-
-1.1
-log
-@Initial revision
-@
-text
-@d2 1
-a2 1
-#  MAKEFILE FOR IBM SPIDER (USING FFTW FOR FOURIERS)-- Makefile_ibmmpfftw
-d6 1
-a6 1
-# native mode on IBM SP machine with OMP parallel stuff
-d8 2
-a9 2
-# Note:    You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
-# 
-d11 6
-a16 1
-FFLAGS   = -qarch=auto -bmaxdata:1000000000 -qfixed=72 -qnosave -c    
-d18 1
-a18 3
-CPPFLAGS = -DSP_IBMSP3 -DSP_LIBFFTW -DSP_MP -DSP_IBMSP3
-COMP     = xlf90_r
-CPP      = /usr/ccs/lib/cpp
-a22 2
-
-LINKLIBS = librfftw_threads.a libfftw_threads.a librfftw.a libfftw.a -lm
-@
diff --git src/Makefile_samples/RCS/Makefile_linux,v src/Makefile_samples/RCS/Makefile_linux,v
deleted file mode 100755
index 8c16dfab..00000000
--- src/Makefile_samples/RCS/Makefile_linux,v
+++ /dev/null
@@ -1,667 +0,0 @@
-head	1.22;
-access;
-symbols
-	pre_fftwrings:1.14
-	pre_opfiles:1.12
-	src:1.12
-	best-code:1.9
-	x-named-regs:1.9
-	x:1.9
-	v13-00:1.9
-	pre_GPL:1.8
-	prec_CA:1.8
-	noindx:1.2;
-locks
-	leith:1.22; strict;
-comment	@# @;
-
-
-1.22
-date	2011.05.11.12.09.31;	author leith;	state Exp;
-branches;
-next	1.21;
-
-1.21
-date	2011.03.03.18.39.38;	author leith;	state Exp;
-branches;
-next	1.20;
-
-1.20
-date	2010.07.14.15.31.53;	author leith;	state Exp;
-branches;
-next	1.19;
-
-1.19
-date	2009.11.30.16.06.52;	author leith;	state Exp;
-branches;
-next	1.18;
-
-1.18
-date	2009.02.25.16.29.41;	author leith;	state Exp;
-branches;
-next	1.17;
-
-1.17
-date	2008.11.03.17.42.01;	author leith;	state Exp;
-branches;
-next	1.16;
-
-1.16
-date	2008.11.03.16.55.04;	author leith;	state Exp;
-branches;
-next	1.15;
-
-1.15
-date	2008.09.17.14.12.34;	author leith;	state Exp;
-branches;
-next	1.14;
-
-1.14
-date	2007.12.14.13.23.38;	author leith;	state Exp;
-branches;
-next	1.13;
-
-1.13
-date	2007.03.12.17.53.55;	author leith;	state Exp;
-branches;
-next	1.12;
-
-1.12
-date	2006.08.03.20.21.54;	author leith;	state Exp;
-branches;
-next	1.11;
-
-1.11
-date	2006.07.31.15.25.44;	author leith;	state dead;
-branches;
-next	1.10;
-
-1.10
-date	2006.07.26.17.46.48;	author leith;	state Exp;
-branches;
-next	1.9;
-
-1.9
-date	2005.10.19.19.19.14;	author leith;	state Exp;
-branches;
-next	1.8;
-
-1.8
-date	2003.03.25.15.03.19;	author leith;	state Exp;
-branches;
-next	1.7;
-
-1.7
-date	2003.02.20.14.22.40;	author leith;	state Exp;
-branches;
-next	1.6;
-
-1.6
-date	2003.02.13.18.53.47;	author leith;	state Exp;
-branches;
-next	1.5;
-
-1.5
-date	2003.02.13.15.55.40;	author leith;	state Exp;
-branches;
-next	1.4;
-
-1.4
-date	2003.02.03.18.47.58;	author leith;	state Exp;
-branches;
-next	1.3;
-
-1.3
-date	2003.01.28.21.17.33;	author leith;	state Exp;
-branches;
-next	1.2;
-
-1.2
-date	2002.06.05.20.40.53;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	2002.04.17.14.19.02;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.22
-log
-@-DHAS_IEEE
-@
-text
-@# 
-# PURPOSE:  MAKEFILE FOR GNU/Linux SPIDER using FFTW3 on single Intel 32 bit processor 
-#
-# USING:    Portland Group F90 compiler
-# TARGET:   Intel IA32 (i386) running GNU/Linux (SHOULD RUN ON MOST LINUX PC's)
-# IMAGES:   Optimal SPIDER image byte order:   Big-endian (SGI) (Non-native) 
-# USAGE:    To create executable: make -f Makefile_linux
-#
-# NOTE:     Uses FFTW3 configured with: --enable-float --enable-openmp
-# NOTE:     You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
-#
-# PGI Compile/link flags
-# -O2             : Invokes level 2 optimization (-O3 causes some run time problems with PGI compiler on SPIDER code)
-# -Kieee          : Invokes strict IEEE floating calculations
-# -mp             : Invokes multi processor support
-# -tp p6          : Targets 32 bit Pentium Pro/II/III with 32 bit memory addresses, supports x87 FP
-# -tp p7          : Targets 32 or 64 bit Pentium4 with 32 bit memory addresses, supports SSE1 & SSE2 FP
-# -tp p7-64       : Targets 64 bit Pentium4 with 64 bit memory addresses, supports SSE1, SSE2 & SSE3 FP
-# -tp x64         : Targets unified 64 bit AMD & Intel binaries (samoa)
-# -tp k8-64e      : Targets AMD Opteron Revision E or AMD Turion (cluster)
-# -Mipa=fast      : Invokes interprocedural analysis 
-# -fast           : Selects appropriate set of flags usually including -O2 -Munroll -Mnoframe
-# -fastsse        : Selects appropriate set of flags including SSE support and usually -O2 -Munroll -Mnoframe -Mvect=sse -Mcache_align 
-# -pc 64          : Sets precision of FPU operations
-# -mcmodel=medium : Allows use of >2GB data area 
-# -Bstatic_pgi    : Uses static PGI libs but makes dynamic executable
-# -Bstatic        : Static link 
-
-SHELL    = /bin/sh
-
-AFLAGS   = r
-
-# Location of PGI Fortran compiler
-#COMP    = /usr10/pgi/linux86-64/8.0-4/bin/pgf95
- COMP    = /usr10/pgi/linux86-64/2011/bin/pgf95
-
-PGM      = spider
-
-EXE      = $(PGM)_linux
-
-LIB      = $(EXE).a
-
-FFLAGS   = -Bstatic -tp p6 -fast -O2 -Mpreprocess -Kieee -Minfo -byteswapio -DHAS_IEEE -DSP_LIBFFTW3 -c  
-
-LF       = -Bstatic -tp p6 $(QLFLAGS)
-
-# Static link with static FFTW3 libraries and math library
-FFTWLIBDIR = ../fftw/fftw3-32/lib
-LINKLIBS = -Bstatic -L$(FFTWLIBDIR) -lfftw3f -lm
-
-.PRECIOUS : ../bin/$(EXE) $(LIB) 
-
-include Makefile.inc
-
-include Makebody.inc
-
-@
-
-
-1.21
-log
-@*** empty log message ***
-@
-text
-@d43 1
-a43 1
-FFLAGS   = -Bstatic -tp p6 -fast -O2 -Mpreprocess -Kieee -Minfo -byteswapio -DSP_LIBFFTW3 -c  
-@
-
-
-1.20
-log
-@cosmetic
-@
-text
-@d7 1
-d11 17
-a27 1
-# NOTE:     To create executable: make -f Makefile_linux
-d31 1
-a31 1
-PGM      = spider
-d34 4
-a37 1
-COMP     = /usr10/pgi/linux86-64/8.0-4/bin/pgf95
-d41 3
-a43 7
-# -O2          : Invokes level 2 optimization (-O3 causes some run time problems with PGI compiler on SPIDER code)
-# -mp          : Invokes multi processor support
-# -tp p6       : Targets 32 bit Pentium Pro/II/III with 32 bit memory addresses, supports x87 FP
-# -tp p7       : Targets 32 or 64 bit Pentium4 with 32 bit memory addresses, supports SSE1 & SSE2 FP
-# -Mipa=fast   : Invokes interprocedural analysis (some routines may fail to compile?)
-# -fast        : Selects an appropriate set of optimization flags usually including -O2 -Munroll -Mnoframe
-# -fastsse     : Selects an appropriate set of flags including SSE support usually including -O2 -Munroll -Mnoframe -Mvect=sse -Mcache_align 
-d45 1
-a45 1
-FFLAGS   = -O2 -Mpreprocess -tp p6 -fast -Kieee -Minfo -byteswapio -DSP_LIBFFTW3 -c  
-d47 1
-a47 1
-# 32 bit FFTW3 library location
-a48 8
-
-LF         = -tp p6 $(QLFLAGS)
-
-LIB        = $(EXE).a
-
-AFLAGS     = r
-
-# Static link with static FFTW3 libraries  and math library
-@
-
-
-1.19
-log
-@removed osf_ieee
-@
-text
-@d2 1
-a2 1
-# ------    MAKEFILE FOR GNU/Linux SPIDER using FFTW3 on single Intel 32 bit processor 
-d8 1
-a8 3
-# NOTE:     Uses FFTW3 
-#           FFTW3 must be configured with: --enable-float --enable-type-prefix
-#
-d10 1
-a10 2
-#
-# NOTE:     To create executable: make -f Makefile_linux 
-d16 2
-a17 3
-#COMP    = /usr/pgi7.2/linux86-64/7.2-5/bin/pgf95
-#COMP    = /scratch/pgi/linux86-64/8.0-4/bin/pgf95
-COMP     = pgf95
-d31 1
-a31 1
-# FFTW library location
-d40 2
-a41 2
-# Static link with FFTW libraries, liblf (supports > 2GB files), and math library
-LINKLIBS = -Bstatic -L/usr/pgi7.2/linux86/7.2-5/liblf -L$(FFTWLIBDIR) -lfftw3f -lm
-@
-
-
-1.18
-log
-@COMP
-@
-text
-@d33 1
-a33 1
-FFLAGS   = -O2 -Mpreprocess -tp p6 -fast -Kieee -Minfo -byteswapio -Dosf_ieee -DSP_LIBFFTW3 -c  
-@
-
-
-1.17
-log
-@*** empty log message ***
-@
-text
-@d19 3
-a21 1
-COMP     = /usr/pgi7.2/linux86-64/7.2-5/bin/pgf95
-@
-
-
-1.16
-log
-@*** empty log message ***
-@
-text
-@a18 3
-WHICH    = 
-
-#COMP    = /usr/pgi/linux86-64/7.1/bin/pgf95
-d21 1
-a21 1
-EXE      = $(PGM)_linux_$(WHICH)$(SUFFIX)
-a42 1
-#LINKLIBS = -Bstatic -L/usr/pgi/linux86/7.1-2/liblf    -L$(FFTWLIBDIR) -lfftw3f -lm
-@
-
-
-1.15
-log
-@/usr/pgi7.2
-@
-text
-@d2 1
-a2 2
-# MAKEFILE FOR GNU/Linux SPIDER using FFTW on single processor --
-#        Non-native mode byte ordering on AMD/Intel IA32  
-d4 3
-a6 3
-# Using: Portland Group F90 compiler
-#        Non-native mode byte ordering on Intel IA32 GNU/Linux SHOULD RUN ON MOST LINUX PC's
-#        FFTW3 must be configured with: --enable-float --enable-type-prefix
-d8 2
-a9 1
-# Note:  You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
-d11 3
-a13 1
-# Note:  To create executable: make -f Makefile_linux_fftw 
-d19 1
-a19 1
-WHICH    = fftw
-d21 1
-a21 1
-#COMP     = /usr/pgi/linux86-64/7.1/bin/pgf95
-@
-
-
-1.14
-log
-@fftw3
-@
-text
-@d9 1
-a9 1
-# Note:    You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
-d19 2
-a20 1
-COMP     = /usr/pgi/linux86-64/7.1/bin/pgf95
-d44 2
-a45 1
-LINKLIBS = -Bstatic -L/usr/pgi/linux86/7.1-2/liblf -L$(FFTWLIBDIR) -lfftw3f -lm
-@
-
-
-1.13
-log
-@liblf used
-@
-text
-@a3 2
-# 
-# Note:  To create executable: make -f Makefile_linux_fftw 
-d6 2
-a7 2
-#        Non-native mode byte ordering on Intel IA32 GNU/Linux 
-#        FFTW must be configured with: --enable-float --enable-type-prefix
-d11 2
-d19 1
-a19 1
-COMP     = /usr/pgi/linux86-64/6.1/bin/pgf95
-d31 1
-a31 1
-FFLAGS   = -O2 -Mpreprocess -tp p6 -fast -Kieee -Minfo -byteswapio -Dosf_ieee -DSP_LIBFFTW -c  
-d34 1
-a34 1
-FFTWLIBDIR = ../fftw/fftw-32/lib
-d42 2
-a43 2
-# static link with FFTW libraries, liblf (supports > 2GB files), and math library
-LINKLIBS = -Bstatic -L/usr/pgi/linux86/6.1/liblf -L$(FFTWLIBDIR) -lsrfftw -lsfftw -lm
-@
-
-
-1.12
-log
-@new
-@
-text
-@a22 1
-# O3 seems to cause some problems with PGI compiler on SPIDER code
-a29 1
-# -pc 64       : Sets precision of FPU operations
-d34 1
-a34 1
-FFTWLIBDIR   = ../fftw/fftw-32/lib
-d36 1
-a36 1
-LF       = -tp p6 $(QLFLAGS)
-d38 1
-a38 1
-LIB      = $(EXE).a
-d40 1
-a40 1
-AFLAGS   = r
-d42 2
-a43 2
-# link with FFTW static libraries and math library
-LINKLIBS =  -Bstatic  -L$(FFTWLIBDIR) -lsrfftw -lsfftw -lm
-d45 1
-a45 1
-.PRECIOUS :  ../bin/$(EXE) $(LIB) 
-@
-
-
-1.11
-log
-@obsolete
-@
-text
-@d24 8
-a31 8
-# -O2            : Invokes level 2 optimization (-O3 causes some run time problems with PGI compiler on SPIDER code)
-# -mp            : Invokes multi processor support
-# -tp p6         : Targets 32 bit Pentium Pro/II/III with 32 bit memory addresses, supports x87 FP
-# -tp p7         : Targets 32 or 64 bit Pentium4 with 32 bit memory addresses, supports SSE1 & SSE2 FP
-# -Mipa=fast     : Invokes interprocedural analysis (some routines may fail to compile?)
-# -fast          : Selects an appropriate set of optimization flags usually including -O2 -Munroll -Mnoframe
-# -fastsse       : Selects an appropriate set of flags including SSE support usually including -O2 -Munroll -Mnoframe -Mvect=sse -Mcache_align 
-# -pc 64         : Sets precision of FPU operations
-@
-
-
-1.10
-log
-@Pgi6.1
-@
-text
-@@
-
-
-1.9
-log
-@fftw_loc
-@
-text
-@d2 2
-a3 1
-# MAKEFILE FOR GNU/Linux SPIDER using FFTW on 1 processor --
-d9 1
-a9 1
-#        FFTW must be configured with: --enable-float --enable-shared --prefix=/usr/local/ --enable-type-prefix
-d19 1
-a19 1
-COMP     = pgf90
-d24 10
-a33 1
-FFLAGS   = -O2 -Mpreprocess -fast -Kieee -pc 64 -Minfo -byteswapio -Dosf_ieee -DSP_LIBFFTW -c  
-d36 1
-a36 3
-FFTWLIBDIR   = ../fftw/fftw-linux/lib
-
-LF       =  $(QLFLAGS)
-d38 1
-a38 2
-# link with FFTW static libraries and math library
-LINKLIBS =  -L$(FFTWLIBDIR) -Bstatic -lsrfftw -lsfftw -lm
-d44 3
-@
-
-
-1.8
-log
-@*** empty log message ***
-@
-text
-@d2 1
-a2 1
-# ------  MAKEFILE FOR GNU/Linux SPIDER using FFTW on 1 processor --
-d18 2
-d22 5
-a26 1
-COMP     = pgf90
-d28 1
-a28 1
-FFLAGS   = -O2 -Mpreprocess -fast -Kieee -pc 64 -Minfo -byteswapio -Dosf_ieee -DSP_LIBFFTW -c  
-d30 2
-a31 1
-AFLAGS   = r
-d35 1
-a35 5
-LIBDIR   = /usr/local/lib/
-LF       = -L$(LIBDIR) $(QLFLAGS)
-
-# link with FFTW shared libraries,  iblf supports > 2GB files
-LINKLIBS = -L/usr/pgi/linux86/liblf  -lsrfftw -lsfftw -lm
-@
-
-
-1.7
-log
-@*** empty log message ***
-@
-text
-@d4 1
-a4 1
-# Note:  To create executable: make -f Makefile_linuxfftw 
-d18 1
-a18 1
-EXE      = $(PGM)_linux$(WHICH)$(SUFFIX)
-@
-
-
-1.6
-log
-@*** empty log message ***
-@
-text
-@d29 1
-a29 1
-LF       = -L$(LIBDIR) -Wl,--rpath -Wl,$(LIBDIR) $(QLFLAGS)
-@
-
-
-1.5
-log
-@*** empty log message ***
-@
-text
-@d22 1
-a22 1
-FFLAGS   = -Mpreprocess -fast -Kieee -pc 64 -Minfo -byteswapio -Dosf_ieee -DSP_LIBFFTW -c  
-d31 2
-a32 2
-# link with FFTW shared libraries
-LINKLIBS = -lsrfftw_threads -lsfftw_threads -lsrfftw -lsfftw -lm
-@
-
-
-1.4
-log
-@*** empty log message ***
-@
-text
-@d2 1
-a2 1
-# ------ MAKEFILE FILE FOR Linux UNIX SPIDER ----------
-d4 2
-d7 2
-a8 5
-#
-# Thanks to: Shixin Yang & Dr Edward Egelman at University of Virginia
-#            for providing original version of this file
-#
-# Note:   To create executable: make -f Makefile_linuxfftw 
-a9 2
-# Non-native mode byte ordering on Intel IA32 Linux 
-#
-d12 3
-a14 1
-WHICH  = fftw
-d16 1
-a16 1
-SHELL    = /bin/sh
-d18 1
-a18 1
-FFLAGS   = -DSP_LIBFFTW -Mpreprocess -pc 64 -Minfo -byteswapio -Dosf_ieee -c  
-d22 1
-a22 1
-LF       = -pc 64 -byteswapio -Minfo 
-d24 1
-a24 3
-PGM      = spider
-
-EXE      = spider_linux$(WHICH)$(SUFFIX)
-d28 2
-a29 1
-AFLAGS   = r
-d31 2
-a32 3
-# remove following two lines if not using FFTW
-LIB_FFTW = ../fftw/fftw-2.1.3/lib/
-LINKLIBS = $(LIB_FFTW)librfftw_threads.a $(LIB_FFTW)libfftw_threads.a $(LIB_FFTW)librfftw.a $(LIB_FFTW)libfftw.a -lm
-@
-
-
-1.3
-log
-@SP_LINUX --> __linux__
-@
-text
-@d2 1
-a2 1
-# ------ MAKEFILE FILE FOR Linux UNIX SPIDER -----------F90
-d11 5
-a15 1
-# non-native mode byte ordering on Intel IA32 Linux 
-d27 1
-a27 1
-EXE      = spider_linuxfftw
-@
-
-
-1.2
-log
-@*** empty log message ***
-@
-text
-@d15 1
-a15 1
-FFLAGS   = -DSP_LIBFFTW -Mpreprocess -pc 64 -Minfo -byteswapio -Dosf_ieee -DSP_LINUX -c  
-@
-
-
-1.1
-log
-@Initial revision
-@
-text
-@d7 1
-a7 1
-#    for providing this file
-d9 1
-a9 1
-# Notes:  1) The commands for ELEMENTS may be  necessary
-a10 2
-#         2) To create executable: make -f Makefile_linuxfftw ../bin/spider_linuxfftw
-#
-d21 3
-a23 1
-PGM      = spider_linuxfftw
-d25 1
-a25 1
-LIB      = $(PGM).a
-d27 2
-d33 1
-a33 1
-.PRECIOUS :  ../bin/$(PGM) $(LIB) 
-d37 2
-a38 14
-../bin/$(PGM) : $(PGM).o $(LIB)
-	@@echo linking ../bin/$(PGM)
-	$(COMP) $(LF) -g $(PGM).o $(LIB)  $(LINKLIBS) -o ../bin/$(PGM)
-
-$(PGM).o  : spider.f
-	$(COMP) $(FFLAGS) -o $(PGM).o  spider.f 
-
-$(LIB) :  $(ELEMENTS)
-	@@echo all object files placed in library
-
-$(ELEMENTS) : 
-	$(COMP) $(FFLAGS) $*.f
-	$(AR) r $(LIB) $*.o
-	@@\rm $*.o
-@
diff --git src/Makefile_samples/RCS/Makefile_linux_alpha,v src/Makefile_samples/RCS/Makefile_linux_alpha,v
deleted file mode 100644
index b9834e30..00000000
--- src/Makefile_samples/RCS/Makefile_linux_alpha,v
+++ /dev/null
@@ -1,97 +0,0 @@
-head	1.3;
-access;
-symbols
-	pre_fftwrings:1.2
-	pre_opfiles:1.2
-	src:1.2
-	best-code:1.2
-	x-named-regs:1.2
-	x:1.2
-	v13-00:1.2
-	pre_GPL:1.2
-	prec_CA:1.2
-	noindx:1.1;
-locks; strict;
-comment	@# @;
-
-
-1.3
-date	2009.02.25.16.10.02;	author leith;	state dead;
-branches;
-next	1.2;
-
-1.2
-date	2003.03.25.15.03.18;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	2000.10.06.18.32.44;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.3
-log
-@osolete
-@
-text
-@#Thanks to: Trevor Sewell  for this file which directs compilation
-#on Compaq Alpha systems running Linux Oct. 2000
-
-include linuxalphamakesource.inc
-
-SPIDER_OBJ = $(SOURCE:.f=.o)
-
-CODE_SWITCHES =   -col72 -assume byterecl
-
-OPTIMIZATION = -automatic -fullwarn -cpp -O4 -tune ev67 -arch host
-
-FFLAGS = $(CODE_SWITCHES) $(OPTIMIZATION)
-PGM      = spider_linux_alpha
-SRC      = spider
-LIB      = $(PGM).a
-LINKLIBS = /usr/local/lib/libfftw.a /usr/local/lib/librfftw.a 
-
-LFLAGS =  
-LIBS = -L. -l../bin/$(PGM) $(LINKLIBS) -lfor -lm
-
-.f.o: $(SPIDER_OBJ)
-	fort $(FFLAGS) -c $<
-
-$(PGM) : $(PGM).o $(LIB)
-	@@echo linking $(PGM)
-	fort $(PGM).o $(PGM).a $(LINKLIBS) -o $(PGM)
-
-$(PGM).a: $(SPIDER_OBJ)
-	ar -rs $@@ $(SPIDER_OBJ)
-$(PGM).o  : $(SRC).f
-	fort $(FFLAGS) -c -o $(PGM).o  $(SRC).f
-	
-clean:
-	\rm -rf *.o 
-	\rm -rf $(PGM).a
-@
-
-
-1.2
-log
-@*** empty log message ***
-@
-text
-@@
-
-
-1.1
-log
-@Initial revision
-@
-text
-@d13 1
-a13 1
-PGM      = spider_linuxalpha
-@
diff --git src/Makefile_samples/RCS/Makefile_linux_bg,v src/Makefile_samples/RCS/Makefile_linux_bg,v
deleted file mode 100644
index 368c445b..00000000
--- src/Makefile_samples/RCS/Makefile_linux_bg,v
+++ /dev/null
@@ -1,80 +0,0 @@
-head	1.1;
-access;
-symbols;
-locks; strict;
-comment	@# @;
-
-
-1.1
-date	2008.11.03.15.22.18;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.1
-log
-@new
-@
-text
-@# 
-# ------ MAKEFILE FILE FOR IBM Blue Gene Linux SPIDER WITH MPI -----------
-#        ArDean Leith   Sept. 2007
-#
-# Notes: 
-#   The commands for ELEMENTS may be necessary
-#   To create  executable:  make -f Makefile_linux_fftw_bg ../bin/spider_linux_fftw_bg
-#   May be necessary to remove all: *.F before starting compilation
-#
-# O2                  : optimization level
-# qstrict             : follow program semantics when optimizing
-# qipa                : inter procedural analysis
-# qfixed=72           : fixed line length
-# qarch=440           : target machine
-# qtune=440           : target machine
-#
-# Note: To have text of FORTRAN error messages displayed, specify  
-#       -env "NLSPATH=$NLSPATH" on your mpirun command  line.  
-
-FFLAGS   =  -O2 -qstrict -qarch=440d -qstrict -qtune=440 -qfixed=72 -qnosave -c    
-LFLAGS   =  -O2 -qarch=440d  -qnosave
-
-CPPFLAGS = -DSP_IBMSP3 -DUSE_MPI -DMPI_DEBUG -DSP_LIBFFTW
-
-# F90 compiler location: /opt/ibmcmp/xlf/bg/10.1/bin/blrts_xlf
-COMP   = /bgl/BlueLight/ppcfloor/bglsys/bin/mpixlf90
-CPP    = /opt/ibmcmp/xlf/bg/10.1/exe/cpp
-
-PGM    = spider_linux_fftw_bg
-LIB    = $(PGM).a
-SRC    = spider
-
-# FFTW library location 
-FFTWLIBDIR = ../fftw/fftw-bg/lib 
-LINKLIBS   = -L$(FFTWLIBDIR) -lsrfftw -lsfftw
-
-.PRECIOUS : $(LIB) ../bin/$(PGM)
-
-include Makefile.inc
-
-../bin/$(PGM) : $(PGM).o $(LIB)
-	@@echo linking ../bin/$(PGM)
-	$(COMP) $(LFLAGS) $(PGM).o $(LIB) $(LINKLIBS) -lc -o ../bin/$(PGM)
-
-$(PGM).o  : $(SRC).f
-	$(CPP)  $(CPPFLAGS) $(SRC).f $(SRC).F 
-	$(COMP) $(FFLAGS) -o $(PGM).o  $(SRC).F 
-	@@\rm $(SRC).F
-
-$(LIB) :  $(ELEMENTS)
-	@@echo all object files placed in library
-
-$(ELEMENTS) : 
-	$(CPP) $(CPPFLAGS) $*.f $*.F 
-	$(COMP) $(FFLAGS) $*.F
-	$(AR) r $(LIB) $*.o
-	@@\rm $*.o $*.F
-@
diff --git src/Makefile_samples/RCS/Makefile_linux_fftw_opt64,v src/Makefile_samples/RCS/Makefile_linux_fftw_opt64,v
deleted file mode 100644
index ad999c90..00000000
--- src/Makefile_samples/RCS/Makefile_linux_fftw_opt64,v
+++ /dev/null
@@ -1,83 +0,0 @@
-head	1.2;
-access;
-symbols
-	best-code:1.1
-	x-named-regs:1.1
-	x:1.1
-	v13-00:1.1
-	pre_GPL:1.1;
-locks; strict;
-comment	@# @;
-
-
-1.2
-date	2006.07.28.14.09.19;	author leith;	state dead;
-branches;
-next	1.1;
-
-1.1
-date	2005.07.15.13.28.44;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.2
-log
-@obsolete
-@
-text
-@# 
-# -----  MAKEFILE FOR GNU/Linux SPIDER using FFTW on Opteron 64--
-# 
-# Note:  To create executable: make -f Makefile_linux_fftw_opt64
-#
-# Using: Portland Group F90 compiler
-#        Non-native mode byte ordering on:  AMD Opteron GNU/Linux 64 bit OS
-#        FFTW must be configured with:  --enable-float --enable-shared --enable-type-prefix
-#
-# Note:    You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
-#
-SHELL    = /bin/sh
-
-PGM      = spider
-
-WHICH    = fftw_opt64
-
-COMP     = pgf90
-
-EXE      = $(PGM)_linux_$(WHICH)$(SUFFIX)
-
-FFLAGS   = -O2 -Mpreprocess -fast -Kieee -tp k8-64 -mcmodel=medium -pc 64 -Minfo -byteswapio -Dosf_ieee -DSP_LIBFFTW  -c  
-
-LIBDIR   = /net/bali/usr1/fftw-opt64/fftw-2.1.5/lib
-
-LF       = -L$(LIBDIR) $(QLFLAGS)
-
-LIB      = $(EXE).a
-
-AFLAGS   = r
-
-# link with FFTW libraries
-LINKLIBS = -lsrfftw -lsfftw -lm
-
-.PRECIOUS :  ../bin/$(EXE) $(LIB) 
-
-include Makefile.inc
-
-include Makebody.inc
-
-
-@
-
-
-1.1
-log
-@new
-@
-text
-@@
-
diff --git src/Makefile_samples/RCS/Makefile_linux_ibm,v src/Makefile_samples/RCS/Makefile_linux_ibm,v
deleted file mode 100644
index 433f142e..00000000
--- src/Makefile_samples/RCS/Makefile_linux_ibm,v
+++ /dev/null
@@ -1,107 +0,0 @@
-head	1.2;
-access;
-symbols
-	pre_fftwrings:1.1
-	pre_opfiles:1.1
-	src:1.1
-	best-code:1.1
-	x-named-regs:1.1
-	x:1.1
-	v13-00:1.1;
-locks; strict;
-comment	@# @;
-
-
-1.2
-date	2008.11.03.16.54.52;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	2005.10.17.16.36.02;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.2
-log
-@*** empty log message ***
-@
-text
-@# 
-# ------    MAKEFILE FOR IBM SP3 UNIX SPIDER using FFTW without MP
-#
-# USING:    IBM xlf90 compiler
-# TARGET:   IBM SP3 running Linux 
-# IMAGES:   Optimal SPIDER image byte order:   (native) 
-#
-# NOTE:     Uses SPIDER'S native FFT (slow) 
-#
-# NOTE:     You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
-#
-# NOTE:     To create executable: make -f Makefile_linux_ibm 
-# 
-# NOTES:    The commands for ELEMENTS may be necessary
-#
-# native mode on IBM SP machine with no parallel stuff
-FFLAGS   =  -qarch=auto -qfixed=80 -qnosave -c  
-  
-LFLAGS   =  -L/vol/apps/MASS42/mass/4.2/sles9/lib -lmass -qarch=auto -qnosave
-
-CPPFLAGS = -DSP_IBMSP3
-
-COMP     = xlf90 -O5
-
-CPP      = /opt/ibmcmp/xlf/9.1/exe/cpp
-
-PGM      = spider_ibm
-
-LIB      = $(PGM).a
-
-SRC      = spider
-
-.PRECIOUS :   $(LIB) ../bin/$(PGM)
-
-include Makefile.inc
-
-../bin/$(PGM) : $(PGM).o $(LIB)
-	@@echo linking ../bin/$(PGM)
-	$(COMP) $(LFLAGS) $(PGM).o $(LIB) -lc -o ../bin/$(PGM)
-
-$(PGM).o  : $(SRC).f
-	$(CPP)  $(CPPFLAGS) $(SRC).f $(SRC).F 
-	$(COMP) $(FFLAGS) -o $(PGM).o  $(SRC).F 
-
-$(LIB) :  $(ELEMENTS)
-	@@echo all object files placed in library
-
-$(ELEMENTS) : 
-	$(CPP) $(CPPFLAGS) $*.f $*.F 
-	$(COMP) $(FFLAGS) $*.F
-	$(AR) r $(LIB) $*.o
-	@@\rm $*.o $*.F
-@
-
-
-1.1
-log
-@from ibm
-@
-text
-@d2 7
-a8 3
-# ------ MAKEFILE FILE FOR IBM SP UNIX SPIDER ----------- F90
-# 
-# Notes: 
-d10 1
-a10 1
-#       The commands for ELEMENTS may be necessary
-d12 3
-a14 1
-#       To create  executable:   make -f Makefile_ibm ../bin/spider_ibm
-@
-
diff --git src/Makefile_samples/RCS/Makefile_linux_ifc,v src/Makefile_samples/RCS/Makefile_linux_ifc,v
deleted file mode 100644
index dd45f63a..00000000
--- src/Makefile_samples/RCS/Makefile_linux_ifc,v
+++ /dev/null
@@ -1,97 +0,0 @@
-head	1.2;
-access;
-symbols
-	pre_fftwrings:1.1
-	pre_opfiles:1.1
-	src:1.1
-	best-code:1.1
-	x-named-regs:1.1
-	x:1.1
-	v13-00:1.1
-	pre_GPL:1.1
-	prec_CA:1.1;
-locks; strict;
-comment	@# @;
-
-
-1.2
-date	2009.11.30.16.07.22;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	2003.03.25.15.04.43;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.2
-log
-@removed osf_iee
-@
-text
-@# 
-# ------  MAKEFILE FOR GNU/Linux SPIDER using FFTW --
-# 
-# Note:  To create executable: make -f Makefile_linux_ifc
-#
-# Using: Intel Fortran compiler 7.0 (ifc)
-#
-# To use non-native mode byte ordering on Intel IA32 GNU/Linux, define the
-# environment variable F_UFMTENDIAN to "big".
-#
-# FFTW must be configured with:  --enable-threads --enable-float --enable-shared --prefix=/usr/local/ --enable-type-prefix
-# Linux 7.4+++
-#
-# All libraries are statically linked except libm and glibc.
-#
-# Note:    You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
-#
-# Makefile modified for Intel Fortran compiler by Slaton Lipscomb
-#
-SHELL    = /bin/sh
-
-PGM      = spider
-
-WHICH    = ifc
-
-COMP     = ifc
-
-#SUFFIX   = _
-
-EXE      = $(PGM)_linux$(WHICH)$(SUFFIX)
-
-FFLAGS   = -Vaxlib -O2 -WB -mp -fpp2 -auto -pc64 -c -cm -w95 -tpp6 -axW -DSP_LINUX -DSP_LIBFFTW -DSP_IFC
-
-LIBDIR   = /usr/local/lib/
-
-LF       =  $(QLFLAGS)
-
-LIB      = spider_linuxifc.a
-
-AFLAGS   = r
-
-# link with FFTW shared libraries,  liblf supports > 2GB files
-LINKLIBS = -Bstatic -L$(LIBDIR) -lsrfftw_threads -lsfftw_threads -lsrfftw -lsfftw -lPEPCF90 -static-libcxa -Bdynamic -lm
-
-.PRECIOUS :  ../bin/$(EXE) $(LIB) 
-
-include Makefile.inc
-include Makebody.inc
-
-@
-
-
-1.1
-log
-@Initial revision
-@
-text
-@d32 1
-a32 1
-FFLAGS   = -Vaxlib -O2 -WB -mp -fpp2 -auto -pc64 -c -cm -w95 -tpp6 -axW -Dosf_ieee -DSP_LINUX -DSP_LIBFFTW -DSP_IFC
-@
diff --git src/Makefile_samples/RCS/Makefile_linux_ifc_p4,v src/Makefile_samples/RCS/Makefile_linux_ifc_p4,v
deleted file mode 100644
index e520d3d2..00000000
--- src/Makefile_samples/RCS/Makefile_linux_ifc_p4,v
+++ /dev/null
@@ -1,98 +0,0 @@
-head	1.2;
-access;
-symbols
-	pre_fftwrings:1.1
-	pre_opfiles:1.1
-	src:1.1
-	best-code:1.1
-	x-named-regs:1.1
-	x:1.1
-	v13-00:1.1
-	pre_GPL:1.1
-	prec_CA:1.1;
-locks; strict;
-comment	@# @;
-
-
-1.2
-date	2009.11.30.16.11.33;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	2003.03.25.15.04.44;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.2
-log
-@removed -Dosf_ieee
-@
-text
-@# 
-# ------  MAKEFILE FOR GNU/Linux SPIDER using FFTW --
-# 
-# Note:  To create executable: make -f Makefile_linux_ifc_p4
-#
-# Using: Intel Fortran compiler 7.0 (ifc)
-# Optimization: Pentium 4/Xeon ONLY
-#
-# To use non-native mode byte ordering on Intel IA32 GNU/Linux, define the
-# environment variable F_UFMTENDIAN to "big".
-#
-# FFTW must be configured with:  --enable-threads --enable-float --enable-shared --prefix=/usr/local/ --enable-type-prefix
-# Linux 7.4+++
-#
-# All libraries are statically linked except libm & glibc.
-#
-# Note:    You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
-#
-# Makefile modified for Intel Fortran compiler by Slaton Lipscomb
-#
-SHELL    = /bin/sh
-
-PGM      = spider
-
-WHICH    = ifc
-
-COMP     = ifc
-
-SUFFIX   = _p4
-
-EXE      = $(PGM)_linux$(WHICH)$(SUFFIX)
-
-FFLAGS   = -Vaxlib -O2 -WB -mp -fpp2 -auto -pc64 -c -cm -w95 -tpp7 -xW  -DSP_LINUX -DSP_LIBFFTW -DSP_IFC
-
-LIBDIR   = /usr/local/lib/
-
-LF       =  $(QLFLAGS)
-
-LIB      = spider_linuxifc.a
-
-AFLAGS   = r
-
-# link with FFTW shared libraries,  liblf supports > 2GB files
-LINKLIBS = -Bstatic -L$(LIBDIR) -lsrfftw_threads -lsfftw_threads -lsrfftw -lsfftw -lPEPCF90 -static-libcxa -Bdynamic -lm
-
-.PRECIOUS :  ../bin/$(EXE) $(LIB) 
-
-include Makefile.inc
-include Makebody.inc
-
-@
-
-
-1.1
-log
-@Initial revision
-@
-text
-@d33 1
-a33 1
-FFLAGS   = -Vaxlib -O2 -WB -mp -fpp2 -auto -pc64 -c -cm -w95 -tpp7 -xW -Dosf_ieee -DSP_LINUX -DSP_LIBFFTW -DSP_IFC
-@
diff --git src/Makefile_samples/RCS/Makefile_linux_mp,v src/Makefile_samples/RCS/Makefile_linux_mp,v
deleted file mode 100755
index 02e616a4..00000000
--- src/Makefile_samples/RCS/Makefile_linux_mp,v
+++ /dev/null
@@ -1,649 +0,0 @@
-head	1.22;
-access;
-symbols
-	pre_fftwrings:1.16
-	pre_opfiles:1.15
-	src:1.15
-	best-code:1.13
-	x-named-regs:1.13
-	x:1.13
-	v13-00:1.13
-	pre_GPL:1.12
-	prec_CA:1.4;
-locks
-	leith:1.22; strict;
-comment	@# @;
-
-
-1.22
-date	2011.03.03.18.39.36;	author leith;	state Exp;
-branches;
-next	1.21;
-
-1.21
-date	2009.11.30.16.12.19;	author leith;	state Exp;
-branches;
-next	1.20;
-
-1.20
-date	2009.02.25.16.29.48;	author leith;	state Exp;
-branches;
-next	1.19;
-
-1.19
-date	2008.11.03.16.55.15;	author leith;	state Exp;
-branches;
-next	1.18;
-
-1.18
-date	2008.11.03.15.53.45;	author leith;	state Exp;
-branches;
-next	1.17;
-
-1.17
-date	2008.09.17.14.51.18;	author leith;	state Exp;
-branches;
-next	1.16;
-
-1.16
-date	2007.12.14.13.30.01;	author leith;	state Exp;
-branches;
-next	1.15;
-
-1.15
-date	2006.07.25.12.51.49;	author leith;	state Exp;
-branches;
-next	1.14;
-
-1.14
-date	2006.07.20.18.20.21;	author leith;	state Exp;
-branches;
-next	1.13;
-
-1.13
-date	2005.10.19.19.20.12;	author leith;	state Exp;
-branches;
-next	1.12;
-
-1.12
-date	2005.08.22.20.28.31;	author leith;	state Exp;
-branches;
-next	1.11;
-
-1.11
-date	2005.08.17.20.34.30;	author leith;	state Exp;
-branches;
-next	1.10;
-
-1.10
-date	2005.05.18.17.03.51;	author leith;	state Exp;
-branches;
-next	1.9;
-
-1.9
-date	2005.05.18.16.57.21;	author leith;	state Exp;
-branches;
-next	1.8;
-
-1.8
-date	2005.05.18.16.50.12;	author leith;	state Exp;
-branches;
-next	1.7;
-
-1.7
-date	2005.05.18.16.42.07;	author leith;	state Exp;
-branches;
-next	1.6;
-
-1.6
-date	2005.01.25.16.58.00;	author leith;	state Exp;
-branches;
-next	1.5;
-
-1.5
-date	2004.07.08.19.10.50;	author leith;	state Exp;
-branches;
-next	1.4;
-
-1.4
-date	2003.03.25.15.03.21;	author leith;	state Exp;
-branches;
-next	1.3;
-
-1.3
-date	2003.02.20.14.22.42;	author leith;	state Exp;
-branches;
-next	1.2;
-
-1.2
-date	2003.02.13.18.53.48;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	2003.02.13.15.55.41;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.22
-log
-@*** empty log message ***
-@
-text
-@# 
-# ------    MAKEFILE FOR GNU/Linux SPIDER using FFTW3 on 2 or more Intel 32 bit processors  
-#  
-# USING:    Portland Group F90 compiler
-# TARGET:   Intel IA32 (i386) running GNU/Linux (Should run on many Linux PC's)
-# IMAGES:   Optimal SPIDER image byte order:   Big-endian Non-native (SGI)
-# USAGE:    To create executable use: make -f Makefile_linux_mp 
-#
-# NOTE:     Uses FFTW3 with OMP threads
-# NOTE:     FFTW3 must be configured with: --enable-float --enable-type-prefix
-# NOTE:     You may ignore any undefined: QFFLAGS, QLFLAGS, or SUFFIX
-#
-# PGI Compile/link flags
-# -O2             : Invokes level 2 optimization (-O3 causes some run time problems with PGI compiler on SPIDER code)
-# -Kieee          : Invokes strict IEEE floating calculations
-# -mp             : Invokes multi processor support
-# -tp p6          : Targets 32 bit Pentium Pro/II/III with 32 bit memory addresses, supports x87 FP
-# -tp p7          : Targets 32 or 64 bit Pentium4 with 32 bit memory addresses, supports SSE1 & SSE2 FP
-# -tp p7-64       : Targets 64 bit Pentium4 with 64 bit memory addresses, supports SSE1, SSE2 & SSE3 FP
-# -tp x64         : Targets unified 64 bit AMD & Intel binaries (samoa)
-# -tp k8-64e      : Targets AMD Opteron Revision E or AMD Turion (cluster)
-# -Mipa=fast      : Invokes interprocedural analysis 
-# -fast           : Selects appropriate set of flags usually including -O2 -Munroll -Mnoframe
-# -fastsse        : Selects appropriate set of flags including SSE support and usually -O2 -Munroll -Mnoframe -Mvect=sse -Mcache_align 
-# -pc 64          : Sets precision of FPU operations
-# -mcmodel=medium : Allows use of >2GB data area 
-# -Bstatic_pgi    : Uses static PGI libs but makes dynamic executable
-# -Bstatic        : Static link 
-
-SHELL    = /bin/sh
-
-AFLAGS   = r
-
-#COMP    = /usr/pgi/linux86-64/7.1/bin/pgf95
-#COMP    = /usr/pgi7.2/linux86-64/7.2-5/bin/pgf95
-#COMP    = /scratch/pgi/linux86-64/8.0-4/bin/pgf95
- COMP    = /usr10/pgi/linux86-64/2011/bin/pgf95
-
-PGM      = spider
-
-WHICH    = mp
-
-EXE      = $(PGM)_linux_$(WHICH)$(SUFFIX)
-
-LIB      = $(EXE).a
-
-FFLAGS   = -Bstatic -tp p6 -fast -mp=nonuma -O2 -Mpreprocess -Kieee -Minfo -byteswapio -DSP_MP -DSP_LIBFFTW3 -c  
-
-LF       = -Bstatic -tp p6 -fast -mp=nonuma $(QLFLAGS)
-
-# Link with Multiprocessing, FFTW3 , and math libraries
-FFTWLIBDIR   = ../fftw/fftw3-32/lib
-LINKLIBS =  -Bstatic -L$(FFTWLIBDIR) -lfftw3f -lfftw3f_threads -lm
-
-.PRECIOUS :  ../bin/$(EXE) $(LIB) 
-
-include Makefile.inc
-
-include Makebody.inc
-
-@
-
-
-1.21
-log
-@removed -Dosf_ieee
-/
-res Makefile_linux_mp_ifc_p4
-@
-text
-@d7 2
-a8 1
-# 
-d10 2
-a11 3
-#           FFTW3 must be configured with: --enable-float --enable-type-prefix
-#
-# Note:     To create executable use: make -f Makefile_linux_mp 
-d13 16
-a28 1
-# NOTE:     You may ignore any undefined: QFFLAGS, QLFLAGS, or SUFFIX
-d32 1
-a32 3
-PGM      = spider
-
-WHICH    = mp
-d37 1
-a37 1
-COMP     = pgf95
-d39 1
-a39 1
-EXE      = $(PGM)_linux_$(WHICH)$(SUFFIX)
-d41 1
-a41 9
-# O3 seems to cause some problems with PGI compiler on SPIDER code
-# -O2            : Invokes level 2 optimization (-O3 causes some run time problems with PGI compiler on SPIDER code)
-# -mp            : Invokes multi processor support
-# -tp p6         : Targets 32 bit Pentium Pro/II/III with 32 bit memory addresses, supports x87 FP
-# -tp p7         : Targets 32 or 64 bit Pentium4 with 32 bit memory addresses, supports SSE1 & SSE2 FP
-# -Mipa=fast     : Invokes interprocedural analysis (some routines may fail to compile)
-# -fast          : Selects an appropriate set of optimization flags usually including -O2 -Munroll -Mnoframe
-# -fastsse       : Selects an appropriate set of flags including SSE support usually including -O2 -Munroll -Mnoframe -Mvect=sse -Mcache_align 
-# -pc 64         : Sets precision of FPU operations
-d43 1
-a43 1
-FFLAGS = -O2 -Mpreprocess -mp -tp p6 -fast -Kieee -Minfo -byteswapio -DSP_MP -DSP_LIBFFTW3 -c  
-d45 1
-a45 2
-# FFTW library location
-FFTWLIBDIR   = ../fftw/fftw3-32/lib
-d47 1
-a47 2
-# Link with multi processor support
-LF       = -tp p6 $(QLFLAGS)
-d49 1
-a49 3
-LIB      = $(EXE).a
-
-AFLAGS   = r
-d52 2
-a53 1
-LINKLIBS =  -Bstatic -L$(FFTWLIBDIR) -lfftw3f -lfftw3f_threads -mp -lm
-@
-
-
-1.20
-log
-@COMP
-@
-text
-@d38 1
-a38 1
-FFLAGS = -O2 -Mpreprocess -mp -tp p6 -fast -Kieee -Minfo -byteswapio -Dosf_ieee -DSP_MP -DSP_LIBFFTW3 -c  
-@
-
-
-1.19
-log
-@*** empty log message ***
-@
-text
-@d22 3
-a24 1
-COMP     = /usr/pgi7.2/linux86-64/7.2-5/bin/pgf95
-@
-
-
-1.18
-log
-@removed fftw in name
-@
-text
-@d2 5
-a6 2
-# MAKEFILE FOR GNU/Linux SPIDER using FFTW on 2 or more processors  Intel/AMD 32 bit
-# FOR:  Intel/AMD IA32 GNU/Linux 
-d8 2
-a9 1
-# Note:  To create executable use: make -f Makefile_linux_mp 
-d11 1
-a11 6
-# Using: Portland Group F90 compiler
-#        Non-native mode byte ordering on:  Intel/AMD IA32 GNU/Linux 
-#        FFTW3 must be configured with: --enable-float --enable-type-prefix
-#        Uses FFTW3 with OMP threads
-#
-# Note:    You may ignore any undefined: QFFLAGS, QLFLAGS, or SUFFIX
-d13 2
-@
-
-
-1.17
-log
-@pgi7.2
-@
-text
-@d5 1
-a5 1
-# Note:  To create executable use: make -f Makefile_linux_mpfftw 
-d10 1
-a10 1
-#        Use FFTW3 with OMP threads
-d18 1
-a18 1
-WHICH    = mpfftw
-@
-
-
-1.16
-log
-@fftw3
-@
-text
-@d20 2
-a21 1
-COMP     = /usr/pgi/linux86-64/7.1/bin/pgf95
-@
-
-
-1.15
-log
-@faster?
-@
-text
-@d9 2
-a10 3
-#        FFTW must be configured with: --enable-float --enable-type-prefix
-#        We use FFTW on single processor (without threads) as it is usually poor for
-#        multiple processors in our testing (June 05 al)
-d20 1
-a20 1
-COMP     = /usr/pgi/linux86-64/6.1/bin/pgf95
-d34 1
-a34 1
-FFLAGS = -O2 -Mpreprocess -mp -tp p6 -fast -Kieee -Minfo -byteswapio -Dosf_ieee -DSP_MP -DSP_LIBFFTW -c  
-d37 1
-a37 1
-FFTWLIBDIR   = ../fftw/fftw-32/lib
-d46 2
-a47 2
-# link with Multiprocessing, FFTW (static), and math libraries
-LINKLIBS =  -Bstatic -L$(FFTWLIBDIR) -lsrfftw -lsfftw -mp -lm
-@
-
-
-1.14
-log
-@for pgi 6.2
-@
-text
-@d3 1
-d26 10
-a35 2
-# Compile with multi processor support
-FFLAGS = -O2 -Mpreprocess -mp -tp p6 -Kieee -Minfo -byteswapio -Dosf_ieee -DSP_MP -DSP_LIBFFTW -c  
-d47 1
-a47 1
-# link with Multiprocessing, FFTW (static), and math library
-@
-
-
-1.13
-log
-@fftw_loc
-@
-text
-@d2 1
-a2 1
-# MAKEFILE FOR GNU/Linux SPIDER using FFTW on 2 or more processors --
-d8 1
-a8 1
-#        FFTW must be configured with: --enable-float --enable-shared --enable-type-prefix
-d20 1
-a20 1
-COMP     = pgf90
-d26 1
-a26 1
-FFLAGS   = -O2 -Mpreprocess -fast -Kieee -pc 64 -Minfo -mp -byteswapio -Dosf_ieee -DSP_MP -DSP_LIBFFTW -c  
-d29 1
-a29 1
-FFTWLIBDIR   = ../fftw/fftw-linux/lib
-d32 1
-a32 1
-LF       = -mp $(QLFLAGS)
-d39 1
-a39 1
-LINKLIBS =  -L$(FFTWLIBDIR) -Bstatic -lsrfftw -lsfftw -lm
-@
-
-
-1.12
-log
-@libpgc static problem
-@
-text
-@d2 1
-a2 1
-# ------  MAKEFILE FOR GNU/Linux SPIDER using FFTW on 2 or more processors --
-d11 1
-a11 1
-##
-d25 5
-a29 1
-FFLAGS   = -O2 -Mpreprocess -fast -Kieee -pc 64 -Minfo -mp -byteswapio -Dosf_ieee -DSP_MP -DSP_LIBFFTW  -c  
-d31 2
-a32 1
-LF       = $(QLFLAGS)
-d38 2
-a39 2
-# link with Multiprocessing, FFTW (shared), and math (shared system) libraries
-LINKLIBS =  -Bstatic -mp -Bdynamic -L/usr/local/lib -lsrfftw -lsfftw -lm
-@
-
-
-1.11
-log
-@no libpgca bug
-@
-text
-@d4 1
-a4 1
-# Note:  To create executable: make -f Makefile_linux_mpfftw 
-d6 1
-a6 1
-# Using: Portland Group F90 compiler (FOR REDHAT LINUX PRE 7.4 !!)
-d8 1
-a8 1
-#        FFTW must be configured with:  --enable-float --enable-shared --enable-type-prefix
-d12 1
-a12 1
-# Note:    You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
-d24 1
-d27 1
-a27 3
-LIBDIR   = /usr/local/lib
-
-LF       = -L$(LIBDIR) -mp  $(QLFLAGS)
-d33 2
-a34 2
-# link with FFTW shared libraries
-LINKLIBS =  -lsrfftw -lsfftw  -lm
-@
-
-
-1.10
-log
-@bad exec name
-@
-text
-@d8 4
-a11 2
-#        FFTW must be configured with: --enable-threads --enable-float --enable-shared --enable-type-prefix
-#
-d24 3
-a26 1
-FFLAGS   = -O2 -Mpreprocess -fast -Kieee -pc 64 -Minfo -mp -byteswapio -Dosf_ieee -DSP_MP -DSP_LIBFFTW -DSP_LIBFFTWMP -c  
-d28 1
-a28 1
-LF       = -mp $(QLFLAGS)
-a31 4
-LIBSTA   = -Wl,-static,/usr/pgi/linux86/6.0/lib/libpgc.a
-
-LIBDIR   = /usr/local/lib
-
-d35 1
-a35 1
-LINKLIBS = $(LIBSTA) $(LIBDIR)/libsrfftw_threads.so  $(LIBDIR)/libsfftw_threads.so $(LIBDIR)/libsrfftw.so $(LIBDIR)/libsfftw.so  -lm
-@
-
-
-1.9
-log
-@bad exec name
-@
-text
-@d26 1
-a26 1
-LIB      = spider_linux_mpfftw.a
-d34 1
-@
-
-
-1.8
-log
-@for PGI 6.0
-@
-text
-@d16 1
-a16 1
-WHICH    = mpfftw_rh7
-a25 1
-# library same as library for: spider_linux_mpfftw
-a33 2
-# link with FFTW shared libraries,  iblf supports > 2GB files
-#LINKLIBS = $(LIBSTA) -L$(LIBDIR) $(LIBDIR)/libsrfftw_threads.so  $(LIBDIR)/libsfftw_threads.so $(LIBDIR)/libsrfftw.so $(LIBDIR)/libsfftw.so  -lm
-@
-
-
-1.7
-log
-@latest from cluster
-@
-text
-@d2 1
-a2 1
-# -----  MAKEFILE FOR GNU/Linux SPIDER using FFTW on 2 or more processors --
-d4 5
-a8 1
-# Note:  To create executable: make -f Makefile_linux_other         
-a9 5
-# Using: Portland Group F90 compiler
-#        Non-native mode byte ordering on:  Intel/AMD  IA32 GNU/Linux 
-#        FFTW must be configured with: --enable-threads --enable-float --enable-shared  --enable-type-prefix
-#        for Redhat Linux 7.4+++ (earlier Redhat Linux requires PGI lpthread)
-#         
-d16 1
-a16 1
-WHICH    = mpfftw
-d24 1
-a24 1
-LF       =  $(QLFLAGS)
-d26 1
-d29 3
-a31 1
-LIBDIR   = /usr/local/lib/
-d35 3
-a37 2
-# link with FFTW shared libraries,  liblf supports > 2GB files
-LINKLIBS =   -L$(LIBDIR) -lsrfftw_threads -lsfftw_threads -lsrfftw -lsfftw -lpgmp -lpthread -lm
-@
-
-
-1.6
-log
-@comment
-@
-text
-@d4 1
-a4 1
-# Note:  To create executable: make -f Makefile_linux_mpfftw         
-d27 1
-a27 1
-LIB      = $(EXE).a
-@
-
-
-1.5
-log
-@for redhat 7.4+++
-@
-text
-@d4 1
-a4 1
-# Note:  To create executable: make -f Makefile_linux_other         
-@
-
-
-1.4
-log
-@*** empty log message ***
-@
-text
-@d2 1
-a2 1
-# ------  MAKEFILE FOR GNU/Linux SPIDER using FFTW on 2 or more processors --
-d4 1
-a4 1
-# Note:  To create executable: make -f Makefile_linux_mpfftw 
-d7 4
-a10 3
-#        Non-native mode byte ordering on:  Intel IA32 GNU/Linux 
-#        FFTW must be configured with:  --enable-threads --enable-float --enable-shared --prefix=/usr/local/ --enable-type-prefix
-#
-d25 1
-a25 1
-LIBDIR   = /usr/local/lib/
-d27 1
-a27 1
-LF       = -L$(LIBDIR) -mp  $(QLFLAGS)
-d29 1
-a29 1
-LIB      = $(EXE).a
-d33 2
-a34 5
-# link with FFTW shared libraries,  iblf supports > 2GB files
-LINKLIBS = -L/usr/pgi/linux86/liblf -lsrfftw_threads -lsfftw_threads -lsrfftw -lsfftw -lm
-
-#For latest PG Compiler version may have to uncomment next line
-#LINKLIBS = $(LINKLIBS) -lpgmp -lpthread
-@
-
-
-1.3
-log
-@*** empty log message ***
-@
-text
-@d4 1
-a4 1
-# Note:  To create executable: make -f Makefile_linuxmpfftw 
-d20 1
-a20 1
-EXE      = $(PGM)_linux$(WHICH)$(SUFFIX)
-@
-
-
-1.2
-log
-@*** empty log message ***
-@
-text
-@d26 1
-a26 1
-LF       = -L$(LIBDIR) -Wl,--rpath -Wl,$(LIBDIR) -mp  $(QLFLAGS)
-@
-
-
-1.1
-log
-@Initial revision
-@
-text
-@d22 1
-a22 1
-FFLAGS   = -Mpreprocess -fast -Kieee -pc 64 -Minfo -mp -byteswapio -Dosf_ieee -DSP_MP -DSP_LIBFFTW -DSP_LIBFFTWMP -c  
-a27 1
-
-d32 2
-a33 2
-# link with FFTW shared libraries
-LINKLIBS = -lsrfftw_threads -lsfftw_threads -lsrfftw -lsfftw -lm
-@
diff --git src/Makefile_samples/RCS/Makefile_linux_mp.gfort,v src/Makefile_samples/RCS/Makefile_linux_mp.gfort,v
deleted file mode 100644
index c070614c..00000000
--- src/Makefile_samples/RCS/Makefile_linux_mp.gfort,v
+++ /dev/null
@@ -1,142 +0,0 @@
-head	1.2;
-access;
-symbols;
-locks; strict;
-comment	@# @;
-
-
-1.2
-date	2012.05.01.16.52.37;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	2012.04.23.15.28.42;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.2
-log
-@*** empty log message ***
-@
-text
-@SHELL		= /bin/sh
-INSTALL		= install -c
-INSTALL_PROGRAM	= $(INSTALL)
-
-# Common prefix for installation directories.
-# NOTE: This directory must exist when you start the install.
-prefix		= /usr/local
-exec_prefix	= $(prefix)
-bindir		= $(exec_prefix)/bin
-
-
-SRCS = $(patsubst %.f, %.o, $(filter-out $(EXCLUDE), $(wildcard *.f)))
-
-all:
-
-build: fftw3.o lundoc.o $(SRCS)
-	$(FC) $(FLFLAGS) -o $(PROGRAM) $^
-
-spider:
-	$(MAKE) FC='/usr/bin/gfortran' \
-		FCFLAGS='-cpp -DSP_GFORTRAN -DSP_LIBFFTW3 -DSP_LINUX -Ofast -funroll-loops -finline-limit=600' \
-		FLFLAGS='-lfftw3f -lm' \
-		PROGRAM='spider' \
-		build
-
-spider-openmp:
-	$(MAKE) FC='/usr/bin/gfortran' \
-		FCFLAGS='-cpp -DSP_GFORTRAN -DSP_LIBFFTW3 -DSP_LINUX -Ofast -funroll-loops -finline-limit=600 -DSP_MP -fopenmp' \
-		FLFLAGS='-lfftw3f -lm -fopenmp -lfftw3f_threads' \
-		PROGRAM='spider-openmp' \
-		build
-
-spider-openmpi:
-	$(MAKE) FC='/usr/bin/mpif90.openmpi' \
-		FCFLAGS='-cpp -DSP_GFORTRAN -DSP_LIBFFTW3 -DSP_LINUX -Ofast -funroll-loops -finline-limit=600 -DUSE_MPI -I/usr/include/openmpi' \
-		FLFLAGS='-lfftw3f -lm -lmpi' \
-		PROGRAM='spider-openmpi' \
-		build
-
-spider-mpich2:
-	$(MAKE) FC='/usr/bin/mpif90.mpich2' \
-		FCFLAGS='-cpp -DSP_GFORTRAN -DSP_LIBFFTW3 -DSP_LINUX -Ofast -funroll-loops -finline-limit=600 -DUSE_MPI -I/usr/include/mpich2' \
-		FLFLAGS='-lfftw3f -lm -lmpi' \
-		PROGRAM='spider-mpich2' \
-		build
-
-spider-pgi:
-	$(MAKE) FC='/usr/local/pgi/linux86-64/12.3/bin/pgf95' \
-		FCFLAGS='-tp x64 -fast -O2 -Mpreprocess -Kieee -Minfo -byteswapio -DHAS_IEEE -DSP_LIBFFTW3' \
-		FLFLAGS='-Bstatic_pgi -tp x64 -lfftw3f -lm' \
-		PROGRAM='spider-pgi' \
-		build
-
-spider-pgi-openmp:
-	$(MAKE) FC='/usr/local/pgi/linux86-64/12.3/bin/pgf95' \
-		FCFLAGS='-tp x64 -mcmodel=medium -fastsse -Mipa=fast -mp=nonuma -O2 -Mpreprocess -Kieee -Minfo -byteswapio -DHAS_IEEE -DSP_MP -DSP_LIBFFTW3' \
-		FLFLAGS='-Bstatic_pgi -tp x64 -mcmodel=medium -fastsse -Mipa=fast -mp=nonuma -lfftw3f -lfftw3f_threads -mp -lm' \
-		PROGRAM='spider-pgi-openmp' \
-		build
-
-%.o: %.f
-	$(FC) $(FCFLAGS) -c $< -o $@@
-
-clean:
-	-rm -f *.o *.mod
-
-distclean: clean
-	-rm -f spider spider-openmp spider-openmpi spider-mpich2
-
-install: spider spider_mp spider_mpi
-	$(INSTALL_PROGRAM) spider $(DESTDIR)$(bindir)/spider
-	$(INSTALL_PROGRAM) spider-openmp  $(DESTDIR)$(bindir)/spider-openmp
-	$(INSTALL_PROGRAM) spider-openmpi $(DESTDIR)$(bindir)/spider-openmpi
-	$(INSTALL_PROGRAM) spider-mpich2  $(DESTDIR)$(bindir)/spider-mpich2
-
-install-strip:
-	$(MAKE) INSTALL_PROGRAM='$(INSTALL_PROGRAM) -s' install
-
-uninstall:
-	-rm -f $(DESTDIR)$(bindir)/spider
-	-rm -f $(DESTDIR)$(bindir)/spider-openmp
-	-rm -f $(DESTDIR)$(bindir)/spider-openmpi
-	-rm -f $(DESTDIR)$(bindir)/spider-mpich2
-@
-
-
-1.1
-log
-@Initial revision
-@
-text
-@a10 16
-EXCLUDE = \
-	alrq_ms_new.f \
-	extractline.f \
-	extractplane.f \
-	fitplane.f jnk.f \
-	lookup.f mrali_p.f \
-	outim.f \
-	paged.f \
-	pagedhdr.f \
-	prntxx.f \
-	putline3.f \
-	quadri_c.f \
-	radcomplete.f \
-	reversegrid32.f \
-	rots3_n.f \
-	test.f
-d72 1
-a72 1
-	$(INSTALL_PROGRAM) spider-openmp $(DESTDIR)$(bindir)/spider-openmp
-d74 1
-a74 1
-	$(INSTALL_PROGRAM) spider-mpich2 $(DESTDIR)$(bindir)/spider-mpich2
-@
diff --git src/Makefile_samples/RCS/Makefile_linux_mp_altix,v src/Makefile_samples/RCS/Makefile_linux_mp_altix,v
deleted file mode 100644
index 4f5d1b05..00000000
--- src/Makefile_samples/RCS/Makefile_linux_mp_altix,v
+++ /dev/null
@@ -1,141 +0,0 @@
-head	1.4;
-access;
-symbols
-	pre_fftwrings:1.4
-	pre_opfiles:1.2
-	src:1.2
-	best-code:1.1
-	x-named-regs:1.1
-	x:1.1
-	v13-00:1.1;
-locks; strict;
-comment	@# @;
-
-
-1.4
-date	2007.12.14.13.26.12;	author leith;	state Exp;
-branches;
-next	1.3;
-
-1.3
-date	2007.01.18.14.23.35;	author leith;	state Exp;
-branches;
-next	1.2;
-
-1.2
-date	2006.08.02.17.37.46;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	2005.10.19.16.49.24;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.4
-log
-@fftw3
-@
-text
-@# 
-# MAKEFILE FOR GNU/Linux SPIDER using FFTW on 2 or more processors on SGI ALTIX --
-# 
-#  PURPOSE: Creates 64 bit multi-processor SPIDER executable with FFTW3 for: SGI Altix 
-#           Output files have SGI native "byte order"
-#           FFTW3 is statically linked, uses OpenMP threads
-#           Uses Intel Fortran compiler
-#
-#  ArDean Leith -- 25 April 2003
-#
-#  NOTE:    You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
-#
-SHELL  = /bin/sh
-
-PGM    = spider
-
-WHICH  = linux_mpfftw_altix
-
-COMP   = /opt/intel_fc_80/bin/ifort   
-
-EXE    = $(PGM)_$(WHICH)$(SUFFIX)
-
-FFLAGS = -ftz -assume byterecl -i4 -72 -convert big_endian -w90 -openmp -cpp -DSP_MP -DSP_IFC -DSP_LIBFFTW3 $(QFFLAGS) -c   
-
-# Set location of FFTW3 libraries and static link for FFTW3
-LF     = -openmp -Bstatic $(QLFLAGS) 
-
-# Link with FFTW3 static libraries
-LINKLIBS  = -Bstatic -L../fftw/fftw3-altix/lib/ -lfftw3f -lfftw3f_threads -Bdynamic -lm
- 
-LIB       = $(EXE).a
- 
-AFLAGS    = r
-
-.PRECIOUS : ../bin/$(EXE) $(LIB) 
-
-include Makefile.inc
-
-include Makebody.inc
-
-@
-
-
-1.3
-log
-@fftw
-@
-text
-@d4 1
-a4 1
-#  PURPOSE: Creates 64 bit multi-processor SPIDER executable with FFTW for: SGI Altix 
-d6 2
-a7 1
-#           FFTW is statically linked, Threads not used as slower
-d23 1
-a23 1
-FFLAGS = -ftz -assume byterecl -i4 -72 -convert big_endian -w90 -openmp -cpp -DSP_MP -DSP_IFC -DSP_LIBFFTW -DSP_LIBFFTWMP $(QFFLAGS) -c   
-d25 2
-a26 3
-# Set location of fftw libraries and whether dynamic or static link
-#LF    = -openmp -lifport -L../fftw/fftw-altix/lib/ $(QLFLAGS) 
-LF     = -openmp -Bstatic -L../fftw/fftw-altix/lib/ $(QLFLAGS) 
-d28 2
-a29 2
-# Link with FFTW static libraries
-LINKLIBS = -Bstatic -lsfftw -lsrfftw -lsfftw_threads -lsrfftw_threads -Bdynamic -lm
-d31 1
-a31 1
-LIB      = $(EXE).a
-d33 1
-a33 1
-AFLAGS   = r
-@
-
-
-1.2
-log
-@fftw location
-@
-text
-@d6 1
-a6 1
-#           FFTW is statically linked
-@
-
-
-1.1
-log
-@renamed
-@
-text
-@d25 2
-a26 2
-#LF    = -openmp -lifport -L../fftw/fftw-linux-altix/lib/ $(QLFLAGS) 
-LF     = -openmp -Bstatic -L../fftw/fftw-linux-altix/lib/ $(QLFLAGS) 
-@
-
diff --git src/Makefile_samples/RCS/Makefile_linux_mp_altixd,v src/Makefile_samples/RCS/Makefile_linux_mp_altixd,v
deleted file mode 100644
index e547aa09..00000000
--- src/Makefile_samples/RCS/Makefile_linux_mp_altixd,v
+++ /dev/null
@@ -1,67 +0,0 @@
-head	1.1;
-access;
-symbols
-	pre_fftwrings:1.1
-	pre_opfiles:1.1
-	src:1.1
-	best-code:1.1
-	x-named-regs:1.1
-	x:1.1
-	v13-00:1.1;
-locks; strict;
-comment	@# @;
-
-
-1.1
-date	2005.10.19.16.49.18;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.1
-log
-@renamed
-@
-text
-@# 
-#  MAKEFILE FOR SGI ALTIX SPIDER with debugger active
-# 
-#  PURPOSE: Creates 64 bit multi-processor SPIDER executable with FFTW for: SGI Altix 
-#           Output files have SGI native "byte order"
-#           FFTW is statically linked
-#
-#  ArDean Leith -- 25 April 2003
-#
-#  NOTE:    You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
-#
-SHELL  = /bin/sh
-
-COMP   = /opt/intel_fc_80/bin/ifort   
-
-PGM    = spider
-
-FFLAGS = -ftz -assume byterecl -i4 -72 -convert big_endian -w90 -DSP_MP -g -openmp -cpp -DSP_IFC -DSP_LIBFFTW -DSP_LIBFFTWMP $(QFFLAGS) -c   
-
-# set location of fftw libraries and whether dynamic or static link
-LF     =  -g -openmp -Bstatic -L/net/bali/usr1/fftw-altix/lib/ $(QLFLAGS) 
-
-# link with FFTW static libraries
-LINKLIBS = -Bstatic -lsfftw -lsrfftw -lsfftw_threads -lsrfftw_threads -Bdynamic -lm
- 
-EXE    = spider_linux_mpfftw_altixd
-
-LIB    = $(EXE).a
- 
-AFLAGS = r
-
-.PRECIOUS :  $(LIB) ../bin/$(EXE)
-
-include Makefile.inc
-
-include Makebody.inc
-
-@
diff --git src/Makefile_samples/RCS/Makefile_linux_mp_ibm,v src/Makefile_samples/RCS/Makefile_linux_mp_ibm,v
deleted file mode 100644
index e366553b..00000000
--- src/Makefile_samples/RCS/Makefile_linux_mp_ibm,v
+++ /dev/null
@@ -1,75 +0,0 @@
-head	1.1;
-access;
-symbols
-	pre_fftwrings:1.1
-	pre_opfiles:1.1
-	src:1.1
-	best-code:1.1
-	x-named-regs:1.1
-	x:1.1
-	v13-00:1.1;
-locks; strict;
-comment	@# @;
-
-
-1.1
-date	2005.10.17.16.35.46;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.1
-log
-@from ibm
-@
-text
-@# 
-# ------ MAKEFILE FILE FOR IBM SP UNIX SPIDER ----------- F90
-# 
-# Notes: 
-#       The commands for ELEMENTS may be necessary
-#       To create  executable:   make -f Makefile_ibm ../bin/spider_ibm
-
-
-# native mode on IBM SP machine with no parallel stuff
-FFLAGS   =  -qarch=auto -qfixed=80 -qnosave -c
-
-LFLAGS   =  -L/vol/apps/MASS42/mass/4.2/sles9/lib -lmass -L/vol/stcfs/rchen/NAMD/fftw.xlc32-lop/lib -lsrfftw -lsfftw -lm -qarch=auto -qnosave
-
-CPPFLAGS = -DSP_IBMSP3 -DSP_LIBFFTW
-
-COMP     = xlf90 -O5
-
-CPP      = /opt/ibmcmp/xlf/9.1/exe/cpp
-
-PGM    = spider_ibm_fftw
-
-LIB    = $(PGM).a
-
-SRC    = spider
-
-.PRECIOUS :   $(LIB) ../bin/$(PGM)
-
-include Makefile.inc
-
-../bin/$(PGM) : $(PGM).o $(LIB)
-	@@echo linking ../bin/$(PGM)
-	$(COMP) $(LFLAGS) $(PGM).o $(LIB) -lc -o ../bin/$(PGM)
-
-$(PGM).o  : $(SRC).f
-	$(CPP)  $(CPPFLAGS) $(SRC).f $(SRC).F 
-	$(COMP) $(FFLAGS) -o $(PGM).o  $(SRC).F 
-
-$(LIB) :  $(ELEMENTS)
-	@@echo all object files placed in library
-
-$(ELEMENTS) : 
-	$(CPP) $(CPPFLAGS) $*.f $*.F 
-	$(COMP) $(FFLAGS) $*.F
-	$(AR) r $(LIB) $*.o
-	@@\rm $*.o $*.F
-@
diff --git src/Makefile_samples/RCS/Makefile_linux_mp_ifc,v src/Makefile_samples/RCS/Makefile_linux_mp_ifc,v
deleted file mode 100755
index 629a146c..00000000
--- src/Makefile_samples/RCS/Makefile_linux_mp_ifc,v
+++ /dev/null
@@ -1,136 +0,0 @@
-head	1.3;
-access;
-symbols
-	pre_fftwrings:1.1
-	pre_opfiles:1.1
-	src:1.1
-	best-code:1.1
-	x-named-regs:1.1
-	x:1.1
-	v13-00:1.1
-	pre_GPL:1.1;
-locks; strict;
-comment	@# @;
-
-
-1.3
-date	2009.11.30.16.14.39;	author leith;	state Exp;
-branches;
-next	1.2;
-
-1.2
-date	2008.11.03.17.43.37;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	2004.11.19.18.37.39;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.3
-log
-@removed -Dosf_ieee
-@
-text
-@# 
-# ------    MAKEFILE FOR GNU/Linux SPIDER using FFTW2 on 2 or more Intel 32 bit processors 
-#
-# USING:    Intel Fortran compiler 7.0 (ifc)
-# TARGET:   Intel IA32 (i386) running GNU/Linux 
-# IMAGES:   Optimal SPIDER image byte order:  Little-endian   (native) 
-#           To use non-native mode byte ordering on Intel IA32 GNU/Linux, define the
-#           environment variable F_UFMTENDIAN to "big".
-#
-# NOTE:     Uses FFTW 
-#           FFTW must be configured with: --enable-threads --enable-float --enable-type-prefix
-#
-# NOTE:     To create executable: make -f  Makefile_linuxmp_ifc
-#
-# NOTE:     All libraries are statically linked except libm, glibc & libpthread.
-#
-# NOTE:     You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
-#
-# NOTE:     Makefile modified for Intel Fortran compiler by Slaton Lipscomb
-
-SHELL    = /bin/sh
-
-PGM      = spider
-
-WHICH    = ifc
-
-COMP     = ifc
-
-#SUFFIX   = _
-
-EXE      = $(PGM)mp_linux$(WHICH)$(SUFFIX)
-
-FFLAGS   = -openmp -Vaxlib -parallel -O2 -WB -mp -fpp2 -auto -pc64 -c -cm -w95 -tpp7 -axW -DSP_LINUX -DSP_LIBFFTWMP -DSP_MP -DSP_IFC
-
-LIBDIR   = /usr/local/lib/
-
-LF       =  $(QLFLAGS)
-
-LIB      = spidermp_linuxifc.a
-
-AFLAGS   = r
-
-# link with FFTW shared libraries,  liblf supports > 2GB files
-LINKLIBS = -Bstatic -L$(LIBDIR) -lsrfftw_threads -lsfftw_threads -lsrfftw -lsfftw -lguide -lPEPCF90 -static-libcxa -Bdynamic -lpthread -lm
-
-.PRECIOUS :  ../bin/$(EXE) $(LIB) 
-
-include Makefile.inc
-include Makebody.inc
-
-@
-
-
-1.2
-log
-@*** empty log message ***
-@
-text
-@d33 1
-a33 1
-FFLAGS   = -openmp -Vaxlib -parallel -O2 -WB -mp -fpp2 -auto -pc64 -c -cm -w95 -tpp7 -axW -Dosf_ieee -DSP_LINUX -DSP_LIBFFTWMP -DSP_MP -DSP_IFC
-@
-
-
-1.1
-log
-@new
-@
-text
-@d2 1
-a2 3
-# ------  MAKEFILE FOR GNU/Linux SPIDER using FFTW on 2 or more processors --
-# 
-# Note:  To create executable: make -f Makefile_linuxmp_ifc
-d4 5
-a8 1
-# Using: Intel Fortran compiler 7.0 (ifc)
-d10 2
-a11 2
-# To use non-native mode byte ordering on Intel IA32 GNU/Linux, define the
-# environment variable F_UFMTENDIAN to "big".
-d13 1
-a13 2
-# FFTW must be configured with:  --enable-threads --enable-float --enable-shared --prefix=/usr/local/ --enable-type-prefix
-# Linux 7.4+++
-d15 1
-a15 1
-# All libraries are statically linked except libm, glibc & libpthread.
-d17 1
-a17 3
-# Note:    You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
-#
-# Makefile modified for Intel Fortran compiler by Slaton Lipscomb
-d19 2
-@
-
diff --git src/Makefile_samples/RCS/Makefile_linux_mp_ifc_p4,v src/Makefile_samples/RCS/Makefile_linux_mp_ifc_p4,v
deleted file mode 100644
index f55657d3..00000000
--- src/Makefile_samples/RCS/Makefile_linux_mp_ifc_p4,v
+++ /dev/null
@@ -1,98 +0,0 @@
-head	1.2;
-access;
-symbols
-	pre_fftwrings:1.1
-	pre_opfiles:1.1
-	src:1.1
-	best-code:1.1
-	x-named-regs:1.1
-	x:1.1
-	v13-00:1.1
-	pre_GPL:1.1
-	prec_CA:1.1;
-locks; strict;
-comment	@# @;
-
-
-1.2
-date	2009.11.30.16.13.04;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	2003.03.25.15.04.45;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.2
-log
-@removed -Dosf_ieee
-@
-text
-@# 
-# ------  MAKEFILE FOR GNU/Linux SPIDER using FFTW on 2 or more processors --
-# 
-# Note:  To create executable: make -f Makefile_linuxmp_ifc_p4
-#
-# Using: Intel Fortran compiler 7.0 (ifc)
-# Optimization: Pentium 4/Xeon ONLY
-#
-# To use non-native mode byte ordering on Intel IA32 GNU/Linux, define the
-# environment variable F_UFMTENDIAN to "big".
-#
-# FFTW must be configured with:  --enable-threads --enable-float --enable-shared --prefix=/usr/local/ --enable-type-prefix
-# Linux 7.4+++
-#
-# All libraries are statically linked except libm, glibc & libpthread.
-#
-# Note:    You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
-#
-# Makefile modified for Intel Fortran compiler by Slaton Lipscomb
-#
-SHELL    = /bin/sh
-
-PGM      = spider
-
-WHICH    = ifc
-
-COMP     = ifc
-
-SUFFIX   = _p4
-
-EXE      = $(PGM)mp_linux$(WHICH)$(SUFFIX)
-
-FFLAGS   = -openmp -Vaxlib -parallel -O2 -WB -mp -fpp2 -auto -pc64 -c -cm -w95 -tpp7 -xW  -DSP_LINUX -DSP_LIBFFTWMP -DSP_MP -DSP_IFC
-
-LIBDIR   = /usr/local/lib/
-
-LF       =  $(QLFLAGS)
-
-LIB      = spidermp_linuxifc.a
-
-AFLAGS   = r
-
-# link with FFTW shared libraries,  liblf supports > 2GB files
-LINKLIBS = -Bstatic -L$(LIBDIR) -lsrfftw_threads -lsfftw_threads -lsrfftw -lsfftw -lguide -lPEPCF90 -static-libcxa -Bdynamic -lm -lpthread
-
-.PRECIOUS :  ../bin/$(EXE) $(LIB) 
-
-include Makefile.inc
-include Makebody.inc
-
-@
-
-
-1.1
-log
-@Initial revision
-@
-text
-@d33 1
-a33 1
-FFLAGS   = -openmp -Vaxlib -parallel -O2 -WB -mp -fpp2 -auto -pc64 -c -cm -w95 -tpp7 -xW -Dosf_ieee -DSP_LINUX -DSP_LIBFFTWMP -DSP_MP -DSP_IFC
-@
diff --git src/Makefile_samples/RCS/Makefile_linux_mp_intel,v src/Makefile_samples/RCS/Makefile_linux_mp_intel,v
deleted file mode 100755
index e291a0fe..00000000
--- src/Makefile_samples/RCS/Makefile_linux_mp_intel,v
+++ /dev/null
@@ -1,672 +0,0 @@
-head	1.24;
-access;
-symbols
-	pre_fftwrings:1.13
-	pre_opfiles:1.11
-	src:1.11
-	best-code:1.7
-	x-named-regs:1.6
-	x:1.6
-	v13-00:1.6
-	pre_GPL:1.4
-	prec_CA:1.1;
-locks
-	leith:1.24; strict;
-comment	@# @;
-
-
-1.24
-date	2011.10.12.18.13.33;	author leith;	state Exp;
-branches;
-next	1.23;
-
-1.23
-date	2011.06.02.15.51.05;	author leith;	state Exp;
-branches;
-next	1.22;
-
-1.22
-date	2011.05.11.12.10.03;	author leith;	state Exp;
-branches;
-next	1.21;
-
-1.21
-date	2011.03.03.18.38.39;	author leith;	state Exp;
-branches;
-next	1.20;
-
-1.20
-date	2010.07.23.17.48.30;	author leith;	state Exp;
-branches;
-next	1.19;
-
-1.19
-date	2010.07.14.15.31.43;	author leith;	state Exp;
-branches;
-next	1.18;
-
-1.18
-date	2009.11.30.16.15.38;	author leith;	state Exp;
-branches;
-next	1.17;
-
-1.17
-date	2009.04.28.13.15.35;	author leith;	state Exp;
-branches;
-next	1.16;
-
-1.16
-date	2009.02.25.16.29.56;	author leith;	state Exp;
-branches;
-next	1.15;
-
-1.15
-date	2008.11.03.15.53.57;	author leith;	state Exp;
-branches;
-next	1.14;
-
-1.14
-date	2008.09.17.14.20.54;	author leith;	state Exp;
-branches;
-next	1.13;
-
-1.13
-date	2007.12.14.13.28.03;	author leith;	state Exp;
-branches;
-next	1.12;
-
-1.12
-date	2007.02.27.19.35.25;	author leith;	state Exp;
-branches;
-next	1.11;
-
-1.11
-date	2006.07.25.12.50.08;	author leith;	state Exp;
-branches;
-next	1.10;
-
-1.10
-date	2006.07.20.18.19.13;	author leith;	state Exp;
-branches;
-next	1.9;
-
-1.9
-date	2006.07.03.15.33.47;	author leith;	state Exp;
-branches;
-next	1.8;
-
-1.8
-date	2006.07.03.15.28.36;	author leith;	state Exp;
-branches;
-next	1.7;
-
-1.7
-date	2006.01.05.20.55.57;	author leith;	state Exp;
-branches;
-next	1.6;
-
-1.6
-date	2005.10.19.19.59.19;	author leith;	state Exp;
-branches;
-next	1.5;
-
-1.5
-date	2005.10.19.19.19.56;	author leith;	state Exp;
-branches;
-next	1.4;
-
-1.4
-date	2005.05.18.16.50.10;	author leith;	state Exp;
-branches;
-next	1.3;
-
-1.3
-date	2005.05.18.16.42.09;	author leith;	state Exp;
-branches;
-next	1.2;
-
-1.2
-date	2004.05.19.13.21.25;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	2003.04.07.19.04.36;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.24
-log
-@32 bit bug
-@
-text
-@# 
-# PURPOSE:  MAKEFILE FOR GNU/Linux SPIDER using FFTW3 on 2 or more processors 
-# 
-# COMPILER: Portland Group F95 
-# TARGET:   32 bit Pentium4 Xeon (Should also run on 64 bit Intel / x86_64 OK)
-# IMAGES:   Optimal SPIDER image byte order: Big-endian (SGI) (Non-native) 
-# USAGE:    make -f Makefile_linux_mp_intel 
-#
-# NOTE:     Uses FFTW3 configured with: --enable-float --enable-openmp
-# NOTE:     You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
-#
-# PGI Compile/link flags
-# -O2             : Invokes level 2 optimization (-O3 causes some run time problems with PGI compiler on SPIDER code)
-# -Kieee          : Invokes strict IEEE floating calculations
-# -mp             : Invokes multi processor support
-# -tp p6          : Targets 32 bit Pentium Pro/II/III with 32 bit memory addresses, supports x87 FP
-# -tp p7          : Targets 32 or 64 bit Pentium4 with 32 bit memory addresses, supports SSE1 & SSE2 FP
-# -tp p7-64       : Targets 64 bit Pentium4 with 64 bit memory addresses, supports SSE1, SSE2 & SSE3 FP
-# -tp x64         : Targets unified 64 bit AMD & Intel binaries (samoa)
-# -tp k8-64e      : Targets AMD Opteron Revision E or AMD Turion (cluster)
-# -Mipa=fast      : Invokes interprocedural analysis 
-# -fast           : Selects appropriate set of flags usually including -O2 -Munroll -Mnoframe
-# -fastsse        : Selects appropriate set of flags including SSE support and usually -O2 -Munroll -Mnoframe -Mvect=sse -Mcache_align 
-# -pc 64          : Sets precision of FPU operations
-# -mcmodel=medium : Allows use of >2GB data area 
-# -Bstatic_pgi    : Uses static PGI libs but makes dynamic executable
-# -Bstatic        : Static link 
-
-AFLAGS   = r
-
-SHELL    = /bin/sh
-
-# Location of PGI Fortran compiler  
-COMP     = /usr10/pgi/linux86/2011/bin/pgf95
-
-PGM      = spider
-
-WHICH    = mp_intel
-
-EXE      = $(PGM)_linux_$(WHICH)$(SUFFIX)
-
-LIB      = $(EXE).a
-
-#FFLAGS   = -O2 -Mpreprocess -tp p6 -fastsse -Mipa=fast -Kieee -Minfo -mp=nonuma -byteswapio -DHAS_IEEE -DSP_MP -DSP_LIBFFTW3 -c  
-FFLAGS   = -O2 -Mpreprocess -tp p7-32 -fastsse -Mipa=fast -Kieee -Minfo -mp=nonuma -byteswapio -DHAS_IEEE -DSP_MP -DSP_LIBFFTW3 -c  
-
-LF       = -tp p7-32 -fastsse -Mipa=fast -mp=nonuma $(QLFLAGS) 
-
-# Link with FFTW3 static libraries with threads and with math library
-FFTWLIBDIR = ../fftw/fftw3-intel/lib
-LINKLIBS   = -Bstatic -L$(FFTWLIBDIR) -lfftw3f -lfftw3f_threads -lm   
-
-.PRECIOUS :  ../bin/$(EXE) $(LIB) 
-
-include Makefile.inc
-
-include Makebody.inc
-
-@
-
-
-1.23
-log
-@32 bit executable bug fixed
-@
-text
-@d34 1
-a34 1
-COMP     = /usr10/pgi/linux86-64/2011/bin/pgf95
-@
-
-
-1.22
-log
-@-DHAS_IEEE
-@
-text
-@d44 2
-a45 1
-FFLAGS   = -O2 -Mpreprocess -tp p7 -fastsse -Mipa=fast -Kieee -Minfo -mp=nonuma -byteswapio -DHAS_IEEE -DSP_MP -DSP_LIBFFTW3 -c  
-d47 1
-a47 1
-LF       = -tp p7 -fastsse -Mipa=fast -mp=nonuma $(QLFLAGS) 
-d51 1
-a51 1
-LINKLIBS   = -Bstatic -L$(FFTWLIBDIR) -lfftw3f -lfftw3f_threads -lm    
-@
-
-
-1.21
-log
-@*** empty log message ***
-@
-text
-@d44 1
-a44 1
-FFLAGS   = -O2 -Mpreprocess -tp p7 -fastsse -Mipa=fast -Kieee -Minfo -mp=nonuma -byteswapio -DSP_MP -DSP_LIBFFTW3 -c  
-@
-
-
-1.20
-log
-@ $(PGM)_linux_$(WHICH)
-@
-text
-@d7 1
-d11 19
-a29 1
-# NOTE:     To create executable: make -f Makefile_linux_mp_intel
-d33 3
-a39 3
-# Location of PGI Fortran compiler
-COMP     = /usr10/pgi/linux86-64/8.0-4/bin/pgf95
-
-d42 1
-a42 12
-# -O2            : Invokes level 2 optimization (-O3 causes some run time problems with PGI compiler on SPIDER code)
-# -mp            : Invokes multi processor support
-# -mp=nonuma     : No numa library for Intel??
-# -tp p6         : Targets 32 bit Pentium Pro/II/III with 32 bit memory addresses, supports x87 FP
-# -tp p7         : Targets 32 or 64 bit Pentium4 with 32 bit memory addresses, supports SSE1 & SSE2 FP
-# -tp p7-64      : Targets 64 bit Pentium4 with 64 bit memory addresses, supports SSE1, SSE2 & SSE3 FP
-# -tp x64        : Targets unified 64 bit AMD & Intel binaries
-# -Mipa=fast     : Invokes interprocedural analysis (some routines fail to compile)
-# -fast          : Selects an appropriate set of optimization flags usually including -O2 -Munroll -Mnoframe
-# -fastsse       : Selects an appropriate set of flags including SSE support usually including -O2 -Munroll -Mnoframe -Mvect=sse -Mcache_align 
-# -pc 64         : Sets precision of FPU operations
-#-mcmodel=medium : Allows use of >2GB data area on 64 bit machines
-d44 1
-a44 1
-FFLAGS = -O2 -Mpreprocess -tp p7 -fastsse -Mipa=fast -Kieee -Minfo -mp=nonuma -byteswapio -DSP_MP -DSP_LIBFFTW3 -c  
-d46 1
-a46 1
-LF     = -tp p7 -fastsse -Mipa=fast -mp=nonuma $(QLFLAGS) 
-d48 1
-a48 1
-# FFTW3 static library location
-d50 1
-a50 7
-
-LIB      = $(EXE).a
-
-AFLAGS   = r
-
-# Link with FFTW3 static libraries with threads and with math library
-LINKLIBS = -Bstatic -L$(FFTWLIBDIR) -lfftw3f -lfftw3f_threads -lm    
-@
-
-
-1.19
-log
-@cosmetic
-@
-text
-@d21 1
-a21 1
-EXE      = $(PGM)_linux$_(WHICH)$(SUFFIX)
-@
-
-
-1.18
-log
-@removed -Dosf_ieee
-@
-text
-@d2 1
-a2 2
-# MAKEFILE FOR GNU/Linux SPIDER using FFTW on 2 or more processors --
-# FOR: 32 bit Pentium4 Xeon (Should also run on 64 bit Intel / x86_64 OK)
-d4 3
-a6 1
-# Note:  To create executable: make -f Makefile_linux_mp_intel
-d8 3
-a10 5
-# Using: Portland Group F90 compiler
-#        Non-native mode byte ordering on:  Intel IA32 GNU/Linux 
-#        FFTW must be configured with:  --enable-float  --enable-openmp
-#
-# Note:    You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
-d16 1
-a16 1
-WHICH    = _mp_intel
-d18 2
-a19 3
-# Location of Fortran compiler for PGI/8.0-4
-#COMP    = /scratch/pgi/linux86-64/8.0-4/bin/pgf95
-COMP     = pgf95
-d21 1
-a21 1
-EXE      = $(PGM)_linux$(WHICH)$(SUFFIX)
-d25 1
-a34 1
-#-mp=nonuma      : No numa library for Intel??
-d36 1
-a36 1
-FFLAGS = -O2 -Mpreprocess -tp p7 -fastsse  -Mipa=fast -Kieee -Minfo -mp=nonuma -byteswapio -DSP_MP -DSP_LIBFFTW3 -c  
-d40 1
-a40 1
-# FFTW library location
-d47 1
-a47 2
-# Link with FFTW static libraries and with math library
-
-@
-
-
-1.17
-log
-@*** empty log message ***
-@
-text
-@d38 1
-a38 1
-FFLAGS = -O2 -Mpreprocess -tp p7 -fastsse  -Mipa=fast -Kieee -Minfo -mp=nonuma -byteswapio -Dosf_ieee -DSP_MP -DSP_LIBFFTW3 -c  
-@
-
-
-1.16
-log
-@COMP
-@
-text
-@d9 1
-a9 5
-#        FFTW must be configured with:  --enable-float  --enable-type-prefix
-#        We use FFTW without threads as it is usually slower using threads for
-#        multiple processors in our testing (June 05 al)
-#
-# All libraries are statically linked except libm, glibc & libpthread.
-d17 1
-a17 3
-WHICH    = _mp
-
-SUFFIX   = _intel
-d19 1
-a19 2
-#COMP    = /usr/pgi/linux86-64/7.1/bin/pgf95
-#COMP    = /usr/pgi7.2/linux86-64/7.2-5/bin/pgf95
-d38 1
-a38 1
-FFLAGS   = -O2 -Mpreprocess -tp p7 -fastsse  -Mipa=fast -Kieee -Minfo -mp=nonuma -byteswapio -Dosf_ieee -DSP_MP -DSP_LIBFFTW3 -c  
-d40 1
-a40 1
-LF       = -tp p7 -fastsse -Mipa=fast -mp=nonuma $(QLFLAGS) 
-d43 1
-a43 1
-FFTWLIBDIR   = ../fftw/fftw3-intel/lib
-@
-
-
-1.15
-log
-@removed fftw in name
-@
-text
-@d26 3
-a28 1
-COMP     = /usr/pgi7.2/linux86-64/7.2-5/bin/pgf95
-@
-
-
-1.14
-log
-@/usr/pgi7.2
-@
-text
-@d3 1
-a3 1
-# For: 32 bit Pentium4 Xeon (Should also run on 64 bit Intel OK)
-d5 1
-a5 1
-# Note:  To create executable: make -f Makefile_linux_mpfftw_intel
-d21 1
-a21 1
-WHICH    = _mpfftw
-@
-
-
-1.13
-log
-@fftw3
-@
-text
-@d25 2
-a26 1
-COMP     = /usr/pgi/linux86-64/7.1/bin/pgf95
-@
-
-
-1.12
-log
-@FFTWLIBDIR   = ../fftw/fftw-intel32/lib
-@
-text
-@d3 1
-a3 1
-# For: 32 bit Pentium4 Xeon (should also run on 64 bit Intel OK)
-d13 1
-a13 1
-# All libraries are statically linked exceptlibm, glibc & libpthread.
-d25 1
-a25 1
-COMP     = /usr/pgi/linux86-64/6.1/bin/pgf95
-d40 1
-a40 1
-FFLAGS   = -O2 -Mpreprocess -tp p7 -fastsse  -Mipa=fast -Kieee -Minfo -mp -byteswapio -Dosf_ieee -DSP_MP -DSP_LIBFFTW -c  
-d42 3
-a44 1
-LF       = -tp p7 -fastsse -Mipa=fast -mp $(QLFLAGS) 
-d47 1
-a47 1
-FFTWLIBDIR   = ../fftw/fftw-intel32/lib
-d53 1
-a53 2
-# Link with FFTW static libraries without threads and with math library
-# Links in: linux-gate.so.1, libm.so.6, libpthread.so.0,  libc.so.6,  libpgc.so,  ld-linux.so.2  
-d55 1
-a55 1
-LINKLIBS = -Bstatic -L$(FFTWLIBDIR) -lsrfftw -lsfftw -L/usr/pgi/linux86/6.1/lib -lm    
-@
-
-
-1.11
-log
-@faster?
-@
-text
-@d45 1
-a45 1
-FFTWLIBDIR   = ../fftw/fftw-intel/lib
-@
-
-
-1.10
-log
-@for pgi 6.2
-@
-text
-@d3 1
-a12 2
-# Optimization: 32 bit Pentium4 Xeon (should also run on 64 bit Intel OK)
-#
-d35 1
-a35 1
-# -Mipa=fast     : Invokes interprocedural analysis 
-d39 2
-a40 2
-#-mcmodel=medium : Allows use of >2GB data area 
-FFLAGS   = -O2 -Mpreprocess -Mipa=fast -tp p7 -fastsse -Kieee -Minfo -mp -byteswapio -Dosf_ieee -DSP_MP -DSP_LIBFFTW -c  
-d42 1
-a42 1
-LF       = -Mipa=fast -tp p7 -fastsse -mp $(QLFLAGS) 
-@
-
-
-1.9
-log
-@ link with -tp p6
-@
-text
-@d9 2
-d12 1
-a12 1
-# Optimization: 32 bit Pentium Pro/II/III and AthlonXP with Xeon
-d14 1
-a14 1
-# All libraries are statically linked except libm, glibc & libpthread.
-d26 1
-a26 1
-COMP     = pgf90
-d30 14
-a43 3
-# O3 causes some problems with PGI compiler on SPIDER code
-# Compile with multi processor support
-FFLAGS   = -O2 -Mpreprocess -tp p6 -Mcache_align -Mvect=sse -Kieee -pc 64 -Minfo -mp -byteswapio -Dosf_ieee -DSP_MP -DSP_LIBFFTW  -c  
-d46 1
-a46 3
-FFTWLIBDIR   = ../fftw/fftw-linux-intel/lib
-
-LF       = -mp -tp p6 $(QLFLAGS) 
-d52 4
-a55 2
-# Link with FFTW static libraries and math library
-LINKLIBS =   -L$(FFTWLIBDIR) -Bstatic -lsrfftw -lsfftw -lm
-@
-
-
-1.8
-log
-@ link with -tp p6
-@
-text
-@d35 1
-a35 1
-LF       = -mp ptp p6 $(QLFLAGS) 
-@
-
-
-1.7
-log
-@static libs
-@
-text
-@d8 1
-a8 1
-#        FFTW must be configured with:  --enable-float --enable-shared  --enable-type-prefix
-d10 1
-a10 1
-# Optimization: Pentium 4/Xeon ONLY
-d28 1
-a28 1
-# O3 seems to cause some problems with PGI compiler on SPIDER code
-d35 1
-a35 1
-LF       = -mp $(QLFLAGS) 
-@
-
-
-1.6
-log
-@lib
-@
-text
-@d8 1
-a8 1
-#        FFTW must be configured with: --enable-threads --enable-float --enable-shared --prefix=/usr/local/ --enable-type-prefix
-d15 1
-a15 1
-#
-d41 2
-a42 5
-# link with FFTW shared libraries with threaded support (INACTIVE)
-LINKLIBS =   -L$(FFTWLIBDIR) -lsrfftw_threads -lsfftw_threads -lsrfftw -lsfftw -lm
-
-# link with FFTW static libraries without threads
-LINKLIBS =   -L$(FFTWLIBDIR) -lsrfftw -lsfftw -lm
-@
-
-
-1.5
-log
-@fftw_loc
-@
-text
-@d33 1
-a33 1
-FFTWLIBDIR   = ../fftw/fftw-linux/lib
-@
-
-
-1.4
-log
-@for PGI 6.0
-@
-text
-@d2 1
-a2 1
-# ------  MAKEFILE FOR GNU/Linux SPIDER using FFTW on 2 or more processors --
-d28 3
-a30 1
-FFLAGS   = -O2 -Mpreprocess -tp p6  -Mcache_align -Mvect=sse -Kieee -pc 64 -Minfo -mp -byteswapio -Dosf_ieee -DSP_MP -DSP_LIBFFTW -DSP_LIBFFTWMP -c  
-d32 2
-a33 1
-LIBDIR   = /usr/local/lib/
-d41 5
-a45 2
-# link with FFTW shared libraries,  iblf supports > 2GB files
-LINKLIBS =   -L$(LIBDIR) -lsrfftw_threads -lsfftw_threads -lsrfftw -lsfftw -lm
-@
-
-
-1.3
-log
-@latest from cluster
-@
-text
-@d32 1
-a32 1
-LF       =  $(QLFLAGS) 
-d39 1
-a39 1
-LINKLIBS =   -L$(LIBDIR) -lsrfftw_threads -lsfftw_threads -lsrfftw -lsfftw -lpgmp -lpthread -lm
-@
-
-
-1.2
-log
-@*** empty log message ***
-@
-text
-@d2 1
-a2 1
-# ---  MAKEFILE FOR PGI Compiled GNU/Linux SPIDER using FFTW on 2 or more processors --
-d12 1
-a12 1
-# All libraries are statically linked except libm,libpgmp, & the FFTW libraries (.
-d28 1
-a28 1
-FFLAGS   = -O2 -Mpreprocess -tp p6 -Mcache_align -Mvect=sse -Kieee -pc 64 -Minfo -mp -byteswapio -Dosf_ieee -DSP_MP -DSP_LIBFFTW -DSP_LIBFFTWMP -c  
-d38 2
-a39 2
-# link with FFTW shared libraries
-LINKLIBS =  -L$(LIBDIR) -lsrfftw_threads -lsfftw_threads -lsrfftw -lsfftw -lpgmp -lpthread -lm
-@
-
-
-1.1
-log
-@Initial revision
-@
-text
-@d2 1
-a2 1
-# ------  MAKEFILE FOR GNU/Linux SPIDER using FFTW on 2 or more processors --
-d12 1
-a12 1
-# All libraries are statically linked except libm, glibc & libpthread.
-d28 1
-a28 1
-FFLAGS   = -O2 -Mpreprocess -tp p6  -Mcache_align -Mvect=sse -Kieee -pc 64 -Minfo -mp -byteswapio -Dosf_ieee -DSP_MP -DSP_LIBFFTW -DSP_LIBFFTWMP -c  
-d38 2
-a39 2
-# link with FFTW shared libraries,  iblf supports > 2GB files
-LINKLIBS =   -L$(LIBDIR) -lsrfftw_threads -lsfftw_threads -lsrfftw -lsfftw -lpgmp -lpthread -lm
-@
diff --git src/Makefile_samples/RCS/Makefile_linux_mp_intel64,v src/Makefile_samples/RCS/Makefile_linux_mp_intel64,v
deleted file mode 100644
index cd0f2ce0..00000000
--- src/Makefile_samples/RCS/Makefile_linux_mp_intel64,v
+++ /dev/null
@@ -1,194 +0,0 @@
-head	1.4;
-access;
-symbols;
-locks
-	leith:1.4; strict;
-comment	@# @;
-
-
-1.4
-date	2011.05.11.12.10.12;	author leith;	state Exp;
-branches;
-next	1.3;
-
-1.3
-date	2011.03.03.18.38.39;	author leith;	state Exp;
-branches;
-next	1.2;
-
-1.2
-date	2010.07.14.15.31.34;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	2009.11.30.16.11.02;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.4
-log
-@-DHAS_IEEE
-@
-text
-@# 
-# PURPOSE:  MAKEFILE FOR GNU/Linux SPIDER using FFTW3 on 2 or more processors 
-# 
-# COMPILER: Portland Group F95 
-# TARGET:   64bit Intel Pentium4 running GNU/Linux  
-# IMAGES:   Optimal SPIDER image byte order: Big-endian (SGI) (Non-native) 
-# USAGE:    make -f Makefile_linux_mp_intel64
-#
-# NOTE:     Uses FFTW3 configured with: --enable-float --enable-openmp
-# NOTE:     You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
-# NOTE:     To create executable: make -f Makefile_linux_mp_intel64
-#
-# PGI Compile/link flags
-# -O2             : Invokes level 2 optimization (-O3 causes some run time problems with PGI compiler on SPIDER code)
-# -Kieee          : Invokes strict IEEE floating calculations
-# -mp             : Invokes multi processor support
-# -tp p6          : Targets 32 bit Pentium Pro/II/III with 32 bit memory addresses, supports x87 FP
-# -tp p7          : Targets 32 or 64 bit Pentium4 with 32 bit memory addresses, supports SSE1 & SSE2 FP
-# -tp p7-64       : Targets 64 bit Pentium4 with 64 bit memory addresses, supports SSE1, SSE2 & SSE3 FP
-# -tp x64         : Targets unified 64 bit AMD & Intel binaries  
-# -tp k8-64e      : Targets AMD Opteron Revision E or AMD Turion (cluster)
-# -Mipa=fast      : Invokes interprocedural analysis 
-# -fast           : Selects appropriate set of flags usually including -O2 -Munroll -Mnoframe
-# -fastsse        : Selects appropriate set of flags including SSE support and usually -O2 -Munroll -Mnoframe -Mvect=sse -Mcache_align 
-# -pc 64          : Sets precision of FPU operations
-# -mcmodel=medium : Allows use of >2GB data area 
-# -Bstatic_pgi    : Uses static PGI libs but makes dynamic executable
-# -Bstatic        : Static link 
-
-SHELL    = /bin/sh
-
-AFLAGS   = r
-
-# Location of PGI Fortran compiler  
-COMP     = /usr10/pgi/linux86-64/2011/bin/pgf95
-
-PGM      = spider
-
-WHICH    = mp_intel64
-
-EXE      = $(PGM)_linux_$(WHICH)$(SUFFIX)
-
-LIB      = $(EXE).a
-
-FFLAGS   = -tp p7-64 -mcmodel=medium -fastsse -Mipa=fast -mp=nonuma -O2 -Mpreprocess -Kieee -Minfo -byteswapio -DHAS_IEEE -DSP_MP -DSP_LIBFFTW3 -c  
-
-LF       = -tp p7-64 -mcmodel=medium -fastsse -Mipa=fast -mp=nonuma $(QLFLAGS)
-
-# Link with FFTW3 static libraries with threads and with math library
-FFTWLIBDIR = ../fftw/fftw3-intel64/lib
-LINKLIBS   = -Bstatic -L$(FFTWLIBDIR) -lfftw3f -lfftw3f_threads -mp -lm
-
-.PRECIOUS : ../bin/$(EXE) $(LIB) 
-
-include Makefile.inc
-
-include Makebody.inc
-
-@
-
-
-1.3
-log
-@*** empty log message ***
-@
-text
-@d45 1
-a45 1
-FFLAGS   = -tp p7-64 -mcmodel=medium -fastsse -Mipa=fast -mp=nonuma -O2 -Mpreprocess -Kieee -Minfo -byteswapio -DSP_MP -DSP_LIBFFTW3 -c  
-@
-
-
-1.2
-log
-@*** empty log message ***
-@
-text
-@d7 1
-d12 2
-a13 12
-
-SHELL    = /bin/sh
-
-PGM      = spider
-
-WHICH    = mp_intel64
-
-# Location of PGI Fortran compiler
-COMP     = /usr10/pgi/linux86-64/8.0-4/bin/pgf95
-
-EXE      = $(PGM)_linux_$(WHICH)$(SUFFIX)
-
-d15 1
-d20 2
-a21 1
-# -tp x64         : Targets unified 64 bit AMD & Intel binaries (samoa)
-d23 2
-a24 2
-# -fast           : Selects an appropriate set of optimization flags usually including -O2 -Munroll -Mnoframe
-# -fastsse        : Selects an appropriate set of flags including SSE support usually including -O2 -Munroll -Mnoframe -Mvect=sse -Mcache_align 
-d27 4
-a30 1
-#-mp=nonuma       : No numa library for Intel
-d32 1
-a32 1
-FFLAGS = -O2 -Mpreprocess -tp p7-64 -mcmodel=medium -fastsse -Mipa=fast -mp=nonuma -Kieee -Minfo -byteswapio -DSP_MP -DSP_LIBFFTW3 -c  
-d34 8
-a41 2
-# Link with multi processor support
-LF  = -tp p7-64 -mcmodel=medium -fastsse -Mipa=fast -mp=nonuma $(QLFLAGS)
-d43 1
-a43 2
-# FFTW3 static library location 
-FFTWLIBDIR   = ../fftw/fftw3-intel64/lib
-d45 1
-a45 1
-LIB    = $(EXE).a
-d47 1
-a47 1
-AFLAGS = r
-d50 2
-a51 1
-LINKLIBS  = -Bstatic -L$(FFTWLIBDIR) -lfftw3f -lfftw3f_threads -mp -lm
-@
-
-
-1.1
-log
-@Initial revision
-@
-text
-@d2 1
-a2 1
-# ------    MAKEFILE FOR GNU/Linux SPIDER using FFTW3 on 2 or more processors on Opteron 64--
-d4 3
-a6 3
-# USING:    Portland Group F90 compiler
-# TARGET:   64bit Intel Pentium running GNU/Linux  
-# IMAGES:   Optimal SPIDER image byte order:   Big-endian (SGI) (Non-native) 
-d9 1
-a9 3
-#
-# NOTE:     You may ignore any undefined  QLFLAGS & SUFFIX
-#
-d18 2
-a19 3
-# Location of Fortran compiler for PGI/8.0-4
-#COMP    = /scratch/pgi/linux86-64/8.0-4/bin/pgf95
-COMP     = pgf95
-d41 1
-a41 1
-# FFTW library location 
-d48 1
-a48 1
-# Link with FFTW static libraries with threads and with math library
-@
diff --git src/Makefile_samples/RCS/Makefile_linux_mp_intel64.ifort,v src/Makefile_samples/RCS/Makefile_linux_mp_intel64.ifort,v
deleted file mode 100755
index 3bfaef3b..00000000
--- src/Makefile_samples/RCS/Makefile_linux_mp_intel64.ifort,v
+++ /dev/null
@@ -1,128 +0,0 @@
-head	1.2;
-access;
-symbols;
-locks; strict;
-comment	@# @;
-
-
-1.2
-date	2012.06.11.16.52.02;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	2012.05.02.12.28.38;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.2
-log
-@*** empty log message ***
-@
-text
-@# 
-# ------    MAKEFILE FOR GNU/Linux SPIDER using FFTW2 on 2 or more Intel 64 bit processors 
-# SOURCE:   /usr8/spider/src/ifort/Makefile_linux_mp_intel64.ifort
-# USING:    Intel Fortran compiler 11.? ifort
-# TARGET:   Intel  running GNU/Linux 
-# IMAGES:   Optimal SPIDER image byte order: Big-endian (SGI) (Non-native)
-# NOTE:     Uses FFTW3 configured with: --enable-float --enable-openmp
-# USAGE:    !!! IN SEPERATE DIR TO AVOID MOD PROBLEMS!!!!!!!!!
-#           source /usr8/repository/intelf90/bin/compilervars.csh intel64
-#           make -f  Makefile_linux_mp_intel64.ifort
-# TEST      stest ; $spib/spider_linux_mp_intel64_ifort tst @@testinfra
-
-SHELL   = /bin/sh
-
-# Location of Intel Fortran compiler: /usr8/repository/intelf90/bin
-COMP    = ifort
-
-PGM     = spider
-
-WHICH   = mp_intel64_ifort
-
-EXE     = $(PGM)_linux_$(WHICH)
-
-#FFLAGS = -openmp -Vaxlib         -parallel -O2 -WB -mp -fpp2 -auto -pc64 -cm -w95 -axW  -DSP_LINUX -DSP_MP -c
-#FFLAGS = -assume byterecl  -openmp -mcmodel=medium -parallel -O2 -WB  -fpp2 -auto  -static -arch sse2 -DSP_LINUX -DSP_MP -c -fixed -convert big_endian 
-FFLAGS  = -assume byterecl  -openmp -mcmodel=medium -parallel -O2 -WB  -fpp2 -auto  -static            -DSP_LINUX -DSP_MP -c -fixed -convert big_endian 
-
-LF      =  -static 
-
-LIB     = $(EXE).a
-
-AFLAGS  = r
-
-# Link with FFTW3 static libraries with threads and with math library
-FFTWLIBDIR = ../../fftw/fftw3-intel64-icc/lib
-LINKLIBS   = -static -L$(FFTWLIBDIR) -lfftw3f -lfftw3f_threads -openmp -lm
-
-.PRECIOUS :  ../bin/$(EXE) $(LIB) 
-
-include Makefile.inc
-
-include Makebody.inc
-
-
-
-
-
-
-                        
-@
-
-
-1.1
-log
-@Initial revision
-@
-text
-@d3 1
-a3 1
-#
-a6 2
-# USAGE:    make -f Makefile_linux_mp_ifort  IN SEPERATE DIR TO AVOID MOD PROBLEMS!!!!!!!!!
-#
-d8 4
-a11 3
-#
-# NOTE:     To create executable: source /usr8/repository/intelf90/bin/compilervars.csh intel64
-#                                 make -f  Makefile_linux_mp_intel64.ifort
-d13 1
-a13 1
-SHELL    = /bin/sh
-d16 1
-a16 1
-COMP     = ifort
-d18 1
-a18 1
-PGM      = spider
-d20 1
-a20 1
-WHICH    = mp_intel64_ifort
-d22 1
-a22 1
-EXE      = $(PGM)_linux_$(WHICH)
-d24 3
-a26 2
-#FFLAGS  = -openmp -Vaxlib         -parallel -O2 -WB -mp -fpp2 -auto -pc64 -cm -w95 -axW  -DSP_LINUX -DSP_MP -c
-FFLAGS   = -assume byterecl -fast -openmp -mcmodel=medium -parallel -O2 -WB     -fpp2 -auto   -static -arch sse2 -DSP_LINUX -DSP_MP -c -fixed -convert big_endian 
-d28 1
-a28 1
-LF       =  -static 
-d30 1
-a30 1
-LIB      = $(EXE).a
-d32 1
-a32 1
-AFLAGS   = r
-d35 1
-a35 1
-FFTWLIBDIR = ../fftw/fftw3-intel64/lib
-d43 1
-@
diff --git src/Makefile_samples/RCS/Makefile_linux_mp_intel_nat,v src/Makefile_samples/RCS/Makefile_linux_mp_intel_nat,v
deleted file mode 100755
index e5f83357..00000000
--- src/Makefile_samples/RCS/Makefile_linux_mp_intel_nat,v
+++ /dev/null
@@ -1,135 +0,0 @@
-head	1.3;
-access;
-symbols
-	pre_fftwrings:1.1
-	pre_opfiles:1.1
-	src:1.1;
-locks; strict;
-comment	@# @;
-
-
-1.3
-date	2008.11.03.16.55.45;	author leith;	state Exp;
-branches;
-next	1.2;
-
-1.2
-date	2008.11.03.15.54.08;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	2006.11.20.17.23.35;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.3
-log
-@*** empty log message ***
-@
-text
-@# 
-# --------  MAKEFILE FOR GNU/Linux SPIDER using FFTW3 on Intel 64 with 2 or more processors
-#
-# USING:    Portland Group F90 compiler
-# TARGET:   Intel Pentiume 4/Xeon IA32 (i386) running GNU/Linux 
-# IMAGES:   Optimal SPIDER image byte order:   little-endian (native) 
-#
-# NOTE:     Uses FFTW3 
-# NOTE:     FFTW3 must be configured with: --enable-float --enable-type-prefix
-#
-# NOTE:     To create executable: make -f Makefile_linux_mp_intel_nat
-#
-# NOTE:     All libraries are statically linked.
-#
-# NOTE:     You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
-
-SHELL    = /bin/sh
-
-PGM      = spider
-
-WHICH    = _mp
-
-SUFFIX   = _intel_nat
-
-COMP     = pgf90
-
-EXE      = $(PGM)_linux$(WHICH)$(SUFFIX)
-
-# O3 seems to cause some problems with PGI compiler on SPIDER code
-# Compile with multi processor support
-FFLAGS   = -O2 -Mpreprocess -tp p6 -Mcache_align -Mvect=sse -Kieee -pc 64 -Minfo -mp -DSP_MP -DSP_LIBFFTW -c  
-
-# FFTW library location
-FFTWLIBDIR   = ../fftw/fftw-linux-intel/lib
-
-LF       = -mp $(QLFLAGS) 
-
-LIB      = $(EXE).a
-
-AFLAGS   = r
-
-# link with FFTW shared libraries with threaded support (INACTIVE)
-#LINKLIBS =   -L$(FFTWLIBDIR) -lsrfftw_threads -lsfftw_threads -lsrfftw -lsfftw -lm
-
-# link with FFTW static libraries without threads
-LINKLIBS =   -L$(FFTWLIBDIR) -Bstatic -lsrfftw -lsfftw -lm
-
-.PRECIOUS :  ../bin/$(EXE) $(LIB) 
-
-include Makefile.inc
-
-include Makebody.inc
-
-@
-
-
-1.2
-log
-@removed fftw in name
-@
-text
-@d2 1
-a2 3
-# MAKEFILE FOR GNU/Linux SPIDER using FFTW on 2 or more processors --
-# 
-# Note:  To create executable: make -f Makefile_linux_mp_intel
-d4 3
-a6 3
-# Using: Portland Group F90 compiler
-#        Native mode byte ordering on:  Intel IA32 GNU/Linux 
-#        FFTW must be configured with: --enable-threads --enable-float --enable-type-prefix
-d8 2
-a9 1
-# OPTIMIZATION: Pentium 4/Xeon ONLY
-d11 1
-a11 1
-# All libraries are statically linked.
-d13 1
-a13 1
-# Note:    You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
-d15 2
-@
-
-
-1.1
-log
-@new
-@
-text
-@d4 1
-a4 1
-# Note:  To create executable: make -f Makefile_linux_mpfftw_intel
-d10 1
-a10 1
-# Optimization: Pentium 4/Xeon ONLY
-d20 1
-a20 1
-WHICH    = _mpfftw
-@
-
diff --git src/Makefile_samples/RCS/Makefile_linux_mp_opt64,v src/Makefile_samples/RCS/Makefile_linux_mp_opt64,v
deleted file mode 100644
index 9a10d1bb..00000000
--- src/Makefile_samples/RCS/Makefile_linux_mp_opt64,v
+++ /dev/null
@@ -1,694 +0,0 @@
-head	1.21;
-access;
-symbols
-	pre_fftwrings:1.12
-	pre_opfiles:1.8
-	src:1.8
-	best-code:1.5
-	x-named-regs:1.5
-	x:1.5
-	v13-00:1.5
-	pre_GPL:1.3;
-locks; strict;
-comment	@# @;
-
-
-1.21
-date	2011.05.11.12.09.53;	author leith;	state Exp;
-branches;
-next	1.20;
-
-1.20
-date	2011.03.03.18.39.09;	author leith;	state Exp;
-branches;
-next	1.19;
-
-1.19
-date	2011.02.15.16.44.49;	author leith;	state Exp;
-branches;
-next	1.18;
-
-1.18
-date	2010.07.14.14.56.51;	author leith;	state Exp;
-branches;
-next	1.17;
-
-1.17
-date	2009.11.30.16.08.33;	author leith;	state Exp;
-branches;
-next	1.16;
-
-1.16
-date	2009.02.25.16.30.04;	author leith;	state Exp;
-branches;
-next	1.15;
-
-1.15
-date	2008.11.03.17.44.16;	author leith;	state Exp;
-branches;
-next	1.14;
-
-1.14
-date	2008.11.03.15.54.21;	author leith;	state Exp;
-branches;
-next	1.13;
-
-1.13
-date	2008.09.17.14.18.04;	author leith;	state Exp;
-branches;
-next	1.12;
-
-1.12
-date	2008.04.09.14.47.51;	author leith;	state Exp;
-branches;
-next	1.11;
-
-1.11
-date	2007.12.28.13.59.56;	author leith;	state Exp;
-branches;
-next	1.10;
-
-1.10
-date	2007.12.14.15.21.21;	author leith;	state Exp;
-branches;
-next	1.9;
-
-1.9
-date	2007.12.06.14.16.43;	author leith;	state Exp;
-branches;
-next	1.8;
-
-1.8
-date	2006.08.03.20.23.55;	author leith;	state Exp;
-branches;
-next	1.7;
-
-1.7
-date	2006.08.02.19.17.06;	author leith;	state Exp;
-branches;
-next	1.6;
-
-1.6
-date	2006.07.20.18.19.28;	author leith;	state Exp;
-branches;
-next	1.5;
-
-1.5
-date	2005.10.19.19.20.29;	author leith;	state Exp;
-branches;
-next	1.4;
-
-1.4
-date	2005.10.19.16.32.26;	author leith;	state Exp;
-branches;
-next	1.3;
-
-1.3
-date	2005.07.14.19.23.27;	author leith;	state Exp;
-branches;
-next	1.2;
-
-1.2
-date	2005.06.30.15.31.33;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	2005.01.25.16.16.03;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.21
-log
-@-DHAS_IEEE
-@
-text
-@# 
-# PURPOSE:  MAKEFILE FOR GNU/Linux SPIDER using FFTW3 on 2 or more processors on Opteron 64--
-# 
-# COMPILER: Portland Group F95 
-# TARGET:   AMD Opteron (x86_64) running GNU/Linux  
-# IMAGES:   Optimal SPIDER image byte order: Big-endian (SGI) (Non-native) 
-# USAGE:    make -f Makefile_linux_mp_opt64
-#
-# NOTE:     Uses FFTW3 configured with: --enable-float --enable-openmp
-# NOTE:     You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
-#
-# PGI Compile/link flags
-# -O2             : Invokes level 2 optimization (-O3 causes some run time problems with PGI compiler on SPIDER code)
-# -Kieee          : Invokes strict IEEE floating calculations
-# -mp             : Invokes multi processor support
-# -tp p6          : Targets 32 bit Pentium Pro/II/III with 32 bit memory addresses, supports x87 FP
-# -tp p7          : Targets 32 or 64 bit Pentium4 with 32 bit memory addresses, supports SSE1 & SSE2 FP
-# -tp p7-64       : Targets 64 bit Pentium4 with 64 bit memory addresses, supports SSE1, SSE2 & SSE3 FP
-# -tp x64         : Targets unified 64 bit AMD & Intel binaries (samoa)
-# -tp k8-64e      : Targets AMD Opteron Revision E or AMD Turion (cluster)
-# -Mipa=fast      : Invokes interprocedural analysis 
-# -fast           : Selects appropriate set of flags usually including -O2 -Munroll -Mnoframe
-# -fastsse        : Selects appropriate set of flags including SSE support and usually -O2 -Munroll -Mnoframe -Mvect=sse -Mcache_align 
-# -pc 64          : Sets precision of FPU operations
-# -mcmodel=medium : Allows use of >2GB data area 
-# -Bstatic_pgi    : Uses static PGI libs but makes dynamic executable
-# -Bstatic        : Static link 
-
-SHELL    = /bin/sh
-
-AFLAGS   = r
-
-# Location of PGI Fortran compiler  
-COMP     = /usr10/pgi/linux86-64/2011/bin/pgf95
-
-PGM      = spider
-
-WHICH    = mp_opt64
-
-EXE      = $(PGM)_linux_$(WHICH)$(SUFFIX)
-
-LIB      = $(EXE).a
-
-FFLAGS   = -Bstatic -tp k8-64 -fastsse -mp=nonuma -mcmodel=medium -O2 -Mpreprocess -Kieee -Minfo -byteswapio -DHAS_IEEE -DSP_MP -DSP_LIBFFTW3 -c  
-
-LF       = -Bstatic -tp k8-64 -fastsse -mp=nonuma -mcmodel=medium $(QLFLAGS)
-
-# Link with FFTW3 static libraries with threads and with math library
-FFTWLIBDIR = ../fftw/fftw3-opt64/lib
-LINKLIBS   = -Bstatic -L$(FFTWLIBDIR) -lfftw3f -lfftw3f_threads -lm
-
-.PRECIOUS : ../bin/$(EXE) $(LIB)
-
-include Makefile.inc
-
-include Makebody.inc
-
-#grep "opt=O3" *.f -->  to list -O3 compiles
-@
-
-
-1.20
-log
-@*** empty log message ***
-@
-text
-@d44 1
-a44 1
-FFLAGS   = -Bstatic -tp k8-64 -fastsse -mp=nonuma -mcmodel=medium -O2 -Mpreprocess -Kieee -Minfo -byteswapio -DSP_MP -DSP_LIBFFTW3 -c  
-@
-
-
-1.19
-log
-@cosmetic
-@
-text
-@d7 1
-d11 2
-a12 1
-# NOTE:     To create executable: make -f Makefile_linux_mp_opt64
-d14 1
-d22 2
-a23 2
-# -fast           : Selects an appropriate set of optimization flags usually including -O2 -Munroll -Mnoframe
-# -fastsse        : Selects an appropriate set of flags including SSE support usually including -O2 -Munroll -Mnoframe -Mvect=sse -Mcache_align 
-d26 2
-d29 1
-d31 1
-a31 1
-SHELL     = /bin/sh
-d33 2
-a34 1
-PGM       = spider
-d36 1
-a36 1
-WHICH     = mp_opt64
-d38 1
-a38 1
-COMP      = /usr10/pgi/linux86-64/8.0-4/bin/pgf95
-d40 1
-a40 1
-EXE       = $(PGM)_linux_$(WHICH)$(SUFFIX)
-d42 1
-a42 3
-# Numa static libraries may need to be placed in:  /usr/lib64
-# cp /usr10/pgi/linux86/8.0-4/libso/libpgnuma.a    /usr/lib/libnuma.a
-# cp /usr10/pgi/linux86-64/8.0-4/libso/libpgnuma.a /usr/lib64/libnuma.a
-d44 1
-a44 1
-FFLAGS     = -O2 -Mpreprocess -tp k8-64 -fastsse -mcmodel=medium -mp -Kieee -Minfo -byteswapio -DSP_MP -DSP_LIBFFTW3 -c  
-d46 1
-a46 1
-LF         = -tp k8-64 -fastsse -mp -mcmodel=medium $(QLFLAGS)
-d48 1
-d50 1
-d52 1
-a52 9
-LIB        = $(EXE).a
-
-AFLAGS     = r
-
-# Link with FFTW3 static libraries with threads and with math library
-FFTWLIBDIR   = ../fftw/fftw3-opt64/lib
-LINKLIBS  = -Bstatic -L$(FFTWLIBDIR) -lfftw3f -lfftw3f_threads -mp -lm
-
-.PRECIOUS : ../bin/$(EXE) $(LIB) 
-d58 1
-@
-
-
-1.18
-log
-@cosmetic
-no more spider.o
-@
-text
-@a10 12
-
-SHELL    = /bin/sh
-
-PGM      = spider
-
-WHICH    = mp_opt64
-
-# Location of PGI Fortran compiler  
-COMP     = /usr10/pgi/linux86-64/8.0-4/bin/pgf95
-
-EXE      = $(PGM)_linux_$(WHICH)$(SUFFIX)
-
-d24 11
-d39 1
-a39 1
-FFLAGS  = -O2 -Mpreprocess -tp k8-64 -fastsse -mcmodel=medium -mp -Kieee -Minfo -byteswapio -DSP_MP -DSP_LIBFFTW3 -c  
-d41 1
-a41 2
-# Link with multi processor support
-LF  = -tp k8-64 -fastsse -mp -mcmodel=medium $(QLFLAGS)
-d43 1
-a43 2
-# FFTW3 static library location
-FFTWLIBDIR   = ../fftw/fftw3-opt64/lib
-d45 1
-a45 1
-LIB    = $(EXE).a
-d47 1
-a47 1
-AFLAGS = r
-d50 1
-@
-
-
-1.17
-log
-@removed -Dosf_ieee
-@
-text
-@d2 1
-a2 1
-# ------    MAKEFILE FOR GNU/Linux SPIDER using FFTW3 on 2 or more processors on Opteron 64--
-d4 1
-a4 1
-# USING:    Portland Group F90 compiler
-d6 1
-a6 4
-# IMAGES:   Optimal SPIDER image byte order:   Big-endian (SGI) (Non-native) 
-#
-# NOTE:     Uses FFTW3 
-#           FFTW3 must be configured with: --enable-float --enable-type-prefix
-d8 1
-a9 1
-#
-d18 2
-a19 5
-# Location of Fortran compiler for PGI7.2-5 
-#COMP    = /usr/pgi/linux86-64/7.1/bin/pgf95
-#COMP    = /usr/pgi7.2/linux86-64/7.2-5/bin/pgf95
-#COMP    = /scratch/pgi/linux86-64/8.0-4/bin/pgf95
-COMP     = pgf95
-d36 3
-a38 2
-# cp /usr/pgi/linux86-64/7.1-2/libso/libpgnuma.a    /usr/lib64/libnuma.a
-# cp /usr/pgi7.2/linux86-64/7.2-5/libso/libpgnuma.a /usr/lib64/libnuma.a
-d45 1
-a45 1
-# FFTW library location for  pgi7.1 static
-d52 1
-a52 1
-# Link with FFTW static libraries with threads and with math library
-@
-
-
-1.16
-log
-@COMP
-@
-text
-@d45 1
-a45 1
-FFLAGS  = -O2 -Mpreprocess -tp k8-64 -fastsse -mcmodel=medium -mp -Kieee -Minfo -byteswapio -Dosf_ieee -DSP_MP -DSP_LIBFFTW3 -c  
-@
-
-
-1.15
-log
-@*** empty log message ***
-@
-text
-@d23 3
-a25 1
-COMP     = /usr/pgi7.2/linux86-64/7.2-5/bin/pgf95
-@
-
-
-1.14
-log
-@removed fftw in name
-@
-text
-@d2 1
-a2 2
-# MAKEFILE FOR GNU/Linux SPIDER using FFTW3 on 2 or more processors on Opteron 64--
-# OPTIMIZATION: 64 bit AMD Opteron (x86_64) 
-d4 3
-a6 1
-# Note:  To create executable: make -f Makefile_linux_mp_opt64
-d8 2
-a9 3
-# Using: Portland Group F90 compiler
-#        Non-native mode byte ordering on:  AMD Opteron GNU/Linux 64 bit OS
-#        FFTW must be configured with: --enable-float --enable-type-prefix
-d11 1
-a11 1
-# Note:    You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
-d13 2
-@
-
-
-1.13
-log
-@/usr/pgi7.2
-@
-text
-@d3 1
-d5 1
-a5 1
-# Note:  To create executable: make -f Makefile_linux_mpfftw3_opt64
-d17 1
-a17 1
-WHICH    = mpfftw_opt64
-@
-
-
-1.12
-log
-@libnuma
-@
-text
-@d18 3
-a20 2
-# Location of Fortran compiler for PGI7.1 
-COMP     = /usr/pgi/linux86-64/7.1/bin/pgf95
-d37 2
-a38 1
-# cp /usr/pgi/linux86-64/7.1-2/libso/libpgnuma.a /usr/lib64/libnuma.a
-@
-
-
-1.11
-log
-@tp
-@
-text
-@d36 1
-a36 1
-# cp ./linux86-64/7.1-2/libso/libpgnuma.a /usr/lib64/libnuma.a
-@
-
-
-1.10
-log
-@fftw3
-@
-text
-@d28 2
-a29 2
-# -tp x64         : Targets unified 64 bit AMD & Intel binaries
-# -tp k8-64e      : Targets AMD Opteron Revision E or AMD Turion 
-d38 1
-d40 2
-a41 7
-#FFLAGS = -O2 -Mpreprocess -tp k8-64   -Mipa=fast -fastsse -mcmodel=medium -mp -Kieee -Minfo -byteswapio -Dosf_ieee -DSP_MP -DSP_LIBFFTW2 -c  
-FFLAGS  = -O2 -Mpreprocess -fastsse -mcmodel=medium -mp -Kieee -Minfo -byteswapio -Dosf_ieee -DSP_MP -DSP_LIBFFTW3 -c  
-
-# Link with multi processor support host is optimal so no tp  needed
-#LF = -tp k8-64  -fastsse -mp -mcmodel=medium $(QLFLAGS)
-#LF = -Mipa=fast -fastsse -mp -mcmodel=medium $(QLFLAGS)
-LF  = -fastsse -mp -mcmodel=medium $(QLFLAGS)
-@
-
-
-1.9
-log
-@renamed fftw/fftw-opt64
-@
-text
-@d2 1
-a2 1
-# MAKEFILE FOR GNU/Linux SPIDER using FFTW on 2 or more processors on Opteron 64--
-d4 1
-a4 1
-# Note:  To create executable: make -f Makefile_linux_mpfftw_opt64
-a8 2
-#        We use FFTW without threads as it is usually slower with threads for
-#        multiple processors in our testing (June 05 al)
-d18 2
-a19 2
-## Location of PGI 6.0 Fortran compiler 
-COMP     = /usr/pgi/linux86-64/6.0/bin/pgf95
-d29 1
-a29 1
-# -tp k8-64e      : Targets AMD Opteron Revision E or AMD Turion (does not work??)
-d36 1
-a36 1
-FFLAGS = -O2 -Mpreprocess -tp k8-64 -fastsse -mcmodel=medium -mp -Kieee -Minfo -byteswapio -Dosf_ieee -DSP_MP -DSP_LIBFFTW -c  
-a37 2
-# Link with multi processor support
-LF = -tp k8-64 -fastsse -mcmodel=medium $(QLFLAGS)
-d39 10
-a48 2
-# FFTW library location for pgi6.0 static (pgi6.1 can only create dynamic linked executable)
-FFTWLIBDIR   = ../fftw/fftw-opt64/lib  
-d54 2
-a55 3
-# Link with FFTW static libraries without threads and with math library
-# For PGI6.0 links everyting static 
-LINKLIBS  = -Bstatic -L$(FFTWLIBDIR) -lsrfftw -lsfftw -mp -lm
-@
-
-
-1.8
-log
-@opt64.pgi6.0
-@
-text
-@d20 1
-a20 1
-## Location of Fortran compiler for PGI6.0 
-a21 2
-## Location of Fortran compiler for PGI6.1 
-#COMP     = /usr/pgi/linux86-64/6.1/bin/pgf95
-d25 12
-a36 12
-# -O2            : Invokes level 2 optimization (-O3 causes some run time problems with PGI compiler on SPIDER code)
-# -mp            : Invokes multi processor support
-# -tp p6         : Targets 32 bit Pentium Pro/II/III with 32 bit memory addresses, supports x87 FP
-# -tp p7         : Targets 32 or 64 bit Pentium4 with 32 bit memory addresses, supports SSE1 & SSE2 FP
-# -tp p7-64      : Targets 64 bit Pentium4 with 64 bit memory addresses, supports SSE1, SSE2 & SSE3 FP
-# -tp x64        : Targets unified 64 bit AMD & Intel binaries
-# -tp k8-64e     : Targets AMD Opteron Revision E or AMD Turion (does not work??)
-# -Mipa=fast     : Invokes interprocedural analysis 
-# -fast          : Selects an appropriate set of optimization flags usually including -O2 -Munroll -Mnoframe
-# -fastsse       : Selects an appropriate set of flags including SSE support usually including -O2 -Munroll -Mnoframe -Mvect=sse -Mcache_align 
-# -pc 64         : Sets precision of FPU operations
-#-mcmodel=medium : Allows use of >2GB data area 
-d43 2
-a44 4
-# FFTW library location for  pgi6.0 static
-FFTWLIBDIR   = ../fftw/fftw-opt64.pgi6.0/lib  
-# FFTW library location for pgi6.1 can only create dynamic linked executable
-# FFTWLIBDIR   = /net/bali/usr1/spider/fftw/fftw-opt64.pgi6.1/lib #for pgi6.1 dynamic only
-d51 1
-a51 2
-
-# For PGI6.0 links static 
-a53 4
-# For PGI6.1 links in dynamically (only way 6.1 will work) :  libm.so.6, libpthread.so.0, libnuma.so.1, libc.so.6, ld-linux-x86-64.so.2
-#LINKLIBS = -Bstatic -L$(FFTWLIBDIR) -lsrfftw -lsfftw  -L/usr/pgi/linux86-64/6.1/lib -mp -lm -Bdynamic /usr/lib64/libnuma.so # For 6.1
-#LINKLIBS = -Bstatic -L$(FFTWLIBDIR) -lsrfftw -lsfftw -lm -L/usr/pgi/linux86-64/6.1/lib -Bdynamic -mp /usr/lib64/libnuma.so #works fir 6.1
- 
-@
-
-
-1.7
-log
-@renamed pgi6.0
-@
-text
-@d46 1
-a46 1
-FFTWLIBDIR   = ../fftw/fftw-opt64pgi6.0/lib  
-@
-
-
-1.6
-log
-@for pgi 6.2
-@
-text
-@d20 4
-a23 1
-COMP     = /usr/pgi/linux86-64/6.1/bin/pgf95
-d43 1
-a43 1
-LF = -mp -tp k8-64 -fastsse -mcmodel=medium $(QLFLAGS)
-d45 4
-a48 2
-# FFTW library location
-FFTWLIBDIR   = ../fftw/fftw-opt64/lib
-d55 7
-a61 2
-# Links in:  libm.so.6, libpthread.so.0, libnuma.so.1, libc.so.6, ld-linux-x86-64.so.2
-LINKLIBS = -Bstatic -L$(FFTWLIBDIR) -lsrfftw -lsfftw  -L/usr/pgi/linux86-64/6.1/lib -mp -lm -Bdynamic /usr/lib64/libnuma.so -o ../bin/spider_linux_mpfftw_opt64
-a62 1
-
-@
-
-
-1.5
-log
-@fftw_loc
-@
-text
-@d8 1
-a8 1
-#        FFTW must be configured with: --enable-float --enable-shared --enable-type-prefix
-d20 1
-a20 1
-COMP     = pgf90
-d24 12
-a35 3
-# O3 seems to cause some problems with PGI compiler on SPIDER code
-# Compile with multi processor support
-FFLAGS   = -O2 -Mpreprocess -fast -Kieee -tp k8-64 -mcmodel=medium -pc 64 -Minfo -mp -byteswapio -Dosf_ieee -DSP_MP -DSP_LIBFFTW  -c  
-d37 1
-a37 2
-# FFTW library location
-FFTWLIBDIR   = ../fftw/fftw-opt64/lib
-d40 1
-a40 1
-LF       = -mp $(QLFLAGS)
-d42 2
-a43 1
-LIB      = $(EXE).a
-d45 1
-a45 1
-AFLAGS   = r
-d47 1
-a47 2
-# Link with FFTW shared libraries with threaded support (INACTIVE)
-#LINKLIBS = -L$(FFTWLIBDIR) -lsrfftw_threads -lsfftw_threads -lsrfftw -lsfftw -lm
-d49 4
-a52 2
-# link with FFTW static libraries without threads and math library
-LINKLIBS =  -L$(FFTWLIBDIR) -Bstatic -lsrfftw -lsfftw -lm
-d54 1
-a54 1
-.PRECIOUS :  ../bin/$(EXE) $(LIB) 
-a59 1
-
-@
-
-
-1.4
-log
-@static fftw
-@
-text
-@d2 1
-a2 1
-# -----  MAKEFILE FOR GNU/Linux SPIDER using FFTW on 2 or more processors on Opteron 64--
-d24 2
-d28 2
-a29 1
-LIBDIR   = ../fftw/fftw-opt64/lib
-d31 2
-a32 1
-LF       = -mp -L$(LIBDIR) $(QLFLAGS)
-d38 2
-a39 2
-# Link with FFTW shared libraries (INACTIVE)
-#LINKLIBS = -lsrfftw -lsfftw -lm
-d41 2
-a42 2
-# Link with FFTW static libraries
-LINKLIBS = -Bstatic -lsrfftw -lsfftw -lm
-@
-
-
-1.3
-log
-@no-threaded-fftw
-@
-text
-@d9 1
-a9 1
-#        We use FFTW on single processor (without threads) as it is usually poor for
-d26 1
-a26 1
-LIBDIR   = /net/bali/usr1/fftw-opt64/fftw-2.1.5/lib
-d28 1
-a28 1
-LF       = -L$(LIBDIR) -mp  $(QLFLAGS)
-d34 5
-a38 2
-# link with FFTW shared libraries
-LINKLIBS = -lsrfftw -lsfftw -lm
-@
-
-
-1.2
-log
-@uses shared libs now
-@
-text
-@d8 2
-a9 2
-#        FFTW must be configured with: --enable-threads --enable-float --enable-shared --enable-type-prefix
-#        We use FFTW on single processor as it is usually poor for
-d35 1
-a35 1
-LINKLIBS = -lsrfftw_threads -lsfftw_threads -lsrfftw -lsfftw -lm
-@
-
-
-1.1
-log
-@update
-@
-text
-@d9 2
-d24 1
-a24 1
-FFLAGS   = -O2 -Mpreprocess -fast -Kieee -tp k8-64 -mcmodel=medium -pc 64 -Minfo -mp -byteswapio -Dosf_ieee -DSP_MP -DSP_LIBFFTW -DSP_LIBFFTWMP -c  
-a33 4
-DEST     = _shared
-
-# link with FFTW static libraries
-###LINKLIBS = -lsrfftw_threads -lsfftw_threads -lsrfftw -lsfftw -lm
-d35 1
-a35 1
-LINKLIBS = -lfftw -lm
-@
-
diff --git src/Makefile_samples/RCS/Makefile_linux_mp_opt64_10,v src/Makefile_samples/RCS/Makefile_linux_mp_opt64_10,v
deleted file mode 100644
index 049ccb30..00000000
--- src/Makefile_samples/RCS/Makefile_linux_mp_opt64_10,v
+++ /dev/null
@@ -1,110 +0,0 @@
-head	1.1;
-access;
-symbols;
-locks; strict;
-comment	@# @;
-
-
-1.1
-date	2010.10.28.15.31.26;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.1
-log
-@Initial revision
-@
-text
-@# 
-# PURPOSE:  MAKEFILE FOR GNU/Linux SPIDER using FFTW3 on 2 or more processors on Opteron 64
-# 
-# COMPILER: Portland Group F95 
-# TARGET:   AMD Opteron (x86_64) running GNU/Linux  
-# IMAGES:   Optimal SPIDER image byte order: Big-endian (SGI) (Non-native) 
-#
-# NOTE:     Uses FFTW3 configured with: --enable-float --enable-openmp
-# NOTE:     You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
-# NOTE:     To create executable: make -f Makefile_linux_mp_opt64_10
-
-SHELL    = /bin/sh
-
-PGM      = spider
-
-WHICH    = mp_opt64_10
-
-# Location of PGI Fortran compiler  
-COMP     = /usr10/pgi/linux86-64/10.8/bin/pgf95
-
-EXE      = $(PGM)_linux_$(WHICH)$(SUFFIX)
-
-# -O2             : Invokes level 2 optimization (-O3 causes some run time problems with PGI compiler on SPIDER code)
-# -mp             : Invokes multi processor support
-# -tp p6          : Targets 32 bit Pentium Pro/II/III with 32 bit memory addresses, supports x87 FP
-# -tp p7          : Targets 32 or 64 bit Pentium4 with 32 bit memory addresses, supports SSE1 & SSE2 FP
-# -tp p7-64       : Targets 64 bit Pentium4 with 64 bit memory addresses, supports SSE1, SSE2 & SSE3 FP
-# -tp x64         : Targets unified 64 bit AMD & Intel binaries (samoa)
-# -tp k8-64e      : Targets AMD Opteron Revision E or AMD Turion (cluster)
-# -Mipa=fast      : Invokes interprocedural analysis 
-# -fast           : Selects an appropriate set of optimization flags usually including -O2 -Munroll -Mnoframe
-# -fastsse        : Selects an appropriate set of flags including SSE support usually including -O2 -Munroll -Mnoframe -Mvect=sse -Mcache_align 
-# -pc 64          : Sets precision of FPU operations
-# -mcmodel=medium : Allows use of >2GB data area 
-# -Bstatic_pgi    : Uses static PGI libs 
-# -Bstatic        : Always Sig faults on run!! 
-
-FFLAGS = -O2 -Bstatic_pgi -Mpreprocess -tp k8-64 -fastsse -mcmodel=medium -mp -Kieee -Minfo -byteswapio -DSP_MP -DSP_LIBFFTW3 -c  
-
-# Link with multi processor support
-LF  = -Bstatic_pgi -tp k8-64 -fastsse -mcmodel=medium -mp $(QLFLAGS)
-
-# FFTW3 static library location
-FFTWLIBDIR = ../fftw/fftw3-opt64/lib
-# Link with FFTW3 static libraries with threads 
-FFTWLIBS = -lfftw3f -lfftw3f_threads 
-
-LIB      = $(EXE).a
-
-AFLAGS   = r
-
-.PRECIOUS : ../bin/$(EXE) $(LIB) 
-
-include Makefile.inc
-
-#PGI 10+ COMPILER LINKS STATIC with -mp -mcmodel=medium
-../bin/$(EXE)$(DEST) : $(LIB)
-	/usr/bin/ld /usr/lib64/crt1.o /usr/lib64/crti.o  /scratch/pgi/linux86-64/10.8/libso/trace_init.o \
-/usr/lib64/gcc/x86_64-suse-linux/4.3/crtbeginT.o /scratch/pgi/linux86-64/10.8/libso/initmp.o \
-/scratch/pgi/linux86-64/10.8/libso/f90main.o \
--m elf_x86_64 -dynamic-linker /lib64/ld-linux-x86-64.so.2 /scratch/pgi/linux86-64/10.8/lib/pgi.ld \
--L$(FFTWLIBDIR) \
--L/scratch/pgi/linux86-64/10.8/libso \
--L/usr/lib64/gcc/x86_64-suse-linux/4.3 \
--Bstatic spider_linux_mp_opt64_10.a \
--lfftw3f -lfftw3f_threads \
--lpgmp   -lpgbind \
--lnuma    \
--lpgf90 -lpgf90_rpm1 -lpgf902 -lpgf90rtl -lpgftnrtl -lnspgc -lpgc \
--lrt -lpthread -lm -lgcc -lgcc_eh -lc -lgcc -lgcc_eh -lc \
-/usr/lib64/gcc/x86_64-suse-linux/4.3/crtend.o /usr/lib64/crtn.o \
--o ../bin/$(EXE)$(DEST) 
-	@@echo "Created: ../bin/$(EXE)$(DEST)"
-	@@echo " "
-
-$(LIB) : $(ELEMENTS)
-	@@echo "        linking $(EXE)$(DEST) now ----"
-
-.f.a:
-	$(COMP) $(FFLAGS) $<
-	$(AR) $(AFLAGS) $(LIB) $*.o
-	@@\rm $*.o
-
-
-
-
-
-@
diff --git src/Makefile_samples/RCS/Makefile_linux_mpfftw_opt,v src/Makefile_samples/RCS/Makefile_linux_mpfftw_opt,v
deleted file mode 100644
index 8398dc03..00000000
--- src/Makefile_samples/RCS/Makefile_linux_mpfftw_opt,v
+++ /dev/null
@@ -1,99 +0,0 @@
-head	1.3;
-access;
-symbols
-	best-code:1.2
-	x-named-regs:1.2
-	x:1.2
-	v13-00:1.2
-	pre_GPL:1.2;
-locks; strict;
-comment	@# @;
-
-
-1.3
-date	2006.07.28.14.07.53;	author leith;	state dead;
-branches;
-next	1.2;
-
-1.2
-date	2005.05.18.16.42.11;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	2004.11.01.14.08.06;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.3
-log
-@obsoliet
-@
-text
-@# 
-# ------  MAKEFILE FOR GNU/Linux SPIDER using FFTW on 2 or more processors --
-# 
-# Note:  To create executable: make -f Makefile_linux_mpfftw_opt
-#
-# Using: Portland Group F90 compiler
-#        Non-native mode byte ordering on:  AMD Opteron GNU/Linux 
-#        FFTW must be configured with:  --enable-threads --enable-float --enable-shared --prefix=/usr/local/ --enable-type-prefix
-#
-# Note:    You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
-#
-SHELL    = /bin/sh
-
-PGM      = spider
-
-WHICH    =  mpfftw_opt
-
-COMP     = pgf90
-
-EXE      = $(PGM)_linux_$(WHICH)$(SUFFIX)
-
-FFLAGS   = -O2 -Mpreprocess -fast -Kieee -pc 64 -Minfo -mp -byteswapio -Dosf_ieee -DSP_MP -DSP_LIBFFTW -DSP_LIBFFTWMP -c  
-
-LIBDIR   = /usr/local/spider/lib/
-
-LF       = -L$(LIBDIR) -mp  $(QLFLAGS)
-
-LIB      = $(EXE).a
-
-AFLAGS   = r
-
-# link with FFTW shared libraries,  iblf supports > 2GB files
-LINKLIBS = -L/usr/pgi/5.1/linux86/liblf  -lsrfftw_threads -lsfftw_threads -lsrfftw -lsfftw -lm
-
-.PRECIOUS :  ../bin/$(EXE) $(LIB) 
-
-include Makefile.inc
-
-include Makebody.inc
-
-@
-
-
-1.2
-log
-@latest from cluster
-@
-text
-@@
-
-
-1.1
-log
-@new
-@
-text
-@a22 3
-#slaton's FFLAGS:
-# -tp k8-64 -mcmodel=medium -O2 -Mpreprocess -fast -Kieee -pc 64 -Minfo -mp 
-# -Dosf_ieee -DSP_MP -DSP_LIBFFTW -DSP_LIBFFTWMP -c
-@
-
diff --git src/Makefile_samples/RCS/Makefile_linux_mpfftw_rh7,v src/Makefile_samples/RCS/Makefile_linux_mpfftw_rh7,v
deleted file mode 100755
index e4c15eeb..00000000
--- src/Makefile_samples/RCS/Makefile_linux_mpfftw_rh7,v
+++ /dev/null
@@ -1,85 +0,0 @@
-head	1.2;
-access;
-symbols
-	pre_opfiles:1.1
-	src:1.1
-	best-code:1.1
-	x-named-regs:1.1
-	x:1.1
-	v13-00:1.1
-	pre_GPL:1.1;
-locks; strict;
-comment	@# @;
-
-
-1.2
-date	2007.12.14.13.31.05;	author leith;	state dead;
-branches;
-next	1.1;
-
-1.1
-date	2004.07.08.19.11.04;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.2
-log
-@obsolete
-@
-text
-@# 
-# ------  MAKEFILE FOR GNU/Linux SPIDER using FFTW on 2 or more processors --
-# 
-# Note:  To create executable: make -f Makefile_linux_mpfftw 
-#
-# Using: Portland Group F90 compiler (FOR REDHAT LINUX PRE 7.4 !!)
-#        Non-native mode byte ordering on:  Intel/AMD IA32 GNU/Linux 
-#        FFTW must be configured with: --enable-threads --enable-float --enable-shared --enable-type-prefix
-#
-# Note:    You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
-#
-SHELL    = /bin/sh
-
-PGM      = spider
-
-WHICH    = mpfftw_rh7
-
-COMP     = pgf90
-
-EXE      = $(PGM)_linux_$(WHICH)$(SUFFIX)
-
-FFLAGS   = -O2 -Mpreprocess -fast -Kieee -pc 64 -Minfo -mp -byteswapio -Dosf_ieee -DSP_MP -DSP_LIBFFTW -DSP_LIBFFTWMP -c  
-
-LF       = -mp $(QLFLAGS)
-
-# library same as library for: spider_linux_mpfftw
-LIB      = spider_linux_mpfftw.a
-
-LIBDIR   = /usr/local/lib/
-
-AFLAGS   = r
-
-# link with FFTW shared libraries,  iblf supports > 2GB files
-LINKLIBS = -L$(LIBDIR) -L/usr/pgi/linux86/liblf -lsrfftw_threads -lsfftw_threads -lsrfftw -lsfftw -lm
-
-.PRECIOUS :  ../bin/$(EXE) $(LIB) 
-
-include Makefile.inc
-
-include Makebody.inc
-
-@
-
-
-1.1
-log
-@Initial revision
-@
-text
-@@
-
diff --git src/Makefile_samples/RCS/Makefile_linux_mpi,v src/Makefile_samples/RCS/Makefile_linux_mpi,v
deleted file mode 100644
index d520d834..00000000
--- src/Makefile_samples/RCS/Makefile_linux_mpi,v
+++ /dev/null
@@ -1,166 +0,0 @@
-head	1.4;
-access;
-symbols
-	pre_fftwrings:1.1
-	pre_opfiles:1.1
-	src:1.1
-	best-code:1.1
-	x-named-regs:1.1
-	x:1.1
-	v13-00:1.1
-	pre_GPL:1.1
-	prec_CA:1.1;
-locks; strict;
-comment	@# @;
-
-
-1.4
-date	2011.03.03.18.39.08;	author leith;	state Exp;
-branches;
-next	1.3;
-
-1.3
-date	2009.11.30.16.17.05;	author leith;	state Exp;
-branches;
-next	1.2;
-
-1.2
-date	2008.08.08.17.58.48;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	2003.09.24.17.17.27;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.4
-log
-@*** empty log message ***
-@
-text
-@# 
-# ------  MAKEFILE FOR GNU/Linux SPIDER with MPI --
-# 
-# USING: Portland Group F90 compiler
-#        Non-native mode byte ordering on Intel IA32 GNU/Linux 
-#        Native SPIDER fft 
-# USAGE: make -f Makefile_linux_mpi 
-#
-# NOTE:  You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
-#
-# THANKS TO: Shixin Yang & Dr Edward Egelman at University of Virginia
-#            for providing original version of this Makefile
-#
-SPGI Compile/link flags
-# -O2             : Invokes level 2 optimization (-O3 causes some run time problems with PGI compiler on SPIDER code)
-# -Kieee          : Invokes strict IEEE floating calculations
-# -mp             : Invokes multi processor support
-# -tp p6          : Targets 32 bit Pentium Pro/II/III with 32 bit memory addresses, supports x87 FP
-# -tp p7          : Targets 32 or 64 bit Pentium4 with 32 bit memory addresses, supports SSE1 & SSE2 FP
-# -tp p7-64       : Targets 64 bit Pentium4 with 64 bit memory addresses, supports SSE1, SSE2 & SSE3 FP
-# -tp x64         : Targets unified 64 bit AMD & Intel binaries (samoa)
-# -tp k8-64e      : Targets AMD Opteron Revision E or AMD Turion (cluster)
-# -Mipa=fast      : Invokes interprocedural analysis 
-# -fast           : Selects appropriate set of flags usually including -O2 -Munroll -Mnoframe
-# -fastsse        : Selects appropriate set of flags including SSE support and usually -O2 -Munroll -Mnoframe -Mvect=sse -Mcache_align 
-# -pc 64          : Sets precision of FPU operations
-# -mcmodel=medium : Allows use of >2GB data area 
-# -Bstatic_pgi    : Uses static PGI libs but makes dynamic executable
-# -Bstatic        : Static link 
-
-AFLAGS   = r
-
-SHELL    = /bin/sh
-
-COMP     = mpif90
-#COMP    = mpif77
-# LAM-MPI does not provide a separate mpif90.  When installing LAM-MPI
-# one has to specify either pgf90 or ifc as the backend compiler for mpif77.
-
-PGM      = spider
-
-WHICH    =  
-
-EXE      = $(PGM)_mpi$(WHICH)$(SUFFIX)
-
-LIB      = $(EXE).a
-
-FFLAGS   = -DUSE_MPI -DMPI_DEBUG -DSP_LIBFFTW3 -O2 -Mpreprocess -fast -Kieee -pc 64 -Minfo -byteswapio -c  
-
-LF       = $(QLFLAGS)  
-
-.PRECIOUS :  ../bin/$(EXE) $(LIB) 
-
-include Makefile.inc
-
-include Makebody.inc
-
-@
-
-
-1.3
-log
-@removed -Dosf_ieee
-@
-text
-@d4 1
-a4 3
-# Note:  To create executable: make -f Makefile_linux_mpi 
-#
-# Using: Portland Group F90 compiler
-d7 3
-d11 1
-a11 1
-# Thanks to: Shixin Yang & Dr Edward Egelman at University of Virginia
-d14 19
-a32 2
-# Note:  You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
-#
-d35 5
-d46 1
-a46 6
-COMP     = mpif90
-#
-#COMP    = mpif77
-#LAM-MPI does not provide a separate mpif90.  When installing LAM-MPI
-#one has to specify either pgf90 or ifc as the backend compiler for mpif77.
-# 
-a49 4
-AFLAGS   = r 
-
-LIB      = $(EXE).a
-
-a50 3
-
-# liblf supports > 2GB files
-LINKLIBS = -L/usr/pgi/linux86/liblf  
-@
-
-
-1.2
-log
-@new
-@
-text
-@d30 1
-a30 1
-FFLAGS   = -DUSE_MPI -DMPI_DEBUG -DSP_LIBFFTW3 -O2 -Mpreprocess -fast -Kieee -pc 64 -Minfo -byteswapio -Dosf_ieee -c  
-@
-
-
-1.1
-log
-@Initial revision
-@
-text
-@d30 1
-a30 1
-FFLAGS   = -DUSE_MPI -DMPI_DEBUG -O2 -Mpreprocess -fast -Kieee -pc 64 -Minfo -byteswapio -Dosf_ieee -c  
-@
-
diff --git src/Makefile_samples/RCS/Makefile_linux_mpi_opt64,v src/Makefile_samples/RCS/Makefile_linux_mpi_opt64,v
deleted file mode 100644
index 0052d583..00000000
--- src/Makefile_samples/RCS/Makefile_linux_mpi_opt64,v
+++ /dev/null
@@ -1,408 +0,0 @@
-head	1.15;
-access;
-symbols;
-locks; strict;
-comment	@# @;
-
-
-1.15
-date	2013.01.03.17.44.33;	author leith;	state Exp;
-branches;
-next	1.14;
-
-1.14
-date	2011.03.14.14.38.09;	author leith;	state Exp;
-branches;
-next	1.13;
-
-1.13
-date	2011.03.03.18.39.07;	author leith;	state Exp;
-branches;
-next	1.12;
-
-1.12
-date	2010.07.14.15.29.02;	author leith;	state Exp;
-branches;
-next	1.11;
-
-1.11
-date	2009.11.30.16.18.04;	author leith;	state Exp;
-branches;
-next	1.10;
-
-1.10
-date	2009.11.05.20.38.25;	author leith;	state Exp;
-branches;
-next	1.9;
-
-1.9
-date	2009.02.26.16.10.21;	author leith;	state Exp;
-branches;
-next	1.8;
-
-1.8
-date	2009.01.22.13.27.29;	author leith;	state Exp;
-branches;
-next	1.7;
-
-1.7
-date	2009.01.22.12.26.30;	author leith;	state Exp;
-branches;
-next	1.6;
-
-1.6
-date	2008.11.07.15.30.38;	author leith;	state Exp;
-branches;
-next	1.5;
-
-1.5
-date	2008.11.06.16.33.42;	author leith;	state Exp;
-branches;
-next	1.4;
-
-1.4
-date	2008.11.03.16.55.30;	author leith;	state Exp;
-branches;
-next	1.3;
-
-1.3
-date	2008.11.03.15.21.01;	author leith;	state Exp;
-branches;
-next	1.2;
-
-1.2
-date	2008.10.20.15.13.26;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	2008.09.30.17.07.19;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.15
-log
-@2.8 mpi
-@
-text
-@# 
-# PURPOSE:   MAKEFILE FOR GNU/Linux SPIDER using FFTW3 with MPI on Opteron 64 
-# 
-# COMPILER:  Portland Group F95 compiler  & OpenMPI
-# TARGET:    AMD Opteron 64 (x86_64) running GNU/Linux 
-# IMAGES:    Optimal SPIDER image byte order:   Big-endian (SGI) (Non-native) 
-# USAGE:     make -f Makefile_linux_mpi_opt64 
-#
-# NOTE:     Uses FFTW3 configured with: --enable-float --enable-type-prefix
-# NOTE:     You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
-#
-# WARNING: Using 'gethostbyname'  & 'getpwuid' from MPI in statically linked applications 
-#          requires runtime shared libraries from the glibc version used for linking
-
-SHELL    = /bin/sh
-
-AFLAGS   = r
-
-# Location of compiler for use with openmpi (OpenMPI sets link to PGI compiler when OpenMPI installed) 
-# LAM-MPI does not provide a separate mpif90.  When installing LAM-MPI
-# one has to specify either pgf90 or ifc as the backend compiler for mpif77.
-#COMP    = /usr/pgi7.2/linux86-64/7.2/mpi/mpich/bin/mpif90 -I /usr/pgi7.2/linux86-64/7.2/mpi/mpich/include
-#COMP    = /usr8/repository/openmpi-1.3.3/bin/mpif90 
- COMP    = /usr8/repository/openmpi-1.2.8/bin/mpif90 
-
-PGM      = spider
-
-WHICH    = mpi_opt64
-
-EXE      = $(PGM)_linux_$(WHICH)$(SUFFIX)
-
-LIB      = $(EXE).a
-
-FFLAGS   = -DUSE_MPI -tp k8-64 -fastsse -mcmodel=medium -O2 -Mpreprocess -Kieee -Minfo -byteswapio -DSP_LIBFFTW3  -c  
-
-LF       = -tp k8-64 -fastsse -mcmodel=medium $(QLFLAGS)
-
-# FFTW3 static library location
-FFTWLIBDIR = ../fftw/fftw3-opt64/lib
-
-# MPI library location
-#MPILIBDIR = /usr/pgi7.2/linux86-64/7.2/mpi/mpich/lib
-#MPILIBDIR = /usr8/repository/openmpi-1.3.3/lib
- MPILIBDIR = /usr8/repository/openmpi-1.2.8/lib
-
-# Could not fully link with MPI static libraries and with math library GAVE UP ON STATIC
-LINKLIBS  =  -Bstatic_pgi -L$(FFTWLIBDIR) -lfftw3f -lfftw3f_threads -L$(MPILIBDIR) -lmpi -lm 
-
-.PRECIOUS :  ../bin/$(EXE) $(LIB)
-
-include Makefile.inc
-
-include Makebody.inc
-
-@
-
-
-1.14
-log
-@for 1.3.3
-@
-text
-@d23 2
-a24 2
-COMP     = /usr8/repository/openmpi-1.2.8/bin/mpif90 
-COMP     = /usr8/repository/openmpi-1.3.3/bin/mpif90 
-d43 1
-@
-
-
-1.13
-log
-@*** empty log message ***
-@
-text
-@d24 1
-@
-
-
-1.12
-log
-@cosmetic
-@
-text
-@d7 1
-a10 1
-# NOTE:     To create executable: make -f Makefile_linux_mpi_opt64 
-d13 1
-a13 1
-#          requires at runtime the shared libraries from the glibc version used for linking
-d17 8
-d29 1
-a29 3
-# Location of compiler for use with openmpi (links to PGI) 
-#COMP    = /usr/pgi7.2/linux86-64/7.2/mpi/mpich/bin/mpif90 -I /usr/pgi7.2/linux86-64/7.2/mpi/mpich/include
-COMP     = /usr8/repository/openmpi-1.2.8/bin/mpif90 
-d31 1
-a31 1
-EXE      = $(PGM)_linux_$(WHICH)$(SUFFIX)
-d33 1
-a33 1
-FFLAGS   = -DSP_LIBFFTW3 -DUSE_MPI -O2 -Mpreprocess -tp k8-64 -fastsse -mcmodel=medium -Kieee -Minfo -byteswapio -c  
-d42 1
-a42 5
-MPILIBDIR = /usr8/repository/openmpi-1.2.8/lib
-
-LIB      = $(EXE).a
-
-AFLAGS   = r 
-a44 1
-#LINKLIBS  = -Bstatic     -L$(FFTWLIBDIR) -lfftw3f -lfftw3f_threads -L$(MPILIBDIR) -lmpi -lm 
-@
-
-
-1.11
-log
-@removed -Dosf_ieee
-@
-text
-@d2 1
-a2 1
-# --------  MAKEFILE FOR GNU/Linux SPIDER using FFTW3 with MPI on Opteron 64 --
-d4 3
-d8 1
-a8 6
-# USING:    Portland Group F90 compiler  & OpenMPI
-# TARGET:   AMD Opteron 64 (x86_64) running GNU/Linux 
-# IMAGES:   Optimal SPIDER image byte order:   Big-endian (SGI) (Non-native) 
-#
-# NOTE:     Uses FFTW3 
-# NOTE:     FFTW3 must be configured with: --enable-float --enable-type-prefix
-a9 1
-#
-d21 1
-d31 1
-a31 1
-# FFTW static library location
-d43 2
-a44 2
-#LINKLIBS  = -Bstatic -L$(FFTWLIBDIR) -lfftw3f -lfftw3f_threads -L$(MPILIBDIR) -lmpi -lm 
-LINKLIBS  = -Bstatic_pgi -L$(FFTWLIBDIR) -lfftw3f -lfftw3f_threads -L$(MPILIBDIR) -lmpi -lm 
-@
-
-
-1.10
-log
-@repository loc
-@
-text
-@d29 1
-a29 1
-FFLAGS   = -DSP_LIBFFTW3 -DUSE_MPI -O2 -Mpreprocess -tp k8-64 -fastsse -mcmodel=medium -Kieee -Minfo -byteswapio -Dosf_ieee -c  
-@
-
-
-1.9
-log
-@cosmetic
-@
-text
-@d25 1
-a25 1
-COMP     = /usr8/spider/repository/openmpi-1.2.8/bin/mpif90 
-d38 1
-a38 1
-MPILIBDIR = /usr8/spider/repository/openmpi-1.2.8/lib
-d46 1
-a46 1
-LINKLIBS  = -L$(FFTWLIBDIR) -lfftw3f -lfftw3f_threads -L$(MPILIBDIR) -lmpi -lm 
-@
-
-
-1.8
-log
-@*** empty log message ***
-@
-text
-@a10 1
-#
-d33 1
-a33 1
-# FFTW static library location for pgi7.2
-@
-
-
-1.7
-log
-@*** empty log message ***
-@
-text
-@d47 1
-a47 1
-LINKLIBS  =   -L$(FFTWLIBDIR) -lfftw3f -lm 
-@
-
-
-1.6
-log
-@*** empty log message ***
-@
-text
-@d26 1
-a26 1
-COMP     = /usr8/repository/openmpi-1.2.8/bin/mpif90 
-d39 1
-a39 1
-MPILIBDIR = /usr8/repository/openmpi-1.2.8/lib
-@
-
-
-1.5
-log
-@*** empty log message ***
-@
-text
-@d5 1
-a5 1
-# USING:    Portland Group F90 compiler
-a31 1
-#LF      = -tp k8-64 -fastsse -mcmodel=medium $(QLFLAGS) ! DID NOT WORK WITH: mpif90!!
-d37 1
-a37 1
-# MPI static library location
-d45 2
-a46 2
-# Link with FFTW static libraries with threads and with math library
-#LINKLIBS  = -Bstatic -L$(FFTWLIBDIR) -lfftw3f -lfftw3f_threads -Bdynamic -L$(MPILIBDIR) -lmpi /usr/lib64/libnuma.a -lm 
-@
-
-
-1.4
-log
-@*** empty log message ***
-@
-text
-@d25 2
-a26 1
-COMP     = /usr/pgi7.2/linux86-64/7.2/mpi/mpich/bin/mpif90 -I /usr/pgi7.2/linux86-64/7.2/mpi/mpich/include
-d30 1
-a30 1
-FFLAGS   = -DSP_LIBFFTW3 -DUSE_MPI             -O2 -Mpreprocess -tp k8-64 -fastsse -mcmodel=medium -Kieee -Minfo -byteswapio -Dosf_ieee -c  
-d32 1
-a32 1
-#LF      = -tp k8-64 -fastsse -mcmodel=medium $(QLFLAGS) ! did not work with mpif90!!
-d39 2
-a40 1
-MPILIBDIR = /usr/pgi7.2/linux86-64/7.2/mpi/mpich/lib
-d47 2
-a48 1
-LINKLIBS  = -Bstatic -L$(FFTWLIBDIR) -lfftw3f -lfftw3f_threads -L$(MPILIBDIR) -lmpich -lm
-@
-
-
-1.3
-log
-@new
-@
-text
-@d2 1
-a2 1
-# ------  MAKEFILE FOR GNU/Linux SPIDER with MPI for use on Opteron 64 --
-a3 1
-# Note:  To create executable: make -f Makefile_linux_mpi_opt64 
-d5 3
-a7 2
-# Using: Portland Group F90 compiler
-#        Non-native mode byte ordering on Opteron 64 running Linux 
-d9 8
-a16 2
-# Note:  You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
-# WARNING: Using 'gethostbyname'  &'getpwuid' from MPI in statically linked applications 
-d18 1
-a18 1
-#
-@
-
-
-1.2
-log
-@*** empty log message ***
-@
-text
-@a18 2
-#LAM-MPI does not provide a separate mpif90. 
-#COMP    = /usr/pgi7.2/linux86-64/7.2-5/bin/pgf95 -I /usr/pgi7.2/linux86-64/7.2/mpi/mpich/include
-a22 1
-#FFLAGS  = -DSP_LIBFFTW3 -DUSE_MPI -DMPI_DEBUG -O2 -Mpreprocess -tp k8-64 -fastsse -mcmodel=medium -Kieee -Minfo -byteswapio -Dosf_ieee -c  
-d26 1
-a26 1
-LF       = -tp k8-64 -fastsse  $(QLFLAGS)
-@
-
-
-1.1
-log
-@new
-@
-text
-@d20 2
-a21 2
-#COMP    = mpif90
-COMP     = /usr/pgi7.2/linux86-64/7.2-5/bin/pgf95 -I /usr/pgi7.2/linux86-64/7.2/mpi/mpich/include
-d25 2
-a26 1
-FFLAGS   = -DSP_LIBFFTW3 -DUSE_MPI -DMPI_DEBUG -O2 -Mpreprocess -tp k8-64 -fastsse -mcmodel=medium -Kieee -Minfo -byteswapio -Dosf_ieee -c  
-d28 2
-a29 1
-LF       = -tp k8-64 -fastsse -mcmodel=medium $(QLFLAGS)
-d31 1
-a31 1
-# FFTW library location for  pgi7.2 static
-d34 1
-a34 1
-# MPI static library MPI location
-@
-
diff --git src/Makefile_samples/RCS/Makefile_linux_nat_opt64,v src/Makefile_samples/RCS/Makefile_linux_nat_opt64,v
deleted file mode 100644
index b3d2cb06..00000000
--- src/Makefile_samples/RCS/Makefile_linux_nat_opt64,v
+++ /dev/null
@@ -1,137 +0,0 @@
-head	1.3;
-access;
-symbols;
-locks; strict;
-comment	@# @;
-
-
-1.3
-date	2013.04.03.14.47.37;	author leith;	state Exp;
-branches;
-next	1.2;
-
-1.2
-date	2011.03.03.18.39.37;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	2011.03.03.15.25.48;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.3
-log
-@*** empty log message ***
-@
-text
-@# 
-# ------    MAKEFILE FOR GNU/Linux SPIDER using FFTW3, on multiple processors, on Opteron 64
-# 
-# TARGET:   AMD Opteron (x86_64) running GNU/Linux  
-# COMPILER: Portland Group F90 
-# IMAGES:   Optimal SPIDER image byte order: Little-endian (native) 
-# REQUIRES: FFTW3 configured with: --enable-float --enable-type-prefix
-# USAGE:    make -f Makefile_linux_nat_opt64
-#
-# NOTES:    You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
-# -tp p6          : Targets 32 bit Pentium Pro/II/III with 32 bit memory addresses, supports x87 FP
-
-SHELL    = /bin/sh
-
-PGM      = spider
-
-WHICH    = nat_opt64
-
-# Location of Fortran compiler   
-#COMP    = /usr10/pgi/linux86-64/2011/bin/pgf95
-COMP     = /usr10/pgi/linux86-64/2013/bin/pgfortran
-
-EXE      = $(PGM)_linux_$(WHICH)$(SUFFIX)
-
-LIB      = $(EXE).a
-
-FFLAGS   = -Bstatic -tp k8-64 -fastsse -mp=nonuma -mcmodel=medium -O2 -Mpreprocess -Kieee -Minfo -DSP_MP -DSP_LIBFFTW3 -c  
-
-LF       = -Bstatic -tp k8-64 -fastsse -mp=nonuma -mcmodel=medium $(QLFLAGS)
-
-
-# Link with FFTW static libraries with threads and with math library
-FFTWLIBDIR = ../fftw/fftw3-opt64/lib
-LINKLIBS   = -Bstatic -L$(FFTWLIBDIR) -lfftw3f -lfftw3f_threads -mp -lm
-
-.PRECIOUS : ../bin/$(EXE) $(LIB) 
-
-include Makefile.inc
-
-include Makebody.inc
-
-@
-
-
-1.2
-log
-@*** empty log message ***
-@
-text
-@d11 1
-d20 2
-a21 1
-COMP     = /usr10/pgi/linux86-64/2011/bin/pgf95
-@
-
-
-1.1
-log
-@Initial revision
-@
-text
-@d8 1
-a10 1
-#           To create executable: make -f Makefile_linux_nat_opt64
-d19 1
-a19 4
-#COMP    = /usr/pgi/linux86-64/7.1/bin/pgf95
-#COMP    = /usr/pgi7.2/linux86-64/7.2-5/bin/pgf95
-#COMP    = /scratch/pgi/linux86-64/8.0-4/bin/pgf95
-COMP     = pgf95
-d23 1
-a23 20
-# -O2             : Invokes level 2 optimization (-O3 causes some run time problems with PGI compiler on SPIDER code)
-# -mp             : Invokes multi processor support
-# -tp p6          : Targets 32 bit Pentium Pro/II/III with 32 bit memory addresses, supports x87 FP
-# -tp p7          : Targets 32 or 64 bit Pentium4 with 32 bit memory addresses, supports SSE1 & SSE2 FP
-# -tp p7-64       : Targets 64 bit Pentium4 with 64 bit memory addresses, supports SSE1, SSE2 & SSE3 FP
-# -tp x64         : Targets unified 64 bit AMD & Intel binaries 
-# -tp k8-64e      : Targets AMD Opteron Revision E or AMD Turion (cluster)
-# -Mipa=fast      : Invokes interprocedural analysis 
-# -fast           : Selects an appropriate set of optimization flags usually including -O2 -Munroll -Mnoframe
-# -fastsse        : Selects an appropriate set of flags including SSE support usually including -O2 -Munroll -Mnoframe -Mvect=sse -Mcache_align 
-# -pc 64          : Sets precision of FPU operations
-# -mcmodel=medium : Allows use of >2GB data area 
-
-# cp /usr/pgi/linux86-64/7.1-2/libso/libpgnuma.a    /usr/lib64/libnuma.a
-# cp /usr/pgi7.2/linux86-64/7.2-5/libso/libpgnuma.a /usr/lib64/libnuma.a
-
-FFLAGS  = -O2 -Mpreprocess -tp k8-64 -fastsse -mcmodel=medium -mp -Kieee -Minfo -DSP_MP -DSP_LIBFFTW3 -c  
-
-# Link with multi processor support
-LF  = -tp k8-64 -fastsse -mp -mcmodel=medium $(QLFLAGS)
-d25 1
-a25 2
-# FFTW static library location 
-FFTWLIBDIR   = ../fftw/fftw3-opt64/lib
-d27 1
-a27 1
-LIB    = $(EXE).a
-a28 1
-AFLAGS = r
-d31 2
-a32 1
-LINKLIBS  = -Bstatic -L$(FFTWLIBDIR) -lfftw3f -lfftw3f_threads -mp -lm
-@
diff --git src/Makefile_samples/RCS/Makefile_linux_other,v src/Makefile_samples/RCS/Makefile_linux_other,v
deleted file mode 100755
index 4d68c07a..00000000
--- src/Makefile_samples/RCS/Makefile_linux_other,v
+++ /dev/null
@@ -1,163 +0,0 @@
-head	1.6;
-access;
-symbols
-	best-code:1.6
-	x-named-regs:1.6
-	x:1.6
-	v13-00:1.6
-	prec_CA:1.5;
-locks; strict;
-comment	@# @;
-
-
-1.6
-date	2005.06.28.15.53.16;	author leith;	state dead;
-branches;
-next	1.5;
-
-1.5
-date	2003.03.26.18.55.46;	author leith;	state Exp;
-branches;
-next	1.4;
-
-1.4
-date	2003.03.25.15.03.20;	author leith;	state Exp;
-branches;
-next	1.3;
-
-1.3
-date	2003.03.03.16.28.24;	author leith;	state Exp;
-branches;
-next	1.2;
-
-1.2
-date	2003.02.25.15.25.01;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	2003.02.20.14.22.43;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.6
-log
-@trash
-@
-text
-@# 
-# ------  MAKEFILE FOR GNU/Linux SPIDER using FFTW on 2 or more processors --
-# 
-# Note:  To create executable: make -f Makefile_linux_other         
-#
-# Using: Portland Group F90 compiler
-#        Non-native mode byte ordering on:  Intel IA32 GNU/Linux 
-#        FFTW must be configured with:  --enable-threads --enable-float --enable-shared --prefix=/usr/local/ --enable-type-prefix
-#        Linux 7.4+++
-#         
-# Note:    You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
-#
-SHELL    = /bin/sh
-
-PGM      = spider
-
-WHICH    = other
-
-COMP     = pgf90
-
-EXE      = $(PGM)_linux_$(WHICH)$(SUFFIX)
-
-FFLAGS   = -O2 -Mpreprocess -fast -Kieee -pc 64 -Minfo -mp -byteswapio -Dosf_ieee -DSP_MP -DSP_LIBFFTW -DSP_LIBFFTWMP -c  
-
-LIB      = spider_linux_mpfftw.a
-
-LF       =  $(QLFLAGS)
-
-LIBDIR   = /usr/local/lib/
-
-AFLAGS   = r
-
-# link with FFTW shared libraries,  liblf supports > 2GB files
-LINKLIBS =   -L$(LIBDIR) -lsrfftw_threads -lsfftw_threads -lsrfftw -lsfftw -lpgmp -lpthread -lm
-
-.PRECIOUS :  ../bin/$(EXE) $(LIB) 
-
-include Makefile.inc
-
-include Makebody.inc
-
-@
-
-
-1.5
-log
-@*** empty log message ***
-@
-text
-@@
-
-
-1.4
-log
-@*** empty log message ***
-@
-text
-@d25 1
-a25 1
-LIB      = spider_linuxmpfftw.a
-@
-
-
-1.3
-log
-@fixed
-@
-text
-@d4 1
-a4 1
-# Note:  To create executable: make -f Makefile_linuxother         
-d21 1
-a21 1
-EXE      = $(PGM)_linux$(WHICH)$(SUFFIX)
-@
-
-
-1.2
-log
-@*** empty log message ***
-@
-text
-@d34 1
-a34 1
-LINKLIBS = -L$(LIBDIR) -lsrfftw_threads -lsfftw_threads -lsrfftw -lsfftw -lpthread -lm
-@
-
-
-1.1
-log
-@Initial revision
-@
-text
-@d4 1
-a4 1
-# Note:  To create executable: make -f Makefile_other         
-a10 1
-#
-d25 1
-a25 1
-LIBDIR   = /usr/local/lib/
-d27 1
-a27 1
-LF       = -L$(LIBDIR) -Wl,--rpath -Wl,$(LIBDIR) $(QLFLAGS)
-d29 1
-a29 1
-LIB      = spider_linuxmpfftw.a
-d34 1
-a34 1
-LINKLIBS = -L/usr/pgi/linux86/liblf -lsrfftw_threads -lsfftw_threads -lsrfftw -lsfftw -lpgmp -lpthread -lm
-@
diff --git src/Makefile_samples/RCS/Makefile_linuxmp_ifc,v src/Makefile_samples/RCS/Makefile_linuxmp_ifc,v
deleted file mode 100644
index dbdd1b77..00000000
--- src/Makefile_samples/RCS/Makefile_linuxmp_ifc,v
+++ /dev/null
@@ -1,92 +0,0 @@
-head	1.2;
-access;
-symbols
-	best-code:1.1
-	x-named-regs:1.1
-	x:1.1
-	v13-00:1.1
-	pre_GPL:1.1
-	prec_CA:1.1;
-locks; strict;
-comment	@# @;
-
-
-1.2
-date	2006.07.31.15.23.49;	author leith;	state dead;
-branches;
-next	1.1;
-
-1.1
-date	2003.03.25.15.04.45;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.2
-log
-@obsolete
-@
-text
-@# 
-# ------  MAKEFILE FOR GNU/Linux SPIDER using FFTW on 2 or more processors --
-# 
-# Note:  To create executable: make -f Makefile_linuxmp_ifc
-#
-# Using: Intel Fortran compiler 7.0 (ifc)
-#
-# To use non-native mode byte ordering on Intel IA32 GNU/Linux, define the
-# environment variable F_UFMTENDIAN to "big".
-#
-# FFTW must be configured with:  --enable-threads --enable-float --enable-shared --prefix=/usr/local/ --enable-type-prefix
-# Linux 7.4+++
-#
-# All libraries are statically linked except libm, glibc & libpthread.
-#
-# Note:    You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
-#
-# Makefile modified for Intel Fortran compiler by Slaton Lipscomb
-#
-SHELL    = /bin/sh
-
-PGM      = spider
-
-WHICH    = ifc
-
-COMP     = ifc
-
-#SUFFIX   = _
-
-EXE      = $(PGM)mp_linux$(WHICH)$(SUFFIX)
-
-FFLAGS   = -openmp -Vaxlib -parallel -O2 -WB -mp -fpp2 -auto -pc64 -c -cm -w95 -tpp7 -axW -Dosf_ieee -DSP_LINUX -DSP_LIBFFTWMP -DSP_MP -DSP_IFC
-
-LIBDIR   = /usr/local/lib/
-
-LF       =  $(QLFLAGS)
-
-LIB      = spidermp_linuxifc.a
-
-AFLAGS   = r
-
-# link with FFTW shared libraries,  liblf supports > 2GB files
-LINKLIBS = -Bstatic -L$(LIBDIR) -lsrfftw_threads -lsfftw_threads -lsrfftw -lsfftw -lguide -lPEPCF90 -static-libcxa -Bdynamic -lpthread -lm
-
-.PRECIOUS :  ../bin/$(EXE) $(LIB) 
-
-include Makefile.inc
-include Makebody.inc
-
-@
-
-
-1.1
-log
-@Initial revision
-@
-text
-@@
-
diff --git src/Makefile_samples/RCS/Makefile_omp,v src/Makefile_samples/RCS/Makefile_omp,v
deleted file mode 100755
index 25c83285..00000000
--- src/Makefile_samples/RCS/Makefile_omp,v
+++ /dev/null
@@ -1,102 +0,0 @@
-head	1.4;
-access;
-symbols
-	best-code:1.3
-	x-named-regs:1.3
-	x:1.3
-	v13-00:1.3
-	pre_GPL:1.3
-	prec_CA:1.3
-	noindx:1.3
-	Bproc:1.3;
-locks; strict;
-comment	@# @;
-
-
-1.4
-date	2006.07.31.15.21.45;	author leith;	state dead;
-branches;
-next	1.3;
-
-1.3
-date	2000.04.24.20.36.28;	author leith;	state Exp;
-branches;
-next	1.2;
-
-1.2
-date	2000.04.18.20.31.41;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	2000.04.18.20.28.48;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@SP_UNIX cpp variable no longer needed.
-@
-
-
-1.4
-log
-@obsolete
-@
-text
-@# 
-# ------ MAKEFILE FILE FOR IBM SP UNIX SPIDER -----------F90
-# 
-# Notes: 
-#
-#       The commands for ELEMENTS may be necessary
-#
-#       To create  executable:   make -f Makefile_ibm ../bin/spider_ibm
-#
-#
-# native mode on IBM SP machine with no parallel stuff
-CPP      = /usr/ccs/lib/cpp
-CPPFLAGS = -DSP_IBMSP3
-
-COMP     = xlf90_r
-FFLAGS   = -qarch=auto -qfixed=72 -qnosave -qsmp=omp     
-
-LFLAGS   = 
-
-PGM    = omp
-SRC    = omp
-
-$(PGM)  : $(SRC).f
-	$(COMP) $(FFLAGS) $(SRC).f -o $(PGM)
-
-@
-
-
-1.3
-log
-@removd -DSP_F90
-@
-text
-@@
-
-
-1.2
-log
-@SP_UNIX cpp variable no longer needed.
-@
-text
-@d13 1
-a13 1
-CPPFLAGS = -DSP_F90 -DSP_IBMSP3
-@
-
-
-1.1
-log
-@Initial revision
-@
-text
-@d13 1
-a13 1
-CPPFLAGS = -DSP_F90 -DSP_UNIX -DSP_IBMSP3
-@
diff --git src/Makefile_samples/RCS/Makefile_osx_32_pgi,v src/Makefile_samples/RCS/Makefile_osx_32_pgi,v
deleted file mode 100644
index 803a0863..00000000
--- src/Makefile_samples/RCS/Makefile_osx_32_pgi,v
+++ /dev/null
@@ -1,115 +0,0 @@
-head	1.3;
-access;
-symbols;
-locks; strict;
-comment	@# @;
-
-
-1.3
-date	2010.07.23.17.50.50;	author leith;	state Exp;
-branches;
-next	1.2;
-
-1.2
-date	2009.11.30.16.21.49;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	2009.04.28.13.15.09;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.3
-log
-@*** empty log message ***
-@
-text
-@#
-# PURPOSE:  MAKEFILE FOR OSX SPIDER using FFTW on 2 or more processors 
-# USING:    PGI Compiler
-#
-# TARGET:   Non-native mode byte ordering on:  34 bit Intel Mac OS X
-#
-# NOTE:     FFTW3 must be configured with: --enable-float --
-# NOTE:     You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
-# NOTE:     To create executable: make -f Makefile_osx_32_pgi
-
-# Note:  You may ignore any undefined QFFLAGS & SUFFIX
-
-SHELL    = /bin/sh
-
-PGM      = spider
-
-WHICH    = osx_32_pgi
-
-# Using: 32 bit PGI Fortran compiler
-COMP     =  /opt/pgi/osx86/8.0/bin/pgf95 
-
-EXE      = $(PGM)_$(WHICH)$(SUFFIX)
-
-# -O3               : Invokes level 3 optimization 
-# -mp               : Invokes OMP multi processor support
-# -DSP_MP           : cpp flag to activate OMP 
-# -DSP_LIBFFTW3     : cpp flag to activate FFTW3 
-# -tp p7            : 32 bit Pentium 4
-
-FFLAGS = -tp p7 -O3 -Mpreprocess -mp -Kieee -Minfo \
-         -byteswapio -DSP_MP -DSP_LIBFFTW3 -c  
-
-# Link with multi processor support
-LF = -tp p7 -mp
-
-# FFTW static library location
-FFTWLIBDIR = ../fftw/fftw3-osx-32-pgi/lib
-
-LIB    = $(EXE).a
-
-AFLAGS = -r
-
-# Static Link with FFTW libraries with threads 
-LINKLIBS  = -L$(FFTWLIBDIR) -lfftw3f -lfftw3f_threads -lm  
-
-.PRECIOUS : ../bin/$(EXE) $(LIB)
-
-include Makefile.inc
-
-include Makebody.inc
-@
-
-
-1.2
-log
-@removed -Dosf_ieee
-res Makefile_osx_x64_pgi
-@
-text
-@d2 2
-a3 1
-# ------  MAKEFILE FOR GNU/Linux SPIDER using FFTW on 2 or more processors --
-d5 5
-a9 4
-# Note:  To create executable: make -f Makefile_osx_32_pgi
-#_
-#        Non-native mode byte ordering on:  32 bit Intel Mac OS X
-#        FFTW3 must be configured with: --enable-float --openmp
-d19 1
-a19 1
-# Using: 32 bit PGI Fortran compiler  8.0
-@
-
-
-1.1
-log
-@new
-@
-text
-@d29 1
-a29 1
-         -byteswapio -Dosf_ieee -DSP_MP -DSP_LIBFFTW3 -c  
-@
diff --git src/Makefile_samples/RCS/Makefile_osx_64,v src/Makefile_samples/RCS/Makefile_osx_64,v
deleted file mode 100644
index ad89374d..00000000
--- src/Makefile_samples/RCS/Makefile_osx_64,v
+++ /dev/null
@@ -1,101 +0,0 @@
-head	1.2;
-access;
-symbols;
-locks; strict;
-comment	@# @;
-
-
-1.2
-date	2010.07.23.17.54.27;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	2009.04.28.13.16.59;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.2
-log
-@*** empty log message ***
-@
-text
-@#
-# PURPOSE: MAKEFILE FOR OSX 64 SPIDER using FFTW on 2 or more processors 
-# USING:   Intel Compiler
-#
-# NOTES:   Non-native mode byte ordering on:  Pentium 4/Xeon  running 64 bit Mac OS
-#          FFTW3 must be configured with: --enable-float --enable-openmp
-#          You may ignore any undefined SUFFIX
-#          To create executable: make -f Makefile_osx_64
-
-SHELL    = /bin/sh
-
-PGM      = spider
-
-WHICH    = osx_64
-
-# Using: Intel Fortran compiler  11.0
-#COMP     =  /opt/intel/Compiler/11.0/059/bin/ia32/ifort 
-COMP     =  ifort 
-
-EXE      = $(PGM)_$(WHICH)$(SUFFIX)
-
-# -O3               : Invokes level 3 optimization 
-# -openmp           : Invokes OMP multi processor support
-# -assume byterecl  ; Sets units for the OPEN statement RECL specifier
-# -WB               : Sets compile-time bounds check warning not error
-# -auto             : Sets  all  local,  non-SAVEd  variables allocated on run-time stack
-# -parallel         : Sets the auto-parallelizer to generate multithreaded code safe loops
-# -cm               : Sets no messages about questionable programming practices
-# -fast             : Sets options -ipo, -O3, -no-prec-div, -static, and -xP (FAILS TO LINK)
-# -DSP_MP           : cpp flag to activate OMP 
-# -DSP_LIBFFTW3     : cpp flag to activate FFTW3 instead of native SPIDER FFT
-# -DSP_IFC          : cpp flag to set use of Intel Fortran Compiler
-
-FFLAGS = -static -O3 -openmp -cpp -WB -auto -cm -assume byterecl -DSP_MP -DSP_LIBFFTW3 -DSP_IFC -c
-
-# Link with multi processor support
-LF = -openmp
-
-# FFTW static library location
-FFTWLIBDIR = ../fftw/fftw3-osx-64/lib
-
-LIB    = $(EXE).a
-
-AFLAGS = -r
-
-# Static Link with FFTW libraries with threads and with static Intel compiler library
-LINKLIBS  = -L$(FFTWLIBDIR) -lfftw3f -lfftw3f_threads -i-static
-
-.PRECIOUS : ../bin/$(EXE) $(LIB)
-
-include Makefile.inc
-
-include Makebody.inc
-@
-
-
-1.1
-log
-@new
-@
-text
-@d2 2
-a3 1
-# --  MAKEFILE FOR GNU/Linux SPIDER using FFTW on 2 or more processors --
-d5 4
-a8 6
-# Note:  To create executable: make -f Makefile_osx_64
-#
-#        Non-native mode byte ordering on:  Pentium 4/Xeon  for 64 bit Mac OS
-#        FFTW3 must be configured with: --enable-float --enable-openmp
-#
-# Note:  You may ignore any undefined SUFFIX
-d17 1
-@
diff --git src/Makefile_samples/RCS/Makefile_osx_64_pgi,v src/Makefile_samples/RCS/Makefile_osx_64_pgi,v
deleted file mode 100644
index 7dc21c6b..00000000
--- src/Makefile_samples/RCS/Makefile_osx_64_pgi,v
+++ /dev/null
@@ -1,113 +0,0 @@
-head	1.3;
-access;
-symbols;
-locks; strict;
-comment	@# @;
-
-
-1.3
-date	2010.07.23.17.52.16;	author leith;	state Exp;
-branches;
-next	1.2;
-
-1.2
-date	2009.11.30.16.21.11;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	2009.04.28.13.15.18;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.3
-log
-@*** empty log message ***
-@
-text
-@#
-# PURPOSE:  MAKEFILE FOR OSX SPIDER using FFTW on 2 or more processors
-# USING:    PGI Compiler
-#
-# TARGET:   Non-native mode byte ordering SPIDER on:  Pentium 4/Xeon  for Mac OS
-#
-# NOTE:     FFTW3 must be configured with: --enable-float 
-# NOTE:     You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
-# NOTE:     To create executable: make -f Makefile_osx_64_pgi
-
-SHELL    = /bin/sh
-
-PGM      = spider
-
-WHICH    = osx_64_pgi
-
-# Using: 64 bit PGI Fortran compiler  
-COMP     =  pgf95 
-
-EXE      = $(PGM)_$(WHICH)$(SUFFIX)
-
-# -O3               : Invokes level 3 optimization 
-# -mp               : Invokes OMP multi processor support
-# -DSP_MP           : cpp flag to activate OMP 
-# -DSP_LIBFFTW3     : cpp flag to activate FFTW3 
-
-FFLAGS = -O3 -Mpreprocess -mp -Kieee -Minfo \
-         -byteswapio -DSP_MP -DSP_LIBFFTW3 -c  
-
-# Link with multi processor support
-LF = -mp
-
-# FFTW static library location
-FFTWLIBDIR = ../fftw/fftw3-osx-64-pgi/lib
-
-LIB    = $(EXE).a
-
-AFLAGS = -r
-
-# Static Link with FFTW libraries with threads 
-LINKLIBS  = -L$(FFTWLIBDIR) -lfftw3f -lfftw3f_threads -lm  
-
-.PRECIOUS : ../bin/$(EXE) $(LIB)
-
-include Makefile.inc
-
-include Makebody.inc
-@
-
-
-1.2
-log
-@removed -Dosf_ieee
-@
-text
-@d2 2
-a3 1
-# --  MAKEFILE FOR GNU/Linux SPIDER using FFTW on 2 or more processors --
-d5 5
-a9 6
-# Note:  To create executable: make -f Makefile_osx_64_pgi
-#_
-#        Non-native mode byte ordering on:  64 bit Intel Mac OS X
-#        FFTW3 must be configured with: --enable-float --
-
-# Note:  You may ignore any undefined SUFFIX
-d17 1
-a17 1
-# Using: 64 bit PGI Fortran compiler  8.0
-@
-
-
-1.1
-log
-@new
-@
-text
-@d28 1
-a28 1
-         -byteswapio -Dosf_ieee -DSP_MP -DSP_LIBFFTW3 -c  
-@
diff --git src/Makefile_samples/RCS/Makefile_osx_mp_xeon_pgi,v src/Makefile_samples/RCS/Makefile_osx_mp_xeon_pgi,v
deleted file mode 100644
index 65e52567..00000000
--- src/Makefile_samples/RCS/Makefile_osx_mp_xeon_pgi,v
+++ /dev/null
@@ -1,109 +0,0 @@
-head	1.3;
-access;
-symbols;
-locks; strict;
-comment	@# @;
-
-
-1.3
-date	2009.11.30.16.20.03;	author leith;	state Exp;
-branches;
-next	1.2;
-
-1.2
-date	2008.11.03.15.52.09;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	2008.08.13.13.12.09;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.3
-log
-@removed -Dosf_ieee
-@
-text
-@# ------  MAKEFILE FOR OSX SPIDER using FFTW3 on 2 or more processors --
-#         using PGI compiler
-#
-# Note:  To create executable: make -f Makefile_osx_mp_xeon_pgi
-#
-#        Non-native mode byte ordering on:  Pentium 4/Xeon  for Mac OS10
-#        FFTW3 must be configured with: --enable-float --enable-type-prefix
-#
-SHELL    = /bin/sh
-
-PGM      = spider
-
-WHICH    = mp_xeon_pgi
-
-# Using: Portland Compilers
-COMP	 = pgf95
-
-EXE      = $(PGM)_osx_$(WHICH)
-
-# -O2             : Invokes level 2 optimization (-O3 causes some run time problems with PGI
-#                   compiler on SPIDER code)
-# -mp             : Invokes multi processor support
-# -tp p7          : Targets 32 or 64 bit Pentium4 with 32 bit memory addresses, 
-#                   supports SSE 1 & SSE2 FP
-# -tp p7-64       : Targets 64 bit Pentium4 with 64 bit memory addresses,
-#                   supports SSE1, SSE 2 & SSE3 FP
-# -tp x64         : Targets unified 64 bit AMD & Intel binaries
-# -fast           : Selects an appropriate set of optimization flags usually 
-#                   including -O2 - Munroll -Mnoframe
-# -fastsse        : Selects an appropriate set of flags including SSE 
-#                   support usually including -O2 -Munroll -Mnoframe -Mvect=sse -Mcache_align 
-# -mcmodel=medium : Allows use of >2GB data area on 64 bit machines
-
-FFLAGS = -O2 -Mpreprocess -tp=p7 -fastsse -Kieee -Minfo -mp -byteswapio -DSP_MP -DSP_LIBFFTW3 -c
-
-# Link with multi processor support
-LF =  -mp -\#
-
-LIB    = $(EXE).a
-
-AFLAGS = -r
-
-# Link with FFTW3 static libraries without threads
-LINKLIBS  = ../fftw/fftw3-osx/lib/libfftw3f.a
-
-.PRECIOUS : ../bin/$(EXE) $(LIB)
-
-include Makefile.inc
-
-include Makebody.inc
-@
-
-
-1.2
-log
-@removed fftw in name
-@
-text
-@d34 1
-a34 1
-FFLAGS = -O2 -Mpreprocess -tp=p7 -fastsse -Kieee -Minfo -mp -byteswapio -Dosf_ieee -DSP_MP -DSP_LIBFFTW3 -c
-@
-
-
-1.1
-log
-@from Eisenbraun
-@
-text
-@d4 1
-a4 1
-# Note:  To create executable: make -f Makefile_osx_mpfftw_xeon_pgi
-d13 1
-a13 1
-WHICH    = mpfftw_xeon_pgi
-@
-
diff --git src/Makefile_samples/RCS/Makefile_spideroptd,v src/Makefile_samples/RCS/Makefile_spideroptd,v
deleted file mode 100644
index 7c271683..00000000
--- src/Makefile_samples/RCS/Makefile_spideroptd,v
+++ /dev/null
@@ -1,253 +0,0 @@
-head	1.9;
-access;
-symbols
-	pre_fftwrings:1.5;
-locks
-	leith:1.9; strict;
-comment	@# @;
-
-
-1.9
-date	2011.03.03.18.37.58;	author leith;	state Exp;
-branches;
-next	1.8;
-
-1.8
-date	2009.11.30.15.51.36;	author leith;	state Exp;
-branches;
-next	1.7;
-
-1.7
-date	2009.02.25.16.30.14;	author leith;	state Exp;
-branches;
-next	1.6;
-
-1.6
-date	2008.09.17.14.46.14;	author leith;	state Exp;
-branches;
-next	1.5;
-
-1.5
-date	2008.01.24.16.59.49;	author leith;	state Exp;
-branches;
-next	1.4;
-
-1.4
-date	2008.01.24.16.55.24;	author leith;	state Exp;
-branches;
-next	1.3;
-
-1.3
-date	2007.12.14.17.57.15;	author leith;	state Exp;
-branches;
-next	1.2;
-
-1.2
-date	2007.12.06.15.18.00;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	2007.02.26.18.54.41;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.9
-log
-@for pgi 11
-@
-text
-@# 
-# MAKEFILE FOR Debugging GNU/Linux SPIDER using FFTW on Opteron 64 
-# 
-# USAGE: make -f Makefile_spideroptd
-#
-# Using: Portland Group F90 compiler
-#        Non-native mode byte ordering on:  AMD Opteron GNU/Linux 64 bit OS
-#        FFTW must be configured with: --enable-float --enable-type-prefix
-#
-# Note:  You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
-
-AFLAGS   = r
-
-SHELL    = /bin/sh
-
-# Location of PGI Fortran compiler  
-COMP       = /usr10/pgi/linux86-64/2011/bin/pgf95
-#COMP      = /usr/pgi/linux86-64/7.1/bin/pgf95
-#COMP      = /usr/pgi7.2/linux86-64/7.2-5/bin/pgf95
-#COMP      = /scratch/pgi/linux86-64/8.0-4/bin/pgf95
- COMP      = /usr10/pgi/linux86-64/2011/bin/pgf95
-
-PGM        = spider
-
-EXE        = spideroptd
-
-LIB        = spideroptd.a
-
-FFLAGS     = -g -Bstatic -tp k8-64 -fastsse -mcmodel=medium -O0 -Mpreprocess -Kieee -Minfo -byteswapio -DSP_LIBFFTW3 -c  
-
-LF         = -g -Bstatic -tp k8-64 -fastsse -mcmodel=medium $(QLFLAGS)
- 
-FFTWLIBDIR = ../fftw/fftw3-opt64/lib  
-
-LINKLIBS   = -Bstatic -L$(FFTWLIBDIR) -lfftw3f -lfftw3f_threads -lm
-
-.PRECIOUS : ../bin/$(EXE) $(LIB) 
-
-include Makefile.inc
-
-include Makebody.inc
-
-@
-
-
-1.8
-log
-@osf_ieee
-@
-text
-@d4 1
-a4 1
-# USAGE: To create debugging executable: make -f Makefile_spideroptd
-a10 2
-#
-#  USAGE:
-d12 10
-a21 1
-SHELL      = /bin/sh
-d25 1
-a25 4
-#COMP      = /usr/pgi/linux86-64/7.1/bin/pgf95
-#COMP       = /usr/pgi7.2/linux86-64/7.2-5/bin/pgf95
-#COMP       = /scratch/pgi/linux86-64/8.0-4/bin/pgf95
-COMP       = pgf95
-d27 1
-a27 1
-EXE        = $(PGM)optd
-d29 1
-a29 1
-FFLAGS     = -g -O0 -Mpreprocess -tp k8-64 -mcmodel=medium -Kieee -Minfo -byteswapio -DSP_LIBFFTW3 -c  
-d31 1
-a31 1
-LF         = -g -tp k8-64 -mcmodel=medium $(QLFLAGS)
-a33 4
-
-LIB        = $(EXE).a
-
-AFLAGS     = r
-@
-
-
-1.7
-log
-@COMP
-@
-text
-@d25 1
-a25 1
-FFLAGS     = -g -O0 -Mpreprocess -tp k8-64 -mcmodel=medium -Kieee -Minfo -byteswapio -Dosf_ieee -DSP_LIBFFTW3 -c  
-@
-
-
-1.6
-log
-@pgi7.2
-@
-text
-@d19 3
-a21 1
-COMP       = /usr/pgi7.2/linux86-64/7.2-5/bin/pgf95
-@
-
-
-1.5
-log
-@FFTW3
-@
-text
-@d2 1
-a2 1
-# MAKEFILE FOR GNU/Linux SPIDER using FFTW on Opteron 64 
-d4 1
-a4 1
-# USAGE:  To create debugging executable: make -f Makefile_spideroptd
-d10 1
-a10 1
-# Note:    You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
-a12 2
-#  cd /usr/local/spider/src
-#  make -f Makefile_spideroptd
-d18 2
-a19 1
-COMP       = /usr/pgi/linux86-64/7.1/bin/pgf95
-a32 1
-#LINKLIBS  = -Bstatic -L$(FFTWLIBDIR) -lsrfftw -lsfftw -lm
-@
-
-
-1.4
-log
-@tpk8-64
-@
-text
-@d24 1
-a24 1
-FFLAGS     = -g -O0 -Mpreprocess -tp k8-64 -mcmodel=medium -Kieee -Minfo -byteswapio -Dosf_ieee -DSP_LIBFFTW -c  
-@
-
-
-1.3
-log
-@fftw3
-@
-text
-@d24 1
-a24 5
-#FFLAGS    = -g -O0 -Mpreprocess -tp k8-64 -mcmodel=medium -Kieee -Minfo -byteswapio -Dosf_ieee -DSP_LIBFFTW -c  
-FFLAGS     = -g -O0 -Mpreprocess           -mcmodel=medium -Kieee -Minfo -byteswapio -Dosf_ieee -DSP_LIBFFTW3 -c  
-
-#LF        = -g -tp k8-64 -mcmodel=medium $(QLFLAGS)
-LF         = -g           -mcmodel=medium $(QLFLAGS)
-d26 2
-@
-
-
-1.2
-log
-@fftw library name
-@
-text
-@d20 1
-a20 1
-COMP       = /usr/pgi/linux86-64/6.0/bin/pgf95
-d24 2
-a25 1
-FFLAGS     = -g -O0 -Mpreprocess -tp k8-64 -mcmodel=medium -Kieee -Minfo -byteswapio -Dosf_ieee -DSP_LIBFFTW -c  
-d27 2
-a28 1
-LF         = -g -tp k8-64 -mcmodel=medium $(QLFLAGS)
-d30 1
-a30 1
-FFTWLIBDIR = ../fftw/fftw-opt64/lib  
-d36 2
-a37 1
-LINKLIBS   = -Bstatic -L$(FFTWLIBDIR) -lsrfftw -lsfftw -lm
-@
-
-
-1.1
-log
-@new
-@
-text
-@d28 1
-a28 1
-FFTWLIBDIR = ../fftw/fftw-opt64.pgi6.0/lib  
-@
-
diff --git src/Makefile_samples/RCS/Makefile_spideroptf,v src/Makefile_samples/RCS/Makefile_spideroptf,v
deleted file mode 100644
index c58ae510..00000000
--- src/Makefile_samples/RCS/Makefile_spideroptf,v
+++ /dev/null
@@ -1,142 +0,0 @@
-head	1.4;
-access;
-symbols;
-locks; strict;
-comment	@# @;
-
-
-1.4
-date	2009.11.30.16.09.32;	author leith;	state Exp;
-branches;
-next	1.3;
-
-1.3
-date	2009.02.25.16.30.21;	author leith;	state Exp;
-branches;
-next	1.2;
-
-1.2
-date	2008.09.17.14.49.56;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	2008.05.22.15.22.38;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.4
-log
-@removed -Dosf_ieee
-@
-text
-@# 
-# PURPOSE: Makefile to create profiling executable for GNU/Linux SPIDER 
-#          using FFTW on Opteron 64
-#
-# USAGE:   make -f Makefile_spideroptpf
-#
-# USING:   Portland Group F90 compiler
-#          Non-native mode byte ordering on:  AMD Opteron GNU/Linux 64 bit OS
-#          FFTW must be configured with: --enable-float --enable-type-prefix
-#
-# NOTE:    You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
-
-SHELL    = /bin/sh
-
-PGM      = spider
-
-WHICH    = optf
-
-# Location of Fortran compiler for PGI7.2 
-#COMP    = /usr/pgi/linux86-64/7.1/bin/pgf95
-#COMP    = /usr/pgi7.2/linux86-64/7.2-5/bin/pgf95
-#COMP    = /scratch/pgi/linux86-64/8.0-4/bin/pgf95
-COMP     = pgf95
-
-EXE      = $(PGM)$(WHICH)$(SUFFIX)
-
-# -O2             : Invokes level 2 optimization (-O3 causes some run time problems with PGI compiler on SPIDER code)
-# -mp             : Invokes multi processor support
-# -tp p6          : Targets 32 bit Pentium Pro/II/III with 32 bit memory addresses, supports x87 FP
-# -tp p7          : Targets 32 or 64 bit Pentium4 with 32 bit memory addresses, supports SSE1 & SSE2 FP
-# -tp p7-64       : Targets 64 bit Pentium4 with 64 bit memory addresses, supports SSE1, SSE2 & SSE3 FP
-# -tp x64         : Targets unified 64 bit AMD & Intel binaries (samoa)
-# -tp k8-64e      : Targets AMD Opteron Revision E or AMD Turion (cluster)
-# -Mipa=fast      : Invokes interprocedural analysis 
-# -fast           : Selects an appropriate set of optimization flags usually including -O2 -Munroll -Mnoframe
-# -fastsse        : Selects an appropriate set of flags including SSE support usually including -O2 -Munroll -Mnoframe -Mvect=sse -Mcache_align 
-# -pc 64          : Sets precision of FPU operations
-# -mcmodel=medium : Allows use of >2GB data area 
-# -Mprof=lines    : Allows use of profiler 
-
-# cp /usr/pgi7.2/linux86-64/7.2-5/libso/libpgnuma.a /usr/lib64/libnuma.a
-
-FFLAGS  = -Mprof=lines -Mpreprocess -tp k8-64 -fastsse -mcmodel=medium -mp -Kieee -Minfo -byteswapio -DSP_MP -DSP_LIBFFTW3 -c  
-
-# Link with multi processor support
-LF  = -Mprof=lines -tp k8-64 -fastsse -mp -mcmodel=medium $(QLFLAGS)
-
-# FFTW library location for  pgi7.1 static
-FFTWLIBDIR   = ../fftw/fftw3-opt64/lib
-
-LIB    = $(EXE).a
-
-AFLAGS = r
-
-# Link with FFTW static libraries with threads and with math library
-LINKLIBS  = -Bstatic -L$(FFTWLIBDIR) -lfftw3f -lfftw3f_threads -mp -lm
-
-.PRECIOUS : ../bin/$(EXE) $(LIB) 
-
-include Makefile.inc
-
-include Makebody.inc
-
-@
-
-
-1.3
-log
-@COMP
-@
-text
-@d43 1
-a43 1
-FFLAGS  = -Mprof=lines -Mpreprocess -tp k8-64 -fastsse -mcmodel=medium -mp -Kieee -Minfo -byteswapio -Dosf_ieee -DSP_MP -DSP_LIBFFTW3 -c  
-@
-
-
-1.2
-log
-@pgi7.2
-@
-text
-@d21 3
-a23 1
-COMP     = /usr/pgi7.2/linux86-64/7.2-5/bin/pgf95
-@
-
-
-1.1
-log
-@new
-@
-text
-@d2 1
-a2 1
-# PURPOSE: Makefiole to create profiling executable for GNU/Linux SPIDER 
-d19 3
-a21 2
-# Location of Fortran compiler for PGI7.1 
-COMP     = /usr/pgi/linux86-64/7.1/bin/pgf95
-d39 1
-a39 1
-# cp /usr/pgi/linux86-64/7.1-2/libso/libpgnuma.a /usr/lib64/libnuma.a
-@
-
diff --git src/Makefile_samples/RCS/Makefile_sun,v src/Makefile_samples/RCS/Makefile_sun,v
deleted file mode 100644
index 8d0ad54e..00000000
--- src/Makefile_samples/RCS/Makefile_sun,v
+++ /dev/null
@@ -1,119 +0,0 @@
-head	1.3;
-access;
-symbols
-	pre_fftwrings:1.3
-	pre_opfiles:1.3
-	src:1.3
-	best-code:1.3
-	x-named-regs:1.3
-	x:1.3
-	v13-00:1.3
-	pre_GPL:1.3
-	prec_CA:1.3
-	noindx:1.3
-	Bproc:1.3
-	oct21:1.1
-	last77:1.1;
-locks; strict;
-comment	@# @;
-
-
-1.3
-date	2000.04.18.20.31.44;	author leith;	state Exp;
-branches;
-next	1.2;
-
-1.2
-date	2000.04.18.20.28.50;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	97.07.23.19.14.48;	author pawel;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.3
-log
-@SP_UNIX cpp variable no longer needed.
-@
-text
-@# 
-# ------ MAKEFILE FILE FOR SUN SPIDER for 4.0.2 ----------------
-# 
-#  ArDean Leith --
-#  
-# At Albany this can be run remotely from hvem, except the link should
-# be done in hvem/usr4/leith/spider_sun.  Copy library & object file to
-# that directory, run ranlib, then run:
-# f77 -O0 spider_sun.o spider_sun.a -o spider_sun
-# copy result back to SGI spider directory
-#
-#
-FFLAGS = -cpp -DSP_SUN4 -c -O0 
- 
-LF     = -O0 
-
-PGM    = spider_sun
-
-LIB    = spider_sun.a
- 
-.PRECIOUS :   $(LIB) ../bin/$(PGM)
-SHELL  = /bin/sh
- 
-# Makefile.inc has listing of library elements (files) in SPIDER
-include Makefile.inc
-
-../bin/$(PGM) : $(PGM).o $(LIB)
-	@@\rm -f  ../bin/$(PGM)
-	f77 $(LF) $(PGM).o $(LIB) -o ../bin/$(PGM)
- 
-$(PGM).o  : spider.f
-	/lib/cpp -PC -DSP_SUN4 spider.f $(PGM).F
-	f77 $(FFLAGS) -o $(PGM).o  $(PGM).F 
-  
-$(LIB) :  $(ELEMENTS)
-	@@echo library filled
-	ranlib $(LIB)
-
-$(ELEMENTS) : 
-	/lib/cpp -PC -DSP_SUN4 $*.f $*.F
-	f77 $(FFLAGS) $*.F
-	$(AR) r $(LIB) $*.o
-	@@\rm $*.o $*.F
-
-
-
-  
-  
-@
-
-
-1.2
-log
-@SP_UNIX cpp variable no longer needed.
-@
-text
-@d32 1
-a32 1
-	/lib/cpp -PC -DSP_UNIX -DSP_SUN4 spider.f $(PGM).F
-d40 1
-a40 1
-	/lib/cpp -PC -DSP_UNIX -DSP_SUN4 $*.f $*.F
-@
-
-
-1.1
-log
-@Initial revision
-@
-text
-@d13 1
-a13 1
-FFLAGS = -cpp -DSP_UNIX  -DSP_SUN4 -c -O0 
-@
diff --git src/Makefile_samples/RCS/Makefile_sunsparc,v src/Makefile_samples/RCS/Makefile_sunsparc,v
deleted file mode 100644
index 4d477999..00000000
--- src/Makefile_samples/RCS/Makefile_sunsparc,v
+++ /dev/null
@@ -1,118 +0,0 @@
-head	1.3;
-access;
-symbols
-	pre_fftwrings:1.3
-	pre_opfiles:1.3
-	src:1.3
-	best-code:1.3
-	x-named-regs:1.3
-	x:1.3
-	v13-00:1.3
-	pre_GPL:1.3
-	prec_CA:1.3
-	noindx:1.3
-	Bproc:1.3
-	oct21:1.1
-	last77:1.1;
-locks; strict;
-comment	@# @;
-
-
-1.3
-date	2000.04.18.20.31.47;	author leith;	state Exp;
-branches;
-next	1.2;
-
-1.2
-date	2000.04.18.20.28.51;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	97.07.23.19.15.06;	author pawel;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.3
-log
-@SP_UNIX cpp variable no longer needed.
-@
-text
-@# 
-# Makefile for WEB system on SUN SPARC   Oct 95 Mahieddine Ladjadj
-#
-#	SUN SPARC: 
-#		node name: xenopus running Solaris 2.4
-# 
-# to set up PATH etc...
-#     source /local/molbio/cshrc_solaris
-#
- 
-FFLAGS =  -DSP_SUN4 -c -O0 
- 
-# add -lV77 to use time, date VMS version: 09:20:57
-LF     =  -g  -lV77
-
-PGM    = spider_sunsparc
-
-LIB    = spider_sunsparc.a
- 
-.PRECIOUS :   $(LIB) ../bin/$(PGM)
-SHELL  = /bin/sh
- 
-# Makefile.inc has listing of library elements (files) in SPIDER
-include Makefile.inc
-
-../bin/$(PGM) : $(PGM).o $(LIB)
-	@@\rm -f  ../bin/$(PGM)
-	f77 $(LF) $(PGM).o $(LIB) -o ../bin/$(PGM)
- 
-$(PGM).o  : spider.f
-	@@/usr/ccs/lib/cpp -PC -DSP_SUN4 spider.f $(PGM).F
-	f77 $(FFLAGS) -o $(PGM).o  $(PGM).F 
-  
-$(LIB) :  $(ELEMENTS)
-	@@echo library filled
-#	ranlib $(LIB)
-
-$(ELEMENTS) : 
-	@@/usr/ccs/lib/cpp -PC -DSP_SUN4 $*.f $*.F
-	f77 $(FFLAGS) $*.F
-	$(AR) r $(LIB) $*.o
-	@@\rm $*.o $*.F
-
-
-
-  
-  
-@
-
-
-1.2
-log
-@SP_UNIX cpp variable no longer needed.
-@
-text
-@d31 1
-a31 1
-	@@/usr/ccs/lib/cpp -PC -DSP_UNIX -DSP_SUN4 spider.f $(PGM).F
-d39 1
-a39 1
-	@@/usr/ccs/lib/cpp -PC -DSP_UNIX -DSP_SUN4 $*.f $*.F
-@
-
-
-1.1
-log
-@Initial revision
-@
-text
-@d11 1
-a11 1
-FFLAGS =  -DSP_UNIX  -DSP_SUN4 -c -O0 
-@
diff --git src/Makefile_samples/RCS/Makefiled2,v src/Makefile_samples/RCS/Makefiled2,v
deleted file mode 100755
index 1e984980..00000000
--- src/Makefile_samples/RCS/Makefiled2,v
+++ /dev/null
@@ -1,195 +0,0 @@
-head	1.7;
-access;
-symbols
-	best-code:1.6
-	x-named-regs:1.6
-	x:1.6
-	v13-00:1.6
-	pre_GPL:1.6
-	prec_CA:1.6
-	noindx:1.6
-	Bproc:1.5
-	oct21:1.4
-	last77:1.2;
-locks; strict;
-comment	@# @;
-
-
-1.7
-date	2006.07.31.15.14.55;	author leith;	state dead;
-branches;
-next	1.6;
-
-1.6
-date	2002.06.05.20.15.47;	author leith;	state Exp;
-branches;
-next	1.5;
-
-1.5
-date	2000.04.18.20.28.53;	author leith;	state Exp;
-branches;
-next	1.4;
-
-1.4
-date	99.06.03.15.56.32;	author leith;	state Exp;
-branches;
-next	1.3;
-
-1.3
-date	99.04.15.14.46.35;	author leith;	state Exp;
-branches;
-next	1.2;
-
-1.2
-date	99.03.19.15.39.45;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	98.06.16.20.24.12;	author pawel;	state Exp;
-branches;
-next	;
-
-
-desc
-@O0
-@
-
-
-1.7
-log
-@obsolete
-@
-text
-@# 
-#  MAKEFILE FOR SGI SPIDER ------ spider2 (old spider5)
-# 
-#  ArDean Leith -- 11 MAY 1994
-#
-#  creates executable for: 
-#  processor      Irix versions  
-#  ---------    ---------------------------------------
-#   R4***      5.2, 5.3, & 6.2 (sub-optimal on Irix 6.2)
-#   R5000      5.3  6.2        (sub-optimal on Irix 6.2)
-#   R8000      6.0, 6.1, & 6.2 (sub-optimal)
-#   R10000     6.2             (sub-optimal)
-# 
-# Note:    You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
-#
- 
-SHELL  = /bin/sh
-
-COMP   = f77
-
-PGM    = spider
-
-EXE    = spider2$(SUFFIX)
-
-FFLAGS   = -mips2 -32 -O0 -old_rl $(QFFLAGS) -c
-
-LF       = -mips2 -32 $(QLFLAGS)
-
-LIB      = $(EXE).a
- 
-AFLAGS   = r
-
-.PRECIOUS :   $(LIB) ../bin/$(EXE)
- 
-include Makefile.inc
-
-include Makebody.inc
-
-
-  
-  
-@
-
-
-1.6
-log
-@*** empty log message ***
-@
-text
-@@
-
-
-1.5
-log
-@SP_UNIX cpp variable no longer needed.
-@
-text
-@d17 8
-d29 1
-a29 3
-PGM      = spider2$(SUFFIX)
-
-LIB      = $(PGM).a
-a30 2
-SHELL    = /bin/sh
-
-d33 1
-a33 1
-.PRECIOUS :   $(LIB) ../bin/$(PGM)
-d37 1
-a37 1
-#include Makebody.inc can not use as it is f90
-a38 13
-../bin/$(PGM) : $(PGM).o $(LIB)
-	f77 $(LF) $(PGM).o $(LIB) $(LINKLIBS) -o ../bin/$(PGM)_tmp 
-	@@chmod ug+w ../bin/$(PGM)_tmp
-
-$(PGM).o  : spider.f
-	f77 $(FFLAGS) -o $(PGM).o  spider.f 
-  
-$(LIB) : $(ELEMENTS)
-	@@echo "        linking $(PGM) now for F77 ----"
-.f.a:
-	f77 $(FFLAGS) $<
-	$(AR) $(AFLAGS) $(LIB) $*.o
-	@@\rm $*.o
-@
-
-
-1.4
-log
-@makes _tmp file now not Nextversion
-@
-text
-@d17 1
-a17 1
-FFLAGS   = -DSP_UNIX -mips2 -32 -O0 -old_rl $(QFFLAGS) -c
-@
-
-
-1.3
-log
-@inlined Makebody.inc
-@
-text
-@a37 2
-	@@echo "Creating: `Nextversion ../bin/$(PGM)`"
-	@@\mv ../bin/$(PGM)_tmp ../bin/`Nextversion ../bin/$(PGM)`
-@
-
-
-1.2
-log
-@removed SP_ALLOC
-@
-text
-@d33 1
-a33 1
-include Makebody.inc
-d35 15
-@
-
-
-1.1
-log
-@Initial revision
-@
-text
-@d17 1
-a17 1
-FFLAGS   = -DSP_UNIX -DSP_ALLOC -mips2 -32 -O0 -old_rl $(QFFLAGS) -c
-@
diff --git src/Makefile_samples/RCS/Makefiled3,v src/Makefile_samples/RCS/Makefiled3,v
deleted file mode 100755
index dff4e28a..00000000
--- src/Makefile_samples/RCS/Makefiled3,v
+++ /dev/null
@@ -1,184 +0,0 @@
-head	1.7;
-access;
-symbols
-	best-code:1.6
-	x-named-regs:1.6
-	x:1.6
-	v13-00:1.6
-	pre_GPL:1.6
-	prec_CA:1.6
-	noindx:1.6
-	Bproc:1.5
-	oct21:1.3
-	last77:1.3;
-locks; strict;
-comment	@# @;
-
-
-1.7
-date	2006.07.31.15.15.01;	author leith;	state dead;
-branches;
-next	1.6;
-
-1.6
-date	2002.06.05.20.15.48;	author leith;	state Exp;
-branches;
-next	1.5;
-
-1.5
-date	2000.04.24.20.39.47;	author leith;	state Exp;
-branches;
-next	1.4;
-
-1.4
-date	2000.04.18.20.28.56;	author leith;	state Exp;
-branches;
-next	1.3;
-
-1.3
-date	99.03.29.21.10.40;	author leith;	state Exp;
-branches;
-next	1.2;
-
-1.2
-date	99.03.19.15.39.48;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	98.06.16.20.24.48;	author pawel;	state Exp;
-branches;
-next	;
-
-
-desc
-@O0
-@
-
-
-1.7
-log
-@obsolete
-@
-text
-@# 
-#  MAKEFILE FOR SGI SPIDER -- Makefile3
-# 
-#  ArDean Leith -- 11 MAY 1994
-#
-#  creates executable for:  
-#  processor      Irix versions              # of processors
-#  ---------    ------------------------    ---------------
-#   R4***      6.2                           >= 1
-#   R5000      6.2       (sub-optimal)       >= 1
-#   R8000      6.1 & 6.2 (sub-optimal)       >= 1
-#   R10000     6.2       (sub-optimal)       >= 1
-#
-# 
-# Note:    You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
-#
-#    
-SHELL  = /bin/sh
-
-COMP   = f90
-
-PGM    = spider
-
-EXE    = spider3$(SUFFIX)
-
-#-multigot stopped compiling jan 90 al
-#FFLAGS = -DSP_LIBFFT -mips3 -n32 -O0 -bytereclen $(QFFLAGS) -c   
-#LF     = -mips3 -n32 -multigot $(QLFLAGS) 
-
-FFLAGS = -cpp -DSP_LIBFFT -mips3 -n32 -O0 -bytereclen $(QFFLAGS) -c   
-
-LF     = -mips3 -n32 $(QLFLAGS) 
-
-LINKLIBS = -lcomplib.sgimath
-
-IB    = $(EXE).a
- 
-AFLAGS = r
-
-.PRECIOUS :   $(LIB) ../bin/$(EXE)
- 
-include Makefile.inc
- 
-include Makebody.inc
- 
-@
-
-
-1.6
-log
-@*** empty log message ***
-@
-text
-@@
-
-
-1.5
-log
-@removd -DSP_F90
-@
-text
-@d20 6
-d36 1
-a36 3
-PGM    = spider3$(SUFFIX)
-
-LIB    = $(PGM).a
-d40 1
-a40 1
-.PRECIOUS :   $(LIB) ../bin/$(PGM)
-@
-
-
-1.4
-log
-@SP_UNIX cpp variable no longer needed.
-@
-text
-@d24 1
-a24 1
-FFLAGS = -cpp -DSP_F90 -DSP_LIBFFT -mips3 -n32 -O0 -bytereclen $(QFFLAGS) -c   
-@
-
-
-1.3
-log
-@f90
-@
-text
-@d21 1
-a21 1
-#FFLAGS = -DSP_UNIX -DSP_LIBFFT -mips3 -n32 -O0 -bytereclen $(QFFLAGS) -c   
-d24 1
-a24 1
-FFLAGS = -cpp -DSP_F90 -DSP_UNIX -DSP_LIBFFT -mips3 -n32 -O0 -bytereclen $(QFFLAGS) -c   
-@
-
-
-1.2
-log
-@removed SP_ALLOC
-@
-text
-@d24 1
-a24 1
-FFLAGS = -DSP_UNIX -DSP_LIBFFT -mips3 -n32 -O0 -bytereclen $(QFFLAGS) -c   
-@
-
-
-1.1
-log
-@Initial revision
-@
-text
-@d21 1
-a21 1
-#FFLAGS = -DSP_UNIX -DSP_ALLOC -DSP_LIBFFT -mips3 -n32 -O0 -bytereclen $(QFFLAGS) -c   
-d24 1
-a24 1
-FFLAGS = -DSP_UNIX -DSP_ALLOC -DSP_LIBFFT -mips3 -n32 -O0 -bytereclen $(QFFLAGS) -c   
-@
diff --git src/Makefile_samples/RCS/Makefiled4,v src/Makefile_samples/RCS/Makefiled4,v
deleted file mode 100755
index 32c62c50..00000000
--- src/Makefile_samples/RCS/Makefiled4,v
+++ /dev/null
@@ -1,191 +0,0 @@
-head	1.8;
-access;
-symbols
-	pre_fftwrings:1.7
-	pre_opfiles:1.7
-	src:1.7
-	best-code:1.7
-	x-named-regs:1.7
-	x:1.7
-	v13-00:1.7
-	pre_GPL:1.7
-	prec_CA:1.7
-	noindx:1.7
-	Bproc:1.6
-	oct21:1.4
-	last77:1.4;
-locks; strict;
-comment	@# @;
-
-
-1.8
-date	2009.04.17.15.23.36;	author leith;	state dead;
-branches;
-next	1.7;
-
-1.7
-date	2002.06.05.20.15.49;	author leith;	state Exp;
-branches;
-next	1.6;
-
-1.6
-date	2000.04.24.20.39.43;	author leith;	state Exp;
-branches;
-next	1.5;
-
-1.5
-date	2000.04.18.20.28.59;	author leith;	state Exp;
-branches;
-next	1.4;
-
-1.4
-date	99.03.29.21.10.43;	author leith;	state Exp;
-branches;
-next	1.3;
-
-1.3
-date	99.03.29.15.53.56;	author leith;	state Exp;
-branches;
-next	1.2;
-
-1.2
-date	99.03.19.15.39.50;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	98.06.16.20.22.43;	author pawel;	state Exp;
-branches;
-next	;
-
-
-desc
-@O0
-@
-
-
-1.8
-log
-@obsolete SGI
-@
-text
-@# 
-#  MAKEFILE FOR SGI SPIDER -- Makefile4
-# 
-#  ArDean Leith -- 3 Mar. 1997
-#
-#  creates executable for:  
-#  processor      Irix versions           # processors
-#  ---------    ---------------           --------------------
-#   R5000      6.2                        >= 1 (no parallel code)
-#   R8000      6.1 & 6.2                  >= 1 (no parallel code)
-#   R10000     6.2                        >= 1 (no parallel code)
-# 
-# Note:    You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
-#
- 
-SHELL  = /bin/sh
-
-COMP   = f90
-
-PGM    = spider
-
-EXE    = spider4$(SUFFIX)
-
-FFLAGS = -cpp -DSP_LIBFFT -mips4 -n32 -O0 -bytereclen $(QFFLAGS) -c   
-
-LF     = -mips4 -n32 -multigot $(QLFLAGS)  
-
-LINKLIBS = -lcomplib.sgimath
-
-LIB    = $(EXE).a
- 
-AFLAGS = r
-
-.PRECIOUS :   $(LIB) ../bin/$(EXE)
- 
-include Makefile.inc
- 
-include Makebody.inc
- 
-@
-
-
-1.7
-log
-@*** empty log message ***
-@
-text
-@@
-
-
-1.6
-log
-@removd -DSP_F90
-@
-text
-@d18 6
-d30 1
-a30 3
-PGM    = spider4$(SUFFIX)
-
-LIB    = $(PGM).a
-d34 1
-a34 1
-.PRECIOUS :   $(LIB) ../bin/$(PGM)
-@
-
-
-1.5
-log
-@SP_UNIX cpp variable no longer needed.
-@
-text
-@d18 1
-a18 1
-FFLAGS = -cpp -DSP_F90 -DSP_LIBFFT -mips4 -n32 -O0 -bytereclen $(QFFLAGS) -c   
-@
-
-
-1.4
-log
-@f90
-@
-text
-@d18 1
-a18 1
-FFLAGS = -cpp -DSP_F90 -DSP_UNIX -DSP_LIBFFT -mips4 -n32 -O0 -bytereclen $(QFFLAGS) -c   
-@
-
-
-1.3
-log
-@removed SP_R8000 flag
-@
-text
-@d18 1
-a18 1
-FFLAGS = -cpp -DSP_UNIX -DSP_LIBFFT -mips4 -n32 -O0 -bytereclen $(QFFLAGS) -c   
-@
-
-
-1.2
-log
-@removed SP_ALLOC
-@
-text
-@d18 1
-a18 1
-FFLAGS = -DSP_UNIX -DSP_R8000 -DSP_LIBFFT -mips4 -n32 -O0 -bytereclen $(QFFLAGS) -c   
-@
-
-
-1.1
-log
-@Initial revision
-@
-text
-@d18 1
-a18 1
-FFLAGS = -DSP_UNIX -DSP_ALLOC -DSP_R8000 -DSP_LIBFFT -mips4 -n32 -O0 -bytereclen $(QFFLAGS) -c   
-@
diff --git src/Makefile_samples/RCS/Makefiled4mp,v src/Makefile_samples/RCS/Makefiled4mp,v
deleted file mode 100755
index b8a7be72..00000000
--- src/Makefile_samples/RCS/Makefiled4mp,v
+++ /dev/null
@@ -1,207 +0,0 @@
-head	1.8;
-access;
-symbols
-	pre_fftwrings:1.7
-	pre_opfiles:1.7
-	src:1.7
-	best-code:1.7
-	x-named-regs:1.7
-	x:1.7
-	v13-00:1.7
-	pre_GPL:1.7
-	prec_CA:1.7
-	noindx:1.7
-	Bproc:1.6
-	oct21:1.4
-	last77:1.4;
-locks; strict;
-comment	@# @;
-
-
-1.8
-date	2009.04.17.15.23.37;	author leith;	state dead;
-branches;
-next	1.7;
-
-1.7
-date	2002.06.05.20.15.50;	author leith;	state Exp;
-branches;
-next	1.6;
-
-1.6
-date	2000.04.24.20.39.38;	author leith;	state Exp;
-branches;
-next	1.5;
-
-1.5
-date	2000.04.18.20.29.01;	author leith;	state Exp;
-branches;
-next	1.4;
-
-1.4
-date	99.03.29.21.10.46;	author leith;	state Exp;
-branches;
-next	1.3;
-
-1.3
-date	99.03.29.15.53.58;	author leith;	state Exp;
-branches;
-next	1.2;
-
-1.2
-date	99.03.19.15.39.52;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	98.06.16.20.25.23;	author pawel;	state Exp;
-branches;
-next	;
-
-
-desc
-@O0
-@
-
-
-1.8
-log
-@obsolete SGI
-@
-text
-@# 
-#  MAKEFILE FOR SGI SPIDER -- Makefile4mp
-# 
-#  ArDean Leith -- 3 Mar. 1997
-#
-#  creates executable for:  
-#  processor      Irix versions           # processors
-#  ---------    ----------------          ------------
-#   R5000      6.2                        >= 2
-#   R8000      6.1 & 6.2                  >= 2
-#   R10000     6.2                        >= 2
-#
-# Warning: -O3 optimization gives wrong results on some calculations
-#          I suggest you do not increase the optimization level
-# 
-# Note:    You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
-#
-SHELL  = /bin/sh
-
-COMP   = f90
-
-PGM    = spider
-
-EXE    = spider4mp$(SUFFIX)
-
-##FFLAGS = -DSP_MP -DSP_LIBFFT -xgot -O0 -mp -mips4 -n32 -bytereclen $(QFFLAGS) -c   
-##LF     = -mp -mips4 -n32 -xgot $(QLFLAGS) 
-# multigot replaced  Feb 13 98 al
-
-FFLAGS = -cpp -DSP_MP -DSP_LIBFFT -O0 -mp -mips4 -n32 -bytereclen $(QFFLAGS) -c   
-
-LF     = -mp -mips4 -n32 -multigot $(QLFLAGS) 
-
-LINKLIBS = -lcomplib.sgimath_mp 
- 
-LIB    = $(EXE).a
- 
-AFLAGS = r
-
-.PRECIOUS :   $(LIB) ../bin/$(EXE)
-
-include Makefile.inc
-
-include Makebody.inc
- 
-@
-
-
-1.7
-log
-@*** empty log message ***
-@
-text
-@@
-
-
-1.6
-log
-@removd -DSP_F90
-@
-text
-@d20 1
-d22 4
-d36 1
-a36 3
-PGM    = spider4mp$(SUFFIX)
-
-LIB    = $(PGM).a
-d40 1
-a40 1
-.PRECIOUS :   $(LIB) ../bin/$(PGM)
-@
-
-
-1.5
-log
-@SP_UNIX cpp variable no longer needed.
-@
-text
-@d25 1
-a25 1
-FFLAGS = -cpp -DSP_F90 -DSP_MP -DSP_LIBFFT -O0 -mp -mips4 -n32 -bytereclen $(QFFLAGS) -c   
-@
-
-
-1.4
-log
-@f90
-@
-text
-@d21 1
-a21 1
-##FFLAGS = -DSP_UNIX -DSP_MP -DSP_LIBFFT -xgot -O0 -mp -mips4 -n32 -bytereclen $(QFFLAGS) -c   
-d25 1
-a25 1
-FFLAGS = -cpp -DSP_F90 -DSP_UNIX -DSP_MP -DSP_LIBFFT -O0 -mp -mips4 -n32 -bytereclen $(QFFLAGS) -c   
-@
-
-
-1.3
-log
-@removed SP_R8000 flag
-@
-text
-@d25 1
-a25 1
-FFLAGS = -DSP_UNIX -DSP_MP -DSP_LIBFFT -O0 -mp -mips4 -n32 -bytereclen $(QFFLAGS) -c   
-@
-
-
-1.2
-log
-@removed SP_ALLOC
-@
-text
-@d21 1
-a21 1
-##FFLAGS = -DSP_UNIX -DSP_R8000 -DSP_MP -DSP_LIBFFT -xgot -O0 -mp -mips4 -n32 -bytereclen $(QFFLAGS) -c   
-d24 2
-a25 1
-FFLAGS = -DSP_UNIX -DSP_R8000 -DSP_MP -DSP_LIBFFT -O0 -mp -mips4 -n32 -bytereclen $(QFFLAGS) -c   
-@
-
-
-1.1
-log
-@Initial revision
-@
-text
-@d21 1
-a21 1
-##FFLAGS = -DSP_UNIX -DSP_ALLOC -DSP_R8000 -DSP_MP -DSP_LIBFFT -xgot -O0 -mp -mips4 -n32 -bytereclen $(QFFLAGS) -c   
-d24 1
-a24 1
-FFLAGS = -DSP_UNIX -DSP_ALLOC -DSP_R8000 -DSP_MP -DSP_LIBFFT -O0 -mp -mips4 -n32 -bytereclen $(QFFLAGS) -c   
-@
diff --git src/Makefile_samples/RCS/Makefilemp_decfftw,v src/Makefile_samples/RCS/Makefilemp_decfftw,v
deleted file mode 100755
index 6ef63f3b..00000000
--- src/Makefile_samples/RCS/Makefilemp_decfftw,v
+++ /dev/null
@@ -1,130 +0,0 @@
-head	1.4;
-access;
-symbols
-	best-code:1.3
-	x-named-regs:1.3
-	x:1.3
-	v13-00:1.3
-	pre_GPL:1.3
-	prec_CA:1.3
-	noindx:1.3
-	Bproc:1.3;
-locks; strict;
-comment	@# @;
-
-
-1.4
-date	2006.07.31.15.20.20;	author leith;	state dead;
-branches;
-next	1.3;
-
-1.3
-date	2000.05.25.15.16.52;	author leith;	state Exp;
-branches;
-next	1.2;
-
-1.2
-date	2000.05.24.17.26.05;	author leith;	state Exp;
-branches;
-next	1.1;
-
-1.1
-date	2000.05.24.15.56.40;	author leith;	state Exp;
-branches;
-next	;
-
-
-desc
-@@
-
-
-1.4
-log
-@obsolete
-@
-text
-@# 
-# ------ MAKEFILE FILE FOR DEC UNIX SPIDER using multiple processors
-# 
-# Notes: 
-#
-#       The commands for ELEMENTS are necessary
-#
-#       To create  executable:   make -f Makefilemp_decfftw ../bin/spidermp_decfftw
-#       if you only type: make  , the make facility will compile 
-#       the source code but will not create the executable.
-#
-#
-# native mode on ALPHA/OSF1 (Compaq True 64 Unix) machine
-
-FFLAGS   = -DSP_LIBFFTWMP -DSP_MP -automatic -c -fullwarn -cpp -col72 -O3 -omp -mp
-LFLAGS   = -mp -omp 
-LINKLIBS = librfftw_threads_dec.a libfftw_threads_dec.a librfftw_dec.a libfftw_dec.a -lm
-PGM      = spidermp_decfftw
-PGMSRC   = spider
-COMP     = f90
-LIB      = $(PGM).a
-
-.PRECIOUS :  ../bin/$(PGM) $(LIB) 
-
-include Makefile.inc
-
-../bin/$(PGM) : $(PGM).o $(LIB)
-	@@echo linking ../bin/$(PGM)
-	$(COMP) $(LFLAGS) $(PGM).o $(LIB) $(LINKLIBS) -o ../bin/$(PGM)
-
-$(PGM).o  : $(PGMSRC).f
-	$(COMP) $(FFLAGS) -o $(PGM).o  $(PGMSRC).f 
-
-$(LIB) :  $(ELEMENTS)
-	@@echo all object files placed in library
-
-$(ELEMENTS) : 
-	$(COMP) $(FFLAGS) $<
-	$(AR) r $(LIB) $*.o
-	@@\rm $*.o
-@
-
-
-1.3
-log
-@_dec on libfft
-@
-text
-@@
-
-
-1.2
-log
-@*** empty log message ***
-@
-text
-@d17 1
-a17 1
-LINKLIBS = librfftw_threads.a libfftw_threads.a librfftw.a libfftw.a -lm
-@
-
-
-1.1
-log
-@Initial revision
-@
-text
-@d15 7
-a21 1
-FFLAGS = -DSP_LIBFFTWMP -DSP_MP -automatic -c -fullwarn -cpp -col72 -O3 -omp -mp
-a22 10
-LFLAGS = -mp -omp 
-
-PGM    = spidermp_decfftw
-
-PGMSRC = spider
-
-COMP   = f90
-
-LIB    = $(PGM).a
-
-d29 1
-a29 1
-	$(COMP) $(LFLAGS) $(PGM).o $(LIB) -o ../bin/$(PGM)
-@
diff --git src/Nextversion src/Nextversion
old mode 100755
new mode 100644
diff --git src/RCS/CMLIMIT.INC,v src/RCS/CMLIMIT.INC,v
index 10516fa9..8de4868f 100644
--- src/RCS/CMLIMIT.INC,v
+++ src/RCS/CMLIMIT.INC,v
@@ -1,4 +1,4 @@
-head	1.26;
+head	1.27;
 access;
 symbols
 	pre_mrcs:1.26
@@ -18,6 +18,11 @@ locks; strict;
 comment	@# @;
 
 
+1.27
+date	2025.11.10.22.31.03;	author dean;	state Exp;
+branches;
+next	1.26;
+
 1.26
 date	2013.05.01.14.35.58;	author leith;	state Exp;
 branches;
@@ -153,9 +158,9 @@ desc
 @@
 
 
-1.26
+1.27
 log
-@tabs to spaces for gfort
+@*** empty log message ***
 @
 text
 @
@@ -187,7 +192,8 @@ C       THIS IS GREATER THAN MAXPRC WHICH IS NUMBER ALLOWED IN STACK
         INTEGER,PARAMETER  :: MAXPRCNAM = 90 
 
 C       MAXNAM: MAXIMUM NUMBER CHAR. IN FILE NAMES
-        INTEGER,PARAMETER  :: MAXNAM  = 80
+C       INTEGER,PARAMETER  :: MAXNAM  = 80 Changed July 2014 al
+        INTEGER,PARAMETER  :: MAXNAM  = 160
 
 C       IAPLOC: HEADER LOCATION FOR 'AP' SPECIFIC DATA
         INTEGER,PARAMETER  :: IAPLOC  = 100
@@ -195,6 +201,17 @@ C       IAPLOC: HEADER LOCATION FOR 'AP' SPECIFIC DATA
 @
 
 
+1.26
+log
+@tabs to spaces for gfort
+@
+text
+@d30 2
+a31 1
+        INTEGER,PARAMETER  :: MAXNAM  = 80
+@
+
+
 1.25
 log
 @increase NIMAXPLUS
diff --git src/RCS/LABLOCK.INC,v src/RCS/LABLOCK.INC,v
old mode 100755
new mode 100644
index 46fff9ae..2aaecc6e
--- src/RCS/LABLOCK.INC,v
+++ src/RCS/LABLOCK.INC,v
@@ -1,4 +1,4 @@
-head	1.3;
+head	1.4;
 access;
 symbols
 	pre_mrcs:1.2
@@ -18,6 +18,11 @@ symbols
 locks; strict;
 
 
+1.4
+date	2025.09.30.19.20.04;	author dean;	state Exp;
+branches;
+next	1.3;
+
 1.3
 date	2019.11.05.17.00.34;	author leith;	state Exp;
 branches;
@@ -946,20 +951,20 @@ ycc.f
 @
 
 
-1.3
+1.4
 log
-@*** empty log message ***
+@KANGLE is INTEGER
 @
 text
 @
 C       LABNEW     COMMON BLOCK FOR FILE HEADER VARIABLES
 C                  USED IN OPENFIL, FILDAT, LUNSETHDR, OPENINSTK, TILT
 
-        INTEGER  :: LABLEN,IANGLE
+        INTEGER  :: LABLEN,IANGLE,KANGLE
         REAL     :: HDR_VALS(64)
 
         REAL     :: PHI,THETA,PSI,XOFF,YOFF,ZOFF,
-     &              SCALE,FLAG,KANGLE,PHI2,THETA2,PSI2,PHI1,
+     &              SCALE,FLAG,PHI2,THETA2,PSI2,PHI1,
      &              THETA1,PSI1 
 
         COMMON/LABNEW/LABLEN,IANGLE,PHI,THETA,PSI,XOFF,YOFF,ZOFF,
@@ -977,6 +982,20 @@ C       HDR_VALS   HEADER LOCATIONS 37...101
 @
 
 
+1.3
+log
+@*** empty log message ***
+@
+text
+@d5 1
+a5 1
+        INTEGER  :: LABLEN,IANGLE
+d9 1
+a9 1
+     &              SCALE,FLAG,KANGLE,PHI2,THETA2,PSI2,PHI1,
+@
+
+
 1.2
 log
 @added HDR_VALS
diff --git src/Makeall src/RCS/Makeall,v
old mode 100755
new mode 100644
similarity index 89%
rename from src/Makeall
rename to src/RCS/Makeall,v
index 18e61f60..77445fc4
--- src/Makeall
+++ src/RCS/Makeall,v
@@ -1,4 +1,27 @@
-#! /bin/sh 
+head	1.1;
+access;
+symbols;
+locks; strict;
+comment	@# @;
+
+
+1.1
+date	2025.11.10.22.31.40;	author dean;	state Exp;
+branches;
+next	;
+
+
+desc
+@new rcs
+@
+
+
+1.1
+log
+@*** empty log message ***
+@
+text
+@#! /bin/sh 
 #
 # SOURCE:       spider/src/makeall
 #
@@ -78,3 +101,4 @@ exit
 
 
 
+@
diff --git src/RCS/Makebody.inc.send,v src/RCS/Makebody.inc.send,v
index df12e6f6..6d95c6e0 100644
--- src/RCS/Makebody.inc.send,v
+++ src/RCS/Makebody.inc.send,v
@@ -1,4 +1,4 @@
-head	1.6;
+head	1.7;
 access;
 symbols
 	pre_mrcs:1.6
@@ -19,6 +19,11 @@ locks; strict;
 comment	@# @;
 
 
+1.7
+date	2025.11.10.22.31.56;	author dean;	state Exp;
+branches;
+next	1.6;
+
 1.6
 date	2014.08.07.15.11.39;	author leith;	state Exp;
 branches;
@@ -54,16 +59,15 @@ desc
 @@
 
 
-1.6
+1.7
 log
-@cosmetic
+@*** empty log message ***
 @
 text
 @# 
 #  SOURCE:  Makebody.inc.send
 #  PURPOSE: MAKEFILE body FOR Linux SPIDER  
 #  AUTHOR:  ArDean Leith -- 13 MARCH 1997
-#  NOTE:    You may ignore undefined $(DEST) 
  
 ../bin/$(EXE) : $(EXE).o $(LIB)
 	$(COMP) $(LF) $(EXE).o $(LIB) $(LINKLIBS) -o ../bin/$(EXE)
@@ -80,6 +84,16 @@ $(LIB) : $(ELEMENTS)
 @
 
 
+1.6
+log
+@cosmetic
+@
+text
+@a4 1
+#  NOTE:    You may ignore undefined $(DEST) 
+@
+
+
 1.5
 log
 @*** empty log message ***
diff --git src/RCS/Makefile.inc,v src/RCS/Makefile.inc,v
index bed7183c..5e44a68c 100644
--- src/RCS/Makefile.inc,v
+++ src/RCS/Makefile.inc,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.3;
@@ -6,6 +6,16 @@ locks; strict;
 comment	@# @;
 
 
+1.11
+date	2025.11.10.22.34.04;	author dean;	state Exp;
+branches;
+next	1.10;
+
+1.10
+date	2025.09.21.18.33.20;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2020.02.24.19.06.06;	author leith;	state Exp;
 branches;
@@ -56,9 +66,9 @@ desc
 @@
 
 
-1.9
+1.11
 log
-@removed getstack.o   getoldstack.o    getnewstack.o
+@*** empty log message ***
 @
 text
 @# 
@@ -66,12 +76,16 @@ text
 #        This is the definitive source listing for source files
 #        compiled into SPIDER. Additional objects are also found
 #        within the corresponding source files.
- 
+#        First time run as is, then invert: lunsetmrchdr.o and lunsethdr.o
+#        and run again.  This may work?
+# 
+# $(LIB)(lunsetmrchdr.o) \
+
 ELEMENTS =  \
- $(LIB)(spider.o)    \
- $(LIB)(openinln.o)  \
  $(LIB)(lunsethdr.o) \
  $(LIB)(lunsetmrchdr.o) \
+ $(LIB)(spider.o)    \
+ $(LIB)(openinln.o)  \
  $(LIB)(fftw3.o)     \
  $(LIB)(lundoc.o)    \
  $(LIB)(apsh_tool.o) \
@@ -221,11 +235,9 @@ ELEMENTS =  \
  $(LIB)(copyf.o)   \
  $(LIB)(copyfromnik.o) \
  $(LIB)(copyfromtif.o) \
- $(LIB)(copyfromxplo.o)\
  $(LIB)(copypos.o)     \
  $(LIB)(copytojpg.o)   \
  $(LIB)(copytostk.o)   \
- $(LIB)(copytoxplor.o) \
  $(LIB)(copytovol.o)   \
  $(LIB)(copyr.o) \
  $(LIB)(copyu.o) \
@@ -405,7 +417,6 @@ ELEMENTS =  \
  $(LIB)(getdocdat.o)  \
  $(LIB)(getdoclist.o) \
  $(LIB)(getfilenum.o) \
- $(LIB)(gethedccp4.o) \
  $(LIB)(getima_q.o) \
  $(LIB)(getlbno.o)  \
  $(LIB)(getlab.o)   \
@@ -983,6 +994,44 @@ ELEMENTS =  \
 @
 
 
+1.10
+log
+@changed order of elements for library creation of mod files
+@
+text
+@d6 2
+a7 2
+#        First time run as is Then invert: lunsetmrchdr. o and  $(LIB)(lunsethdr.o)
+#        then run again??
+d9 2
+a11 1
+ $(LIB)(lunsetmrchdr.o) \
+a13 1
+ $(LIB)(lunsethdr.o) \
+@
+
+
+1.9
+log
+@removed getstack.o   getoldstack.o    getnewstack.o
+@
+text
+@d6 3
+a8 1
+ 
+d10 4
+a15 2
+ $(LIB)(lunsethdr.o) \
+ $(LIB)(lunsetmrchdr.o) \
+a164 1
+ $(LIB)(copyfromxplo.o)\
+a167 1
+ $(LIB)(copytoxplor.o) \
+a346 1
+ $(LIB)(gethedccp4.o) \
+@
+
+
 1.8
 log
 @util_11
diff --git src/RCS/Makefile_linux,v src/RCS/Makefile_linux,v
old mode 100755
new mode 100644
diff --git src/RCS/Makefile_linux.gfort,v src/RCS/Makefile_linux.gfort,v
old mode 100755
new mode 100644
diff --git src/RCS/Makefile_linux_intel_27.gfort,v src/RCS/Makefile_linux_intel_27.gfort,v
new file mode 100644
index 00000000..8987d8b2
--- /dev/null
+++ src/RCS/Makefile_linux_intel_27.gfort,v
@@ -0,0 +1,207 @@
+head	1.2;
+access;
+symbols;
+locks; strict;
+comment	@# @;
+
+
+1.2
+date	2025.11.10.22.33.58;	author dean;	state Exp;
+branches;
+next	1.1;
+
+1.1
+date	2025.09.21.19.00.47;	author dean;	state Exp;
+branches;
+next	;
+
+
+desc
+@Makefile for creating Makefile_linux_intel_gfort_27
+@
+
+
+1.2
+log
+@*** empty log message ***
+@
+text
+@# 
+# PURPOSE:  MAKEFILE FOR creating Linux SPIDER using FFTW3 using single processor compiled with gfortran
+#
+# USING:             Gnu Fortran compiler
+# TARGET:            Same machine as compiled on
+# IMAGES:            Optimal SPIDER image byte order: Native to machine
+ 
+# CREATE EXECUTABLE: make -f Makefile_linux_intel_27.gfort
+ 
+#        ANOTHER:    make -f Makefile_linux_mp_intel_27.gfort
+
+#        ANOTHER:    make -f Makefile_linux_intel_backtrace_27.gfort
+
+ 
+# EXECUTABLE:        spider_linux_intel_gfort_27 
+ 
+# NOTE:     Since .MOD files are not compatible with those prepared by
+#           other compilers be sure and compile in a clean directory!!!
+#           \rm spider_linux_intel_backtrace_gfort_27.a  *.mod
+#           See note on compilation order in: Makefile.inc
+#
+# NOTE:     Uses FFTW3 configured with: --enable-float --enable-openmp  
+#                                       --enable-threads
+#
+# NOTE:     You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
+#
+# FOR INITIAL USE:  \rm spider_linux_intel_gfort_27.a  *.mod
+#                   See note on compilation order in: Makefile.inc
+#
+# SOME GFORTRAN COMPILE/LINK FLAGS
+# -cpp                      : Use C preprocesor
+# -fopenmp                  : Invokes multi processor support
+# -Ofast                    : Selects fast set of flags for this architecture 
+# -Og                       : Few optimizations (faster than -0 , for debug use) 
+# -O0                       : No optimizations  (slow, for debug use)
+# -g                        : For use with in interactive debugger
+# -fallow-argument-mismatch : Needed for conflation of COMPLEX/REAL
+# -funroll-loops            : Sets optimization of loop unrolling
+# -finline-limit=600        : Sets limit on the number of inlined instructions 
+# -fwrapv                   : Wraps signed int overflow (Needed by: bpcg.f)
+# -fcheck=all               : Enables runtime tests, e.g. array bounds 
+# -fbacktrace               : To list location after crash
+# -fbounds-check            : Slow but lists array overflow
+# -fno-strict-aliasing      : No strict-aliasing warning
+# -Wall                     : Enable reporting of possible errors
+# -Wno-unused-parameter     : Stops nag about unused parameters
+# -Wno-unused-label         : Stops nag about unused statement labels
+# -Wno-unused-variable      : Stops nag about unused variables
+# -Wno-unused-dummy-argument: Stops nag about unused args in subroutine call
+# -Wno-conversion           : Stops nag about integer value = real value
+
+
+SHELL    = /bin/sh
+
+AFLAGS   = r
+
+# Location of Fortran compiler
+COMP     = /usr/bin/gfortran-13
+
+PGM      = spider
+
+WHICH    = linux_intel_gfort
+
+SUFFIX   = 27
+
+LIB      = $(PGM)_$(WHICH)_$(SUFFIX).a
+
+EXE      = $(PGM)_$(WHICH)_$(SUFFIX)
+
+LF       = $(QLFLAGS)  
+
+FFLAGS   = -cpp -Ofast -funroll-loops -finline-limit=600 -fno-strict-aliasing -fwrapv  -fallow-argument-mismatch -DSP_LIBFFTW3 -DSP_GFORTRAN -c   
+
+FFTWLIBDIR = /home/dean/Software/spider-2026/fftw/fftw3310-intel-gfort/lib/
+
+LINKLIBS   = $(FFTWLIBDIR)/libfftw3f.a  $(FFTWLIBDIR)/libfftw3f_threads.a 
+
+.PRECIOUS :  $(EXE) $(LIB) 
+
+include Makefile.inc
+
+$(EXE) : $(LIB)
+	@@echo "        "
+	@@echo "        Linking now:  $(COMP) $(LF)  $(LIB) $(LINKLIBS) -o $(EXE)"
+	$(COMP) $(LF)  $(LIB) $(LINKLIBS) -o $(EXE)
+	@@echo "Created: $(EXE)"
+	@@echo " "
+
+$(LIB) : $(ELEMENTS)
+	@@echo "         "
+	@@echo "        Compiling and archiving $(COMP) $(FFLAGS) $< now ----"
+	@@echo "         "
+.f.a:
+	@@echo "         "
+	@@echo "        Compiling $< now ----"
+	$(COMP) $(FFLAGS) $<
+	$(AR) $(AFLAGS) $(LIB) $*.o
+	@@\rm $*.o
+
+
+#SRCS = $(patsubst %.f, %.o, $(filter-out $(EXCLUDE), $(wildcard *.f)))
+
+clean:
+	rm -f *.mod *.MOD *.a
+
+# Tapu's: FFLAGS = -cpp -Ofast -funroll-loops -finline-limit=600 -DSP_LIBFFTW3 -DSP_GFORTRAN -fno-strict-aliasing -fwrapv -fallow-argument-mismatch -c
+#  
+# Static link with static FFTW3 libraries 
+# Tapu's: FFTWLIBDIR = ../fftw/fftw-3.3.10/lib
+#         FFTWLIBDIR = ../../fftw/fftw3-opt64-gfort/lib
+#         FFTWLIBDIR = ../../fftw/fftw321-intel/lib
+#         FFTWLIBDIR = ../../fftw/fftw3-opt64-gfort/lib
+#
+#         FFTWLIBDIR = fftw321-opt64/       NO
+#         FFTWLIBDIR = fftw321-intel/       BAD  ARCH
+#         FFTWLIBDIR = fftw337-intel64-icc/ NO INTEL...
+#
+#LINKLIBS  = -L$(FFTWLIBDIR) -llibfftw3f.a -llibfftw3f_threads.a -llibfftw3f_omp.a
+@
+
+
+1.1
+log
+@Initial revision
+@
+text
+@d2 1
+a2 1
+# PURPOSE:  MAKEFILE FOR GNU/Linux SPIDER using FFTW3 using multiple processors. Compiled with gfortran
+d4 17
+a20 4
+# USING:    Gnu Fortran compiler !!
+# TARGET:   Same machine as compiled on  
+# IMAGES:   Optimal SPIDER image byte order:    native to machine 
+# USAGE:    To create executable:  make -f Makefile_linux_intel_27.gfort 
+d22 2
+a23 2
+# FOR INITIAL USE:  \rm spider_linux_intel_gfort_27.a  *.mod
+#                   See note on compilation order in: Makefile.inc
+a24 1
+# NOTE:     Uses FFTW3 configured with: --enable-float --enable-openmp
+d27 2
+a28 2
+# NOTE:     SINCE .MOD FILES ARE NOT COMPATIBLE WITH THOSE PREPARED BY
+#           OTHER COMPILERS BE SURE AND COMPILE IN A CLEAN DIRECTORY!!!
+d30 22
+a51 7
+# Some gfortran Compile/link flags
+# -fopenmp             : Invokes multi processor support 
+# -Ofast               : Selects fast set of flags for this architecture 
+# -fwrapv              : Wrapping of underflow/overflow  (needed for correct results in: bpcg.f)
+# -fno-strict-aliasing :
+# -Wall                      : Warn of possible errors
+# -fallow-argument-mismatch' : Needed for conflation of COMPLEX/REAL
+d72 1
+a72 15
+FFLAGS    = -cpp -Ofast -funroll-loops -finline-limit=600  -DSP_LIBFFTW3 -DSP_GFORTRAN  -fno-strict-aliasing -fwrapv  -fallow-argument-mismatch -c   
+
+# Tapu's: FFLAGS = -cpp -Ofast -funroll-loops -finline-limit=600 -DSP_LIBFFTW3 -DSP_GFORTRAN -fno-strict-aliasing -fwrapv -fallow-argument-mismatch -c
+#  
+# Static link with static FFTW3 libraries 
+# Tapu's: FFTWLIBDIR = ../fftw/fftw-3.3.10/lib
+#         FFTWLIBDIR = ../../fftw/fftw3-opt64-gfort/lib
+#         FFTWLIBDIR = ../../fftw/fftw321-intel/lib
+#         FFTWLIBDIR = ../../fftw/fftw3-opt64-gfort/lib
+#
+#         FFTWLIBDIR = fftw321-opt64/       NO
+#         FFTWLIBDIR = fftw321-intel/       BAD ARCH
+#         FFTWLIBDIR = fftw337-intel64-icc/ NO INTEL...
+
+#LINKLIBS  = -L$(FFTWLIBDIR) -llibfftw3f.a -llibfftw3f_threads.a -llibfftw3f_omp.a
+d91 2
+a92 1
+	@@echo "        Linking $(EXE) now ----"
+d95 1
+a95 1
+	@@echo "        Compiling and archiving $(COMP) $(FFLAGS) $< now ----"
+d106 13
+@
diff --git src/RCS/Makefile_linux_intel_backtrace_27.gfort,v src/RCS/Makefile_linux_intel_backtrace_27.gfort,v
new file mode 100644
index 00000000..4cca0b2e
--- /dev/null
+++ src/RCS/Makefile_linux_intel_backtrace_27.gfort,v
@@ -0,0 +1,214 @@
+head	1.4;
+access;
+symbols;
+locks; strict;
+comment	@# @;
+
+
+1.4
+date	2025.11.10.22.33.58;	author dean;	state Exp;
+branches;
+next	1.3;
+
+1.3
+date	2025.10.03.14.51.29;	author dean;	state Exp;
+branches;
+next	1.2;
+
+1.2
+date	2025.09.21.19.47.55;	author dean;	state Exp;
+branches;
+next	1.1;
+
+1.1
+date	2025.09.21.19.47.06;	author dean;	state Exp;
+branches;
+next	;
+
+
+desc
+@MAKEFILE FOR creating Linux SPIDER for use in tracing crashes
+@
+
+
+1.4
+log
+@*** empty log message ***
+@
+text
+@
+# PURPOSE:  MAKEFILE For Linux SPIDER using FFTW3 using single processor.
+#           Compiled with gfortran  for use in tracing crashes
+#
+# USING:             Gnu Fortran compiler
+# TARGET:            Same machine as compiled on
+# IMAGES:            Optimal SPIDER image byte order:    Native to machine
+# CREATE EXECUTABLE: make -f Makefile_linux_intel_backtrace_27.gfort
+
+#        ANOTHER:    make -f Makefile_linux_intel_27.gfort
+ 
+#        ANOTHER:    make -f Makefile_linux_mp_intel_27.gfort
+ 
+# RUN EXECUTABLE:    spider_linux_intel_backtrace_gfort_27 
+ 
+# NOTE:     Since .MOD files are not compatible with those prepared by
+#           other compilers be sure and compile in a clean directory!!!
+#           \rm spider_linux_intel_backtrace_gfort_27.a  *.mod
+#           See note on compilation order in: Makefile.inc
+#
+# NOTE:     Uses FFTW3 configured with: --enable-float --enable-openmp  
+#                                       --enable-threads
+#
+# NOTE:     You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
+#
+# Some gfortran compile/link flags
+# -cpp                      : Use C preprocesor
+# -fopenmp                  : Invokes multi processor support
+# -Ofast                    : Selects fast set of flags for this architecture 
+# -Og                       : Few optimizations (faster than -0 , for debug use) 
+# -O0                       : No optimizations  (slow, for debug use)
+# -g                        : For use with in interactive debugger
+# -fallow-argument-mismatch : Needed for conflation of COMPLEX/REAL
+# -funroll-loops            : Sets optimization of loop unrolling
+# -finline-limit=600        : Sets limit on the number of inlined instructions 
+# -fwrapv                   : Wraps signed int overflow (Needed by: bpcg.f)
+# -fcheck=all               : Enables runtime tests, e.g. array bounds 
+# -fbacktrace               : To list location after crash
+# -fbounds-check            : Slow but lists array overflow
+# -fno-strict-aliasing      : No strict-aliasing warning
+# -Wall                     : Enable reporting of possible errors
+# -Wno-unused-parameter     : Stops nag about unused parameters
+# -Wno-unused-label         : Stops nag about unused statement labels
+# -Wno-unused-variable      : Stops nag about unused variables
+# -Wno-unused-dummy-argument: Stops nag about unused args in subroutine call
+# -Wno-conversion           : Stops nag about integer value = real value
+
+
+SHELL    = /bin/sh
+
+AFLAGS   = r
+
+# Location of Fortran compiler
+COMP     = /usr/bin/gfortran-13
+
+PGM      = spider
+
+WHICH    = linux_intel_backtrace_gfort
+
+SUFFIX   = 27
+
+LIB      = $(PGM)_$(WHICH)_$(SUFFIX).a
+
+EXE      = $(PGM)_$(WHICH)_$(SUFFIX)
+
+LF       = $(QLFLAGS)
+
+LIB      = $(EXE).a
+
+FFLAGS   = -cpp -Ofast -funroll-loops -finline-limit=600 -fno-strict-aliasing -fwrapv -g -O0   -fallow-argument-mismatch -fcheck=all -fbacktrace -Wall -Wno-unused-variable -Wno-unused-dummy-argument -Wno-conversion -DSP_LIBFFTW3 -DSP_GFORTRAN  -DSP_DBUGIO -c
+
+#-DSP_GFORTRAN -DSP_BACK -DSP_DEBUG -DSP_DBUGIO -c
+
+
+# Static link with static FFTW3 libraries
+FFTWLIBDIR = /home/dean/Software/spider-2026/fftw/fftw3310-intel-gfort/lib/
+
+LINKLIBS   = $(FFTWLIBDIR)/libfftw3f.a  $(FFTWLIBDIR)/libfftw3f_threads.a $(FFTWLIBDIR)/libfftw3f_omp.a
+
+.PRECIOUS :  ../bin/$(EXE) $(LIB)
+
+include Makefile.inc
+
+$(EXE) : $(LIB)
+	@@echo "        "
+	@@echo "        Linking now:  $(COMP) $(LF)  $(LIB) $(LINKLIBS) -o $(EXE)"
+	$(COMP) $(LF)  $(LIB) $(LINKLIBS) -o $(EXE)
+	@@echo "Created: $(EXE)"
+	@@echo " "
+
+$(LIB) : $(ELEMENTS)
+	@@echo "         "
+	@@echo "        Compiling and archiving $(COMP) $(FFLAGS) $< now ----"
+	@@echo "         "
+.f.a:
+	@@echo "         "
+	@@echo "        Compiling $< now ----"
+	$(COMP) $(FFLAGS) $<
+	$(AR) $(AFLAGS) $(LIB) $*.o
+	@@\rm $*.o
+
+#SRCS = $(patsubst %.f, %.o, $(filter-out $(EXCLUDE), $(wildcard *.f)))
+
+clean:
+	rm -f *.mod *.MOD *.a
+
+
+# FFLAGS   = -cpp -Ofast -funroll-loops -finline-limit=600 -DSP_LIBFFTW3 
+#            -DSP_GFORTRAN -fno-strict-aliasing -fwrapv  -g -O0 -fcheck=all -fbacktrace 
+#            -fallow-argument-mismatch
+@
+
+
+1.3
+log
+@added comments and checks
+@
+text
+@d9 4
+d70 3
+a72 1
+FFLAGS   = -cpp -Ofast -funroll-loops -finline-limit=600 -fno-strict-aliasing -fwrapv -g -O0   -fallow-argument-mismatch -fcheck=all -fbacktrace -Wall -Wno-unused-variable -Wno-unused-dummy-argument -Wno-conversion -DSP_LIBFFTW3 -DSP_GFORTRAN -c
+@
+
+
+1.2
+log
+@cosmetic
+@
+text
+@d1 2
+a2 2
+# 
+# PURPOSE:  MAKEFILE For creating Linux SPIDER using FFTW3 using single processor. 
+d5 11
+a15 4
+# USING:    Gnu Fortran compiler
+# TARGET:   Same machine as compiled on  
+# IMAGES:   Optimal SPIDER image byte order:    native to machine 
+# USAGE:    To create executable: make -f Makefile_linux_backtrace.gfort
+d17 2
+a18 2
+# FOR INITIAL USE:  \rm spider_linux_intel_backtrace_gfort_27.a  *.mod
+#                   See note on compilation order in: Makefile.inc
+a19 1
+# NOTE:     Uses FFTW3 configured with: --enable-float --enable-openmp --enable-threads
+a21 3
+# NOTE:     SINCE .MOD FILES ARE NOT COMPATIBLE WITH THOSE PREPARED BY
+#           OTHER COMPILERS BE SURE AND COMPILE IN A CLEAN DIRECTORY!!!
+#
+d23 21
+a43 6
+# -fopenmp                   : Invokes multi processor support
+# -Ofast                     : Selects fast set of flags for this architecture usually including:
+# -fwrapv                    : Wrapping of underflow/overflow  (needed for correct results in: bpcg.f)
+# -fno-strict-aliasing       :
+# -Wall                      : Report possible errors
+# -fallow-argument-mismatch' : Needed for conflation of COMPLEX/REAL
+d66 1
+a66 1
+FFLAGS   = -cpp -Ofast -funroll-loops -finline-limit=600 -fno-strict-aliasing -fwrapv -g -O0   -fcheck=all -fbacktrace -DSP_LIBFFTW3 -DSP_GFORTRAN -c
+d102 3
+a104 1
+##FFLAGS   = -cpp -Ofast -funroll-loops -finline-limit=600 -DSP_LIBFFTW3 ##-DSP_GFORTRAN -fno-strict-aliasing -fwrapv  -g -O0 -fcheck=all -fbacktrace  ##-fallow-argument-mismatch  -c
+@
+
+
+1.1
+log
+@Initial revision
+@
+text
+@d2 1
+a2 1
+# PURPOSE:  MAKEFILE FOR creating Linux SPIDER using FFTW3 using single processor. 
+@
diff --git src/RCS/Makefile_linux_mp,v src/RCS/Makefile_linux_mp,v
old mode 100755
new mode 100644
diff --git src/RCS/Makefile_linux_mp.gfort,v src/RCS/Makefile_linux_mp.gfort,v
index 9ed2e2ef..66b0c3d7 100644
--- src/RCS/Makefile_linux_mp.gfort,v
+++ src/RCS/Makefile_linux_mp.gfort,v
@@ -1,4 +1,4 @@
-head	1.1;
+head	1.2;
 access;
 symbols
 	pre_mrcs:1.1;
@@ -6,6 +6,11 @@ locks; strict;
 comment	@# @;
 
 
+1.2
+date	2025.11.10.22.34.04;	author dean;	state Exp;
+branches;
+next	1.1;
+
 1.1
 date	2017.11.17.14.29.39;	author leith;	state Exp;
 branches;
@@ -16,9 +21,9 @@ desc
 @@
 
 
-1.1
+1.2
 log
-@Initial revision
+@*** empty log message ***
 @
 text
 @# 
@@ -29,6 +34,10 @@ text
 # IMAGES:   Optimal SPIDER image byte order:    native to machine 
 # USAGE:    To create executable: make -f Makefile_linux_mp.gfort
 #
+#
+# FOR INITIAL USE:  \rm spider_linux_intel_gfort_27.a  *.mod
+#                   See note on compilation order in: Makefile.inc
+#
 # NOTE:     Uses FFTW3 configured with: --enable-float --enable-openmp
 # NOTE:     You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
 #
@@ -47,7 +56,7 @@ SHELL    = /bin/sh
 AFLAGS   = r
 
 # Location of Fortran compiler
-COMP     = /usr/bin/gfortran
+COMP     = /usr/bin/gfortran-13
 
 PGM      = spider_linux_mp_gfort
 
@@ -84,3 +93,15 @@ $(LIB) : $(ELEMENTS)
 
 
 @
+
+
+1.1
+log
+@Initial revision
+@
+text
+@d9 4
+d31 1
+a31 1
+COMP     = /usr/bin/gfortran
+@
diff --git src/RCS/Makefile_linux_mp_backtrace.gfort,v src/RCS/Makefile_linux_mp_backtrace.gfort,v
new file mode 100644
index 00000000..b60e1335
--- /dev/null
+++ src/RCS/Makefile_linux_mp_backtrace.gfort,v
@@ -0,0 +1,91 @@
+head	1.1;
+access;
+symbols;
+locks; strict;
+comment	@# @;
+
+
+1.1
+date	2025.11.10.22.33.58;	author dean;	state Exp;
+branches;
+next	;
+
+
+desc
+@new
+@
+
+
+1.1
+log
+@*** empty log message ***
+@
+text
+@# 
+# PURPOSE:  MAKEFILE FOR GNU/Linux SPIDER using FFTW3 using multiple processors. Compiled with gfortran
+#
+# USING:    Gnu Fortran compiler!!
+# TARGET:   Same machine as compiled on  
+# IMAGES:   Optimal SPIDER image byte order:    native to machine 
+# USAGE:    To create executable: make -f Makefile_linux_mp.gfort
+#
+# NOTE:     Uses FFTW3 configured with: --enable-float --enable-openmp --enable-threads
+# NOTE:     You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
+#
+# NOTE:     SINCE .MOD FILES ARE NOT COMPATIBLE WITH THOSE PREPARED BY
+#           OTHER COMPILERS BE SURE AND COMPILE IN A CLEAN DIRECTORY!!!
+#
+# Some gfortran compile/link flags
+# -fopenmp                   : Invokes multi processor support
+# -Ofast                     : Selects fast set of flags for this architecture usually including:
+# -fwrapv                    : Wrapping of underflow/overflow  (needed for correct results in: bpcg.f)
+# -fno-strict-aliasing       :
+# -Wall                      : Report possible errors
+# -fallow-argument-mismatch' : Needed for conflation of COMPLEX/REAL
+
+SHELL    = /bin/sh
+
+AFLAGS   = r
+
+# Location of Fortran compiler
+COMP     = /usr/bin/gfortran
+
+PGM      = spider
+
+WHICH    = mp_gfort_backtrace
+
+EXE      = $(PGM)_linux_$(WHICH)$(SUFFIX)
+
+FFLAGS   = -cpp -Ofast -funroll-loops -finline-limit=600 -DSP_LIBFFTW3 -DSP_GFORTRAN -fno-strict-aliasing -fwrapv -fopenmp -g -O0 -fcheck=all -fbacktrace -DSP_MP -fallow-argument-mismatch -c
+
+LF       = -fopenmp $(QLFLAGS)
+
+LIB      = $(EXE).a
+
+# Static link with static FFTW3 libraries
+FFTWLIBDIR = ../fftw/fftw-3.3.10/lib
+LINKLIBS   = -L$(FFTWLIBDIR) -lfftw3f -lfftw3f_threads
+
+.PRECIOUS :  ../bin/$(EXE) $(LIB)
+
+include Makefile.inc
+
+$(EXE) : $(LIB)
+	$(COMP) $(LF)  $(LIB) $(LINKLIBS) -o ../bin/$(EXE)
+	@@echo "Created: $(EXE)"
+	@@echo " "
+
+$(LIB) : $(ELEMENTS)
+	@@echo "        linking $(EXE) now ----"
+.f.a:
+	$(COMP) $(FFLAGS) $<
+	$(AR) $(AFLAGS) $(LIB) $*.o
+	@@\rm $*.o
+
+
+#SRCS = $(patsubst %.f, %.o, $(filter-out $(EXCLUDE), $(wildcard *.f)))
+
+clean:
+	rm -f *.mod *.MOD *.a
+
+@
diff --git src/RCS/Makefile_linux_mp_intel,v src/RCS/Makefile_linux_mp_intel,v
old mode 100755
new mode 100644
diff --git src/RCS/Makefile_linux_mp_intel_27.gfort,v src/RCS/Makefile_linux_mp_intel_27.gfort,v
new file mode 100644
index 00000000..debd1622
--- /dev/null
+++ src/RCS/Makefile_linux_mp_intel_27.gfort,v
@@ -0,0 +1,237 @@
+head	1.3;
+access;
+symbols;
+locks; strict;
+comment	@# @;
+
+
+1.3
+date	2025.11.10.22.34.04;	author dean;	state Exp;
+branches;
+next	1.2;
+
+1.2
+date	2025.09.21.19.32.17;	author dean;	state Exp;
+branches;
+next	1.1;
+
+1.1
+date	2025.09.21.19.16.12;	author dean;	state Exp;
+branches;
+next	;
+
+
+desc
+@MAKEFILE FOR Linux SPIDER using multiple processors compiled with gfortran
+@
+
+
+1.3
+log
+@*** empty log message ***
+@
+text
+@# 
+# PURPOSE:  MAKEFILE FOR Linux SPIDER using FFTW3 using multiple processors. 
+#           Compiled with gfortran
+#
+# USING:             Gnu Fortran compiler
+# TARGET:            Same machine as compiled on  
+# IMAGES:            Optimal SPIDER image byte order:    native to machine 
+# CREATE EXECUTABLE: make -f Makefile_linux_mp_intel_27.gfort
+
+#        ANOTHER:    make -f Makefile_linux_intel_27.gfort
+ 
+#        ANOTHER:    make -f Makefile_linux_intel_backtrace_27.gfort
+
+# RUN EXECUTABLE:    spider_linux_mp_intel_gfort_27 
+ 
+# NOTE:     Since .MOD files are not compatible with those prepared by
+#           other compilers be sure and compile in a clean directory!!!
+#           \rm spider_linux_mp_intel_gfort_27.a   *.mod
+#           See note on compilation order in: Makefile.inc
+#
+# NOTE:     Uses FFTW3 configured with: --enable-float --enable-openmp  
+#                                       --enable-threads
+#
+# NOTE:     You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
+#
+# Some gfortran compile/link flags
+# -cpp                      : Use C preprocesor
+# -fopenmp                  : Invokes multi processor support
+# -Ofast                    : Selects fast set of flags for this architecture 
+# -Og                       : Few optimizations (faster than -0 , for debug use) 
+# -O0                       : No optimizations  (slow, for debug use)
+# -g                        : For use with in interactive debugger
+# -fallow-argument-mismatch : Needed for conflation of COMPLEX/REAL
+# -funroll-loops            : Sets optimization of loop unrolling
+# -finline-limit=600        : Sets limit on the number of inlined instructions 
+# -fwrapv                   : Wraps signed int overflow (Needed by: bpcg.f)
+# -fcheck=all               : Enables runtime tests, e.g. array bounds 
+# -fbacktrace               : To list location after crash
+# -fbounds-check            : Slow but lists array overflow
+# -fno-strict-aliasing      : No strict-aliasing warning
+# -Wall                     : Enable reporting of possible errors
+# -Wno-unused-parameter     : Stops nag about unused parameters
+# -Wno-unused-label         : Stops nag about unused statement labels
+# -Wno-unused-variable      : Stops nag about unused variables
+# -Wno-unused-dummy-argument: Stops nag about unused args in subroutine call
+# -Wno-conversion           : Stops nag about integer value = real value
+#
+# FOR INITIAL USE:   \rm spider_linux_mp_intel_gfort_27.a  *.mod
+#                    See note on compilation order in: Makefile.inc
+#
+# NOTE:     Uses FFTW3 configured with: --enable-float --enable-openmp
+# NOTE:     You may ignore any undefined QFFLAGS, QLFLAGS & SUFFIX
+#
+
+SHELL    = /bin/sh
+
+AFLAGS   = r
+
+# Location of Fortran compiler
+COMP     = /usr/bin/gfortran-13
+
+PGM      = spider
+
+WHICH    = linux_mp_intel_gfort
+
+SUFFIX   = 27
+
+LIB      = $(PGM)_$(WHICH)_$(SUFFIX).a
+
+EXE      = $(PGM)_$(WHICH)_$(SUFFIX)
+
+LF       = -fopenmp $(QLFLAGS)  
+
+FFLAGS    = -cpp -Ofast -funroll-loops -finline-limit=600 -fno-strict-aliasing -fwrapv -fopenmp -fallow-argument-mismatch -DSP_MP -DSP_LIBFFTW3 -DSP_GFORTRAN -c   
+
+FFTWLIBDIR = /home/dean/Software/spider-2026/fftw/fftw3310-intel-gfort/lib/
+#            /home/dean/Software/spider-github-2026/fftw/fftw3310-intel-gfort/lib/
+
+LINKLIBS   = $(FFTWLIBDIR)/libfftw3f.a  $(FFTWLIBDIR)/libfftw3f_threads.a $(FFTWLIBDIR)/libfftw3f_omp.a
+
+.PRECIOUS :  $(EXE) $(LIB) 
+
+include Makefile.inc
+
+$(EXE) : $(LIB)
+	@@echo "        "
+	@@echo "        Linking now:  $(COMP) $(LF)  $(LIB) $(LINKLIBS) -o $(EXE)"
+	$(COMP) $(LF)  $(LIB) $(LINKLIBS) -o $(EXE)
+	@@echo "Created: $(EXE)"
+	@@echo " "
+
+$(LIB) : $(ELEMENTS)
+	@@echo "         "
+	@@echo "        Compiling and archiving $(COMP) $(FFLAGS) $< now ----"
+	@@echo "         "
+.f.a:
+	@@echo "         "
+	@@echo "        Compiling $< now ----"
+	$(COMP) $(FFLAGS) $<
+	$(AR) $(AFLAGS) $(LIB) $*.o
+	@@\rm $*.o
+
+
+#SRCS = $(patsubst %.f, %.o, $(filter-out $(EXCLUDE), $(wildcard *.f)))
+
+clean:
+	rm -f *.mod *.MOD *.a
+
+#FFLAGS   = -cpp -Ofast -funroll-loops -finline-limit=600 -DSP_MP -DSP_LIBFFTW3 #-DSP_GFORTRAN  -fno-strict-aliasing -fwrapv -fopenmp -Wno-argument-mismatch -c    
+# Tapu's: FFLAGS   = -cpp -Ofast -funroll-loops -finline-limit=600 -DSP_LIBFFTW3 -DSP_GFORTRAN -fno-strict-aliasing -fwrapv -fallow-argument-mismatch -c
+#
+# Static link with static FFTW3 libraries 
+# Tapu's: FFTWLIBDIR = ../fftw/fftw-3.3.10/lib
+#         FFTWLIBDIR = ../../fftw/fftw3-opt64-gfort/lib
+#         FFTWLIBDIR = ../../fftw/fftw321-intel/lib
+#         FFTWLIBDIR = ../../fftw/fftw3-opt64-gfort/lib
+#
+#         FFTWLIBDIR = fftw321-opt64/       NO
+#         FFTWLIBDIR = fftw321-intel/       BAD ARCH
+#         FFTWLIBDIR = fftw337-intel64-icc/ NO INTEL...
+
+#LINKLIBS  = -L$(FFTWLIBDIR) -llibfftw3f.a -llibfftw3f_threads.a -llibfftw3f_omp.a
+@
+
+
+1.2
+log
+@mainly cosmetic
+@
+text
+@d2 2
+a3 1
+# PURPOSE:  MAKEFILE FOR Linux SPIDER using FFTW3 using multiple processors. Compiled with gfortran
+d5 15
+a19 4
+# USING:    Gnu Fortran compiler !!
+# TARGET:   Same machine as compiled on  
+# IMAGES:   Optimal SPIDER image byte order:    native to machine 
+# USAGE:    To create executable:  make -f Makefile_linux_mp_intel_27.gfort 
+d21 29
+a49 2
+# FOR INITIAL USE:  \rm spider_linux_mp_intel_gfort_27.a  *.mod
+#                   See note on compilation order in: Makefile.inc
+a53 10
+# NOTE:     SINCE .MOD FILES ARE NOT COMPATIBLE WITH THOSE PREPARED BY
+#           OTHER COMPILERS BE SURE AND COMPILE IN A CLEAN DIRECTORY!!!
+#
+# Some gfortran Compile/link flags
+# -fopenmp             : Invokes multi processor support 
+# -Ofast               : Selects fast set of flags for this architecture 
+# -fwrapv              : Wrapping of underflow/overflow  (needed for correct results in: bpcg.f)
+# -fno-strict-aliasing :
+# -Wall                      : Warn of possible errors
+# -fallow-argument-mismatch' : Needed for conflation of COMPLEX/REAL
+d74 1
+a74 1
+FFLAGS    = -cpp -Ofast -funroll-loops -finline-limit=600  -fno-strict-aliasing -fwrapv  -fopenmp  -fallow-argument-mismatch -DSP_MP -DSP_LIBFFTW3 -DSP_GFORTRAN -c   
+d77 1
+a77 1
+#/home/dean/Software/spider-github-2026/fftw/fftw3310-intel-gfort/lib/
+@
+
+
+1.1
+log
+@Initial revision
+@
+text
+@d2 1
+a2 1
+# PURPOSE:  MAKEFILE FOR GNU/Linux SPIDER using FFTW3 using multiple processors. Compiled with gfortran
+d9 3
+d45 1
+a45 19
+
+FFLAGS    = -cpp -Ofast -funroll-loops -finline-limit=600 -DSP_MP -DSP_LIBFFTW3 -DSP_GFORTRAN  -fno-strict-aliasing -fwrapv -fopenmp  -fallow-argument-mismatch -c   
+
+#FFLAGS   = -cpp -Ofast -funroll-loops -finline-limit=600 -DSP_MP -DSP_LIBFFTW3 #-DSP_GFORTRAN  -fno-strict-aliasing -fwrapv -fopenmp -Wno-argument-mismatch -c    
+# Tapu's: FFLAGS   = -cpp -Ofast -funroll-loops -finline-limit=600 -DSP_LIBFFTW3 -DSP_GFORTRAN -fno-strict-aliasing -fwrapv -fallow-argument-mismatch -c
+
+
+
+# Static link with static FFTW3 libraries 
+# Tapu's: FFTWLIBDIR = ../fftw/fftw-3.3.10/lib
+#         FFTWLIBDIR = ../../fftw/fftw3-opt64-gfort/lib
+#         FFTWLIBDIR = ../../fftw/fftw321-intel/lib
+#         FFTWLIBDIR = ../../fftw/fftw3-opt64-gfort/lib
+#
+#         FFTWLIBDIR = fftw321-opt64/       NO
+#         FFTWLIBDIR = fftw321-intel/       BAD ARCH
+#         FFTWLIBDIR = fftw337-intel64-icc/ NO INTEL...
+
+#LINKLIBS  = -L$(FFTWLIBDIR) -llibfftw3f.a -llibfftw3f_threads.a -llibfftw3f_omp.a
+d58 1
+a58 1
+	@@echo "        exing  $(COMP) $(LF)  $(LIB) $(LINKLIBS) -o $(EXE)  now ----"
+d65 2
+a66 1
+	@@echo "        linking $(EXE) now ----"
+d69 1
+a69 1
+	@@echo "        finding $(COMP) $(FFLAGS) $< now ----"
+d80 14
+@
diff --git src/RCS/Nextversion,v src/RCS/Nextversion,v
old mode 100755
new mode 100644
diff --git src/RCS/acrs_2.f,v src/RCS/acrs_2.f,v
index 9c115a88..e7c7aefc 100644
--- src/RCS/acrs_2.f,v
+++ src/RCS/acrs_2.f,v
@@ -1,4 +1,4 @@
-head	1.13;
+head	1.14;
 access;
 symbols
 	pre_mrcs:1.13
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.14
+date	2025.11.10.21.23.40;	author dean;	state Exp;
+branches;
+next	1.13;
+
 1.13
 date	2018.10.03.14.29.43;	author leith;	state Exp;
 branches;
@@ -95,9 +100,9 @@ desc
 @
 
 
-1.13
+1.14
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -113,7 +118,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -179,6 +184,17 @@ c$omp   parallel do private(i,j,ix,iy,argy,arg,ctemp)
 @
 
 
+1.13
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.12
 log
 @GPL_2010
diff --git src/RCS/acrs_2s.f,v src/RCS/acrs_2s.f,v
index 2c02bd13..5c49ff4e 100644
--- src/RCS/acrs_2s.f,v
+++ src/RCS/acrs_2s.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -22,6 +22,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.31.57;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.29.43;	author leith;	state Exp;
 branches;
@@ -67,9 +72,9 @@ desc
 @@
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -84,7 +89,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -141,6 +146,17 @@ c$omp   parallel do private(i,j,ix,iy,argy,arg)
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @GPL_2010
diff --git src/RCS/acrs_3.f,v src/RCS/acrs_3.f,v
index bf4cfa09..21f9dd91 100644
--- src/RCS/acrs_3.f,v
+++ src/RCS/acrs_3.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.31.57;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.29.43;	author leith;	state Exp;
 branches;
@@ -85,9 +90,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -103,7 +108,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -174,6 +179,17 @@ c$omp   parallel do private(i,j,k,ix,iy,iz,arg,argy,argz,ctemp)
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @GPL_2010
diff --git src/RCS/acrs_3s.f,v src/RCS/acrs_3s.f,v
index da9eb0bc..93d0c547 100644
--- src/RCS/acrs_3s.f,v
+++ src/RCS/acrs_3s.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -22,6 +22,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.31.57;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.33.54;	author leith;	state Exp;
 branches;
@@ -67,9 +72,9 @@ desc
 @@
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -84,7 +89,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -150,6 +155,17 @@ c$omp   parallel do private(i,j,k,ix,iy,iz,arg,argy,argz)
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @GPL_2010
diff --git src/RCS/addfac.f,v src/RCS/addfac.f,v
index 661553c7..c02152c8 100644
--- src/RCS/addfac.f,v
+++ src/RCS/addfac.f,v
@@ -1,4 +1,4 @@
-head	1.6;
+head	1.7;
 access;
 symbols
 	pre_mrcs:1.6
@@ -20,6 +20,11 @@ locks; strict;
 comment	@c @;
 
 
+1.7
+date	2025.11.10.22.31.57;	author dean;	state Exp;
+branches;
+next	1.6;
+
 1.6
 date	2018.10.03.14.33.54;	author leith;	state Exp;
 branches;
@@ -55,9 +60,9 @@ desc
 @@
 
 
-1.6
+1.7
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -72,7 +77,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -163,6 +168,17 @@ C          RATIO OF a TO b TIMES FACT2 IS ADDED TO a * FACT1
 @
 
 
+1.6
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.5
 log
 @GPL_2010
diff --git src/RCS/adds.f,v src/RCS/adds.f,v
index 837b3d23..fdd7f4eb 100644
--- src/RCS/adds.f,v
+++ src/RCS/adds.f,v
@@ -1,4 +1,4 @@
-head	1.52;
+head	1.53;
 access;
 symbols
 	pre_mrcs:1.52
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.53
+date	2025.11.10.22.31.57;	author dean;	state Exp;
+branches;
+next	1.52;
+
 1.52
 date	2018.10.03.14.33.54;	author leith;	state Exp;
 branches;
@@ -290,9 +295,9 @@ desc
 @
 
 
-1.52
+1.53
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C **********************************************************************
@@ -308,7 +313,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2017  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -618,6 +623,17 @@ C           TRAP FOR NaN
 @
 
 
+1.52
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.51
 log
 @redvol, precison difference note
diff --git src/RCS/adds_n.f,v src/RCS/adds_n.f,v
index ba47df14..63bd5704 100644
--- src/RCS/adds_n.f,v
+++ src/RCS/adds_n.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -7,6 +7,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.31.57;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.33.54;	author leith;	state Exp;
 branches;
@@ -62,9 +67,9 @@ desc
 @@
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C **********************************************************************
@@ -81,7 +86,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2012  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -573,6 +578,17 @@ C        SAVE SUBSET 2 VAR. OUTPUT IMAGE
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d15 1
+a15 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @double can not be sent to set_nsel
diff --git src/RCS/ads.f,v src/RCS/ads.f,v
index 9b9d4e94..c1dbcb11 100644
--- src/RCS/ads.f,v
+++ src/RCS/ads.f,v
@@ -1,4 +1,4 @@
-head	1.5;
+head	1.6;
 access;
 symbols
 	pre_mrcs:1.5
@@ -20,6 +20,11 @@ locks; strict;
 comment	@c @;
 
 
+1.6
+date	2025.11.10.22.31.57;	author dean;	state Exp;
+branches;
+next	1.5;
+
 1.5
 date	2018.10.03.14.33.54;	author leith;	state Exp;
 branches;
@@ -50,9 +55,9 @@ desc
 @@
 
 
-1.5
+1.6
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -66,7 +71,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -187,6 +192,17 @@ C     FINISHED, OPEN OUTPUT FILE
 @
 
 
+1.5
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.4
 log
 @GPL_2010
diff --git src/RCS/al10.f,v src/RCS/al10.f,v
index 3dbc7a8e..6a4b7dd0 100644
--- src/RCS/al10.f,v
+++ src/RCS/al10.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.31.57;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.33.54;	author leith;	state Exp;
 branches;
@@ -70,9 +75,9 @@ desc
 @
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -85,7 +90,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -115,6 +120,17 @@ C--*********************************************************************
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @GPL_2010
diff --git src/RCS/alphaint.f,v src/RCS/alphaint.f,v
index 580527ff..cacc9e45 100644
--- src/RCS/alphaint.f,v
+++ src/RCS/alphaint.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.31.57;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.33.54;	author leith;	state Exp;
 branches;
@@ -80,9 +85,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -95,7 +100,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -141,6 +146,17 @@ C--*******************************************************************      DOUB
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @GPL_2010
diff --git src/RCS/alprbs.f,v src/RCS/alprbs.f,v
index 8729055e..13a94cda 100644
--- src/RCS/alprbs.f,v
+++ src/RCS/alprbs.f,v
@@ -1,4 +1,4 @@
-head	1.17;
+head	1.18;
 access;
 symbols
 	pre_mrcs:1.17
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.18
+date	2025.11.10.22.31.57;	author dean;	state Exp;
+branches;
+next	1.17;
+
 1.17
 date	2018.10.03.14.33.54;	author leith;	state Exp;
 branches;
@@ -115,9 +120,9 @@ desc
 @
 
 
-1.17
+1.18
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -130,7 +135,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -203,6 +208,17 @@ C          ALL THE RINGS ARE POWER-OF-TWO.
 @
 
 
+1.17
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.16
 log
 @FOR USE WITH SPIDER (e.g. NOT!! FFTW3) FFT
diff --git src/RCS/alprbs_q.f,v src/RCS/alprbs_q.f,v
index 8c796544..a42f2bef 100644
--- src/RCS/alprbs_q.f,v
+++ src/RCS/alprbs_q.f,v
@@ -1,4 +1,4 @@
-head	1.17;
+head	1.18;
 access;
 symbols
 	pre_mrcs:1.17
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.18
+date	2025.11.10.22.31.57;	author dean;	state Exp;
+branches;
+next	1.17;
+
 1.17
 date	2018.10.03.14.33.54;	author leith;	state Exp;
 branches;
@@ -114,9 +119,9 @@ desc
 @@
 
 
-1.17
+1.18
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -131,7 +136,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -266,6 +271,17 @@ C          ALL THE RINGS ARE POWER-OF-TWO. ADD 2 TO LEN TO USE NEW FFT.
 @
 
 
+1.17
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.16
 log
 @GPL_2010
diff --git src/RCS/alrosf_q.f,v src/RCS/alrosf_q.f,v
index 8d6df34f..fa005d74 100644
--- src/RCS/alrosf_q.f,v
+++ src/RCS/alrosf_q.f,v
@@ -1,4 +1,4 @@
-head	1.14;
+head	1.15;
 access;
 symbols
 	pre_mrcs:1.14
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.15
+date	2025.11.10.22.31.57;	author dean;	state Exp;
+branches;
+next	1.14;
+
 1.14
 date	2018.10.03.14.33.54;	author leith;	state Exp;
 branches;
@@ -99,9 +104,9 @@ desc
 @@
 
 
-1.14
+1.15
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -114,7 +119,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -206,6 +211,17 @@ C       CALL  RTQS(A,ATMP,NSAM,NROW,PARA(1),PARA(2),PARA(3))
 @
 
 
+1.14
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.13
 log
 @GPL_2010
diff --git src/RCS/alrosi_q.f,v src/RCS/alrosi_q.f,v
index 6b240e04..a8c10c9b 100644
--- src/RCS/alrosi_q.f,v
+++ src/RCS/alrosi_q.f,v
@@ -1,4 +1,4 @@
-head	1.16;
+head	1.17;
 access;
 symbols
 	pre_mrcs:1.16
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.17
+date	2025.11.10.22.31.58;	author dean;	state Exp;
+branches;
+next	1.16;
+
 1.16
 date	2018.10.03.14.33.54;	author leith;	state Exp;
 branches;
@@ -109,9 +114,9 @@ desc
 @@
 
 
-1.16
+1.17
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -124,7 +129,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2017  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -239,6 +244,17 @@ C         ROTATE IMAGE A INTO ATMP
 @
 
 
+1.16
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.15
 log
 @removed debug output
diff --git src/RCS/alrq.f,v src/RCS/alrq.f,v
index a5b85bdb..2900167a 100644
--- src/RCS/alrq.f,v
+++ src/RCS/alrq.f,v
@@ -1,4 +1,4 @@
-head	1.16;
+head	1.17;
 access;
 symbols
 	pre_mrcs:1.16
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.17
+date	2025.11.10.22.31.58;	author dean;	state Exp;
+branches;
+next	1.16;
+
 1.16
 date	2018.10.03.14.33.54;	author leith;	state Exp;
 branches;
@@ -110,9 +115,9 @@ desc
 @
 
 
-1.16
+1.17
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -126,7 +131,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -229,6 +234,17 @@ c$omp   end parallel do
 @
 
 
+1.16
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.15
 log
 @GPL_2010
diff --git src/RCS/alrq_m.f,v src/RCS/alrq_m.f,v
index af23e750..8a31db7d 100644
--- src/RCS/alrq_m.f,v
+++ src/RCS/alrq_m.f,v
@@ -1,4 +1,4 @@
-head	1.12;
+head	1.13;
 access;
 symbols
 	pre_mrcs:1.12
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.13
+date	2025.11.10.22.31.58;	author dean;	state Exp;
+branches;
+next	1.12;
+
 1.12
 date	2018.10.03.14.33.54;	author leith;	state Exp;
 branches;
@@ -90,9 +95,9 @@ desc
 @
 
 
-1.12
+1.13
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -106,7 +111,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -210,6 +215,17 @@ C
 @
 
 
+1.12
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.11
 log
 @GPL_2010
diff --git src/RCS/alrq_ms_fbs.f,v src/RCS/alrq_ms_fbs.f,v
index de030c8d..1eec87aa 100644
--- src/RCS/alrq_ms_fbs.f,v
+++ src/RCS/alrq_ms_fbs.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -7,6 +7,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.31.58;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.33.54;	author leith;	state Exp;
 branches;
@@ -62,9 +67,9 @@ desc
 @@
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -80,7 +85,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2013  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -452,6 +457,17 @@ C                FILL OTHER HALF OF CIRCLE
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @.0) ) THEN
diff --git src/RCS/alrq_ms_quad.f,v src/RCS/alrq_ms_quad.f,v
index 0969c12c..bd2ba1c6 100644
--- src/RCS/alrq_ms_quad.f,v
+++ src/RCS/alrq_ms_quad.f,v
@@ -1,4 +1,4 @@
-head	1.17;
+head	1.18;
 access;
 symbols
 	pre_mrcs:1.17
@@ -23,6 +23,11 @@ locks; strict;
 comment	@c @;
 
 
+1.18
+date	2025.11.10.22.31.58;	author dean;	state Exp;
+branches;
+next	1.17;
+
 1.17
 date	2018.10.03.14.33.54;	author leith;	state Exp;
 branches;
@@ -113,9 +118,9 @@ desc
 @@
 
 
-1.17
+1.18
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -134,7 +139,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2013  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -459,6 +464,17 @@ C                FILL OTHER HALF OF CIRCLE
 @
 
 
+1.17
+log
+@email_health_dept
+@
+text
+@d17 1
+a17 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.16
 log
 @OUT OF BOUNDS TRAP ENLARGED
diff --git src/RCS/alrq_q.f,v src/RCS/alrq_q.f,v
index a77aad8d..8abe1a0d 100644
--- src/RCS/alrq_q.f,v
+++ src/RCS/alrq_q.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.31.58;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.33.54;	author leith;	state Exp;
 branches;
@@ -79,9 +84,9 @@ desc
 @@
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -94,7 +99,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -198,6 +203,17 @@ C          TWO LOCATIONS ARE ONLY FOR THE NEW FFT.
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @GPL_2010
diff --git src/RCS/alrqs.f,v src/RCS/alrqs.f,v
index 604b1b0d..6927eb5e 100644
--- src/RCS/alrqs.f,v
+++ src/RCS/alrqs.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -23,6 +23,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.31.58;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.33.54;	author leith;	state Exp;
 branches;
@@ -73,9 +78,9 @@ desc
 @@
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -88,7 +93,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -194,6 +199,17 @@ C          RADIUS OF THE RING
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @*** empty log message ***
diff --git src/RCS/amoeba.f,v src/RCS/amoeba.f,v
index 28560f6a..4a994b30 100644
--- src/RCS/amoeba.f,v
+++ src/RCS/amoeba.f,v
@@ -1,4 +1,4 @@
-head	1.15;
+head	1.16;
 access;
 symbols
 	pre_mrcs:1.15
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.16
+date	2025.11.10.22.31.58;	author dean;	state Exp;
+branches;
+next	1.15;
+
 1.15
 date	2018.10.03.14.33.54;	author leith;	state Exp;
 branches;
@@ -105,9 +110,9 @@ desc
 @
 
 
-1.15
+1.16
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -120,7 +125,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -265,6 +270,17 @@ C--*********************************************************************
 @
 
 
+1.15
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.14
 log
 @updated
diff --git src/RCS/ang.f,v src/RCS/ang.f,v
index 26407a7b..8e7d2748 100644
--- src/RCS/ang.f,v
+++ src/RCS/ang.f,v
@@ -1,4 +1,4 @@
-head	1.13;
+head	1.14;
 access;
 symbols
 	pre_mrcs:1.13
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.14
+date	2025.11.10.22.31.58;	author dean;	state Exp;
+branches;
+next	1.13;
+
 1.13
 date	2018.10.03.14.33.55;	author leith;	state Exp;
 branches;
@@ -95,9 +100,9 @@ desc
 @
 
 
-1.13
+1.14
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -111,7 +116,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -150,6 +155,17 @@ C--*********************************************************************
 @
 
 
+1.13
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.12
 log
 @GPL_2010
diff --git src/RCS/ang_n.f,v src/RCS/ang_n.f,v
index 5bde5a40..02aabb6b 100644
--- src/RCS/ang_n.f,v
+++ src/RCS/ang_n.f,v
@@ -1,4 +1,4 @@
-head	1.5;
+head	1.6;
 access;
 symbols
 	pre_mrcs:1.5
@@ -20,6 +20,11 @@ locks; strict;
 comment	@c @;
 
 
+1.6
+date	2025.11.10.22.31.58;	author dean;	state Exp;
+branches;
+next	1.5;
+
 1.5
 date	2018.10.03.14.33.55;	author leith;	state Exp;
 branches;
@@ -51,9 +56,9 @@ desc
 @
 
 
-1.5
+1.6
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C
@@ -67,7 +72,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -105,6 +110,17 @@ C--*********************************************************************
 @
 
 
+1.5
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.4
 log
 @GPL_2010
diff --git src/RCS/ap_getangas.f,v src/RCS/ap_getangas.f,v
index dfd322ed..e8457544 100644
--- src/RCS/ap_getangas.f,v
+++ src/RCS/ap_getangas.f,v
@@ -1,4 +1,4 @@
-head	1.13;
+head	1.14;
 access;
 symbols
 	pre_mrcs:1.13
@@ -19,6 +19,11 @@ locks; strict;
 comment	@c @;
 
 
+1.14
+date	2025.11.10.22.31.58;	author dean;	state Exp;
+branches;
+next	1.13;
+
 1.13
 date	2018.10.03.14.33.55;	author leith;	state Exp;
 branches;
@@ -89,9 +94,9 @@ desc
 @@
 
 
-1.13
+1.14
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -109,7 +114,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2015  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -402,6 +407,17 @@ C       **************************** AP_TEST  ***********************
 @
 
 
+1.13
+log
+@email_health_dept
+@
+text
+@d16 1
+a16 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.12
 log
 @FORMATTING IMPROVED
diff --git src/RCS/ap_getdata.f,v src/RCS/ap_getdata.f,v
index 9d79dfac..1c7fea0f 100644
--- src/RCS/ap_getdata.f,v
+++ src/RCS/ap_getdata.f,v
@@ -1,4 +1,4 @@
-head	1.25;
+head	1.26;
 access;
 symbols
 	pre_mrcs:1.25
@@ -20,6 +20,11 @@ locks; strict;
 comment	@c @;
 
 
+1.26
+date	2025.11.10.22.31.58;	author dean;	state Exp;
+branches;
+next	1.25;
+
 1.25
 date	2018.10.03.14.33.55;	author leith;	state Exp;
 branches;
@@ -151,9 +156,9 @@ desc
 @
 
 
-1.25
+1.26
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -179,7 +184,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2016  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -880,6 +885,17 @@ C             UNPAD DENOISED IMAGE --> BUFOUT
 @
 
 
+1.25
+log
+@email_health_dept
+@
+text
+@d24 1
+a24 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.24
 log
 @FQ_BUF REPLACED WITH FQ2
diff --git src/RCS/ap_stat.f,v src/RCS/ap_stat.f,v
index 21a0e03e..5f9ef25c 100644
--- src/RCS/ap_stat.f,v
+++ src/RCS/ap_stat.f,v
@@ -1,4 +1,4 @@
-head	1.14;
+head	1.15;
 access;
 symbols
 	pre_mrcs:1.14
@@ -19,6 +19,11 @@ locks; strict;
 comment	@c @;
 
 
+1.15
+date	2025.11.10.22.31.59;	author dean;	state Exp;
+branches;
+next	1.14;
+
 1.14
 date	2018.10.03.14.33.55;	author leith;	state Exp;
 branches;
@@ -94,9 +99,9 @@ desc
 @@
 
 
-1.14
+1.15
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @ 
@@ -114,7 +119,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2015  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -463,6 +468,17 @@ C       WRITE TO DOC FILE
 @
 
 
+1.14
+log
+@email_health_dept
+@
+text
+@d16 1
+a16 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.13
 log
 @AP_STAT_R ADDED
diff --git src/RCS/apcc.f,v src/RCS/apcc.f,v
index 82198caa..858175f4 100644
--- src/RCS/apcc.f,v
+++ src/RCS/apcc.f,v
@@ -1,4 +1,4 @@
-head	1.14;
+head	1.15;
 access;
 symbols
 	pre_mrcs:1.14
@@ -12,6 +12,11 @@ locks; strict;
 comment	@c @;
 
 
+1.15
+date	2025.11.10.22.31.59;	author dean;	state Exp;
+branches;
+next	1.14;
+
 1.14
 date	2018.10.03.14.33.55;	author leith;	state Exp;
 branches;
@@ -87,9 +92,9 @@ desc
 @@
 
 
-1.14
+1.15
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -106,7 +111,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -662,6 +667,17 @@ c       this only writes first lsc values from each row
 @
 
 
+1.14
+log
+@email_health_dept
+@
+text
+@d15 1
+a15 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.13
 log
 @pksr3_sub cannot be fed with sgn=1 as integer
diff --git src/RCS/apmaster_tool.f,v src/RCS/apmaster_tool.f,v
index a2d4f394..973daa4f 100644
--- src/RCS/apmaster_tool.f,v
+++ src/RCS/apmaster_tool.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -8,6 +8,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.31.59;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.33.55;	author leith;	state Exp;
 branches;
@@ -58,9 +63,9 @@ desc
 @@
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -75,7 +80,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* Authors: J. Frank & A. Leith                                       *
 C=* Copyright 1985-2011  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -367,6 +372,17 @@ C       UNALLOCATE FFTW3 PLANS (TO REMOVE MEMORY LEAK)
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @enter
diff --git src/RCS/applyw.f,v src/RCS/applyw.f,v
index 3b0dff6d..6568118e 100644
--- src/RCS/applyw.f,v
+++ src/RCS/applyw.f,v
@@ -1,4 +1,4 @@
-head	1.12;
+head	1.13;
 access;
 symbols
 	pre_mrcs:1.12
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.13
+date	2025.11.10.22.31.59;	author dean;	state Exp;
+branches;
+next	1.12;
+
 1.12
 date	2018.10.03.14.33.55;	author leith;	state Exp;
 branches;
@@ -89,9 +94,9 @@ desc
 @@
 
 
-1.12
+1.13
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -104,7 +109,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -151,6 +156,17 @@ c$omp parallel do private(i,j,jc,NUMR3I,NUMR2I,W)
 @
 
 
+1.12
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.11
 log
 @GPL_2010
diff --git src/RCS/applyws.f,v src/RCS/applyws.f,v
index 4b9a8c58..f893aaa2 100644
--- src/RCS/applyws.f,v
+++ src/RCS/applyws.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -23,6 +23,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.31.59;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.33.55;	author leith;	state Exp;
 branches;
@@ -78,9 +83,9 @@ desc
 @@
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -95,7 +100,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -199,6 +204,17 @@ C       STILL USED IN: oracfmsk.f, oracfmskm.f:
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @msg about why ccrot values negative allowed again and loc. 2 bug
diff --git src/RCS/apref_p.f,v src/RCS/apref_p.f,v
index 716636fd..b83eb349 100644
--- src/RCS/apref_p.f,v
+++ src/RCS/apref_p.f,v
@@ -1,4 +1,4 @@
-head	1.81;
+head	1.82;
 access;
 symbols
 	pre_mrcs:1.81
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.82
+date	2025.11.10.22.31.59;	author dean;	state Exp;
+branches;
+next	1.81;
+
 1.81
 date	2018.10.03.14.33.55;	author leith;	state Exp;
 branches;
@@ -435,9 +440,9 @@ desc
 @
 
 
-1.81
+1.82
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -468,7 +473,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2012  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -1315,6 +1320,17 @@ C ------------------------- END OF MPI CODE -----------------------
 
 
 
+@
+
+
+1.81
+log
+@email_health_dept
+@
+text
+@d29 1
+a29 1
+C=* Email: spider@@health.ny.gov                                        *
 @
 
 
diff --git src/RCS/apref_pm.f,v src/RCS/apref_pm.f,v
index 849c9054..1ef04146 100644
--- src/RCS/apref_pm.f,v
+++ src/RCS/apref_pm.f,v
@@ -1,4 +1,4 @@
-head	1.85;
+head	1.86;
 access;
 symbols
 	pre_mrcs:1.85
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.86
+date	2025.11.10.22.31.59;	author dean;	state Exp;
+branches;
+next	1.85;
+
 1.85
 date	2018.10.03.14.33.55;	author leith;	state Exp;
 branches;
@@ -455,9 +460,9 @@ desc
 @
 
 
-1.85
+1.86
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @ 
@@ -493,7 +498,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2015  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -939,6 +944,17 @@ C             GOOD MATCH WITH TOTA (MIRRORED OR NOT)  POSITION
 @
 
 
+1.85
+log
+@email_health_dept
+@
+text
+@d34 1
+a34 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.84
 log
 @F == -999 WANT MIRCC NOT RO
diff --git src/RCS/aprings.f,v src/RCS/aprings.f,v
index f7472984..593ed3c8 100644
--- src/RCS/aprings.f,v
+++ src/RCS/aprings.f,v
@@ -1,4 +1,4 @@
-head	1.46;
+head	1.47;
 access;
 symbols
 	pre_mrcs:1.46
@@ -20,6 +20,11 @@ locks; strict;
 comment	@c @;
 
 
+1.47
+date	2025.11.10.22.31.59;	author dean;	state Exp;
+branches;
+next	1.46;
+
 1.46
 date	2018.10.03.14.33.55;	author leith;	state Exp;
 branches;
@@ -256,9 +261,9 @@ desc
 @
 
 
-1.46
+1.47
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -282,7 +287,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2011  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -856,6 +861,17 @@ C          USING COEFF ARRAY, EITHER TRANSFORMED RINGS OR NOT
 
 
 
+@
+
+
+1.46
+log
+@email_health_dept
+@
+text
+@d22 1
+a22 1
+C=* Email: spider@@health.ny.gov                                        *
 @
 
 
diff --git src/RCS/aprings_coef.f,v src/RCS/aprings_coef.f,v
index ec93c4ec..c08be559 100644
--- src/RCS/aprings_coef.f,v
+++ src/RCS/aprings_coef.f,v
@@ -1,4 +1,4 @@
-head	1.15;
+head	1.16;
 access;
 symbols
 	pre_mrcs:1.15
@@ -8,6 +8,11 @@ locks; strict;
 comment	@c @;
 
 
+1.16
+date	2025.11.10.22.31.59;	author dean;	state Exp;
+branches;
+next	1.15;
+
 1.15
 date	2018.10.03.14.33.55;	author leith;	state Exp;
 branches;
@@ -89,9 +94,9 @@ desc
 @
 
 
-1.15
+1.16
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -117,7 +122,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* Authors: J. Frank & A. Leith                                        *
 C=* Copyright 1985-2013  Health Research Inc.                          *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -852,6 +857,17 @@ C              ALSO SETS: IXY CONTAINING VALUES OF: X & Y
 @
 
 
+1.15
+log
+@email_health_dept
+@
+text
+@d24 1
+a24 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.14
 log
 @C              OUT OF BOUNDS TRAP ENLARGED       FEB 2013 ARDEAN LEITH
diff --git src/RCS/aprings_trans.f,v src/RCS/aprings_trans.f,v
index bc81babf..dd94c7b7 100644
--- src/RCS/aprings_trans.f,v
+++ src/RCS/aprings_trans.f,v
@@ -1,4 +1,4 @@
-head	1.6;
+head	1.7;
 access;
 symbols
 	pre_mrcs:1.6
@@ -8,6 +8,11 @@ locks; strict;
 comment	@c @;
 
 
+1.7
+date	2025.11.10.22.31.59;	author dean;	state Exp;
+branches;
+next	1.6;
+
 1.6
 date	2018.10.03.14.33.55;	author leith;	state Exp;
 branches;
@@ -44,9 +49,9 @@ desc
 @
 
 
-1.6
+1.7
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -58,7 +63,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* Authors: J. Frank & A. Leith                                        *
 C=* Copyright 1985-2010  Health Research Inc.                          *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -535,6 +540,17 @@ C       REFORM RINGS BY RAY ORDER AND APPLY OPTIONAL WEIGHTING
 @
 
 
+1.6
+log
+@email_health_dept
+@
+text
+@d10 1
+a10 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.5
 log
 @taken from aprings_coef  (trans files only)
diff --git src/RCS/apsh_ps.f,v src/RCS/apsh_ps.f,v
index 74998420..18d2da2d 100644
--- src/RCS/apsh_ps.f,v
+++ src/RCS/apsh_ps.f,v
@@ -1,4 +1,4 @@
-head	1.110;
+head	1.111;
 access;
 symbols
 	pre_mrcs:1.110
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.111
+date	2025.11.10.22.32.00;	author dean;	state Exp;
+branches;
+next	1.110;
+
 1.110
 date	2018.10.03.14.33.55;	author leith;	state Exp;
 branches;
@@ -580,9 +585,9 @@ desc
 @
 
 
-1.110
+1.111
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -623,7 +628,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2012  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -1707,6 +1712,17 @@ C       ALMOST ZERO IS LIKELY TO BE ZERO
 @
 
 
+1.110
+log
+@email_health_dept
+@
+text
+@d39 1
+a39 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.109
 log
 @undefined anginheader
diff --git src/RCS/apsh_psc.f,v src/RCS/apsh_psc.f,v
index 27f38089..ba74e25f 100644
--- src/RCS/apsh_psc.f,v
+++ src/RCS/apsh_psc.f,v
@@ -1,4 +1,4 @@
-head	1.41;
+head	1.42;
 access;
 symbols
 	pre_mrcs:1.41
@@ -8,6 +8,11 @@ locks; strict;
 comment	@c @;
 
 
+1.42
+date	2025.11.10.22.32.00;	author dean;	state Exp;
+branches;
+next	1.41;
+
 1.41
 date	2018.10.03.14.33.55;	author leith;	state Exp;
 branches;
@@ -219,9 +224,9 @@ desc
 @
 
 
-1.41
+1.42
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -244,7 +249,7 @@ C=* SPIDER - Modular Image Processing System.                          *
 C=* Authors: J. Frank & A. Leith                                       *
 C=* Copyright 1985-2016  Health Research Inc.                          *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -1192,6 +1197,17 @@ C                MEDIAN FILTER OVER 3x3 SQUARE BOX
 @
 
 
+1.41
+log
+@email_health_dept
+@
+text
+@d21 1
+a21 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.40
 log
 @nullify lcg for ifort use
diff --git src/RCS/apsh_ss.f,v src/RCS/apsh_ss.f,v
index 16936410..4a255606 100644
--- src/RCS/apsh_ss.f,v
+++ src/RCS/apsh_ss.f,v
@@ -1,4 +1,4 @@
-head	1.109;
+head	1.110;
 access;
 symbols
 	pre_mrcs:1.109
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.110
+date	2025.11.10.22.32.00;	author dean;	state Exp;
+branches;
+next	1.109;
+
 1.109
 date	2018.10.03.14.33.55;	author leith;	state Exp;
 branches;
@@ -575,9 +580,9 @@ desc
 @
 
 
-1.109
+1.110
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -618,7 +623,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2011  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -1274,6 +1279,17 @@ C          SAVE CCROT & ANGULAR DISPLACEMENT STATISTICS
 @
 
 
+1.109
+log
+@email_health_dept
+@
+text
+@d39 1
+a39 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.108
 log
 @undefined anginheader
diff --git src/RCS/apsh_tool.f,v src/RCS/apsh_tool.f,v
index 97a286e4..6a0d5c6b 100644
--- src/RCS/apsh_tool.f,v
+++ src/RCS/apsh_tool.f,v
@@ -1,4 +1,4 @@
-head	1.15;
+head	1.16;
 access;
 symbols
 	pre_mrcs:1.15
@@ -8,6 +8,11 @@ locks; strict;
 comment	@c @;
 
 
+1.16
+date	2025.11.10.22.32.00;	author dean;	state Exp;
+branches;
+next	1.15;
+
 1.15
 date	2018.10.03.14.33.55;	author leith;	state Exp;
 branches;
@@ -89,9 +94,9 @@ desc
 @
 
 
-1.15
+1.16
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -105,7 +110,7 @@ C=* SPIDER - Modular Image Processing System.                          *
 C=* Authors: J. Frank & A. Leith                                       *
 C=* Copyright 1985-2011  Health Research Inc.                          *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -1317,6 +1322,17 @@ C       SAVE THE EQUIVALENT TOP NO-SKIP CC
 @
 
 
+1.15
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.14
 log
 @mpibcast T on getdata
diff --git src/RCS/apshift.f,v src/RCS/apshift.f,v
index 89f9fed2..68d8fc23 100644
--- src/RCS/apshift.f,v
+++ src/RCS/apshift.f,v
@@ -1,4 +1,4 @@
-head	1.22;
+head	1.23;
 access;
 symbols
 	pre_mrcs:1.22
@@ -19,6 +19,11 @@ locks; strict;
 comment	@c @;
 
 
+1.23
+date	2025.11.10.22.32.00;	author dean;	state Exp;
+branches;
+next	1.22;
+
 1.22
 date	2018.10.03.14.33.55;	author leith;	state Exp;
 branches;
@@ -134,9 +139,9 @@ desc
 @@
 
 
-1.22
+1.23
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -156,7 +161,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2011  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -385,6 +390,17 @@ C       ADJUST FOR MIRROR OF IMAGE NOT MIRROR OF REF. IMAGE
 @
 
 
+1.22
+log
+@email_health_dept
+@
+text
+@d18 1
+a18 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.21
 log
 @quadri int bug
diff --git src/RCS/apshift_fou.f,v src/RCS/apshift_fou.f,v
index 5655896a..5a6879f3 100644
--- src/RCS/apshift_fou.f,v
+++ src/RCS/apshift_fou.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -7,6 +7,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.32.00;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.33.55;	author leith;	state Exp;
 branches;
@@ -57,9 +62,9 @@ desc
 @@
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -77,7 +82,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2012  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -489,6 +494,17 @@ C                      MIRROR THE IMAGE IN PLACE
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d16 1
+a16 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @all rots
diff --git src/RCS/arasq.f,v src/RCS/arasq.f,v
index 5cb272f7..85caf0c9 100644
--- src/RCS/arasq.f,v
+++ src/RCS/arasq.f,v
@@ -1,4 +1,4 @@
-head	1.21;
+head	1.22;
 access;
 symbols
 	pre_mrcs:1.21
@@ -25,6 +25,11 @@ locks; strict;
 comment	@c @;
 
 
+1.22
+date	2025.11.10.22.32.00;	author dean;	state Exp;
+branches;
+next	1.21;
+
 1.21
 date	2018.10.03.14.33.55;	author leith;	state Exp;
 branches;
@@ -136,9 +141,9 @@ desc
 @
 
 
-1.21
+1.22
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -158,7 +163,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -253,6 +258,17 @@ C       NOW SET REGISTER FROM LEFT HAND NEQ-1 CHARACTERS
 @
 
 
+1.21
+log
+@email_health_dept
+@
+text
+@d18 1
+a18 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.20
 log
 @GPL_2010
diff --git src/RCS/arith.f,v src/RCS/arith.f,v
index 4288b480..88d7a71a 100644
--- src/RCS/arith.f,v
+++ src/RCS/arith.f,v
@@ -1,4 +1,4 @@
-head	1.33;
+head	1.34;
 access;
 symbols
 	pre_mrcs:1.33
@@ -25,6 +25,11 @@ locks; strict;
 comment	@c @;
 
 
+1.34
+date	2025.11.10.22.32.00;	author dean;	state Exp;
+branches;
+next	1.33;
+
 1.33
 date	2018.10.03.14.33.55;	author leith;	state Exp;
 branches;
@@ -196,9 +201,9 @@ desc
 @
 
 
-1.33
+1.34
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -214,7 +219,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -309,6 +314,17 @@ C             CALL CALC(IRPN,NRPN,VAL,BUF(K),BUF(K),IRTFLG)
 @
 
 
+1.33
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.32
 log
 @GPL_2010
diff --git src/RCS/asta.f,v src/RCS/asta.f,v
index 6d237187..54f84500 100644
--- src/RCS/asta.f,v
+++ src/RCS/asta.f,v
@@ -1,4 +1,4 @@
-head	1.14;
+head	1.15;
 access;
 symbols
 	pre_mrcs:1.14
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.15
+date	2025.11.10.22.32.00;	author dean;	state Exp;
+branches;
+next	1.14;
+
 1.14
 date	2018.10.03.14.33.55;	author leith;	state Exp;
 branches;
@@ -100,9 +105,9 @@ desc
 @
 
 
-1.14
+1.15
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -117,7 +122,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2013  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -200,6 +205,17 @@ C       ESTIMATE AVERAGE OUTSIDE THE CIRCLE
 @
 
 
+1.14
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.13
 log
 @*** empty log message ***
diff --git src/RCS/astcyl.f,v src/RCS/astcyl.f,v
index a7e0077a..6d8e5ba7 100644
--- src/RCS/astcyl.f,v
+++ src/RCS/astcyl.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.32.00;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.33.55;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -91,7 +96,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -137,6 +142,17 @@ C--*********************************************************************
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/atmc.f,v src/RCS/atmc.f,v
index 21215c7d..5e9ae66a 100644
--- src/RCS/atmc.f,v
+++ src/RCS/atmc.f,v
@@ -1,4 +1,4 @@
-head	1.7;
+head	1.8;
 access;
 symbols
 	pre_mrcs:1.7
@@ -20,6 +20,11 @@ locks; strict;
 comment	@c @;
 
 
+1.8
+date	2025.11.10.22.32.00;	author dean;	state Exp;
+branches;
+next	1.7;
+
 1.7
 date	2018.10.03.14.33.55;	author leith;	state Exp;
 branches;
@@ -61,9 +66,9 @@ desc
 @
 
 
-1.7
+1.8
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -73,7 +78,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -292,6 +297,17 @@ C                         Found a larger peak, skip the current one
 @
 
 
+1.7
+log
+@email_health_dept
+@
+text
+@d8 1
+a8 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.6
 log
 @CHARACTER (LEN=MAXNAM)
diff --git src/RCS/atpk.f,v src/RCS/atpk.f,v
index 9edc39c6..a777be89 100644
--- src/RCS/atpk.f,v
+++ src/RCS/atpk.f,v
@@ -1,4 +1,4 @@
-head	1.18;
+head	1.19;
 access;
 symbols
 	pre_mrcs:1.18
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.19
+date	2025.11.10.22.32.00;	author dean;	state Exp;
+branches;
+next	1.18;
+
 1.18
 date	2018.10.03.14.33.55;	author leith;	state Exp;
 branches;
@@ -120,9 +125,9 @@ desc
 @
 
 
-1.18
+1.19
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C	
@@ -136,7 +141,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2013  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -261,6 +266,17 @@ C                  123456789 123456789 123456789 123456789 123456789 123456789
 @
 
 
+1.18
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.17
 log
 @used opendoc, added doc file header, added error traps
diff --git src/RCS/atsa.f,v src/RCS/atsa.f,v
index e4485d33..7a9067e4 100644
--- src/RCS/atsa.f,v
+++ src/RCS/atsa.f,v
@@ -1,4 +1,4 @@
-head	1.19;
+head	1.20;
 access;
 symbols
 	pre_mrcs:1.19
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.20
+date	2025.11.10.22.32.00;	author dean;	state Exp;
+branches;
+next	1.19;
+
 1.19
 date	2018.10.03.14.33.55;	author leith;	state Exp;
 branches;
@@ -125,9 +130,9 @@ desc
 @
 
 
-1.19
+1.20
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -141,7 +146,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -266,6 +271,17 @@ c100	CONTINUE
 @
 
 
+1.19
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.18
 log
 @enter
diff --git src/RCS/atwn.f,v src/RCS/atwn.f,v
index 7435d7b3..4a9797ea 100644
--- src/RCS/atwn.f,v
+++ src/RCS/atwn.f,v
@@ -1,4 +1,4 @@
-head	1.21;
+head	1.22;
 access;
 symbols
 	pre_mrcs:1.21
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.22
+date	2025.11.10.22.32.00;	author dean;	state Exp;
+branches;
+next	1.21;
+
 1.21
 date	2018.10.03.14.33.55;	author leith;	state Exp;
 branches;
@@ -135,9 +140,9 @@ desc
 @
 
 
-1.21
+1.22
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -151,7 +156,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -228,6 +233,17 @@ C       NIMA - TOTAL NUMBER OF IMAGES
 @
 
 
+1.21
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.20
 log
 @cosmetic
diff --git src/RCS/averg.f,v src/RCS/averg.f,v
index a0f1fa28..8ff79ff8 100644
--- src/RCS/averg.f,v
+++ src/RCS/averg.f,v
@@ -1,4 +1,4 @@
-head	1.13;
+head	1.14;
 access;
 symbols
 	pre_mrcs:1.13
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.14
+date	2025.11.10.22.32.00;	author dean;	state Exp;
+branches;
+next	1.13;
+
 1.13
 date	2018.10.03.14.33.55;	author leith;	state Exp;
 branches;
@@ -95,9 +100,9 @@ desc
 @
 
 
-1.13
+1.14
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*******************************************************************
@@ -110,7 +115,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -242,6 +247,17 @@ C          J INCREMENTED ONE
 @
 
 
+1.13
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.12
 log
 @added x param
diff --git src/RCS/averg3.f,v src/RCS/averg3.f,v
index 39277b2e..a69d13b3 100644
--- src/RCS/averg3.f,v
+++ src/RCS/averg3.f,v
@@ -1,4 +1,4 @@
-head	1.14;
+head	1.15;
 access;
 symbols
 	pre_mrcs:1.14
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.15
+date	2025.11.10.22.32.00;	author dean;	state Exp;
+branches;
+next	1.14;
+
 1.14
 date	2018.10.03.14.33.55;	author leith;	state Exp;
 branches;
@@ -100,9 +105,9 @@ desc
 @
 
 
-1.14
+1.15
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*******************************************************************
@@ -116,7 +121,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -357,6 +362,17 @@ C          L INCREMENTED ONE ----------------------------------- 6
 @
 
 
+1.14
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.13
 log
 @added x param, nx
diff --git src/RCS/bckc0.f,v src/RCS/bckc0.f,v
index d885a7f7..26071cb8 100644
--- src/RCS/bckc0.f,v
+++ src/RCS/bckc0.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.32.00;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.33.55;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -91,7 +96,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -140,6 +145,17 @@ C     2                 +     DIPX *B(IQX+1)
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/bckc2.f,v src/RCS/bckc2.f,v
index a6ac5f97..1457a5a0 100644
--- src/RCS/bckc2.f,v
+++ src/RCS/bckc2.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.32.00;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.33.55;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -91,7 +96,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -139,6 +144,17 @@ c$omp parallel do private(i)
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/bckpj.f,v src/RCS/bckpj.f,v
index 1481c095..9d2f56ec 100644
--- src/RCS/bckpj.f,v
+++ src/RCS/bckpj.f,v
@@ -1,4 +1,4 @@
-head	1.27;
+head	1.28;
 access;
 symbols
 	pre_mrcs:1.27
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.28
+date	2025.11.10.22.32.00;	author dean;	state Exp;
+branches;
+next	1.27;
+
 1.27
 date	2018.10.03.14.33.56;	author leith;	state Exp;
 branches;
@@ -165,9 +170,9 @@ desc
 @
 
 
-1.27
+1.28
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -183,7 +188,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2012  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -398,6 +403,17 @@ C     &                 +     DIPX *     DIPY *B(MAP(IQX+1,IQY+1))
 @
 
 
+1.27
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.26
 log
 @renamed from: bckcq_, removed bckpj,
diff --git src/RCS/bcq.f,v src/RCS/bcq.f,v
index 466f2c83..1f6d53c2 100644
--- src/RCS/bcq.f,v
+++ src/RCS/bcq.f,v
@@ -1,4 +1,4 @@
-head	1.55;
+head	1.56;
 access;
 symbols
 	pre_mrcs:1.55
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.56
+date	2025.11.10.22.32.00;	author dean;	state Exp;
+branches;
+next	1.55;
+
 1.55
 date	2018.10.03.14.33.56;	author leith;	state Exp;
 branches;
@@ -304,9 +309,9 @@ desc
 @@
 
 
-1.55
+1.56
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -328,7 +333,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -570,6 +575,17 @@ C       DEALLOCATE  ARRAYS
 @
 
 
+1.55
+log
+@email_health_dept
+@
+text
+@d20 1
+a20 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.54
 log
 @enter
diff --git src/RCS/bfact.f,v src/RCS/bfact.f,v
index 38794cf0..8a9b00a0 100644
--- src/RCS/bfact.f,v
+++ src/RCS/bfact.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -20,6 +20,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.32.00;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.33.56;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @@
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -90,7 +95,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2018  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -194,6 +199,17 @@ C                 B-FACTOR NORMALIZATION
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @AMP = AMP*D*(EXP(B*F**2) comment
diff --git src/RCS/bigalloc.f,v src/RCS/bigalloc.f,v
index d2ac8d08..44a1fd11 100644
--- src/RCS/bigalloc.f,v
+++ src/RCS/bigalloc.f,v
@@ -1,4 +1,4 @@
-head	1.5;
+head	1.6;
 access;
 symbols
 	pre_mrcs:1.5
@@ -21,6 +21,11 @@ locks; strict;
 comment	@c @;
 
 
+1.6
+date	2025.11.10.22.32.01;	author dean;	state Exp;
+branches;
+next	1.5;
+
 1.5
 date	2018.10.03.14.33.56;	author leith;	state Exp;
 branches;
@@ -51,9 +56,9 @@ desc
 @@
 
 
-1.5
+1.6
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -67,7 +72,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -165,6 +170,17 @@ C       COMPILED ON UNKNOWN PROBABLY 32 BIT PLATFORM
 @
 
 
+1.5
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.4
 log
 @GPL_2010
diff --git src/RCS/bigended.f,v src/RCS/bigended.f,v
index f1c5b1bb..2374825f 100644
--- src/RCS/bigended.f,v
+++ src/RCS/bigended.f,v
@@ -1,4 +1,4 @@
-head	1.7;
+head	1.8;
 access;
 symbols
 	pre_mrcs:1.7
@@ -21,6 +21,11 @@ locks; strict;
 comment	@c @;
 
 
+1.8
+date	2025.11.10.22.32.01;	author dean;	state Exp;
+branches;
+next	1.7;
+
 1.7
 date	2018.10.03.14.33.56;	author leith;	state Exp;
 branches;
@@ -61,9 +66,9 @@ desc
 @@
 
 
-1.7
+1.8
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -77,7 +82,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -224,6 +229,17 @@ C        RUNNING WITH NON-NATIVE BYTE-SWAPPING
 @
 
 
+1.7
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.6
 log
 @preserved code for another method of finding endedness
diff --git src/RCS/blank.f,v src/RCS/blank.f,v
index dcaaf10b..67a12d75 100644
--- src/RCS/blank.f,v
+++ src/RCS/blank.f,v
@@ -1,4 +1,4 @@
-head	1.13;
+head	1.14;
 access;
 symbols
 	pre_mrcs:1.13
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.14
+date	2025.11.10.22.32.01;	author dean;	state Exp;
+branches;
+next	1.13;
+
 1.13
 date	2018.10.03.14.33.56;	author leith;	state Exp;
 branches;
@@ -95,9 +100,9 @@ desc
 @
 
 
-1.13
+1.14
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -111,7 +116,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -151,6 +156,17 @@ C--********************************************************************
 @
 
 
+1.13
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.12
 log
 @GPL_2010
diff --git src/RCS/bldr.f,v src/RCS/bldr.f,v
index 019b1a08..64790748 100644
--- src/RCS/bldr.f,v
+++ src/RCS/bldr.f,v
@@ -1,4 +1,4 @@
-head	1.12;
+head	1.13;
 access;
 symbols
 	pre_mrcs:1.12
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.13
+date	2025.11.10.22.32.01;	author dean;	state Exp;
+branches;
+next	1.12;
+
 1.12
 date	2018.10.03.14.33.56;	author leith;	state Exp;
 branches;
@@ -90,9 +95,9 @@ desc
 @
 
 
-1.12
+1.13
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -105,7 +110,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -151,6 +156,17 @@ C
 @
 
 
+1.12
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.11
 log
 @reverted
diff --git src/RCS/blob.f,v src/RCS/blob.f,v
index ed8090ec..3ca24096 100644
--- src/RCS/blob.f,v
+++ src/RCS/blob.f,v
@@ -1,4 +1,4 @@
-head	1.7;
+head	1.8;
 access;
 symbols
 	pre_mrcs:1.7
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.8
+date	2025.11.10.22.32.01;	author dean;	state Exp;
+branches;
+next	1.7;
+
 1.7
 date	2018.10.03.14.33.56;	author leith;	state Exp;
 branches;
@@ -65,9 +70,9 @@ desc
 @
 
 
-1.7
+1.8
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -80,7 +85,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -125,6 +130,17 @@ c$omp parallel do private(j,i,r,r2)
 @
 
 
+1.7
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.6
 log
 @GPL_2010
diff --git src/RCS/blob_q.f,v src/RCS/blob_q.f,v
index d7484748..6c4aaf5c 100644
--- src/RCS/blob_q.f,v
+++ src/RCS/blob_q.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.32.01;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.33.56;	author leith;	state Exp;
 branches;
@@ -69,9 +74,9 @@ desc
 @@
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -85,7 +90,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -133,6 +138,17 @@ c$omp parallel do private(j,i,r,r2)
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @GPL_2010
diff --git src/RCS/bmax_c.f,v src/RCS/bmax_c.f,v
index fce02199..1beb5331 100644
--- src/RCS/bmax_c.f,v
+++ src/RCS/bmax_c.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.32.01;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.33.56;	author leith;	state Exp;
 branches;
@@ -80,9 +85,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -96,7 +101,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -138,6 +143,17 @@ C***********************************************************************
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @GPL_2010
diff --git src/RCS/bmax_s.f,v src/RCS/bmax_s.f,v
index fd29448f..42e27a31 100644
--- src/RCS/bmax_s.f,v
+++ src/RCS/bmax_s.f,v
@@ -1,4 +1,4 @@
-head	1.12;
+head	1.13;
 access;
 symbols
 	pre_mrcs:1.12
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.13
+date	2025.11.10.22.32.02;	author dean;	state Exp;
+branches;
+next	1.12;
+
 1.12
 date	2018.10.03.14.33.56;	author leith;	state Exp;
 branches;
@@ -90,9 +95,9 @@ desc
 @
 
 
-1.12
+1.13
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -106,7 +111,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -159,6 +164,17 @@ c$omp parallel do  private(i),schedule(static)
 @
 
 
+1.12
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.11
 log
 @GPL_2010
diff --git src/RCS/bmin_c.f,v src/RCS/bmin_c.f,v
index fd5583e2..098851c9 100644
--- src/RCS/bmin_c.f,v
+++ src/RCS/bmin_c.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.32.02;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.33.56;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -91,7 +96,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -133,6 +138,17 @@ C***********************************************************************
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/bmin_s.f,v src/RCS/bmin_s.f,v
index f430a028..3ed9091f 100644
--- src/RCS/bmin_s.f,v
+++ src/RCS/bmin_s.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.32.02;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.33.56;	author leith;	state Exp;
 branches;
@@ -85,9 +90,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -101,7 +106,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -154,6 +159,17 @@ c$omp parallel do  private(i),schedule(static)
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @GPL_2010
diff --git src/RCS/boxx.f,v src/RCS/boxx.f,v
index 313a4e56..92ee6712 100644
--- src/RCS/boxx.f,v
+++ src/RCS/boxx.f,v
@@ -1,4 +1,4 @@
-head	1.18;
+head	1.19;
 access;
 symbols
 	pre_mrcs:1.18
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.19
+date	2025.11.10.22.32.02;	author dean;	state Exp;
+branches;
+next	1.18;
+
 1.18
 date	2018.10.03.14.33.56;	author leith;	state Exp;
 branches;
@@ -120,9 +125,9 @@ desc
 @
 
 
-1.18
+1.19
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C+*********************************************************************
@@ -139,7 +144,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2012  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -567,6 +572,17 @@ C                   SECOND OR GREATER LINE OF THIS SLICE
 
 
 
+@
+
+
+1.18
+log
+@email_health_dept
+@
+text
+@d15 1
+a15 1
+C=* Email: spider@@health.ny.gov                                        *
 @
 
 
diff --git src/RCS/bp3f.f,v src/RCS/bp3f.f,v
index d9f91b85..d9f8a36e 100644
--- src/RCS/bp3f.f,v
+++ src/RCS/bp3f.f,v
@@ -1,4 +1,4 @@
-head	1.71;
+head	1.72;
 access;
 symbols
 	pre_mrcs:1.71
@@ -23,6 +23,11 @@ locks; strict;
 comment	@c @;
 
 
+1.72
+date	2025.11.10.22.32.02;	author dean;	state Exp;
+branches;
+next	1.71;
+
 1.71
 date	2018.10.03.14.33.56;	author leith;	state Exp;
 branches;
@@ -384,9 +389,9 @@ desc
 @
 
 
-1.71
+1.72
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -1614,7 +1619,7 @@ C=*                                                                    *
 C=* HEALTH RESEARCH INCORPORATED (HRI),                                *   
 C=* ONE UNIVERSITY PLACE, RENSSELAER, NY 12144-3455.                   *
 C=*                                                                    *
-C=* Email:  spider@@health.ny.gov                                       *
+C=* Email:  spider@@wadsworth.org                                       *
 C=*                                                                    *
 C=* This program is free software; you can redistribute it and/or      *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -1768,6 +1773,17 @@ c$omp   parallel do private(i,j,k)
 
 
 	
+@
+
+
+1.71
+log
+@email_health_dept
+@
+text
+@d1226 1
+a1226 1
+C=* Email:  spider@@health.ny.gov                                       *
 @
 
 
diff --git src/RCS/bpcg.f,v src/RCS/bpcg.f,v
index e031fcdd..9e62439e 100644
--- src/RCS/bpcg.f,v
+++ src/RCS/bpcg.f,v
@@ -1,4 +1,4 @@
-head	1.70;
+head	1.71;
 access;
 symbols
 	pre_mrcs:1.70
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.71
+date	2025.11.10.22.32.02;	author dean;	state Exp;
+branches;
+next	1.70;
+
 1.70
 date	2018.10.03.14.33.56;	author leith;	state Exp;
 branches;
@@ -380,9 +385,9 @@ desc
 @
 
 
-1.70
+1.71
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -414,7 +419,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2015  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -2305,6 +2310,17 @@ C             WRITE FINAL ERROR ALWAYS
 @
 
 
+1.70
+log
+@email_health_dept
+@
+text
+@d30 1
+a30 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.69
 log
 @verbose output tracing, ==
diff --git src/RCS/bpcm.f,v src/RCS/bpcm.f,v
index d493a3bf..c9875428 100644
--- src/RCS/bpcm.f,v
+++ src/RCS/bpcm.f,v
@@ -1,4 +1,4 @@
-head	1.14;
+head	1.15;
 access;
 symbols
 	pre_mrcs:1.14
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.15
+date	2025.11.10.22.32.02;	author dean;	state Exp;
+branches;
+next	1.14;
+
 1.14
 date	2018.10.03.14.33.56;	author leith;	state Exp;
 branches;
@@ -99,9 +104,9 @@ desc
 @@
 
 
-1.14
+1.15
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -115,7 +120,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -205,6 +210,17 @@ c     &                 +     DIPX *     DIPY *B(MAP(IQX+1,IQY+1))
 @
 
 
+1.14
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.13
 log
 @GPL_2010
diff --git src/RCS/bpcmp.f,v src/RCS/bpcmp.f,v
index 435059e6..d31de0f3 100644
--- src/RCS/bpcmp.f,v
+++ src/RCS/bpcmp.f,v
@@ -1,4 +1,4 @@
-head	1.22;
+head	1.23;
 access;
 symbols
 	pre_mrcs:1.22
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.23
+date	2025.11.10.22.32.03;	author dean;	state Exp;
+branches;
+next	1.22;
+
 1.22
 date	2018.10.03.14.33.56;	author leith;	state Exp;
 branches;
@@ -139,9 +144,9 @@ desc
 @@
 
 
-1.22
+1.23
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -157,7 +162,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -230,6 +235,17 @@ C          LOAD THE PROJECTION, DO NOT USE REDVOL
 @
 
 
+1.22
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.21
 log
 @GPL_2010
diff --git src/RCS/bpcq.f,v src/RCS/bpcq.f,v
index 50b2296e..0e02caa1 100644
--- src/RCS/bpcq.f,v
+++ src/RCS/bpcq.f,v
@@ -1,4 +1,4 @@
-head	1.13;
+head	1.14;
 access;
 symbols
 	pre_mrcs:1.13
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.14
+date	2025.11.10.22.32.03;	author dean;	state Exp;
+branches;
+next	1.13;
+
 1.13
 date	2018.10.03.14.33.56;	author leith;	state Exp;
 branches;
@@ -94,9 +99,9 @@ desc
 @@
 
 
-1.13
+1.14
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -110,7 +115,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -180,6 +185,17 @@ C     &                 +     DIPX *     DIPY *B(MAP(IQX+1,IQY+1))
 @
 
 
+1.13
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.12
 log
 @GPL_2010
diff --git src/RCS/bpcqp.f,v src/RCS/bpcqp.f,v
index f391d17b..86dc9083 100644
--- src/RCS/bpcqp.f,v
+++ src/RCS/bpcqp.f,v
@@ -1,4 +1,4 @@
-head	1.25;
+head	1.26;
 access;
 symbols
 	pre_mrcs:1.25
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.26
+date	2025.11.10.22.32.03;	author dean;	state Exp;
+branches;
+next	1.25;
+
 1.25
 date	2018.10.03.14.33.56;	author leith;	state Exp;
 branches;
@@ -154,9 +159,9 @@ desc
 @@
 
 
-1.25
+1.26
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -172,7 +177,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -253,6 +258,17 @@ C          LOAD THE PROJECTION, DO NOT USE REDVOL
 @
 
 
+1.25
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.24
 log
 @GPL_2010
diff --git src/RCS/bprj2.f,v src/RCS/bprj2.f,v
index aaa0d027..c5983262 100644
--- src/RCS/bprj2.f,v
+++ src/RCS/bprj2.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.32.03;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.33.56;	author leith;	state Exp;
 branches;
@@ -85,9 +90,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -101,7 +106,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -146,6 +151,17 @@ C***********************************************************************
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @GPL_2010
diff --git src/RCS/bps2.f,v src/RCS/bps2.f,v
index d5a99a46..640413e9 100644
--- src/RCS/bps2.f,v
+++ src/RCS/bps2.f,v
@@ -1,4 +1,4 @@
-head	1.25;
+head	1.26;
 access;
 symbols
 	pre_mrcs:1.25
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.26
+date	2025.11.10.22.32.03;	author dean;	state Exp;
+branches;
+next	1.25;
+
 1.25
 date	2018.10.03.14.33.56;	author leith;	state Exp;
 branches;
@@ -155,9 +160,9 @@ desc
 @
 
 
-1.25
+1.26
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -172,7 +177,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -384,6 +389,17 @@ C
 @
 
 
+1.25
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.24
 log
 @formatting ,prompts,cosmetic
diff --git src/RCS/bpwr.f,v src/RCS/bpwr.f,v
index 051cf5b9..6a1da4a9 100644
--- src/RCS/bpwr.f,v
+++ src/RCS/bpwr.f,v
@@ -1,4 +1,4 @@
-head	1.23;
+head	1.24;
 access;
 symbols
 	pre_mrcs:1.23
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.24
+date	2025.11.10.22.32.03;	author dean;	state Exp;
+branches;
+next	1.23;
+
 1.23
 date	2018.10.03.14.33.56;	author leith;	state Exp;
 branches;
@@ -145,9 +150,9 @@ desc
 @
 
 
-1.23
+1.24
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -162,7 +167,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -275,6 +280,17 @@ C--*********************************************************************
 @
 
 
+1.23
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.22
 log
 @echo formatting
diff --git src/RCS/bpwr_q.f,v src/RCS/bpwr_q.f,v
index 1645a29b..1c6361e8 100644
--- src/RCS/bpwr_q.f,v
+++ src/RCS/bpwr_q.f,v
@@ -1,4 +1,4 @@
-head	1.19;
+head	1.20;
 access;
 symbols
 	pre_mrcs:1.19
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.20
+date	2025.11.10.22.32.03;	author dean;	state Exp;
+branches;
+next	1.19;
+
 1.19
 date	2018.10.03.14.33.57;	author leith;	state Exp;
 branches;
@@ -125,9 +130,9 @@ desc
 @
 
 
-1.19
+1.20
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -141,7 +146,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -307,6 +312,17 @@ C        ENDIF COMES FROM SKIPPING A FILE
 @
 
 
+1.19
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.18
 log
 @finpat passed bug
diff --git src/RCS/buildm.f,v src/RCS/buildm.f,v
index 53f968ed..a34a989f 100644
--- src/RCS/buildm.f,v
+++ src/RCS/buildm.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -21,6 +21,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.32.03;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.02;	author leith;	state Exp;
 branches;
@@ -72,9 +77,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -87,7 +92,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -156,6 +161,17 @@ C             MISSING KEY
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @FORMAT('  PROJECTION
diff --git src/RCS/builds.f,v src/RCS/builds.f,v
index ea96f4e0..5a388917 100644
--- src/RCS/builds.f,v
+++ src/RCS/builds.f,v
@@ -1,4 +1,4 @@
-head	1.6;
+head	1.7;
 access;
 symbols
 	pre_mrcs:1.6
@@ -21,6 +21,11 @@ locks; strict;
 comment	@c @;
 
 
+1.7
+date	2025.11.10.22.32.03;	author dean;	state Exp;
+branches;
+next	1.6;
+
 1.6
 date	2018.10.03.14.34.02;	author leith;	state Exp;
 branches;
@@ -57,9 +62,9 @@ desc
 @
 
 
-1.6
+1.7
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -73,7 +78,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -132,6 +137,17 @@ C             MISSING KEY
 @
 
 
+1.6
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.5
 log
 @GPL_2010
diff --git src/RCS/buterp.f,v src/RCS/buterp.f,v
index 5a64e855..dcd961cb 100644
--- src/RCS/buterp.f,v
+++ src/RCS/buterp.f,v
@@ -1,4 +1,4 @@
-head	1.14;
+head	1.15;
 access;
 symbols
 	pre_mrcs:1.14
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.15
+date	2025.11.10.22.32.03;	author dean;	state Exp;
+branches;
+next	1.14;
+
 1.14
 date	2018.10.03.14.34.02;	author leith;	state Exp;
 branches;
@@ -99,9 +104,9 @@ desc
 @@
 
 
-1.14
+1.15
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -114,7 +119,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -213,6 +218,17 @@ C***********************************************************************
 @
 
 
+1.14
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.13
 log
 @PASS-BAND AND STOP BAND FREQUENCY
diff --git src/RCS/calc.f,v src/RCS/calc.f,v
index f5778e4b..d9e65bd5 100644
--- src/RCS/calc.f,v
+++ src/RCS/calc.f,v
@@ -1,4 +1,4 @@
-head	1.33;
+head	1.34;
 access;
 symbols
 	pre_mrcs:1.33
@@ -25,6 +25,11 @@ locks; strict;
 comment	@c @;
 
 
+1.34
+date	2025.11.10.22.32.03;	author dean;	state Exp;
+branches;
+next	1.33;
+
 1.33
 date	2018.10.03.14.34.02;	author leith;	state Exp;
 branches;
@@ -195,9 +200,9 @@ desc
 @@
 
 
-1.33
+1.34
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*************************************************** 12/11/79 1/11/81 VAX
@@ -211,7 +216,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -525,6 +530,17 @@ C          END OF EVALUATION LOOP -----------------------------------
 @
 
 
+1.33
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.32
 log
 @detab
diff --git src/RCS/cald.f,v src/RCS/cald.f,v
index 3fc4574b..0a0d4500 100644
--- src/RCS/cald.f,v
+++ src/RCS/cald.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.32.03;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.02;	author leith;	state Exp;
 branches;
@@ -80,9 +85,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -95,7 +100,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -198,6 +203,17 @@ C<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @GPL_2010
diff --git src/RCS/cang.f,v src/RCS/cang.f,v
index 80244684..aa389cdb 100644
--- src/RCS/cang.f,v
+++ src/RCS/cang.f,v
@@ -1,4 +1,4 @@
-head	1.15;
+head	1.16;
 access;
 symbols
 	pre_mrcs:1.15
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.16
+date	2025.11.10.22.32.03;	author dean;	state Exp;
+branches;
+next	1.15;
+
 1.15
 date	2018.10.03.14.34.02;	author leith;	state Exp;
 branches;
@@ -104,9 +109,9 @@ desc
 @@
 
 
-1.15
+1.16
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -120,7 +125,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2011  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -226,6 +231,17 @@ C          WANT TO RETURN SS
 @
 
 
+1.15
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.14
 log
 @cosmetics
diff --git src/RCS/cc1gfilt.f,v src/RCS/cc1gfilt.f,v
index 9978906f..f15227e0 100644
--- src/RCS/cc1gfilt.f,v
+++ src/RCS/cc1gfilt.f,v
@@ -1,4 +1,4 @@
-head	1.7;
+head	1.8;
 access;
 symbols
 	pre_mrcs:1.7
@@ -20,6 +20,11 @@ locks; strict;
 comment	@c @;
 
 
+1.8
+date	2025.11.10.22.32.03;	author dean;	state Exp;
+branches;
+next	1.7;
+
 1.7
 date	2018.10.03.14.34.02;	author leith;	state Exp;
 branches;
@@ -61,9 +66,9 @@ desc
 @
 
 
-1.7
+1.8
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C=**********************************************************************
@@ -75,7 +80,7 @@ C=**********************************************************************
 C=* From: SPIDER - MODULAR IMAGE PROCESSING SYSTEM                     *
 C=* Copyright (C)2000  M. Radermacher                                  *
 C=*                                                                    *
-C=* Email:  spider@@health.ny.gov                                       *
+C=* Email:  spider@@wadsworth.org                                       *
 C=*                                                                    *
 C=* This program is free software; you can redistribute it and/or      *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -322,6 +327,17 @@ C          NORMALIZE LINE TO A MAXIMUM OF 1:
 @
 
 
+1.7
+log
+@email_health_dept
+@
+text
+@d10 1
+a10 1
+C=* Email:  spider@@health.ny.gov                                       *
+@
+
+
 1.6
 log
 @CHARACTER (LEN=MAXNAM) :: FILN1
diff --git src/RCS/ccc.f,v src/RCS/ccc.f,v
index a7500dbe..11768d72 100644
--- src/RCS/ccc.f,v
+++ src/RCS/ccc.f,v
@@ -1,4 +1,4 @@
-head	1.27;
+head	1.28;
 access;
 symbols
 	pre_mrcs:1.27
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.28
+date	2025.11.10.22.32.03;	author dean;	state Exp;
+branches;
+next	1.27;
+
 1.27
 date	2018.10.03.14.34.02;	author leith;	state Exp;
 branches;
@@ -165,9 +170,9 @@ desc
 @
 
 
-1.27
+1.28
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -183,7 +188,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -302,6 +307,17 @@ C          SKIP FILE INFO IF NOT-VERBOSE
 @
 
 
+1.27
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.26
 log
 @lnblnkn used
diff --git src/RCS/cconect.f,v src/RCS/cconect.f,v
index ce639b58..68dbebe6 100644
--- src/RCS/cconect.f,v
+++ src/RCS/cconect.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.32.03;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.02;	author leith;	state Exp;
 branches;
@@ -80,9 +85,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -96,7 +101,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -258,6 +263,17 @@ C                      END OF CLUSTER ON THIS ROW OF SECOND SLICE
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @GPL_2010
diff --git src/RCS/ccrd_2.f,v src/RCS/ccrd_2.f,v
index 7aba087b..35533a28 100644
--- src/RCS/ccrd_2.f,v
+++ src/RCS/ccrd_2.f,v
@@ -1,4 +1,4 @@
-head	1.17;
+head	1.18;
 access;
 symbols
 	pre_mrcs:1.17
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.18
+date	2025.11.10.22.32.03;	author dean;	state Exp;
+branches;
+next	1.17;
+
 1.17
 date	2018.10.03.14.34.02;	author leith;	state Exp;
 branches;
@@ -115,9 +120,9 @@ desc
 @
 
 
-1.17
+1.18
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -133,7 +138,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -255,6 +260,17 @@ C$omp   parallel do private(i,j,iy,argy,arg,tmpr,tmpi,fnrm)
 @
 
 
+1.17
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.16
 log
 @cc h
diff --git src/RCS/ccrd_3.f,v src/RCS/ccrd_3.f,v
index c7f9bf69..54b2fe72 100644
--- src/RCS/ccrd_3.f,v
+++ src/RCS/ccrd_3.f,v
@@ -1,4 +1,4 @@
-head	1.15;
+head	1.16;
 access;
 symbols
 	pre_mrcs:1.15
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.16
+date	2025.11.10.22.32.03;	author dean;	state Exp;
+branches;
+next	1.15;
+
 1.15
 date	2018.10.03.14.34.02;	author leith;	state Exp;
 branches;
@@ -105,9 +110,9 @@ desc
 @
 
 
-1.15
+1.16
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -123,7 +128,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -269,6 +274,17 @@ c$omp   parallel do private(i,j,k,iy,iz,arg,argy,argz,tmpr,tmpi,fnrm)
 @
 
 
+1.15
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.14
 log
 @cc h
diff --git src/RCS/ccrs.f,v src/RCS/ccrs.f,v
index 61fc402a..dc59ae59 100644
--- src/RCS/ccrs.f,v
+++ src/RCS/ccrs.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -12,6 +12,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.32.03;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.02;	author leith;	state Exp;
 branches;
@@ -72,9 +77,9 @@ desc
 @@
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -90,7 +95,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -462,6 +467,17 @@ shud be_________________________________
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @MOD(NSLICE,2) .EQ. 0  .OR.  NSLICE == 1
diff --git src/RCS/ccrs_2.f,v src/RCS/ccrs_2.f,v
index 08bbb010..93b67fec 100644
--- src/RCS/ccrs_2.f,v
+++ src/RCS/ccrs_2.f,v
@@ -1,4 +1,4 @@
-head	1.26;
+head	1.27;
 access;
 symbols
 	pre_mrcs:1.26
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.27
+date	2025.11.10.22.32.03;	author dean;	state Exp;
+branches;
+next	1.26;
+
 1.26
 date	2018.10.03.14.34.02;	author leith;	state Exp;
 branches;
@@ -160,9 +165,9 @@ desc
 @
 
 
-1.26
+1.27
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -180,7 +185,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2013  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -429,6 +434,17 @@ C       PHASE CORRELATION
 @
 
 
+1.26
+log
+@email_health_dept
+@
+text
+@d16 1
+a16 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.25
 log
 @nx, comments
diff --git src/RCS/ccrs_ph_3.f,v src/RCS/ccrs_ph_3.f,v
index a5dccded..8524cc9e 100644
--- src/RCS/ccrs_ph_3.f,v
+++ src/RCS/ccrs_ph_3.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -16,6 +16,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.32.03;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.02;	author leith;	state Exp;
 branches;
@@ -66,9 +71,9 @@ desc
 @@
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -86,7 +91,7 @@ C=*                                                                    *
 C=* HEALTH RESEARCH INCORPORATED (HRI),                                *   
 C=* ONE UNIVERSITY PLACE, RENSSELAER, NY 12144-3455.                   *
 C=*                                                                    *
-C=* Email:  spider@@health.ny.gov                                       *
+C=* Email:  spider@@wadsworth.org                                       *
 C=*                                                                    *
 C=* This program is free software; you can redistribute it and/or      *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -209,6 +214,17 @@ c$omp&                     badbtm,btm)
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d16 1
+a16 1
+C=* Email:  spider@@health.ny.gov                                       *
+@
+
+
 1.8
 log
 @error trap
diff --git src/RCS/cengr3.f,v src/RCS/cengr3.f,v
index 505c304a..1c7c60b8 100644
--- src/RCS/cengr3.f,v
+++ src/RCS/cengr3.f,v
@@ -1,4 +1,4 @@
-head	1.21;
+head	1.22;
 access;
 symbols
 	pre_mrcs:1.21
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.22
+date	2025.11.10.22.32.04;	author dean;	state Exp;
+branches;
+next	1.21;
+
 1.21
 date	2018.10.03.14.34.02;	author leith;	state Exp;
 branches;
@@ -135,9 +140,9 @@ desc
 @
 
 
-1.21
+1.22
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -153,7 +158,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2012  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -298,6 +303,17 @@ C          NOW CALCULATE RADIUS OF GYRATION, RG
 @
 
 
+1.21
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.20
 log
 @output formatting
diff --git src/RCS/cent_3ph.f,v src/RCS/cent_3ph.f,v
index e9655c07..9315c924 100644
--- src/RCS/cent_3ph.f,v
+++ src/RCS/cent_3ph.f,v
@@ -1,4 +1,4 @@
-head	1.12;
+head	1.13;
 access;
 symbols
 	pre_mrcs:1.12
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.13
+date	2025.11.10.22.32.04;	author dean;	state Exp;
+branches;
+next	1.12;
+
 1.12
 date	2018.10.03.14.34.02;	author leith;	state Exp;
 branches;
@@ -90,9 +95,9 @@ desc
 @
 
 
-1.12
+1.13
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -107,7 +112,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2012  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -194,6 +199,17 @@ C
 @
 
 
+1.12
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.11
 log
 @comment
diff --git src/RCS/cent_ph.f,v src/RCS/cent_ph.f,v
index 4bc4c06c..348ab1f0 100644
--- src/RCS/cent_ph.f,v
+++ src/RCS/cent_ph.f,v
@@ -1,4 +1,4 @@
-head	1.14;
+head	1.15;
 access;
 symbols
 	pre_mrcs:1.14
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.15
+date	2025.11.10.22.32.04;	author dean;	state Exp;
+branches;
+next	1.14;
+
 1.14
 date	2018.10.03.14.34.02;	author leith;	state Exp;
 branches;
@@ -100,9 +105,9 @@ desc
 @
 
 
-1.14
+1.15
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -117,7 +122,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2012  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -200,6 +205,17 @@ c$omp    parallel do private(j,jm1,i,t),reduction(+:c,s)
 @
 
 
+1.14
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.13
 log
 @reformatted text, comments, nx,ny
diff --git src/RCS/cent_q.f,v src/RCS/cent_q.f,v
index 6eb043fa..97b2b7f6 100644
--- src/RCS/cent_q.f,v
+++ src/RCS/cent_q.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.32.04;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.02;	author leith;	state Exp;
 branches;
@@ -79,9 +84,9 @@ desc
 @@
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -94,7 +99,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -159,6 +164,17 @@ c$omp parallel do private(i,t,j),reduction(+:c,s)
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @GPL_2010
diff --git src/RCS/cent_rod.f,v src/RCS/cent_rod.f,v
index b70d0086..ba969e7f 100644
--- src/RCS/cent_rod.f,v
+++ src/RCS/cent_rod.f,v
@@ -1,4 +1,4 @@
-head	1.2;
+head	1.3;
 access;
 symbols
 	pre_mrcs:1.2
@@ -7,6 +7,11 @@ locks; strict;
 comment	@c @;
 
 
+1.3
+date	2025.11.10.22.32.04;	author dean;	state Exp;
+branches;
+next	1.2;
+
 1.2
 date	2018.10.03.14.34.02;	author leith;	state Exp;
 branches;
@@ -22,9 +27,9 @@ desc
 @@
 
 
-1.2
+1.3
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C **********************************************************************
@@ -37,7 +42,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NROW 12204.    *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -425,6 +430,17 @@ c$omp  parallel do private(iy,fy,ycod,ysid, ix,fx, xold,yold)
 @
 
 
+1.2
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.1
 log
 @Initial revision
diff --git src/RCS/cent_sym.f,v src/RCS/cent_sym.f,v
index 1797a0fa..3c3036b8 100644
--- src/RCS/cent_sym.f,v
+++ src/RCS/cent_sym.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -7,6 +7,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.32.04;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.02;	author leith;	state Exp;
 branches;
@@ -62,9 +67,9 @@ desc
 @@
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C **********************************************************************
@@ -77,7 +82,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2012  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NROW 12204.    *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -319,6 +324,17 @@ C       write(6,*), 'SHX, SHY = ', SHX2, SHY2
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @merged with cent_symobj, cosmetic
diff --git src/RCS/cgr_3.f,v src/RCS/cgr_3.f,v
index 254afccc..bb283ab3 100644
--- src/RCS/cgr_3.f,v
+++ src/RCS/cgr_3.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.32.04;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.02;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -91,7 +96,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -172,6 +177,17 @@ C--*********************************************************************
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/changeval.f,v src/RCS/changeval.f,v
index 4ca23358..f1a12524 100644
--- src/RCS/changeval.f,v
+++ src/RCS/changeval.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.32.04;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.02;	author leith;	state Exp;
 branches;
@@ -85,9 +90,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -101,7 +106,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -166,6 +171,17 @@ C--********************************************************************
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @GPL_2010
diff --git src/RCS/charinside.f,v src/RCS/charinside.f,v
index eacfcfc3..d2e2040d 100644
--- src/RCS/charinside.f,v
+++ src/RCS/charinside.f,v
@@ -1,4 +1,4 @@
-head	1.12;
+head	1.13;
 access;
 symbols
 	pre_mrcs:1.12
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.13
+date	2025.11.10.22.32.05;	author dean;	state Exp;
+branches;
+next	1.12;
+
 1.12
 date	2018.10.03.14.34.02;	author leith;	state Exp;
 branches;
@@ -90,9 +95,9 @@ desc
 @
 
 
-1.12
+1.13
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -107,7 +112,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -223,6 +228,17 @@ C      FIND NUMBER OF CHARACTERS IN RETURNED SUBSTRING
 @
 
 
+1.12
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.11
 log
 @GPL_2010
diff --git src/RCS/chava.f,v src/RCS/chava.f,v
index 3f4ad3e1..dcf86003 100644
--- src/RCS/chava.f,v
+++ src/RCS/chava.f,v
@@ -1,4 +1,4 @@
-head	1.19;
+head	1.20;
 access;
 symbols
 	pre_mrcs:1.19
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.20
+date	2025.11.10.22.32.05;	author dean;	state Exp;
+branches;
+next	1.19;
+
 1.19
 date	2018.10.03.14.34.02;	author leith;	state Exp;
 branches;
@@ -125,9 +130,9 @@ desc
 @
 
 
-1.19
+1.20
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C **********************************************************************
@@ -143,7 +148,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2013  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -344,6 +349,17 @@ C        READ FROM CLUSTER FILE ON: LUNK
 @
 
 
+1.19
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.18
 log
 @*** empty log message ***
diff --git src/RCS/chisq.f,v src/RCS/chisq.f,v
index 2ad66012..553389cb 100644
--- src/RCS/chisq.f,v
+++ src/RCS/chisq.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.32.05;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.02;	author leith;	state Exp;
 branches;
@@ -80,9 +85,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -96,7 +101,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -162,6 +167,17 @@ C***********************************************************************
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @GPL_2010
diff --git src/RCS/chkinpq.f,v src/RCS/chkinpq.f,v
index bb05e7d7..c657cd1a 100644
--- src/RCS/chkinpq.f,v
+++ src/RCS/chkinpq.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.32.05;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.34.02;	author leith;	state Exp;
 branches;
@@ -70,9 +75,9 @@ desc
 @
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -86,7 +91,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -173,6 +178,17 @@ C      WHICH NOT FOUND IN SMENU
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @GPL_2010
diff --git src/RCS/chkstr.f,v src/RCS/chkstr.f,v
index fb1d1ffc..7faad539 100644
--- src/RCS/chkstr.f,v
+++ src/RCS/chkstr.f,v
@@ -1,4 +1,4 @@
-head	1.22;
+head	1.23;
 access;
 symbols
 	pre_mrcs:1.22
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.23
+date	2025.11.10.22.32.05;	author dean;	state Exp;
+branches;
+next	1.22;
+
 1.22
 date	2018.10.03.14.34.02;	author leith;	state Exp;
 branches;
@@ -140,9 +145,9 @@ desc
 @
 
 
-1.22
+1.23
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -161,7 +166,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -311,6 +316,17 @@ c     &                     '  IGO: ',IGO,' IEND: ',IEND
 
         
              
+@
+
+
+1.22
+log
+@email_health_dept
+@
+text
+@d17 1
+a17 1
+C=* Email: spider@@health.ny.gov                                        *
 @
 
 
diff --git src/RCS/chkstuff.f,v src/RCS/chkstuff.f,v
index 121621f1..d84873d5 100644
--- src/RCS/chkstuff.f,v
+++ src/RCS/chkstuff.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -8,6 +8,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.32.05;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.02;	author leith;	state Exp;
 branches;
@@ -68,9 +73,9 @@ desc
 @@
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -83,7 +88,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2008  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -506,6 +511,17 @@ C        CURVE HEIGHT
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @chkplot
diff --git src/RCS/clast.f,v src/RCS/clast.f,v
index 46fab0b6..223e196e 100644
--- src/RCS/clast.f,v
+++ src/RCS/clast.f,v
@@ -1,4 +1,4 @@
-head	1.17;
+head	1.18;
 access;
 symbols
 	pre_mrcs:1.17
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.18
+date	2025.11.10.22.32.05;	author dean;	state Exp;
+branches;
+next	1.17;
+
 1.17
 date	2018.10.03.14.34.02;	author leith;	state Exp;
 branches;
@@ -115,9 +120,9 @@ desc
 @
 
 
-1.17
+1.18
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -133,7 +138,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2011  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -245,6 +250,17 @@ C     UPDATE COORDINATES OF THE GRAVITY CENTERS
 @
 
 
+1.17
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.16
 log
 @factor list (KV) added
diff --git src/RCS/clss.f,v src/RCS/clss.f,v
index fa4ae940..6a3ad227 100644
--- src/RCS/clss.f,v
+++ src/RCS/clss.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.32.05;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.34.02;	author leith;	state Exp;
 branches;
@@ -70,9 +75,9 @@ desc
 @
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -86,7 +91,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -167,6 +172,17 @@ C
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @GPL_2010
diff --git src/RCS/cncalc.f,v src/RCS/cncalc.f,v
index c5fc4527..cbfba5d5 100644
--- src/RCS/cncalc.f,v
+++ src/RCS/cncalc.f,v
@@ -1,4 +1,4 @@
-head	1.14;
+head	1.15;
 access;
 symbols
 	pre_mrcs:1.14
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.15
+date	2025.11.10.22.32.05;	author dean;	state Exp;
+branches;
+next	1.14;
+
 1.14
 date	2018.10.03.14.34.02;	author leith;	state Exp;
 branches;
@@ -100,9 +105,9 @@ desc
 @
 
 
-1.14
+1.15
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -116,7 +121,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -274,6 +279,17 @@ C       NUMBER OF ITERATIONS
 @
 
 
+1.14
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.13
 log
 @GPL_2010
diff --git src/RCS/cnint3.f,v src/RCS/cnint3.f,v
index ca39d75e..df614225 100644
--- src/RCS/cnint3.f,v
+++ src/RCS/cnint3.f,v
@@ -1,4 +1,4 @@
-head	1.27;
+head	1.28;
 access;
 symbols
 	pre_mrcs:1.27
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.28
+date	2025.11.10.22.32.05;	author dean;	state Exp;
+branches;
+next	1.27;
+
 1.27
 date	2018.10.03.14.34.02;	author leith;	state Exp;
 branches;
@@ -165,9 +170,9 @@ desc
 @
 
 
-1.27
+1.28
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -184,7 +189,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -465,6 +470,17 @@ C            GIVE IMMEDIATE POSTSCRIPT PLOT (IF DESIRED)
 @
 
 
+1.27
+log
+@email_health_dept
+@
+text
+@d15 1
+a15 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.26
 log
 @LEN=MAXNAM
diff --git src/RCS/cnrd_2.f,v src/RCS/cnrd_2.f,v
index 30d1254c..623522f3 100644
--- src/RCS/cnrd_2.f,v
+++ src/RCS/cnrd_2.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.32.05;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.02;	author leith;	state Exp;
 branches;
@@ -85,9 +90,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -103,7 +108,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -167,6 +172,17 @@ C--*********************************************************************
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @GPL_2010
diff --git src/RCS/cnrd_3.f,v src/RCS/cnrd_3.f,v
index 4ef19ba1..e49e1187 100644
--- src/RCS/cnrd_3.f,v
+++ src/RCS/cnrd_3.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.32.05;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.02;	author leith;	state Exp;
 branches;
@@ -85,9 +90,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -103,7 +108,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -176,6 +181,17 @@ C--*********************************************************************
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @GPL_2010
diff --git src/RCS/cnrs_2.f,v src/RCS/cnrs_2.f,v
index c23bd18b..bf0f2fe9 100644
--- src/RCS/cnrs_2.f,v
+++ src/RCS/cnrs_2.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.32.05;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.02;	author leith;	state Exp;
 branches;
@@ -85,9 +90,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -104,7 +109,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -165,6 +170,17 @@ C--*********************************************************************
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d15 1
+a15 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @GPL_2010
diff --git src/RCS/cnrs_3.f,v src/RCS/cnrs_3.f,v
index ab35682c..cdfe1074 100644
--- src/RCS/cnrs_3.f,v
+++ src/RCS/cnrs_3.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.32.05;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.03;	author leith;	state Exp;
 branches;
@@ -85,9 +90,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -103,7 +108,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -176,6 +181,17 @@ c$omp   parallel do private(i,j,k, ix,iy,iz, arg,argy,argz,ctemp)
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @GPL_2010
diff --git src/RCS/cnscan.f,v src/RCS/cnscan.f,v
index 0d1e8156..c904257c 100644
--- src/RCS/cnscan.f,v
+++ src/RCS/cnscan.f,v
@@ -1,4 +1,4 @@
-head	1.14;
+head	1.15;
 access;
 symbols
 	pre_mrcs:1.14
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.15
+date	2025.11.10.22.32.05;	author dean;	state Exp;
+branches;
+next	1.14;
+
 1.14
 date	2018.10.03.14.34.03;	author leith;	state Exp;
 branches;
@@ -100,9 +105,9 @@ desc
 @
 
 
-1.14
+1.15
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -116,7 +121,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -349,6 +354,17 @@ C                 OVERFLOW OF X,Y ARRAYS.
 @
 
 
+1.14
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.13
 log
 @GPL_2010
diff --git src/RCS/cnstuff.f,v src/RCS/cnstuff.f,v
index 464fb6aa..3f7ca501 100644
--- src/RCS/cnstuff.f,v
+++ src/RCS/cnstuff.f,v
@@ -1,4 +1,4 @@
-head	1.20;
+head	1.21;
 access;
 symbols
 	pre_mrcs:1.20
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.21
+date	2025.11.10.22.32.05;	author dean;	state Exp;
+branches;
+next	1.20;
+
 1.20
 date	2018.10.03.14.34.03;	author leith;	state Exp;
 branches;
@@ -130,9 +135,9 @@ desc
 @
 
 
-1.20
+1.21
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -146,7 +151,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -246,6 +251,17 @@ C        STORE THE CONTOUR IN POSTSCRIPT FILE
 @
 
 
+1.20
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.19
 log
 @GPL_2010
diff --git src/RCS/cntrce.f,v src/RCS/cntrce.f,v
index 9f9243d0..61d5e3a0 100644
--- src/RCS/cntrce.f,v
+++ src/RCS/cntrce.f,v
@@ -1,4 +1,4 @@
-head	1.14;
+head	1.15;
 access;
 symbols
 	pre_mrcs:1.14
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.15
+date	2025.11.10.22.32.05;	author dean;	state Exp;
+branches;
+next	1.14;
+
 1.14
 date	2018.10.03.14.34.03;	author leith;	state Exp;
 branches;
@@ -100,9 +105,9 @@ desc
 @
 
 
-1.14
+1.15
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -112,7 +117,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -313,6 +318,17 @@ C ************************** END OF MAIN PIXEL VISITING LOOP **********
 @
 
 
+1.14
+log
+@email_health_dept
+@
+text
+@d8 1
+a8 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.13
 log
 @GPL_2010
diff --git src/RCS/cntrfl.f,v src/RCS/cntrfl.f,v
index af506ced..e9528247 100644
--- src/RCS/cntrfl.f,v
+++ src/RCS/cntrfl.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.32.05;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.03;	author leith;	state Exp;
 branches;
@@ -85,9 +90,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -101,7 +106,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -495,6 +500,17 @@ C       WRITES LAST ROW TO OUTPUT FILE ------------------------------------
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @GPL_2010
diff --git src/RCS/cntur.f,v src/RCS/cntur.f,v
index 4495b0cf..112bc02a 100644
--- src/RCS/cntur.f,v
+++ src/RCS/cntur.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.32.05;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.03;	author leith;	state Exp;
 branches;
@@ -85,9 +90,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -97,7 +102,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -310,6 +315,17 @@ C              CONTOUR LINES FOUND ON LAST LEVEL
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d8 1
+a8 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @GPL_2010
diff --git src/RCS/comp3dmad.f,v src/RCS/comp3dmad.f,v
index 3b1e8d76..3c0191e1 100644
--- src/RCS/comp3dmad.f,v
+++ src/RCS/comp3dmad.f,v
@@ -1,4 +1,4 @@
-head	1.22;
+head	1.23;
 access;
 symbols
 	pre_mrcs:1.22
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.23
+date	2025.11.10.22.32.05;	author dean;	state Exp;
+branches;
+next	1.22;
+
 1.22
 date	2018.10.03.14.34.03;	author leith;	state Exp;
 branches;
@@ -140,9 +145,9 @@ desc
 @
 
 
-1.22
+1.23
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -155,7 +160,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -363,6 +368,17 @@ C     $'    SUM1: ',F16.4,'      SUM2: ',F16.4)
 @
 
 
+1.22
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.21
 log
 @GPL_2010
diff --git src/RCS/conf.f,v src/RCS/conf.f,v
index c6641232..b9def602 100644
--- src/RCS/conf.f,v
+++ src/RCS/conf.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.32.05;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.03;	author leith;	state Exp;
 branches;
@@ -80,9 +85,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -95,7 +100,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -160,6 +165,17 @@ C        COMMON ADUM(80),BUF(1)
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @GPL_2010
diff --git src/RCS/conf1.f,v src/RCS/conf1.f,v
index 3ed499d6..0a7d4863 100644
--- src/RCS/conf1.f,v
+++ src/RCS/conf1.f,v
@@ -1,4 +1,4 @@
-head	1.31;
+head	1.32;
 access;
 symbols
 	pre_mrcs:1.31
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.32
+date	2025.11.10.22.32.06;	author dean;	state Exp;
+branches;
+next	1.31;
+
 1.31
 date	2018.10.03.14.34.03;	author leith;	state Exp;
 branches;
@@ -185,9 +190,9 @@ desc
 @
 
 
-1.31
+1.32
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -206,7 +211,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -491,6 +496,17 @@ C         ERROR PROBABILITY
 @
 
 
+1.31
+log
+@email_health_dept
+@
+text
+@d17 1
+a17 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.30
 log
 @UNDOCUMENTED OP: calling tpaired, hotm & hotelling
diff --git src/RCS/cop.f,v src/RCS/cop.f,v
index 11904023..998719a3 100644
--- src/RCS/cop.f,v
+++ src/RCS/cop.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.32.06;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.03;	author leith;	state Exp;
 branches;
@@ -85,9 +90,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -100,7 +105,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2017  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -138,6 +143,17 @@ c$omp parallel do private(i)
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @out of date note added
diff --git src/RCS/copy1.f,v src/RCS/copy1.f,v
index db8d04d7..820fb70a 100644
--- src/RCS/copy1.f,v
+++ src/RCS/copy1.f,v
@@ -1,4 +1,4 @@
-head	1.74;
+head	1.77;
 access;
 symbols
 	pre_mrcs:1.70
@@ -24,6 +24,21 @@ locks; strict;
 comment	@c @;
 
 
+1.77
+date	2025.11.10.22.33.58;	author dean;	state Exp;
+branches;
+next	1.76;
+
+1.76
+date	2025.09.29.13.26.28;	author dean;	state Exp;
+branches;
+next	1.75;
+
+1.75
+date	2025.09.21.15.24.45;	author dean;	state Exp;
+branches;
+next	1.74;
+
 1.74
 date	2020.01.09.18.07.17;	author leith;	state Exp;
 branches;
@@ -400,9 +415,9 @@ desc
 @
 
 
-1.74
+1.77
 log
-@cpfrommrc
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -425,20 +440,22 @@ C               'CP FROM NIK'                       JAN 05 ArDean Leith
 C               'CP TO PDS' GONE                    MAR 09 ArDean Leith
 C               'CP TO SGI' GONE                    MAY 09 ArDean Leith
 C               'CP TO VV'  GONE                    DEC 10 ArDean Leith
-C               'CCP4' NOW JUST MRC                 FEB 12 ArDean Leith
-C               'CP TO JPG'                         APR 13 ArDean Leith
-C               'CP TO VOL'                         MAY 13 ArDean Leith
-C               'CP FROM TIF'                       MAR 14 ArDean Leith
-C               'CP TO MRC' STACKS                  JUN 15 ArDean Leith
-C               REMOVED XPLO OPS                    JAN 18 ArDean Leith
-C               'CP TO STK' NOT FOR MRC             OCT 19 ArDean Leith
+C               'CCP4' NOW JUST MRC              FEB 2012 ArDean Leith
+C               'CP TO JPG'                      APR 2013 ArDean Leith
+C               'CP TO VOL'                      MAY 2013 ArDean Leith
+C               'CP FROM TIF'                    MAR 2014 ArDean Leith
+C               'CP TO MRC' STACKS               JUN 2015 ArDean Leith
+C               REMOVED XPLO OPS                 JAN 2018 ArDean Leith
+C               'CP TO STK' NOT FOR MRC          OCT 2019 ArDean Leith
+C               NO INITIAL PARAMETER SENT        OCT 2025 ArDean Leith
+C
 C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2019  Health Research Inc.,                         *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -454,25 +471,25 @@ C=* along with this program. If not, see <http://www.gnu.org/licenses> *
 C=*                                                                    *
 C **********************************************************************
 C
-C  COPY1(INT_UNUSED)
+C  COPY1  CALLED FROM UTIL2 FOR 'CP ****'
 C
-C  PARAMETERS:      INT_UNUSED         UNUSED
+C  PARAMETERS:      
 C
 C23456789012345678901234567890123456789012345678901234567890123456789012
 C--*********************************************************************
 
-        SUBROUTINE COPY1(INT_UNUSED)
+        SUBROUTINE COPY1
 
         IMPLICIT NONE
 
         INCLUDE 'CMBLOCK.INC'
         INCLUDE 'CMLIMIT.INC'
 
-        INTEGER               :: INT_UNUSED
         INTEGER               :: ICOMM,MYPID,MPIERR
         INTEGER               :: NILMAX,IRTFLG,NLET,ITYPE,NX,NY,NZ,NE
         INTEGER               :: MAXIM,NDUM,NIMG,IMGNUM,LOCAT,LOCAST
-        LOGICAL               :: VERBOSET       
+        LOGICAL               :: VERBOSET 
+        INTEGER               :: LNBLNKN,LENFCHAR     
 
         CHARACTER(LEN=MAXNAM) :: FILOLD,FILNEW
         INTEGER, ALLOCATABLE  :: ILIST(:)
@@ -482,7 +499,7 @@ C--*********************************************************************
         LOGICAL               :: IS_STACK
         LOGICAL               :: IS_MRC
 
-
+        
         INTEGER,PARAMETER     :: IDELAY  = 3
 
         INTEGER, PARAMETER    :: LUN1    = 14 
@@ -496,9 +513,23 @@ C--*********************************************************************
 C       FROM/'AS','MR','PD','RA','NI','TE','VA','EM','NT','XP'
 C       TO  /'AS','BR','MR','PO','RA','TI','XP','OP','JPG'  
 
+
         CALL SET_MPI(ICOMM,MYPID,MPIERR) ! SETS ICOMM AND MYPID
 
-        IF (FCHAR(4:7) == 'TO O') THEN !----------------- 'CP TO OPEND'
+        LENFCHAR = LNBLNKN(FCHAR)
+
+        !write(6,*)'  In copy1, lenfchar: ',LENFCHAR
+
+ 
+        IF (LENFCHAR .LE. 2) THEN      !----------------- 'CP'
+C          STANDARD COPY (CAN HANDLE MRC INPUT/OUTPUT)
+           INDXD   = .FALSE.
+           FLIPOUT = .FALSE.
+
+           CALL COPYD(LUN1,LUN2,LUNDOC,LUNXM1,LUNXM2,INDXD,FLIPOUT)
+           GOTO 9000
+
+        ELSEIF (FCHAR(4:7) == 'TO O') THEN !------------- 'CP TO OPEND'
 C          STANDARD COPY WITH FLIPPED ENDEDNESS
            INDXD   = .FALSE.
            FLIPOUT = .TRUE.
@@ -511,8 +542,11 @@ C          SPIDER IMAGE(S) FILE INTO VOLUME FILES
            GOTO 9000
 
         ELSEIF (FCHAR(4:8) == 'TO ST') THEN !-------------- 'CP TO STK'
-C          SPIDER STACK(S) INTO A SINGLE STACK  
+C          SPIDER STACK(S) INTO A SINGLE STACK 
+
+           !write(3,*)'  Calling copytostk  ' 
            CALL COPYTOSTK()
+           !write(3,*)'  After   copytostk  ' 
            GOTO 9000
 
         ELSEIF (FCHAR(4:9) == 'TO MRC') THEN !------------- 'CP TO MRC'
@@ -521,36 +555,26 @@ C          COPY SPIDER FILE TO MRC IMAGE/VOLUME
            GOTO 9000
 
         ELSEIF (FCHAR(4:9) == 'FROM M' .OR.
-     &          FCHAR(4:9) == 'FROM C' ) THEN !----------- 'CP FROM MRC'
+     &          FCHAR(4:9) == 'FROM C' ) THEN  !--------- 'CP FROM MRC'
 C          FROM MRC FORMAT TO SPIDER 
            CALL COPYFROMMRC(LUN1,LUN2,LUNDOC,LUNXM1,LUNXM2)
            GOTO 9000
 
-        ENDIF
-
-
-C                                    12345678     1234567890
-        SELECT CASE(FCHAR(4:5))   ! 'CP TO XX' , 'CP FROM XX'
-
-#if defined(SP_IFC) || defined(__INTEL_COMPILER) 
-        CASE ('I')      ! --------------------------------------- 'CP I'
-#else
-#if defined(__GFORTRAN__) 
-        CASE ('I')      ! --------------------------------------- 'CP I'
-#else
-        CASE ('I','I ') ! --------------------------------------- 'CP I'
-#endif
-#endif
+        ELSEIF (FCHAR(4:4) == 'I') THEN        !----------- 'CP I'
 C          STANDARD COPY TO INDEXED STACK
            INDXD   = .TRUE.
            FLIPOUT = .FALSE.
-           CALL COPYD(LUN1,LUN2,LUNDOC,LUNXM1,LUNXM2,INDXD,FLIPOUT)
+           !write(6,*) '  In copy1, calling copyd:',lun1,lun2,flipout
 
-        CASE ('')    ! ------------------------------------------ 'CP'
-C          STANDARD COPY (CAN HANDLE MRC INPUT/OUTPUT)
-           INDXD   = .FALSE.
-           FLIPOUT = .FALSE.
            CALL COPYD(LUN1,LUN2,LUNDOC,LUNXM1,LUNXM2,INDXD,FLIPOUT)
+           GOTO 9000
+
+        ENDIF
+
+
+C                                    12345678     1234567890
+        SELECT CASE(FCHAR(4:5))   ! 'CP TO **' , 'CP FROM **'
+
 
         CASE ('TO')  ! ------------------------------------- 'CP TO **'
 
@@ -561,9 +585,10 @@ C          OPEN INPUT IMAGE(S), (NOT FOURIER)
               CALL ERRT(46,'COPY1; ILIST',NILMAX)
               RETURN
            ENDIF
-
+ 
            ASKNAM = .TRUE.
            FOUROK = .FALSE.
+           IMGNUM = 0         ! needed, sept 2025 
            CALL OPFILES(0,LUN1,LUNDOC,LUNXM1, 
      &                  ASKNAM,FILOLD,NLET, 'O',
      &                  ITYPE,NX,NY,NZ,MAXIM,
@@ -577,6 +602,19 @@ C          OPEN INPUT IMAGE(S), (NOT FOURIER)
            IS_STACK = (MAXIM > 0)                     ! USING A STACK
            BARE     = (LOCAT > 0 .AND. LOCAT == NLET) ! BARESTACK
 
+#if defined (SP_DBUGIO)
+        write(3,*) ' In: copy1 ------------- xxxxxxxxxxxxxxxxxxxxxx'
+        write(3,*) '  filold:   ',filold(1:nlet)
+        write(3,*) '  filold:   ',filold(1:nlet)
+        write(3,*) '  locat :   ',locat
+        write(3,*) '  locast:   ',locast
+        write(3,*) '  nlet:     ',nlet
+        write(3,*) '  is_stack: ',is_stack
+        write(3,*) '  maxim:    ',maxim
+        write(3,*) '  nimg:     ',nimg
+        write(3,*) '  bare:     ',bare
+#endif
+
 
            IF (BARE) THEN
               CALL ERRT(101,
@@ -616,7 +654,8 @@ C             SPIDER IMAGE FILE INTO XPLOR FILES --------- 'CP TO XPLOR'
            CASE ('JP')
 C             SPIDER IMAGE FILE INTO JPG FILES ------------- 'CP TO JPG'
               VERBOSET = VERBOSE  ! FROM CMBLOCK
-              FILNEW   = NULL
+ 
+             FILNEW   = NULL
               CALL COPYTOJPG(LUN1,LUNT,FILNEW,NX,NY,NZ,
      &                       VERBOSET,IDELAY)
 
@@ -642,6 +681,7 @@ C             FROM PDB FILE TO SPIDER VOLUME FILE -------- 'CP FROM PDB'
 
            CASE ('RA')
 C             COPY RAW IMAGE FILE INTO SPIDER IMAGE FILE - 'CP FROM RAW'
+              !write(6,*) '  In copy1, calling rawtospider:',lun1,lun2
               CALL RAWTOSPIDER(LUN1,LUN2,IRTFLG)
 
            CASE ('NI')
@@ -689,12 +729,39 @@ C             NO SUCH COPY FUNCTION
            CALL ERRT(101,'NO SUCH CP OPERATION, CHECK MENU',NE)
 
         END SELECT
+        !write(3,*) '  filold:',filold(1:nlet)
 
 9000    CLOSE(LUN1)
         CLOSE(LUN2)
         IF (ALLOCATED(ILIST)) DEALLOCATE(ILIST)
 
         END
+@
+
+
+1.76
+log
+@cosmetic
+@
+text
+@a58 1
+        !SUBROUTINE COPY1(INT_UNUSED) ! sept 2025
+a65 1
+        !INTEGER               :: INT_UNUSED
+d73 1
+a73 1
+        INTEGER, ALLOCATABLE   :: ILIST(:)
+d80 1
+a80 1
+
+d110 1
+a110 1
+        ELSEIF (FCHAR(4:7) == 'TO O') THEN !--------------- 'CP TO OPEND'
+d136 1
+a136 1
+     &          FCHAR(4:9) == 'FROM C' ) THEN  !----------- 'CP FROM MRC'
+d183 14
+a316 12
 
 #ifdef NEVER
         write(6,*) '  filold:',filold(1:nlet)
@@ -710,6 +777,102 @@ C             NO SUCH COPY FUNCTION
 @
 
 
+1.75
+log
+@IMGNUM = 0         ! needed, sept 2025 
+other changes for gfort compiler
+@
+text
+@d21 9
+a29 7
+C               'CCP4' NOW JUST MRC                 FEB 12 ArDean Leith
+C               'CP TO JPG'                         APR 13 ArDean Leith
+C               'CP TO VOL'                         MAY 13 ArDean Leith
+C               'CP FROM TIF'                       MAR 14 ArDean Leith
+C               'CP TO MRC' STACKS                  JUN 15 ArDean Leith
+C               REMOVED XPLO OPS                    JAN 18 ArDean Leith
+C               'CP TO STK' NOT FOR MRC             OCT 19 ArDean Leith
+d34 1
+a34 1
+C=* Copyright 1985-2019  Health Research Inc.,                         *
+d36 1
+a36 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
+1.74
+log
+@cpfrommrc
+@
+text
+@d50 1
+a50 1
+C  COPY1(INT_UNUSED)
+d52 1
+a52 1
+C  PARAMETERS:      INT_UNUSED         UNUSED
+d57 2
+a58 1
+        SUBROUTINE COPY1(INT_UNUSED)
+d65 1
+a65 1
+        INTEGER               :: INT_UNUSED
+d69 2
+a70 1
+        LOGICAL               :: VERBOSET       
+d73 1
+a73 1
+        INTEGER, ALLOCATABLE  :: ILIST(:)
+d94 1
+d97 14
+a110 1
+        IF (FCHAR(4:7) == 'TO O') THEN !----------------- 'CP TO OPEND'
+d123 3
+a125 1
+C          SPIDER STACK(S) INTO A SINGLE STACK  
+d127 1
+d136 1
+a136 1
+     &          FCHAR(4:9) == 'FROM C' ) THEN !----------- 'CP FROM MRC'
+d141 9
+d154 1
+a154 15
+        SELECT CASE(FCHAR(4:5))   ! 'CP TO XX' , 'CP FROM XX'
+
+#if defined(SP_IFC) || defined(__INTEL_COMPILER) 
+        CASE ('I')      ! --------------------------------------- 'CP I'
+#else
+#if defined(__GFORTRAN__) 
+        CASE ('I')      ! --------------------------------------- 'CP I'
+#else
+        CASE ('I','I ') ! --------------------------------------- 'CP I'
+#endif
+#endif
+C          STANDARD COPY TO INDEXED STACK
+           INDXD   = .TRUE.
+           FLIPOUT = .FALSE.
+           CALL COPYD(LUN1,LUN2,LUNDOC,LUNXM1,LUNXM2,INDXD,FLIPOUT)
+a155 5
+        CASE ('')    ! ------------------------------------------ 'CP'
+C          STANDARD COPY (CAN HANDLE MRC INPUT/OUTPUT)
+           INDXD   = .FALSE.
+           FLIPOUT = .FALSE.
+           CALL COPYD(LUN1,LUN2,LUNDOC,LUNXM1,LUNXM2,INDXD,FLIPOUT)
+d166 1
+a166 1
+
+d169 1
+a182 1
+
+d221 2
+a222 1
+              FILNEW   = NULL
+d248 1
+d296 1
+@
+
+
 1.73
 log
 @comment
diff --git src/RCS/copybrix.f,v src/RCS/copybrix.f,v
index b5f6ca48..2c8b3541 100644
--- src/RCS/copybrix.f,v
+++ src/RCS/copybrix.f,v
@@ -1,4 +1,4 @@
-head	1.28;
+head	1.29;
 access;
 symbols
 	pre_mrcs:1.28
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.29
+date	2025.11.10.22.32.06;	author dean;	state Exp;
+branches;
+next	1.28;
+
 1.28
 date	2018.10.03.14.34.03;	author leith;	state Exp;
 branches;
@@ -170,9 +175,9 @@ desc
 @
 
 
-1.28
+1.29
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -187,7 +192,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -535,6 +540,17 @@ C                    IF EITHER DIRECTION OVER EDGE, PACK RECORD
 @
 
 
+1.28
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.27
 log
 @COMMON /IOBUF
diff --git src/RCS/copyd.f,v src/RCS/copyd.f,v
index ca2eb72a..e16899a2 100644
--- src/RCS/copyd.f,v
+++ src/RCS/copyd.f,v
@@ -1,4 +1,4 @@
-head	1.50;
+head	1.53;
 access;
 symbols
 	pre_mrcs:1.48
@@ -24,6 +24,21 @@ locks; strict;
 comment	@c @;
 
 
+1.53
+date	2025.11.10.22.33.58;	author dean;	state Exp;
+branches;
+next	1.52;
+
+1.52
+date	2025.10.16.19.37.11;	author dean;	state Exp;
+branches;
+next	1.51;
+
+1.51
+date	2025.09.21.15.27.16;	author dean;	state Exp;
+branches;
+next	1.50;
+
 1.50
 date	2019.12.20.15.23.39;	author leith;	state Exp;
 branches;
@@ -286,9 +301,9 @@ desc
 @
 
 
-1.50
+1.53
 log
-@comments
+@*** empty log message ***
 @
 text
 @
@@ -303,14 +318,15 @@ C              OPFILES                        DEC 10    ARDEAN LEITH
 C              INDEXED STACK BUG              JAN 11    ARDEAN LEITH
 C              INDEXED STACK BUG              FEB 11    ARDEAN LEITH
 C              NON SPIDER IMAGE COPY          MAY 14    ARDEAN LEITH
+C              DEBUG OUTPUT ADDED             SEP 20    ArDean Leith
 C
 C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2014  Health Research Inc.,                         *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -347,6 +363,7 @@ C--*********************************************************************
         COMMON /IOERR/  IERR
         COMMON /IOBUF/  BUF(NBUFSIZ)
 
+        common /lunara/ lunara(100),lunstk(100),lunarb(100),lunflip(100)
         INTEGER                  :: LUN1,LUN2,LUNDOC,LUNXM1,LUNXM2
         LOGICAL                  :: INDXD,FLIPOUT
 
@@ -372,9 +389,12 @@ C--*********************************************************************
            RETURN
         ENDIF
 
+        !write(3,*)' In copyd 0: lun1,iflipin: ',lun1,iflipin 
+        !write(3,*)' In copyd 0 calling opfiles: lun1: ',lun1 
+
 C       OPEN FIRST INPUT FILE, DISP = 'E' DOES NOT STOP ON ERROR
         MAXIM1 = 0
-        PROMPT = 'INPUT FILE NAME OR TEMPLATE (E.G. STK@@****)~~9'
+        PROMPT = 'INPUT FILE NAME OR TEMPLATE (E.G. STK@@*)~~9'
         CALL OPFILES(0,LUN1,LUNDOC,LUNXM1,  
      &               .TRUE.,FILNAM1,NLET1, 'E',
      &               IFORM1,NX1,NY1,NZ1,NSTACK1,
@@ -382,19 +402,27 @@ C       OPEN FIRST INPUT FILE, DISP = 'E' DOES NOT STOP ON ERROR
      &              .TRUE., ILIST1,NILMAX, 
      &               NDUM,NGOT1,IMG1, IRTFLG) 
 
+	
+        !write(3,*)' Back in copyd   ------------ 1 ----------' 
+        !write(3,*)' In copyd 1: lun1,iflipin:  ', lun1,iflipin 
+        !write(3,*)' In copyd 1: lunflip(lun1): ', lunflip(lun1) 
+        !write(3,*)' In copyd 1, lun1,flipout:',   lun1,flipout
+        !write(3,*)' In copyd 1: irtflg,filnam1: ',irtflg,filnam1 
+
+
         IF (IRTFLG == 5) THEN
 C          NOT A VALID SPIDER OR MRC INPUT DATA FILE
 
            CALL FILERD(FILNAM2,NLET2,NULL,'OUTPUT FILE NAME',IRTFLG)
            IF (IRTFLG .NE. 0) RETURN 
 
-           !write(6,*) ' Non spider input: ', filnam1(1:nlet1)
-           !write(6,*) ' Non spider output: ',filnam2(1:nlet2)
+           !write(3,*) ' In copyd: Non spider input: ', filnam1(1:nlet1)
+           !write(3,*) ' In copyd: Non spider output: ',filnam2(1:nlet2)
 
            LOCDOT1 = ( INDEX(FILNAM1(1:NLET1),'.',BACK=.TRUE.) )
            LOCDOT2 = ( INDEX(FILNAM2(1:NLET2),'.',BACK=.TRUE.) )
 
-           IF ( LOCDOT2 <= 0 ) THEN
+           IF ( LOCDOT2 <= 0 ) THEN 
 C             APPEND EXTENSION TO FILNAM2
               FILNAM2 = FILNAM2(1:NLET2) // '.' // FILNAM1(LOCDOT1+1:)
               NLET2   = lnblnkn(FILNAM2)
@@ -403,15 +431,20 @@ C             APPEND EXTENSION TO FILNAM2
 C          USE SYSTEM COPY
            COMMAN = 'cp ' // FILNAM1(1:NLET1) //' '// FILNAM2(1:NLET2)
 
-           WRITE(NOUT,'(2X,2A,2X,A)'),
+           WRITE(NOUT,'(2X,2A,2X,A)')
      &           'cp ',FILNAM1(:NLET1),FILNAM2(:NLET2)
            IRET = system(COMMAN)
            GOTO 999
-        ENDIF
+	   
+	ENDIF
+	
+        IF (IRTFLG .NE. 0) GOTO 999
 
-        IF (IRTFLG .NE. 0) RETURN
+        !write(3,'(a,8i5)')' In copyd; nstack1,ngot1,img1:', 
+        !&                             nstack1,ngot1,img1
 
-        !write(6,'(a,8i5)')' In  nstack1,ngot1,img1:',nstack1,ngot1,img1
+C       FIND NATIVE-ENDDEDNESS OF SPIDER INPUT     
+        CALL LUNGETFLIP(LUN1,IFLIPIN,IRTFLG)
 
         NSTACK2 =  1 ! UNUSED
         DISP    = 'U'          
@@ -420,14 +453,38 @@ C          INPUT IS A WHOLE STACK AND WANT INDEXED OUTPUT STACK
            DISP    = 'I'
            NSTACK2 = NSTACK1  ! MAX SIZE
         ENDIF
-
-        IF (FLIPOUT) THEN
-C          STANDARD COPY WITH FLIPPED ENDEDNESS
-           CALL LUNGETFLIP(LUN1,IFLIPIN,IRTFLG)
-           IF (IFLIPIN .NE. 1) IFLIPOUT = 1
-        ENDIF
-        IF (IFLIPOUT == 1) CALL LUNSETFLIP(LUN2,IFLIPOUT,IRTFLG)
-
+	
+        !write(3,*)' In copyd --------------- 0 --------'
+        !write(3,'(A,L5)') ' In copyd 0, flipout:',   flipout
+        !write(3,'(A,4i6)')' In copyd 0: iflipin,: ', iflipin 
+        !write(3,'(A,4i6)')' In copyd 0: lunflip(lun1): ',lunflip(lun1) 
+        !write(3,*)' --------------- END OF 0 --------' 
+
+C       FIND NATIVE-ENDDEDNESS OF INPUT     
+        CALL LUNGETFLIP(LUN1,IFLIPIN,IRTFLG)
+
+C       FIND NATIVE-ENDDEDNESS OF INPUT     
+        IFLIPOUT = 0    ; 
+        IF     (IFLIPIN .EQ. 0 .AND.       FLIPOUT) THEN
+	   IFILPOUT = 1
+        ELSEIF (IFLIPIN .EQ. 0 .AND. .NOT. FLIPOUT) THEN
+           IFLIPOUT = 0
+        ELSEIF (IFLIPIN .EQ. 1 .AND.       FLIPOUT) THEN
+           IFLIPOUT = 0
+        ELSEIF (IFLIPIN .EQ. 1 .AND. .NOT. FLIPOUT) THEN
+           IFLIPOUT = 1
+	ENDIF
+	
+        CALL LUNSETFLIP(LUN2,IFLIPOUT,IRTFLG)
+		
+        !write(3,*)'  '
+        !write(3,*)' In copyd --------------- 0 --------'
+        !write(3,'(A,4i6)')'  In copyd: iflipin,iflipout: ',
+        !&                              iflipin,iflipout 
+        !write(3,'(A,4i6)')'  In copyd: lunflip(lun1),lunflip(lun2): ',
+        !&                              lunflip(lun1),lunflip(lun2) 
+        !write(3,*)' -------------- END OF 0 CALLING OPFILES -------' 
+      	    	
 C	OPEN FIRST OUTPUT FILE
         IMG2 = IMG1
         CALL OPFILES(LUN1,LUN2,LUNDOC,LUNXM2, 
@@ -437,28 +494,36 @@ C	OPEN FIRST OUTPUT FILE
      &             .TRUE., ILIST2,NILMAX, 
      &             NDUM,NGOT2,IMG2, IRTFLG) 
 
-        !write(6,'(A,4i6)')' Out nstack2,ngot2,img2:',nstack2,ngot2,img2
-
-        IFLIPOUT = 0
-        IF (FLIPOUT) THEN
-C          STANDARD COPY WITH FLIPPED ENDEDNESS
-           CALL LUNGETFLIP(LUN1,IFLIPIN,IRTFLG)
-           IF (IFLIPIN .NE. 1) IFLIPOUT = 1
-        ENDIF
-        !write(6,'(A,4i6)')' IFLIPIN, IFLIPOUT:',IFLIPIN, IFLIPOUT 
-
+        !write(3,*)'  '
+        !write(3,*)' In copyd --------------- 1 --------'
+        !write(3,'(A,4i6)')'  In copyd: nstack2,ngot2,img2:',
+        !&                              nstack2,ngot2,img2
+        !write(3,'(A,4i6)')'  In copyd: iflipin,iflipout: ',
+        !&                              iflipin,iflipout 
+        !write(3,'(A,4i6)')'  In copyd: lun1,lun2: ',
+        !&                              lun1,lun2 
+        !write(3,'(A,4i6)')'  In copyd: lunflip(lun1),lunflip(lun2): ',
+        !&                              lunflip(lun1),lunflip(lun2) 
+        !write(3,*)' --------------- END OF 1 --------' 
+    
        IF (IFLIPOUT == 1) THEN
-C          TELL WRITLIN TO FLIP CONTENTS DURING I/O
+C          TELL WRTLIN TO FLIP CONTENTS DURING I/O
            CALL LUNSETFLIP(LUN2,IFLIPOUT,IRTFLG)
+
 C          REPLACE HEADER WITH BYTE-FLIPPED HEADER
-           CALL LUNWRTHED (LUN2,NX1,0,IRTFLG)
+           CALL LUNWRTHED(LUN2,NX1,0,IRTFLG)
         ENDIF
-       !call lungetstat(lun2,imamit,fmint,fmaxt,avt,sigt,irtflg)
-       !write(3,*)' In copyd, stats3:',imamit,fmint,fmaxt,avt,sigt 
+	
+        !write(3,*)'  '
+        !write(3,*)' In copyd --------------- 2 --------'
+        !call lungetstat(lun2,imamit,fmint,fmaxt,avt,sigt,irtflg)
+        !write(3,*)' In copyd, stats3:',imamit,fmint,fmaxt,avt,sigt 
+        !write(3,*)' --------------- END OF 2 --------' 
 
         NINDX1 = 1
         NINDX2 = 1
-        DO                ! LOOP OVER ALL IMAGES/STACKS
+
+        DO       ! LOOP OVER ALL IMAGES/STACKS
 
 C          DO NOT REPORT FILE INFO IF WHOLE STACK (VERBOSE IN COMMON)
 	   IF (NSTACK1 > 0 .AND. NSTACK2 >= 0) VERBOSE = .FALSE. 
@@ -470,19 +535,20 @@ C          COPY THE DESIRED NUMBER OF DATA RECORDS
            ENDDO
 
 C          OPEN NEXT SET OF I/O FILES, UPDATES NINDX1 & NINDX2 
-           !write(3,*)' In copyd, calling nextfiles:',nindx1,nindx2 
+           !write(3,*)' In copyd, Calling nextfiles:',nindx1,nindx2 
+
            CALL NEXTFILES(NINDX1,NINDX2,  ILIST1,ILIST2, 
      &                    .FALSE., LUNXM1,LUNXM2,
      &                    NGOT1,NGOT2,    NSTACK1,NSTACK2,  
      &                    LUN1,LUN1,LUN2, FILNAM1,FILNAM2,
      &                    IMG1,IMG2, IRTFLG)
 
-           !write(3,*) ' In copyd, after nextfiles, irtflg',irtflg
+           !write(3,*) ' In copyd, After nextfiles, irtflg',irtflg
            !if (irtflg .ne. 0) then
-           !write(6,'(A,4i6)') 
-!     &        ' Nextfiles img1,img2,irtflg:',img1,img2,irtflg
-           !write(6,'(A,4i6)') 
-!     &        ' Nextfiles nindx1,nindx2:',nindx1,nindx2
+           !write(3,'(A,4i6)') 
+           !&        ' Nextfiles img1,img2,irtflg:',img1,img2,irtflg
+           !write(3,'(A,4i6)') 
+           !&        ' Nextfiles nindx1,nindx2:',nindx1,nindx2
            !endif
 
            IF (IRTFLG .NE. 0) EXIT      ! ERROR / END OF INPUT STACK
@@ -502,6 +568,137 @@ C          OPEN NEXT SET OF I/O FILES, UPDATES NINDX1 & NINDX2
 @
 
 
+1.52
+log
+@debug output altered
+@
+text
+@d21 1
+a21 1
+C=* Email: spider@@health.ny.gov                                        *
+d89 1
+a89 1
+        PROMPT = 'INPUT FILE NAME OR TEMPLATE (E.G. STK@@****)~~9'
+@
+
+
+1.51
+log
+@flip logic changes needed
+gfort compiler changes needed
+@
+text
+@d13 1
+d135 2
+a136 1
+        !write(3,'(a,8i5)')' In  nstack1,ngot1,img1:',nstack1,ngot1,img1
+d175 3
+a177 3
+        !&                                 iflipin,iflipout 
+        ! write(3,'(A,4i6)')'  In copyd: lunflip(lun1),lunflip(lun2): ',
+        !&                                 lunflip(lun1),lunflip(lun2) 
+d192 1
+a192 1
+        !&                                 nstack2,ngot2,img2
+d194 1
+a194 1
+        !&                                 iflipin,iflipout 
+d196 1
+a196 1
+        !&                                 lun1,lun2 
+d198 1
+a198 1
+        !&                                 lunflip(lun1),lunflip(lun2) 
+d204 1
+d206 1
+a206 1
+           CALL LUNWRTHED (LUN2,NX1,0,IRTFLG)
+d217 2
+a218 1
+        DO                ! LOOP OVER ALL IMAGES/STACKS
+d230 2
+a231 1
+           !write(3,*)' In copyd, calling nextfiles:',nindx1,nindx2 
+d238 1
+a238 1
+           !write(3,*) ' In copyd, after nextfiles, irtflg',irtflg
+d241 1
+a241 1
+           !     &        ' Nextfiles img1,img2,irtflg:',img1,img2,irtflg
+d243 1
+a243 1
+           !     &        ' Nextfiles nindx1,nindx2:',nindx1,nindx2
+@
+
+
+1.50
+log
+@comments
+@
+text
+@d18 1
+a18 1
+C=* Copyright 1985-2014  Health Research Inc.,                         *
+d57 1
+d83 3
+d96 8
+d110 2
+a111 2
+           !write(6,*) ' Non spider input: ', filnam1(1:nlet1)
+           !write(6,*) ' Non spider output: ',filnam2(1:nlet2)
+d116 1
+a116 1
+           IF ( LOCDOT2 <= 0 ) THEN
+d125 1
+a125 1
+           WRITE(NOUT,'(2X,2A,2X,A)'),
+d129 4
+a132 1
+        ENDIF
+d134 1
+a134 1
+        IF (IRTFLG .NE. 0) RETURN
+d136 2
+a137 1
+        !write(6,'(a,8i5)')' In  nstack1,ngot1,img1:',nstack1,ngot1,img1
+d146 32
+a177 8
+
+        IF (FLIPOUT) THEN
+C          STANDARD COPY WITH FLIPPED ENDEDNESS
+           CALL LUNGETFLIP(LUN1,IFLIPIN,IRTFLG)
+           IF (IFLIPIN .NE. 1) IFLIPOUT = 1
+        ENDIF
+        IF (IFLIPOUT == 1) CALL LUNSETFLIP(LUN2,IFLIPOUT,IRTFLG)
+
+d187 12
+a198 10
+        !write(6,'(A,4i6)')' Out nstack2,ngot2,img2:',nstack2,ngot2,img2
+
+        IFLIPOUT = 0
+        IF (FLIPOUT) THEN
+C          STANDARD COPY WITH FLIPPED ENDEDNESS
+           CALL LUNGETFLIP(LUN1,IFLIPIN,IRTFLG)
+           IF (IFLIPIN .NE. 1) IFLIPOUT = 1
+        ENDIF
+        !write(6,'(A,4i6)')' IFLIPIN, IFLIPOUT:',IFLIPIN, IFLIPOUT 
+
+d200 1
+a200 1
+C          TELL WRITLIN TO FLIP CONTENTS DURING I/O
+d205 6
+a210 2
+       !call lungetstat(lun2,imamit,fmint,fmaxt,avt,sigt,irtflg)
+       !write(3,*)' In copyd, stats3:',imamit,fmint,fmaxt,avt,sigt 
+d235 4
+a238 4
+           !write(6,'(A,4i6)') 
+!     &        ' Nextfiles img1,img2,irtflg:',img1,img2,irtflg
+           !write(6,'(A,4i6)') 
+!     &        ' Nextfiles nindx1,nindx2:',nindx1,nindx2
+@
+
+
 1.49
 log
 @debug_msg
diff --git src/RCS/copye.f,v src/RCS/copye.f,v
index e0a59590..61375ece 100644
--- src/RCS/copye.f,v
+++ src/RCS/copye.f,v
@@ -1,4 +1,4 @@
-head	1.14;
+head	1.15;
 access;
 symbols
 	pre_mrcs:1.14
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.15
+date	2025.11.10.22.32.06;	author dean;	state Exp;
+branches;
+next	1.14;
+
 1.14
 date	2018.10.03.14.34.03;	author leith;	state Exp;
 branches;
@@ -100,9 +105,9 @@ desc
 @
 
 
-1.14
+1.15
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -117,7 +122,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -200,6 +205,17 @@ C         SET OUTPUT FORMAT
 @
 
 
+1.14
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.13
 log
 @CHARACTER(LEN=1) :: NULL = CHAR(0)
diff --git src/RCS/copyemi.f,v src/RCS/copyemi.f,v
index 111e5796..4d3ce00b 100644
--- src/RCS/copyemi.f,v
+++ src/RCS/copyemi.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -21,6 +21,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.32.06;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.34.03;	author leith;	state Exp;
 branches;
@@ -66,9 +71,9 @@ desc
 @@
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -83,7 +88,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -314,6 +319,17 @@ C
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @GPL_2010
diff --git src/RCS/copyf.f,v src/RCS/copyf.f,v
index dc0376ac..bc4f9cee 100644
--- src/RCS/copyf.f,v
+++ src/RCS/copyf.f,v
@@ -1,4 +1,4 @@
-head	1.19;
+head	1.20;
 access;
 symbols
 	pre_mrcs:1.19
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.20
+date	2025.11.10.22.32.06;	author dean;	state Exp;
+branches;
+next	1.19;
+
 1.19
 date	2018.10.03.14.34.03;	author leith;	state Exp;
 branches;
@@ -125,9 +130,9 @@ desc
 @
 
 
-1.19
+1.20
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -143,7 +148,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -254,6 +259,17 @@ C          IOSTAT NEEDED FOR PARTIAL LINES
 @
 
 
+1.19
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.18
 log
 @center
diff --git src/RCS/copyfrommrc.f,v src/RCS/copyfrommrc.f,v
index 1db5f1a8..786a89c4 100644
--- src/RCS/copyfrommrc.f,v
+++ src/RCS/copyfrommrc.f,v
@@ -1,4 +1,4 @@
-head	1.48;
+head	1.51;
 access;
 symbols
 	pre_mrcs:1.38
@@ -21,6 +21,21 @@ locks; strict;
 comment	@c @;
 
 
+1.51
+date	2025.11.10.22.33.58;	author dean;	state Exp;
+branches;
+next	1.50;
+
+1.50
+date	2025.10.03.14.34.57;	author dean;	state Exp;
+branches;
+next	1.49;
+
+1.49
+date	2025.09.26.14.34.49;	author dean;	state Exp;
+branches;
+next	1.48;
+
 1.48
 date	2020.01.13.19.18.47;	author leith;	state Exp;
 branches;
@@ -266,39 +281,42 @@ desc
 @@
 
 
-1.48
+1.51
 log
-@cosmetic
+@*** empty log message ***
 @
 text
 @
 C **********************************************************************
 C
-C COPYFROMMRC   MODIFIED FROM COPYMRC             FEB 02 ArDean Leith         
-C               ISSWAB ADDED                      JUL 02 ArDean Leith
-C               FLIP QUESTION                     MAR 03 ArDean Leith
-C               BAD IRECMRC4 & FLIP               SEP 03 ArDean Leith
-C               SCALING                           JAN 05 ArDean Leith
-C               I*8                               SEP 08 ArDean Leith
-C               NPIX8                             DEC 08 ArDean Leith
-C               BOTLEFT OPTION                    MAY 12 ArDean Leith
-C               STREAM IO                         FEB 13 ArDean Leith
-C               VOL BUG                           JUN 13 ArDean Leith
-C               VOL BUG FIXED                     JUL 13 ArDean Leith
-C               MODE 6 STACK SUPPORT              SEP 14 ArDean Leith
-C               IPOSMRC INTEGER *8                JAN 15 ArDean Leith
-C               BOTLEFT DEFAULT                   JUL 15 ArDean Leith
-C               2015 STACK SUPPORT                JUL 15 ArDean Leith
-C               STACK END BUG                     OCT 15 ArDean Leith
-C               'MRCV'                            DEC 15 ArDean Leith
-C               REWRITE FOR NATIVE MRC SUPPORT    JAN 20 ArDean Leith
+C COPYFROMMRC  MODIFIED FROM COPYMRC             FEB 2002 ArDean Leith
+C              ISSWAB ADDED                      JUL 2002 ArDean Leith
+C              FLIP QUESTION                     MAR 2003 ArDean Leith
+C              BAD IRECMRC4 & FLIP               SEP 2003 ArDean Leith
+C              SCALING                           JAN 2005 ArDean Leith
+C              I*8                               SEP 2008 ArDean Leith
+C              NPIX8                             DEC 2008 ArDean Leith
+C              BOTLEFT OPTION                    MAY 2012 ArDean Leith
+C              STREAM IO                         FEB 2013 ArDean Leith
+C              VOL BUG                           JUN 2013 ArDean Leith
+C              VOL BUG FIXED                     JUL 2013 ArDean Leith
+C              MODE 6 STACK SUPPORT              SEP 2014 ArDean Leith
+C              IPOSMRC INTEGER *8                JAN 2015 ArDean Leith
+C              BOTLEFT DEFAULT                   JUL 2015 ArDean Leith
+C              2015 STACK SUPPORT                JUL 2015 ArDean Leith
+C              STACK END BUG                     OCT 2015 ArDean Leith
+C              'MRCV'                            DEC 2015 ArDean Leith
+C              REWRITE FOR NATIVE MRC SUPPORT    JAN 2020 ArDean Leith
+C              DEBUG OUTPUT ADDED                SEP 2025 ArDean Leith
+C              LUNCP=0, NO COPY FROM MRC HEADER  SEP 2025 ArDean Leith
+c
 C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2020 Health Research Inc.,                          *
+C=* Copyright 1985-2025 Health Research Inc.,                          *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -339,6 +357,7 @@ C***********************************************************************
         COMMON /IOBUF/ BUF(NBUFSIZ)
 
         INTEGER                  :: LUN1,LUN2,LUNDOC,LUNXM1,LUNXM2
+        INTEGER                  :: LUNCP  ! sept 2025
 
         LOGICAL                  :: VERBOSE_SAVE,ASKNAM
         LOGICAL                  :: IS_MRC,IS_ACTUALLY_A_VOL,IS_BARE
@@ -369,7 +388,7 @@ C***********************************************************************
 
 C       OPEN FIRST INPUT MRC FILE 
 
-        PROMPT  = 'MRC INPUT FILE OR TEMPLATE (E.G. STK@@****)~~9'
+        PROMPT  = 'MRC INPUT FILE OR TEMPLATE (E.G. *@@STK)~~9'
         CALL FILERD(FILNAM1,NLET1,NULL, PROMPT,IRTFLG)
         IF (IRTFLG .NE. 0) GOTO 999
 
@@ -396,8 +415,8 @@ C       APPEND .mrc IF NEEDED
 C       NSTACK1 RET:  -2   IS NON-STACK IMAGE,  -1 IS STACKED IMG,                  
 C                    >= 0 IS CURRENT MAX. IMG # FOR STACK             
 
-        !write(3,'(a,5i5)')' In copyfrommrc, nstack1,ngot1,img1:',
-        !&                                      nstack1,ngot1,img1
+       !write(6,*)' In copyfrommrc; nstack1,ngot1,img1: ',
+       !&                           nstack1,ngot1,img1
  
 C       BE SURE INPUT IS MRC
         CALL LUNGETIS_MRC(LUN1,IS_MRC,IRTFLG)
@@ -406,13 +425,17 @@ C       BE SURE INPUT IS MRC
            GOTO 999
         ENDIF
 
+        !write(6,*)' In copyfrommrc, is_mrc:',is_mrc
+
+
 C	OPEN FIRST SPIDER OUTPUT FILE
         NSTACK2 =  1   ! PARAMETER NOT USED ON INPUT
         DISP    = 'U'          
         IMG2    = IMG1
+        LUNCP   = 0    ! CAN NOT COPY FROM MRC HEADER
 
         IF (NSTACK1 >= 0) THEN
-           PROMPT = 'SPIDER OUTPUT FILE OR TEMPLATE (E.G. STK@@****)~~9'
+           PROMPT = 'SPIDER OUTPUT FILE OR TEMPLATE (E.G. STK@@*)~~9'
         ELSE
            PROMPT = 'SPIDER OUTPUT FILE~'
         ENDIF
@@ -449,22 +472,23 @@ C           TREAT THIS IMAGE AS A VOLUME NOT A STACK
         ENDIF
 
         ASKNAM = .FALSE.
-        CALL OPFILES(LUN1,LUN2,LUNDOC,LUNXM2, 
+        CALL OPFILES(LUNCP,LUN2,LUNDOC,LUNXM2, 
      &             ASKNAM,FILNAM2,NLET2,DISP,
      &             IFORM1,NX1,NY1,NZ1,NSTACK2,
      &             FILNAM2,
      &             FOUROK, ILIST2,NILMAX, 
      &             NDUM,NGOT2,IMG2, IRTFLG)
  
-C       NSTACK2 RET:  -2   IS NON-STACK IMAGE,  -1 IS STACKED IMG,                  
+C       NSTACK2 RET: -2   IS NON-STACK IMAGE,  
+C                    -1   IS STACKED IMG              
 C                    >= 0 IS CURRENT MAX. IMG # FOR STACK             
 
-        !write(6,'(A,4i6)')' Out nstack2,ngot2,img2:',nstack2,ngot2,img2
+        !write(6,*)'In opfiles; nstack2,ngot2,img2: ',nstack2,ngot2,img2
 
         CALL WHICH_HAND_MRC(LUN1,FILNAM1,CAXIS,IRTFLG)
         IF (IRTFLG .NE. 0) GOTO 999
 
-        !write(3,*) ' Mrc data axis: ',caxis
+        !write(6,*) ' Mrc data axis: ',caxis
 
         IF (NZ1 <= 1) THEN       ! IMAGE(S) INPUT
            CALL RDPRMC(CSTR,NC,.TRUE.,'DATA ORIGIN CORNER (UL/LL)', 
@@ -505,19 +529,20 @@ C          VOLUME OUTPUT
         DO                ! LOOP OVER ALL IMAGES/STACKS
 
 C          DO NOT REPORT FILE INFO IF WHOLE STACK (VERBOSE IN COMMON)
-	   !!!IF (NSTACK1 > 0 .AND. NSTACK2 >= 0) VERBOSE = .FALSE. 
+           !!!IF (NSTACK1 > 0 .AND. NSTACK2 >= 0) VERBOSE = .FALSE. 
 
 C          COPY THE DESIRED NUMBER OF DATA RECORDS (MRC OK)
            DO IREC = 1,NY1 * NZ1
               CALL REDLIN(LUN1,BUF,NX1,IREC)
               CALL WRTLIN(LUN2,BUF,NX1,IREC)
            ENDDO
-           !write(3,*)' in copyfrommrc,ilist.:   ',ilist1(:3),ilist2(:3) 
-           !write(3,*)' in copyfrommrc,filnam1:  ',filnam1(1:20)
-           !write(3,*)' in copyfrommrc,filnam2:  ',filnam2(1:20)
-           !write(3,*)' in copyfrommrc,ngot1..2: ',ngot1,ngot2 
-           !write(3,*)' In copyfrommrc,nindx1..2:',nindx1,nindx2 
-           !write(3,*)' in copyfrommrc,img1..2:  ',img1,img2 
+
+           !write(6,*)' In copyfrommrc; ilist: ',ilist1(:3),ilist2(:3)
+           !write(6,*)' In copyfrommrc; filnam1:  ',filnam1(:20)
+           !write(6,*)' In copyfrommrc; filnam2:  ',filnam2(:20)
+           !write(6,*)' In copyfrommrc; ngot1..2: ',ngot1,ngot2 
+           !write(6,*)' In copyfrommrc; nindx1..2:',nindx1,nindx2 
+           !write(6,*)' in copyfrommrc; img1..2:  ',img1,img2 
 
 C          OPEN NEXT SET OF I/O FILES, UPDATES NINDX1 & NINDX2 
            CALL NEXTFILES(NINDX1,NINDX2,  ILIST1,ILIST2, 
@@ -528,9 +553,9 @@ C          OPEN NEXT SET OF I/O FILES, UPDATES NINDX1 & NINDX2
 
            !if (irtflg .ne. 0) then
            !write(6,'(A,4i6)') 
-!     &        ' Nextfiles img1,img2,irtflg:',img1,img2,irtflg
+           !&        ' Nextfiles; img1,img2,irtflg: ',img1,img2,irtflg
            !write(6,'(A,4i6)') 
-!     &        ' Nextfiles nindx1,nindx2:',nindx1,nindx2
+           !&        ' Nextfiles; nindx1,nindx2: ',nindx1,nindx2
            !endif
 
            IF (IRTFLG .NE. 0) EXIT      ! ERROR / END OF INPUT STACK
@@ -550,6 +575,122 @@ C          OPEN NEXT SET OF I/O FILES, UPDATES NINDX1 & NINDX2
 @
 
 
+1.50
+log
+@LUNCP=0, NO COPY FROM MRC HEADER
+@
+text
+@d24 1
+d103 1
+a103 1
+        PROMPT  = 'MRC INPUT FILE OR TEMPLATE (E.G. STK@@****)~~9'
+d150 1
+a150 1
+           PROMPT = 'SPIDER OUTPUT FILE OR TEMPLATE (E.G. STK@@****)~~9'
+d244 1
+a244 1
+	   !!!IF (NSTACK1 > 0 .AND. NSTACK2 >= 0) VERBOSE = .FALSE. 
+d252 1
+a252 1
+           !write(6,*)' In copyfrommrc; ilist:   ',ilist1(:3),ilist2(:3)
+@
+
+
+1.49
+log
+@DEBUG OUTPUT ADDED
+@
+text
+@d4 20
+a23 19
+C COPYFROMMRC   MODIFIED FROM COPYMRC             FEB 02 ArDean Leith
+C               ISSWAB ADDED                      JUL 02 ArDean Leith
+C               FLIP QUESTION                     MAR 03 ArDean Leith
+C               BAD IRECMRC4 & FLIP               SEP 03 ArDean Leith
+C               SCALING                           JAN 05 ArDean Leith
+C               I*8                               SEP 08 ArDean Leith
+C               NPIX8                             DEC 08 ArDean Leith
+C               BOTLEFT OPTION                    MAY 12 ArDean Leith
+C               STREAM IO                         FEB 13 ArDean Leith
+C               VOL BUG                           JUN 13 ArDean Leith
+C               VOL BUG FIXED                     JUL 13 ArDean Leith
+C               MODE 6 STACK SUPPORT              SEP 14 ArDean Leith
+C               IPOSMRC INTEGER *8                JAN 15 ArDean Leith
+C               BOTLEFT DEFAULT                   JUL 15 ArDean Leith
+C               2015 STACK SUPPORT                JUL 15 ArDean Leith
+C               STACK END BUG                     OCT 15 ArDean Leith
+C               'MRCV'                            DEC 15 ArDean Leith
+C               REWRITE FOR NATIVE MRC SUPPORT    JAN 20 ArDean Leith
+C               DEBUG OUTPUT ADDED                SEP 25 ArDean Leith
+d71 1
+d129 2
+a130 2
+c        write(6,*)' In copyfrommrc; nstack1,ngot1,img1: ',
+c     &                              nstack1,ngot1,img1
+d138 4
+a141 1
+c       write(6,*)' In copyfrommrc, is_mrc:',is_mrc
+d146 1
+d186 1
+a186 1
+        CALL OPFILES(LUN1,LUN2,LUNDOC,LUNXM2, 
+d193 2
+a194 1
+C       NSTACK2 RET:  -2   IS NON-STACK IMAGE,  -1 IS STACKED IMG,                  
+d197 1
+a197 1
+        !write(6,'(A,4i6)')' Out nstack2,ngot2,img2:',nstack2,ngot2,img2
+d267 1
+a267 1
+!     &        ' Nextfiles; img1,img2,irtflg: ',img1,img2,irtflg
+d269 1
+a269 1
+!     &        ' Nextfiles; nindx1,nindx2: ',nindx1,nindx2
+@
+
+
+1.48
+log
+@cosmetic
+@
+text
+@d4 1
+a4 1
+C COPYFROMMRC   MODIFIED FROM COPYMRC             FEB 02 ArDean Leith         
+d22 1
+d27 1
+a27 1
+C=* Copyright 1985-2020 Health Research Inc.,                          *
+d29 1
+a29 1
+C=* Email: spider@@health.ny.gov                                        *
+d127 2
+a128 2
+        !write(3,'(a,5i5)')' In copyfrommrc, nstack1,ngot1,img1:',
+        !&                                      nstack1,ngot1,img1
+d136 1
+a136 1
+
+d195 1
+a195 1
+        !write(3,*) ' Mrc data axis: ',caxis
+d243 7
+a249 6
+           !write(3,*)' in copyfrommrc,ilist.:   ',ilist1(:3),ilist2(:3) 
+           !write(3,*)' in copyfrommrc,filnam1:  ',filnam1(1:20)
+           !write(3,*)' in copyfrommrc,filnam2:  ',filnam2(1:20)
+           !write(3,*)' in copyfrommrc,ngot1..2: ',ngot1,ngot2 
+           !write(3,*)' In copyfrommrc,nindx1..2:',nindx1,nindx2 
+           !write(3,*)' in copyfrommrc,img1..2:  ',img1,img2 
+d260 1
+a260 1
+!     &        ' Nextfiles img1,img2,irtflg:',img1,img2,irtflg
+d262 1
+a262 1
+!     &        ' Nextfiles nindx1,nindx2:',nindx1,nindx2
+@
+
+
 1.47
 log
 @cosmetic
diff --git src/RCS/copyfrommrc_new.f,v src/RCS/copyfrommrc_new.f,v
new file mode 100644
index 00000000..186a7adc
--- /dev/null
+++ src/RCS/copyfrommrc_new.f,v
@@ -0,0 +1,232 @@
+head	1.1;
+access;
+symbols;
+locks; strict;
+comment	@c @;
+
+
+1.1
+date	2025.11.10.22.32.06;	author dean;	state Exp;
+branches;
+next	;
+
+
+desc
+@new under rcs
+@
+
+
+1.1
+log
+@*** empty log message ***
+@
+text
+@
+C++*********************************************************************
+C
+C COPYD.F      CREATED                        23 DEC 87 ARDEAN LEITH
+C              USED GETOLDSTACK, GETNEWSTACK  APRIL 99  ARDEAN LEITH
+C              GETNEWSTACK PARAM.             FEB 03    ARDEAN LEITH
+C              FLIPEND                        FEB 03    ARDEAN LEITH
+C              MPI                            FEB 04    Chao Yang
+C              OPFILES                        DEC 10    ARDEAN LEITH
+C              INDEXED STACK BUG              JAN 11    ARDEAN LEITH
+C              INDEXED STACK BUG              FEB 11    ARDEAN LEITH
+C              NON SPIDER IMAGE COPY          MAY 14    ARDEAN LEITH
+C
+C **********************************************************************
+C=*                                                                    *
+C=* This file is part of:   SPIDER - Modular Image Processing System.  *
+C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
+C=* Copyright 1985-2014  Health Research Inc.,                         *
+C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
+C=* Email: spider@@health.ny.gov                                        *
+C=*                                                                    *
+C=* SPIDER is free software; you can redistribute it and/or            *
+C=* modify it under the terms of the GNU General Public License as     *
+C=* published by the Free Software Foundation; either version 2 of the *
+C=* License, or (at your option) any later version.                    *
+C=*                                                                    *
+C=* SPIDER is distributed in the hope that it will be useful,          *
+C=* but WITHOUT ANY WARRANTY; without even the implied warranty of     *
+C=* merchantability or fitness for a particular purpose.  See the GNU  *
+C=* General Public License for more details.                           *
+C=* You should have received a copy of the GNU General Public License  *
+C=* along with this program. If not, see <http://www.gnu.org/licenses> *
+C=*                                                                    *
+C **********************************************************************
+C
+C  COPYD(LUN1,LUN2,LUNDOC,LUNXM1,LUNXM2,INDXD,FLIPOUT)
+C
+C  PURPOSE:  COPY SPIDER IMAGE/VOL TO ANOTHER FILE INCLUDING MRC FIL
+C 
+C  PARAMETERS: LUN1,LUN2      READ & WRITE UNIT                 (SENT)
+C              LUNDOC         READ & WRITE UNIT                 (SENT)
+C              LUNXM1,LUNXM2  READ & WRITE UNIT                 (SENT)
+C              INDXD          CREATE INDXD STACK                (SENT)
+C              FLIPOUT        CHANGE BYTE ORDER                 (SENT)
+C
+C23456789 123456789 123456789 123456789 123456789 123456789 123456789 12
+C--*********************************************************************
+
+        SUBROUTINE COPYD(LUN1,LUN2,LUNDOC,LUNXM1,LUNXM2,INDXD,FLIPOUT)
+
+        INCLUDE 'CMBLOCK.INC'
+        INCLUDE 'CMLIMIT.INC'
+
+        COMMON /IOERR/  IERR
+        COMMON /IOBUF/  BUF(NBUFSIZ)
+
+        INTEGER                  :: LUN1,LUN2,LUNDOC,LUNXM1,LUNXM2
+        LOGICAL                  :: INDXD,FLIPOUT
+
+        INTEGER                  :: IFLIPOUT
+        CHARACTER (LEN=MAXNAM)   :: PROMPT 
+        CHARACTER (LEN=MAXNAM)   :: FILNAM1,FILNAM2
+        CHARACTER (LEN=2*MAXNAM) :: COMMAN
+        LOGICAL                  :: VERBOSE_SAVE,IFLIP
+        INTEGER,ALLOCATABLE      :: ILIST1(:),ILIST2(:)
+        CHARACTER (LEN=1)        :: NULL = CHAR(0)
+        CHARACTER (LEN=1)        :: DISP
+
+        CALL SET_MPI(ICOMM,MYPID,MPIERR) ! SETS ICOMM AND MYPID
+
+        VERBOSE_SAVE = VERBOSE           ! SAVE CURRENT VERBOSITY
+
+        NILMAX       = NIMAX             ! FROM CMLIMIT
+        ALLOCATE(ILIST1(NIMAX),
+     &           ILIST2(NIMAX),
+     &           STAT=IRTFLG)
+        IF (IRTFLG .NE. 0) THEN
+           CALL ERRT(46,'COPYD; ILIST....',2*NIMAX)
+           RETURN
+        ENDIF
+
+C       OPEN FIRST INPUT FILE, DISP = 'E' DOES NOT STOP ON ERROR
+        MAXIM1 = 0
+        PROMPT = 'INPUT FILE NAME OR TEMPLATE (E.G. STK@@****)~~9'
+        CALL OPFILES(0,LUN1,LUNDOC,LUNXM1,  
+     &               .TRUE.,FILNAM1,NLET1, 'E',
+     &               IFORM1,NX1,NY1,NZ1,NSTACK1,
+     &               PROMPT,
+     &              .TRUE., ILIST1,NILMAX, 
+     &               NDUM,NGOT1,IMG1, IRTFLG) 
+
+        IF (IRTFLG == 5) THEN
+C          NOT A VALID SPIDER OR MRC INPUT DATA FILE
+
+           CALL FILERD(FILNAM2,NLET2,NULL,'OUTPUT FILE NAME',IRTFLG)
+           IF (IRTFLG .NE. 0) RETURN 
+
+           !write(6,*) ' Non spider input: ', filnam1(1:nlet1)
+           !write(6,*) ' Non spider output: ',filnam2(1:nlet2)
+
+           LOCDOT1 = ( INDEX(FILNAM1(1:NLET1),'.',BACK=.TRUE.) )
+           LOCDOT2 = ( INDEX(FILNAM2(1:NLET2),'.',BACK=.TRUE.) )
+
+           IF ( LOCDOT2 <= 0 ) THEN
+C             APPEND EXTENSION TO FILNAM2
+              FILNAM2 = FILNAM2(1:NLET2) // '.' // FILNAM1(LOCDOT1+1:)
+              NLET2   = lnblnkn(FILNAM2)
+           ENDIF
+
+C          USE SYSTEM COPY
+           COMMAN = 'cp ' // FILNAM1(1:NLET1) //' '// FILNAM2(1:NLET2)
+
+           WRITE(NOUT,'(2X,2A,2X,A)'),
+     &           'cp ',FILNAM1(:NLET1),FILNAM2(:NLET2)
+           IRET = system(COMMAN)
+           GOTO 999
+        ENDIF
+
+        IF (IRTFLG .NE. 0) RETURN
+
+        !write(6,'(a,8i5)')' In  nstack1,ngot1,img1:',nstack1,ngot1,img1
+
+        NSTACK2 =  1 ! UNUSED
+        DISP    = 'U'          
+        IF (NSTACK1 .GT. 0 .AND. INDXD) THEN
+C          INPUT IS A WHOLE STACK AND WANT INDEXED OUTPUT STACK
+           DISP    = 'I'
+           NSTACK2 = NSTACK1  ! MAX SIZE
+        ENDIF
+
+        IF (FLIPOUT) THEN
+C          STANDARD COPY WITH FLIPPED ENDEDNESS
+           CALL LUNGETFLIP(LUN1,IFLIPIN,IRTFLG)
+           IF (IFLIPIN .NE. 1) IFLIPOUT = 1
+        ENDIF
+        IF (IFLIPOUT == 1) CALL LUNSETFLIP(LUN2,IFLIPOUT,IRTFLG)
+
+C	OPEN FIRST OUTPUT FILE
+        IMG2 = IMG1
+        CALL OPFILES(LUN1,LUN2,LUNDOC,LUNXM2, 
+     &             .TRUE.,FILNAM2,NLET2,DISP,
+     &             IFORM1,NX1,NY1,NZ1,NSTACK2,
+     &             NULL,
+     &             .TRUE., ILIST2,NILMAX, 
+     &             NDUM,NGOT2,IMG2, IRTFLG) 
+
+        !write(6,'(A,4i6)')' Out nstack2,ngot2,img2:',nstack2,ngot2,img2
+
+        IFLIPOUT = 0
+        IF (FLIPOUT) THEN
+C          STANDARD COPY WITH FLIPPED ENDEDNESS
+           CALL LUNGETFLIP(LUN1,IFLIPIN,IRTFLG)
+           IF (IFLIPIN .NE. 1) IFLIPOUT = 1
+        ENDIF
+        !write(6,'(A,4i6)')' IFLIPIN, IFLIPOUT:',IFLIPIN, IFLIPOUT 
+
+       IF (IFLIPOUT == 1) THEN
+C          TELL WRITLIN TO FLIP CONTENTS DURING I/O
+           CALL LUNSETFLIP(LUN2,IFLIPOUT,IRTFLG)
+C          REPLACE HEADER WITH BYTE-FLIPPED HEADER
+           CALL LUNWRTHED (LUN2,NX1,0,IRTFLG)
+        ENDIF
+       !call lungetstat(lun2,imamit,fmint,fmaxt,avt,sigt,irtflg)
+       !write(3,*)' In copyd, stats3:',imamit,fmint,fmaxt,avt,sigt 
+
+        NINDX1 = 1
+        NINDX2 = 1
+        DO                ! LOOP OVER ALL IMAGES/STACKS
+
+C          DO NOT REPORT FILE INFO IF WHOLE STACK (VERBOSE IN COMMON)
+	   IF (NSTACK1 > 0 .AND. NSTACK2 >= 0) VERBOSE = .FALSE. 
+
+C          COPY THE DESIRED NUMBER OF DATA RECORDS
+           DO IREC = 1,NY1 * NZ1
+              CALL REDLIN(LUN1,BUF,NX1,IREC)
+              CALL WRTLIN(LUN2,BUF,NX1,IREC)
+           ENDDO
+
+C          OPEN NEXT SET OF I/O FILES, UPDATES NINDX1 & NINDX2 
+           !write(3,*)' In copyd, calling nextfiles:',nindx1,nindx2 
+           CALL NEXTFILES(NINDX1,NINDX2,  ILIST1,ILIST2, 
+     &                    .FALSE., LUNXM1,LUNXM2,
+     &                    NGOT1,NGOT2,    NSTACK1,NSTACK2,  
+     &                    LUN1,LUN1,LUN2, FILNAM1,FILNAM2,
+     &                    IMG1,IMG2, IRTFLG)
+
+           !write(3,*) ' In copyd, after nextfiles, irtflg',irtflg
+           !if (irtflg .ne. 0) then
+           !write(6,'(A,4i6)') 
+!     &        ' Nextfiles img1,img2,irtflg:',img1,img2,irtflg
+           !write(6,'(A,4i6)') 
+!     &        ' Nextfiles nindx1,nindx2:',nindx1,nindx2
+           !endif
+
+           IF (IRTFLG .NE. 0) EXIT      ! ERROR / END OF INPUT STACK
+       ENDDO
+
+       IRTFLG = 0
+   
+999    CLOSE(LUN1)
+       CLOSE(LUN2)
+
+       VERBOSE = VERBOSE_SAVE          ! RESTORE VERBOSITY 
+       IF (ALLOCATED(ILIST1)) DEALLOCATE(ILIST1)
+       IF (ALLOCATED(ILIST2)) DEALLOCATE(ILIST2)
+
+       END
+
+@
diff --git src/RCS/copyfromnik.f,v src/RCS/copyfromnik.f,v
index 5d6611b1..d630bce8 100644
--- src/RCS/copyfromnik.f,v
+++ src/RCS/copyfromnik.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -19,6 +19,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.32.18;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.03;	author leith;	state Exp;
 branches;
@@ -74,9 +79,9 @@ desc
 @@
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -91,7 +96,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -321,6 +326,17 @@ C       SWAB=.TRUE.  FOLD=.TRUE. IS BEST
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @GPL_2010
diff --git src/RCS/copyfromtif.f,v src/RCS/copyfromtif.f,v
index 8105fbe6..0c518f8d 100644
--- src/RCS/copyfromtif.f,v
+++ src/RCS/copyfromtif.f,v
@@ -1,4 +1,4 @@
-head	1.7;
+head	1.8;
 access;
 symbols
 	pre_mrcs:1.7
@@ -7,6 +7,11 @@ locks; strict;
 comment	@c @;
 
 
+1.8
+date	2025.11.10.22.32.18;	author dean;	state Exp;
+branches;
+next	1.7;
+
 1.7
 date	2018.10.03.14.34.03;	author leith;	state Exp;
 branches;
@@ -47,9 +52,9 @@ desc
 @@
 
 
-1.7
+1.8
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -62,7 +67,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2015  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -785,6 +790,17 @@ C     ------------------------ FLIP_I4 ---------------------
 @
 
 
+1.7
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.6
 log
 @POSSIBLE CODE SYNTAX FOR ifort INTEL COMPILER
diff --git src/RCS/copymrc.for,v src/RCS/copymrc.for,v
old mode 100755
new mode 100644
diff --git src/RCS/copypos.f,v src/RCS/copypos.f,v
index 9836bf42..22f1bac6 100644
--- src/RCS/copypos.f,v
+++ src/RCS/copypos.f,v
@@ -1,4 +1,4 @@
-head	1.28;
+head	1.29;
 access;
 symbols
 	pre_mrcs:1.28
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.29
+date	2025.11.10.22.32.18;	author dean;	state Exp;
+branches;
+next	1.28;
+
 1.28
 date	2018.10.03.14.34.03;	author leith;	state Exp;
 branches;
@@ -170,9 +175,9 @@ desc
 @
 
 
-1.28
+1.29
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -190,7 +195,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2015  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -474,6 +479,17 @@ C         BVALUE = IVAL   ! Through equivalence
 @
 
 
+1.28
+log
+@email_health_dept
+@
+text
+@d16 1
+a16 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.27
 log
 @max(0.   for ifort
diff --git src/RCS/copyr.f,v src/RCS/copyr.f,v
index 1bef5740..8fd7bf34 100644
--- src/RCS/copyr.f,v
+++ src/RCS/copyr.f,v
@@ -1,4 +1,4 @@
-head	1.15;
+head	1.16;
 access;
 symbols
 	pre_mrcs:1.15
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.16
+date	2025.11.10.22.32.18;	author dean;	state Exp;
+branches;
+next	1.15;
+
 1.15
 date	2018.10.03.14.34.03;	author leith;	state Exp;
 branches;
@@ -105,9 +110,9 @@ desc
 @
 
 
-1.15
+1.16
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -122,7 +127,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -206,6 +211,17 @@ C           WRITE(NOUT,9000)(BUF(K),K=1,NX)
 @
 
 
+1.15
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.14
 log
 @rewrite
diff --git src/RCS/copytojpg.f,v src/RCS/copytojpg.f,v
index ea62f30c..ea881bf1 100644
--- src/RCS/copytojpg.f,v
+++ src/RCS/copytojpg.f,v
@@ -1,4 +1,4 @@
-head	1.12;
+head	1.14;
 access;
 symbols
 	pre_mrcs:1.11
@@ -7,6 +7,16 @@ locks; strict;
 comment	@c @;
 
 
+1.14
+date	2025.10.25.15.10.37;	author dean;	state Exp;
+branches;
+next	1.13;
+
+1.13
+date	2025.09.21.15.16.14;	author dean;	state Exp;
+branches;
+next	1.12;
+
 1.12
 date	2019.12.11.18.34.36;	author leith;	state Exp;
 branches;
@@ -72,9 +82,9 @@ desc
 @@
 
 
-1.12
+1.14
 log
-@LUNFLIPORG_MRC added
+@renamed temp gray file
 @
 text
 @
@@ -84,13 +94,16 @@ C  COPYTOJPG.F  -- NEW                             APR 13 ArDean Leith
 C                  ECHO                            APR 16 ArDean Leith
 C                  WORKS ON VOLUME SLICES NOW      JAN 18 ArDean Leith
 C                  WORKS ON MRC IMAGES NOW         DEC 19 ArDean Leith
+C                  EXTRACTED DISP()                JAN 20 ArDean Leith
+C                  RENAMED GRAY                    OCT 25 ArDean Leith
+C
 C **********************************************************************
 C=* AUTHOR: A. LEITH                                                   *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2019  Health Research Inc.,                         *
+C=* Copyright 1985-2020  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -105,7 +118,6 @@ C=*                                                                    *
 C **********************************************************************
 C
 C   COPYTOJPG(LUNO,FILOLD,LUNT,NX,NY,NZ,VERBOSET,IDELAY))
-C   DISP()
 C
 C   PURPOSE:      CONVERT SPIDER IMAGE FILE TO JPEG FORMAT USING
 C                 IMAGEMAGICK,  CAN ALSO DISPLAY IMAGE
@@ -142,10 +154,13 @@ C--*********************************************************************
         LOGICAL               :: CALLERRT = .TRUE.
         LOGICAL               :: erri2
 
-        CHARACTER(LEN=17)     :: FILTMP = 'JUNK_FOR_JPG.gray' 
+        CHARACTER(LEN=17)     :: FILTMP    = 'jnk_temp_jpg.gray' 
+        CHARACTER(LEN=5)      :: ENDIANMSB = ' msb ' 
+        CHARACTER(LEN=5)      :: ENDIANLSB = ' lsb ' 
+        CHARACTER *5          :: ENDIAN
  
         INTEGER               :: lnblnkn
-
+ 
         ISLICE = 1
         IF (NZ > 1) THEN
 C          THIS IS A VOLUME
@@ -205,22 +220,33 @@ C          GET NAME FOR JPEG FILE
         CALL INTTOCHAR(NX, STRNX, NC2,1)
         CALL INTTOCHAR(NY, STRNY, NC3,1)
 
+        ENDIAN = ENDIANMSB
+        !!!IF (
+        ENDIAN = ENDIANLSB
+
         IF (VERBOSET) THEN
-           WRITE(COMLIN,8005) STRNX(:NC2),STRNY(:NC3),
+           WRITE(COMLIN,8005) STRNX(:NC2),STRNY(:NC3),ENDIAN,
      &                        FILTMP,FILNEW(1:NLETN)
+     
 8005       FORMAT( 
      &     ' convert -verbose -depth 32 -size ',A,'x',A, 
      &     ' -define quantum:format=floating-point ',
-     &     '-define quantum:scale=65536.0 -endian msb ',
-     &     A,' ',A )
+     &     '-define quantum:scale=65536.0 -endian ',A,
+     &     ' ',A,' ',A )
+
+cc 2025   &     '-define quantum:scale=65536.0 -endian msb ',
+
         ELSE
-           WRITE(COMLIN,8006) STRNX(:NC2),STRNY(:NC3),
+           WRITE(COMLIN,8006) STRNX(:NC2),STRNY(:NC3),ENDIAN,
      &                        FILTMP,FILNEW(1:NLETN)
+     
 8006       FORMAT( 
      &     ' convert -depth 32 -size ',A,'x',A, 
      &     ' -define quantum:format=floating-point ',
-     &     '-define quantum:scale=65536.0 -endian msb ',
-     &     A,' ',A, ' >& /dev/null' )
+     &     '-define quantum:scale=65536.0 -endian',A,' ',
+     &     A,' ',A, '  >& /dev/null' )
+
+cc 2025   &     '-define quantum:scale=65536.0 -endian msb ',
 
         ENDIF
 
@@ -237,6 +263,63 @@ C       A DELAY HERE. (KLUDGY)
         END
 
 
+@
+
+
+1.13
+log
+@& on command line bug and other fixes for gfort
+@
+text
+@d9 2
+d17 1
+a17 1
+C=* Email: spider@@health.ny.gov                                        *
+d68 1
+a68 1
+        CHARACTER(LEN=17)     :: FILTMP = 'JUNK_FOR_JPG.gray' 
+d135 1
+a135 1
+	!!!IF (
+d137 1
+a137 1
+	
+@
+
+
+1.12
+log
+@LUNFLIPORG_MRC added
+@
+text
+@d8 1
+d13 1
+a13 1
+C=* Copyright 1985-2019  Health Research Inc.,                         *
+a29 1
+C   DISP()
+d67 3
+d72 1
+a72 1
+
+d132 4
+d137 1
+a137 1
+           WRITE(COMLIN,8005) STRNX(:NC2),STRNY(:NC3),
+d139 1
+d143 5
+a147 2
+     &     '-define quantum:scale=65536.0 -endian msb ',
+     &     A,' ',A )
+d149 1
+a149 1
+           WRITE(COMLIN,8006) STRNX(:NC2),STRNY(:NC3),
+d151 1
+d155 4
+a158 2
+     &     '-define quantum:scale=65536.0 -endian msb ',
+     &     A,' ',A, ' >& /dev/null' )
+a174 64
 C **********************************************************************
 C
 C  DISP
diff --git src/RCS/copytomrc.f,v src/RCS/copytomrc.f,v
index 3ec3a5ec..54e97449 100644
--- src/RCS/copytomrc.f,v
+++ src/RCS/copytomrc.f,v
@@ -1,4 +1,4 @@
-head	1.46;
+head	1.49;
 access;
 symbols
 	pre_mrcs:1.42
@@ -21,6 +21,21 @@ locks; strict;
 comment	@c @;
 
 
+1.49
+date	2025.11.10.22.33.58;	author dean;	state Exp;
+branches;
+next	1.48;
+
+1.48
+date	2025.10.25.15.34.03;	author dean;	state Exp;
+branches;
+next	1.47;
+
+1.47
+date	2025.10.20.13.51.27;	author dean;	state Exp;
+branches;
+next	1.46;
+
 1.46
 date	2020.01.09.17.59.57;	author leith;	state Exp;
 branches;
@@ -256,15 +271,15 @@ desc
 @@
 
 
-1.46
+1.49
 log
-@renamed from copytomrc_new.f
+@*** empty log message ***
 @
 text
 @
 C ++********************************************************************
 C
-C COPYTOMRC    MODIFIED FROM COPYMRC               FEB 02 ArDean Leith         
+C COPYTOMRC    MODIFIED FROM COPYMRC               FEB 02 ArDean Leith  
 C              ISSWAB ADDED                        JUL 02 ArDean Leith
 C              FLIP QUESTION                       MAR 03 ArDean Leith
 C              BAD IRECMRC4 & FLIP                 SEP 03 ArDean Leith
@@ -284,14 +299,15 @@ C              BOTLEFT OPTION REINTRODUCED         SEP 16 ArDean Leith
 C              CREATES LITTLE ENDED FILES ONLY     JAN 18 ArDean Leith
 C              GETLAB PARAMETERS                   NOV 19 ArDean Leith
 C              REWRITE                             DEC 19 ArDean Leith
+C              FIXED STACKS                        OCT 25 ArDean Leith
 C
 C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2019  Health Research Inc.,                         *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -308,7 +324,7 @@ C=*                                                                    *
 C **********************************************************************
 C 
 C COPYTOMRC    (LUNSPI,LUNMRC,NX,NY,NZ)
-C COPYTOMRC_STK(LUNSPI,LUNMRC,NX,NY,NZ) 
+C COPYTOMRC_STK(LUNSPI,LUNMRC,NX,NY,NZ)    !!! NEVER USED
 C                                                                    
 C PURPOSE: COPY FROM SPIDER TO MRC FILE FORMAT
 C
@@ -319,6 +335,48 @@ C               1 : INTEGER*2 (SIGNED)
 C               2 : REALS
 C               6 : INTEGER*2 (UNSIGNED)
 C
+C  CALL TREE:
+C  IF ('CP....')   
+C     |
+C  COPY1
+C     |
+C  IF ('CP TO MRC')    SPIDER FILE(S) TO MRC IMAGE(S) OR VOLUME(S)
+C     |
+C  COPYTOMRC
+C     |
+C     OPEN FIRST SPIDER INPUT FILE
+C     OPFILES(0,LUNSPI,LUNDOC,LUNXM1,  
+C     &       .TRUE.,FILNAM1,NLET1, 'E',
+C     &       IFORM1,NX1,NY1,NZ1,NSTACK1,
+C     &       'SPIDER INPUT FILE NAME OR TEMPLATE (e.g. SPI_STK@@*)~~9'
+C     &       TRUE., ILIST1,NILMAX, 
+C     &       NOT_USED,NGOT1,IMG1, IRTFLG) 
+C     |
+C     FILERD (FILNAM2,NLET2,NULL,  
+C     &       'MRC OUTPUT FILE NAME OR TEMPLATE (e.g. MRC_STK@@*.mrc)~'
+C     &       IRTFLG)
+C     OPEN FIRST MRC OUTPUT FILE 
+C     OPFILES(LUNSPI,LUNMRC,LUNDOC,LUNXM2, 
+C     &       .FALSE.,FILNAM2,NLET2,DISP,
+C     &       IFORM1,NX1,NY1,NZ1,NSTACK2,
+C     &       FILNAM2,
+C     &       .TRUE., ILIST2,NILMAX, 
+C     &       NOT_USED,NGOT2,IMG2, IRTFLG) 
+C       |
+C     LOOP
+C       REDLIN
+C        |
+C       WRTLIN
+C        |
+C       OPEN NEXT SPIDER INPUT & MRC OUTPUT FILES
+C        |
+C       NEXTFILES(NINDX1,NINDX2,  ILIST1,ILIST2,   
+C               .FALSE., LUNXM1,LUNXM2,
+C               NGOT1,NGOT2,    NSTACK1,NSTACK2,  
+C               LUNSPI,LUNSPI,LUNMRC, FILNAM1,FILNAM2,
+C               IMG1,IMG2, IRTFLG)
+C        |
+C     END LOOP
 C23456789012345678901234567890123456789012345678901234567890123456789012
 C***********************************************************************
 
@@ -357,7 +415,7 @@ C***********************************************************************
       CHARACTER (LEN=4)        :: CAXIS,CSTR
       INTEGER                  :: ICOMM,MYPID,MPIERR
       INTEGER                  :: IFORM1,NX1,NY1,NZ1,NSTACK1,NSTACK2
-      INTEGER                  :: NDUM,NGOT1,NGOT2,IMG1,IMG2,NILMAX,IVAL
+      INTEGER                  :: NGOT1,NGOT2,IMG1,IMG2,NILMAX,IVAL
       INTEGER                  :: MAXIM1,MAXIM2,NLET1,NLET2
       INTEGER                  :: LENT,NOT_USED,IRECIN
 
@@ -378,37 +436,35 @@ C***********************************************************************
 
 C     OPEN FIRST INPUT FILE, DISP = 'E' DOES NOT STOP ON ERROR
       MAXIM1 = 0
+      IMG1   = 0
       PROMPT =
-     &     'SPIDER INPUT FILE NAME OR TEMPLATE (e.g. SPI_STK@@**)~~9'
+     &     'SPIDER INPUT FILE NAME OR TEMPLATE (e.g. SPI_STK@@*)~~9'
       CALL OPFILES(0,LUNSPI,LUNDOC,LUNXM1,  
-     &               .TRUE.,FILNAM1,NLET1, 'E',
+     &               .TRUE.,FILNAM1,NLET1, 'O',
      &               IFORM1,NX1,NY1,NZ1,NSTACK1,
      &               PROMPT,
      &              .TRUE., ILIST1,NILMAX, 
-     &               NDUM,NGOT1,IMG1, IRTFLG) 
+     &               NOT_USED,NGOT1,IMG1, IRTFLG) 
+
 
+#if defined(SP_DBUGIO)
+      write(3,*)' ------- RETURNED TO: COPYTOMRC --------'
+      write(3,*)' In copytomrc; nx1,ny1,nz1: ',nx1,ny1,nz1
+      write(3,*)' '
+
+#endif
 
       CALL LUNGETIS_MRC(LUNSPI,IS_MRC,IRTFLG)      
       CALL LUNGETISBARE(LUNSPI,IS_BARE,IRTFLG)
 
       IF (IS_MRC) THEN
-         CALL ERRT(101,'OPERATION DOES NOT READ MRC FILES',NDUM)
+         CALL ERRT(101,'OPERATION DOES NOT READ MRC FILES',IDUM)
          GOTO 999
       ENDIF
 
-      !write(3,'(A,4i6)')' In nstack1,ngot1,img1:',nstack1,ngot1,img1
-
-      CALL FILERD(FILNAM2,NLET2,NULL,
-     &       'MRC OUTPUT FILE NAME OR TEMPLATE (e.g. **@@MRC_STK.mrc)~',
-     &       IRTFLG)
-      IF (IRTFLG .NE. 0) GOTO 999
-
-      IF (INDEX(FILNAM2,'.mrc') <= 0 .AND.
-     &    INDEX(FILNAM2,'.MRC') <= 0) THEN
-         CALL ERRT(101,
-     &     'OUTPUT FILE NAME MUST HAVE MRC/mrc EXTENSION',NDUM)
-         GOTO 999
-      ENDIF
+#if defined(SP_DBUGIO)
+      !write(3,'(A,4i6)')' In nstack1; ngot1,img1:',nstack1,ngot1,img1
+#endif
 
 
 C     FIND HEADER VALUES FOR THE MRC FILE
@@ -427,15 +483,13 @@ C     LEGACY INPUT TRAP
       IF (MRCMODE == 16) MRCMODE = 6   ! 16 BIT UNSIGNED INT
       IF (MRCMODE == 32) MRCMODE = 2   ! 32 BIT FLOATING POINT
 
-      WRITE(NOUT,*) ' ' 
-      WRITE(NOUT,*) ' MRC DATA ORIGIN     UL: UPPER LEFT, ',
+       WRITE(NOUT,*) ' MRC DATA ORIGIN     UL: UPPER LEFT, ',
      &              ' LL: LOWER LEFT  '
       IF (NZ1 > 1) THEN
-         WRITE(NOUT,*) ' MRC HANDEDNESS  L: LEFT, ',
-     &                 '        R:  RIGHT '
+         WRITE(NOUT,*) ' MRC HANDEDNESS  L: LEFT, ','        R:  RIGHT '
       ENDIF
 
-      CAXIS(1:2) = 'UL'        ! DEFAULT
+      CAXIS = 'UL  '        ! DEFAULT
 
       IF (NZ1 <= 1) THEN
          CALL RDPRMC(CSTR,NC,.TRUE.,'MRC DATA ORIGIN (UL/LL)',
@@ -494,7 +548,7 @@ C        NEED FMIN & FMAX (SIG IN COMMON: MASTER)
          FMAXT = FMAX
          FAVT  = AV
          FSIGT = SIG
-C     UNFININISHED HERE !!!!!!!!!!!!!!!!!!!
+C        UNFININISHED HERE !!!!!!!!!!!!!!!!!!!
 
       ELSEIF (MRCMODE == 0  .AND. MAXIM1 < 0 ) THEN
 C        8 BIT SIGNED INTEGER IMAGE OR VOLUME (NOT WHOLE STACK)
@@ -537,6 +591,7 @@ C        NEED FMIN & FMAX (SIG IN COMMON: MASTER)
             I4VAL = FMIN
             CALL ERRT(102,'POSSIBLE 16 BIT INTEGER UNDERFLOW',I4VAL)
             GOTO 999
+
          ELSEIF (FMAX > HUGE(I2VAL)) THEN 
             I4VAL = FMAX
             CALL ERRT(102,'POSSIBLE 16 BIT INTEGER OVERFLOW',I4VAL)
@@ -570,58 +625,69 @@ C          NOTHING IN SPIDER HEADER?
       ENDIF
       IF (IRTFLG .NE. 0) RETURN
 
-      NSTACK2 =  1   ! UNUSED
-      DISP    = 'U'  ! NEW OUTPUT FILE        
+      WRITE(NOUT,*) ' ' 
+      NSTACK2 =  1   ! UNUSED, NOT SENT
+      DISP    = 'N'  ! NEW OUTPUT FILE        
 
 C     OPEN FIRST OUTPUT FILE 
-      IMG2 = IMG1
+      IMG2   = IMG1         ! DEFAULT
+      PROMPT =
+     &    'MRC OUTPUT FILE NAME OR TEMPLATE (e.g. *@@file_stk.mrc)~'
+
       CALL OPFILES(LUNSPI,LUNMRC,LUNDOC,LUNXM2, 
-     &              .FALSE.,FILNAM2,NLET2,DISP,
+     &              .TRUE.,FILNAM2,NLET2,DISP,
      &              IFORM1,NX1,NY1,NZ1,NSTACK2,
-     &              FILNAM2,
-     &              .TRUE., ILIST2,NILMAX, 
-     &              NDUM,NGOT2,IMG2, IRTFLG) 
-
-      !write(3,'(A,4i6)')' In copytomrc nstack2,ngot2:',nstack2,ngot2
-      !write(3,'(A,i6,A)')' In copytomrc img2:',img2
-      !write(3,*)         ' In copytomrc caxis:',caxis
+     &              PROMPT,
+     &              .FALSE., ILIST2,NILMAX, 
+     &              NOT_USED,NGOT2,IMG2, IRTFLG) 
+
+#if defined (SP_DBUGIO)
+      write(3,*)' In copytomrc; nx1,ny1,nz1:    ', nx1,ny1,nz1
+      write(3,*)' In copytomrc; nstack2,nilmax: ', nstack2,nilmax
+      write(3,*)' In copytomrc; ngot2,img2:     ', ngot2,img2
+      write(3,*)' '
+#endif
 
       CALL LUNSETMODE_MRC(LUNMRC,MRCMODE,IRTFLG)
+
       CALL LUNSETHAND_MRC(LUNMRC,CAXIS,IRTFLG)
+
       CALL LUNSETPIXSIZES_MRC(LUNMRC,SCALEX,SCALEY,SCALEZ,IRTFLG)
+
       CALL LUNWRTHED_MRC(LUNMRC,IRTFLG)
 
-C     SETS LUNMRCNBYT(LUN) = NBYT
       CALL LUNSETPOS_MRC(LUNMRC,IMG1,IRTFLG)
 
+C     SETS LUNMRCNBYT(LUN) = NBYT    ! COMMENTED OUT??
+
 C     DO NOT REPORT FILE INFO IF WHOLE STACK
       IF (NSTACK1 > 0 .AND. NSTACK2 >= 0) VERBOSE = .FALSE. 
 
       NINDX1 = 1
       NINDX2 = 1
-      DO                ! LOOP OVER ALL IMAGES/STACKS
+      DO                ! LOOP OVER ALL IMAGES or IMAGE STACKS
 
 C        COPY THE DESIRED NUMBER OF DATA RECORDS FROM EACH FILE
-         DO IRECIN = 1,NY1*NZ1
+         DO IRECIN = 1,NY1*NZ1   ! NUMBER OF RECORDS COPIED
 
-C           READ EACH ROW OF SPIDER INPUT FILE 
+C           READ EACH ROW OF SPIDER INPUT FILE  (READS INPUT DATA)
             CALL REDLIN(LUNSPI,BUF,NX1,IRECIN)
 
 C           WRITE EACH ROW OF SPIDER INPUT FILE 
             IF (MRCMODE == 2) THEN
-C              32 BIT FLOATING POINT  
+C              32 BIT FLOATING POINT            (WRITES OUTPUT DATA)
                CALL WRTLIN_MRC(LUNMRC,BUF,NX1,IRECIN,MYPID,IERR)
 
             ELSEIF (MRCMODE == 0 ) THEN
-C              8 BIT SIGNED INTEGER
+C              8 BIT SIGNED INTEGER            (WRITES OUTPUT DATA)
                CALL WRTLIN_MRC(LUNMRC,BUF,NX1,IRECIN,MYPID,IERR)
  
             ELSEIF (MRCMODE == 1) THEN
-C              16 BIT SIGNED INTEGER
+C              16 BIT SIGNED INTEGER            (WRITES OUTPUT DATA)
                CALL WRTLIN_MRC(LUNMRC,BUF,NX1,IRECIN,MYPID,IERR)
  
             ELSEIF (MRCMODE == 6) THEN
-C              16 BIT UNSIGNED INTEGER
+C              16 BIT UNSIGNED INTEGER            (WRITES OUTPUT DATA)
                CALL WRTLIN_MRC(LUNMRC,BUF,NX1,IRECIN,MYPID,IERR)
  
             ENDIF
@@ -638,14 +704,27 @@ C              16 BIT UNSIGNED INTEGER
          ENDDO     ! END OF: DO IRECIN = 1,NY*NZ
 
 
-C        OPEN NEXT SET OF I/O FILES, UPDATES NINDX1 & NINDX2 
-         !write(3,*)' In copytomrc, calling nextfiles:',nindx1,nindx2 
+C        OPEN NEXT SET OF I/O FILES, UPDATES NINDX1 & NINDX2
 
+#if defined (SP_DBUGIO)
+         write(3,*)' In copytomrc; calling nextfiles:',nindx1,nindx2
+         write(3,*) ' ==================  next set ===================='
+#endif
+                    
          CALL NEXTFILES(NINDX1,NINDX2,  ILIST1,ILIST2, 
      &                  .FALSE., LUNXM1,LUNXM2,
      &                  NGOT1,NGOT2,    NSTACK1,NSTACK2,  
      &                  LUNSPI,LUNSPI,LUNMRC, FILNAM1,FILNAM2,
      &                  IMG1,IMG2, IRTFLG)
+
+#if defined (SP_DBUGIO)
+         write(3,*)' After nextfiles; ngot1,nstack1,img1: ',
+     &                                ngot1,nstack1,img1
+         write(3,*)' After nextfiles; ngot2,nstack2,img2: ',
+     &                                ngot2,nstack2,img2
+         write(3,*)' After nextfiles; irtflg:             ', irtflg
+#endif
+
          IF (IRTFLG .NE. 0) EXIT      ! ERROR / END OF INPUT STACK
       ENDDO
 
@@ -660,6 +739,91 @@ C        OPEN NEXT SET OF I/O FILES, UPDATES NINDX1 & NINDX2
 
       END
 
+@
+
+
+1.48
+log
+@fixed some stk bugs
+defined(SP_DBUGIO)
+@
+text
+@d49 1
+a49 1
+C COPYTOMRC_STK(LUNSPI,LUNMRC,NX,NY,NZ) 
+d73 1
+a73 1
+C     &       'SPIDER INPUT FILE NAME OR TEMPLATE (e.g. SPI_STK@@**)~~9'
+d78 1
+a78 1
+C     &       'MRC OUTPUT FILE NAME OR TEMPLATE (e.g. MRC_STK.mrc@@***)~'
+d161 1
+d163 1
+a163 1
+     &     'SPIDER INPUT FILE NAME OR TEMPLATE (e.g. SPI_STK@@**)~~9'
+d173 4
+a176 1
+      !write(3,*)' ------- RETURNED TO: COPYTOMRC --------'
+d214 1
+a214 1
+      CAXIS(1:2) = 'UL'        ! DEFAULT
+d351 1
+a351 1
+      NSTACK2 =  1   ! UNUSED
+d355 1
+a355 1
+      IMG2   = IMG1
+d357 1
+a357 1
+     &    'MRC OUTPUT FILE NAME OR TEMPLATE (e.g.MRC_STK@@***.mrc)~'
+d367 1
+d369 2
+a370 1
+      write(3,*)' In copytomrc; ngot2,img2: ',     ngot2,img2
+d374 1
+d376 1
+d378 1
+a380 1
+C     SETS LUNMRCNBYT(LUN) = NBYT
+d383 2
+d390 1
+a390 1
+      DO                ! LOOP OVER ALL IMAGES/STACKS
+d393 1
+a393 1
+         DO IRECIN = 1,NY1*NZ1
+d395 1
+a395 1
+C           READ EACH ROW OF SPIDER INPUT FILE 
+d400 1
+a400 1
+C              32 BIT FLOATING POINT  
+d404 1
+a404 1
+C              8 BIT SIGNED INTEGER
+d408 1
+a408 1
+C              16 BIT SIGNED INTEGER
+d412 1
+a412 1
+C              16 BIT UNSIGNED INTEGER
+d429 2
+a430 1
+C        OPEN NEXT SET OF I/O FILES, UPDATES NINDX1 & NINDX2 
+d432 2
+a433 1
+         write(3,*)' In copytomrc; calling nextfiles:',nindx1,nindx2 
+d435 1
+a435 1
+
+d443 5
+a447 4
+         write(3,'(a,5i5)')'  After nextfiles; ngot1,nstack1,img1: ',
+     &                                         ngot1,nstack1,img1
+         write(3,'(a,5i5)')'  After nextfiles; ngot2,nstack2,img2: ',
+     &                                         ngot2,nstack2,img2
+a462 234
+
 
 
 
@@ -849,7 +1013,7 @@ C          SET STARTING POSITION FOR MRC DATA
            IPOSMRC = IPOSMRC * 4
            IPOSMRC = IOFFSET + IPOSMRC + 1
 
-c          write(6,'(2x,A,3i6,i12)') '  nindx,ilist,imgnumout,iposmrc:',
+c        write(6,'(2x,A,3i6,i12)') '  nindx,ilist,imgnumout,iposmrc:',
 c     &                          nindx,ilist(nindx),imgnumout,iposmrc
 
            DO IRECIN = 1,NY*NZ
@@ -893,7 +1057,110 @@ C          OPEN NEXT SPIDER INPUT FILE, UPDATES NINDX
         CLOSE(LUNMRC)
 
         END
+@
+
+
+1.47
+log
+@cosmetic
+@
+text
+@d24 1
+d60 42
+d140 1
+a140 1
+      INTEGER                  :: NDUM,NGOT1,NGOT2,IMG1,IMG2,NILMAX,IVAL
+d164 1
+a164 1
+     &               .TRUE.,FILNAM1,NLET1, 'E',
+d168 1
+a168 1
+     &               NDUM,NGOT1,IMG1, IRTFLG) 
+d171 4
+d179 1
+a179 1
+         CALL ERRT(101,'OPERATION DOES NOT READ MRC FILES',NDUM)
+d183 3
+a185 16
+      !write(3,'(A,4i6)')' In nstack1,ngot1,img1:',nstack1,ngot1,img1
+
+C     PROMPT: ~ IN LAST CHAR MEANS SKIP ADDING "FILE" AT END OF PROMPT
+
+
+      CALL FILERD(FILNAM2,NLET2,NULL,
+     &       'MRC OUTPUT FILE NAME OR TEMPLATE (e.g. MRC_STK.mrc@@***)~',
+     &       IRTFLG)
+      IF (IRTFLG .NE. 0) GOTO 999
+
+      IF (INDEX(FILNAM2,'.mrc') <= 0 .AND.
+     &    INDEX(FILNAM2,'.MRC') <= 0) THEN
+         CALL ERRT(101,
+     &     'OUTPUT FILE NAME MUST HAVE MRC/mrc EXTENSION',NDUM)
+         GOTO 999
+      ENDIF
+d204 1
+a204 2
+      WRITE(NOUT,*) ' ' 
+      WRITE(NOUT,*) ' MRC DATA ORIGIN     UL: UPPER LEFT, ',
+d269 1
+a269 1
+C     UNFININISHED HERE !!!!!!!!!!!!!!!!!!!
+d312 1
+d346 1
+d348 1
+a348 1
+      DISP    = 'U'  ! NEW OUTPUT FILE        
+d351 4
+a354 1
+      IMG2 = IMG1
+d356 1
+a356 1
+     &              .FALSE.,FILNAM2,NLET2,DISP,
+d358 8
+a365 10
+     &              FILNAM2,
+     &              .TRUE., ILIST2,NILMAX, 
+     &              NDUM,NGOT2,IMG2, IRTFLG) 
+
+
+
+
+      !write(3,'(A,4i6)')' In copytomrc nstack2,ngot2:',nstack2,ngot2
+      !write(3,'(A,i6,A)')' In copytomrc img2:',img2
+      !write(3,*)         ' In copytomrc caxis:',caxis
+d420 3
+a422 1
+         !write(3,*)' In copytomrc, calling nextfiles:',nindx1,nindx2 
+d429 8
+d640 1
+a640 1
+c          write(6,'(2x,A,3i6,i12)') '  nindx,ilist,imgnumout,iposmrc:',
+@
+
 
+1.46
+log
+@renamed from copytomrc_new.f
+@
+text
+@d4 1
+a4 1
+C COPYTOMRC    MODIFIED FROM COPYMRC               FEB 02 ArDean Leith         
+d29 1
+a29 1
+C=* Copyright 1985-2019  Health Research Inc.,                         *
+d31 1
+a31 1
+C=* Email: spider@@health.ny.gov                                        *
+d138 3
+d142 1
+a142 1
+     &       'MRC OUTPUT FILE NAME OR TEMPLATE (e.g. **@@MRC_STK.mrc)~',
+d174 1
+a174 2
+         WRITE(NOUT,*) ' MRC HANDEDNESS  L: LEFT, ',
+     &                 '        R:  RIGHT '
+d323 3
 @
 
 
diff --git src/RCS/copytostk.f,v src/RCS/copytostk.f,v
index 9349af8a..652cac86 100644
--- src/RCS/copytostk.f,v
+++ src/RCS/copytostk.f,v
@@ -1,4 +1,4 @@
-head	1.6;
+head	1.7;
 access;
 symbols
 	pre_mrcs:1.4
@@ -7,6 +7,11 @@ locks; strict;
 comment	@c @;
 
 
+1.7
+date	2025.09.21.15.22.29;	author dean;	state Exp;
+branches;
+next	1.6;
+
 1.6
 date	2020.02.24.16.59.49;	author leith;	state Exp;
 branches;
@@ -43,9 +48,10 @@ desc
 @
 
 
-1.6
+1.7
 log
-@removed stack operation
+@write(3  msgs added 
+possible lungethedoff changes??
 @
 text
 @C **********************************************************************
@@ -151,7 +157,8 @@ C       OPEN FIRST INPUT STACK TO GET SIZING NEEDED FOR OUTPUT FILE
         CLOSE(LUN1)
 
         nlet1 = nlet + 1
-        !write(6,*)'  opened filolds:',nlet1,filolds(1:nlet1)
+        !write(6,*)'  Opened first in:',nlet1,filolds(1:nlet1)
+       write(3,*)'  Opened first input stack:',filolds
 
         IMG2GO = 1
         CALL RDPRI1S(IMG2GO,NOT_USED,
@@ -174,9 +181,6 @@ C	OPEN OUTPUT STACK
            GOTO 9999
         ENDIF
 
-
-        !write(6,*)'  Opened filnew:',nlet2,filnew(1:nlet2)
-
         IMG2 = IMG2GO   ! STARTING OUTPUT IMAGE NUMBER
 
 C       LOOP OVER ALL INPUT STACKS (1...NSTKS)
@@ -193,8 +197,8 @@ C          OPEN BARE INPUT STACK
            CALL OPFILEC(0,ASKNAM,FILOLDS,LUN1,'O',LTYPE,
      &                  LX,LY,LZ,NSTACK1,' ',FOUROK,IRTFLG)
            
-c          write(3,*)'  Opened bare input stack:',filolds(1:nlet+5), 
-c     &                  ' nstack1:',nstack1,irtflg
+           !write(3,*)'  Opened bare input stack:',nstack1,filolds                  
+
            IF (IRTFLG .NE. 0) RETURN
 
 C          MUST CONTAIN  SAME SIZE AND TYPE OF IMAGES/VOLUMES
@@ -210,10 +214,14 @@ C             OPEN NEXT IMAGE IN INPUT STACK
               NSTACK1_1 = 0            ! STACKED IMAGE
               CALL INTTOCHAR(IMG1,CNUM,NLETC,1)
               FILOLDS = FILOLD(1:NLET) // '@@' // CNUM(1:NLETC)
+
+              !write(3,*)'  ========== Opening stacked input:',lun1,filolds 
+
               CALL OPFILEC(0,ASKNAM,FILOLDS,LUN1,'O',LTYPE,
      &                  LX,LY,LZ,NSTACK1_1,' ',FOUROK,IRTFLG)
-c             write(3,*)'  Opened stacked input :',filolds(1:nlet+5), 
-c&                  ' nstack1_1:',nstack1_1,irtflg
+
+              !write(3,*)'  Opened stacked input:',nstack1_1,filolds 
+
               IF (IRTFLG .NE. 0) RETURN
 
 C             GET OVERALL HEADER FROM THE NEW STACK FILE
@@ -239,9 +247,9 @@ C             PUT IMAGE INUSE IN THIS IMAGE'S HEADER OBJECT
 C             PUSH HEADER OBJECT INFO INTO NEW STACKED FILE
               CALL LUNWRTHED(LUN2,NX,IMG2,IRTFLG)
 
-c             write(3,*)'  In copytostk 2, img2,irtflg:',img2,irtflg,ny
-c             call lungethedoff(lun2,nx,img2, lunaraoff,lunstkoff,irtflg)
-c             write(3,*)'  In copytostk 3 --:',img2,lunaraoff,lunstkoff
+              !write(3,*)'  In copytostk 2, img2,irtflg:',img2,irtflg,ny
+              !call lungethedoff(lun2,nx,img2, lunaraoff,lunstkoff,irtflg)
+              !write(3,*)'  In copytostk 3 --:',img2,lunaraoff,lunstkoff
 
 C             COPY THE DATA RECORDS
               DO IREC = 1,NY * NZ
@@ -291,6 +299,35 @@ C       OPEN FIRST INPUT FILE, DISP = 'E' DOES NOT STOP ON ERROR
 @
 
 
+1.6
+log
+@removed stack operation
+@
+text
+@d104 2
+a105 1
+        !write(6,*)'  opened filolds:',nlet1,filolds(1:nlet1)
+a127 3
+
+        !write(6,*)'  Opened filnew:',nlet2,filnew(1:nlet2)
+
+d144 2
+a145 2
+c          write(3,*)'  Opened bare input stack:',filolds(1:nlet+5), 
+c     &                  ' nstack1:',nstack1,irtflg
+d161 3
+d166 3
+a168 2
+c             write(3,*)'  Opened stacked input :',filolds(1:nlet+5), 
+c&                  ' nstack1_1:',nstack1_1,irtflg
+d194 3
+a196 3
+c             write(3,*)'  In copytostk 2, img2,irtflg:',img2,irtflg,ny
+c             call lungethedoff(lun2,nx,img2, lunaraoff,lunstkoff,irtflg)
+c             write(3,*)'  In copytostk 3 --:',img2,lunaraoff,lunstkoff
+@
+
+
 1.5
 log
 @mrc_support
diff --git src/RCS/copytovol.f,v src/RCS/copytovol.f,v
index 7b6ea7b5..86e7a7fd 100644
--- src/RCS/copytovol.f,v
+++ src/RCS/copytovol.f,v
@@ -1,4 +1,4 @@
-head	1.6;
+head	1.7;
 access;
 symbols
 	pre_mrcs:1.6
@@ -7,6 +7,11 @@ locks; strict;
 comment	@c @;
 
 
+1.7
+date	2025.11.10.22.32.18;	author dean;	state Exp;
+branches;
+next	1.6;
+
 1.6
 date	2018.10.03.14.34.03;	author leith;	state Exp;
 branches;
@@ -42,9 +47,9 @@ desc
 @@
 
 
-1.6
+1.7
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -60,7 +65,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2016  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -285,6 +290,17 @@ C        FILLING AN EMPTY VOLUME
 
 
 
+@
+
+
+1.6
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
 @
 
 
diff --git src/RCS/copyu.f,v src/RCS/copyu.f,v
index 5922865d..60bc5675 100644
--- src/RCS/copyu.f,v
+++ src/RCS/copyu.f,v
@@ -1,4 +1,4 @@
-head	1.27;
+head	1.28;
 access;
 symbols
 	pre_mrcs:1.27
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.28
+date	2025.11.10.22.32.18;	author dean;	state Exp;
+branches;
+next	1.27;
+
 1.27
 date	2018.10.03.14.34.03;	author leith;	state Exp;
 branches;
@@ -165,9 +170,9 @@ desc
 @
 
 
-1.27
+1.28
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -184,7 +189,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -266,6 +271,17 @@ C       CLOSE INPUT AND OUTPUT FILES
 @
 
 
+1.27
+log
+@email_health_dept
+@
+text
+@d15 1
+a15 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.26
 log
 @GPL_2010
diff --git src/RCS/corel.f,v src/RCS/corel.f,v
index defc2674..5b90c155 100644
--- src/RCS/corel.f,v
+++ src/RCS/corel.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.32.18;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.03;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -91,7 +96,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -145,6 +150,17 @@ C***********************************************************************
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/corr1.f,v src/RCS/corr1.f,v
index 8d82598b..f08a17ea 100644
--- src/RCS/corr1.f,v
+++ src/RCS/corr1.f,v
@@ -1,4 +1,4 @@
-head	1.52;
+head	1.53;
 access;
 symbols
 	pre_mrcs:1.52
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.53
+date	2025.11.10.22.32.19;	author dean;	state Exp;
+branches;
+next	1.52;
+
 1.52
 date	2018.10.03.14.34.03;	author leith;	state Exp;
 branches;
@@ -290,9 +295,9 @@ desc
 @
 
 
-1.52
+1.53
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -314,7 +319,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2015  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -745,6 +750,17 @@ C       THIS ONLY WRITES FIRST LS1 VALUES FROM EACH ROW
 @
 
 
+1.52
+log
+@email_health_dept
+@
+text
+@d20 1
+a20 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.51
 log
 @==,  input1
diff --git src/RCS/coupe.f,v src/RCS/coupe.f,v
index 120ceb48..f0b5af55 100644
--- src/RCS/coupe.f,v
+++ src/RCS/coupe.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.32.19;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.03;	author leith;	state Exp;
 branches;
@@ -85,9 +90,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -97,7 +102,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -201,6 +206,17 @@ C     INDICATOR IV(NKLA) OF THE AGGREGATION IN KPART CLASSES
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d8 1
+a8 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @GPL_2010
diff --git src/RCS/cppb.f,v src/RCS/cppb.f,v
index 5f17f658..f37b72f9 100644
--- src/RCS/cppb.f,v
+++ src/RCS/cppb.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.32.19;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.03;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -91,7 +96,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -126,6 +131,17 @@ C***********************************************************************
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/cproj.f,v src/RCS/cproj.f,v
index bbe0708c..9662ddb9 100644
--- src/RCS/cproj.f,v
+++ src/RCS/cproj.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.32.19;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.34.03;	author leith;	state Exp;
 branches;
@@ -70,9 +75,9 @@ desc
 @
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -86,7 +91,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -198,6 +203,17 @@ C
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @GPL_2010
diff --git src/RCS/cr180_2.f,v src/RCS/cr180_2.f,v
index c3550786..e4ce6c4f 100644
--- src/RCS/cr180_2.f,v
+++ src/RCS/cr180_2.f,v
@@ -1,4 +1,4 @@
-head	1.13;
+head	1.14;
 access;
 symbols
 	pre_mrcs:1.13
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.14
+date	2025.11.10.22.32.19;	author dean;	state Exp;
+branches;
+next	1.13;
+
 1.13
 date	2018.10.03.14.34.03;	author leith;	state Exp;
 branches;
@@ -95,9 +100,9 @@ desc
 @
 
 
-1.13
+1.14
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -111,7 +116,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -175,6 +180,17 @@ c$omp   parallel do private(i,j,ix,iy,argy,arg,ctemp)
 @
 
 
+1.13
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.12
 log
 @GPL_2010
diff --git src/RCS/crcse1.f,v src/RCS/crcse1.f,v
index e7aea528..5199930b 100644
--- src/RCS/crcse1.f,v
+++ src/RCS/crcse1.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.32.19;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.03;	author leith;	state Exp;
 branches;
@@ -85,9 +90,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -101,7 +106,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2013  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -189,6 +194,17 @@ C                    INSIDE CIRCLE
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @added half image options
diff --git src/RCS/crcse2.f,v src/RCS/crcse2.f,v
index 6a5e32ef..4535d9b0 100644
--- src/RCS/crcse2.f,v
+++ src/RCS/crcse2.f,v
@@ -1,4 +1,4 @@
-head	1.5;
+head	1.6;
 access;
 symbols
 	pre_mrcs:1.5
@@ -22,6 +22,11 @@ locks; strict;
 comment	@c @;
 
 
+1.6
+date	2025.11.10.22.32.19;	author dean;	state Exp;
+branches;
+next	1.5;
+
 1.5
 date	2018.10.03.14.34.03;	author leith;	state Exp;
 branches;
@@ -52,9 +57,9 @@ desc
 @@
 
 
-1.5
+1.6
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -67,7 +72,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -124,6 +129,17 @@ C        I DO NOT KNOW IF SAVE IS NEEDED FEB 99 al
 @
 
 
+1.5
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.4
 log
 @GPL_2010
diff --git src/RCS/crcse3.f,v src/RCS/crcse3.f,v
index f3358ed9..f7d618cb 100644
--- src/RCS/crcse3.f,v
+++ src/RCS/crcse3.f,v
@@ -1,4 +1,4 @@
-head	1.13;
+head	1.14;
 access;
 symbols
 	pre_mrcs:1.13
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.14
+date	2025.11.10.22.32.19;	author dean;	state Exp;
+branches;
+next	1.13;
+
 1.13
 date	2018.10.03.14.34.03;	author leith;	state Exp;
 branches;
@@ -95,9 +100,9 @@ desc
 @
 
 
-1.13
+1.14
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -110,7 +115,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -187,6 +192,17 @@ C--*********************************************************************
 @
 
 
+1.13
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.12
 log
 @nx , reformatted, added buf parameter
diff --git src/RCS/crosrmg.f,v src/RCS/crosrmg.f,v
index 5e7697da..5bcfd8fb 100644
--- src/RCS/crosrmg.f,v
+++ src/RCS/crosrmg.f,v
@@ -1,4 +1,4 @@
-head	1.5;
+head	1.6;
 access;
 symbols
 	pre_mrcs:1.5
@@ -19,6 +19,11 @@ locks; strict;
 comment	@c @;
 
 
+1.6
+date	2025.11.10.22.32.19;	author dean;	state Exp;
+branches;
+next	1.5;
+
 1.5
 date	2018.10.03.14.34.03;	author leith;	state Exp;
 branches;
@@ -50,9 +55,9 @@ desc
 @
 
 
-1.5
+1.6
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -65,7 +70,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -162,6 +167,17 @@ C
 @
 
 
+1.5
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.4
 log
 @GPL_2010
diff --git src/RCS/crosrng.f,v src/RCS/crosrng.f,v
index d1bf169a..4c515bbb 100644
--- src/RCS/crosrng.f,v
+++ src/RCS/crosrng.f,v
@@ -1,4 +1,4 @@
-head	1.19;
+head	1.20;
 access;
 symbols
 	pre_mrcs:1.19
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.20
+date	2025.11.10.22.32.19;	author dean;	state Exp;
+branches;
+next	1.19;
+
 1.19
 date	2018.10.03.14.34.03;	author leith;	state Exp;
 branches;
@@ -125,9 +130,9 @@ desc
 @
 
 
-1.19
+1.20
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -140,7 +145,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -316,6 +321,17 @@ C             FIRST RING SET IS NON-CONJUGATED (NOT MIRRORED)
 @
 
 
+1.19
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.18
 log
 @removed CROSRNG_COM_NEW call in: CROSRNG_NEW, rewrote: CROSRNG_NEW
diff --git src/RCS/crosrng_2.f,v src/RCS/crosrng_2.f,v
index 8ca15849..f0db63ff 100644
--- src/RCS/crosrng_2.f,v
+++ src/RCS/crosrng_2.f,v
@@ -1,4 +1,4 @@
-head	1.15;
+head	1.16;
 access;
 symbols
 	pre_mrcs:1.15
@@ -8,6 +8,11 @@ locks; strict;
 comment	@c @;
 
 
+1.16
+date	2025.11.10.22.32.19;	author dean;	state Exp;
+branches;
+next	1.15;
+
 1.15
 date	2018.10.03.14.34.03;	author leith;	state Exp;
 branches;
@@ -88,9 +93,9 @@ desc
 @@
 
 
-1.15
+1.16
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -115,7 +120,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2013  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -735,6 +740,17 @@ C             NOT USING COMPLEX VARIABLES ('AP SHCUU')
 
 
 
+@
+
+
+1.15
+log
+@email_health_dept
+@
+text
+@d23 1
+a23 1
+C=* Email: spider@@health.ny.gov                                        *
 @
 
 
diff --git src/RCS/crosrng_com.f,v src/RCS/crosrng_com.f,v
index cb0812e0..7e4b78bf 100644
--- src/RCS/crosrng_com.f,v
+++ src/RCS/crosrng_com.f,v
@@ -1,4 +1,4 @@
-head	1.28;
+head	1.29;
 access;
 symbols
 	pre_mrcs:1.28
@@ -23,6 +23,11 @@ locks; strict;
 comment	@c @;
 
 
+1.29
+date	2025.11.10.22.32.19;	author dean;	state Exp;
+branches;
+next	1.28;
+
 1.28
 date	2018.10.03.14.34.03;	author leith;	state Exp;
 branches;
@@ -168,9 +173,9 @@ desc
 @@
 
 
-1.28
+1.29
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -190,7 +195,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2012 Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -474,6 +479,17 @@ C       INTERPOLATION OVER 3+3 NEIGHBORHOOD AROUND MAXL
 
 
 
+@
+
+
+1.28
+log
+@email_health_dept
+@
+text
+@d18 1
+a18 1
+C=* Email: spider@@health.ny.gov                                        *
 @
 
 
diff --git src/RCS/crosrng_ds.f,v src/RCS/crosrng_ds.f,v
index efc75b38..9a96543d 100644
--- src/RCS/crosrng_ds.f,v
+++ src/RCS/crosrng_ds.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -23,6 +23,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.32.19;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.03;	author leith;	state Exp;
 branches;
@@ -73,9 +78,9 @@ desc
 @@
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -88,7 +93,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -214,6 +219,17 @@ C	CALL DSCAL1D(IP,1.0D0/DBLE(FLOAT(IP)),Q,LDA)
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/crosrng_ms.f,v src/RCS/crosrng_ms.f,v
index 6028cf27..89008527 100644
--- src/RCS/crosrng_ms.f,v
+++ src/RCS/crosrng_ms.f,v
@@ -1,4 +1,4 @@
-head	1.17;
+head	1.18;
 access;
 symbols
 	pre_mrcs:1.17
@@ -23,6 +23,11 @@ locks; strict;
 comment	@c @;
 
 
+1.18
+date	2025.11.10.22.32.19;	author dean;	state Exp;
+branches;
+next	1.17;
+
 1.17
 date	2018.10.03.14.34.03;	author leith;	state Exp;
 branches;
@@ -113,9 +118,9 @@ desc
 @@
 
 
-1.17
+1.18
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -133,7 +138,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -262,6 +267,17 @@ C       FOR MIRRORED CASE
 @
 
 
+1.17
+log
+@email_health_dept
+@
+text
+@d16 1
+a16 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.16
 log
 @removed unused crosrng_msp... routines
diff --git src/RCS/crosrng_q.f,v src/RCS/crosrng_q.f,v
index 6eb7fe47..4b3d4ca1 100644
--- src/RCS/crosrng_q.f,v
+++ src/RCS/crosrng_q.f,v
@@ -1,4 +1,4 @@
-head	1.12;
+head	1.13;
 access;
 symbols
 	pre_mrcs:1.12
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.13
+date	2025.11.10.22.32.19;	author dean;	state Exp;
+branches;
+next	1.12;
+
 1.12
 date	2018.10.03.14.34.04;	author leith;	state Exp;
 branches;
@@ -89,9 +94,9 @@ desc
 @@
 
 
-1.12
+1.13
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -104,7 +109,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -186,6 +191,17 @@ C
 @
 
 
+1.12
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.11
 log
 @GPL_2010
diff --git src/RCS/crosrng_trans.f,v src/RCS/crosrng_trans.f,v
index f1ea244d..acb5cf14 100644
--- src/RCS/crosrng_trans.f,v
+++ src/RCS/crosrng_trans.f,v
@@ -1,4 +1,4 @@
-head	1.5;
+head	1.6;
 access;
 symbols
 	pre_mrcs:1.5
@@ -8,6 +8,11 @@ locks; strict;
 comment	@c @;
 
 
+1.6
+date	2025.11.10.22.32.20;	author dean;	state Exp;
+branches;
+next	1.5;
+
 1.5
 date	2018.10.03.14.34.04;	author leith;	state Exp;
 branches;
@@ -39,9 +44,9 @@ desc
 @
 
 
-1.5
+1.6
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -54,7 +59,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -354,6 +359,17 @@ C          FOR MIRRORED
 
 
 
+@
+
+
+1.5
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
 @
 
 
diff --git src/RCS/crsm_2.f,v src/RCS/crsm_2.f,v
index 467e6f84..92fe5b14 100644
--- src/RCS/crsm_2.f,v
+++ src/RCS/crsm_2.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.32.20;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.04;	author leith;	state Exp;
 branches;
@@ -85,9 +90,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -100,7 +105,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -300,6 +305,17 @@ c$omp parallel do private(j)
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @GPL_2010
diff --git src/RCS/cslice.f,v src/RCS/cslice.f,v
index a7a45925..c92a2ce8 100644
--- src/RCS/cslice.f,v
+++ src/RCS/cslice.f,v
@@ -1,4 +1,4 @@
-head	1.15;
+head	1.16;
 access;
 symbols
 	pre_mrcs:1.15
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.16
+date	2025.11.10.22.32.20;	author dean;	state Exp;
+branches;
+next	1.15;
+
 1.15
 date	2018.10.03.14.34.04;	author leith;	state Exp;
 branches;
@@ -105,9 +110,9 @@ desc
 @
 
 
-1.15
+1.16
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -122,7 +127,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2012  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -310,6 +315,17 @@ C             INTERPOLATE
 @
 
 
+1.15
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.14
 log
 @enter
diff --git src/RCS/csvms.f,v src/RCS/csvms.f,v
index 286b2476..7ce4b303 100644
--- src/RCS/csvms.f,v
+++ src/RCS/csvms.f,v
@@ -1,4 +1,4 @@
-head	1.14;
+head	1.15;
 access;
 symbols
 	pre_mrcs:1.14
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.15
+date	2025.11.10.22.32.20;	author dean;	state Exp;
+branches;
+next	1.14;
+
 1.14
 date	2018.10.03.14.34.04;	author leith;	state Exp;
 branches;
@@ -100,9 +105,9 @@ desc
 @
 
 
-1.14
+1.15
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -117,7 +122,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2013  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -174,6 +179,17 @@ C--********************************************************************
 @
 
 
+1.14
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.13
 log
 @CSVMS(LINE,.TRUE.,IERR)
diff --git src/RCS/cutxslice.f,v src/RCS/cutxslice.f,v
index c33c2cdf..496e862d 100644
--- src/RCS/cutxslice.f,v
+++ src/RCS/cutxslice.f,v
@@ -1,4 +1,4 @@
-head	1.4;
+head	1.5;
 access;
 symbols
 	pre_mrcs:1.4
@@ -20,6 +20,11 @@ locks; strict;
 comment	@c @;
 
 
+1.5
+date	2025.11.10.22.32.20;	author dean;	state Exp;
+branches;
+next	1.4;
+
 1.4
 date	2018.10.03.14.34.04;	author leith;	state Exp;
 branches;
@@ -46,9 +51,9 @@ desc
 @
 
 
-1.4
+1.5
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -61,7 +66,7 @@ C=**********************************************************************
 C=* From: SPIDER - MODULAR IMAGE PROCESSING SYSTEM                     *
 C=* Copyright (C)2000  M. Radermacher                                  *
 C=*                                                                    *
-C=* Email:  spider@@health.ny.gov                                       *
+C=* Email:  spider@@wadsworth.org                                       *
 C=*                                                                    *
 C=* This program is free software; you can redistribute it and/or      *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -91,6 +96,17 @@ C=**********************************************************************
 @
 
 
+1.4
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email:  spider@@health.ny.gov                                       *
+@
+
+
 1.3
 log
 @GPL License fixed
diff --git src/RCS/cutyslice.f,v src/RCS/cutyslice.f,v
index d4edb487..02af4192 100644
--- src/RCS/cutyslice.f,v
+++ src/RCS/cutyslice.f,v
@@ -1,4 +1,4 @@
-head	1.4;
+head	1.5;
 access;
 symbols
 	pre_mrcs:1.4
@@ -20,6 +20,11 @@ locks; strict;
 comment	@c @;
 
 
+1.5
+date	2025.11.10.22.32.20;	author dean;	state Exp;
+branches;
+next	1.4;
+
 1.4
 date	2018.10.03.14.34.04;	author leith;	state Exp;
 branches;
@@ -46,9 +51,9 @@ desc
 @
 
 
-1.4
+1.5
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -56,7 +61,7 @@ C=**********************************************************************
 C=* From: SPIDER - MODULAR IMAGE PROCESSING SYSTEM                     *
 C=* Copyright (C)2000  M. Radermacher                                  *
 C=*                                                                    *
-C=* Email:  spider@@health.ny.gov                                       *
+C=* Email:  spider@@wadsworth.org                                       *
 C=*                                                                    *
 C=* This program is free software; you can redistribute it and/or      *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -92,6 +97,17 @@ C       THE LINE CAN BE TRUNCATED AT NSAM2.
 @
 
 
+1.4
+log
+@email_health_dept
+@
+text
+@d6 1
+a6 1
+C=* Email:  spider@@health.ny.gov                                       *
+@
+
+
 1.3
 log
 @GPL License fixed
diff --git src/RCS/cutzslice.f,v src/RCS/cutzslice.f,v
index 1ac77853..b2fe84b9 100644
--- src/RCS/cutzslice.f,v
+++ src/RCS/cutzslice.f,v
@@ -1,4 +1,4 @@
-head	1.4;
+head	1.5;
 access;
 symbols
 	pre_mrcs:1.4
@@ -20,6 +20,11 @@ locks; strict;
 comment	@c @;
 
 
+1.5
+date	2025.11.10.22.32.20;	author dean;	state Exp;
+branches;
+next	1.4;
+
 1.4
 date	2018.10.03.14.34.04;	author leith;	state Exp;
 branches;
@@ -46,9 +51,9 @@ desc
 @
 
 
-1.4
+1.5
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -56,7 +61,7 @@ C=**********************************************************************
 C=* From: SPIDER - MODULAR IMAGE PROCESSING SYSTEM                     *
 C=* Copyright (C)2000  M. Radermacher                                  *
 C=*                                                                    *
-C=* Email:  spider@@health.ny.gov                                       *
+C=* Email:  spider@@wadsworth.org                                       *
 C=*                                                                    *
 C=* This program is free software; you can redistribute it and/or      *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -91,6 +96,17 @@ C       THE LINE CAN BE TRUNCATED AT NSAM2.
 @
 
 
+1.4
+log
+@email_health_dept
+@
+text
+@d6 1
+a6 1
+C=* Email:  spider@@health.ny.gov                                       *
+@
+
+
 1.3
 log
 @GPL License fixed
diff --git src/RCS/d3dplt.f,v src/RCS/d3dplt.f,v
index 660ae9c9..3c20a38f 100644
--- src/RCS/d3dplt.f,v
+++ src/RCS/d3dplt.f,v
@@ -1,4 +1,4 @@
-head	1.15;
+head	1.16;
 access;
 symbols
 	pre_mrcs:1.15
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.16
+date	2025.11.10.22.32.20;	author dean;	state Exp;
+branches;
+next	1.15;
+
 1.15
 date	2018.10.03.14.34.04;	author leith;	state Exp;
 branches;
@@ -105,9 +110,9 @@ desc
 @
 
 
-1.15
+1.16
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -124,7 +129,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -320,6 +325,17 @@ C     CLOSE THE POSTSCRIPT-FILE
 @
 
 
+1.15
+log
+@email_health_dept
+@
+text
+@d15 1
+a15 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.14
 log
 @cosmetics on input/output formatting , error msg, maxnam
diff --git src/RCS/date.f,v src/RCS/date.f,v
index 5b27fdfd..8eecef52 100644
--- src/RCS/date.f,v
+++ src/RCS/date.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.32.20;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.04;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -90,7 +95,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -162,6 +167,17 @@ C --*********************************************************************
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/date_2k.f,v src/RCS/date_2k.f,v
index 007d6752..92d51b7f 100644
--- src/RCS/date_2k.f,v
+++ src/RCS/date_2k.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.32.20;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.04;	author leith;	state Exp;
 branches;
@@ -74,9 +79,9 @@ desc
 @@
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -89,7 +94,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -170,6 +175,17 @@ C      PUT IN YEAR
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/dchist.f,v src/RCS/dchist.f,v
index 5c21f843..9f532202 100644
--- src/RCS/dchist.f,v
+++ src/RCS/dchist.f,v
@@ -1,4 +1,4 @@
-head	1.22;
+head	1.23;
 access;
 symbols
 	pre_mrcs:1.22
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.23
+date	2025.11.10.22.32.20;	author dean;	state Exp;
+branches;
+next	1.22;
+
 1.22
 date	2018.10.03.14.34.04;	author leith;	state Exp;
 branches;
@@ -140,9 +145,9 @@ desc
 @
 
 
-1.22
+1.23
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -160,7 +165,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -340,6 +345,17 @@ C       DEALLOCATE DOC. FILE MEMORY
 @
 
 
+1.22
+log
+@email_health_dept
+@
+text
+@d16 1
+a16 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.21
 log
 @LEN=MAXNAM) :: FILDOC,FILPOS
diff --git src/RCS/decimate.f,v src/RCS/decimate.f,v
index 0490ac19..76adc4c2 100644
--- src/RCS/decimate.f,v
+++ src/RCS/decimate.f,v
@@ -1,4 +1,4 @@
-head	1.20;
+head	1.21;
 access;
 symbols
 	pre_mrcs:1.20
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.21
+date	2025.11.10.22.32.20;	author dean;	state Exp;
+branches;
+next	1.20;
+
 1.20
 date	2018.10.03.14.34.04;	author leith;	state Exp;
 branches;
@@ -129,9 +134,9 @@ desc
 @@
 
 
-1.20
+1.21
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -146,7 +151,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -341,6 +346,17 @@ C       --------------------------- DECIM ----------------------------
 @
 
 
+1.20
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.19
 log
 @SETPRS for pixsiz
diff --git src/RCS/dee.f,v src/RCS/dee.f,v
index 3b0d74e8..1c824c78 100644
--- src/RCS/dee.f,v
+++ src/RCS/dee.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.32.20;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.04;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -91,7 +96,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -140,6 +145,17 @@ C***********************************************************************
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/defo001.f,v src/RCS/defo001.f,v
index ea5221e9..a68d1b6c 100644
--- src/RCS/defo001.f,v
+++ src/RCS/defo001.f,v
@@ -1,4 +1,4 @@
-head	1.21;
+head	1.22;
 access;
 symbols
 	pre_mrcs:1.21
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.22
+date	2025.11.10.22.32.20;	author dean;	state Exp;
+branches;
+next	1.21;
+
 1.21
 date	2018.10.03.14.34.04;	author leith;	state Exp;
 branches;
@@ -135,9 +140,9 @@ desc
 @
 
 
-1.21
+1.22
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -150,7 +155,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -460,6 +465,17 @@ C       GATE VALUE IS 0.08
 @
 
 
+1.21
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.20
 log
 @cosmetic rewrite
diff --git src/RCS/defo003.f,v src/RCS/defo003.f,v
index 673bc949..3be138a9 100644
--- src/RCS/defo003.f,v
+++ src/RCS/defo003.f,v
@@ -1,4 +1,4 @@
-head	1.19;
+head	1.20;
 access;
 symbols
 	pre_mrcs:1.19
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.20
+date	2025.11.10.22.32.20;	author dean;	state Exp;
+branches;
+next	1.19;
+
 1.19
 date	2018.10.03.14.34.04;	author leith;	state Exp;
 branches;
@@ -125,9 +130,9 @@ desc
 @
 
 
-1.19
+1.20
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -140,7 +145,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -311,6 +316,17 @@ c          WRITE(NOUT,*) '#',I ,KFR(I), B(I), '(A-1)   A=',A(I)
 @
 
 
+1.19
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.18
 log
 @several fatal bugs fixed,  rewrite
diff --git src/RCS/defo1001.f,v src/RCS/defo1001.f,v
index 2249c94b..8e32dbbd 100644
--- src/RCS/defo1001.f,v
+++ src/RCS/defo1001.f,v
@@ -1,4 +1,4 @@
-head	1.16;
+head	1.17;
 access;
 symbols
 	pre_mrcs:1.16
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.17
+date	2025.11.10.22.32.20;	author dean;	state Exp;
+branches;
+next	1.16;
+
 1.16
 date	2018.10.03.14.34.04;	author leith;	state Exp;
 branches;
@@ -110,9 +115,9 @@ desc
 @
 
 
-1.16
+1.17
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -125,7 +130,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -507,6 +512,17 @@ C	GATE VALUE IS 0.08
 @
 
 
+1.16
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.15
 log
 @CS_zero
diff --git src/RCS/defo2001.f,v src/RCS/defo2001.f,v
index 6bef53df..cfd29805 100644
--- src/RCS/defo2001.f,v
+++ src/RCS/defo2001.f,v
@@ -1,4 +1,4 @@
-head	1.13;
+head	1.14;
 access;
 symbols
 	pre_mrcs:1.13
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.14
+date	2025.11.10.22.32.20;	author dean;	state Exp;
+branches;
+next	1.13;
+
 1.13
 date	2018.10.03.14.34.04;	author leith;	state Exp;
 branches;
@@ -95,9 +100,9 @@ desc
 @
 
 
-1.13
+1.14
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -110,7 +115,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -547,6 +552,17 @@ C	WRITE(NOUT,*) 'NSTEP',NSTEP, A(1),A(2),A(3),A(4)
 @
 
 
+1.13
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.12
 log
 @CS_zero
diff --git src/RCS/defocus.f,v src/RCS/defocus.f,v
index c1d35a68..cbb39160 100644
--- src/RCS/defocus.f,v
+++ src/RCS/defocus.f,v
@@ -1,4 +1,4 @@
-head	1.22;
+head	1.23;
 access;
 symbols
 	pre_mrcs:1.22
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.23
+date	2025.11.10.22.32.20;	author dean;	state Exp;
+branches;
+next	1.22;
+
 1.22
 date	2018.10.03.14.34.04;	author leith;	state Exp;
 branches;
@@ -140,9 +145,9 @@ desc
 @
 
 
-1.22
+1.23
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -157,7 +162,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -312,6 +317,17 @@ C          SINGLE INPUT FILE CASE
 @
 
 
+1.22
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.21
 log
 @rewrite and fixed fatal bug
diff --git src/RCS/dendro.f,v src/RCS/dendro.f,v
index 9d7416c7..73a42898 100644
--- src/RCS/dendro.f,v
+++ src/RCS/dendro.f,v
@@ -1,4 +1,4 @@
-head	1.22;
+head	1.23;
 access;
 symbols
 	pre_mrcs:1.22
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.23
+date	2025.11.10.22.32.20;	author dean;	state Exp;
+branches;
+next	1.22;
+
 1.22
 date	2018.10.03.14.34.04;	author leith;	state Exp;
 branches;
@@ -140,9 +145,9 @@ desc
 @
 
 
-1.22
+1.23
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -161,7 +166,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -679,6 +684,17 @@ C     PLACE UNTRUNCATED DENDROGRAM SPECIFICATIONS IN DOC FILE
 @
 
 
+1.22
+log
+@email_health_dept
+@
+text
+@d17 1
+a17 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.21
 log
 @enteer
diff --git src/RCS/denlst.f,v src/RCS/denlst.f,v
index db2b485d..11e5dcdf 100644
--- src/RCS/denlst.f,v
+++ src/RCS/denlst.f,v
@@ -1,4 +1,4 @@
-head	1.14;
+head	1.15;
 access;
 symbols
 	pre_mrcs:1.14
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.15
+date	2025.11.10.22.32.20;	author dean;	state Exp;
+branches;
+next	1.14;
+
 1.14
 date	2018.10.03.14.34.04;	author leith;	state Exp;
 branches;
@@ -100,9 +105,9 @@ desc
 @
 
 
-1.14
+1.15
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -118,7 +123,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -195,6 +200,17 @@ C           STORE THIS LINE IN DOC FILE
 @
 
 
+1.14
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.13
 log
 @GPL_2010
diff --git src/RCS/denov.f,v src/RCS/denov.f,v
index c64da094..9ff3c231 100644
--- src/RCS/denov.f,v
+++ src/RCS/denov.f,v
@@ -1,4 +1,4 @@
-head	1.12;
+head	1.13;
 access;
 symbols
 	pre_mrcs:1.12
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.13
+date	2025.11.10.22.32.20;	author dean;	state Exp;
+branches;
+next	1.12;
+
 1.12
 date	2018.10.03.14.34.04;	author leith;	state Exp;
 branches;
@@ -90,9 +95,9 @@ desc
 @
 
 
-1.12
+1.13
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -106,7 +111,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -172,6 +177,17 @@ C--*******************************************************************
 @
 
 
+1.12
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.11
 log
 @center
diff --git src/RCS/deucl.f,v src/RCS/deucl.f,v
index 57950dd0..a005cb99 100644
--- src/RCS/deucl.f,v
+++ src/RCS/deucl.f,v
@@ -1,4 +1,4 @@
-head	1.14;
+head	1.15;
 access;
 symbols
 	pre_mrcs:1.14
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.15
+date	2025.11.10.22.32.20;	author dean;	state Exp;
+branches;
+next	1.14;
+
 1.14
 date	2018.10.03.14.34.04;	author leith;	state Exp;
 branches;
@@ -100,9 +105,9 @@ desc
 @
 
 
-1.14
+1.15
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -117,7 +122,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -231,6 +236,17 @@ C       CALCULATION OF THE MATRIX OF DISTANCES BETWEEN OBJECTS
 @
 
 
+1.14
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.13
 log
 @GPL_2010
diff --git src/RCS/dhide.f,v src/RCS/dhide.f,v
index 43a08946..2899e762 100644
--- src/RCS/dhide.f,v
+++ src/RCS/dhide.f,v
@@ -1,4 +1,4 @@
-head	1.13;
+head	1.14;
 access;
 symbols
 	pre_mrcs:1.13
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.14
+date	2025.11.10.22.32.20;	author dean;	state Exp;
+branches;
+next	1.13;
+
 1.13
 date	2018.10.03.14.34.04;	author leith;	state Exp;
 branches;
@@ -95,9 +100,9 @@ desc
 @
 
 
-1.13
+1.14
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -112,7 +117,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -641,6 +646,17 @@ C--********************************************************************
 @
 
 
+1.13
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.12
 log
 @GPL_2010
diff --git src/RCS/diff1o.f,v src/RCS/diff1o.f,v
index 31f4c8c1..c0a44bca 100644
--- src/RCS/diff1o.f,v
+++ src/RCS/diff1o.f,v
@@ -1,4 +1,4 @@
-head	1.29;
+head	1.30;
 access;
 symbols
 	pre_mrcs:1.29
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.30
+date	2025.11.10.22.32.20;	author dean;	state Exp;
+branches;
+next	1.29;
+
 1.29
 date	2018.10.03.14.34.04;	author leith;	state Exp;
 branches;
@@ -175,9 +180,9 @@ desc
 @
 
 
-1.29
+1.30
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -194,7 +199,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -520,6 +525,17 @@ C         COMPUTE OPTIMUM LATTICE VECTORS FOR NEXT ITERATION
 
 
 
+@
+
+
+1.29
+log
+@email_health_dept
+@
+text
+@d15 1
+a15 1
+C=* Email: spider@@health.ny.gov                                        *
 @
 
 
diff --git src/RCS/dilation.f,v src/RCS/dilation.f,v
index c05f5086..334c34db 100644
--- src/RCS/dilation.f,v
+++ src/RCS/dilation.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -22,6 +22,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.32.20;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.04;	author leith;	state Exp;
 branches;
@@ -83,9 +88,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -98,7 +103,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -402,6 +407,17 @@ C             OUTPUT VOLUME
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @GPL_2010
diff --git src/RCS/dirnm.f,v src/RCS/dirnm.f,v
index a7452511..97301e53 100644
--- src/RCS/dirnm.f,v
+++ src/RCS/dirnm.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.32.21;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.04;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -91,7 +96,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -171,6 +176,17 @@ C***********************************************************************
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/disc.f,v src/RCS/disc.f,v
index 6a4decb2..f2b44c29 100644
--- src/RCS/disc.f,v
+++ src/RCS/disc.f,v
@@ -1,4 +1,4 @@
-head	1.16;
+head	1.17;
 access;
 symbols
 	pre_mrcs:1.16
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.17
+date	2025.11.10.22.32.21;	author dean;	state Exp;
+branches;
+next	1.16;
+
 1.16
 date	2018.10.03.14.34.04;	author leith;	state Exp;
 branches;
@@ -110,9 +115,9 @@ desc
 @
 
 
-1.16
+1.17
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -125,7 +130,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -421,6 +426,17 @@ C
 @
 
 
+1.16
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.15
 log
 @GPL_2010
diff --git src/RCS/discrim.f,v src/RCS/discrim.f,v
index 7dd446b8..197043bd 100644
--- src/RCS/discrim.f,v
+++ src/RCS/discrim.f,v
@@ -1,4 +1,4 @@
-head	1.13;
+head	1.14;
 access;
 symbols
 	pre_mrcs:1.13
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.14
+date	2025.11.10.22.32.21;	author dean;	state Exp;
+branches;
+next	1.13;
+
 1.13
 date	2018.10.03.14.34.04;	author leith;	state Exp;
 branches;
@@ -95,9 +100,9 @@ desc
 @
 
 
-1.13
+1.14
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -111,7 +116,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -352,6 +357,17 @@ C       WRITE(LUN51,99)
 @
 
 
+1.13
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.12
 log
 @GPL_2010
diff --git src/RCS/disp.f,v src/RCS/disp.f,v
index d9b159a2..d017052e 100644
--- src/RCS/disp.f,v
+++ src/RCS/disp.f,v
@@ -1,4 +1,4 @@
-head	1.14;
+head	1.17;
 access;
 symbols
 	pre_mrcs:1.11
@@ -7,6 +7,21 @@ locks; strict;
 comment	@c @;
 
 
+1.17
+date	2025.11.10.22.33.58;	author dean;	state Exp;
+branches;
+next	1.16;
+
+1.16
+date	2025.10.25.15.31.03;	author dean;	state Exp;
+branches;
+next	1.15;
+
+1.15
+date	2025.10.21.19.26.55;	author dean;	state Exp;
+branches;
+next	1.14;
+
 1.14
 date	2020.01.13.19.20.24;	author leith;	state Exp;
 branches;
@@ -82,23 +97,26 @@ desc
 @@
 
 
-1.14
+1.17
 log
-@relion_display --i blank needed
+@*** empty log message ***
 @
 text
 @
+
 C++*********************************************************************
 C
-C  DISP.F  -- EXTRACTED FROM COPYTOJPED            Jan 20 ArDean Leith
+C  DISP.F  -- EXTRACTED FROM COPYTOJPED           Jan 2020 ArDean Leith
+C          -- IRTFLG 654321                       Oct 2025 ArDean Leith
+C          -- REMOVE MRC EXTENSION                Oct 2025 ArDean Leith
 C
 C **********************************************************************
 C=* AUTHOR: A. LEITH                                                   *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2020  Health Research Inc.,                         *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -138,9 +156,9 @@ C--*********************************************************************
         CHARACTER(LEN=160)    :: COMLIN
  
         CHARACTER(LEN=1)      :: NULL = CHAR(0)
-        LOGICAL               :: VERBOSET,WANTOUT
+        LOGICAL               :: VERBOSET,WANTOUT,SAYIT
         INTEGER               :: NX,NY,NZ,MAXIM,ITYPE,IRTFLG,NLET,NLETC
-        INTEGER               :: lnblnkn,NLETO
+        INTEGER               :: lnblnkn,NLETO,IGOEXT,NDUM
 
         INTEGER, PARAMETER    :: LUN1   = 14 
         INTEGER, PARAMETER    :: LUN2   = 15 
@@ -154,35 +172,70 @@ C--*********************************************************************
 
 C       OPEN INPUT FILE, WHOLE STACK NOT ALLOWED
         MAXIM = 0
+        ITYPE = 0   ! ?
         CALL OPFILEC(0,.TRUE.,FILOLD,LUN1,'O',ITYPE,
      &               NX,NY,NZ,MAXIM,'SPIDER OR MRC INPUT',
      &               .FALSE.,IRTFLG)
         IF (IRTFLG .NE. 0) RETURN
 
+        IF (NZ > 1) THEN
+           CALL ERRT(101,'CAN NOT DISPLAY A VOLUME',NDUM)
+           RETURN
+        ENDIF
+
+#if defined (SP_DBUGIO)
+        nletc = lnblnkn(filold)
+        write(3,*)' In disp; nletc,filold: ',nletc,filold(:nletc)
+#endif
+
         IF (IMAMI .NE. 1) 
      &      CALL NORM3(LUN1,NX,NY,NZ,FMAX,FMIN,AV)
 
 C       IF MRC AND ORIGIN IS 'LL' FLIP ORIGIN FOR DISPLAY
         CALL LUNFLIPORG_MRC(LUN1,NX,NY,NZ,.FALSE.,IRTFLG)
 
-C       JPEG OUTPUT FILE NAME
+C       CREATE JPEG OUTPUT FILE NAME
         NLET   = lnblnkn(FILOLD)
+        IGOEXT = SCAN(FILOLD,'.')
+        IF(IGOEXT > 0 .AND. IGOEXT < NLET) NLET = IGOEXT - 1
+
+#if defined (SP_DBUGIO)
+        write(3,*)' In disp; nlet,filold(:nlet): ',nlet,filold(:nlet)
+#endif
+
         FILNEW = FILOLD(:NLET) // '.jpg'
         NLET   = NLET + 4
 
+       ! FILNEW = 'jnk_temp_for_display.jpg'
+       ! NLET   = lnblnkn(FILNEW)
+
+#if defined (SP_DBUGIO)
+        write(3,*)' In disp; nlet,filnew(:nlet): ', nlet,filnew(:nlet)
+#endif
+
 C       CONVERT IMAGE FILE INTO JPG FILE
-        VERBOSET = .FALSE.
+C       COPYTOJPG HAS A DELAY NEAR END SINCE AN INTERMEDIATE FILE .gray
+C       IS CREATED TO HANDLE FLOATING POINTS AND NEGATIVE VALUES
+
+        !!!!!!!!!!!!!VERBOSET = .FALSE.
+        VERBOSET = .TRUE.
         CALL COPYTOJPG(LUN1,LUN2,FILNEW,NX,NY,NZ, VERBOSET,IDELAY)
 
-        IRTFLG = -999   ! KEEP LOWERCASE
+        IRTFLG = 654321   ! KEEP LOWERCASE AND ACCEPT <CR>
         CALL RDPRMC(OPTIONS,NLETO,.TRUE.,
      &          'IMAGEMAGICK DISPLAY OPTIONS (or <CR>)',NULL,IRTFLG)
 
         WRITE(COMLIN,90) OPTIONS(1:NLETO),FILNEW(1:NLET)
 90      FORMAT( ' display ', A,' ',A, ' &' )
 
-C       DO NOT ECHO COMLIN
-        CALL CSVMS(COMLIN,.FALSE.,IRTFLG)
+#if defined (SP_DBUGIO)
+        write(3,*)' In disp; comlin: ',comlin
+        !sayit = .TRUE.
+#endif
+
+C       SAYIT: ECHO COMLIN TO OUTPUT
+        SAYIT = .FALSE.
+        CALL CSVMS(COMLIN,SAYIT,IRTFLG)
 
         END
 
@@ -219,7 +272,7 @@ C       ----------------- DISP_RELION ---------------------------------
      &              NULL,IRTFLG)
         IF (IRTFLG .NE. 0) RETURN
 
-        WRITE(COMLIN,90) ,FILELINE(1:NLET1), OPTIONS(1:NLET2)
+        WRITE(COMLIN,90) FILELINE(1:NLET1), OPTIONS(1:NLET2)
 90      FORMAT( ' relion_display --i ', A,' ',A, ' &' )
 
 C       DO NOT ECHO COMLIN
@@ -287,6 +340,101 @@ gyan 877% relion_display -h
 @
 
 
+1.16
+log
+@(SP_DBUGIO)
+renamed temp files
+@
+text
+@d83 2
+a84 2
+        !nletc = lnblnkn(filold)
+        !write(3,*)' In disp; nletc,filold: ',nletc,filold(:nletc)
+d102 2
+a103 2
+        !FILNEW = FILOLD(:NLET) // '.jpg'
+        !NLET   = NLET + 4
+d105 2
+a106 2
+        FILNEW = 'jnk_temp_for_display.jpg'
+        NLET   = lnblnkn(FILNEW)
+d116 2
+a117 1
+        VERBOSET = .FALSE.
+@
+
+
+1.15
+log
+@removed .mrc from jpeg filename
+display options do not fail with ifort debugger now
+@
+text
+@d2 1
+d57 1
+a57 1
+        INTEGER               :: lnblnkn,NLETO,IGOEXT
+d71 1
+d77 10
+d96 8
+a103 1
+        IF(IGOEXT .LT. NLET) NLET = IGOEXT - 1
+d105 6
+a110 2
+        FILNEW = FILOLD(:NLET) // '.jpg'
+        NLET   = NLET + 4
+a122 8
+        SAYIT = .FALSE.
+
+#if defined (SP_DBUGIO)
+        write(3,*)' In disp; nleto,options(:nleto): ',
+     &                       nleto,options(:nleto)
+        !sayit = .TRUE.
+#endif
+
+d132 1
+@
+
+
+1.14
+log
+@relion_display --i blank needed
+@
+text
+@d4 3
+a6 1
+C  DISP.F  -- EXTRACTED FROM COPYTOJPED            Jan 20 ArDean Leith
+d12 1
+a12 1
+C=* Copyright 1985-2020  Health Research Inc.,                         *
+d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+d54 1
+a54 1
+        LOGICAL               :: VERBOSET,WANTOUT
+d56 1
+a56 1
+        INTEGER               :: lnblnkn,NLETO
+d81 1
+a81 1
+C       JPEG OUTPUT FILE NAME
+d83 3
+d90 3
+d96 1
+a96 1
+        IRTFLG = -999   ! KEEP LOWERCASE
+d100 8
+d111 7
+a117 2
+C       DO NOT ECHO COMLIN
+        CALL CSVMS(COMLIN,.FALSE.,IRTFLG)
+d154 1
+a154 1
+        WRITE(COMLIN,90) ,FILELINE(1:NLET1), OPTIONS(1:NLET2)
+@
+
+
 1.13
 log
 @removed from copytojpg.f
diff --git src/RCS/dist1.f,v src/RCS/dist1.f,v
index 4132519f..65064ae2 100644
--- src/RCS/dist1.f,v
+++ src/RCS/dist1.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.32.22;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.04;	author leith;	state Exp;
 branches;
@@ -80,9 +85,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -96,7 +101,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -150,6 +155,17 @@ C***********************************************************************
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @GPL_2010
diff --git src/RCS/dist2.f,v src/RCS/dist2.f,v
index aecc37ac..d86c0845 100644
--- src/RCS/dist2.f,v
+++ src/RCS/dist2.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.32.22;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.04;	author leith;	state Exp;
 branches;
@@ -85,9 +90,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -101,7 +106,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -157,6 +162,17 @@ C***********************************************************************
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @GPL_2010
diff --git src/RCS/dist4.f,v src/RCS/dist4.f,v
index da25e7be..da2dfd25 100644
--- src/RCS/dist4.f,v
+++ src/RCS/dist4.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.32.22;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.04;	author leith;	state Exp;
 branches;
@@ -80,9 +85,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -96,7 +101,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -159,6 +164,17 @@ C***********************************************************************
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @GPL_2010
diff --git src/RCS/dist_p.f,v src/RCS/dist_p.f,v
index 7983203f..e5557252 100644
--- src/RCS/dist_p.f,v
+++ src/RCS/dist_p.f,v
@@ -1,4 +1,4 @@
-head	1.18;
+head	1.19;
 access;
 symbols
 	pre_mrcs:1.18
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.19
+date	2025.11.10.22.32.22;	author dean;	state Exp;
+branches;
+next	1.18;
+
 1.18
 date	2018.10.03.14.34.04;	author leith;	state Exp;
 branches;
@@ -120,9 +125,9 @@ desc
 @
 
 
-1.18
+1.19
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -136,7 +141,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2013  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -248,6 +253,17 @@ C                 IMC OR PIX FILE
 @
 
 
+1.18
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.17
 log
 @*** empty log message ***
diff --git src/RCS/distest.f,v src/RCS/distest.f,v
index 17e2c992..63523f06 100644
--- src/RCS/distest.f,v
+++ src/RCS/distest.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.32.22;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.04;	author leith;	state Exp;
 branches;
@@ -80,9 +85,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -96,7 +101,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -178,6 +183,17 @@ C         ALPH=ALPHAINT(F,N1,N2)
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @GPL_2010
diff --git src/RCS/divcr3.f,v src/RCS/divcr3.f,v
index 4acba2c9..cd8082b4 100644
--- src/RCS/divcr3.f,v
+++ src/RCS/divcr3.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.32.22;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.04;	author leith;	state Exp;
 branches;
@@ -85,9 +90,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -100,7 +105,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -139,6 +144,17 @@ C--*********************************************************************
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @GPL_2010
diff --git src/RCS/docorr3_s.f,v src/RCS/docorr3_s.f,v
index 744f34aa..020c9ea2 100644
--- src/RCS/docorr3_s.f,v
+++ src/RCS/docorr3_s.f,v
@@ -1,4 +1,4 @@
-head	1.12;
+head	1.13;
 access;
 symbols
 	pre_mrcs:1.12
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.13
+date	2025.11.10.22.32.22;	author dean;	state Exp;
+branches;
+next	1.12;
+
 1.12
 date	2018.10.03.14.34.04;	author leith;	state Exp;
 branches;
@@ -90,9 +95,9 @@ desc
 @
 
 
-1.12
+1.13
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -106,7 +111,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -149,6 +154,17 @@ c$omp parallel do  private(i,j,temp),reduction(+:sbq)
 @
 
 
+1.12
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.11
 log
 @GPL_2010
diff --git src/RCS/docors3_s.f,v src/RCS/docors3_s.f,v
index 8a83fd2c..cc9e50fe 100644
--- src/RCS/docors3_s.f,v
+++ src/RCS/docors3_s.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.32.22;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.04;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -90,7 +95,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -201,6 +206,17 @@ c
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/docs1.f,v src/RCS/docs1.f,v
index 29ce30f8..495d9444 100644
--- src/RCS/docs1.f,v
+++ src/RCS/docs1.f,v
@@ -1,4 +1,4 @@
-head	1.89;
+head	1.90;
 access;
 symbols
 	pre_mrcs:1.89
@@ -23,6 +23,11 @@ locks; strict;
 comment	@c @;
 
 
+1.90
+date	2025.11.10.22.32.22;	author dean;	state Exp;
+branches;
+next	1.89;
+
 1.89
 date	2018.10.03.14.34.04;	author leith;	state Exp;
 branches;
@@ -473,9 +478,9 @@ desc
 @@
 
 
-1.89
+1.90
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -522,7 +527,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2016  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -1986,6 +1991,17 @@ C       DEALLOCATE ALLOCATABLE ARRAYS
 @
 
 
+1.89
+log
+@email_health_dept
+@
+text
+@d45 1
+a45 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.88
 log
 @Empty doc files msg for 'DOC MERGE'
diff --git src/RCS/docseparate.f,v src/RCS/docseparate.f,v
index 9fc465d5..ab3f40d5 100644
--- src/RCS/docseparate.f,v
+++ src/RCS/docseparate.f,v
@@ -1,4 +1,4 @@
-head	1.5;
+head	1.6;
 access;
 symbols
 	pre_mrcs:1.5
@@ -7,6 +7,11 @@ locks; strict;
 comment	@c @;
 
 
+1.6
+date	2025.11.10.22.32.22;	author dean;	state Exp;
+branches;
+next	1.5;
+
 1.5
 date	2018.10.03.14.34.04;	author leith;	state Exp;
 branches;
@@ -37,9 +42,9 @@ desc
 @@
 
 
-1.5
+1.6
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -53,7 +58,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -245,6 +250,17 @@ C           PUSH LINE INTO SUMMARY DOC. FILE
 @
 
 
+1.5
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.4
 log
 @nletp prompt fixed
diff --git src/RCS/docsub.f,v src/RCS/docsub.f,v
index af813b7d..65c5ce5d 100644
--- src/RCS/docsub.f,v
+++ src/RCS/docsub.f,v
@@ -1,4 +1,4 @@
-head	1.75;
+head	1.76;
 access;
 symbols
 	pre_mrcs:1.75
@@ -23,6 +23,11 @@ locks; strict;
 comment	@c @;
 
 
+1.76
+date	2025.11.10.22.32.22;	author dean;	state Exp;
+branches;
+next	1.75;
+
 1.75
 date	2018.10.03.14.34.04;	author leith;	state Exp;
 branches;
@@ -403,9 +408,9 @@ desc
 @@
 
 
-1.75
+1.76
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -419,7 +424,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -857,6 +862,17 @@ C       DEALLOCATE ALLOCATABLE ARRAYS
 @
 
 
+1.75
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.74
 log
 @IF (ASSOCIATED(DOCBUF2))..
diff --git src/RCS/domax3_s.f,v src/RCS/domax3_s.f,v
index 509baef4..5239e107 100644
--- src/RCS/domax3_s.f,v
+++ src/RCS/domax3_s.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.32.30;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.04;	author leith;	state Exp;
 branches;
@@ -85,9 +90,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -101,7 +106,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -143,6 +148,17 @@ c$omp parallel do  private(i,j)
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @GPL_2010
diff --git src/RCS/domin3_s.f,v src/RCS/domin3_s.f,v
index a6e6c7f8..6595b5be 100644
--- src/RCS/domin3_s.f,v
+++ src/RCS/domin3_s.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.32.30;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.04;	author leith;	state Exp;
 branches;
@@ -85,9 +90,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -100,7 +105,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -142,6 +147,17 @@ c$omp parallel do  private(i,j)
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @GPL_2010
diff --git src/RCS/dprofd.f,v src/RCS/dprofd.f,v
index df21fbf8..1f840813 100644
--- src/RCS/dprofd.f,v
+++ src/RCS/dprofd.f,v
@@ -1,4 +1,4 @@
-head	1.22;
+head	1.23;
 access;
 symbols
 	pre_mrcs:1.22
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.23
+date	2025.11.10.22.32.30;	author dean;	state Exp;
+branches;
+next	1.22;
+
 1.22
 date	2018.10.03.14.34.05;	author leith;	state Exp;
 branches;
@@ -140,9 +145,9 @@ desc
 @
 
 
-1.22
+1.23
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -159,7 +164,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2013  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -409,7 +414,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -590,6 +595,20 @@ C       DEALLOCATE DOC. FILE MEMORY
 @
 
 
+1.22
+log
+@email_health_dept
+@
+text
+@d15 1
+a15 1
+C=* Email: spider@@health.ny.gov                                        *
+d265 1
+a265 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.21
 log
 @typo
diff --git src/RCS/dprofl.f,v src/RCS/dprofl.f,v
index 9975256b..15f7a071 100644
--- src/RCS/dprofl.f,v
+++ src/RCS/dprofl.f,v
@@ -1,4 +1,4 @@
-head	1.17;
+head	1.18;
 access;
 symbols
 	pre_mrcs:1.17
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.18
+date	2025.11.10.22.32.30;	author dean;	state Exp;
+branches;
+next	1.17;
+
 1.17
 date	2018.10.03.14.34.05;	author leith;	state Exp;
 branches;
@@ -115,9 +120,9 @@ desc
 @
 
 
-1.17
+1.18
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -133,7 +138,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2018  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -351,7 +356,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -613,6 +618,20 @@ C     CLOSE THE POSTSCRIPT-FILE
 
 
 
+@
+
+
+1.17
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+d232 1
+a232 1
+C=* Email: spider@@health.ny.gov                                        *
 @
 
 
diff --git src/RCS/driv1.f,v src/RCS/driv1.f,v
index aeb78499..1ef3a54d 100644
--- src/RCS/driv1.f,v
+++ src/RCS/driv1.f,v
@@ -1,4 +1,4 @@
-head	1.80;
+head	1.81;
 access;
 symbols
 	pre_mrcs:1.80
@@ -25,6 +25,11 @@ locks; strict;
 comment	@c @;
 
 
+1.81
+date	2025.11.10.22.32.30;	author dean;	state Exp;
+branches;
+next	1.80;
+
 1.80
 date	2018.10.03.14.34.05;	author leith;	state Exp;
 branches;
@@ -431,9 +436,9 @@ desc
 @
 
 
-1.80
+1.81
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -467,7 +472,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2016  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -742,6 +747,17 @@ C          SEND IMAGE DOWN PIPE  ------------------------------- PI IMG
 @
 
 
+1.80
+log
+@email_health_dept
+@
+text
+@d32 1
+a32 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.79
 log
 @avgloc
diff --git src/RCS/driv2.f,v src/RCS/driv2.f,v
index 2d58c8d3..c12ad265 100644
--- src/RCS/driv2.f,v
+++ src/RCS/driv2.f,v
@@ -1,4 +1,4 @@
-head	1.22;
+head	1.23;
 access;
 symbols
 	pre_mrcs:1.22
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.23
+date	2025.11.10.22.32.30;	author dean;	state Exp;
+branches;
+next	1.22;
+
 1.22
 date	2018.10.03.14.34.05;	author leith;	state Exp;
 branches;
@@ -140,9 +145,9 @@ desc
 @
 
 
-1.22
+1.23
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -158,7 +163,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2015  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -276,6 +281,17 @@ C             PDATES ADDS DATE AND CALLS SPIREOUT
 @
 
 
+1.22
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.21
 log
 @wt tv MANUAL PAGE MISSING
diff --git src/RCS/driv3.f,v src/RCS/driv3.f,v
index c4dfdbc4..b19504ff 100644
--- src/RCS/driv3.f,v
+++ src/RCS/driv3.f,v
@@ -1,4 +1,4 @@
-head	1.37;
+head	1.38;
 access;
 symbols
 	pre_mrcs:1.37
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.38
+date	2025.11.10.22.32.31;	author dean;	state Exp;
+branches;
+next	1.37;
+
 1.37
 date	2018.10.03.14.34.05;	author leith;	state Exp;
 branches;
@@ -215,9 +220,9 @@ desc
 @
 
 
-1.37
+1.38
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -239,7 +244,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2015  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -425,6 +430,17 @@ C          SYMMETRY DOCUMENT FILE --------------------------------- SY
 @
 
 
+1.37
+log
+@email_health_dept
+@
+text
+@d20 1
+a20 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.36
 log
 @FCHAR(4:5) == 'FE'
diff --git src/RCS/dust.f,v src/RCS/dust.f,v
index 92dee241..8de5bc45 100644
--- src/RCS/dust.f,v
+++ src/RCS/dust.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.32.31;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.05;	author leith;	state Exp;
 branches;
@@ -85,9 +90,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -102,7 +107,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -205,6 +210,17 @@ C     SET STATISTICS TO UNDETERMINED
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @nx, output top & bot, etc
diff --git src/RCS/dvcr.f,v src/RCS/dvcr.f,v
index f30c80f3..84006c23 100644
--- src/RCS/dvcr.f,v
+++ src/RCS/dvcr.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.32.31;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.05;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -90,7 +95,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -129,6 +134,17 @@ C***********************************************************************
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/edge.f,v src/RCS/edge.f,v
index 3863db47..710d232b 100644
--- src/RCS/edge.f,v
+++ src/RCS/edge.f,v
@@ -1,4 +1,4 @@
-head	1.15;
+head	1.16;
 access;
 symbols
 	pre_mrcs:1.15
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.16
+date	2025.11.10.22.32.31;	author dean;	state Exp;
+branches;
+next	1.15;
+
 1.15
 date	2018.10.03.14.34.05;	author leith;	state Exp;
 branches;
@@ -105,9 +110,9 @@ desc
 @
 
 
-1.15
+1.16
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -123,7 +128,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -484,6 +489,17 @@ C       END LINE BY LINE LOOP
 @
 
 
+1.15
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.14
 log
 @GPL_2010
diff --git src/RCS/edm.f,v src/RCS/edm.f,v
index 04206d58..448e14b2 100644
--- src/RCS/edm.f,v
+++ src/RCS/edm.f,v
@@ -1,4 +1,4 @@
-head	1.12;
+head	1.13;
 access;
 symbols
 	pre_mrcs:1.12
@@ -21,6 +21,11 @@ locks; strict;
 comment	@c @;
 
 
+1.13
+date	2025.11.10.22.32.31;	author dean;	state Exp;
+branches;
+next	1.12;
+
 1.12
 date	2018.10.03.14.34.05;	author leith;	state Exp;
 branches;
@@ -86,9 +91,9 @@ desc
 @@
 
 
-1.12
+1.13
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -102,7 +107,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -351,6 +356,17 @@ C       OUTPUT VOLUME
 @
 
 
+1.12
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.11
 log
 @GPL_2010
diff --git src/RCS/eff.f,v src/RCS/eff.f,v
index acb94994..aa730a93 100644
--- src/RCS/eff.f,v
+++ src/RCS/eff.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.32.31;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.05;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -90,7 +95,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -120,6 +125,17 @@ C *********************************************************************C *******
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/ehist.f,v src/RCS/ehist.f,v
index 700c0bc7..103a5d5f 100644
--- src/RCS/ehist.f,v
+++ src/RCS/ehist.f,v
@@ -1,4 +1,4 @@
-head	1.12;
+head	1.13;
 access;
 symbols
 	pre_mrcs:1.12
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.13
+date	2025.11.10.22.32.31;	author dean;	state Exp;
+branches;
+next	1.12;
+
 1.12
 date	2018.10.03.14.34.05;	author leith;	state Exp;
 branches;
@@ -90,9 +95,9 @@ desc
 @
 
 
-1.12
+1.13
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -108,7 +113,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -226,6 +231,17 @@ C     PRINT HISTOGRAM IN RESULTS FILE IF DESIRED
 @
 
 
+1.12
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.11
 log
 @GPL_2010
diff --git src/RCS/eigpercent.f,v src/RCS/eigpercent.f,v
index cf987c3f..69ace132 100644
--- src/RCS/eigpercent.f,v
+++ src/RCS/eigpercent.f,v
@@ -1,4 +1,4 @@
-head	1.3;
+head	1.4;
 access;
 symbols
 	pre_mrcs:1.3
@@ -7,6 +7,11 @@ locks; strict;
 comment	@c @;
 
 
+1.4
+date	2025.11.10.22.32.31;	author dean;	state Exp;
+branches;
+next	1.3;
+
 1.3
 date	2018.10.03.14.34.05;	author leith;	state Exp;
 branches;
@@ -27,9 +32,9 @@ desc
 @@
 
 
-1.3
+1.4
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C **********************************************************************
@@ -42,7 +47,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2013  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -144,6 +149,17 @@ C       READ _EIG EIGEN VALUES & STORE IN DOC FILE
 @
 
 
+1.3
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.2
 log
 @nsel
diff --git src/RCS/empsli.f,v src/RCS/empsli.f,v
index 7e12cc61..92dd3606 100644
--- src/RCS/empsli.f,v
+++ src/RCS/empsli.f,v
@@ -1,4 +1,4 @@
-head	1.7;
+head	1.8;
 access;
 symbols
 	pre_mrcs:1.7
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.8
+date	2025.11.10.22.32.31;	author dean;	state Exp;
+branches;
+next	1.7;
+
 1.7
 date	2018.10.03.14.34.05;	author leith;	state Exp;
 branches;
@@ -65,9 +70,9 @@ desc
 @
 
 
-1.7
+1.8
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -81,7 +86,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -133,6 +138,17 @@ C--********************************************************************
 @
 
 
+1.7
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.6
 log
 @GPL_2010
diff --git src/RCS/endit.f,v src/RCS/endit.f,v
index fd3dd80e..3ad85be7 100644
--- src/RCS/endit.f,v
+++ src/RCS/endit.f,v
@@ -1,4 +1,4 @@
-head	1.17;
+head	1.18;
 access;
 symbols
 	pre_mrcs:1.17
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.18
+date	2025.11.10.22.32.31;	author dean;	state Exp;
+branches;
+next	1.17;
+
 1.17
 date	2018.10.03.14.34.05;	author leith;	state Exp;
 branches;
@@ -115,9 +120,9 @@ desc
 @
 
 
-1.17
+1.18
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -132,7 +137,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2012  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -210,6 +215,17 @@ C       STOP IS CALLED AFTER RETURN IN CALLER
 @
 
 
+1.17
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.16
 log
 @iostat needs integer on mac
diff --git src/RCS/ener.f,v src/RCS/ener.f,v
index 70c714a1..2090285d 100644
--- src/RCS/ener.f,v
+++ src/RCS/ener.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.32.31;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.05;	author leith;	state Exp;
 branches;
@@ -80,9 +85,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -96,7 +101,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -141,6 +146,17 @@ C --********************************************************************
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @GPL_2010
diff --git src/RCS/enfr_2.f,v src/RCS/enfr_2.f,v
index baa599e2..fdd7cf65 100644
--- src/RCS/enfr_2.f,v
+++ src/RCS/enfr_2.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.32.31;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.05;	author leith;	state Exp;
 branches;
@@ -85,9 +90,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -100,7 +105,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -159,6 +164,17 @@ C       ENERGY IN FOURIER SPACE
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @GPL_2010
diff --git src/RCS/enhanc.f,v src/RCS/enhanc.f,v
index eddbbf75..17ea4aca 100644
--- src/RCS/enhanc.f,v
+++ src/RCS/enhanc.f,v
@@ -1,4 +1,4 @@
-head	1.21;
+head	1.22;
 access;
 symbols
 	pre_mrcs:1.21
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.22
+date	2025.11.10.22.32.31;	author dean;	state Exp;
+branches;
+next	1.21;
+
 1.21
 date	2018.10.03.14.34.05;	author leith;	state Exp;
 branches;
@@ -135,9 +140,9 @@ desc
 @
 
 
-1.21
+1.22
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -154,7 +159,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2011  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -378,6 +383,17 @@ C     RESULT IS NORMALIZED BETWEEN 0. AND 2.
 @
 
 
+1.21
+log
+@email_health_dept
+@
+text
+@d15 1
+a15 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.20
 log
 @nbins capable (not used), 'A' query bug, formatting
diff --git src/RCS/entrop.f,v src/RCS/entrop.f,v
index 9e041088..4ebc799c 100644
--- src/RCS/entrop.f,v
+++ src/RCS/entrop.f,v
@@ -1,4 +1,4 @@
-head	1.7;
+head	1.8;
 access;
 symbols
 	pre_mrcs:1.7
@@ -20,6 +20,11 @@ locks; strict;
 comment	@c @;
 
 
+1.8
+date	2025.11.10.22.32.31;	author dean;	state Exp;
+branches;
+next	1.7;
+
 1.7
 date	2018.10.03.14.34.05;	author leith;	state Exp;
 branches;
@@ -60,9 +65,9 @@ desc
 @@
 
 
-1.7
+1.8
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -77,7 +82,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -216,6 +221,17 @@ C     FIND ENTROPY
 @
 
 
+1.7
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.6
 log
 @GPL_2010
diff --git src/RCS/envelope.f,v src/RCS/envelope.f,v
index 536061ac..e01aee09 100644
--- src/RCS/envelope.f,v
+++ src/RCS/envelope.f,v
@@ -1,4 +1,4 @@
-head	1.21;
+head	1.22;
 access;
 symbols
 	pre_mrcs:1.21
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.22
+date	2025.11.10.22.32.31;	author dean;	state Exp;
+branches;
+next	1.21;
+
 1.21
 date	2018.10.03.14.34.05;	author leith;	state Exp;
 branches;
@@ -135,9 +140,9 @@ desc
 @
 
 
-1.21
+1.22
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C **********************************************************************
@@ -151,7 +156,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -560,6 +565,17 @@ C	ENDDO
 @
 
 
+1.21
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.20
 log
 @CS_zero
diff --git src/RCS/epur4.f,v src/RCS/epur4.f,v
index 8047d33a..ef795657 100644
--- src/RCS/epur4.f,v
+++ src/RCS/epur4.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.32.31;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.05;	author leith;	state Exp;
 branches;
@@ -85,9 +90,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -105,7 +110,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -204,6 +209,17 @@ C            LOCATIONS SET TO: FRAME
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d16 1
+a16 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @klic buggy, cosmetic, formatting
diff --git src/RCS/erc.f,v src/RCS/erc.f,v
index 41575ead..1fdd4d88 100644
--- src/RCS/erc.f,v
+++ src/RCS/erc.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.32.32;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.05;	author leith;	state Exp;
 branches;
@@ -80,9 +85,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -95,7 +100,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -146,6 +151,17 @@ C       USED IN GNC2.FOR
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @GPL_2010
diff --git src/RCS/erosion.f,v src/RCS/erosion.f,v
index 8cb81fb0..0de8f9b3 100644
--- src/RCS/erosion.f,v
+++ src/RCS/erosion.f,v
@@ -1,4 +1,4 @@
-head	1.16;
+head	1.17;
 access;
 symbols
 	pre_mrcs:1.16
@@ -21,6 +21,11 @@ locks; strict;
 comment	@c @;
 
 
+1.17
+date	2025.11.10.22.32.32;	author dean;	state Exp;
+branches;
+next	1.16;
+
 1.16
 date	2018.10.03.14.34.05;	author leith;	state Exp;
 branches;
@@ -106,9 +111,9 @@ desc
 @@
 
 
-1.16
+1.17
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -125,7 +130,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -419,6 +424,17 @@ C             OUTPUT VOLUME LINE
 @
 
 
+1.16
+log
+@email_health_dept
+@
+text
+@d15 1
+a15 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.15
 log
 @removed buggy 'ER DOC'
diff --git src/RCS/errf2.f,v src/RCS/errf2.f,v
index 4f483f6a..cf924d29 100644
--- src/RCS/errf2.f,v
+++ src/RCS/errf2.f,v
@@ -1,4 +1,4 @@
-head	1.7;
+head	1.8;
 access;
 symbols
 	pre_mrcs:1.7
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.8
+date	2025.11.10.22.32.32;	author dean;	state Exp;
+branches;
+next	1.7;
+
 1.7
 date	2018.10.03.14.34.05;	author leith;	state Exp;
 branches;
@@ -65,9 +70,9 @@ desc
 @
 
 
-1.7
+1.8
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -82,7 +87,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -143,6 +148,17 @@ C--*********************************************************************
 @
 
 
+1.7
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.6
 log
 @GPL_2010
diff --git src/RCS/erri2.f,v src/RCS/erri2.f,v
index 8620ff63..a9ed2307 100644
--- src/RCS/erri2.f,v
+++ src/RCS/erri2.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.32.32;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.05;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -92,7 +97,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2018  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -160,6 +165,17 @@ C--*******************************************************************
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @immproved message
diff --git src/RCS/errt.f,v src/RCS/errt.f,v
index 6528d08b..7d32c53a 100644
--- src/RCS/errt.f,v
+++ src/RCS/errt.f,v
@@ -1,4 +1,4 @@
-head	1.62;
+head	1.63;
 access;
 symbols
 	pre_mrcs:1.62
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.63
+date	2025.11.10.22.32.32;	author dean;	state Exp;
+branches;
+next	1.62;
+
 1.62
 date	2018.10.03.14.34.05;	author leith;	state Exp;
 branches;
@@ -340,9 +345,9 @@ desc
 @
 
 
-1.62
+1.63
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -364,7 +369,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -676,6 +681,17 @@ C         PARAM(10) = 1.0
 @
 
 
+1.62
+log
+@email_health_dept
+@
+text
+@d20 1
+a20 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.61
 log
 @ifndef SP_GFORTRAN on ieee stuff
diff --git src/RCS/evalnq.f,v src/RCS/evalnq.f,v
index c702e25f..1100ea45 100644
--- src/RCS/evalnq.f,v
+++ src/RCS/evalnq.f,v
@@ -1,4 +1,4 @@
-head	1.25;
+head	1.26;
 access;
 symbols
 	pre_mrcs:1.25
@@ -25,6 +25,11 @@ locks; strict;
 comment	@c @;
 
 
+1.26
+date	2025.11.10.22.32.32;	author dean;	state Exp;
+branches;
+next	1.25;
+
 1.25
 date	2018.10.03.14.34.05;	author leith;	state Exp;
 branches;
@@ -156,9 +161,9 @@ desc
 @
 
 
-1.25
+1.26
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*************************************************** 12/11/79 1/11/81 VAX
@@ -173,7 +178,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -229,6 +234,17 @@ C       EVALUATE RPN EXPRESSION, PIXVAL IS NOT USED HERE
 @
 
 
+1.25
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.24
 log
 @GPL_2010
diff --git src/RCS/evalsympar.f,v src/RCS/evalsympar.f,v
index 5c556bec..f020bc13 100644
--- src/RCS/evalsympar.f,v
+++ src/RCS/evalsympar.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -22,6 +22,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.32.33;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.05;	author leith;	state Exp;
 branches;
@@ -72,9 +77,9 @@ desc
 @@
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -89,7 +94,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -180,6 +185,17 @@ C             WILL STOP IN ERRT IN FILNAMSUB IF THERE IS AN ERROR
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/express3q.f,v src/RCS/express3q.f,v
index 612c7bb2..241be27e 100644
--- src/RCS/express3q.f,v
+++ src/RCS/express3q.f,v
@@ -1,4 +1,4 @@
-head	1.14;
+head	1.15;
 access;
 symbols
 	pre_mrcs:1.14
@@ -25,6 +25,11 @@ locks; strict;
 comment	@c @;
 
 
+1.15
+date	2025.11.10.22.32.33;	author dean;	state Exp;
+branches;
+next	1.14;
+
 1.14
 date	2018.10.03.14.34.05;	author leith;	state Exp;
 branches;
@@ -101,9 +106,9 @@ desc
 @
 
 
-1.14
+1.15
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -123,7 +128,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -315,6 +320,17 @@ C     EXPRESSION FOUND OR RAN OFF END OF STRING
 @
 
 
+1.14
+log
+@email_health_dept
+@
+text
+@d18 1
+a18 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.13
 log
 @! COMMENT DELIMITER
diff --git src/RCS/exprq.f,v src/RCS/exprq.f,v
index 48ba5226..08481a20 100644
--- src/RCS/exprq.f,v
+++ src/RCS/exprq.f,v
@@ -1,4 +1,4 @@
-head	1.16;
+head	1.17;
 access;
 symbols
 	pre_mrcs:1.16
@@ -25,6 +25,11 @@ locks; strict;
 comment	@c @;
 
 
+1.17
+date	2025.11.10.22.32.33;	author dean;	state Exp;
+branches;
+next	1.16;
+
 1.16
 date	2018.10.03.14.34.05;	author leith;	state Exp;
 branches;
@@ -111,9 +116,9 @@ desc
 @
 
 
-1.16
+1.17
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -129,7 +134,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -196,6 +201,17 @@ C          IF NONE OF ABOVE APPLIES, HAVE TRUE ARITHMETIC EXPRESSION!
 @
 
 
+1.16
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.15
 log
 @detab
diff --git src/RCS/falb.f,v src/RCS/falb.f,v
index d6210b68..e8795e90 100644
--- src/RCS/falb.f,v
+++ src/RCS/falb.f,v
@@ -1,4 +1,4 @@
-head	1.36;
+head	1.37;
 access;
 symbols
 	pre_mrcs:1.36
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.37
+date	2025.11.10.22.32.33;	author dean;	state Exp;
+branches;
+next	1.36;
+
 1.36
 date	2018.10.03.14.34.05;	author leith;	state Exp;
 branches;
@@ -210,9 +215,9 @@ desc
 @
 
 
-1.36
+1.37
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -233,7 +238,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2012  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -624,6 +629,17 @@ C          CALCULATE DISTANCES
 @
 
 
+1.36
+log
+@email_health_dept
+@
+text
+@d19 1
+a19 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.35
 log
 @comment
diff --git src/RCS/fallg.f,v src/RCS/fallg.f,v
index 7482cbc6..8a4ea436 100644
--- src/RCS/fallg.f,v
+++ src/RCS/fallg.f,v
@@ -1,4 +1,4 @@
-head	1.4;
+head	1.5;
 access;
 symbols
 	pre_mrcs:1.4
@@ -20,6 +20,11 @@ locks; strict;
 comment	@c @;
 
 
+1.5
+date	2025.11.10.22.32.33;	author dean;	state Exp;
+branches;
+next	1.4;
+
 1.4
 date	2018.10.03.14.34.05;	author leith;	state Exp;
 branches;
@@ -46,9 +51,9 @@ desc
 @
 
 
-1.4
+1.5
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -56,7 +61,7 @@ C=**********************************************************************
 C=* From: SPIDER - MODULAR IMAGE PROCESSING SYSTEM                     *
 C=* Copyright (C)2000  M. Radermacher                                  *
 C=*                                                                    *
-C=* Email:  spider@@health.ny.gov                                       *
+C=* Email:  spider@@wadsworth.org                                       *
 C=*                                                                    *
 C=* This program is free software; you can redistribute it and/or      *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -84,6 +89,17 @@ C       CALCULATE GAUSSIAN, SIGMA=SX, A=AMPLITUDE
 @
 
 
+1.4
+log
+@email_health_dept
+@
+text
+@d6 1
+a6 1
+C=* Email:  spider@@health.ny.gov                                       *
+@
+
+
 1.3
 log
 @GPL License fixed
diff --git src/RCS/fbs2.f,v src/RCS/fbs2.f,v
index f9768bde..e08c9059 100644
--- src/RCS/fbs2.f,v
+++ src/RCS/fbs2.f,v
@@ -1,4 +1,4 @@
-head	1.13;
+head	1.14;
 access;
 symbols
 	pre_mrcs:1.13
@@ -7,6 +7,11 @@ locks; strict;
 comment	@c @;
 
 
+1.14
+date	2025.11.10.22.32.33;	author dean;	state Exp;
+branches;
+next	1.13;
+
 1.13
 date	2018.10.03.14.34.05;	author leith;	state Exp;
 branches;
@@ -77,9 +82,9 @@ desc
 @@
 
 
-1.13
+1.14
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C **********************************************************************
@@ -94,7 +99,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2012  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -332,6 +337,17 @@ C      REVERSE FFT
 @
 
 
+1.13
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.12
 log
 @WX DIM. BUG
diff --git src/RCS/fbs3.f,v src/RCS/fbs3.f,v
index deb8d3e1..c2f68510 100644
--- src/RCS/fbs3.f,v
+++ src/RCS/fbs3.f,v
@@ -1,4 +1,4 @@
-head	1.17;
+head	1.18;
 access;
 symbols
 	pre_mrcs:1.17
@@ -7,6 +7,11 @@ locks; strict;
 comment	@c @;
 
 
+1.18
+date	2025.11.10.22.32.33;	author dean;	state Exp;
+branches;
+next	1.17;
+
 1.17
 date	2018.10.03.14.34.05;	author leith;	state Exp;
 branches;
@@ -97,9 +102,9 @@ desc
 @@
 
 
-1.17
+1.18
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -114,7 +119,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2012  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NROW 12204.    *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -512,6 +517,17 @@ C      REVERSE FFT
 @
 
 
+1.17
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.16
 log
 @WX DIM. BUG       DEC 2012 Gregory Kishchenko *
diff --git src/RCS/fcnq.f,v src/RCS/fcnq.f,v
index 36e95197..c879da22 100644
--- src/RCS/fcnq.f,v
+++ src/RCS/fcnq.f,v
@@ -1,4 +1,4 @@
-head	1.12;
+head	1.13;
 access;
 symbols
 	pre_mrcs:1.12
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.13
+date	2025.11.10.22.32.33;	author dean;	state Exp;
+branches;
+next	1.12;
+
 1.12
 date	2018.10.03.14.34.05;	author leith;	state Exp;
 branches;
@@ -90,9 +95,9 @@ desc
 @
 
 
-1.12
+1.13
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -105,7 +110,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -240,6 +245,17 @@ C                   CHI=CHI+(XPO(IX,IY,IZ)-AVD)*(XPO(IX,IY,IZ)-AVD)
 @
 
 
+1.12
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.11
 log
 @updated
diff --git src/RCS/fermp.f,v src/RCS/fermp.f,v
index 321d944a..69955c97 100644
--- src/RCS/fermp.f,v
+++ src/RCS/fermp.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.32.33;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.05;	author leith;	state Exp;
 branches;
@@ -85,9 +90,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -101,7 +106,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -172,6 +177,17 @@ C***********************************************************************
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @GPL_2010
diff --git src/RCS/ffilts.f,v src/RCS/ffilts.f,v
index d7ee540d..c1d15d91 100644
--- src/RCS/ffilts.f,v
+++ src/RCS/ffilts.f,v
@@ -1,4 +1,4 @@
-head	1.32;
+head	1.33;
 access;
 symbols
 	pre_mrcs:1.32
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.33
+date	2025.11.10.22.32.33;	author dean;	state Exp;
+branches;
+next	1.32;
+
 1.32
 date	2018.10.03.14.34.05;	author leith;	state Exp;
 branches;
@@ -190,9 +195,9 @@ desc
 @
 
 
-1.32
+1.33
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*******************************************************************
@@ -210,7 +215,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -468,6 +473,17 @@ C          SAMPLED SPACE FILTER **************************************
 @
 
 
+1.32
+log
+@email_health_dept
+@
+text
+@d16 1
+a16 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.31
 log
 @butterworth location of bands altered
diff --git src/RCS/fftc_d.f,v src/RCS/fftc_d.f,v
index 84d9f51b..68674009 100644
--- src/RCS/fftc_d.f,v
+++ src/RCS/fftc_d.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.32.33;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.05;	author leith;	state Exp;
 branches;
@@ -80,9 +85,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -95,7 +100,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -275,6 +280,17 @@ C
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @GPL_2010
diff --git src/RCS/fftc_q.f,v src/RCS/fftc_q.f,v
index a20852cc..532e0a7c 100644
--- src/RCS/fftc_q.f,v
+++ src/RCS/fftc_q.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.32.33;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.34.05;	author leith;	state Exp;
 branches;
@@ -70,9 +75,9 @@ desc
 @
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -85,7 +90,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -259,6 +264,17 @@ C
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @GPL_2010
diff --git src/RCS/fftmcf.f,v src/RCS/fftmcf.f,v
index 312b26af..aadce5b5 100644
--- src/RCS/fftmcf.f,v
+++ src/RCS/fftmcf.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.32.33;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.05;	author leith;	state Exp;
 branches;
@@ -85,9 +90,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -100,7 +105,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -685,6 +690,17 @@ C
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @GPL_2010
diff --git src/RCS/fftr_d.f,v src/RCS/fftr_d.f,v
index 379ff348..ed50d327 100644
--- src/RCS/fftr_d.f,v
+++ src/RCS/fftr_d.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.32.33;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.05;	author leith;	state Exp;
 branches;
@@ -80,9 +85,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -95,7 +100,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -209,6 +214,17 @@ C
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @GPL_2010
diff --git src/RCS/fftr_q.f,v src/RCS/fftr_q.f,v
index d3ee0c60..874ce018 100644
--- src/RCS/fftr_q.f,v
+++ src/RCS/fftr_q.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.32.33;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.05;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -90,7 +95,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -198,6 +203,17 @@ C
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/fftw3.f,v src/RCS/fftw3.f,v
index c5d4bdff..be7a1f4f 100644
--- src/RCS/fftw3.f,v
+++ src/RCS/fftw3.f,v
@@ -1,4 +1,4 @@
-head	1.18;
+head	1.19;
 access;
 symbols
 	pre_mrcs:1.18
@@ -12,6 +12,11 @@ locks; strict;
 comment	@c @;
 
 
+1.19
+date	2025.11.10.22.32.33;	author dean;	state Exp;
+branches;
+next	1.18;
+
 1.18
 date	2018.10.03.14.34.05;	author leith;	state Exp;
 branches;
@@ -107,9 +112,9 @@ desc
 @@
 
 
-1.18
+1.19
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -127,7 +132,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -639,6 +644,17 @@ C          IF (VERBOSE) WRITE(NOUT,92) NUMFFTWTH
 @
 
 
+1.18
+log
+@email_health_dept
+@
+text
+@d16 1
+a16 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.17
 log
 @output msg formatting I0,  nx
diff --git src/RCS/fgr.f,v src/RCS/fgr.f,v
index 4340b3ac..bca6e8a8 100644
--- src/RCS/fgr.f,v
+++ src/RCS/fgr.f,v
@@ -1,4 +1,4 @@
-head	1.13;
+head	1.14;
 access;
 symbols
 	pre_mrcs:1.13
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.14
+date	2025.11.10.22.32.33;	author dean;	state Exp;
+branches;
+next	1.13;
+
 1.13
 date	2018.10.03.14.34.05;	author leith;	state Exp;
 branches;
@@ -95,9 +100,9 @@ desc
 @
 
 
-1.13
+1.14
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -110,7 +115,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -275,6 +280,17 @@ C      CALL  WRTXT( IBI,8,52,15,3)
 @
 
 
+1.13
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.12
 log
 @GPL_2010
diff --git src/RCS/fhodt.f,v src/RCS/fhodt.f,v
index e5a97b1a..5c0b2c55 100644
--- src/RCS/fhodt.f,v
+++ src/RCS/fhodt.f,v
@@ -1,4 +1,4 @@
-head	1.14;
+head	1.15;
 access;
 symbols
 	pre_mrcs:1.14
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.15
+date	2025.11.10.22.32.34;	author dean;	state Exp;
+branches;
+next	1.14;
+
 1.14
 date	2018.10.03.14.34.05;	author leith;	state Exp;
 branches;
@@ -100,9 +105,9 @@ desc
 @
 
 
-1.14
+1.15
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -115,7 +120,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -177,6 +182,17 @@ C       AVR is "-average"
 @
 
 
+1.14
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.13
 log
 @GPL_2010
diff --git src/RCS/filcad.f,v src/RCS/filcad.f,v
index a4478ba6..542b13ae 100644
--- src/RCS/filcad.f,v
+++ src/RCS/filcad.f,v
@@ -1,4 +1,4 @@
-head	1.12;
+head	1.13;
 access;
 symbols
 	pre_mrcs:1.12
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.13
+date	2025.11.10.22.32.34;	author dean;	state Exp;
+branches;
+next	1.12;
+
 1.12
 date	2018.10.03.14.34.05;	author leith;	state Exp;
 branches;
@@ -90,9 +95,9 @@ desc
 @
 
 
-1.12
+1.13
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -107,7 +112,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -185,6 +190,17 @@ C       GO BACKWARDS THRU FILENAME TO LOCATE DIGITS
 @
 
 
+1.12
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.11
 log
 @modernized
diff --git src/RCS/filcan.f,v src/RCS/filcan.f,v
index 23b7bfae..5d894f21 100644
--- src/RCS/filcan.f,v
+++ src/RCS/filcan.f,v
@@ -1,4 +1,4 @@
-head	1.16;
+head	1.17;
 access;
 symbols
 	pre_mrcs:1.16
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.17
+date	2025.11.10.22.32.34;	author dean;	state Exp;
+branches;
+next	1.16;
+
 1.16
 date	2018.10.03.14.34.05;	author leith;	state Exp;
 branches;
@@ -110,9 +115,9 @@ desc
 @
 
 
-1.16
+1.17
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -128,7 +133,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -257,6 +262,17 @@ C       NORMAL RETURN
 @
 
 
+1.16
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.15
 log
 @(LEN=MAXNAM) :: MASTMP
diff --git src/RCS/filelist.f,v src/RCS/filelist.f,v
index a4cf3de3..ed6e1609 100644
--- src/RCS/filelist.f,v
+++ src/RCS/filelist.f,v
@@ -1,4 +1,4 @@
-head	1.21;
+head	1.22;
 access;
 symbols
 	pre_mrcs:1.21
@@ -23,6 +23,11 @@ locks; strict;
 comment	@c @;
 
 
+1.22
+date	2025.11.10.22.32.34;	author dean;	state Exp;
+branches;
+next	1.21;
+
 1.21
 date	2018.10.03.14.34.05;	author leith;	state Exp;
 branches;
@@ -133,9 +138,9 @@ desc
 @@
 
 
-1.21
+1.22
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -154,7 +159,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -539,6 +544,17 @@ C           CHAR. (A..Z) SAYS STRING MAY BE A FILE NAME ?
 @
 
 
+1.21
+log
+@email_health_dept
+@
+text
+@d17 1
+a17 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.20
 log
 @removed: ENTER
diff --git src/RCS/filgen.f,v src/RCS/filgen.f,v
index bf618799..e2ef2743 100644
--- src/RCS/filgen.f,v
+++ src/RCS/filgen.f,v
@@ -1,4 +1,4 @@
-head	1.12;
+head	1.13;
 access;
 symbols
 	pre_mrcs:1.12
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.13
+date	2025.11.10.22.32.34;	author dean;	state Exp;
+branches;
+next	1.12;
+
 1.12
 date	2018.10.03.14.34.05;	author leith;	state Exp;
 branches;
@@ -90,9 +95,9 @@ desc
 @
 
 
-1.12
+1.13
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -107,7 +112,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -204,6 +209,17 @@ C               STOP AFTER 10 NON-EXISTING FILES
 @
 
 
+1.12
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.11
 log
 @GPL_2010
diff --git src/RCS/filget.f,v src/RCS/filget.f,v
index e315c1b0..8612528f 100644
--- src/RCS/filget.f,v
+++ src/RCS/filget.f,v
@@ -1,4 +1,4 @@
-head	1.18;
+head	1.19;
 access;
 symbols
 	pre_mrcs:1.18
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.19
+date	2025.11.10.22.33.57;	author dean;	state Exp;
+branches;
+next	1.18;
+
 1.18
 date	2018.10.03.14.34.06;	author leith;	state Exp;
 branches;
@@ -120,9 +125,9 @@ desc
 @
 
 
-1.18
+1.19
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -139,7 +144,6 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2011  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -299,6 +303,16 @@ C       FIND 1ST CHAR IN FILNAM THAT WILL BE ALTERED
 @
 
 
+1.18
+log
+@email_health_dept
+@
+text
+@a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.17
 log
 @NAME@@* SUB improved
diff --git src/RCS/filget_at.f,v src/RCS/filget_at.f,v
index a7f156a0..0b116e0e 100644
--- src/RCS/filget_at.f,v
+++ src/RCS/filget_at.f,v
@@ -1,10 +1,15 @@
-head	1.1;
+head	1.2;
 access;
 symbols;
 locks; strict;
 comment	@c @;
 
 
+1.2
+date	2025.09.21.15.05.08;	author dean;	state Exp;
+branches;
+next	1.1;
+
 1.1
 date	2019.11.04.17.35.01;	author leith;	state Exp;
 branches;
@@ -15,9 +20,9 @@ desc
 @@
 
 
-1.1
+1.2
 log
-@mrc_support
+@C     ???@@STK.MRC or aaa/???@@STK.MRC   ! GFORT DID NOT ACCEPT * HERE
 @
 text
 @C++*********************************************************************
@@ -30,7 +35,6 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2011  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -78,7 +82,7 @@ C
 C     APPEND IMAGE NUMBER TO BARE STACK FILE NAME
 C     (INTTOCHAR ALSO RETURNS NEW VALUE FOR NLET)
 C
-C     ***@@STK.MRC or aaa/***@@STK.MRC
+C     ???@@STK.MRC or aaa/???@@STK.MRC   ! GFORT DID NOT ACCEPT * HERE Sept 2025
 C        @@STK.MRC or aaa/@@STK.MRC
 C         IMG***.MRC ??
 
@@ -131,3 +135,16 @@ C       BARE STACK:  @@STK.MRC
 
 
 @
+
+
+1.1
+log
+@mrc_support
+@
+text
+@a10 1
+C=* Email: spider@@health.ny.gov                                        *
+d58 1
+a58 1
+C     ***@@STK.MRC or aaa/***@@STK.MRC
+@
diff --git src/RCS/fillbessi0.f,v src/RCS/fillbessi0.f,v
index a6654ead..da4a67f5 100644
--- src/RCS/fillbessi0.f,v
+++ src/RCS/fillbessi0.f,v
@@ -1,4 +1,4 @@
-head	1.6;
+head	1.7;
 access;
 symbols
 	pre_mrcs:1.6
@@ -12,6 +12,11 @@ locks; strict;
 comment	@c @;
 
 
+1.7
+date	2025.11.10.22.32.34;	author dean;	state Exp;
+branches;
+next	1.6;
+
 1.6
 date	2018.10.03.14.34.06;	author leith;	state Exp;
 branches;
@@ -47,9 +52,9 @@ desc
 @@
 
 
-1.6
+1.7
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @ 
@@ -64,7 +69,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -173,6 +178,17 @@ cc$omp  parallel do private(i,s,xt)
 @
 
 
+1.6
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.5
 log
 @comment on nnn was wrong
diff --git src/RCS/filnamandext.f,v src/RCS/filnamandext.f,v
index 5846d812..904e6828 100644
--- src/RCS/filnamandext.f,v
+++ src/RCS/filnamandext.f,v
@@ -1,4 +1,4 @@
-head	1.6;
+head	1.7;
 access;
 symbols
 	pre_mrcs:1.6
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.7
+date	2025.11.10.22.32.35;	author dean;	state Exp;
+branches;
+next	1.6;
+
 1.6
 date	2018.10.03.14.34.06;	author leith;	state Exp;
 branches;
@@ -60,9 +65,9 @@ desc
 @
 
 
-1.6
+1.7
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -76,7 +81,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -168,6 +173,17 @@ C          ADD FILENAME EXTENSION TO FILOUT
 @
 
 
+1.6
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.5
 log
 @GPL_2010
diff --git src/RCS/filnamsub.f,v src/RCS/filnamsub.f,v
index b693b566..ff1091d7 100644
--- src/RCS/filnamsub.f,v
+++ src/RCS/filnamsub.f,v
@@ -1,4 +1,4 @@
-head	1.36;
+head	1.37;
 access;
 symbols
 	pre_mrcs:1.36
@@ -25,6 +25,11 @@ locks; strict;
 comment	@c @;
 
 
+1.37
+date	2025.11.10.22.32.35;	author dean;	state Exp;
+branches;
+next	1.36;
+
 1.36
 date	2018.10.03.14.34.06;	author leith;	state Exp;
 branches;
@@ -210,9 +215,9 @@ desc
 @@
 
 
-1.36
+1.37
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -240,7 +245,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2015  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -714,6 +719,17 @@ C        SEE IF ANY MORE SUBSTITUTIONS ARE NEEDED
 @
 
 
+1.36
+log
+@email_health_dept
+@
+text
+@d26 1
+a26 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.35
 log
 @CVAL = adjustl(CVAL) for removing extra blank in %% output line
diff --git src/RCS/filseqp.f,v src/RCS/filseqp.f,v
index 67b3b5c1..3230ca42 100644
--- src/RCS/filseqp.f,v
+++ src/RCS/filseqp.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.32.35;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.06;	author leith;	state Exp;
 branches;
@@ -80,9 +85,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -96,7 +101,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -179,6 +184,17 @@ C          SET NUM TO NMAX FOR NUMBER OF FILES ALLOWED
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @enter
diff --git src/RCS/filsli.f,v src/RCS/filsli.f,v
index 3b0c518c..fef14955 100644
--- src/RCS/filsli.f,v
+++ src/RCS/filsli.f,v
@@ -1,4 +1,4 @@
-head	1.7;
+head	1.8;
 access;
 symbols
 	pre_mrcs:1.7
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.8
+date	2025.11.10.22.32.35;	author dean;	state Exp;
+branches;
+next	1.7;
+
 1.7
 date	2018.10.03.14.34.06;	author leith;	state Exp;
 branches;
@@ -65,9 +70,9 @@ desc
 @
 
 
-1.7
+1.8
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -81,7 +86,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -155,6 +160,17 @@ C                 VOXEL IS ABOVE THRESHOLD
 @
 
 
+1.7
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.6
 log
 @GPL_2010
diff --git src/RCS/filtdoc.f,v src/RCS/filtdoc.f,v
index a58c9aa4..25b15fa1 100644
--- src/RCS/filtdoc.f,v
+++ src/RCS/filtdoc.f,v
@@ -1,4 +1,4 @@
-head	1.33;
+head	1.34;
 access;
 symbols
 	pre_mrcs:1.33
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.34
+date	2025.11.10.22.32.35;	author dean;	state Exp;
+branches;
+next	1.33;
+
 1.33
 date	2018.10.03.14.34.06;	author leith;	state Exp;
 branches;
@@ -195,9 +200,9 @@ desc
 @
 
 
-1.33
+1.34
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -217,7 +222,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -376,6 +381,17 @@ C       DEALLOCATE RUN-TIME MEMORY
 @
 
 
+1.33
+log
+@email_health_dept
+@
+text
+@d18 1
+a18 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.32
 log
 @operation 'C' bug fixed
diff --git src/RCS/filter_har.f,v src/RCS/filter_har.f,v
index 99f158af..95b79efa 100644
--- src/RCS/filter_har.f,v
+++ src/RCS/filter_har.f,v
@@ -1,4 +1,4 @@
-head	1.12;
+head	1.13;
 access;
 symbols
 	pre_mrcs:1.12
@@ -21,6 +21,11 @@ locks; strict;
 comment	@c @;
 
 
+1.13
+date	2025.11.10.22.32.35;	author dean;	state Exp;
+branches;
+next	1.12;
+
 1.12
 date	2018.10.03.14.34.06;	author leith;	state Exp;
 branches;
@@ -86,9 +91,9 @@ desc
 @@
 
 
-1.12
+1.13
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -101,7 +106,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -376,6 +381,17 @@ C     CONVERSION FACTOR FROM FLOATING POINT TO INTEGER RANGE
 @
 
 
+1.12
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.11
 log
 @GPL_2010
diff --git src/RCS/filtplot.f,v src/RCS/filtplot.f,v
index 4663159f..2ab56a2f 100644
--- src/RCS/filtplot.f,v
+++ src/RCS/filtplot.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.32.35;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.06;	author leith;	state Exp;
 branches;
@@ -80,9 +85,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -95,7 +100,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -145,6 +150,17 @@ C--*******************************************************************
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @input prompt format
diff --git src/RCS/findcent.f,v src/RCS/findcent.f,v
index dfd6c047..bfa0ee55 100644
--- src/RCS/findcent.f,v
+++ src/RCS/findcent.f,v
@@ -1,4 +1,4 @@
-head	1.32;
+head	1.33;
 access;
 symbols
 	pre_mrcs:1.32
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.33
+date	2025.11.10.22.32.35;	author dean;	state Exp;
+branches;
+next	1.32;
+
 1.32
 date	2018.10.03.14.34.06;	author leith;	state Exp;
 branches;
@@ -190,9 +195,9 @@ desc
 @
 
 
-1.32
+1.33
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C **********************************************************************
@@ -206,7 +211,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2016  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -374,6 +379,17 @@ C           VOLUME ------------------------------------------- VOLUME
 @
 
 
+1.32
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.31
 log
 @does not work on vols
diff --git src/RCS/findfilcen.f,v src/RCS/findfilcen.f,v
index e063643f..86997b2b 100644
--- src/RCS/findfilcen.f,v
+++ src/RCS/findfilcen.f,v
@@ -1,4 +1,4 @@
-head	1.2;
+head	1.3;
 access;
 symbols
 	pre_mrcs:1.2
@@ -7,6 +7,11 @@ locks; strict;
 comment	@c @;
 
 
+1.3
+date	2025.11.10.22.32.35;	author dean;	state Exp;
+branches;
+next	1.2;
+
 1.2
 date	2018.10.03.14.34.06;	author leith;	state Exp;
 branches;
@@ -22,9 +27,9 @@ desc
 @@
 
 
-1.2
+1.3
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*******************************************************************
@@ -37,7 +42,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -97,6 +102,17 @@ C--*******************************************************************
 @
 
 
+1.2
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.1
 log
 @Initial revision
diff --git src/RCS/findfrq.f,v src/RCS/findfrq.f,v
index f0d8bb29..7575806d 100644
--- src/RCS/findfrq.f,v
+++ src/RCS/findfrq.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.32.35;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.34.06;	author leith;	state Exp;
 branches;
@@ -70,9 +75,9 @@ desc
 @
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -86,7 +91,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -183,6 +188,17 @@ C***********************************************************************
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @GPL_2010
diff --git src/RCS/findlbq.f,v src/RCS/findlbq.f,v
index d0196064..f56da570 100644
--- src/RCS/findlbq.f,v
+++ src/RCS/findlbq.f,v
@@ -1,4 +1,4 @@
-head	1.36;
+head	1.37;
 access;
 symbols
 	pre_mrcs:1.36
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.37
+date	2025.11.10.22.32.35;	author dean;	state Exp;
+branches;
+next	1.36;
+
 1.36
 date	2018.10.03.14.34.06;	author leith;	state Exp;
 branches;
@@ -210,9 +215,9 @@ desc
 @
 
 
-1.36
+1.37
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -238,7 +243,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2015  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -656,6 +661,17 @@ C       SIMULATE ECHO OF OPERATION TO RESULTS FILE
 @
 
 
+1.36
+log
+@email_health_dept
+@
+text
+@d24 1
+a24 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.35
 log
 @GOTO LB WITHIN LOOP BUG
diff --git src/RCS/findminsormaxs.f,v src/RCS/findminsormaxs.f,v
index e488fe70..d19b4634 100644
--- src/RCS/findminsormaxs.f,v
+++ src/RCS/findminsormaxs.f,v
@@ -1,4 +1,4 @@
-head	1.4;
+head	1.5;
 access;
 symbols
 	pre_mrcs:1.4
@@ -7,6 +7,11 @@ locks; strict;
 comment	@c @;
 
 
+1.5
+date	2025.11.10.22.32.35;	author dean;	state Exp;
+branches;
+next	1.4;
+
 1.4
 date	2018.10.03.14.34.06;	author leith;	state Exp;
 branches;
@@ -32,9 +37,9 @@ desc
 @@
 
 
-1.4
+1.5
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C **********************************************************************
@@ -47,7 +52,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -392,6 +397,17 @@ C                FOUND A MIN (MAY BE AT INITIAL POINT)
 
 
 
+@
+
+
+1.4
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
 @
 
 
diff --git src/RCS/findmx.f,v src/RCS/findmx.f,v
index 127b8920..a14df48e 100644
--- src/RCS/findmx.f,v
+++ src/RCS/findmx.f,v
@@ -1,4 +1,4 @@
-head	1.15;
+head	1.16;
 access;
 symbols
 	pre_mrcs:1.15
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.16
+date	2025.11.10.22.32.35;	author dean;	state Exp;
+branches;
+next	1.15;
+
 1.15
 date	2018.10.03.14.34.06;	author leith;	state Exp;
 branches;
@@ -105,9 +110,9 @@ desc
 @
 
 
-1.15
+1.16
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -120,7 +125,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -183,6 +188,17 @@ C***********************************************************************
 @
 
 
+1.15
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.14
 log
 @GPL_2010
diff --git src/RCS/findmx_f.f,v src/RCS/findmx_f.f,v
index 612f50e7..5621fb13 100644
--- src/RCS/findmx_f.f,v
+++ src/RCS/findmx_f.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.32.35;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.06;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -90,7 +95,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -150,6 +155,17 @@ C
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/findmx_q.f,v src/RCS/findmx_q.f,v
index 09ccee37..f868d1b9 100644
--- src/RCS/findmx_q.f,v
+++ src/RCS/findmx_q.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.32.35;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.06;	author leith;	state Exp;
 branches;
@@ -74,9 +79,9 @@ desc
 @@
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -89,7 +94,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2017  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -154,6 +159,17 @@ C--*********************************************************************
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @cosmetic, nrow, peakv renamed
diff --git src/RCS/findridges.f,v src/RCS/findridges.f,v
index fd75a423..0a74fc3f 100644
--- src/RCS/findridges.f,v
+++ src/RCS/findridges.f,v
@@ -1,4 +1,4 @@
-head	1.16;
+head	1.17;
 access;
 symbols
 	pre_mrcs:1.16
@@ -7,6 +7,11 @@ locks; strict;
 comment	@c @;
 
 
+1.17
+date	2025.11.10.22.32.35;	author dean;	state Exp;
+branches;
+next	1.16;
+
 1.16
 date	2018.10.03.14.34.06;	author leith;	state Exp;
 branches;
@@ -92,9 +97,9 @@ desc
 @@
 
 
-1.16
+1.17
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C **********************************************************************
@@ -109,7 +114,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2016 Health Research Inc.,                          *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -548,6 +553,17 @@ C                FOUND A MIN (MAY BE AT INITIAL POINT)
 
 
 
+@
+
+
+1.16
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
 @
 
 
diff --git src/RCS/fint.f,v src/RCS/fint.f,v
index eeac4e77..cd845998 100644
--- src/RCS/fint.f,v
+++ src/RCS/fint.f,v
@@ -1,4 +1,4 @@
-head	1.18;
+head	1.19;
 access;
 symbols
 	pre_mrcs:1.18
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.19
+date	2025.11.10.22.32.35;	author dean;	state Exp;
+branches;
+next	1.18;
+
 1.18
 date	2018.10.03.14.34.06;	author leith;	state Exp;
 branches;
@@ -120,9 +125,9 @@ desc
 @
 
 
-1.18
+1.19
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -135,7 +140,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -229,6 +234,17 @@ C       ELEMENT.
 @
 
 
+1.18
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.17
 log
 @GPL_2010
diff --git src/RCS/fint3.f,v src/RCS/fint3.f,v
index c5d86231..c2b42f3c 100644
--- src/RCS/fint3.f,v
+++ src/RCS/fint3.f,v
@@ -1,4 +1,4 @@
-head	1.13;
+head	1.14;
 access;
 symbols
 	pre_mrcs:1.13
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.14
+date	2025.11.10.22.32.35;	author dean;	state Exp;
+branches;
+next	1.13;
+
 1.13
 date	2018.10.03.14.34.06;	author leith;	state Exp;
 branches;
@@ -95,9 +100,9 @@ desc
 @
 
 
-1.13
+1.14
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -110,7 +115,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -250,6 +255,17 @@ C       ELEMENT.
 @
 
 
+1.13
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.12
 log
 @GPL_2010
diff --git src/RCS/fitt.f,v src/RCS/fitt.f,v
index e1198897..0b047d8b 100644
--- src/RCS/fitt.f,v
+++ src/RCS/fitt.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.32.35;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.06;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -90,7 +95,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -161,6 +166,17 @@ C***********************************************************************
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/flushfile.f,v src/RCS/flushfile.f,v
index 7823bc41..a165613b 100644
--- src/RCS/flushfile.f,v
+++ src/RCS/flushfile.f,v
@@ -1,4 +1,4 @@
-head	1.6;
+head	1.7;
 access;
 symbols
 	pre_mrcs:1.6
@@ -20,6 +20,11 @@ locks; strict;
 comment	@c @;
 
 
+1.7
+date	2025.11.10.22.32.35;	author dean;	state Exp;
+branches;
+next	1.6;
+
 1.6
 date	2018.10.03.14.34.06;	author leith;	state Exp;
 branches;
@@ -56,9 +61,9 @@ desc
 @
 
 
-1.6
+1.7
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -73,7 +78,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -114,6 +119,17 @@ C       IRIX & GNU-Linux
 @
 
 
+1.6
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.5
 log
 @GPL_2010
diff --git src/RCS/flushresults.f,v src/RCS/flushresults.f,v
index 22892404..dd11e20a 100644
--- src/RCS/flushresults.f,v
+++ src/RCS/flushresults.f,v
@@ -1,4 +1,4 @@
-head	1.22;
+head	1.23;
 access;
 symbols
 	pre_mrcs:1.22
@@ -21,6 +21,11 @@ locks; strict;
 comment	@c @;
 
 
+1.23
+date	2025.11.10.22.32.35;	author dean;	state Exp;
+branches;
+next	1.22;
+
 1.22
 date	2018.10.03.14.34.06;	author leith;	state Exp;
 branches;
@@ -136,9 +141,9 @@ desc
 @@
 
 
-1.22
+1.23
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -155,7 +160,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2013  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -239,6 +244,17 @@ C***********************************************************************
 @
 
 
+1.22
+log
+@email_health_dept
+@
+text
+@d15 1
+a15 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.21
 log
 @flushresults_q  quiet
diff --git src/RCS/fmax_c.f,v src/RCS/fmax_c.f,v
index eb78c71d..318e2424 100644
--- src/RCS/fmax_c.f,v
+++ src/RCS/fmax_c.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.32.35;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.06;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -91,7 +96,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -129,6 +134,17 @@ C***********************************************************************
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/fmax_q.f,v src/RCS/fmax_q.f,v
index e82ed235..7844d6b4 100644
--- src/RCS/fmax_q.f,v
+++ src/RCS/fmax_q.f,v
@@ -1,4 +1,4 @@
-head	1.13;
+head	1.14;
 access;
 symbols
 	pre_mrcs:1.13
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.14
+date	2025.11.10.22.32.35;	author dean;	state Exp;
+branches;
+next	1.13;
+
 1.13
 date	2018.10.03.14.34.06;	author leith;	state Exp;
 branches;
@@ -95,9 +100,9 @@ desc
 @
 
 
-1.13
+1.14
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -111,7 +116,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -155,6 +160,17 @@ c$omp parallel do private(i),reduction(max:xmax)
 @
 
 
+1.13
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.12
 log
 @GPL_2010
diff --git src/RCS/fmax_s.f,v src/RCS/fmax_s.f,v
index 353e7be1..7d08afe7 100644
--- src/RCS/fmax_s.f,v
+++ src/RCS/fmax_s.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.32.35;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.06;	author leith;	state Exp;
 branches;
@@ -80,9 +85,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -96,7 +101,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -148,6 +153,17 @@ c$omp parallel do  private(i),schedule(static)
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @GPL_2010
diff --git src/RCS/fmin_c.f,v src/RCS/fmin_c.f,v
index b12be7e1..ce1643c9 100644
--- src/RCS/fmin_c.f,v
+++ src/RCS/fmin_c.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.32.35;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.34.06;	author leith;	state Exp;
 branches;
@@ -70,9 +75,9 @@ desc
 @
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -86,7 +91,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -124,6 +129,17 @@ C***********************************************************************
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @GPL_2010
diff --git src/RCS/fmin_q.f,v src/RCS/fmin_q.f,v
index 597fc3c9..30ac5fae 100644
--- src/RCS/fmin_q.f,v
+++ src/RCS/fmin_q.f,v
@@ -1,4 +1,4 @@
-head	1.12;
+head	1.13;
 access;
 symbols
 	pre_mrcs:1.12
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.13
+date	2025.11.10.22.32.35;	author dean;	state Exp;
+branches;
+next	1.12;
+
 1.12
 date	2018.10.03.14.34.06;	author leith;	state Exp;
 branches;
@@ -90,9 +95,9 @@ desc
 @
 
 
-1.12
+1.13
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -106,7 +111,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -148,6 +153,17 @@ c$omp parallel do private(i),reduction(min:xmin)
 @
 
 
+1.12
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.11
 log
 @GPL_2010
diff --git src/RCS/fmin_s.f,v src/RCS/fmin_s.f,v
index 1d326980..1cc3f116 100644
--- src/RCS/fmin_s.f,v
+++ src/RCS/fmin_s.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.32.35;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.06;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -91,7 +96,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -143,6 +148,17 @@ c$omp parallel do  private(i),schedule(static)
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/fmr_1.f,v src/RCS/fmr_1.f,v
index 0ff67ba7..bbd95d5a 100644
--- src/RCS/fmr_1.f,v
+++ src/RCS/fmr_1.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.32.35;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.06;	author leith;	state Exp;
 branches;
@@ -80,9 +85,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -95,7 +100,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -186,6 +191,17 @@ C INV CAN BE +1 (FORWARD FFT) OR -1 (INVERSE FFT)
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @GPL_2010
diff --git src/RCS/fmr_2.f,v src/RCS/fmr_2.f,v
index 039a6be9..283a0d59 100644
--- src/RCS/fmr_2.f,v
+++ src/RCS/fmr_2.f,v
@@ -1,4 +1,4 @@
-head	1.19;
+head	1.20;
 access;
 symbols
 	pre_mrcs:1.19
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.20
+date	2025.11.10.22.32.36;	author dean;	state Exp;
+branches;
+next	1.19;
+
 1.19
 date	2018.10.03.14.34.06;	author leith;	state Exp;
 branches;
@@ -125,9 +130,9 @@ desc
 @
 
 
-1.19
+1.20
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -140,7 +145,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -261,6 +266,17 @@ c$omp   parallel do  private(i,work),shared(invt)
 @
 
 
+1.19
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.18
 log
 @cosmetic and comments
diff --git src/RCS/fmrs.f,v src/RCS/fmrs.f,v
index 31835061..dd1b936d 100644
--- src/RCS/fmrs.f,v
+++ src/RCS/fmrs.f,v
@@ -1,4 +1,4 @@
-head	1.19;
+head	1.20;
 access;
 symbols
 	pre_mrcs:1.19
@@ -12,6 +12,11 @@ locks; strict;
 comment	@c @;
 
 
+1.20
+date	2025.11.10.22.32.36;	author dean;	state Exp;
+branches;
+next	1.19;
+
 1.19
 date	2018.10.03.14.34.06;	author leith;	state Exp;
 branches;
@@ -112,9 +117,9 @@ desc
 @@
 
 
-1.19
+1.20
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -133,7 +138,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2012  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -641,6 +646,17 @@ C               SIZE OR THREADING CHANGED, CREATE NEW FORWARD PLAN
 @
 
 
+1.19
+log
+@email_health_dept
+@
+text
+@d17 1
+a17 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.18
 log
 @comment
diff --git src/RCS/fmrs_1.f,v src/RCS/fmrs_1.f,v
index 5e068d13..e457fb93 100644
--- src/RCS/fmrs_1.f,v
+++ src/RCS/fmrs_1.f,v
@@ -1,4 +1,4 @@
-head	1.29;
+head	1.30;
 access;
 symbols
 	pre_mrcs:1.29
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.30
+date	2025.11.10.22.32.36;	author dean;	state Exp;
+branches;
+next	1.29;
+
 1.29
 date	2018.10.03.14.34.06;	author leith;	state Exp;
 branches;
@@ -175,9 +180,9 @@ desc
 @
 
 
-1.29
+1.30
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -193,7 +198,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -242,6 +247,17 @@ C--*********************************************************************
 @
 
 
+1.29
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.28
 log
 @GPL_2010
diff --git src/RCS/fmrs_1d.f,v src/RCS/fmrs_1d.f,v
index 2f41334d..1f40412a 100644
--- src/RCS/fmrs_1d.f,v
+++ src/RCS/fmrs_1d.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.32.36;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.34.06;	author leith;	state Exp;
 branches;
@@ -69,9 +74,9 @@ desc
 @@
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -84,7 +89,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -162,6 +167,17 @@ C  GET OLD FORMAT
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @GPL_2010
diff --git src/RCS/fmrs_2.f,v src/RCS/fmrs_2.f,v
index c9d04472..5c6cdc48 100644
--- src/RCS/fmrs_2.f,v
+++ src/RCS/fmrs_2.f,v
@@ -1,4 +1,4 @@
-head	1.43;
+head	1.44;
 access;
 symbols
 	pre_mrcs:1.43
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.44
+date	2025.11.10.22.32.36;	author dean;	state Exp;
+branches;
+next	1.43;
+
 1.43
 date	2018.10.03.14.34.06;	author leith;	state Exp;
 branches;
@@ -245,9 +250,9 @@ desc
 @
 
 
-1.43
+1.44
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -262,7 +267,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -317,6 +322,17 @@ C--*********************************************************************
 @
 
 
+1.43
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.42
 log
 @GPL_2010
diff --git src/RCS/fmrs_2dr.f,v src/RCS/fmrs_2dr.f,v
index 1c9c2770..113a4b43 100644
--- src/RCS/fmrs_2dr.f,v
+++ src/RCS/fmrs_2dr.f,v
@@ -1,4 +1,4 @@
-head	1.12;
+head	1.13;
 access;
 symbols
 	pre_mrcs:1.12
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.13
+date	2025.11.10.22.32.36;	author dean;	state Exp;
+branches;
+next	1.12;
+
 1.12
 date	2018.10.03.14.34.06;	author leith;	state Exp;
 branches;
@@ -91,9 +96,9 @@ desc
 @
 
 
-1.12
+1.13
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -106,7 +111,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -340,6 +345,17 @@ c	CLOSE(LUN2)
 @
 
 
+1.12
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.11
 log
 @GPL_2010
diff --git src/RCS/fmrs_2r.f,v src/RCS/fmrs_2r.f,v
index d2fa161d..abf9374a 100644
--- src/RCS/fmrs_2r.f,v
+++ src/RCS/fmrs_2r.f,v
@@ -1,4 +1,4 @@
-head	1.19;
+head	1.20;
 access;
 symbols
 	pre_mrcs:1.19
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.20
+date	2025.11.10.22.32.36;	author dean;	state Exp;
+branches;
+next	1.19;
+
 1.19
 date	2018.10.03.14.34.06;	author leith;	state Exp;
 branches;
@@ -125,9 +130,9 @@ desc
 @
 
 
-1.19
+1.20
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C
@@ -142,7 +147,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -212,6 +217,17 @@ c$omp   parallel do private(i),shared(invt)
 @
 
 
+1.19
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.18
 log
 @GPL_2010
diff --git src/RCS/fmrs_3.f,v src/RCS/fmrs_3.f,v
index c7abdc94..50eee9b9 100644
--- src/RCS/fmrs_3.f,v
+++ src/RCS/fmrs_3.f,v
@@ -1,4 +1,4 @@
-head	1.40;
+head	1.41;
 access;
 symbols
 	pre_mrcs:1.40
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.41
+date	2025.11.10.22.32.36;	author dean;	state Exp;
+branches;
+next	1.40;
+
 1.40
 date	2018.10.03.14.34.06;	author leith;	state Exp;
 branches;
@@ -230,9 +235,9 @@ desc
 @
 
 
-1.40
+1.41
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -248,7 +253,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -304,6 +309,17 @@ C--*********************************************************************
 @
 
 
+1.40
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.39
 log
 @GPL_2010
diff --git src/RCS/fmrs_3dr.f,v src/RCS/fmrs_3dr.f,v
index 2c38b52d..fe77939d 100644
--- src/RCS/fmrs_3dr.f,v
+++ src/RCS/fmrs_3dr.f,v
@@ -1,4 +1,4 @@
-head	1.14;
+head	1.15;
 access;
 symbols
 	pre_mrcs:1.14
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.15
+date	2025.11.10.22.32.36;	author dean;	state Exp;
+branches;
+next	1.14;
+
 1.14
 date	2018.10.03.14.34.06;	author leith;	state Exp;
 branches;
@@ -100,9 +105,9 @@ desc
 @
 
 
-1.14
+1.15
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C
@@ -116,7 +121,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -365,6 +370,17 @@ c$omp parallel do  private(k,i1)
 @
 
 
+1.14
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.13
 log
 @GPL_2010
diff --git src/RCS/fmrs_3r.f,v src/RCS/fmrs_3r.f,v
index ad30653b..8fe5997c 100644
--- src/RCS/fmrs_3r.f,v
+++ src/RCS/fmrs_3r.f,v
@@ -1,4 +1,4 @@
-head	1.14;
+head	1.15;
 access;
 symbols
 	pre_mrcs:1.14
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.15
+date	2025.11.10.22.32.36;	author dean;	state Exp;
+branches;
+next	1.14;
+
 1.14
 date	2018.10.03.14.34.06;	author leith;	state Exp;
 branches;
@@ -100,9 +105,9 @@ desc
 @
 
 
-1.14
+1.15
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C
@@ -116,7 +121,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -180,6 +185,17 @@ c$omp parallel do private(k,j,i)
 @
 
 
+1.14
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.13
 log
 @GPL_2010
diff --git src/RCS/fnrm.f,v src/RCS/fnrm.f,v
index 0b95075b..c09ba5e4 100644
--- src/RCS/fnrm.f,v
+++ src/RCS/fnrm.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.32.37;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.06;	author leith;	state Exp;
 branches;
@@ -80,9 +85,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -95,7 +100,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -134,6 +139,17 @@ c$omp parallel do private(i),reduction(+:tfnrm)
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @GPL_2010
diff --git src/RCS/four1.f,v src/RCS/four1.f,v
index 3e739b1c..9adbbe39 100644
--- src/RCS/four1.f,v
+++ src/RCS/four1.f,v
@@ -1,4 +1,4 @@
-head	1.62;
+head	1.63;
 access;
 symbols
 	pre_mrcs:1.62
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.63
+date	2025.11.10.22.32.37;	author dean;	state Exp;
+branches;
+next	1.62;
+
 1.62
 date	2018.10.03.14.27.28;	author leith;	state Exp;
 branches;
@@ -340,9 +345,9 @@ desc
 @
 
 
-1.62
+1.63
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -360,7 +365,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2016  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -567,6 +572,17 @@ C          CALL  RADWEIGHT
 @
 
 
+1.62
+log
+@email_health_dept
+@
+text
+@d16 1
+a16 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.61
 log
 @comments
diff --git src/RCS/four1a_fp.f,v src/RCS/four1a_fp.f,v
index a1473468..c7ded40d 100644
--- src/RCS/four1a_fp.f,v
+++ src/RCS/four1a_fp.f,v
@@ -1,4 +1,4 @@
-head	1.22;
+head	1.23;
 access;
 symbols
 	pre_mrcs:1.22
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.23
+date	2025.11.10.22.32.37;	author dean;	state Exp;
+branches;
+next	1.22;
+
 1.22
 date	2018.10.03.14.34.06;	author leith;	state Exp;
 branches;
@@ -140,9 +145,9 @@ desc
 @
 
 
-1.22
+1.23
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -160,7 +165,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -325,6 +330,17 @@ C       UPDATE THE INCORE HEADER VALUE & FILE HEADER FOR PIXSIZ
 @
 
 
+1.22
+log
+@email_health_dept
+@
+text
+@d16 1
+a16 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.21
 log
 @enter
diff --git src/RCS/four1b.f,v src/RCS/four1b.f,v
index 531c4197..024373ae 100644
--- src/RCS/four1b.f,v
+++ src/RCS/four1b.f,v
@@ -1,4 +1,4 @@
-head	1.25;
+head	1.26;
 access;
 symbols
 	pre_mrcs:1.25
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.26
+date	2025.11.10.22.32.37;	author dean;	state Exp;
+branches;
+next	1.25;
+
 1.25
 date	2018.10.03.14.34.06;	author leith;	state Exp;
 branches;
@@ -155,9 +160,9 @@ desc
 @
 
 
-1.25
+1.26
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -171,7 +176,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2018  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -355,6 +360,17 @@ C             VOLUME
 @
 
 
+1.25
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.24
 log
 @refactored
diff --git src/RCS/four1c.f,v src/RCS/four1c.f,v
index 53b39d91..72c1f4c8 100644
--- src/RCS/four1c.f,v
+++ src/RCS/four1c.f,v
@@ -1,4 +1,4 @@
-head	1.26;
+head	1.27;
 access;
 symbols
 	pre_mrcs:1.26
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.27
+date	2025.11.10.22.32.37;	author dean;	state Exp;
+branches;
+next	1.26;
+
 1.26
 date	2018.10.03.14.34.06;	author leith;	state Exp;
 branches;
@@ -160,9 +165,9 @@ desc
 @
 
 
-1.26
+1.27
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -176,7 +181,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -325,6 +330,17 @@ C             3D FFT
 @
 
 
+1.26
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.25
 log
 @comments
diff --git src/RCS/four_fq.f,v src/RCS/four_fq.f,v
index 7b88c3d0..c150099d 100644
--- src/RCS/four_fq.f,v
+++ src/RCS/four_fq.f,v
@@ -1,4 +1,4 @@
-head	1.19;
+head	1.20;
 access;
 symbols
 	pre_mrcs:1.19
@@ -7,6 +7,11 @@ locks; strict;
 comment	@c @;
 
 
+1.20
+date	2025.11.10.22.32.37;	author dean;	state Exp;
+branches;
+next	1.19;
+
 1.19
 date	2018.10.03.14.34.06;	author leith;	state Exp;
 branches;
@@ -107,9 +112,9 @@ desc
 @@
 
 
-1.19
+1.20
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -132,7 +137,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2018  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -628,7 +633,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2018, Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -1014,7 +1019,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2018, Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -1283,6 +1288,23 @@ C       RESTORE ZERO TERM FOR HIGH PASS OPTIONS
 @
 
 
+1.19
+log
+@email_health_dept
+@
+text
+@d21 1
+a21 1
+C=* Email: spider@@health.ny.gov                                        *
+d517 1
+a517 1
+C=* Email: spider@@health.ny.gov                                        *
+d903 1
+a903 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.18
 log
 @hidden plot option and pad type options
diff --git src/RCS/fouring.f,v src/RCS/fouring.f,v
index 93d02b88..53c53c44 100644
--- src/RCS/fouring.f,v
+++ src/RCS/fouring.f,v
@@ -1,4 +1,4 @@
-head	1.15;
+head	1.16;
 access;
 symbols
 	pre_mrcs:1.15
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.16
+date	2025.11.10.22.33.17;	author dean;	state Exp;
+branches;
+next	1.15;
+
 1.15
 date	2018.10.03.14.34.07;	author leith;	state Exp;
 branches;
@@ -105,9 +110,9 @@ desc
 @
 
 
-1.15
+1.16
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -120,7 +125,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -177,6 +182,17 @@ c$omp parallel do private(i,l)
 @
 
 
+1.15
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.14
 log
 @GPL_2010
diff --git src/RCS/fouring_q.f,v src/RCS/fouring_q.f,v
index b9764aba..33479461 100644
--- src/RCS/fouring_q.f,v
+++ src/RCS/fouring_q.f,v
@@ -1,4 +1,4 @@
-head	1.13;
+head	1.14;
 access;
 symbols
 	pre_mrcs:1.13
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.14
+date	2025.11.10.22.33.17;	author dean;	state Exp;
+branches;
+next	1.13;
+
 1.13
 date	2018.10.03.14.34.07;	author leith;	state Exp;
 branches;
@@ -94,9 +99,9 @@ desc
 @@
 
 
-1.13
+1.14
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -109,7 +114,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -171,6 +176,17 @@ c       parallel do private(i,inv,nval,igo)(FAILS MAKING PLAN WITH FFTW3)
 @
 
 
+1.13
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.12
 log
 @lacked igo in parallel private  bug
diff --git src/RCS/framealign_mlr.f,v src/RCS/framealign_mlr.f,v
index 2750b8ad..8660dc24 100644
--- src/RCS/framealign_mlr.f,v
+++ src/RCS/framealign_mlr.f,v
@@ -1,4 +1,4 @@
-head	1.5;
+head	1.6;
 access;
 symbols
 	pre_mrcs:1.5
@@ -7,6 +7,11 @@ locks; strict;
 comment	@c @;
 
 
+1.6
+date	2025.11.10.22.33.17;	author dean;	state Exp;
+branches;
+next	1.5;
+
 1.5
 date	2018.10.03.14.34.07;	author leith;	state Exp;
 branches;
@@ -37,9 +42,9 @@ desc
 @@
 
 
-1.5
+1.6
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -52,7 +57,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2015  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -478,6 +483,17 @@ c ---------------------- Unused below -------------------
 @
 
 
+1.5
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.4
 log
 @iterative refinement of shifts
diff --git src/RCS/frng.f,v src/RCS/frng.f,v
index f74eb479..39f9273f 100644
--- src/RCS/frng.f,v
+++ src/RCS/frng.f,v
@@ -1,4 +1,4 @@
-head	1.15;
+head	1.16;
 access;
 symbols
 	pre_mrcs:1.15
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.16
+date	2025.11.10.22.33.17;	author dean;	state Exp;
+branches;
+next	1.15;
+
 1.15
 date	2018.10.03.14.34.07;	author leith;	state Exp;
 branches;
@@ -105,9 +110,9 @@ desc
 @
 
 
-1.15
+1.16
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -120,7 +125,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -159,6 +164,17 @@ c$omp    end parallel do
 @
 
 
+1.15
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.14
 log
 @GPL_2010
diff --git src/RCS/frngs.f,v src/RCS/frngs.f,v
index cfe46877..a55c7c9f 100644
--- src/RCS/frngs.f,v
+++ src/RCS/frngs.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -23,6 +23,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.33.17;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.07;	author leith;	state Exp;
 branches;
@@ -78,9 +83,9 @@ desc
 @@
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -95,7 +100,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -188,6 +193,17 @@ c$omp      end parallel do
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @removed ifdef SP_LIBFFTW3, implicit none
diff --git src/RCS/fromtoq.f,v src/RCS/fromtoq.f,v
index 85874fa5..0c6af82d 100644
--- src/RCS/fromtoq.f,v
+++ src/RCS/fromtoq.f,v
@@ -1,4 +1,4 @@
-head	1.13;
+head	1.14;
 access;
 symbols
 	pre_mrcs:1.13
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.14
+date	2025.11.10.22.33.17;	author dean;	state Exp;
+branches;
+next	1.13;
+
 1.13
 date	2018.10.03.14.34.07;	author leith;	state Exp;
 branches;
@@ -95,9 +100,9 @@ desc
 @
 
 
-1.13
+1.14
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -113,7 +118,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -181,6 +186,17 @@ C       ALTER NCHAR TO STOP FURTHER PROCESSING OF BRACKETED SUBSTRING
 @
 
 
+1.13
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.12
 log
 @GPL_2010
diff --git src/RCS/fsort.f,v src/RCS/fsort.f,v
index 4928661e..3f886651 100644
--- src/RCS/fsort.f,v
+++ src/RCS/fsort.f,v
@@ -1,4 +1,4 @@
-head	1.6;
+head	1.7;
 access;
 symbols
 	pre_mrcs:1.6
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.7
+date	2025.11.10.22.33.17;	author dean;	state Exp;
+branches;
+next	1.6;
+
 1.6
 date	2018.10.03.14.34.07;	author leith;	state Exp;
 branches;
@@ -60,9 +65,9 @@ desc
 @
 
 
-1.6
+1.7
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*******************************************************************
@@ -75,7 +80,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -199,6 +204,17 @@ C
 @
 
 
+1.6
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.5
 log
 @GPL_2010
diff --git src/RCS/ftr.f,v src/RCS/ftr.f,v
index f9137b45..5263a496 100644
--- src/RCS/ftr.f,v
+++ src/RCS/ftr.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -21,6 +21,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.33.17;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.34.07;	author leith;	state Exp;
 branches;
@@ -67,9 +72,9 @@ desc
 @
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -83,7 +88,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -202,6 +207,17 @@ C       OUTPUT IMAGE
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @GPL_2010
diff --git src/RCS/fv.f,v src/RCS/fv.f,v
index 18a737d5..ebec4330 100644
--- src/RCS/fv.f,v
+++ src/RCS/fv.f,v
@@ -1,4 +1,4 @@
-head	1.13;
+head	1.14;
 access;
 symbols
 	pre_mrcs:1.13
@@ -22,6 +22,11 @@ locks; strict;
 comment	@c @;
 
 
+1.14
+date	2025.11.10.22.33.17;	author dean;	state Exp;
+branches;
+next	1.13;
+
 1.13
 date	2018.10.03.14.34.07;	author leith;	state Exp;
 branches;
@@ -93,9 +98,9 @@ desc
 @
 
 
-1.13
+1.14
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -110,7 +115,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -236,6 +241,17 @@ C--*********************************************************************
 @
 
 
+1.13
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.12
 log
 @GPL_2010
diff --git src/RCS/gali.f,v src/RCS/gali.f,v
index 345fce85..35a4ec19 100644
--- src/RCS/gali.f,v
+++ src/RCS/gali.f,v
@@ -1,4 +1,4 @@
-head	1.54;
+head	1.55;
 access;
 symbols
 	pre_mrcs:1.54
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.55
+date	2025.11.10.22.33.17;	author dean;	state Exp;
+branches;
+next	1.54;
+
 1.54
 date	2018.10.03.14.34.07;	author leith;	state Exp;
 branches;
@@ -300,9 +305,9 @@ desc
 @
 
 
-1.54
+1.55
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -320,7 +325,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2017, Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -519,7 +524,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2017  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -941,6 +946,20 @@ C          END OF INFINITE ITERATIONS
 @
 
 
+1.54
+log
+@email_health_dept
+@
+text
+@d16 1
+a16 1
+C=* Email: spider@@health.ny.gov                                        *
+d215 1
+a215 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.53
 log
 @COSMETIC changes while chasing non-relevant bug,  endless loop trap
diff --git src/RCS/gam.f,v src/RCS/gam.f,v
index 39481d2c..e75e61cb 100644
--- src/RCS/gam.f,v
+++ src/RCS/gam.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.33.17;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.34.07;	author leith;	state Exp;
 branches;
@@ -70,9 +75,9 @@ desc
 @
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -85,7 +90,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -140,6 +145,17 @@ C***********************************************************************
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @GPL_2010
diff --git src/RCS/gaussp.f,v src/RCS/gaussp.f,v
index 4086230a..5f3f6e60 100644
--- src/RCS/gaussp.f,v
+++ src/RCS/gaussp.f,v
@@ -1,4 +1,4 @@
-head	1.13;
+head	1.14;
 access;
 symbols
 	pre_mrcs:1.13
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.14
+date	2025.11.10.22.33.17;	author dean;	state Exp;
+branches;
+next	1.13;
+
 1.13
 date	2018.10.03.14.34.07;	author leith;	state Exp;
 branches;
@@ -95,9 +100,9 @@ desc
 @
 
 
-1.13
+1.14
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -111,7 +116,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -179,6 +184,17 @@ C	IF(WHAT.EQ.'B') THEN
 @
 
 
+1.13
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.12
 log
 @GPL_2010
diff --git src/RCS/gee.f,v src/RCS/gee.f,v
index 5c53c95f..95b1b3f1 100644
--- src/RCS/gee.f,v
+++ src/RCS/gee.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.33.17;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.07;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -90,7 +95,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -140,6 +145,17 @@ C***********************************************************************
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/get_tf_input.f,v src/RCS/get_tf_input.f,v
index 6c6fbf8f..0a826e2f 100644
--- src/RCS/get_tf_input.f,v
+++ src/RCS/get_tf_input.f,v
@@ -1,4 +1,4 @@
-head	1.7;
+head	1.8;
 access;
 symbols
 	pre_mrcs:1.7
@@ -7,6 +7,11 @@ locks; strict;
 comment	@c @;
 
 
+1.8
+date	2025.11.10.22.33.18;	author dean;	state Exp;
+branches;
+next	1.7;
+
 1.7
 date	2018.10.03.14.34.07;	author leith;	state Exp;
 branches;
@@ -47,9 +52,9 @@ desc
 @@
 
 
-1.7
+1.8
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -63,7 +68,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2015  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -266,6 +271,17 @@ C        MUST BE KEV (RELATIVISTIC ELECTRONS)
 @
 
 
+1.7
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.6
 log
 @changed geh prompt.
diff --git src/RCS/getcoo.f,v src/RCS/getcoo.f,v
index 4eee2473..4351b348 100644
--- src/RCS/getcoo.f,v
+++ src/RCS/getcoo.f,v
@@ -1,4 +1,4 @@
-head	1.17;
+head	1.18;
 access;
 symbols
 	pre_mrcs:1.17
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.18
+date	2025.11.10.22.33.18;	author dean;	state Exp;
+branches;
+next	1.17;
+
 1.17
 date	2018.10.03.14.34.07;	author leith;	state Exp;
 branches;
@@ -115,9 +120,9 @@ desc
 @
 
 
-1.17
+1.18
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -132,7 +137,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -298,6 +303,17 @@ C         WRITE  DATA TO PIX*** FILE
 @
 
 
+1.17
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.16
 log
 @GPL_2010
diff --git src/RCS/getcoo2.f,v src/RCS/getcoo2.f,v
index 78b819f7..ea744e48 100644
--- src/RCS/getcoo2.f,v
+++ src/RCS/getcoo2.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.33.18;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.07;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -90,7 +95,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -213,6 +218,17 @@ C.......... WRITE THE COORDINATES OF THE COLUMNS (IMAGES)
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/getcoot.f,v src/RCS/getcoot.f,v
index 51b44d92..89ee85af 100644
--- src/RCS/getcoot.f,v
+++ src/RCS/getcoot.f,v
@@ -1,4 +1,4 @@
-head	1.16;
+head	1.17;
 access;
 symbols
 	pre_mrcs:1.16
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.17
+date	2025.11.10.22.33.18;	author dean;	state Exp;
+branches;
+next	1.16;
+
 1.16
 date	2018.10.03.14.34.07;	author leith;	state Exp;
 branches;
@@ -110,9 +115,9 @@ desc
 @
 
 
-1.16
+1.17
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -128,7 +133,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -291,6 +296,17 @@ C         WRITE IMC DATA TO IMC FILE
 @
 
 
+1.16
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.15
 log
 @GPL_2010
diff --git src/RCS/getdefocus.f,v src/RCS/getdefocus.f,v
index 40ceaa21..ba13104a 100644
--- src/RCS/getdefocus.f,v
+++ src/RCS/getdefocus.f,v
@@ -1,4 +1,4 @@
-head	1.5;
+head	1.6;
 access;
 symbols
 	pre_mrcs:1.5
@@ -20,6 +20,11 @@ locks; strict;
 comment	@c @;
 
 
+1.6
+date	2025.09.21.15.11.53;	author dean;	state Exp;
+branches;
+next	1.5;
+
 1.5
 date	2011.05.27.14.30.02;	author leith;	state Exp;
 branches;
@@ -50,13 +55,16 @@ desc
 @@
 
 
-1.5
+1.6
 log
-@?
+@C integer do loop counters are deprecated, very buggy code./coi tfed.f
+C integer do loop counters are deprecated, very buggy code./coi tfed.f
 @
 text
 @C **********************************************************************
 C *  GETDEFOCUS.F
+C *  THIS CODE IS A MESS!  SEGFAULTS and COMPILER ERRORS!! 
+C *  I ABANDONED TRYING TO FIX IT! al
 C=**********************************************************************
 C=* From: SPIDER - MODULAR IMAGE PROCESSING SYSTEM                     *
 C=* Copyright (C)2002, L. Joyeux & P. A. Penczek                       *
@@ -102,6 +110,9 @@ CC==X is X coordinates!
       	REAL       VALUE(NUMBER), ENV(NUMBER), VALUE2(NUMBER),X(NUMBER)
       	REAL      PS, CS, LAMBDA, CONTRAST, DZLOW1, DZHIGH1, DZINC, DZ
      	 REAL      DZLOW, DZHIGH,XXX,XSCORE
+
+C        GFORT WILL NOT ACCEPT REAL PARAMETERS FOR LOOPING   Sept 2025 al
+      	INTEGER      IDZLOW, IDZHIGH,IDZINC, IDZ
       	REAL      GETDEFOCUS
 	COMMON /SEARCH_RANGE/ DZLOW1,DZHIGH1,NMB
       	INTEGER          I, J, L, ISTART,ISTOP,ISWI
@@ -118,16 +129,25 @@ CC==X is X coordinates!
         ENDIF
 
         DO
-           DO DZ = DZLOW, DZHIGH, DZINC
+C           GFORT WILL NOT ACCEPT REAL PARAMETERS FOR LOOPING   Sept 2025 al
+            IDZLOW  = DZLOW    ! buggy change of limits ,,, redefined below al
+	    IDZHIGH = DZHIGH 
+	    IDZINC  = DZINC
+	    
+            DO IDZ  = IDZLOW, IDZHIGH, IDZINC
+	      DZ    = IDZ
+	      
               CALL CTF_SIGNAL1(VALUE,X,NUMBER, PS, CS, 
      &                      LAMBDA, DZ, CONTRAST)
 
               IF (ISWI.EQ.0) THEN
                   DO L = ISTART, ISTOP
-                     DIFF=DIFF+(VALUE(L)*DBLE(VALUE(L))*ENV(L)-
-CCC=CHECK ENVELOPE EFFECT
-C		DIFF=DIFF+(VALUE(L)*DBLE(VALUE(L))-
-     &                    DBLE(VALUE2(L)))**2
+		  
+CCC                     DIFF=DIFF+(VALUE(L)*DBLE(VALUE(L))*ENV(L)-
+CCC=CHECK ENVELOPE EFFECT  was buggy?? sept 2025
+
+ 		        DIFF = DIFF+(VALUE(L)*DBLE(VALUE(L))-
+     &                      DBLE(VALUE2(L)))**2
                   ENDDO
                   IF (DIFF<DIFFMIN .OR. DZ .EQ. DZLOW) THEN
                      GETDEFOCUS = DZ
@@ -164,6 +184,25 @@ C		DIFF=DIFF+(VALUE(L)*DBLE(VALUE(L))-
 @
 
 
+1.5
+log
+@?
+@
+text
+@d3 2
+d50 3
+d69 8
+a76 1
+           DO DZ = DZLOW, DZHIGH, DZINC
+d82 6
+a87 4
+                     DIFF=DIFF+(VALUE(L)*DBLE(VALUE(L))*ENV(L)-
+CCC=CHECK ENVELOPE EFFECT
+C		DIFF=DIFF+(VALUE(L)*DBLE(VALUE(L))-
+     &                    DBLE(VALUE2(L)))**2
+@
+
+
 1.4
 log
 @Pawels GPL License used
diff --git src/RCS/getdocdat.f,v src/RCS/getdocdat.f,v
index 2dd62b93..e8e64d6b 100644
--- src/RCS/getdocdat.f,v
+++ src/RCS/getdocdat.f,v
@@ -1,4 +1,4 @@
-head	1.35;
+head	1.36;
 access;
 symbols
 	pre_mrcs:1.35
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.36
+date	2025.11.10.22.33.18;	author dean;	state Exp;
+branches;
+next	1.35;
+
 1.35
 date	2018.10.03.14.34.07;	author leith;	state Exp;
 branches;
@@ -205,9 +210,9 @@ desc
 @
 
 
-1.35
+1.36
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -226,7 +231,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2012  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -415,6 +420,17 @@ C          TO RECOVER MULTIPLE VALUES HAVING SAME KEY
 @
 
 
+1.35
+log
+@email_health_dept
+@
+text
+@d17 1
+a17 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.34
 log
 @unused var removed
diff --git src/RCS/getdoclist.f,v src/RCS/getdoclist.f,v
index b7c3d282..871c2785 100644
--- src/RCS/getdoclist.f,v
+++ src/RCS/getdoclist.f,v
@@ -1,4 +1,4 @@
-head	1.4;
+head	1.5;
 access;
 symbols
 	pre_mrcs:1.4
@@ -20,6 +20,11 @@ locks; strict;
 comment	@c @;
 
 
+1.5
+date	2025.11.10.22.33.18;	author dean;	state Exp;
+branches;
+next	1.4;
+
 1.4
 date	2018.10.03.14.34.07;	author leith;	state Exp;
 branches;
@@ -45,9 +50,9 @@ desc
 @@
 
 
-1.4
+1.5
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -60,7 +65,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -143,6 +148,17 @@ C             IN ANG ARRAY ORDER SHOULD BE OTHER WAY AROUND
 @
 
 
+1.4
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.3
 log
 @GPL_2010
diff --git src/RCS/getfilenum.f,v src/RCS/getfilenum.f,v
index 09b17ee3..c084dc8d 100644
--- src/RCS/getfilenum.f,v
+++ src/RCS/getfilenum.f,v
@@ -1,4 +1,4 @@
-head	1.5;
+head	1.7;
 access;
 symbols
 	pre_mrcs:1.5
@@ -21,6 +21,16 @@ locks; strict;
 comment	@c @;
 
 
+1.7
+date	2025.11.10.22.33.56;	author dean;	state Exp;
+branches;
+next	1.6;
+
+1.6
+date	2025.10.25.15.35.25;	author dean;	state Exp;
+branches;
+next	1.5;
+
 1.5
 date	2018.10.03.14.34.07;	author leith;	state Exp;
 branches;
@@ -51,9 +61,9 @@ desc
 @@
 
 
-1.5
+1.7
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -61,13 +71,14 @@ C++*********************************************************************
 C
 C GETFILENUM.F  -- NEW JAN 1999                   AUTHOR: ARDEAN LEITH
 C                  EXTRACTED FROM LUNSETHDR AUG 02 ARDEAN LEITH
+C
 C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -81,43 +92,53 @@ C=* General Public License for more details.                           *
 C=* You should have received a copy of the GNU General Public License  *
 C=* along with this program. If not, see <http://www.gnu.org/licenses> *
 C=*                                                                    *
-C *******************************************************************C **********************************************************************
-C
+C **********************************************************************
 C
-C    GETFILENUM(FILNAM,IMGNUM,CALLERRT,IRTFLG)  
+C    GETFILENUM(FILNAM,IMGNUM,NDIGITS,CALLERRT,IRTFLG)  
 C
 C    PURPOSE:    FINDS FILE NUMBER AT END OF FILENAME
 C    
-C    PARAMETERS:     FILNAM    CHAR. VARIABLE FILE NAME         (SENT)
-C                    IMGNUM    NUMBER IN FILE NAME               (RET.)
-C                    NDIGITS   NUMBER OF DIGITS                  (RET.)
-C                    CALLERRT  CALL ERRT IF ERROR               (SENT)
-C                    IRTFLG    ERROR FLAG                       (RET.)
+C    PARAMETERS: FILNAM    CHAR. VARIABLE FILE NAME             (SENT)
+C                IMGNUM    NUMBER IN FILE NAME                   (RET)
+C                NDIGITS   NUMBER OF DIGITS                      (RET)
+C                CALLERRT  CALL ERRT IF ERROR                   (SENT)
+C                IRTFLG    ERROR FLAG                            (RET)
+C
+C    CALLED BY:      deletf.f    filgen.f     openinstk.f 
+C                    openstk.f   to_peaks.f 
 C
 C23456789 123456789 123456789 123456789 123456789 123456789 123456789 12
 C--*********************************************************************
  
        SUBROUTINE GETFILENUM(FILNAM,IMGNUM,NDIGITS,CALLERRT,IRTFLG)
 
+       IMPLICIT  NONE
+
        INCLUDE 'CMBLOCK.INC'
 
-       CHARACTER *(*) FILNAM
-       CHARACTER *1   CHARI
-       LOGICAL        CALLERRT
-    
+       CHARACTER *(*) :: FILNAM
+       LOGICAL        :: CALLERRT
+       INTEGER        :: IMGNUM,NDIGITS,IRTFLG
+
+       CHARACTER *1   :: CHARI
+       INTEGER        :: NLET,IGO,I,NE
+       INTEGER        :: lnblnkn
+
+
 C      FIND NUMBER OF CHAR. IN FILNAM
        NLET   = LNBLNKN(FILNAM)
+
        IGO    = NLET - 1
        IMGNUM = 0
 
 C      EXTRACT IMGNUM FROM FILENAME
        DO I = NLET,1,-1
           CHARI = FILNAM(I:I)
-          IF (CHARI .LT. '0' .OR. CHARI .GT. '9') GOTO 10
+          IF (CHARI .LT. '0' .OR. CHARI .GT. '9') EXIT
           IGO = I 
        ENDDO
 
-10     NDIGITS = NLET - IGO + 1
+       NDIGITS = NLET - IGO + 1
        IF (NDIGITS .LE. 0 .OR. NDIGITS .GT. 10) THEN
 C         NO NUMBER AT END OF FILNAM OR > 10 DIGITS
           IRTFLG = -1
@@ -127,7 +148,8 @@ C         NO NUMBER AT END OF FILNAM OR > 10 DIGITS
        READ(FILNAM(IGO:NLET),'(I10)',ERR=999) IMGNUM
        IRTFLG = 0
        RETURN
-     
+ 
+    
 999    WRITE(NOUT,*) '*** CAN NOT GET FILE NUMBER FROM: ',FILNAM(:NLET)
        IF (CALLERRT) THEN
           CALL ERRT(100,'GETFILENUM',NE)
@@ -138,7 +160,714 @@ C         NO NUMBER AT END OF FILNAM OR > 10 DIGITS
        END
 
 
+C++*********************************************************************
+C
+C GET_FILNAM_NSTK   NEW OCT 2005                 OCT 2025 ArDean Leith
+C               
+C **********************************************************************
+C=*                                                                    *
+C=* This file is part of:   SPIDER - Modular Image Processing System.  *
+C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
+C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
+C=* Email:                                                             *
+C=*                                                                    *
+C=* SPIDER is free software; you can redistribute it and/or            *
+C=* modify it under the terms of the GNU General Public License as     *
+C=* published by the Free Software Foundation; either version 2 of the *
+C=* License, or (at your option) any later version.                    *
+C=*                                                                    *
+C=* SPIDER is distributed in the hope that it will be useful,          *
+C=* but WITHOUT ANY WARRANTY; without even the implied warranty of     *
+C=* merchantability or fitness for a particular purpose.  See the GNU  *
+C=* General Public License for more details.                           *
+C=* You should have received a copy of the GNU General Public License  *
+C=* along with this program. If not, see <http://www.gnu.org/licenses> *
+C=*                                                                    *
+C ************************* GET_FILNAM_NSTK ****************************
+C
+C   GET_FILNAM_NSTK(FILNAM,FIL_NOAT, FIL_DIRS,FIL_BASE,FIL_EXT,
+C                   IS_MRC,LOCAST, IS_STK,NSTK_FLG, IRTFLG)
+C
+C   PURPOSE:    FINDS STACKED IMG  NUMBER IN FILENAME
+C    
+C   PARAMETERS: FILNAM     CHAR. VARIABLE FILE NAME            (SENT)
+C               FIL_NOAT   CHAR. VARIABLE FILE NAME             (RET)
+C               FIL_DIRS   CHAR. VARIABLE FILE NAME             (RET)
+C               FIL_BASE   CHAR. VARIABLE FILE NAME             (RET)
+C               FIL_EXT    CHAR. VARIABLE FILE NAME             (RET)
+C               IS_MRC     NUMBER IN FILE NAME                  (RET)
+C               LOCAST     LOCATION OF * IN FILE NAME           (RET)
+C               IS_STK     IS A STACK                   (SENT or RET)
+C               NSTK_FLG   STACK IMG NUMBER FROM FILE NAME      (RET)
+C                            -2 :  NOT A STACK   (NO @@)
+C                            -1 :  AST IN STACK   
+C                             0 :  BARE STACK
+C                            >1 :  STACKED IMAGE NUMBER
+C
+C               IRTFLG     ERROR FLAG                       (RET.)
+C  
+C     IF PRESENT, EXTRACT STACK FILENAME AND NUMBER e.g. from
+C     056@@file.mrcs       or file3321@@100.mrcs  or /dir/fileaa@@21 or
+C     /dir/fileaa@@21.mrcs or /dir/056@@file         etc 
+C
+C23456789 123456789 123456789 123456789 123456789 123456789 123456789 12
+C--*********************************************************************
+
+      SUBROUTINE GET_FILNAM_NSTK(FILNAM,
+     &                      FIL_NOAT,FIL_DIRS,FIL_BASE,FIL_EXT,
+     &                      IS_MRC, LOCAST, IS_STK, NSTK_FLG,IRTFLG)
+
+      IMPLICIT NONE
+
+      INCLUDE 'CMBLOCK.INC'
+      INCLUDE 'CMLIMIT.INC'
+
+      CHARACTER(LEN=*)              :: FILNAM,FIL_DIRS,FIL_BASE,FIL_EXT
+      CHARACTER(LEN=*),INTENT(OUT)  :: FIL_NOAT
+      LOGICAL                       :: IS_MRC,IS_STK
+      INTEGER                       :: LOCAST,NSTK_FLG,IRTFLG
+
+      LOGICAL               :: GOT_EXT, IS_MRCS
+      INTEGER               :: LOCAT
+
+      INTEGER               :: LOCSLASH,NLEN,IGO,LOCDOT,IENDB,IASTSB4
+      INTEGER               :: LOCEXT,IERR,NE,IDIGS,ILENT
+      CHARACTER(LEN=1)      :: NULL = CHAR(0)
+ 
+      INTEGER               :: lnblnkn
+
+
+      NLEN = lnblnkn(FILNAM)
+
+C     FIND ENDING LOCATION OF  DIRECTORY(S) IN FILNAM_AT
+      LOCSLASH = INDEX(FILNAM(1:NLEN),'/',BACK=.TRUE.)
+
+C     STRIP OFF DIRECTORY(S)
+      FIL_DIRS = NULL
+      FIL_BASE = NULL
+
+      IF (LOCSLASH > 0) THEN
+          FIL_DIRS = FILNAM(1:LOCSLASH)
+          FIL_BASE = FILNAM(LOCSLASH+1:NLEN) 
+      ENDIF
+
+#if defined (SP_DBUGIO)
+      write(3,*)' In get_filnam_nstk  0000000'
+      write(3,*)' In get_filnam_nstk; locslash:',locslash
+
+      ilent = lnblnkn(filnam)
+      write(3,*)' In get_filnam_nstk; filnam: ',   filnam(1:ilent)
+      ilent = lnblnkn(fil_dirs)
+      write(3,*)' In get_filnam_nstk; fil_dirs: ', fil_dirs(1:ilent)
+#endif
+
+
+C     FIND LOCATION OF EXTENSION IN FILNAM
+      LOCDOT   = INDEX(FILNAM(1:NLEN),'.',BACK=.TRUE.)
+
+C     EXTRACT  EXTENSION FROM FILNAM
+      GOT_EXT  = (LOCDOT > 0)
+
+      FIL_EXT  = NULL
+ 
+      IF (GOT_EXT) THEN
+C        GET FILE EXTENSION
+         FIL_EXT  = FILNAM(LOCDOT+1:NLEN)
+
+C        STRIP OFF EXTENSION FROM FIL_BASE
+         LOCEXT   = INDEX(FIL_BASE,'.',BACK=.TRUE.)
+         FIL_BASE = FIL_BASE(1:LOCEXT-1)
+      ENDIF
+               
+      IS_MRC = .FALSE.
+      IF  ( ( INDEX(FIL_EXT,'mrc') > 0) .OR. 
+     &      ( INDEX(FIL_EXT,'MRC') > 0) ) THEN
+        IS_MRC = .TRUE.
+      ENDIF
+
+      IS_MRCS = .FALSE.
+      IF  ( ( INDEX(FIL_EXT,'mrcs') > 0) .OR. 
+     &      ( INDEX(FIL_EXT,'MRCS') > 0) ) THEN
+        IS_MRC = .TRUE.
+      ENDIF
+
+
+#if defined (SP_DBUGIO)
+      write(3,*)' In get_filnam_nstk; ismrc,ismrcs:', is_mrc,is_mrcs
+ 
+      ilent = lnblnkn(fil_ext)
+      write(3,*)' In get_filnam_nstk; fil_ext: ',  fil_ext(1:ilent) 
+      ilent = lnblnkn(fil_base)
+      write(3,*)' In get_filnam_nstk; fil_base: ', fil_base(1:ilent) 
+#endif
+
+      IENDB   = lnblnkn(FIL_BASE)
+      LOCAT   = INDEX(FIL_BASE(1:IENDB),'@@')
+
+#if defined (SP_DBUGIO)
+      write(3,*)' In get_filnam_nstk; iendb,nlen:',iendb,nlen
+      write(3,*)' In get_filnam_nstk; locslash,locdot,locat:',
+     &                                locslash,locdot,locat 
+        
+#endif
+      
+
+      IRTFLG   = 0
+
+      IF (LOCAT <= 0 .AND. (.NOT. IS_MRCS)) THEN
+
+#if defined (SP_DBUGIO)
+         write(3,*)' In get_filnam_nstk  0000000 '      
+#endif
+
+         IS_STK    = .FALSE.
+         FIL_NOAT  = FILNAM
+         NSTK_FLG  = -2   ! NOT A STACK
+         GOTO 999         !RETURN
+
+      ELSEIF (LOCAT <= 0 .AND. IS_MRCS ) THEN
+
+#if defined (SP_DBUGIO)
+         write(3,*)' In get_filnam_nstk  1111111 ' 
+#endif
+
+         IS_STK    = .TRUE.
+         FIL_NOAT  = FILNAM
+         NSTK_FLG  = 1      ! MRCS STACK WITHOUT @@
+         GOTO 999           ! RETURN
+
+      ELSEIF (LOCAT == 1 ) THEN
+C        BARESTACK AT START OF FILE BASENAME
+
+#if defined (SP_DBUGIO)
+         write(3,*)'  In GET_FILNAM_NSTK  2222222 '
+#endif
+ 
+         IS_STK    = .TRUE.
+         NSTK_FLG  = 0      ! BARESTACK
+         FIL_BASE  = FIL_BASE(2:IENDB)
+
+         ILENT     = lnblnkn(FIL_NOAT)
+         IF (GOT_EXT) FIL_NOAT = FIL_NOAT(1:ILENT) // '.' // FIL_EXT
+         GOTO 999   
+
+      ELSEIF (LOCAT == IENDB ) THEN
+C        BARESTACK AT END OF FILE BASENAME
+
+#if defined (SP_DBUGIO)
+         write(3,*)' In get_filnam_nstk    3333333 '
+#endif
+
+         IS_STK    = .TRUE.
+         NSTK_FLG  = 0      ! BARESTACK
+         FIL_BASE  = FIL_BASE(1:IENDB-1) // NULL
+
+         ILENT     = lnblnkn(FIL_DIRS)
+         FIL_NOAT  = FIL_DIRS(1:ILENT) // FIL_BASE 
+         ILENT     = lnblnkn(FIL_NOAT)
+         IF (GOT_EXT) FIL_NOAT = FIL_NOAT(1:ILENT) // '.' // FIL_EXT
+         GOTO 999    
 
+      ENDIF
+
+#if defined (SP_DBUGIO)
+      !write(3,*)' In get_filnam_nstk  3333333  to   4444444 '
+#endif
+   
+      IASTSB4 = VERIFY(FIL_BASE(1:LOCAT-1),'*',.TRUE.) 
+      IF ((LOCAT > 1) .AND. (IASTSB4 == 0)) THEN
+C        ONLY '*'s  AT START OF FILE BASENAME
+
+#if defined (SP_DBUGIO)
+         write(3,*)' In get_filnam_nstk 4444444 '
+#endif
+
+         IS_STK    = .TRUE.
+         NSTK_FLG  = -1      ! (*)@@
+
+         ILENT     = lnblnkn(FIL_DIRS)
+         FIL_NOAT  = FIL_DIRS(1:ILENT) // FIL_BASE(LOCAT+1:IENDB) 
+
+         ILENT     = lnblnkn(FIL_NOAT)
+         IF (GOT_EXT) FIL_NOAT = FIL_NOAT(1:ILENT) // '.' // FIL_EXT
+         GOTO 999    
+      ENDIF
+
+#if defined (SP_DBUGIO)
+      !write(3,*)' In get_filnam_nstk    4444444 to  5555555 '
+#endif
+
+      IASTSB4 = VERIFY(FIL_BASE(LOCAT+1:IENDB),'*') 
+      IF ((LOCAT > 1) .AND. (IASTSB4 == 0)) THEN
+C        ONLY '*'s  AT END OF FILE BASENAME
+
+#if defined (SP_DBUGIO)
+         !write(3,*)' In get_filnam_nstk   5555555 '
+         !write(3,*)' In get_filnam_nstk; ilent: ',  ilent
+         !write(3,*)' In get_filnam_nstk; iastsb4,locat: ',    iastsb4,locat
+         !write(3,*)' In get_filnam_nstk; fil_base ',fil_base(1:locat)
+#endif
+
+         IS_STK    = .TRUE.
+         NSTK_FLG  = -1       ! @@(*)
+
+         !!FIL_BASE  = FIL_BASE(1:LOCAT-1) // NULL
+
+         ILENT     = lnblnkn(FIL_DIRS)
+         FIL_NOAT  = FIL_DIRS(1:ILENT) // FIL_BASE 
+         ILENT     = lnblnkn(FIL_NOAT)
+         IF (GOT_EXT) FIL_NOAT = FIL_NOAT(1:ILENT) // '.' // FIL_EXT
+
+         GOTO 999  
+      ENDIF
+
+
+#if defined (SP_DBUGIO)
+      !write(3,*)' In get_filnam_nstk    5555555   TO  6666666 '
+#endif
+
+      IDIGS = VERIFY(FIL_BASE(1:LOCAT-1),'1234567890') 
+
+      IF ((LOCAT > 1) .AND. (IDIGS == 0)) THEN
+C        ONLY DIGITS  AT START OF FILE BASENAME BEFORE @@
+ 
+#if defined (SP_DBUGIO)
+        write(3,*)' In get_filnam_nstk   6666666 '
+#endif
+
+         READ(FIL_BASE(1:LOCAT-1),'(I10)',IOSTAT=IERR) NSTK_FLG
+         IF (IERR .NE. 0) THEN
+             WRITE(NOUT,*)
+     &          '*** CAN NOT GET STK NUMBER FROM: ',FIL_BASE(1:LOCAT)
+             CALL ERRT(100,'GET_FILNAM_NSTK',NE)
+             IRTFLG = 1
+             RETURN
+         ENDIF
+
+         IS_STK    = .TRUE.
+
+         ILENT     = lnblnkn(FIL_DIRS)
+         FIL_NOAT  = FIL_DIRS(1:ILENT) // FIL_BASE(LOCAT+1:)
+ 
+         ILENT     = lnblnkn(FIL_NOAT)
+         IF (GOT_EXT) FIL_NOAT = FIL_NOAT(1:ILENT) // '.' // FIL_EXT
+
+         GOTO 999    !RETURN
+      ENDIF
+
+#if defined (SP_DBUGIO)
+      !write(3,*)' In get_filnam_nstk    6666666 to  7777777  '
+#endif
+
+
+      IDIGS = VERIFY(FIL_BASE(LOCAT+1:IENDB),'1234567890') 
+      IF ((LOCAT < IENDB) .AND. (IDIGS == 0)) THEN
+C        ONLY DIGITS  AT END OF FILE BASENAME AFTER @@
+ 
+#if defined (SP_DBUGIO)
+        write(3,*)' In get_filnam_nstk    7777777 '
+        write(3,*)' In get_filnam_nstk; locat,idigs,iendb:',
+     &                                  locat,idigs,iendb
+        ilent = lnblnkn(fil_base)
+        write(3,*)' In get_filnam_nstk; fil_base ', 
+     &                                  fil_base(locat+1:ilent)
+c
+c        write(3,*)' In get_filnam_nstk; fil_base(:locat-1):',
+c     &                                  fil_base(:locat-1)
+c
+c        write(3,*)' In get_filnam_nstk; fil_base(locat+1:iendb) ',
+c     &                                  fil_base(locat+1:iendb)
+c
+c        ilent = lnblnkn(fil_base)
+c        write(3,*)' In get_filnam_nstk; fil_base ', 
+c     &                                  fil_base(locat+1:ilent)
+
+#endif
+
+        READ(FIL_BASE(LOCAT+1:IENDB),'(I10)',IOSTAT=IERR) NSTK_FLG
+
+        IF (IERR .NE. 0) THEN
+            WRITE(NOUT,*)
+     &        '*** CAN NOT GET STK NUMBER FROM: ',FIL_BASE(LOCAT:IENDB)
+            CALL ERRT(100,'get_filnam_nstk',NE)
+            IRTFLG = 1
+            RETURN
+        ENDIF
+
+        IS_STK    = .TRUE.
+
+        ILENT     = lnblnkn(FIL_DIRS)
+        FIL_NOAT  = FIL_DIRS(1:ILENT) // FIL_BASE(1:LOCAT-1)
+ 
+        ILENT     = lnblnkn(FIL_NOAT)
+        IF (GOT_EXT) FIL_NOAT = FIL_NOAT(1:ILENT) // '.' // FIL_EXT
+    
+        GOTO 999    
+ 
+      ENDIF
+
+      write(3,*) '  Should not get to this line!!!!!! '
+
+ 999  CONTINUE
+
+      LOCAST    = INDEX(FIL_NOAT,'*')
+
+#if defined (SP_DBUGIO)
+
+      write(3,*)'  '
+      !ilent = lnblnkn(fil_noat)
+      !write(3,*)' In get_filnam_nstk; lnblnkn fil_noat: ', ilent
+      !ilent = len(fil_noat)
+      !write(3,*)' In get_filnam_nstk; ilent fil_noat: ', ilent
+      !write(3,*)' End get_filnam_nstk; fil_noat: ',    fil_noat(:ilent)
+
+      ilent = lnblnkn(fil_noat)
+      write(3,*)' End get_filnam_nstk; fil_noat: ', fil_noat(1:ilent)
+
+      ilent = lnblnkn(fil_dirs)
+      write(3,*)' End get_filnam_nstk; fil_dirs: ', fil_dirs(1:ilent)
+
+      ilent = lnblnkn(fil_base)
+      write(3,*)' End get_filnam_nstk; fil_base: ', fil_base(1:ilent)
+
+      ilent = lnblnkn(fil_ext)
+      write(3,*)' End get_filnam_nstk; fil_ext:  ', fil_ext(1:ilent)
+
+      write(3,*)' End get_filnam_nstk; locast:   ', locast
+
+      write(3,*)' End get_filnam_nstk; nstk_flg,irtflg: ',
+     &                                 nstk_flg,irtflg
+   
+      write(3,*)' '
+
+
+
+        
+#endif
+
+      END
+
+
+
+@
+
+
+1.6
+log
+@defined (SP_DBUGIO)
+added  GET_IMG_STK subroutine
+@
+text
+@d6 1
+d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+d29 1
+a29 1
+C    GETFILENUM(FILNAM,IMGNUM,CALLERRT,IRTFLG)  
+d33 8
+a40 5
+C    PARAMETERS:     FILNAM    CHAR. VARIABLE FILE NAME         (SENT)
+C                    IMGNUM    NUMBER IN FILE NAME               (RET.)
+C                    NDIGITS   NUMBER OF DIGITS                  (RET.)
+C                    CALLERRT  CALL ERRT IF ERROR               (SENT)
+C                    IRTFLG    ERROR FLAG                       (RET.)
+d47 2
+d51 9
+a59 4
+       CHARACTER *(*) FILNAM
+       CHARACTER *1   CHARI
+       LOGICAL        CALLERRT
+    
+d62 1
+d69 1
+a69 1
+          IF (CHARI .LT. '0' .OR. CHARI .GT. '9') GOTO 10
+d73 1
+a73 1
+10     NDIGITS = NLET - IGO + 1
+d83 2
+a84 1
+     
+d95 25
+a119 1
+C ************************* GET_IMG_STK *******************************
+d121 2
+a122 2
+C   GET_IMG_STK(FILNAM,FIL_DIRS,FIL_BASE,FIL_EXT,
+C               ISMRC,LOCAST,NSTK,IRTFLG)
+d124 1
+a124 1
+C   PURPOSE:    FINDS FILE NUMBER AT END OF FILENAME
+d126 14
+a139 13
+C   PARAMETERS: FILNAM     CHAR. VARIABLE FILE NAME         (SENT)
+C               FIL_NOAT   CHAR. VARIABLE FILE NAME         (RET)
+C               FIL_DIRS   CHAR. VARIABLE FILE NAME         (RET)
+C               FIL_BASE   CHAR. VARIABLE FILE NAME         (RET)
+C               FIL_EXT    CHAR. VARIABLE FILE NAME         (RET)
+C               ISMRC      NUMBER IN FILE NAME              (RET.)
+C               LOCAST     LOCATION OF * IN FILE NAME       (RET.)
+C               NSTK       STACK IMG NUMBER FROM FILE NAME  (RET.)
+C                          -2 :  AST IN STACK   
+C                          -1 :  NOT A STACK   (NO @@)
+C                           0 :  BARE STACK
+C                          >1 :  STACKED IMAGE NUMBER
+C               CALLERRT   CALL ERRT IF ERROR               (SENT)
+d149 3
+a151 2
+      SUBROUTINE GET_IMG_STK(FILNAM,FIL_NOAT,FIL_DIRS,FIL_BASE,FIL_EXT,
+     &                ISMRC,LOCAST,NSTK,IRTFLG)
+d158 10
+a167 7
+      CHARACTER(LEN=*)      :: FILNAM,FIL_DIRS,FIL_BASE,FIL_EXT
+      CHARACTER(LEN=MAXNAM) :: FIL_NOAT
+      INTEGER               :: LOCAT,NSTK,IRTFLG
+
+      INTEGER               :: LOCSLASH,NLEN,IGO,LOCDOT,IEND,IASTSB4
+      INTEGER               :: IERR,NE,LOCAST,IDIGS,ilen,ILENT
+      LOGICAL               :: ISMRC,GOT_EXT
+d172 2
+a173 1
+      NLEN     = lnblnkn(FILNAM)
+d179 7
+a185 2
+      FIL_DIRS(1:) = NULL
+      IF (LOCSLASH > 0) FIL_DIRS = FILNAM(1:LOCSLASH+1)
+d187 9
+a195 4
+      !write(3,*)'0000000000000000000'
+      !write(3,*)' In get_img_stk; locslash:',locslash
+      !ilent = lnblnkn(fil_dirs)
+      !write(3,*)' In get_img_stk; fil_dirs: ', fil_dirs(1:ilent)
+a196 1
+C     FIND BEGINNING LOCATION OF EXTENSION IN FILNAM
+d198 1
+a198 1
+      IEND     = NLEN
+d200 2
+d204 22
+a225 1
+      !write(3,*)' In get_img_stk; nlen,locdot,ilent:',nlen,locdot,ilent
+a226 21
+      IF (LOCDOT > 0) FIL_EXT = FILNAM(LOCDOT+1:NLEN)
+      
+      !write(3,*)' in get_img_stk; nlen,locdot,ilent:',nlen,locdot,ilent
+         
+      ISMRC = .FALSE.
+      IF ((( (INDEX(FIL_EXT,'mrc') ) > 0) .OR. 
+     &      ((INDEX(FIL_EXT,'MRC') ) > 0) ))
+     &     ISMRC = .TRUE.
+
+C     STRIP OFF DIRECTORY(S) and EXTENSION
+      IF (LOCDOT .GT. 0 ) IEND = LOCDOT - 1 
+      FIL_BASE  = FILNAM(1:IEND) // NULL
+
+      IEND      = lnblnkn(FIL_BASE)
+      LOCAT     = INDEX(FIL_BASE(1:IEND),'@@')
+      LOCAST    = INDEX(FIL_BASE(1:IEND),'*')
+
+#if defined (SP_DBUGIO)
+      write(3,*)' In get_img_stk; locslash,locdot:',
+     &                            locslash,locdot
+      write(3,*)' In get_img_stk; locat,locast:',locat,locast
+d228 5
+a232 4
+      ilent = lnblnkn(filnam)
+      write(3,*)' In get_img_stk; filnam: ',   filnam(1:ilent)
+      ilent = lnblnkn(fil_dirs)
+      write(3,*)' In get_img_stk; fil_dirs: ', fil_dirs(1:ilent)
+d234 1
+a234 3
+      write(3,*)' In get_img_stk; fil_base: ', fil_base(1:ilent) 
+      ilent = lnblnkn(fil_ext)
+      write(3,*)' In get_img_stk; fil_ext: ',  fil_ext(1:ilent) 
+d237 11
+d250 16
+a265 3
+      IF (LOCAT <= 0) THEN
+ 
+         !write(3,*) '  1111111111111111111111111 '
+d267 1
+d269 2
+a270 3
+         LOCAST    = INDEX(FIL_NOAT,'*')
+         NSTK      = -1   ! NOT A STACK
+         GOTO 999    !RETURN
+d275 3
+a277 1
+         !write(3,*) '  222222222222222222222 '
+d279 4
+a282 2
+         NSTK      = -1      ! BARESTACK
+         FIL_BASE  = FIL_BASE(2:IEND)
+d285 1
+a285 2
+         LOCAST    = INDEX(FIL_NOAT,'*')
+         !RETURN
+d287 1
+a287 1
+      ELSEIF (LOCAT == IEND ) THEN
+d290 7
+a296 1
+        !write(3,*) '  33333333333333333333333 '
+a297 2
+         NSTK      = -1      ! BARESTACK
+         FIL_BASE  = FIL_BASE(1:IEND-1) // NULL
+d302 1
+a302 2
+         LOCAST    = INDEX(FIL_NOAT,'*')
+         GOTO 999    !RETURN
+d306 4
+a309 3
+      !write(3,*) '  33333  to  4444444 '
+
+     
+d314 6
+a319 1
+         write(3,*) ' 44444444444444444 '
+a320 2
+         NSTK      = -2      ! (*)@@
+         FIL_BASE  = FIL_BASE(LOCAT+1:IEND) // NULL
+d322 2
+a323 1
+         FIL_NOAT  = FIL_DIRS(1:ILENT) // FIL_BASE 
+d326 1
+a326 2
+         LOCAST    = INDEX(FIL_NOAT,'*')
+         GOTO 999    !RETURN
+d329 3
+a331 2
+      !write(3,*) '   4444444 to  55555555555 '
+
+d333 1
+a333 1
+      IASTSB4 = VERIFY(FIL_BASE(LOCAT+1:IEND),'*') 
+d338 4
+a341 4
+       write(3,*)' 55555555; ilen: ', ilen
+       write(3,*)' 55555555; iastsb4,locat: ', iastsb4,locat
+       write(3,*)' 55555555; iastsb4,fil_base: ', iastsb4,fil_base
+       write(3,*)' 55555555; fil_base(1:locat) ', fil_base(1:locat)
+d343 6
+a348 2
+         NSTK      = -2       ! @@(*)
+         FIL_BASE  = FIL_BASE(1:LOCAT-1) // NULL
+d353 2
+a354 2
+         LOCAST    = INDEX(FIL_NOAT,'*')
+         GOTO 999    !RETURN
+a356 1
+      !write(3,*) '   5555555555   TO  7777777777777 '
+d358 3
+d363 1
+d367 3
+a369 1
+         !write(3,*) '  777777777777777 '
+d371 1
+a371 1
+          READ(FIL_BASE(1:LOCAT-1),'(I10)',IOSTAT=IERR) NSTK
+d375 1
+a375 1
+             CALL ERRT(100,'GET_IMG_STK',NE)
+d380 2
+a381 1
+         FIL_BASE  = FIL_BASE(LOCAT+1:) // NULL
+d383 2
+a384 1
+         FIL_NOAT  = FIL_DIRS(1:ILENT) // FIL_BASE 
+d387 1
+a387 1
+         LOCAST    = INDEX(FIL_NOAT,'*')
+d391 4
+a394 1
+ 
+d396 2
+a397 2
+      IDIGS = VERIFY(FIL_BASE(LOCAT+1:IEND),'1234567890') 
+      IF ((LOCAT < IEND) .AND. (IDIGS == 0)) THEN
+d400 17
+a416 2
+       !write(3,*)' 9999; locat,idigs,iend:', locat,idigs,iend
+       !write(3,*)' 9999; fil_base ',  fil_base
+d418 1
+a418 1
+       !write(3,*)' 9999; fil_base(1:locat-1): ', fil_base(1:locat-1)
+d420 1
+a420 2
+       !write(3,*)' 9999; fil_base(locat+1:iend) ',
+       !&                 fil_base(locat+1:iend)
+d422 7
+a428 1
+        write(3,*) '  88888888888888888 '
+d430 1
+a430 16
+         READ(FIL_BASE(LOCAT+1:IEND),'(I10)',IOSTAT=IERR) NSTK
+         IF (IERR .NE. 0) THEN
+             WRITE(NOUT,*)
+     &         '*** CAN NOT GET STK NUMBER FROM: ',FIL_BASE(LOCAT:IEND)
+             CALL ERRT(100,'GET_IMG_STK',NE)
+             IRTFLG = 1
+             RETURN
+         ENDIF
+
+         FIL_BASE  = FIL_BASE(1:LOCAT-1) // NULL
+     
+         ! ilent = lnblnkn(fil_base)
+         !write(3,*)' 99997777; fil_base: ', fil_base
+
+         ILENT     = lnblnkn(FIL_DIRS)
+         FIL_NOAT  = FIL_DIRS(1:ILENT) // FIL_BASE 
+d432 2
+a433 2
+         ILENT     = lnblnkn(FIL_NOAT)
+         IF (GOT_EXT) FIL_NOAT = FIL_NOAT(1:ILENT) // '.' // FIL_EXT
+d435 3
+a437 7
+        LOCAST    = INDEX(FIL_BASE,'*')
+
+        !ilent = lnblnkn(fil_noat)
+        !write(3,*)' 999999999999; fil_noat:', fil_noat(1:ilent)
+        !ilent = lnblnkn(fil_base)
+        !write(3,*)' 99999999 nstk,irtflg: ', nstk,irtflg,locast
+
+a439 1
+        !RETURN
+d444 1
+d446 1
+a446 1
+ 999  CONTINUE
+a448 14
+      ilen = lnblnkn(fil_noat)
+      write(3,*)' End get_img_stk; fil_noat: ',    fil_noat(1:ilen)
+      ilen = lnblnkn(fil_dirs)
+      write(3,*)' End get_img_stk; fil_dirs: ',    fil_dirs(1:ilen)
+      ilen = lnblnkn(fil_base)
+      write(3,*)' End get_img_stk; fil_base: ',    fil_base(1:ilen)
+      ilen = lnblnkn(fil_ext)
+      write(3,*)' End get_img_stk; fil_ext: ',     fil_ext(1:ilen)
+
+      write(3,*)' End get_img_stk; nstk,irtflg: ', nstk,irtflg
+
+      LOCAST = INDEX(FIL_BASE,'*')
+     
+      write(3,*)' End get_img_stk; locast: ', locast
+d450 24
+d475 4
+@
+
+
+1.5
+log
+@email_health_dept
+@
+text
+@d26 1
+a26 2
+C *******************************************************************C **********************************************************************
+C
+d80 285
 @
 
 
diff --git src/RCS/getima_q.f,v src/RCS/getima_q.f,v
index 74ca9fdb..15386612 100644
--- src/RCS/getima_q.f,v
+++ src/RCS/getima_q.f,v
@@ -1,4 +1,4 @@
-head	1.13;
+head	1.14;
 access;
 symbols
 	pre_mrcs:1.13
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.14
+date	2025.11.10.22.33.18;	author dean;	state Exp;
+branches;
+next	1.13;
+
 1.13
 date	2018.10.03.14.34.07;	author leith;	state Exp;
 branches;
@@ -94,9 +99,9 @@ desc
 @@
 
 
-1.13
+1.14
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -111,7 +116,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -174,6 +179,17 @@ C          MUST READ IN IMAGE FROM FILE
 @
 
 
+1.13
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.12
 log
 @LEN=MAXNAM
diff --git src/RCS/getlbno.f,v src/RCS/getlbno.f,v
index ba93a5e5..9a2687a3 100644
--- src/RCS/getlbno.f,v
+++ src/RCS/getlbno.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,16 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.09.22.13.02.23;	author dean;	state Exp;
+branches;
+next	1.10;
+
+1.10
+date	2025.09.22.12.59.46;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.07;	author leith;	state Exp;
 branches;
@@ -74,9 +84,9 @@ desc
 @@
 
 
-1.9
+1.11
 log
-@email_health_dept
+@bug ;
 @
 text
 @
@@ -89,7 +99,7 @@ C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2015  Health Research Inc.,                         *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
 C=* Email: spider@@health.ny.gov                                        *
 C=*                                                                    *
@@ -124,11 +134,18 @@ C--*********************************************************************
         CHARACTER(LEN=80) :: TEMP1
         LOGICAL           :: ISDIGI
 
-        LBNO   = -1
-        IRTFLG = 0
+        INTEGER           :: LBNO,IRTFLG
+        INTEGER           :: NCHAR1,IGO,NCHAR
+
+
+        IRTFLG = 0        ! UNUSED?
+        LBNO   = -1       ! ERROR RETURN
 
 C       FIND LAST NON-BLANK            
         NCHAR1 = lnblnk(STRING)
+        
+C       WHAT IF IT IS ZERO?
+        IF (NCHAR1 .LE. 0) RETURN
 
         TEMP1 = STRING(1:NCHAR1)
         CALL SSUPCAS(TEMP1)
@@ -142,9 +159,13 @@ C       FIND LAST NON-BLANK
            NCHAR = 3
         ENDIF 
 
+        !write(3,*)' In getlbno: igo,temp1,string:', igo, temp1,string
+
         READ(TEMP1(IGO+2:IGO+2+NCHAR-1),8000) LBNO
 8000    FORMAT(I6)
 
+        !write(3,*)' In getlbno: string,lbno:', temp1,string
+
 	END
 
 
@@ -152,6 +173,36 @@ C       FIND LAST NON-BLANK
 @
 
 
+1.10
+log
+@handle nchar1 of zero
+@
+text
+@d50 2
+a51 2
+        IRTFLG = 0        ; UNUSED?
+        LBNO   = -1       ; ERROR RETURN
+@
+
+
+1.9
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Copyright 1985-2015  Health Research Inc.,                         *
+d46 6
+a51 2
+        LBNO   = -1
+        IRTFLG = 0
+d55 3
+d71 2
+d75 2
+@
+
+
 1.8
 log
 @==, comments
diff --git src/RCS/getnexttoken.f,v src/RCS/getnexttoken.f,v
index d0dc3be3..5e10b67e 100644
--- src/RCS/getnexttoken.f,v
+++ src/RCS/getnexttoken.f,v
@@ -1,4 +1,4 @@
-head	1.12;
+head	1.13;
 access;
 symbols
 	pre_mrcs:1.12
@@ -22,6 +22,11 @@ locks; strict;
 comment	@c @;
 
 
+1.13
+date	2025.09.21.14.54.42;	author dean;	state Exp;
+branches;
+next	1.12;
+
 1.12
 date	2018.10.03.14.34.07;	author leith;	state Exp;
 branches;
@@ -87,9 +92,9 @@ desc
 @@
 
 
-1.12
+1.13
 log
-@email_health_dept
+@BUGGY 2025??CHARACTER(LEN=NLET)      :: RECLIN
 @
 text
 @C++*********************************************************************
@@ -106,7 +111,6 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2011  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -417,8 +421,10 @@ C      FILLS TOKENS ARRAY WITH CONSECUTIVE TOKENS FROM A LINE
        IMPLICIT NONE
        INCLUDE 'CMBLOCK.INC'
 
-       CHARACTER(LEN=NLET)      :: RECLIN          ! TOKEN LINE  (SENT)
+
        INTEGER                  :: NLET            ! LINE LENGTH (SENT)
+       CHARACTER(LEN=NLET)      :: RECLIN          ! TOKEN LINE  (SENT)
+
        INTEGER                  :: MAXLENTOK,NTOKSMAX  ! (SENT)
        CHARACTER(LEN=MAXLENTOK) :: TOKENS(NTOKSMAX)! TOKEN FIELDS
        LOGICAL                  :: INSIDE          ! DELIM IS INSIDE (SENT)
@@ -487,7 +493,8 @@ C      WILL PARTITION SUCH FIELDS INTO MULTIPLE TOKENS.
        IMPLICIT NONE
        INCLUDE 'CMBLOCK.INC'
 
-       CHARACTER(LEN=NLET)      :: RECLIN          ! TOKEN LINE  (SENT)
+C       BUGGY 2025??CHARACTER(LEN=NLET)      :: RECLIN          ! TOKEN LINE  (SENT)
+       CHARACTER(LEN=*)      :: RECLIN          ! TOKEN LINE  (SENT)
        INTEGER                  :: NLET            ! LINE LENGTH (SENT)
        INTEGER                  :: MAXLENTOK,NTOKSMAX  ! (SENT)
        CHARACTER(LEN=MAXLENTOK) :: TOKENS(NTOKSMAX)! TOKEN FIELDS
@@ -590,6 +597,23 @@ C           PUT TOKEN IN LIST FOR RETURN
 @
 
 
+1.12
+log
+@email_health_dept
+@
+text
+@a14 1
+C=* Email: spider@@health.ny.gov                                        *
+d325 2
+d328 1
+a328 1
+       INTEGER                  :: NLET            ! LINE LENGTH (SENT)
+d397 2
+a398 1
+       CHARACTER(LEN=NLET)      :: RECLIN          ! TOKEN LINE  (SENT)
+@
+
+
 1.11
 log
 @added 7 digit max integer field hack  subroutine
diff --git src/RCS/getsym.f,v src/RCS/getsym.f,v
index b0ba463e..abc91eca 100644
--- src/RCS/getsym.f,v
+++ src/RCS/getsym.f,v
@@ -1,4 +1,4 @@
-head	1.6;
+head	1.7;
 access;
 symbols
 	pre_mrcs:1.6
@@ -20,6 +20,11 @@ locks; strict;
 comment	@c @;
 
 
+1.7
+date	2025.11.10.22.33.18;	author dean;	state Exp;
+branches;
+next	1.6;
+
 1.6
 date	2018.10.03.14.34.07;	author leith;	state Exp;
 branches;
@@ -56,9 +61,9 @@ desc
 @
 
 
-1.6
+1.7
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -67,7 +72,7 @@ C=**********************************************************************
 C=* From: SPIDER - MODULAR IMAGE PROCESSING SYSTEM                     *
 C=* Copyright (C)2000  M. Radermacher                                  *
 C=*                                                                    *
-C=* Email:  spider@@health.ny.gov                                       *
+C=* Email:  spider@@wadsworth.org                                       *
 C=*                                                                    *
 C=* This program is free software; you can redistribute it and/or      *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -123,6 +128,17 @@ C=**********************************************************************
 @
 
 
+1.6
+log
+@email_health_dept
+@
+text
+@d7 1
+a7 1
+C=* Email:  spider@@health.ny.gov                                       *
+@
+
+
 1.5
 log
 @GPL License fixed
diff --git src/RCS/getthreads.f,v src/RCS/getthreads.f,v
index 872b779d..27d35288 100644
--- src/RCS/getthreads.f,v
+++ src/RCS/getthreads.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -22,6 +22,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.33.18;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.34.07;	author leith;	state Exp;
 branches;
@@ -67,9 +72,9 @@ desc
 @@
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -84,7 +89,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -129,6 +134,17 @@ c$omp end parallel
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @GPL_2010
diff --git src/RCS/gnc.f,v src/RCS/gnc.f,v
index c0cea98d..0c6841dd 100644
--- src/RCS/gnc.f,v
+++ src/RCS/gnc.f,v
@@ -1,4 +1,4 @@
-head	1.15;
+head	1.16;
 access;
 symbols
 	pre_mrcs:1.15
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.16
+date	2025.11.10.22.33.18;	author dean;	state Exp;
+branches;
+next	1.15;
+
 1.15
 date	2018.10.03.14.34.07;	author leith;	state Exp;
 branches;
@@ -105,9 +110,9 @@ desc
 @
 
 
-1.15
+1.16
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -120,7 +125,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -188,6 +193,17 @@ C***********************************************************************
 @
 
 
+1.15
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.14
 log
 @GPL_2010
diff --git src/RCS/gnc2s.f,v src/RCS/gnc2s.f,v
index ae1a07c4..afe7e1e9 100644
--- src/RCS/gnc2s.f,v
+++ src/RCS/gnc2s.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.33.18;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.07;	author leith;	state Exp;
 branches;
@@ -80,9 +85,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -95,7 +100,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -445,6 +450,17 @@ C       PRINT *,P,ER
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @GPL_2010
diff --git src/RCS/gotbranch.f,v src/RCS/gotbranch.f,v
index ce20c6bf..bd9a9e19 100644
--- src/RCS/gotbranch.f,v
+++ src/RCS/gotbranch.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.33.19;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.34.07;	author leith;	state Exp;
 branches;
@@ -70,9 +75,9 @@ desc
 @
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -86,7 +91,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -160,6 +165,17 @@ C        RAN OUT OF SPACE IN IEQUIV ARRAY
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @GPL_2010
diff --git src/RCS/gp.f,v src/RCS/gp.f,v
index 8147049a..edf311c1 100644
--- src/RCS/gp.f,v
+++ src/RCS/gp.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.33.19;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.07;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C
@@ -91,7 +96,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -136,6 +141,17 @@ C       USED IN GNC2S.FOR  DEC 90 AL
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/gprp.f,v src/RCS/gprp.f,v
index 1220c067..8395d76d 100644
--- src/RCS/gprp.f,v
+++ src/RCS/gprp.f,v
@@ -1,4 +1,4 @@
-head	1.7;
+head	1.8;
 access;
 symbols
 	pre_mrcs:1.7
@@ -20,6 +20,11 @@ locks; strict;
 comment	@c @;
 
 
+1.8
+date	2025.11.10.22.33.19;	author dean;	state Exp;
+branches;
+next	1.7;
+
 1.7
 date	2018.10.03.14.34.07;	author leith;	state Exp;
 branches;
@@ -60,9 +65,9 @@ desc
 @@
 
 
-1.7
+1.8
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -76,7 +81,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -188,6 +193,17 @@ C          SET UNDETERMINED STATISTICS FLAG
 @
 
 
+1.7
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.6
 log
 @GPL_2010
diff --git src/RCS/graphp.f,v src/RCS/graphp.f,v
index 950a245c..b2982651 100644
--- src/RCS/graphp.f,v
+++ src/RCS/graphp.f,v
@@ -1,4 +1,4 @@
-head	1.13;
+head	1.14;
 access;
 symbols
 	pre_mrcs:1.13
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.14
+date	2025.11.10.22.33.19;	author dean;	state Exp;
+branches;
+next	1.13;
+
 1.13
 date	2018.10.03.14.34.07;	author leith;	state Exp;
 branches;
@@ -95,9 +100,9 @@ desc
 @
 
 
-1.13
+1.14
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -111,7 +116,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -174,6 +179,17 @@ C       PLOT THE LINE
 @
 
 
+1.13
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.12
 log
 @GPL_2010
diff --git src/RCS/graphs.f,v src/RCS/graphs.f,v
index a972de18..e3dcd15e 100644
--- src/RCS/graphs.f,v
+++ src/RCS/graphs.f,v
@@ -1,4 +1,4 @@
-head	1.13;
+head	1.14;
 access;
 symbols
 	pre_mrcs:1.13
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.14
+date	2025.11.10.22.33.19;	author dean;	state Exp;
+branches;
+next	1.13;
+
 1.13
 date	2018.10.03.14.34.07;	author leith;	state Exp;
 branches;
@@ -95,9 +100,9 @@ desc
 @
 
 
-1.13
+1.14
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -111,7 +116,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -339,6 +344,17 @@ C     LABEL  X AXIS, WITH SCALES
 @
 
 
+1.13
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.12
 log
 @cosmetic
diff --git src/RCS/gsmod.f,v src/RCS/gsmod.f,v
index b777a2fc..97ec33d5 100644
--- src/RCS/gsmod.f,v
+++ src/RCS/gsmod.f,v
@@ -1,4 +1,4 @@
-head	1.6;
+head	1.7;
 access;
 symbols
 	pre_mrcs:1.6
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.7
+date	2025.11.10.22.33.19;	author dean;	state Exp;
+branches;
+next	1.6;
+
 1.6
 date	2018.10.03.14.34.07;	author leith;	state Exp;
 branches;
@@ -60,9 +65,9 @@ desc
 @
 
 
-1.6
+1.7
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C
@@ -76,7 +81,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -190,6 +195,17 @@ c
 @
 
 
+1.6
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.5
 log
 @GPL_2010
diff --git src/RCS/gsmodl.f,v src/RCS/gsmodl.f,v
index 126cc21a..25621ccd 100644
--- src/RCS/gsmodl.f,v
+++ src/RCS/gsmodl.f,v
@@ -1,4 +1,4 @@
-head	1.6;
+head	1.7;
 access;
 symbols
 	pre_mrcs:1.6
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.7
+date	2025.11.10.22.33.19;	author dean;	state Exp;
+branches;
+next	1.6;
+
 1.6
 date	2018.10.03.14.34.07;	author leith;	state Exp;
 branches;
@@ -60,9 +65,9 @@ desc
 @
 
 
-1.6
+1.7
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -77,7 +82,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -177,6 +182,17 @@ c
 @
 
 
+1.6
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.5
 log
 @GPL_2010
diff --git src/RCS/hali.f,v src/RCS/hali.f,v
index 7db509e3..88180587 100644
--- src/RCS/hali.f,v
+++ src/RCS/hali.f,v
@@ -1,4 +1,4 @@
-head	1.31;
+head	1.32;
 access;
 symbols
 	pre_mrcs:1.31
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.32
+date	2025.11.10.22.33.19;	author dean;	state Exp;
+branches;
+next	1.31;
+
 1.31
 date	2018.10.03.14.34.07;	author leith;	state Exp;
 branches;
@@ -185,9 +190,9 @@ desc
 @
 
 
-1.31
+1.32
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C **********************************************************************
@@ -204,7 +209,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -385,7 +390,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -725,6 +730,20 @@ c$omp   parallel do private(i,j,nsirt,arg,c)
 @
 
 
+1.31
+log
+@email_health_dept
+@
+text
+@d15 1
+a15 1
+C=* Email: spider@@health.ny.gov                                        *
+d196 1
+a196 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.30
 log
 @!CLOSE(LUNIN) bug?? j
diff --git src/RCS/hclp.f,v src/RCS/hclp.f,v
index ae975510..6100ffc2 100644
--- src/RCS/hclp.f,v
+++ src/RCS/hclp.f,v
@@ -1,4 +1,4 @@
-head	1.21;
+head	1.22;
 access;
 symbols
 	pre_mrcs:1.21
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.22
+date	2025.11.10.22.33.19;	author dean;	state Exp;
+branches;
+next	1.21;
+
 1.21
 date	2018.10.03.14.34.07;	author leith;	state Exp;
 branches;
@@ -135,9 +140,9 @@ desc
 @
 
 
-1.21
+1.22
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -154,7 +159,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2013  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -218,6 +223,17 @@ C        CLASSIFICATION TREE OF THE NKLA CENTERS
 @
 
 
+1.21
+log
+@email_health_dept
+@
+text
+@d15 1
+a15 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.20
 log
 @.
diff --git src/RCS/hcls.f,v src/RCS/hcls.f,v
index 1b8fa68f..13a951e4 100644
--- src/RCS/hcls.f,v
+++ src/RCS/hcls.f,v
@@ -1,4 +1,4 @@
-head	1.35;
+head	1.36;
 access;
 symbols
 	pre_mrcs:1.35
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.36
+date	2025.11.10.22.33.19;	author dean;	state Exp;
+branches;
+next	1.35;
+
 1.35
 date	2018.10.03.14.34.07;	author leith;	state Exp;
 branches;
@@ -205,9 +210,9 @@ desc
 @
 
 
-1.35
+1.36
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -223,7 +228,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -401,6 +406,17 @@ C        CALCULATE NUMBER OF FACTORS
 @
 
 
+1.35
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.34
 log
 @*** empty log message ***
diff --git src/RCS/hdiag.f,v src/RCS/hdiag.f,v
index a8fb21f5..32a6855d 100644
--- src/RCS/hdiag.f,v
+++ src/RCS/hdiag.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.33.19;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.07;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -91,7 +96,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -251,6 +256,17 @@ C***********************************************************************
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/hdls.f,v src/RCS/hdls.f,v
index 45712b3a..a0ec889f 100644
--- src/RCS/hdls.f,v
+++ src/RCS/hdls.f,v
@@ -1,4 +1,4 @@
-head	1.16;
+head	1.17;
 access;
 symbols
 	pre_mrcs:1.16
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.17
+date	2025.11.10.22.33.20;	author dean;	state Exp;
+branches;
+next	1.16;
+
 1.16
 date	2018.10.03.14.34.07;	author leith;	state Exp;
 branches;
@@ -110,9 +115,9 @@ desc
 @
 
 
-1.16
+1.17
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -126,7 +131,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -286,6 +291,17 @@ C       SET OPERATION LINE REGISTERS TO NCLAS
 @
 
 
+1.16
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.15
 log
 @GPL_2010
diff --git src/RCS/hels.f,v src/RCS/hels.f,v
index 8a8bf3f6..492a81dd 100644
--- src/RCS/hels.f,v
+++ src/RCS/hels.f,v
@@ -1,4 +1,4 @@
-head	1.14;
+head	1.15;
 access;
 symbols
 	pre_mrcs:1.14
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.15
+date	2025.11.10.22.33.20;	author dean;	state Exp;
+branches;
+next	1.14;
+
 1.14
 date	2018.10.03.14.34.07;	author leith;	state Exp;
 branches;
@@ -100,9 +105,9 @@ desc
 @
 
 
-1.14
+1.15
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -115,7 +120,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -301,6 +306,17 @@ C                  123456789 123456789 123456789 123456
 @
 
 
+1.14
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.13
 log
 @enter
diff --git src/RCS/hgr.f,v src/RCS/hgr.f,v
index f58153ba..c42808f5 100644
--- src/RCS/hgr.f,v
+++ src/RCS/hgr.f,v
@@ -1,4 +1,4 @@
-head	1.13;
+head	1.14;
 access;
 symbols
 	pre_mrcs:1.13
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.14
+date	2025.11.10.22.33.20;	author dean;	state Exp;
+branches;
+next	1.13;
+
 1.13
 date	2018.10.03.14.34.07;	author leith;	state Exp;
 branches;
@@ -95,9 +100,9 @@ desc
 @
 
 
-1.13
+1.14
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -110,7 +115,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -290,6 +295,17 @@ C
 @
 
 
+1.13
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.12
 log
 @GPL_2010
diff --git src/RCS/hiang.f,v src/RCS/hiang.f,v
index aa2536e0..d18ad81f 100644
--- src/RCS/hiang.f,v
+++ src/RCS/hiang.f,v
@@ -1,4 +1,4 @@
-head	1.19;
+head	1.20;
 access;
 symbols
 	pre_mrcs:1.19
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.20
+date	2025.11.10.22.33.20;	author dean;	state Exp;
+branches;
+next	1.19;
+
 1.19
 date	2018.10.03.14.34.07;	author leith;	state Exp;
 branches;
@@ -125,9 +130,9 @@ desc
 @
 
 
-1.19
+1.20
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -140,7 +145,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2011  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -245,6 +250,17 @@ C       NANG=LO
 @
 
 
+1.19
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.18
 log
 @cosmetic
diff --git src/RCS/hisd.f,v src/RCS/hisd.f,v
index d4ec011d..de9bc371 100644
--- src/RCS/hisd.f,v
+++ src/RCS/hisd.f,v
@@ -1,4 +1,4 @@
-head	1.19;
+head	1.20;
 access;
 symbols
 	pre_mrcs:1.19
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.20
+date	2025.11.10.22.33.20;	author dean;	state Exp;
+branches;
+next	1.19;
+
 1.19
 date	2018.10.03.14.34.08;	author leith;	state Exp;
 branches;
@@ -125,9 +130,9 @@ desc
 @
 
 
-1.19
+1.20
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -144,7 +149,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2015  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -373,6 +378,17 @@ C           ECHO TO RESULTS FILE
 @
 
 
+1.19
+log
+@email_health_dept
+@
+text
+@d15 1
+a15 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.18
 log
 @wantdoc declared
diff --git src/RCS/hismap.f,v src/RCS/hismap.f,v
index 7b97540b..b8a6b388 100644
--- src/RCS/hismap.f,v
+++ src/RCS/hismap.f,v
@@ -1,4 +1,4 @@
-head	1.21;
+head	1.22;
 access;
 symbols
 	pre_mrcs:1.21
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.22
+date	2025.11.10.22.33.20;	author dean;	state Exp;
+branches;
+next	1.21;
+
 1.21
 date	2018.10.03.14.34.08;	author leith;	state Exp;
 branches;
@@ -135,9 +140,9 @@ desc
 @
 
 
-1.21
+1.22
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -153,7 +158,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -472,6 +477,17 @@ C      DRAW LINE ACROSS PAGE
 @
 
 
+1.21
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.20
 log
 @rewrite for scaling bug
diff --git src/RCS/hismap4.f,v src/RCS/hismap4.f,v
index fa9d86c0..2dc4fdaf 100644
--- src/RCS/hismap4.f,v
+++ src/RCS/hismap4.f,v
@@ -1,4 +1,4 @@
-head	1.18;
+head	1.19;
 access;
 symbols
 	pre_mrcs:1.18
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.19
+date	2025.11.10.22.33.20;	author dean;	state Exp;
+branches;
+next	1.18;
+
 1.18
 date	2018.10.03.14.34.08;	author leith;	state Exp;
 branches;
@@ -120,9 +125,9 @@ desc
 @
 
 
-1.18
+1.19
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -141,7 +146,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -306,6 +311,17 @@ C     CLOSE THE POSTSCRIPT-FILE
 @
 
 
+1.18
+log
+@email_health_dept
+@
+text
+@d17 1
+a17 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.17
 log
 @klic overflow bug fixed, ==, cosmetic
diff --git src/RCS/hist.f,v src/RCS/hist.f,v
index 031c35d8..14400345 100644
--- src/RCS/hist.f,v
+++ src/RCS/hist.f,v
@@ -1,4 +1,4 @@
-head	1.43;
+head	1.44;
 access;
 symbols
 	pre_mrcs:1.43
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.44
+date	2025.11.10.22.33.20;	author dean;	state Exp;
+branches;
+next	1.43;
+
 1.43
 date	2018.10.03.14.34.08;	author leith;	state Exp;
 branches;
@@ -245,9 +250,9 @@ desc
 @
 
 
-1.43
+1.44
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -265,7 +270,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -589,6 +594,17 @@ C              PIXEL HAS POSITIVE MASK VALUE
 @
 
 
+1.43
+log
+@email_health_dept
+@
+text
+@d16 1
+a16 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.42
 log
 @nx,  prompts
diff --git src/RCS/histe.f,v src/RCS/histe.f,v
index f692fc72..cdd7309e 100644
--- src/RCS/histe.f,v
+++ src/RCS/histe.f,v
@@ -1,4 +1,4 @@
-head	1.13;
+head	1.14;
 access;
 symbols
 	pre_mrcs:1.13
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.14
+date	2025.11.10.22.33.20;	author dean;	state Exp;
+branches;
+next	1.13;
+
 1.13
 date	2018.10.03.14.34.08;	author leith;	state Exp;
 branches;
@@ -95,9 +100,9 @@ desc
 @
 
 
-1.13
+1.14
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -110,7 +115,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -489,6 +494,17 @@ C                   FHT2(AK,NSR1,LENH,QK2,QK4,QK5,QK6,RXR,XRMI)
 @
 
 
+1.13
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.12
 log
 @GPL_2010
diff --git src/RCS/histod.f,v src/RCS/histod.f,v
index f716a9d5..ce76a146 100644
--- src/RCS/histod.f,v
+++ src/RCS/histod.f,v
@@ -1,4 +1,4 @@
-head	1.15;
+head	1.16;
 access;
 symbols
 	pre_mrcs:1.15
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.16
+date	2025.11.10.22.33.21;	author dean;	state Exp;
+branches;
+next	1.15;
+
 1.15
 date	2018.10.03.14.34.08;	author leith;	state Exp;
 branches;
@@ -105,9 +110,9 @@ desc
 @
 
 
-1.15
+1.16
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -120,7 +125,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -192,6 +197,17 @@ C--*********************************************************************
 @
 
 
+1.15
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.14
 log
 @GPL_2010
diff --git src/RCS/histodc.f,v src/RCS/histodc.f,v
index d1292d3c..cb200f43 100644
--- src/RCS/histodc.f,v
+++ src/RCS/histodc.f,v
@@ -1,4 +1,4 @@
-head	1.16;
+head	1.17;
 access;
 symbols
 	pre_mrcs:1.16
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.17
+date	2025.11.10.22.33.21;	author dean;	state Exp;
+branches;
+next	1.16;
+
 1.16
 date	2018.10.03.14.34.08;	author leith;	state Exp;
 branches;
@@ -110,9 +115,9 @@ desc
 @
 
 
-1.16
+1.17
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -125,7 +130,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -240,6 +245,17 @@ C        IF(NSEL(3).NE.0)  PARAM(NSEL(3))=C
 @
 
 
+1.16
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.15
 log
 @GPL_2010
diff --git src/RCS/histog.f,v src/RCS/histog.f,v
index 2d7808f0..efe9ddcb 100644
--- src/RCS/histog.f,v
+++ src/RCS/histog.f,v
@@ -1,4 +1,4 @@
-head	1.4;
+head	1.5;
 access;
 symbols
 	pre_mrcs:1.4
@@ -7,6 +7,11 @@ locks; strict;
 comment	@c @;
 
 
+1.5
+date	2025.11.10.22.33.21;	author dean;	state Exp;
+branches;
+next	1.4;
+
 1.4
 date	2018.10.03.14.34.08;	author leith;	state Exp;
 branches;
@@ -32,9 +37,9 @@ desc
 @@
 
 
-1.4
+1.5
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -52,7 +57,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -476,6 +481,17 @@ C              PIXEL HAS POSITIVE MASK VALUE
 @
 
 
+1.4
+log
+@email_health_dept
+@
+text
+@d16 1
+a16 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.3
 log
 @undedefined ndev if creating doc output
diff --git src/RCS/hkmc.f,v src/RCS/hkmc.f,v
index f1621eb9..c6897b6f 100644
--- src/RCS/hkmc.f,v
+++ src/RCS/hkmc.f,v
@@ -1,4 +1,4 @@
-head	1.15;
+head	1.16;
 access;
 symbols
 	pre_mrcs:1.15
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.16
+date	2025.11.10.22.33.21;	author dean;	state Exp;
+branches;
+next	1.15;
+
 1.15
 date	2018.10.03.14.34.08;	author leith;	state Exp;
 branches;
@@ -105,9 +110,9 @@ desc
 @
 
 
-1.15
+1.16
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -121,7 +126,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -421,6 +426,17 @@ C
 @
 
 
+1.15
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.14
 log
 @NOUT --> NDUM in parameters since I used CMBLOCK for verbose
diff --git src/RCS/iftorpn.f,v src/RCS/iftorpn.f,v
index d022a547..016d58df 100644
--- src/RCS/iftorpn.f,v
+++ src/RCS/iftorpn.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -25,6 +25,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.33.22;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.08;	author leith;	state Exp;
 branches;
@@ -86,9 +91,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -107,7 +112,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2011  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -236,6 +241,17 @@ C     ERROR HANDLER --------------------------------------------
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d17 1
+a17 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @! COMMENT DELIMITER
diff --git src/RCS/imseq4.f,v src/RCS/imseq4.f,v
index fdd7772e..c2fed66b 100644
--- src/RCS/imseq4.f,v
+++ src/RCS/imseq4.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.33.22;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.08;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -91,7 +96,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -137,6 +142,17 @@ C***********************************************************************
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/imsq.f,v src/RCS/imsq.f,v
index 2f37a573..2448d95f 100644
--- src/RCS/imsq.f,v
+++ src/RCS/imsq.f,v
@@ -1,4 +1,4 @@
-head	1.12;
+head	1.13;
 access;
 symbols
 	pre_mrcs:1.12
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.13
+date	2025.11.10.22.33.22;	author dean;	state Exp;
+branches;
+next	1.12;
+
 1.12
 date	2018.10.03.14.34.08;	author leith;	state Exp;
 branches;
@@ -90,9 +95,9 @@ desc
 @
 
 
-1.12
+1.13
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -107,7 +112,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -253,6 +258,17 @@ C       WRITE TO OUTPUT FILE ON LUNOUT
 @
 
 
+1.12
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.11
 log
 @GPL_2010
diff --git src/RCS/imstat.f,v src/RCS/imstat.f,v
index 9787eb0b..630c705a 100644
--- src/RCS/imstat.f,v
+++ src/RCS/imstat.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.33.22;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.34.08;	author leith;	state Exp;
 branches;
@@ -70,9 +75,9 @@ desc
 @
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -86,7 +91,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -153,6 +158,17 @@ C         WILL NOT WORK RIGHT
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @GPL_2010
diff --git src/RCS/imtovol.f,v src/RCS/imtovol.f,v
index 238a4536..eb31ee20 100644
--- src/RCS/imtovol.f,v
+++ src/RCS/imtovol.f,v
@@ -1,4 +1,4 @@
-head	1.14;
+head	1.15;
 access;
 symbols
 	pre_mrcs:1.14
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.15
+date	2025.11.10.22.33.22;	author dean;	state Exp;
+branches;
+next	1.14;
+
 1.14
 date	2018.10.03.14.34.08;	author leith;	state Exp;
 branches;
@@ -100,9 +105,9 @@ desc
 @
 
 
-1.14
+1.15
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -116,7 +121,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -197,6 +202,17 @@ C      SAVE THE VOLUME BUFFER
 @
 
 
+1.14
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.13
 log
 @GPL_2010
diff --git src/RCS/incor3.f,v src/RCS/incor3.f,v
index fd8f53a1..b649cd6e 100644
--- src/RCS/incor3.f,v
+++ src/RCS/incor3.f,v
@@ -1,4 +1,4 @@
-head	1.17;
+head	1.18;
 access;
 symbols
 	pre_mrcs:1.17
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.18
+date	2025.11.10.22.33.22;	author dean;	state Exp;
+branches;
+next	1.17;
+
 1.17
 date	2018.10.03.14.34.08;	author leith;	state Exp;
 branches;
@@ -115,9 +120,9 @@ desc
 @
 
 
-1.17
+1.18
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -130,7 +135,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -325,6 +330,17 @@ c     &        5(1PG12.5,' '),/,5(1PG12.5,' '),/,1(1PG12.5,' ')/)
 @
 
 
+1.17
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.16
 log
 @GPL_2010
diff --git src/RCS/incort.f,v src/RCS/incort.f,v
index ff29aaef..1064e25b 100644
--- src/RCS/incort.f,v
+++ src/RCS/incort.f,v
@@ -1,4 +1,4 @@
-head	1.7;
+head	1.8;
 access;
 symbols
 	pre_mrcs:1.7
@@ -19,6 +19,11 @@ locks; strict;
 comment	@c @;
 
 
+1.8
+date	2025.11.10.22.33.22;	author dean;	state Exp;
+branches;
+next	1.7;
+
 1.7
 date	2018.10.03.14.34.08;	author leith;	state Exp;
 branches;
@@ -60,9 +65,9 @@ desc
 @
 
 
-1.7
+1.8
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -75,7 +80,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -269,6 +274,17 @@ original old SPIDER
 @
 
 
+1.7
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.6
 log
 @GPL_2010
diff --git src/RCS/inf3_p.f,v src/RCS/inf3_p.f,v
index e534221f..8d37e5ce 100644
--- src/RCS/inf3_p.f,v
+++ src/RCS/inf3_p.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.33.22;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.08;	author leith;	state Exp;
 branches;
@@ -85,9 +90,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -101,7 +106,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -176,6 +181,17 @@ C***********************************************************************
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @GPL_2010
diff --git src/RCS/inf_q.f,v src/RCS/inf_q.f,v
index 9c222ac7..79a31c9f 100644
--- src/RCS/inf_q.f,v
+++ src/RCS/inf_q.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.33.22;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.08;	author leith;	state Exp;
 branches;
@@ -85,9 +90,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -101,7 +106,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -163,6 +168,17 @@ C***********************************************************************
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @GPL_2010
diff --git src/RCS/initunix.f,v src/RCS/initunix.f,v
index ca5b65a2..a9916df0 100644
--- src/RCS/initunix.f,v
+++ src/RCS/initunix.f,v
@@ -1,4 +1,4 @@
-head	1.48;
+head	1.49;
 access;
 symbols
 	pre_mrcs:1.48
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.49
+date	2025.11.10.22.33.22;	author dean;	state Exp;
+branches;
+next	1.48;
+
 1.48
 date	2018.10.03.14.34.08;	author leith;	state Exp;
 branches;
@@ -270,9 +275,9 @@ desc
 @
 
 
-1.48
+1.49
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -293,7 +298,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2017  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -428,6 +433,17 @@ C       write(6,*) ' commandline:',commandline
 @
 
 
+1.48
+log
+@email_health_dept
+@
+text
+@d19 1
+a19 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.47
 log
 @ILEN UNDEFINED
diff --git src/RCS/inlnbuf.f,v src/RCS/inlnbuf.f,v
index 4561b197..5ad5cb25 100644
--- src/RCS/inlnbuf.f,v
+++ src/RCS/inlnbuf.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.33.22;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.34.08;	author leith;	state Exp;
 branches;
@@ -70,9 +75,9 @@ desc
 @
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -85,7 +90,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -174,6 +179,17 @@ C          NOT AN INLINE FILE
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @GPL_2010
diff --git src/RCS/inquirealloc.f,v src/RCS/inquirealloc.f,v
index 1154e92c..758e2004 100644
--- src/RCS/inquirealloc.f,v
+++ src/RCS/inquirealloc.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -21,6 +21,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.33.22;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.08;	author leith;	state Exp;
 branches;
@@ -76,9 +81,9 @@ desc
 @@
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -92,7 +97,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -179,6 +184,17 @@ C       CONVERT STARTING REQUEST TO 4 BYTE (INTEGER) UNITS
 
 
 
+@
+
+
+1.10
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
 @
 
 
diff --git src/RCS/inquirearch.f,v src/RCS/inquirearch.f,v
index 000331bc..f67ba3c2 100644
--- src/RCS/inquirearch.f,v
+++ src/RCS/inquirearch.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -21,6 +21,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.33.22;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.08;	author leith;	state Exp;
 branches;
@@ -72,9 +77,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -88,7 +93,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -294,6 +299,17 @@ CC           WRITE(NOUT,*) ' FOLD INT*4 (BY BYTES):     ',I4FOLD
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/inquirecomp.f,v src/RCS/inquirecomp.f,v
index b685c612..a1cc0b56 100644
--- src/RCS/inquirecomp.f,v
+++ src/RCS/inquirecomp.f,v
@@ -1,4 +1,4 @@
-head	1.3;
+head	1.4;
 access;
 symbols
 	pre_mrcs:1.3
@@ -7,6 +7,11 @@ locks; strict;
 comment	@c @;
 
 
+1.4
+date	2025.11.10.22.33.22;	author dean;	state Exp;
+branches;
+next	1.3;
+
 1.3
 date	2018.10.03.14.34.08;	author leith;	state Exp;
 branches;
@@ -27,9 +32,9 @@ desc
 @@
 
 
-1.3
+1.4
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -43,7 +48,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2013  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -111,6 +116,17 @@ C--*********************************************************************
 @
 
 
+1.3
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.2
 log
 @*** empty log message ***
diff --git src/RCS/inquireif.f,v src/RCS/inquireif.f,v
index 105c6bae..1cf6b401 100644
--- src/RCS/inquireif.f,v
+++ src/RCS/inquireif.f,v
@@ -1,4 +1,4 @@
-head	1.20;
+head	1.21;
 access;
 symbols
 	pre_mrcs:1.20
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.21
+date	2025.11.10.22.33.23;	author dean;	state Exp;
+branches;
+next	1.20;
+
 1.20
 date	2018.10.03.14.34.08;	author leith;	state Exp;
 branches;
@@ -130,9 +135,9 @@ desc
 @
 
 
-1.20
+1.21
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -151,7 +156,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -259,6 +264,17 @@ C       SET REGISTERS (IF NECESSARY)
 
 
 
+@
+
+
+1.20
+log
+@email_health_dept
+@
+text
+@d17 1
+a17 1
+C=* Email: spider@@health.ny.gov                                        *
 @
 
 
diff --git src/RCS/inquireif1.f,v src/RCS/inquireif1.f,v
index 7e204c55..3dc809bb 100644
--- src/RCS/inquireif1.f,v
+++ src/RCS/inquireif1.f,v
@@ -1,4 +1,4 @@
-head	1.30;
+head	1.31;
 access;
 symbols
 	pre_mrcs:1.30
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.31
+date	2025.11.10.22.33.23;	author dean;	state Exp;
+branches;
+next	1.30;
+
 1.30
 date	2018.10.03.14.34.08;	author leith;	state Exp;
 branches;
@@ -180,9 +185,9 @@ desc
 @
 
 
-1.30
+1.31
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -204,7 +209,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2016  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -359,6 +364,17 @@ C          READ(FILNAM(ILOCAT+1:),*,IOSTAT=IER) IMGNUM -changed for osf-liy
 
 
 
+@
+
+
+1.30
+log
+@email_health_dept
+@
+text
+@d20 1
+a20 1
+C=* Email: spider@@health.ny.gov                                        *
 @
 
 
diff --git src/RCS/inquirereg.f,v src/RCS/inquirereg.f,v
index 64992630..dc343709 100644
--- src/RCS/inquirereg.f,v
+++ src/RCS/inquirereg.f,v
@@ -1,4 +1,4 @@
-head	1.14;
+head	1.15;
 access;
 symbols
 	pre_mrcs:1.14
@@ -25,6 +25,11 @@ locks; strict;
 comment	@c @;
 
 
+1.15
+date	2025.11.10.22.33.23;	author dean;	state Exp;
+branches;
+next	1.14;
+
 1.14
 date	2018.10.03.14.34.08;	author leith;	state Exp;
 branches;
@@ -101,9 +106,9 @@ desc
 @
 
 
-1.14
+1.15
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -120,7 +125,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -245,6 +250,17 @@ C         NOT A NAMED REGISTER VARIABLE, MAYBE OBSOLETE NUMBER ONLY
 
 
 
+@
+
+
+1.14
+log
+@email_health_dept
+@
+text
+@d15 1
+a15 1
+C=* Email: spider@@health.ny.gov                                        *
 @
 
 
diff --git src/RCS/inquiresync.f,v src/RCS/inquiresync.f,v
index 8881c20d..be36c80f 100644
--- src/RCS/inquiresync.f,v
+++ src/RCS/inquiresync.f,v
@@ -1,4 +1,4 @@
-head	1.17;
+head	1.18;
 access;
 symbols
 	pre_mrcs:1.17
@@ -23,6 +23,11 @@ locks; strict;
 comment	@c @;
 
 
+1.18
+date	2025.11.10.22.33.23;	author dean;	state Exp;
+branches;
+next	1.17;
+
 1.17
 date	2018.10.03.14.34.08;	author leith;	state Exp;
 branches;
@@ -113,9 +118,9 @@ desc
 @@
 
 
-1.17
+1.18
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -134,7 +139,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2012  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -248,6 +253,17 @@ C             CAN NOT REMOVE STACK, STACKED FILE, OR INCORE FILE
 
 
 
+@
+
+
+1.17
+log
+@email_health_dept
+@
+text
+@d17 1
+a17 1
+C=* Email: spider@@health.ny.gov                                        *
 @
 
 
diff --git src/RCS/interp.f,v src/RCS/interp.f,v
index 172dffbd..b1872fa5 100644
--- src/RCS/interp.f,v
+++ src/RCS/interp.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.33.23;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.08;	author leith;	state Exp;
 branches;
@@ -85,9 +90,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -101,7 +106,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -299,6 +304,17 @@ C        DO LAST LINE
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @maxdim was not used
diff --git src/RCS/interp3.f,v src/RCS/interp3.f,v
index 631266fb..69e0c41f 100644
--- src/RCS/interp3.f,v
+++ src/RCS/interp3.f,v
@@ -1,4 +1,4 @@
-head	1.18;
+head	1.19;
 access;
 symbols
 	pre_mrcs:1.18
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.19
+date	2025.11.10.22.33.23;	author dean;	state Exp;
+branches;
+next	1.18;
+
 1.18
 date	2018.10.03.14.34.08;	author leith;	state Exp;
 branches;
@@ -120,9 +125,9 @@ desc
 @
 
 
-1.18
+1.19
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -136,7 +141,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2011  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -192,6 +197,17 @@ C     CALL INTERPOLATION ROUTINE
 @
 
 
+1.18
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.17
 log
 @used allocate always, maxdim bug fixed
diff --git src/RCS/interp_fbs.f,v src/RCS/interp_fbs.f,v
index 795ca1ca..249a6b33 100644
--- src/RCS/interp_fbs.f,v
+++ src/RCS/interp_fbs.f,v
@@ -1,4 +1,4 @@
-head	1.20;
+head	1.21;
 access;
 symbols
 	pre_mrcs:1.20
@@ -7,6 +7,11 @@ locks; strict;
 comment	@c @;
 
 
+1.21
+date	2025.11.10.22.33.23;	author dean;	state Exp;
+branches;
+next	1.20;
+
 1.20
 date	2018.10.03.14.34.08;	author leith;	state Exp;
 branches;
@@ -112,9 +117,9 @@ desc
 @@
 
 
-1.20
+1.21
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -129,7 +134,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -239,6 +244,17 @@ c$omp  parallel do private(k2,y,m2, k1,x,m1)
 @
 
 
+1.20
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.19
 log
 @shift bug fixed by GPK
diff --git src/RCS/interp_fbs3.f,v src/RCS/interp_fbs3.f,v
index b1cca47d..be0c27c7 100644
--- src/RCS/interp_fbs3.f,v
+++ src/RCS/interp_fbs3.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -7,6 +7,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.33.23;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.08;	author leith;	state Exp;
 branches;
@@ -63,9 +68,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -78,7 +83,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -196,6 +201,17 @@ c$omp  parallel do private(k3,z,k31, k2,y,k21, k1,x,k11)
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @omp parallel
diff --git src/RCS/interps.f,v src/RCS/interps.f,v
index d50d65b5..5e5e6139 100644
--- src/RCS/interps.f,v
+++ src/RCS/interps.f,v
@@ -1,4 +1,4 @@
-head	1.174;
+head	1.175;
 access;
 symbols
 	pre_mrcs:1.174
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.175
+date	2025.11.10.22.33.23;	author dean;	state Exp;
+branches;
+next	1.174;
+
 1.174
 date	2018.10.03.14.34.08;	author leith;	state Exp;
 branches;
@@ -906,9 +911,9 @@ desc
 @
 
 
-1.174
+1.175
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -923,7 +928,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2011	  Health Research Inc.,                        *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -1184,6 +1189,17 @@ c     &        ' Calling Nextfiles, nindx1,nindx2:',nindx1,nindx2
 @
 
 
+1.174
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.173
 log
 @enter
diff --git src/RCS/inttochar.f,v src/RCS/inttochar.f,v
index bd555009..3596b175 100644
--- src/RCS/inttochar.f,v
+++ src/RCS/inttochar.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.09.26.15.35.23;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.34.08;	author leith;	state Exp;
 branches;
@@ -69,24 +74,25 @@ desc
 @@
 
 
-1.8
+1.9
 log
-@email_health_dept
+@debug output commented out, cosmetic
 @
 text
 @
 C++*********************************************************************
 C
 C INTTOCHAR.F   -- NEW 7 Jan 99 ArDean Leith
-CC                 AVOIDS SGI'S MEMORY LEAK aug 02 ArDean Leith
-
+C                  AVOIDS SGI'S MEMORY LEAK aug 2002  ArDean Leith
+C                  DEBUG OUTPUT             sep 2025  ArDean Leith
+C
 C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2010  Health Research Inc.,                         *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -108,8 +114,8 @@ C    PURPOSE:       CONVERT INTEGER TO A CHARACTER STRING
 C
 C    PARAMETERS:
 C        NUMBER     INTEGER NUMBER                                (SENT)
-C        STRING     OUTPUT STRING                                 (SENT) 
-C        NLET       NUMBER OF CHARAcTERS IN OUTPUT STRING         (RET.)
+C        STRING     OUTPUT STRING                                 (RET.) 
+C        NLET       NUMBER OF CHARACTERS IN OUTPUT STRING         (RET.)
 C                   (<0 INDICATES ERROR)
 C        MINLEN     MINIMUM LENGTH OF OUTPUT STRING               (SENT)
 C
@@ -122,9 +128,14 @@ C--*********************************************************************
 
         SUBROUTINE INTTOCHAR(NUMBER,STRING,NLET,MINLEN)
 
-        CHARACTER (LEN=*) ::       STRING
-        INTEGER, PARAMETER::       MAXSTR = 10
-        CHARACTER (LEN=MAXSTR) ::  CTEMP,CZEROS
+        INTEGER                :: NUMBER,NLET,MINLEN
+        CHARACTER (LEN=*)      :: STRING
+
+        INTEGER, PARAMETER     :: MAXSTR = 10
+        CHARACTER (LEN=MAXSTR) :: CTEMP,CZEROS
+
+        INTEGER                :: NZ,IGO
+
 
         DATA CZEROS/'0000000000'/
 
@@ -136,11 +147,17 @@ C       FIND NUMBER OF LEADING ZEROS (IF ANY)
 
         IGO  = (MAXSTR-NLET+1)
         NLET = NLET + NZ
+        
+c        write(6,*) ' Inttochar  number,minlen,nlet,nz: ', 
+c     &                          number,minlen,nlet,nz
 
 C       CHECK FOR OVERFLOW OF STRING
         IF (NLET .GT. LEN(STRING) .OR. NLET .GT. MAXSTR) GOTO 999
 
 C       I10 MUST BE SAME AS MAXSTR!!
+
+c       write(3,*)' inttochar maxstr: ',maxstr
+
         WRITE(CTEMP,'(I10)',ERR=999) NUMBER
 
         IF (NZ .GT. 0) THEN
@@ -150,6 +167,9 @@ C          MUST PREFIX ZERO'S
            STRING = CTEMP(IGO:MAXSTR) 
         ENDIF
 
+c       write(6,*) ' inttochar number,nlet,string,nlet:',
+c       &                      number,nlet,string,nlet
+
         RETURN
 
 C       ERROR RETURN
@@ -161,6 +181,36 @@ C       ERROR RETURN
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d5 3
+a7 2
+CC                 AVOIDS SGI'S MEMORY LEAK aug 02 ArDean Leith
+
+d12 1
+a12 1
+C=* Copyright 1985-2010  Health Research Inc.,                         *
+d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+d36 2
+a37 2
+C        STRING     OUTPUT STRING                                 (SENT) 
+C        NLET       NUMBER OF CHARAcTERS IN OUTPUT STRING         (RET.)
+d50 8
+a57 3
+        CHARACTER (LEN=*) ::       STRING
+        INTEGER, PARAMETER::       MAXSTR = 10
+        CHARACTER (LEN=MAXSTR) ::  CTEMP,CZEROS
+d69 3
+d77 3
+d88 3
+@
+
+
 1.7
 log
 @GPL_2010
diff --git src/RCS/invbt.f,v src/RCS/invbt.f,v
index a1ea517e..871f333a 100644
--- src/RCS/invbt.f,v
+++ src/RCS/invbt.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.33.24;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.34.08;	author leith;	state Exp;
 branches;
@@ -69,9 +74,9 @@ desc
 @@
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -85,7 +90,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -171,6 +176,17 @@ C
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @GPL_2010
diff --git src/RCS/invgdist.f,v src/RCS/invgdist.f,v
index 9d4af96e..d6dfe125 100644
--- src/RCS/invgdist.f,v
+++ src/RCS/invgdist.f,v
@@ -1,4 +1,4 @@
-head	1.5;
+head	1.6;
 access;
 symbols
 	pre_mrcs:1.5
@@ -21,6 +21,11 @@ locks; strict;
 comment	@c @;
 
 
+1.6
+date	2025.11.10.22.33.24;	author dean;	state Exp;
+branches;
+next	1.5;
+
 1.5
 date	2018.10.03.14.34.08;	author leith;	state Exp;
 branches;
@@ -52,9 +57,9 @@ desc
 @
 
 
-1.5
+1.6
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -64,7 +69,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -125,6 +130,17 @@ C........................................................................
 @
 
 
+1.5
+log
+@email_health_dept
+@
+text
+@d8 1
+a8 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.4
 log
 @GPL_2010
diff --git src/RCS/ipalign64.f,v src/RCS/ipalign64.f,v
index 18304745..2c884fb3 100644
--- src/RCS/ipalign64.f,v
+++ src/RCS/ipalign64.f,v
@@ -1,4 +1,4 @@
-head	1.7;
+head	1.8;
 access;
 symbols
 	pre_mrcs:1.7
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.8
+date	2025.11.10.22.33.24;	author dean;	state Exp;
+branches;
+next	1.7;
+
 1.7
 date	2018.10.03.14.34.08;	author leith;	state Exp;
 branches;
@@ -65,9 +70,9 @@ desc
 @
 
 
-1.7
+1.8
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -81,7 +86,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -114,6 +119,17 @@ C***********************************************************************
 @
 
 
+1.7
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.6
 log
 @GPL_2010
diff --git src/RCS/irmrecord.f,v src/RCS/irmrecord.f,v
index 1eb9ec7a..70f032f1 100644
--- src/RCS/irmrecord.f,v
+++ src/RCS/irmrecord.f,v
@@ -1,4 +1,4 @@
-head	1.4;
+head	1.5;
 access;
 symbols
 	pre_mrcs:1.4
@@ -20,6 +20,11 @@ locks; strict;
 comment	@c @;
 
 
+1.5
+date	2025.11.10.22.33.24;	author dean;	state Exp;
+branches;
+next	1.4;
+
 1.4
 date	2018.10.03.14.34.08;	author leith;	state Exp;
 branches;
@@ -46,9 +51,9 @@ desc
 @
 
 
-1.4
+1.5
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -81,7 +86,7 @@ C=**********************************************************************
 C=* From: SPIDER - MODULAR IMAGE PROCESSING SYSTEM                     *
 C=* Copyright (C)2000  M. Radermacher                                  *
 C=*                                                                    *
-C=* Email:  spider@@health.ny.gov                                       *
+C=* Email:  spider@@wadsworth.org                                       *
 C=*                                                                    *
 C=* This program is free software; you can redistribute it and/or      *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -248,6 +253,17 @@ C       WRITE(NDAT,998) IPLANE,IROW,IRMRECORD
 @
 
 
+1.4
+log
+@email_health_dept
+@
+text
+@d31 1
+a31 1
+C=* Email:  spider@@health.ny.gov                                       *
+@
+
+
 1.3
 log
 @GPL License fixed
diff --git src/RCS/irp3.f,v src/RCS/irp3.f,v
index 14df61af..6a1c67c2 100644
--- src/RCS/irp3.f,v
+++ src/RCS/irp3.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.33.24;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.08;	author leith;	state Exp;
 branches;
@@ -85,9 +90,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -101,7 +106,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -182,6 +187,17 @@ C       REMAINING CASES
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @GPL_2010
diff --git src/RCS/isbare.f,v src/RCS/isbare.f,v
index 99361f47..97bad90c 100644
--- src/RCS/isbare.f,v
+++ src/RCS/isbare.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.33.24;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.34.08;	author leith;	state Exp;
 branches;
@@ -70,9 +75,9 @@ desc
 @
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -87,7 +92,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -131,6 +136,17 @@ C      IF IT IS A BARE STACK ILOCAT IS LENB
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @GPL_2010
diff --git src/RCS/ischar.f,v src/RCS/ischar.f,v
index 84818eed..73ac8195 100644
--- src/RCS/ischar.f,v
+++ src/RCS/ischar.f,v
@@ -1,4 +1,4 @@
-head	1.7;
+head	1.8;
 access;
 symbols
 	pre_mrcs:1.7
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.8
+date	2025.11.10.22.33.24;	author dean;	state Exp;
+branches;
+next	1.7;
+
 1.7
 date	2018.10.03.14.34.08;	author leith;	state Exp;
 branches;
@@ -65,9 +70,9 @@ desc
 @
 
 
-1.7
+1.8
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -81,7 +86,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -120,6 +125,17 @@ C--*******************************************************************
 @
 
 
+1.7
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.6
 log
 @GPL_2010
diff --git src/RCS/isdigi.f,v src/RCS/isdigi.f,v
index e3d41ebf..0501b705 100644
--- src/RCS/isdigi.f,v
+++ src/RCS/isdigi.f,v
@@ -1,4 +1,4 @@
-head	1.7;
+head	1.8;
 access;
 symbols
 	pre_mrcs:1.7
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.8
+date	2025.11.10.22.33.24;	author dean;	state Exp;
+branches;
+next	1.7;
+
 1.7
 date	2018.10.03.14.34.08;	author leith;	state Exp;
 branches;
@@ -65,9 +70,9 @@ desc
 @
 
 
-1.7
+1.8
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -81,7 +86,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -117,6 +122,17 @@ C--*********************************************************************
 @
 
 
+1.7
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.6
 log
 @GPL_2010
diff --git src/RCS/isdocincore.f,v src/RCS/isdocincore.f,v
index e75100e3..032f3e80 100644
--- src/RCS/isdocincore.f,v
+++ src/RCS/isdocincore.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -20,6 +20,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.33.24;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.08;	author leith;	state Exp;
 branches;
@@ -70,9 +75,9 @@ desc
 @@
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -88,7 +93,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -170,6 +175,17 @@ C          REMEMBER WHICH LOCATIONS ARE EMPTY IN CASE DOCNAM NOT IN-CORE
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/itpow.f,v src/RCS/itpow.f,v
index 1b9a0d5a..a8433e72 100644
--- src/RCS/itpow.f,v
+++ src/RCS/itpow.f,v
@@ -1,4 +1,4 @@
-head	1.7;
+head	1.8;
 access;
 symbols
 	pre_mrcs:1.7
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.8
+date	2025.11.10.22.33.24;	author dean;	state Exp;
+branches;
+next	1.7;
+
 1.7
 date	2018.10.03.14.34.08;	author leith;	state Exp;
 branches;
@@ -65,9 +70,9 @@ desc
 @
 
 
-1.7
+1.8
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -82,7 +87,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -172,6 +177,17 @@ C........ PERIODIC CENTERING
 @
 
 
+1.7
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.6
 log
 @GPL_2010
diff --git src/RCS/johist.f,v src/RCS/johist.f,v
index 1e370dd3..dd8f4dfd 100644
--- src/RCS/johist.f,v
+++ src/RCS/johist.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -20,6 +20,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.33.24;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.08;	author leith;	state Exp;
 branches;
@@ -70,9 +75,9 @@ desc
 @@
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -88,7 +93,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -235,6 +240,17 @@ C     FIND ENTROPY
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/johistf.f,v src/RCS/johistf.f,v
index 1b43aa8d..0e2fc7ba 100644
--- src/RCS/johistf.f,v
+++ src/RCS/johistf.f,v
@@ -1,4 +1,4 @@
-head	1.7;
+head	1.8;
 access;
 symbols
 	pre_mrcs:1.7
@@ -20,6 +20,11 @@ locks; strict;
 comment	@c @;
 
 
+1.8
+date	2025.11.10.22.33.25;	author dean;	state Exp;
+branches;
+next	1.7;
+
 1.7
 date	2018.10.03.14.34.08;	author leith;	state Exp;
 branches;
@@ -60,9 +65,9 @@ desc
 @@
 
 
-1.7
+1.8
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -76,7 +81,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -330,6 +335,17 @@ C     FIND ENTROPY
 @
 
 
+1.7
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.6
 log
 @GPL_2010
diff --git src/RCS/jpmsk1.f,v src/RCS/jpmsk1.f,v
index 39e4d2a8..62b7f5d1 100644
--- src/RCS/jpmsk1.f,v
+++ src/RCS/jpmsk1.f,v
@@ -1,4 +1,4 @@
-head	1.70;
+head	1.71;
 access;
 symbols
 	pre_mrcs:1.70
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.71
+date	2025.11.10.22.33.26;	author dean;	state Exp;
+branches;
+next	1.70;
+
 1.70
 date	2018.10.03.14.34.08;	author leith;	state Exp;
 branches;
@@ -380,9 +385,9 @@ desc
 @
 
 
-1.70
+1.71
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C **********************************************************************
@@ -412,7 +417,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -910,6 +915,17 @@ C       CLOSE ALL FILES THAT MIGHT BE OPEN
 @
 
 
+1.70
+log
+@email_health_dept
+@
+text
+@d28 1
+a28 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.69
 log
 @enter
diff --git src/RCS/jpmsk2.f,v src/RCS/jpmsk2.f,v
index 6d4c6e18..ae48ee1f 100644
--- src/RCS/jpmsk2.f,v
+++ src/RCS/jpmsk2.f,v
@@ -1,4 +1,4 @@
-head	1.50;
+head	1.51;
 access;
 symbols
 	pre_mrcs:1.50
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.51
+date	2025.11.10.22.33.26;	author dean;	state Exp;
+branches;
+next	1.50;
+
 1.50
 date	2018.10.03.14.34.08;	author leith;	state Exp;
 branches;
@@ -280,9 +285,9 @@ desc
 @
 
 
-1.50
+1.51
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -310,7 +315,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -1128,6 +1133,17 @@ C	  REPLACE THE AVERAGES TO THE ORIGINAL DATA IF(PCA_AVRG)=TRUE
 @
 
 
+1.50
+log
+@email_health_dept
+@
+text
+@d26 1
+a26 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.49
 log
 @enter
diff --git src/RCS/jpmsk3.f,v src/RCS/jpmsk3.f,v
index ecfe4e9c..de3d69dc 100644
--- src/RCS/jpmsk3.f,v
+++ src/RCS/jpmsk3.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -19,6 +19,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.33.26;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.34.09;	author leith;	state Exp;
 branches;
@@ -64,9 +69,9 @@ desc
 @@
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C **********************************************************************
@@ -81,7 +86,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -510,6 +515,17 @@ C         READ THE _IMC  FILE TO GET WEIGHTI....
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @enter
diff --git src/RCS/labelspi.f,v src/RCS/labelspi.f,v
index e08de710..8ce02297 100644
--- src/RCS/labelspi.f,v
+++ src/RCS/labelspi.f,v
@@ -1,4 +1,4 @@
-head	1.16;
+head	1.17;
 access;
 symbols
 	pre_mrcs:1.16
@@ -21,6 +21,11 @@ locks; strict;
 comment	@c @;
 
 
+1.17
+date	2025.11.10.22.33.26;	author dean;	state Exp;
+branches;
+next	1.16;
+
 1.16
 date	2018.10.03.14.34.09;	author leith;	state Exp;
 branches;
@@ -106,9 +111,9 @@ desc
 @@
 
 
-1.16
+1.17
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -125,7 +130,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -412,6 +417,17 @@ C     DUMP IMAGE BUFFER TO FILE
 @
 
 
+1.16
+log
+@email_health_dept
+@
+text
+@d15 1
+a15 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.15
 log
 @blank image support
diff --git src/RCS/lastoccur.f,v src/RCS/lastoccur.f,v
index 0b5bbe15..b537e9ac 100644
--- src/RCS/lastoccur.f,v
+++ src/RCS/lastoccur.f,v
@@ -1,4 +1,4 @@
-head	1.6;
+head	1.7;
 access;
 symbols
 	pre_mrcs:1.6
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.7
+date	2025.11.10.22.33.26;	author dean;	state Exp;
+branches;
+next	1.6;
+
 1.6
 date	2018.10.03.14.34.09;	author leith;	state Exp;
 branches;
@@ -60,9 +65,9 @@ desc
 @
 
 
-1.6
+1.7
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -76,7 +81,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -129,6 +134,17 @@ C     FIND LAST OCCURENCE OF PATTERN IN THE LINE
 @
 
 
+1.6
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.5
 log
 @GPL_2010
diff --git src/RCS/latcen.f,v src/RCS/latcen.f,v
index e70b4555..2a3e347c 100644
--- src/RCS/latcen.f,v
+++ src/RCS/latcen.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.33.26;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.09;	author leith;	state Exp;
 branches;
@@ -80,9 +85,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -95,7 +100,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -202,6 +207,17 @@ C       COMPUTE FIT
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @GPL_2010
diff --git src/RCS/latice.f,v src/RCS/latice.f,v
index 012d7886..4a65bc48 100644
--- src/RCS/latice.f,v
+++ src/RCS/latice.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.33.26;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.09;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -91,7 +96,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -238,6 +243,17 @@ C	WRITE(NOUT,711)IPOINT
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/lenopenfile.f,v src/RCS/lenopenfile.f,v
index 16351bb8..58000a16 100644
--- src/RCS/lenopenfile.f,v
+++ src/RCS/lenopenfile.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.33.26;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.09;	author leith;	state Exp;
 branches;
@@ -84,9 +89,9 @@ desc
 @@
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -99,7 +104,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -156,6 +161,17 @@ C      END OF NON-DEC (OSF) UNIX SPECIFIC STATEMENTS
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @GPL_2010
diff --git src/RCS/lhist.f,v src/RCS/lhist.f,v
index 72040aec..d70d38cc 100644
--- src/RCS/lhist.f,v
+++ src/RCS/lhist.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.33.26;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.09;	author leith;	state Exp;
 branches;
@@ -85,9 +90,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -101,7 +106,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -227,6 +232,17 @@ C        FIRST COLUMN SUBTRACTED IN FIRST PASS, LAST COL. ADDED IN SECOND PASS
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @GPL_2010
diff --git src/RCS/listhedmrc.f,v src/RCS/listhedmrc.f,v
index 04f771e6..f184d9c5 100644
--- src/RCS/listhedmrc.f,v
+++ src/RCS/listhedmrc.f,v
@@ -1,10 +1,20 @@
-head	1.4;
+head	1.6;
 access;
 symbols;
 locks; strict;
 comment	@c @;
 
 
+1.6
+date	2025.11.10.22.33.56;	author dean;	state Exp;
+branches;
+next	1.5;
+
+1.5
+date	2025.11.02.20.43.27;	author dean;	state Exp;
+branches;
+next	1.4;
+
 1.4
 date	2019.12.31.19.59.55;	author leith;	state Exp;
 branches;
@@ -49,23 +59,25 @@ desc
 @
 
 
-1.4
+1.6
 log
-@Data type (Mode)
+@*** empty log message ***
 @
 text
 @
 C **********************************************************************
 C 
-C  LISTHEDMRC   NEW FOR MRC SUPPORT             OCT 2019  ArDean Leith
-C                                                                     
+C  LISTHEDMRC  NEW FOR MRC SUPPORT              OCT 2019  ArDean Leith
+C              ADDED SPIDER SPECIFIC LOCS       OCT 2025  ArDean Leith
+C                 (NOT IN FILE)                                         
+C                        
 C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2019  Health Research Inc.,                         *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -96,21 +108,23 @@ C
 C  1    NX          # OF COLUMNS    (FASTEST CHANGING IN MAP)
 C  2    NY          # OF ROWS
 C  3    NZ          # OF SECTIONS   (SLOWEST CHANGING IN MAP)
+C
 C  4    MODE        DATA TYPE
-C                   0   IMAGE:  8-BIT BYTES RANGE -128 -->127 (SIGNED)                  
-C                   1   IMAGE: 16-BIT INTEGERS HALFWORDS                
-C                   2   IMAGE: 32-BIT REALS                    
-C                   6   IMAGE: UNSIGNED 8-BIT BYTES RANGE 0 -->255        
-C                   3   TRANSFORM: COMPLEX 16-BIT INTEGERS (UNSUPPORTED)   
-C                   4   TRANSFORM: COMPLEX 32-BIT REALS    (UNSUPPORTED)     
-C  5    NXSTART     # OF FIRST COLUMN  IN MAP 
-C  6    NYSTART     # OF FIRST ROW     IN MAP       
-C  7    NZSTART     # OF FIRST SECTION IN MAP       
+C                   0   IMAGE:  8-BIT BYTES RANGE -128 -->127 (SIGNED)   
+C                   1   IMAGE: 16-BIT INTEGERS HALFWORDS     
+C                   2   IMAGE: 32-BIT REALS    
+C                   6   IMAGE: UNSIGNED 8-BIT BYTES RANGE 0 -->255  
+C                   3   TRANSFORM: COMPLEX 16-BIT INTEGERS (UNSUPPORTED)
+C                   4   TRANSFORM: COMPLEX 32-BIT REALS    (UNSUPPORTED)
+C    
+C  5    NXSTART     # OF FIRST COLUMN  IN MAP
+C  6    NYSTART     # OF FIRST ROW     IN MAP
+C  7    NZSTART     # OF FIRST SECTION IN MAP  
 C  8    MX          # OF INTERVALS ALONG X
 C  9    MY          # OF INTERVALS ALONG Y
 C 10    MZ          # OF INTERVALS ALONG Z    (>1 FOR STACK)
 C 11-13 CELLA       CELL DIMENSIONS IN ANGSTROMS
-C 14-16 CELLB       CELL ANGLES IN DEGREES  (PHI,THETA,PSI)                        
+C 14-16 CELLB       CELL ANGLES IN DEGREES  (PHI,THETA,PSI)            
 C 17    MAPC        AXIS CORRESPONDING TO COLUMNS  (1,2,3 FOR X,Y,Z)
 C 18    MAPR        AXIS CORRESPONDING TO ROWS     (1,2,3 FOR X,Y,Z)
 C 19    MAPS        AXIS CORRESPONDING TO SECTIONS (1,2,3 FOR X,Y,Z)
@@ -155,12 +169,12 @@ C        RMS   < 0.0                         RMS       UNDETERMINED
 C
 C     Bytes 213 and 214 contain 4 `nibbles' (half-bytes) indicating 
 C     the representation of float, complex, integer and character 
-C     datatypes. Bytes 215 and 216 are unused. The CCP4 library contains 
-C     a general representation of datatypes, but in practice it is 
+C     datatypes. Bytes 215 and 216 are unused. The CCP4 library contains
+C     a general representation of data types, but in practice it is 
 C     safe to use 0x44 0x44 0x00 0x00 for little endian machines, and 
 C     0x11 0x11 0x00 0x00 for big endian machines. The CCP4 library 
 C     uses this information to automatically byte-swap data if 
-C     appropriate, when tranferring data files between machines.  
+C     appropriate, when tranferring data files between machines.
 C
 C23456789012345678901234567890123456789012345678901234567890123456789012
 CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
@@ -170,6 +184,7 @@ CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
 C     IMPLICIT NONE
 
 #include "LUNHDR.INC"
+
       INCLUDE 'CMBLOCK.INC'
       INCLUDE 'CMLIMIT.INC'
 
@@ -182,6 +197,8 @@ C     IMPLICIT NONE
       LOGICAL               :: BIGENDFILE,SAMEENDFILE
       CHARACTER(LEN=MAXNAM) :: FILNAM
       CHARACTER(LEN=800)    :: LABELS
+      CHARACTER(LEN=80)     :: OUTSTR
+      
       CHARACTER(LEN=4)      :: CSTR
       CHARACTER(LEN=1)      :: NULL = CHAR(0)
         
@@ -196,12 +213,15 @@ C     IMPLICIT NONE
       REAL                  :: PIXSIZX,PIXSIZY,PIXSIZZ
       REAL                  :: ORX,ORY,ORZ
       INTEGER               :: IANGLE,IMGSTATS,NLABL,IVERSION
+      INTEGER               :: IXTRA29,IXTRA30,IXTRA31,IXTRA32
       CHARACTER(LEN=4)      :: MAP 
       CHARACTER(LEN=4)      :: CAXIS,EXTTYP
 
       INTEGER               :: LNBLNKN    ! FUNCTION
       LOGICAL               :: ISMRCFILE  ! FUNCTION
 
+      integer               :: idsp,isbare,img_in_stats,nstack    
+
 
 C     OPEN INPUT FILE
       CALL OPFILEC(0,.TRUE.,FILNAM,LUN,'O',ITYPE,
@@ -265,8 +285,11 @@ C     POINT TO HEADER OBJECT
 
       ISPG     = MRC_HEADER(23) 
       NSYMBT   = MRC_HEADER(24) 
+
+C     GET CONTENT OF EXTRA HEADER LOCATION: 25  (AS INTEGER) 
       IMGSTATS = MRC_HEADER(25)                     ! SPIDER DEFINED
 
+C     GET CONTENT OF EXTRA HEADER LOCATION: 26  (AS CHAR STRING) 
       CAXIS    = TRANSFER(MRC_HEADER(26),CSTR(1:4)) ! SPIDER DEFINED
 
 C     GET EXTTYP (NOW 'MRCO')
@@ -275,6 +298,12 @@ C     GET EXTTYP (NOW 'MRCO')
 C     GET VERSION NUMBER 
       IVERSION = MRC_HEADER(28) 
 
+C     GET CONTENT OF EXTRA HEADER LOCATION: 29-32 (AS INTEGERS) 
+      IXTRA29  = MRC_HEADER(29) ! NOT REPORTED BELOW 
+      IXTRA30  = MRC_HEADER(30) ! NOT REPORTED BELOW 
+      IXTRA31  = MRC_HEADER(31) ! NOT REPORTED BELOW 
+      IXTRA32  = MRC_HEADER(32) ! NOT REPORTED BELOW
+
 C     GET IANGLE
       IANGLE   = MRC_HEADER(42)
 
@@ -300,6 +329,7 @@ C     GET MAP TYPE
       RMS      = TRANSFER(MRC_HEADER(55),FVAL) ! DEVIATION FROM MEAN       
       NLABL    = MRC_HEADER(56)
 
+       
       IF (NLABL > 0) THEN
 C        GET LABELS
          CALL LUNGETLABELS_MRC(LUN,NLABL,LABELS,IRTFLG)
@@ -329,6 +359,7 @@ C     WRITE OUT CONVERSION INFORMATION
          WRITE(NOUT,*)' On little ended architecture,',
      &                ' Reading little ended file.'
       ENDIF
+      WRITE(NOUT,*)'  '
 
 
 C     WRITE OUT HEADER INFORMATION
@@ -338,28 +369,33 @@ C     WRITE OUT HEADER INFORMATION
       IF     (MRCMODE == 0) THEN
         WRITE(NOUT,*) ' Data type (Mode) ..........................' //
      &               '    0: 8-bit signed integers, Range -128 --> 127'
+
       ELSEIF (MRCMODE == 1) THEN
         WRITE(NOUT,*) ' Data type .................................' //
-     &                '     1: 16-bit signed integers'
+     &                '      1: 16-bit signed integers'
+
       ELSEIF (MRCMODE == 2) THEN
         WRITE(NOUT,*) ' Data type ................................ ' //
-     &                '     2: 32-bit reals '
+     &                '      2: 32-bit reals '
+
       ELSEIF (MRCMODE == 3) THEN
         WRITE(NOUT,*) ' Data type  ................................' //
-     &                '     3: Complex 16-bit integers'
+     &                '      3: Complex 16-bit integers'
+
       ELSEIF (MRCMODE == 4) THEN
         WRITE(NOUT,*) ' Data type  ................................' //
-     &                '     4: Complex 32-bit reals'
+     &                '      4: Complex 32-bit reals'
+
       ELSEIF (MRCMODE == 6) THEN
         WRITE(NOUT,*) ' Data type  ................................' //
-     &                '    6 : 16-bit unsigned integers'
+     &                '      6 : 16-bit unsigned integers'
       ENDIF
 
       WRITE(NOUT,1001) NX,NY,NZ
-1001  FORMAT(2X,'Columns, rows, sections ..................  ',3(I7,1X))
+1001  FORMAT(2X,'Columns, rows, sections (NX,NY,NZ) ....... ',3(I7,1X))
 
       WRITE(NOUT,1003) NXSTART,NYSTART,NZSTART
-1003  FORMAT(2X,'Starting columns, rows, sections ......... ',3I7)
+1003  FORMAT(2X,'Starting column, row, section ............ ',3I7)
 
       WRITE(NOUT,1004) MX,MY,MZ 
 1004  FORMAT(2X,'Intervals (MX,MY,MZ) .....................  ',3I7)
@@ -377,13 +413,13 @@ C     WRITE OUT HEADER INFORMATION
 1007  FORMAT(2X,'Fast, medium, slow axes .................. ',3I7)
 
       WRITE(NOUT,1008) DMIN,DMAX  
-1008  FORMAT(2X,'Min & max  density ....................... ',2F23.11)
+1008  FORMAT(2X,'Min & max  density .......................',2F23.11)
 
       WRITE(NOUT,1009) DMEAN,RMS
-1009  FORMAT(2X,'Mean & RMS density ....................... ',2F23.11)
+1009  FORMAT(2X,'Mean & RMS density .......................',2F23.11)
 
       WRITE(NOUT,1092) ANG1,ANG2,ANG3,ANG4,ANG5,ANG6
-1092  FORMAT(2X,'Angles (Phi,Theta,Psi) ...............     ',6F8.2)
+1092  FORMAT(2X,'Angles (Phi,Theta,Psi) ...................   ',6F8.2)
 
       WRITE(NOUT,1010) ORX,ORY,ORZ
 1010  FORMAT(2X,'Origins .................................. ',3F10.2)
@@ -392,12 +428,13 @@ C     WRITE OUT HEADER INFORMATION
 1011  FORMAT(2X,'Space group, extra header bytes .......... ',2I7)
 
       WRITE(NOUT,1091) IMGSTATS 
-1091  FORMAT(2X,'Image used for stats ** .................. ',2I7)
+1091  FORMAT(2X,'Image or volume in DMIN,DMAX ** ........... ',I7)
+
       WRITE(NOUT,1012) CAXIS 
 1012  FORMAT(2X,'Data origin ** ..........................        ',A)
 
       WRITE(NOUT,1013) MACHST
-1013  FORMAT(2X,'Machine stamp ............................ ',I12)
+1013  FORMAT(2X,'Machine stamp ............................',I12)
 
       WRITE(NOUT,1014) MAP
 1014  FORMAT(2X,'Map type..................................       ',A)
@@ -406,19 +443,43 @@ C     WRITE OUT HEADER INFORMATION
 1015  FORMAT(2X,'MRC version ..............................     ',I7)
 
       WRITE(NOUT,1016) EXTTYP 
-1016  FORMAT(2X,'ExtType .....................................    ',A)
+1016  FORMAT(2X,'ExtType ..................................       ',A)
 
-      WRITE(NOUT,1017) NLABL 
-1017  FORMAT(2X,'Number of labels ......................... ',I7)
+      WRITE(NOUT,1022) NLABL
+1022  FORMAT(2X,'Number of labels .........................  ',I7)
+
+      idsp    = mrc_header(257)
+      isbare  = mrc_header(258)
+      imgnum  = mrc_header(258)
+      nstack  = mrc_header(260)
+
+      WRITE(NOUT,*) ' '
+
+      WRITE(NOUT,1018) idsp 
+1018  FORMAT(2X,'Old or New File    (OLD: 0) (NEW: 1) ** .... ',I7)
+
+      WRITE(NOUT,1019)  isbare  
+1019  FORMAT(2X,'Bare stack         (1: TRUE)         ** .... ',I7)
+
+      WRITE(NOUT,1020) imgnum 
+1020  FORMAT(2X,'Image in header    (-2: NOT A STACK) ** .... ',I7)
+
+      WRITE(NOUT,1021) nstack 
+1021  FORMAT(2X,'Max image in stack (-2: NOT A STACK) ** .... ',I7)
+
+      WRITE(NOUT,*) ' '
 
       IF (NLABL > 0) THEN
          IEND = lnblnkn(LABELS)
 
-         WRITE(NOUT,1031)
-1031     FORMAT('  Labels:')
-
-         WRITE(NOUT,1032) LABELS(1:IEND)
-1032     FORMAT(3X,100(A80))
+         DO ILABL = 1,NLABL 
+            ILOC = (ILABL - 1) * 80 + 1
+            OUTSTR = LABELS(ILOC: ILOC+80)
+            OUTSTR = ADJUSTL(OUTSTR)
+            OUTSTR = TRIM(OUTSTR)  
+            WRITE(NOUT,1031) ILABL,OUTSTR
+1031        FORMAT('  Label:', I5,'     ',A80)
+         ENDDO
       ENDIF
 
       WRITE(NOUT,*) ' '
@@ -426,6 +487,130 @@ C     WRITE OUT HEADER INFORMATION
       CLOSE(LUN)
 
       END
+
+@
+
+
+1.5
+log
+@added common block variables (not in header)
+@
+text
+@d45 1
+d47 10
+a56 9
+C                   0   IMAGE:  8-BIT BYTES RANGE -128 -->127 (SIGNED)   C               
+C                   1   IMAGE: 16-BIT INTEGERS HALFWORDS                
+C                   2   IMAGE: 32-BIT REALS                    
+C                   6   IMAGE: UNSIGNED 8-BIT BYTES RANGE 0 -->255       C 
+C                   3   TRANSFORM: COMPLEX 16-BIT INTEGERS (UNSUPPORTED) C  
+C                   4   TRANSFORM: COMPLEX 32-BIT REALS    (UNSUPPORTED) C    
+C  5    NXSTART     # OF FIRST COLUMN  IN MAP 
+C  6    NYSTART     # OF FIRST ROW     IN MAP       
+C  7    NZSTART     # OF FIRST SECTION IN MAP       
+d61 1
+a61 1
+C 14-16 CELLB       CELL ANGLES IN DEGREES  (PHI,THETA,PSI)              C          
+d106 2
+a107 2
+C     datatypes. Bytes 215 and 216 are unused. The CCP4 library contains 
+C     a general representation of datatypes, but in practice it is 
+d111 1
+a111 1
+C     appropriate, when tranferring data files between machines.  
+d150 1
+d222 2
+d226 1
+d235 6
+d329 1
+a329 1
+1001  FORMAT(2X,'Columns, rows, sections ..................  ',3(I7,1X))
+d332 1
+a332 1
+1003  FORMAT(2X,'Starting columns, rows, sections ......... ',3I7)
+d365 1
+a365 1
+1091  FORMAT(2X,'Image used for stats ** .................. ',I7)
+@
+
+
+1.4
+log
+@Data type (Mode)
+@
+text
+@d4 4
+a7 2
+C  LISTHEDMRC   NEW FOR MRC SUPPORT             OCT 2019  ArDean Leith
+C                                                                     
+d12 1
+a12 1
+C=* Copyright 1985-2019  Health Research Inc.,                         *
+d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+d46 1
+a46 1
+C                   0   IMAGE:  8-BIT BYTES RANGE -128 -->127 (SIGNED)                  
+d49 3
+a51 3
+C                   6   IMAGE: UNSIGNED 8-BIT BYTES RANGE 0 -->255        
+C                   3   TRANSFORM: COMPLEX 16-BIT INTEGERS (UNSUPPORTED)   
+C                   4   TRANSFORM: COMPLEX 32-BIT REALS    (UNSUPPORTED)     
+d59 1
+a59 1
+C 14-16 CELLB       CELL ANGLES IN DEGREES  (PHI,THETA,PSI)                        
+d119 1
+d132 2
+d154 2
+d254 1
+d284 1
+d294 1
+d297 2
+a298 1
+     &                '     1: 16-bit signed integers'
+d301 2
+a302 1
+     &                '     2: 32-bit reals '
+d305 2
+a306 1
+     &                '     3: Complex 16-bit integers'
+d309 2
+a310 1
+     &                '     4: Complex 32-bit reals'
+d313 1
+a313 1
+     &                '    6 : 16-bit unsigned integers'
+d338 1
+a338 1
+1008  FORMAT(2X,'Min & max  density ....................... ',2F23.11)
+d341 1
+a341 1
+1009  FORMAT(2X,'Mean & RMS density ....................... ',2F23.11)
+d344 1
+a344 1
+1092  FORMAT(2X,'Angles (Phi,Theta,Psi) ...............     ',6F8.2)
+d353 2
+a354 1
+1091  FORMAT(2X,'Image used for stats ** .................. ',2I7)
+d359 1
+a359 1
+1013  FORMAT(2X,'Machine stamp ............................ ',I12)
+d368 1
+a368 1
+1016  FORMAT(2X,'ExtType .....................................    ',A)
+d370 23
+a392 2
+      WRITE(NOUT,1017) NLABL 
+1017  FORMAT(2X,'Number of labels ......................... ',I7)
+d397 8
+a404 5
+         WRITE(NOUT,1031)
+1031     FORMAT('  Labels:')
+
+         WRITE(NOUT,1032) LABELS(1:IEND)
+1032     FORMAT(3X,100(A80))
+d412 1
 @
 
 
diff --git src/RCS/listit.f,v src/RCS/listit.f,v
index 13a36f3d..1cc1a686 100644
--- src/RCS/listit.f,v
+++ src/RCS/listit.f,v
@@ -1,4 +1,4 @@
-head	1.34;
+head	1.35;
 access;
 symbols
 	pre_mrcs:1.34
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.35
+date	2025.11.10.22.33.26;	author dean;	state Exp;
+branches;
+next	1.34;
+
 1.34
 date	2018.10.03.14.34.09;	author leith;	state Exp;
 branches;
@@ -200,9 +205,9 @@ desc
 @
 
 
-1.34
+1.35
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -223,7 +228,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -552,6 +557,17 @@ C                FLOATING POINT LISTING
 @
 
 
+1.34
+log
+@email_health_dept
+@
+text
+@d19 1
+a19 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.33
 log
 @'LI T' for header can output to register now,  nx, ==
diff --git src/RCS/listitr.f,v src/RCS/listitr.f,v
index adea9547..e16272f4 100644
--- src/RCS/listitr.f,v
+++ src/RCS/listitr.f,v
@@ -1,4 +1,4 @@
-head	1.15;
+head	1.16;
 access;
 symbols
 	pre_mrcs:1.15
@@ -25,6 +25,11 @@ locks; strict;
 comment	@c @;
 
 
+1.16
+date	2025.11.10.22.33.26;	author dean;	state Exp;
+branches;
+next	1.15;
+
 1.15
 date	2018.10.03.14.34.09;	author leith;	state Exp;
 branches;
@@ -106,9 +111,9 @@ desc
 @
 
 
-1.15
+1.16
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -126,7 +131,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2013  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -226,6 +231,17 @@ C              POINT OUTSIDE OF IMAGE
 @
 
 
+1.15
+log
+@email_health_dept
+@
+text
+@d16 1
+a16 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.14
 log
 @update
diff --git src/RCS/lnblnk.f,v src/RCS/lnblnk.f,v
index a25c7261..4f9e0d95 100644
--- src/RCS/lnblnk.f,v
+++ src/RCS/lnblnk.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.33.26;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.09;	author leith;	state Exp;
 branches;
@@ -85,9 +90,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @ 
@@ -101,7 +106,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -177,6 +182,17 @@ C   RENAME THE OBJECT FILE TO AVOID COLLISION
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @GPL_2010
diff --git src/RCS/lnblnkn.f,v src/RCS/lnblnkn.f,v
index b81096ee..cc307b53 100644
--- src/RCS/lnblnkn.f,v
+++ src/RCS/lnblnkn.f,v
@@ -1,4 +1,4 @@
-head	1.7;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.7
@@ -24,6 +24,16 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.09.21.18.23.33;	author dean;	state Exp;
+branches;
+next	1.8;
+
+1.8
+date	2025.09.21.13.55.57;	author dean;	state Exp;
+branches;
+next	1.7;
+
 1.7
 date	2018.10.03.14.34.09;	author leith;	state Exp;
 branches;
@@ -66,22 +76,22 @@ ls *.f
 @
 
 
-1.7
+1.9
 log
-@email_health_dept
+@declared integers
 @
 text
 @C++*********************************************************************
 C
 C LNBLNKN.F   -- NEW FEB 1999                       AUTHOR: ARDEAN LEITH
-C                ADDED TAB TRAP NOV 00                      ARDEAN LEITH                        
+C                ADDED TAB TRAP NOV 00                      ARDEAN LEITH C                BUG FIXED      SEP 25                      TAPU          
 C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2010  Health Research Inc.,                         *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -110,19 +120,31 @@ C--*********************************************************************
        INTEGER FUNCTION LNBLNKN(STRING)
 
        CHARACTER *(*) STRING
+       INTEGER        LENN,LENB,IDX
 
 C      FIND LOCATION OF LAST NON-NULL, PRINTING CHARACTER IN STRING
- 
        LNBLNKN = lnblnk(STRING)
+
+C      Check for null character inside string
        LENN    = INDEX(STRING,CHAR(0)) 
        IF (LENN .GE. 1 .AND. LENN .LE. LNBLNKN) LNBLNKN = LENN - 1
 
-       IF (LNBLNKN .GT. 0 .AND. STRING(LNBLNKN:LNBLNKN) .LE. CHAR(32))
-     &    THEN
+C      If lnblnkn is 0, then string(lnblnkn:lnblnkn) below will be invalid
+       IF (LNBLNKN .LE. 0) THEN
+          LNBLNKN = 0
+          RETURN
+       ENDIF
+
+C      IF (STRING(LNBLNKN:LNBLNKN) .LE. CHAR(32)) THEN
+       IF (ICHAR(STRING(LNBLNKN:LNBLNKN)) .LE. 32) THEN
 C         LAST POSITION IS STILL NON PRINTING
           LENB = LNBLNKN
-          DO LNBLNKN = LENB,1,-1
-             IF (STRING(LNBLNKN:LNBLNKN) .GT. CHAR(32)) RETURN
+          DO IDX = LENB,1,-1
+C            IF (STRING(LNBLNKN:LNBLNKN) .GT. CHAR(32)) THEN
+             IF (ICHAR(STRING(idx:idx)) .GT. 32) THEN
+                LNBLNKN = IDX
+                RETURN
+             ENDIF
           ENDDO
           LNBLNKN = 0 
        ENDIF
@@ -133,6 +155,46 @@ C         LAST POSITION IS STILL NON PRINTING
 @
 
 
+1.8
+log
+@tapu's bug fix
+@
+text
+@d4 1
+a4 1
+C                ADDED TAB TRAP NOV 00                      ARDEAN LEITH                        
+d9 1
+a9 1
+C=* Copyright 1985-2010  Health Research Inc.,                         *
+d11 1
+a11 1
+C=* Email: spider@@wadsworth.org                                        *
+d40 1
+@
+
+
+1.7
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+a41 1
+ 
+d43 2
+d48 8
+a55 2
+       IF (LNBLNKN .GT. 0 .AND. STRING(LNBLNKN:LNBLNKN) .LE. CHAR(32))
+     &    THEN
+d58 6
+a63 2
+          DO LNBLNKN = LENB,1,-1
+             IF (STRING(LNBLNKN:LNBLNKN) .GT. CHAR(32)) RETURN
+@
+
+
 1.6
 log
 @GPL_2010
diff --git src/RCS/local.f,v src/RCS/local.f,v
index 05a5b484..22be8c26 100644
--- src/RCS/local.f,v
+++ src/RCS/local.f,v
@@ -1,4 +1,4 @@
-head	1.15;
+head	1.16;
 access;
 symbols
 	pre_mrcs:1.15
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.16
+date	2025.11.10.22.33.26;	author dean;	state Exp;
+branches;
+next	1.15;
+
 1.15
 date	2018.10.03.14.34.09;	author leith;	state Exp;
 branches;
@@ -105,9 +110,9 @@ desc
 @
 
 
-1.15
+1.16
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -125,7 +130,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -300,6 +305,17 @@ C     BORDER CLEARING.
 @
 
 
+1.15
+log
+@email_health_dept
+@
+text
+@d16 1
+a16 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.14
 log
 @cosmetic, alloc, nx
diff --git src/RCS/log2.f,v src/RCS/log2.f,v
index fefd8796..cb7fcee9 100644
--- src/RCS/log2.f,v
+++ src/RCS/log2.f,v
@@ -1,4 +1,4 @@
-head	1.7;
+head	1.8;
 access;
 symbols
 	pre_mrcs:1.7
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.8
+date	2025.11.10.22.33.26;	author dean;	state Exp;
+branches;
+next	1.7;
+
 1.7
 date	2018.10.03.14.34.09;	author leith;	state Exp;
 branches;
@@ -65,9 +70,9 @@ desc
 @
 
 
-1.7
+1.8
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*******************************************************************
@@ -80,7 +85,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -118,6 +123,17 @@ C
 @
 
 
+1.7
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.6
 log
 @GPL_2010
diff --git src/RCS/logifq.f,v src/RCS/logifq.f,v
index 414f0346..90aae33f 100644
--- src/RCS/logifq.f,v
+++ src/RCS/logifq.f,v
@@ -1,4 +1,4 @@
-head	1.15;
+head	1.16;
 access;
 symbols
 	pre_mrcs:1.15
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.16
+date	2025.11.10.22.33.26;	author dean;	state Exp;
+branches;
+next	1.15;
+
 1.15
 date	2018.10.03.14.34.09;	author leith;	state Exp;
 branches;
@@ -105,9 +110,9 @@ desc
 @
 
 
-1.15
+1.16
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -128,7 +133,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2011  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -404,6 +409,17 @@ C     ERROR HANDLER
 @
 
 
+1.15
+log
+@email_health_dept
+@
+text
+@d19 1
+a19 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.14
 log
 @ST(ICHAR:ICHAR+1) .EQ. '/=' bug fixed
diff --git src/RCS/longer.f,v src/RCS/longer.f,v
index d22969e2..441a1156 100644
--- src/RCS/longer.f,v
+++ src/RCS/longer.f,v
@@ -1,4 +1,4 @@
-head	1.7;
+head	1.8;
 access;
 symbols
 	pre_mrcs:1.7
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.8
+date	2025.11.10.22.33.26;	author dean;	state Exp;
+branches;
+next	1.7;
+
 1.7
 date	2018.10.03.14.34.09;	author leith;	state Exp;
 branches;
@@ -65,9 +70,9 @@ desc
 @
 
 
-1.7
+1.8
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -81,7 +86,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -136,6 +141,17 @@ C          SUFFIX HAS NULL LENGTH
 @
 
 
+1.7
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.6
 log
 @GPL_2010
diff --git src/RCS/lundoc.f,v src/RCS/lundoc.f,v
index cc4c1ec6..1faa940f 100644
--- src/RCS/lundoc.f,v
+++ src/RCS/lundoc.f,v
@@ -1,4 +1,4 @@
-head	1.115;
+head	1.116;
 access;
 symbols
 	pre_mrcs:1.115
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.116
+date	2025.11.10.22.33.26;	author dean;	state Exp;
+branches;
+next	1.115;
+
 1.115
 date	2018.10.03.14.34.09;	author leith;	state Exp;
 branches;
@@ -604,9 +609,9 @@ desc
 @@
 
 
-1.115
+1.116
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -658,7 +663,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2017  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -2250,6 +2255,17 @@ C ---------------------------------------------------------------
 @
 
 
+1.115
+log
+@email_health_dept
+@
+text
+@d50 1
+a50 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.114
 log
 @add flush to some lundocwrtdat output files
diff --git src/RCS/lunsethdr.f,v src/RCS/lunsethdr.f,v
index 4a8dfe7b..2e364d84 100644
--- src/RCS/lunsethdr.f,v
+++ src/RCS/lunsethdr.f,v
@@ -1,4 +1,4 @@
-head	1.74;
+head	1.79;
 access;
 symbols
 	pre_mrcs:1.71
@@ -24,6 +24,31 @@ locks; strict;
 comment	@c @;
 
 
+1.79
+date	2025.11.10.22.33.58;	author dean;	state Exp;
+branches;
+next	1.78;
+
+1.78
+date	2025.09.30.19.26.13;	author dean;	state Exp;
+branches;
+next	1.77;
+
+1.77
+date	2025.09.26.15.12.02;	author dean;	state Exp;
+branches;
+next	1.76;
+
+1.76
+date	2025.09.26.15.07.03;	author dean;	state Exp;
+branches;
+next	1.75;
+
+1.75
+date	2025.09.21.15.18.56;	author dean;	state Exp;
+branches;
+next	1.74;
+
 1.74
 date	2020.01.21.15.58.28;	author leith;	state Exp;
 branches;
@@ -399,9 +424,9 @@ desc
 @@
 
 
-1.74
+1.79
 log
-@fmin --> fmint in setstat & getstat usage clarifed (no change in logic)
+@*** empty log message ***
 @
 text
 @
@@ -422,14 +447,15 @@ C                LABBYT >= 10000000) TRAP       MAR 2011  ArDean Leith
 C                MAXNAM                         JUL 2014  ArDean Leith
 C                EM2EM BUG RECOVERY SUPPORT     AUG 2014  ArDean Leith
 C                MRC SUPPORT                    MAY 2019  ArDean Leith
+C                MRC SUPPORT FIXED              SEP 2025  ArDean Leith
 C                    
 C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2019 Health Research Inc.,                          *
+C=* Copyright 1985-2025 Health Research Inc.,                          *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -459,10 +485,10 @@ C     ------------------------- LUNSETLAB -----------------------------
 C     ------------------------- LUNGETLAB -----------------------------
 C     ------------------------- LUNGETTYPE ----------------------------
 C     ------------------------- LUNSETTYPE ----------------------------
-C     ------------------------- LUNGETISTACK ----------------------------
-C     ------------------------- LUNSETISTACK ----------------------------
+C     ------------------------- LUNGETISTACK --------------------------
+C     ------------------------- LUNSETISTACK --------------------------
 C     ------------------------- LUNGETSTK -----------------------------
-C     ------------------------- LUNSET25 ---------------------------
+C     ------------------------- LUNSET25 ------------------------------
 C     ------------------------- LUNSETINUSE ---------------------------
 C     ------------------------- LUNGETINUSE ---------------------------
 C     ------------------------- LUNGETMAXIM ---------------------------
@@ -494,7 +520,9 @@ C     ------------------------- LUNWRTINDX ----------------------------
 C     ------------------------- LUNGETINDXTOP -------------------------
 C     ------------------------- LUNSETINDXTOP -------------------------
 C     ------------------------- LUNSETVALS ----------------------------
-C     ------------------------- LUNSETIMGOFF -------------------------
+C     ------------------------- LUNSETIMGOFF --------------------------
+C     ------------------------- LUNSETFLIP ----------------------------
+C     ------------------------- LUNGETFLIP ----------------------------
 C      
 C     STATIC LOCATION    257 -- IDSP
 C                        258 -- ISBARE
@@ -524,7 +552,7 @@ C     INITIALIZES OFFSETS IN LUNARA,LUNSTK,LUNARB & LUNFLIP ARRAYS
 
       INTEGER  :: LUN,IVALA,IVALSTK,IVALLUN,IVALFLIP,IRTFLG
 
-      INTEGER  :: LUNARA(100),LUNSTK(100),LUNARB(100),LUNFLIP(100)
+      INTEGER  ::     LUNARA(100),LUNSTK(100),LUNARB(100),LUNFLIP(100)
       COMMON /LUNARA/ LUNARA,LUNSTK,LUNARB,LUNFLIP
 
       LUNARA(LUN)  = IVALA
@@ -547,8 +575,8 @@ C     OVERALL HEADER TO ENSURE THAT LUNGETHEDOFF SUCCEEDS
 
       INTEGER      :: LUN,NX,IMGNUM,IRTFLG 
 
-      INTEGER      :: LUNARA(100),LUNSTK(100),LUNARB(100) 
-      COMMON /LUNARA/ LUNARA,LUNSTK,LUNARB
+      INTEGER      :: LUNARA(100),LUNSTK(100),LUNARB(100),LUNFLIP(100)  
+      COMMON /LUNARA/ LUNARA,LUNSTK,LUNARB,LUNFLIP
 
       INTEGER      :: IERR 
       COMMON /IOERR/  IERR
@@ -560,12 +588,14 @@ C     OVERALL HEADER TO ENSURE THAT LUNGETHEDOFF SUCCEEDS
 C     SET PROPER  OFFSET IN LUNSTK
       LUNSTKSAV   = LUNSTK(LUN)
       LABRECSAV   = LUNARA(LUN)
-      !write(3,*) ' In labrecsav:',lunstksav,labrecsav,lun
+      !write(6,*) ' In labrecsav:',lunstksav,labrecsav,lun
 
 C     FIND PROPER IMGNUM OFFSET 
       CALL LUNGETHEDOFF(LUN,NX,IMGNUM,
      &                  LUNARA(LUN),LUNSTK(LUN),IRTFLG)
-      !write(3,*) ' In lunredhdr, imgnum:',imgnum
+
+      !write(6,*) ' In lunredhdr, imgnum--------:',imgnum
+
       IF (IRTFLG .NE. 0) RETURN
 
 C     POINT TO HEADER OBJECT
@@ -596,7 +626,9 @@ C        LENT IS REMAINING LENGTH OF HEADER TO BE FILLED
 
 C     REPLACE OFFSETS IN LUNARA & LUNSTK    
       LUNARA(LUN) = LABRECSAV
-      LUNSTK(LUN) = LUNSTKSAV 
+      LUNSTK(LUN) = LUNSTKSAV
+ 
+      ! write(6,*) ' In lunredhed:',lun,header(27)
 
       END
 
@@ -737,7 +769,8 @@ C     SHOULD ONLY BE CALLED FOR STACKS!
 
       INCLUDE 'CMBLOCK.INC'
 
-      COMMON /LUNARA/ LUNARA(100),LUNSTK(100),LUNARB(100)
+      INTEGER  ::     LUNARA,LUNSTK,LUNARB,LUNFLIP
+      COMMON /LUNARA/ LUNARA(100),LUNSTK(100),LUNARB(100),LUNFLIP(100)
 
 C     GET RECORD INFO (CAN BE FROM OVERALL HEADER)
       CALL LUNGETLAB(LUN,LABREC,INDXREC,NRECS,NDUM1,NDUM2,IRTFLG)
@@ -793,6 +826,7 @@ C     ------------------------- LUNGETTYPE ----------------------------
 #include "LUNHDR.INC"
 
       INTEGER   :: LUN,ITYPE,IRTFLG 
+      LOGICAL  :: IS_MRC
 
 C     DETERMINE IF MRC OR SPIDER HEADER OBJECT
       CALL LUNGETIS_MRC(LUN,IS_MRC,IRTFLG)
@@ -979,8 +1013,8 @@ C     WRITES HEADER OBJECT TO SPECIFIED IMAGE HEADER
 
 #include "LUNHDR.INC"
 
-      INTEGER      :: LUNARA,LUNSTK,LUNARB
-      COMMON /LUNARA/ LUNARA(100),LUNSTK(100),LUNARB(100)
+      INTEGER ::      LUNARA,LUNSTK,LUNARB,LUNFLIP
+      COMMON /LUNARA/ LUNARA(100),LUNSTK(100),LUNARB(100),LUNFLIP(100)
 
       INCLUDE 'CMBLOCK.INC'
 
@@ -989,6 +1023,7 @@ C     WRITES HEADER OBJECT TO SPECIFIED IMAGE HEADER
 
       INTEGER  :: LUN,NX,IMGNUM,IRTFLG
 
+
       INTEGER  :: LUNSTKSAV,LABRECSAV,IRECT,ILOC,LENT
       LOGICAL  :: IS_MRC
 
@@ -1070,14 +1105,19 @@ C     ------------------------- LUNGETINUSE ----------------------------
 #include "LUNHDR.INC"
 
       INTEGER  :: LUN,INUSE,IRTFLG
+      integer  :: iwas
 
 C     POINT TO HEADER OBJECT
       CALL LUNGETOBJ(LUN,HEADER,IRTFLG)
       IF (IRTFLG .NE. 0) RETURN
  
+      iwas = inuse
+ 
 C     GET STACK RELATED LOCATIONS
       INUSE = HEADER(27) 
 
+C      write(6,*)' In getinuse, lun,hd27--99:',
+C     &            lun,header(27),iwas,' -->',inuse 
       IRTFLG = 0
       END
 
@@ -1088,6 +1128,7 @@ C     ------------------------- LUNSETINUSE ----------------------------
 #include "LUNHDR.INC"
 
       INTEGER  :: LUN,INUSE,IRTFLG
+      LOGICAL  :: IS_MRC
 
 C     DETERMINE IF MRC OR SPIDER HEADER OBJECT
       CALL LUNGETIS_MRC(LUN,IS_MRC,IRTFLG)
@@ -1150,6 +1191,7 @@ C     ------------------------- LUNSETMAXIM ----------------------------
 #include "LUNHDR.INC"
 
       INTEGER  :: LUN,MAXIM,IRTFLG
+      LOGICAL  :: IS_MRC
 
 C     DETERMINE IF MRC OR SPIDER HEADER OBJECT
       CALL LUNGETIS_MRC(LUN,IS_MRC,IRTFLG)
@@ -1199,7 +1241,8 @@ C     COMPLICATED SINCE I DO NOT WANT TO ALTER CURRENT FILE HEADER OBJECT
       INCLUDE 'CMLIMIT.INC'
       COMMON /IOBUF/ BUF(NBUFSIZ)
 
-      COMMON /LUNARA/ LUNARA(100),LUNSTK(100),LUNARB(100)
+      INTEGER ::      LUNARA,LUNSTK,LUNARB,LUNFLIP
+      COMMON /LUNARA/ LUNARA(100),LUNSTK(100),LUNARB(100),LUNFLIP(100)
 
       COMMON /IOERR/  IERR
 
@@ -1409,7 +1452,7 @@ C     GET RETURN VALUES
       IRTFLG = 0
       END
 
-C     ------------------------- LUNGETPIXSIZ ----------------------------
+C     ------------------------- LUNGETPIXSIZ -------------------------
 
       SUBROUTINE LUNGETPIXSIZ(LUN,PIXSIZ,IRTFLG)
 
@@ -1439,7 +1482,7 @@ C     GET RETURN VALUES
       IRTFLG = 0
       END
 
-C     ------------------------- LUNSETPIXSIZ ----------------------------
+C     ------------------------- LUNSETPIXSIZ -------------------------
 
       SUBROUTINE LUNSETPIXSIZ(LUN,PIXSIZ,IRTFLG)
 
@@ -1880,8 +1923,14 @@ C        NOTE THAT ALPHA-NUMERICAL DATA (ABCD) WILL BE WRITTEN (DCBA)
 
 C     RECOVER TITLE FROM CLINE
       FILETITLE = CLINE(21:180)
+      !write(6,*) 'In lungettitle - cline(21:180):',cline(21:180),'||'
+      !write(6,*) 'In lungettitle - filetitle:',filetitle,'||'
+
       LENTIT    = lnblnkn(FILETITLE)
 
+      !write(6,*) 'In lungettitle - lentit:',lentit
+      !write(6,*) 'In lungettitle - filetitle:',filetitle,'||'
+
       IRTFLG = 0
       END
 
@@ -2005,7 +2054,7 @@ C     ------------------------- LUNSAYINFO ----------------------------
       CHARACTER * 2    TYPE
       CHARACTER *12    CDAT
       CHARACTER *8     CTIM
-      CHARACTER *160   CTIT
+      CHARACTER *160   CTIT_LOCAL
 
       CHARACTER(LEN=MAXNAM):: FILNAM
 
@@ -2068,8 +2117,17 @@ C     RETRIEVE CURRENT FILENAME (INCLUDES IMGNUM IF STACKED IMAGE)
 
 C     RECOVER FILE DATE, TIME & TITLE FROM HEADER
       CALL LUNGETDATE(LUN,CDAT,CTIM,IRTFLG)
-      CALL LUNGETTITLE(LUN,CTIT,LENTIT,IRTFLG)
+
+c     write(6,*)'In lunsayinfo - lun,lentit,irtflg: ',lun,lentit,irtflg
+c     ctit_local = 'cow'
+c     write(6,*)'In lunsayinfo - ctit_local:',ctit_local,'}}'
+
+      CALL LUNGETTITLE(LUN,CTIT_LOCAL,LENTIT,IRTFLG)
       
+c     write(6,*)' In lunsayinfo - lun,lentit,irtflg: ',
+c     &                           lun,lentit,irtflg
+c     write(6,*)'In lunsayinfo - ctit_local: ',ctit_local(1:lentit),'||'
+
 C     GET RECORD INFO
       CALL LUNGETLAB(LUN,LABREC,INDXREC,NRECS,LABBYT,LENBYT,IRTFLG)
 
@@ -2122,7 +2180,8 @@ C           FILENAME BUT NO TITLE
          ELSE IF (LENT > 0 .AND. LENT < 70) THEN
 C           HAS FILENAME AND TITLE THAT FIT ON ONE LINE
             IF (MYPID <= 0) THEN
-               WRITE(NOUT,*) ' ',FILNAM(:NLET),'     /',CTIT(:LENTIT)
+               WRITE(NOUT,*) ' ',FILNAM(:NLET),
+     &                       '     /',CTIT_LOCAL(:LENTIT)
             ENDIF
 
 
@@ -2132,8 +2191,8 @@ C           FILENAME AND TITLE DO NOT FIT ON SINGLE LINE
             LENT = MIN(80,LENTIT)
 
             IF (MYPID <= 0) THEN
-               WRITE(NOUT,*) ' ',CTIT(1:LENT)
-               IF (LENTIT > 80)  WRITE(NOUT,*) ' ',CTIT(81:LENTIT)
+               WRITE(NOUT,*) ' ',CTIT_LOCAL(1:LENT)
+               IF (LENTIT > 80) WRITE(NOUT,*) ' ',CTIT_LOCAL(81:LENTIT)
             ENDIF
 
          ENDIF
@@ -2203,7 +2262,7 @@ C           SIMPLE IMAGE
       END
 
 
-C     ------------------------- LUNSETCOMMON ----------------------------
+C     ------------------------- LUNSETCOMMON -------------------------
 
       SUBROUTINE LUNSETCOMMON(LUN,IRTFLG)
 
@@ -2211,6 +2270,8 @@ C     ------------------------- LUNSETCOMMON ----------------------------
 
       INCLUDE 'CMBLOCK.INC'
 
+      INTEGER           :: LUN,IRTFLG
+
       CHARACTER(LEN=12) :: CDUM
       CHARACTER(LEN=1)  :: NULL = CHAR(0)
 
@@ -2259,7 +2320,7 @@ C     DATE NOT PASSED IN COMMON ANY MORE AS COMMON IS ONLY 10 CHAR.
 C     RECOVER ANGLES
       CALL LUNGETANG(LUN,IANGLE,PHI,THETA,PSI,XOFF,YOFF,ZOFF, 
      &               KANGLE,IRTFLG)
-      IF (IRTFLG .NE. 0) RETURN
+      IF (IRTFLG .NE.  0) RETURN
 
 C     SET REGISTER VALUES AS NEEDED
       CALL REG_SET(1,FLOAT(NSAMC),  NULL, IRTFLG)
@@ -2294,6 +2355,7 @@ C           LABBYT, LABREC, NREC, DATE, TIME, IMGNUM, INUSE
       REAL, POINTER           :: HEADERT(:) 
 
       IRTFLG = 1
+      ! write(6,*)'In lunsethdr; call lungetobj; lun,lunt: ',lun,lunt
 
 C     POINT TO HEADER OBJECT
       CALL LUNGETOBJ(LUN,HEADER,IRTFLG)
@@ -2303,6 +2365,8 @@ C     POINT TO HEADER OBJECT
 C        COPY ALL HEADER BUFFER SPACES UP TO LENBUF
 C        POINT TO TRANSFER HEADER OBJECT
 
+         !write(6,*)' In lunsethdr; call lungetobj; lunt: ',lunt
+
          CALL LUNGETOBJ(LUNT,HEADERT,IRTFLG)
          IF (IRTFLG .NE. 0) THEN
            CALL ERRT(102,'LUNGETOBJ FAILED FOR LUN:',LUNT)
@@ -2366,7 +2430,8 @@ C     CLEARS ALL INDEX RECORDS
 
 #include "LUNHDR.INC"
 
-      COMMON /LUNARA/ LUNARA(100),LUNSTK(100),LUNARB(100)
+      INTEGER  ::     LUNARA,LUNSTK,LUNARB,LUNFLIP
+      COMMON /LUNARA/ LUNARA(100),LUNSTK(100),LUNARB(100),LUNFLIP(100)
 
       INCLUDE 'CMBLOCK.INC'
 
@@ -2426,7 +2491,9 @@ C     ----------- LUNWRTINDX --------------------------------------
 C     SETS INDEX FOR A SPECIFIED IMGNUM 
 
       INCLUDE 'CMBLOCK.INC'
-      COMMON /LUNARA/ LUNARA(100),LUNSTK(100),LUNARB(100)
+
+      INTEGER  ::     LUNARA,LUNSTK,LUNARB,LUNFLIP
+      COMMON /LUNARA/ LUNARA(100),LUNSTK(100),LUNARB(100),LUNFLIP(100)
  
       INTEGER :: INDXBUF(NX)
 
@@ -2488,10 +2555,11 @@ C     RETURNS INDEX FOR A SPECIFIED IMGNUM
 
       INCLUDE 'CMBLOCK.INC'
 
-      COMMON /LUNARA/ LUNARA(100),LUNSTK(100),LUNARB(100)
+      INTEGER  ::     LUNARA,LUNSTK,LUNARB,LUNFLIP
+      COMMON /LUNARA/ LUNARA(100),LUNSTK(100),LUNARB(100),LUNFLIP(100)
  
       INTEGER  :: LUN,IMGNUM,INDX,NX,IRTFLG
-
+      
 C     AUTOMATIC ARRAY
       INTEGER  :: INDXBUF(NX)
 
@@ -2550,7 +2618,7 @@ C     POINT TO HEADER OBJECT
       IF (IRTFLG .NE. 0) RETURN
 
 C     SET INUSE RELATED LOCATION
-      HEADER(25) = -1 
+      HEADER(25) =  -1 
 
       IRTFLG = 0
       END
@@ -2629,12 +2697,11 @@ C     SETS DUPLICATE LUN OPEN  IN LUNARB(LUN)
       INTEGER  :: LUN,LUNB,IRTFLG
 
       INTEGER  :: LUNARA,LUNSTK,LUNARB,LUNFLIP
-
       COMMON /LUNARA/ LUNARA(100),LUNSTK(100),LUNARB(100),LUNFLIP(100)
 
       LUNARB(LUN) = LUNB
 
-      !write(3,*) ' In lunsetlunb, lun,lunb: ',lun,lunb,lunarb(lun)
+      !write(6,*) ' In lunsetlunb, lun,lunb: ',lun,lunb,lunarb(lun)
 
       IRTFLG      = 0
       END
@@ -2649,7 +2716,6 @@ C     GETS DUPLICATE LUN OPEN  IN LUNARB(LUN)
       INTEGER  :: LUN,LUNB,IRTFLG
 
       INTEGER  :: LUNARA,LUNSTK,LUNARB,LUNFLIP
-
       COMMON /LUNARA/ LUNARA(100),LUNSTK(100),LUNARB(100),LUNFLIP(100)
 
       LUNB   = LUNARB(LUN)
@@ -2667,11 +2733,10 @@ C     SETS FLIP IN LUNFLIP(LUN)
       INTEGER  :: LUN,IFLIP,IRTFLG
 
       INTEGER  :: LUNARA,LUNSTK,LUNARB,LUNFLIP
-
       COMMON /LUNARA/ LUNARA(100),LUNSTK(100),LUNARB(100),LUNFLIP(100)
 
       LUNFLIP(LUN) = IFLIP
-
+      
       IRTFLG       = 0
       END
 
@@ -2720,6 +2785,176 @@ C     FLIP VALUES
 @
 
 
+1.78
+log
+@removed debug output
+@
+text
+@d2131 1
+a2131 1
+
+@
+
+
+1.77
+log
+@debug output commented out
+@
+text
+@d57 2
+a58 2
+C     ------------------------- LUNGETISTACK ----------------------------
+C     ------------------------- LUNSETISTACK ----------------------------
+d60 1
+a60 1
+C     ------------------------- LUNSET25 ---------------------------
+d93 2
+d1024 1
+a1024 1
+C     ------------------------- LUNGETPIXSIZ ----------------------------
+d1054 1
+a1054 1
+C     ------------------------- LUNSETPIXSIZ ----------------------------
+d1842 2
+d1927 1
+d1936 2
+@
+
+
+1.76
+log
+@CTIT_LOCAL used to avoid confusion, debug output added
+@
+text
+@d158 1
+a158 1
+      !write(3,*) ' In labrecsav:',lunstksav,labrecsav,lun
+d164 1
+a164 1
+      !write(3,*) ' In lunredhdr, imgnum--------:',imgnum
+d198 1
+a198 1
+      ! write(3,*) ' In lunredhed:',lun,header(27)
+d686 1
+a686 1
+C      write(3,*)' In getinuse, lun,hd27--99:',
+d1493 2
+a1494 2
+       write(3,*) 'In lungettitle - cline(21:180):',cline(21:180),'||'
+       write(3,*) 'In lungettitle - filetitle:',filetitle,'||'
+d1498 2
+a1499 2
+        write(3,*) 'In lungettitle - lentit:',lentit
+        write(3,*) 'In lungettitle - filetitle:',filetitle,'||'
+d1694 1
+a1694 1
+c     write(3,*)' In lunsayinfo - lun,lentit,irtflg: ',
+d2266 1
+a2266 1
+      !write(3,*) ' In lunsetlunb, lun,lunb: ',lun,lunb,lunarb(lun)
+@
+
+
+1.75
+log
+@COMMON /LUNARA/ LUNARA(100),LUNSTK(100),LUNARB(100),LUNFLIP(100) 
+other gfort problems
+@
+text
+@d19 1
+d25 1
+a25 1
+C=* Copyright 1985-2019 Health Research Inc.,                          *
+d27 1
+a27 1
+C=* Email: spider@@health.ny.gov                                        *
+d92 1
+a92 1
+C     ------------------------- LUNSETIMGOFF -------------------------
+d1493 3
+d1498 3
+d1624 1
+a1624 1
+      CHARACTER *160   CTIT
+d1687 6
+a1692 1
+      CALL LUNGETTITLE(LUN,CTIT,LENTIT,IRTFLG)
+d1694 4
+d1750 2
+a1751 1
+               WRITE(NOUT,*) ' ',FILNAM(:NLET),'     /',CTIT(:LENTIT)
+d1761 2
+a1762 2
+               WRITE(NOUT,*) ' ',CTIT(1:LENT)
+               IF (LENTIT > 80)  WRITE(NOUT,*) ' ',CTIT(81:LENTIT)
+d1832 1
+a1832 1
+C     ------------------------- LUNSETCOMMON ----------------------------
+@
+
+
+1.74
+log
+@fmin --> fmint in setstat & getstat usage clarifed (no change in logic)
+@
+text
+@d121 1
+a121 1
+      INTEGER  :: LUNARA(100),LUNSTK(100),LUNARB(100),LUNFLIP(100)
+d144 2
+a145 2
+      INTEGER      :: LUNARA(100),LUNSTK(100),LUNARB(100) 
+      COMMON /LUNARA/ LUNARA,LUNSTK,LUNARB
+d162 3
+a164 1
+      !write(3,*) ' In lunredhdr, imgnum:',imgnum
+d195 3
+a197 1
+      LUNSTK(LUN) = LUNSTKSAV 
+d338 2
+a339 1
+      COMMON /LUNARA/ LUNARA(100),LUNSTK(100),LUNARB(100)
+d395 1
+d582 2
+a583 2
+      INTEGER      :: LUNARA,LUNSTK,LUNARB
+      COMMON /LUNARA/ LUNARA(100),LUNSTK(100),LUNARB(100)
+d592 1
+d674 1
+d680 2
+d685 2
+d697 1
+d760 1
+d810 2
+a811 1
+      COMMON /LUNARA/ LUNARA(100),LUNSTK(100),LUNARB(100)
+d1871 1
+a1871 1
+      IF (IRTFLG .NE. 0) RETURN
+d1978 2
+a1979 1
+      COMMON /LUNARA/ LUNARA(100),LUNSTK(100),LUNARB(100)
+d2039 3
+a2041 1
+      COMMON /LUNARA/ LUNARA(100),LUNSTK(100),LUNARB(100)
+d2103 2
+a2104 1
+      COMMON /LUNARA/ LUNARA(100),LUNSTK(100),LUNARB(100)
+d2166 1
+a2166 1
+      HEADER(25) = -1 
+a2244 1
+
+a2263 1
+
+a2280 1
+
+d2284 1
+a2284 1
+
+@
+
+
 1.73
 log
 @IDUM unused
diff --git src/RCS/lunsetmrchdr.f,v src/RCS/lunsetmrchdr.f,v
index 53b32f90..2bc7f593 100644
--- src/RCS/lunsetmrchdr.f,v
+++ src/RCS/lunsetmrchdr.f,v
@@ -1,10 +1,50 @@
-head	1.13;
+head	1.21;
 access;
 symbols;
 locks; strict;
 comment	@c @;
 
 
+1.21
+date	2025.11.10.22.33.56;	author dean;	state Exp;
+branches;
+next	1.20;
+
+1.20
+date	2025.10.16.19.24.55;	author dean;	state Exp;
+branches;
+next	1.19;
+
+1.19
+date	2025.10.07.13.41.14;	author dean;	state Exp;
+branches;
+next	1.18;
+
+1.18
+date	2025.10.03.14.29.35;	author dean;	state Exp;
+branches;
+next	1.17;
+
+1.17
+date	2025.09.26.17.23.48;	author dean;	state Exp;
+branches;
+next	1.16;
+
+1.16
+date	2025.09.26.15.23.09;	author dean;	state Exp;
+branches;
+next	1.15;
+
+1.15
+date	2025.09.22.18.00.07;	author dean;	state Exp;
+branches;
+next	1.14;
+
+1.14
+date	2025.09.21.14.58.03;	author dean;	state Exp;
+branches;
+next	1.13;
+
 1.13
 date	2020.01.21.18.46.13;	author leith;	state Exp;
 branches;
@@ -76,23 +116,29 @@ desc
 @
 
 
-1.13
+1.21
 log
-@added: CALL LUNSETSTATS_MRC
+@*** empty log message ***
 @
 text
-@C++*********************************************************************
+@C++********************************************************************
+C
+C LUNSETMRCHDR.F  DERIVED FROM LUNSETHDR.F        JUN 2019 ArDean Leith
+C                 NATIVE MRC FILE SUPPORT         JUL 2019 ArDean Leit
+C                 NVIDIA COMPILER CHANGES         SEP 2025 Tapu Shaikh
+C                 NVIDIA COMPILER CHANGES UNDONE  SEP 2025 ArDean Leith
+C                 DEBUG OUTPUT CHANGED,CTIT_LOCAL SEP 2025 ArDean Leith
+C                 NBYT, NBYT_PER_VAL CONFUSED     SEP 2025 ArDean Leith
+C                 DEBUG OUTPUT ADDED              OCT 2025 ArDean Leith
+C                 LUNSETFILE SET (27)             OCT 2025 ArDean Leith
 C
-C LUNSETMRCHDR.F    DERIVED FROM LUNSETHDR.F    JUN 2019  ArDean Leith
-C                   NATIVE MRC FILE SUPPORT     JUL 2019  ArDean Leith
-C                    
 C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2020 Health Research Inc.,                          *
+C=* Copyright 1985-2025 Health Research Inc.,                          *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -152,7 +198,8 @@ C     ------------------------- LUNSETNSTACK_MRC -------------------
 C     ------------------------- LUNSETCOMMON_MRC ------------------- 
 C     ------------------------- LUNGETLABELS_MRC ------------------- 
 C     ------------------------- LUNSAYINFO_MRC --------------------- 
-C
+C     ------------------------- LUNGETMODSIZES_MRC -----------------
+
 C  REAL LOCATIONS:      
 C
 C      CELLAX   = TRANSFER(MRC_HEADER(11),FVAL)  ! PIXEL SIZE * NX
@@ -187,7 +234,7 @@ C      ORZ      = TRANSFER(MRC_HEADER(52),FVAL)
 C
 C      MAP      = TRANSFER(MRC_HEADER(53),CSTR(1:4))
 C
-C      RMS      = TRANSFER(MRC_HEADER(55),FVAL) ! DEVIATION FROM MEAN DENSITY          
+C      RMS      = TRANSFER(MRC_HEADER(55),FVAL) ! DEVIATION FROM MEAN DENSITY   
 C
 C
 C
@@ -263,6 +310,9 @@ C     READS MRC IMAGE HEADER FROM FILE INTO MRC HEADER OBJECT
 
       INTEGER * 8  :: IPOSMRC
 
+      character(len=4) :: caxis
+
+ 
 C     INCLUSION FOR OPTIONAL MPI INITIALIZATION.  
       INTEGER      :: MYPID = -1
 #include "MPI_INIT.INC"
@@ -290,7 +340,13 @@ C       ALWAYS BROADCASTS IF ONLYONE_RED IS .TRUE. WHEN USING MPI
       ENDIF
 #endif
 
-      !write(3,*)' In lunredhed_mrc, mrc_header:',mrc_header(1:9)
+
+
+#if defined(SP_DBUG)
+       caxis = transfer(mrc_header(26),caxis) 
+       write(3,*)' In lunredhed_mrc, mrc_header: ',mrc_header(26)
+       write(3,*)' In lunredhed_mrc, caxis:',caxis
+#endif
 
       IF (MYPID <= 0 .AND. IRTFLG .NE. 0 .AND. CALLERRT) THEN
          CALL ERRT(102,'I/O ERROR ON FILE HEADER',IRTFLG)
@@ -305,17 +361,18 @@ C     ----------- LUNWRTHED_MRC ---------------------------------------
 
       SUBROUTINE LUNWRTHED_MRC(LUN,IRTFLG)
 
-C     WRITES HEADER OBJECT INTO FILE'S MRC IMAGE HEADER
+C     WRITES HEADER OBJECT INTO MRC FILE'S HEADER (ONLY HAS 1 HEADER)
 
 #include "LUNHDR.INC"
 
       INTEGER    :: LUN,IRTFLG
 
-      INTEGER *8 :: IPOSMRC 
+      INTEGER *8 :: IPOSMRC = 1    ! LONG INTEGER
       real       :: fval
 
 C     INCLUSION FOR OPTIONAL MPI INITIALIZATION.  
-      INTEGER      :: MYPID = -1
+      INTEGER    :: MYPID = -1
+
 #include "MPI_INIT.INC"
 
 C     POINT TO HEADER OBJECT
@@ -323,14 +380,20 @@ C     POINT TO HEADER OBJECT
       IF (IRTFLG .NE. 0) RETURN
 
 C     WRITE HEADER RECORD FROM MRC_HEADER INTO MRC FILE 
-      IPOSMRC = 1
 
       IF (MYPID <= 0) 
      &    WRITE(LUN, POS=IPOSMRC,IOSTAT=IRTFLG) MRC_HEADER(1:256)
-      !write(3,*)' In lunwrthed_mrc, header(25): ',mrc_header(25),lun   
 
-#ifdef USE_MPI
+#if defined(SP_DBUGIO)
+      write(3,*) ' '
+      write(3,*) ' In lunwrthed_mrc; iposmrc,irtflg: ',iposmrc,irtflg
+      write(3,*) ' In lunwrthed_mrc; header(25): ',    mrc_header(25)
+      write(3,*) ' '
+      !CALL BACKTRACE
+#endif
 
+
+#ifdef USE_MPI
       IF (ONLYONE_RED) THEN
 C       ALWAYS BROADCASTS IF ONLYONE_RED IS .TRUE. WHEN USING MPI
         CALL BCAST_MPI('LUNWRTHED_MRC','MRC_HEADER',MRC_HEADER,256,'I',
@@ -339,9 +402,11 @@ C       ALWAYS BROADCASTS IF ONLYONE_RED IS .TRUE. WHEN USING MPI
      &                  ICOMM,MPIERR)
       ENDIF
 #endif
+
       !fval = transfer(mrc_header(20),fval)
 
       IF (MYPID <= 0 .AND. IRTFLG .NE. 0) THEN
+
          CALL ERRT(102,'WRITING TO MRC FILE HEADER',IRTFLG)
          IRTFLG = 1
       ENDIF
@@ -379,11 +444,11 @@ C     POINT TO HEADER OBJECT
 
 C     ------------------ LUNGETPOSINFO_MRC ----------------------------
 
-      SUBROUTINE LUNGETPOSINFO_MRC(LUN,NBYT,IHEDLEN,IRTFLG)
+      SUBROUTINE LUNGETPOSINFO_MRC(LUN,NBYT_PER_VAL,IHEDLEN,IRTFLG)
 
 #include "LUNHDR.INC"
      
-      INTEGER         :: LUN,NBYT,IHEDLEN,IRTFLG
+      INTEGER         :: LUN,NBYT_PER_VAL,IHEDLEN,IRTFLG
 
       INTEGER         :: NSYMBT,MRCMODE
 
@@ -403,33 +468,68 @@ C     CALCULATE NUMBER OF BYTES IN AN IMAGE VALUE (<0 == UNSIGNED)
       MRCMODE = MRC_HEADER(4)
 
       IF     (MRCMODE == 0) THEN
-         NBYT =  1           ! SIGNED    8 BIT INTEGER*1 
+         NBYT_PER_VAL =  1         ! SIGNED    8 BIT INTEGER*1
+ 
       ELSEIF (MRCMODE == 1) THEN
-         NBYT =  2           ! SIGNED   16 BIT INTEGER*2
+         NBYT_PER_VAL =  2         ! SIGNED   16 BIT INTEGER*2
+
       ELSEIF (MRCMODE == 6) THEN
-         NBYT = -2           ! UNSIGNED 16 BIT INTEGER*2
+         NBYT_PER_VAL = -2         ! UNSIGNED 16 BIT INTEGER*2
+
       ELSEIF (MRCMODE == 2) THEN
-         NBYT =  4           ! REAL*4  
+         NBYT_PER_VAL =  4         ! REAL*4
+  
       ELSE
-         NBYT   = 0          ! NOT A VALID MRC FILE
+         NBYT_PER_VAL = 0          ! NOT A VALID MRC FILE
          IRTFLG = 1
+         RETURN
       ENDIF
 
       IRTFLG = 0
       END
 
+
+C     ------------------ LUNSET_HEDPOS_MRC ----------------------------
+
+      SUBROUTINE LUNSET_HEDPOS_MRC(LUN,IRTFLG)
+
+      IMPLICIT NONE
+     
+      INTEGER        :: LUN,IRTFLG
+
+      INTEGER * 8    :: LUNMRCPOS 
+      INTEGER        :: LUNMRCNBYT
+      COMMON /LUNMRC/   LUNMRCPOS(100),LUNMRCNBYT(100)
+
+      INTEGER        :: LUNARA,LUNSTK,LUNARB,LUNFLIP
+      COMMON /LUNARA/   LUNARA(100),LUNSTK(100),LUNARB(100),LUNFLIP(100)
+
+      INTEGER        :: NX,NY,NZ
+
+      CALL LUNGETSIZE_MRC(LUN,NX,NY,NZ,IRTFLG)
+      IF (IRTFLG .NE. 0) RETURN
+
+      LUNARA(LUN)    = NX
+
+C     NO STACK OFFSET NEEDED
+      LUNMRCPOS(LUN) = 1
+
+      IRTFLG = 0
+      END
+
 C     ------------------ LUNSETPOS_MRC ----------------------------
 
       SUBROUTINE LUNSETPOS_MRC(LUN,IMGNUM,IRTFLG)
 
       IMPLICIT NONE
      
-      INTEGER         :: LUN,IMGNUM,IRTFLG
+      INTEGER        :: LUN,IMGNUM,IRTFLG
 
-      INTEGER * 8     :: LUNMRCPOS 
-      INTEGER         :: LUNMRCNBYT
-      COMMON /LUNMRC/    LUNMRCPOS(100),LUNMRCNBYT(100)
-      INTEGER         :: LUNARA,LUNSTK,LUNARB,LUNFLIP
+      INTEGER * 8    :: LUNMRCPOS 
+      INTEGER        :: LUNMRCNBYT
+      COMMON /LUNMRC/   LUNMRCPOS(100),LUNMRCNBYT(100)
+
+      INTEGER        :: LUNARA,LUNSTK,LUNARB,LUNFLIP
       COMMON /LUNARA/   LUNARA(100),LUNSTK(100),LUNARB(100),LUNFLIP(100)
 
       INTEGER         :: NBYT,IHEDLEN,NBYT_PER_VAL,NBYT_PER_REC
@@ -442,16 +542,16 @@ C     THIS IS NOT A STANDARD MRC DEFINED HEADER POSITION!!
       IF (IRTFLG .NE. 0) RETURN
 
 C     GET NUMBER OF BYTES IN AN IMAGE VALUE AND HEADER LENGTH
-      CALL LUNGETPOSINFO_MRC(LUN,NBYT,IHEDLEN,IRTFLG)
+      CALL LUNGETPOSINFO_MRC(LUN,NBYT_PER_VAL,IHEDLEN,IRTFLG)
       IF (IRTFLG .NE. 0) RETURN
 
 C     NZ IS ADJUSTED FOR RELION .mrcs FILES IF NEEDED
       CALL LUNGETSIZE_MRC(LUN,NX,NY,NZ,IRTFLG)
       IF (IRTFLG .NE. 0) RETURN
 
-      LUNMRCNBYT(LUN) = NBYT       ! PRESERVES NEGATIVE FOR SIGN
+      LUNMRCNBYT(LUN) = NBYT_PER_VAL  ! PRESERVES NEGATIVE FOR SIGN
 
-      NBYT_PER_VAL    = ABS(NBYT)   
+      NBYT_PER_VAL    = ABS(NBYT_PER_VAL)   
       NBYT_PER_REC    = NBYT_PER_VAL * NX
 
  
@@ -463,6 +563,7 @@ C        ORIGIN AT UPPER LEFT, POSITION AT ONE RECORD BEFORE IMAGE
          IF (IMGNUM <= 1) THEN
 C          NO STACK OFFSET NEEDED
            LUNMRCPOS(LUN) = IHEDLEN - NBYT_PER_REC + 1
+
          ELSE
 C          STACKED FILE OFFSET NEEDED 
            LUNMRCPOS(LUN) = IHEDLEN + 
@@ -489,13 +590,12 @@ C          STACKED FILE OFFSET NEEDED
          ENDIF   ! END OF: IF (IMGNUM <= 1)
       ENDIF
 
-      !write(3,*) ' In lunsetpos_mrc, imgnum,lunmrcpos(lun): ',
-      !&                               imgnum,lunmrcpos(lun)
-
-      !write(3,*)' In lunsetpos_mrc, ihedlen,nx,ny,nz,nbyt,imgnum:',
-      !&                              ihedlen,nx,ny,nz,nbyt,imgnum
-      !write(3,*)' In lunsetpos_mrc, nbyt_per_rec:', nbyt_per_rec
-      !write(3,*)' In lunsetpos_mrc lunmrcpos:',lunmrcpos(lun)
+      !write(3,*)' In lunsetpos_mrc; imgnum,lunmrcpos(lun): ',
+      !&                             imgnum,lunmrcpos(lun)
+      !write(3,*)' In lunsetpos_mrc; ihedlen,nx,ny,nz,nbyt,imgnum: ',
+      !&                             ihedlen,nx,ny,nz,nbyt,imgnum
+      !write(3,*)' In lunsetpos_mrc; nbyt_per_rec: ', nbyt_per_rec
+      !write(3,*)' In lunsetpos_mrc; lunmrcpos: ',lunmrcpos(lun)
 
       IRTFLG = 0
       END
@@ -506,13 +606,14 @@ C     ------------------------- LUNFLIPORG_MRC ------------------------
 
 #include "LUNHDR.INC"
 
-      INTEGER         :: LUN,NX,NY,NZ,IRTFLG
-      LOGICAL         :: RESET
+      INTEGER        :: LUN,NX,NY,NZ,IRTFLG
+      LOGICAL        :: RESET
 
-      INTEGER * 8     :: LUNMRCPOS 
-      INTEGER         :: LUNMRCNBYT
-      COMMON /LUNMRC/    LUNMRCPOS(100),LUNMRCNBYT(100)
-      INTEGER         :: LUNARA,LUNSTK,LUNARB,LUNFLIP
+      INTEGER * 8    :: LUNMRCPOS 
+      INTEGER        :: LUNMRCNBYT
+      COMMON /LUNMRC/   LUNMRCPOS(100),LUNMRCNBYT(100)
+
+      INTEGER        :: LUNARA,LUNSTK,LUNARB,LUNFLIP
       COMMON /LUNARA/   LUNARA(100),LUNSTK(100),LUNARB(100),LUNFLIP(100)
 
       CHARACTER(LEN=4)  :: CAXIS
@@ -538,7 +639,7 @@ C       GET AXIS ORIGIN IN FILE NOT A STANDARD MRC DEFINED POSITION!!
 
         IF (CAXIS(1:1) == 'L') THEN    
 C         ORIGIN AT LOWER LEFT, BUT POSITION AT ONE RECORD BEFORE IMAGE
-
+          NBYT_PER_REC   = LUNMRCNBYT(LUN)
           LUNMRCPOS_SAV  = LUNMRCPOS(LUN)
           LUNMRCPOS(LUN) = LUNMRCPOS(LUN) - NZ * NY * NBYT_PER_REC
 
@@ -563,7 +664,13 @@ C     PURPOSE:  QUERIES HEADER LOCATION THAT SPECIFIES MRC FILE
       INTEGER         :: LUNMRCNBYT
       COMMON /LUNMRC/    LUNMRCPOS(100),LUNMRCNBYT(100)
 
-      IS_MRC = (LUNMRCPOS(LUN) .NE. 0)
+C     Handle invalid index (LUN=0, etc.)  Sept 2025
+      IF (LUN >= LBOUND(LUNMRCPOS, 1) .AND. 
+     &    LUN <= UBOUND(LUNMRCPOS, 1)) THEN
+          IS_MRC = (LUNMRCPOS(LUN) .NE. 0)
+      ELSE
+          IS_MRC = .FALSE.
+      ENDIF
 
       IRTFLG = 0
       END
@@ -582,12 +689,17 @@ C     POINT TO HEADER OBJECT
       MAPC = MRC_HEADER(17)
       MAPR = MRC_HEADER(18)
       MAPS = MRC_HEADER(19)
-      ! write(6,*) ' In lungetmap_mrc, map c,r,s: ',mapc,mapr,maps
+
+#if defined(SP_DBUG)
+        write(3,*) ' In lungetmap_mrc; mrc_header 17,18,19:  ',
+     &        mrc_header(17),' ',mrc_header(18),' ',mrc_header(19)      
+        write(3,*) ' In lungetmap_mrc; map c,r,s: ',mapc,mapr,maps
+#endif
 
       IRTFLG = 0
       END
 
-C     ------------------------- WHICH_HAND_MRC ----------------------------
+C     ------------------------- WHICH_HAND_MRC ------------------------
 
       SUBROUTINE WHICH_HAND_MRC(LUN,FILNAM,CAXIS,IRTFLG)
 
@@ -604,29 +716,41 @@ C               BEFORE LUNSETPOS_MRC
 
       LOGICAL             :: ISMRCSFILE
 
-C     SET AXIS ORIGIN LOCATION & VOLUME HANDEDNESS BEFORE LUNSETPOS_MRC
+C     SET AXIS ORIGIN LOCATION & VOLUME HANDEDNESS BEFORE 
+C              CALLING LUNSETPOS_MRC
 
 C     SEE IF RELION COMPATIBLE IMAGE/STACK (ALWAYS 'UL L')
       ISMRCSFILE = (INDEX(FILNAM,'.MRCS') > 1  .OR.
      &              INDEX(FILNAM,'.mrcs') > 1)
+        
+#if defined(SP_DBUG)
+      write(3,*)' In lunwhichhand_mrc; ismrcsfile: ',ismrcsfile
+      write(3,*)' In lunwhichhand_mrc; caxis   1111111: ',caxis
+#endif
 
       IF (ISMRCSFILE) THEN
 C        RELION COMPATIBLE IMAGE/STACK (ALWAYS 'UL L')
          CAXIS = 'UL L'
+
          CALL LUNSETHAND_MRC(LUN,CAXIS,IRTFLG)
-       
+         !write(3,*)' In which_hand_mrc; called sethand 22222: ',caxis
+      
       ELSE
 C        SEE IF FILE HEADER ALREADY HAS CAXIS SET
          CALL LUNGETHAND_MRC(LUN,CAXIS,IRTFLG)
          IF (IRTFLG .NE. 0) RETURN
 
          IF (INDEX(CAXIS,'L') == 0) THEN
-C           CAXIS DOES NOT CONTAIN: 'UL L', 'UL R', 'LL L' or 'LL R' (ALWAYS HAS L)
+C           CAXIS DOES NOT CONTAIN: 'UL L', 'UL R', 'LL L' or 'LL R'
+C                (ALWAYS HAS L)
+
 C           SET ORIGIN & HANDEDNESS TO CURRENT DEFAULT MRC_AXIS
             CAXIS = MRC_AXIS
             CALL LUNSETHAND_MRC(LUN,CAXIS,IRTFLG)
-         ENDIF       
-      ENDIF
+
+            !write(3,*)' In which_hand_mrc; called sethand 3333: ',caxis
+        ENDIF       
+      ENDIF 
 
       END     
 
@@ -650,7 +774,9 @@ C     POINT TO HEADER OBJECT
 
       MRC_HEADER(26) = TRANSFER(CAXIS(1:4),I4V)
 
-      !write(3,*)' In lunsethand_mrc, caxis: ',mrc_header(26),caxis
+#if defined(SP_DBUG)
+      write(3,*)' In lunsethand_mrc; in header(26) caxis: ',caxis
+#endif
 
       IRTFLG = 0
       END
@@ -674,7 +800,8 @@ C     POINT TO HEADER OBJECT
       IF (IRTFLG .NE. 0) RETURN
 
       CAXIS(1:4) = TRANSFER(MRC_HEADER(26),CSTR(1:4))
-      !write(3,*)' In lungethand_mrc, lun,caxis: ',lun,caxis
+
+      !write(3,*)' In lungethand_mrc; lun,caxis: ',lun,caxis
 
       IRTFLG = 0
       END
@@ -758,12 +885,10 @@ C               123456789 123456789 123456789 123456789
          MRC_HEADER(INOW) = TRANSFER(CVAL(1:4),I4V)
       ENDDO
 
-      !write(3,*)' In lunsetstk_mrc, iversion: ',mrc_header(23),nstack
-
       IRTFLG = 0
       END
 
-C     ------------------------- LUNSETMODSIZ_MRC ----------------------------
+C     ------------------------- LUNSETMODSIZ_MRC -----------------------
 
       SUBROUTINE LUNSETMODSIZ_MRC(LUN,MRCMODE,NX,NY,NZMRC,
      &                            MX,MY,MZ,IRTFLG)
@@ -784,23 +909,18 @@ C     POINT TO HEADER OBJECT
       MRC_HEADER(9)  = MY    ! NO. OF INTERVALS ALONG Y
       MRC_HEADER(10) = MZ    ! NO. OF INTERVALS ALONG Z (>1 = STACK)
 
-      !write(6,*) ' In lunsetmodsiz_mrc: ',mrcmode,nx,ny,nz,mx,my,mz
+      !write(3,*) ' In lunsetmodsiz_mrc: ',mrcmode,nx,ny,nz,mx,my,mz
 
       IRTFLG = 0
       END
 
-C     ------------------------- LUNSETMODE_MRC ----------------------------
+C     ------------------------- LUNSETMODE_MRC ------------------------
 
       SUBROUTINE LUNSETMODE_MRC(LUN,MRCMODE,IRTFLG)
 
 #include "LUNHDR.INC"
 
-      INTEGER         :: LUN,MRCMODE,IRTFLG
-
-      INTEGER * 8     :: LUNMRCPOS 
-      INTEGER         :: LUNMRCNBYT
-      COMMON /LUNMRC/    LUNMRCPOS(100),LUNMRCNBYT(100)
-
+      INTEGER  :: LUN,MRCMODE,IRTFLG
 
 C     POINT TO HEADER OBJECT
       CALL LUNGETOBJ_MRC(LUN,MRC_HEADER,IRTFLG)
@@ -808,34 +928,33 @@ C     POINT TO HEADER OBJECT
 
       MRC_HEADER(4) = MRCMODE
 
-      !write(3,*) ' In lunsetmode_mrc: ',mrcmode
+      !write(3,*) ' In lunsetmode_mrc; mrcmode: ',mrcmode
 
       IRTFLG = 0
       END
 
 
-C     ------------------------- LUNGETMODSIZ_MRC ----------------------
+C     ------------------------- LUNGETMODSIZES_MRC --------------------
 
-      SUBROUTINE LUNGETMODSIZ_MRC(LUN,MRCMODE,NX,NY,NZMRC,
-     &                            MX,MY,MZ,IRTFLG)
+      SUBROUTINE LUNGETMODSIZES_MRC(LUN,NX,NY,NZ,
+     &                                  MX,MY,MZ,IRTFLG)
 
 #include "LUNHDR.INC"
 
-      INTEGER  :: LUN,MRCMODE,NX,NY,NZMRC,MX,MY,MZ,IRTFLG
+      INTEGER  :: LUN,NX,NY,NZ, MX,MY,MZ,IRTFLG
 
 C     POINT TO HEADER OBJECT
       CALL LUNGETOBJ_MRC(LUN,MRC_HEADER,IRTFLG)
       IF (IRTFLG .NE. 0) RETURN
 
-      MRCMODE = MRC_HEADER(4)
       NX      = MRC_HEADER(1)
       NY      = MRC_HEADER(2)
-      NZMRC   = MRC_HEADER(3)  ! NO. OF IMAGES IN RELION mrcs FILES!
+      NZ      = MRC_HEADER(3)  ! NO. OF IMAGES IN RELION mrcs FILES! 
       MX      = MRC_HEADER(8)  ! NO. OF INTERVALS ALONG X
       MY      = MRC_HEADER(9)  ! NO. OF INTERVALS ALONG Y
       MZ      = MRC_HEADER(10) ! NO. OF INTERVALS ALONG Z (>1 = STACK)
 
-      !write(6,*) ' In lungetmodsiz_mrc: ',mrcmode,nx,ny,nz,mx,my,mz
+      !write(3,*) ' In lungetmodsizes_mrc: ',mrcmode,nx,ny,nz,mx,my,mz
 
       IRTFLG = 0
       END
@@ -854,12 +973,12 @@ C     POINT TO HEADER OBJECT
 
       MRCMODE = MRC_HEADER(4)
 
-      !write(6,*) ' In lungetmod_mrc: ',mrcmode
+      !write(3,*) ' In lungetmod_mrc; mrcmode: ',mrcmode
 
       IRTFLG = 0
       END
 
-C     ------------------------- LUNGETVIN_MRC ----------------------------
+C     ------------------------- LUNGETVIN_MRC -------------------------
 
       SUBROUTINE LUNGETVIN_MRC(LUN,IVERSION,ISPG,NSYMBT,NLABL,IRTFLG)
 
@@ -879,7 +998,7 @@ C     (23)  ISPG == 401      STACK OF EM VOLUMES
       NSYMBT   = MRC_HEADER(24)  ! NO. OF ADDITIONAL HEADER BYTES
       NLABL    = MRC_HEADER(56)  ! NO. OF LABELS
 
-      ! write(6,*) ' In lungetvin_mrc, iversion', iversion
+      ! write(3,*) ' In lungetvin_mrc; iversion', iversion
 
       IRTFLG = 0
       END
@@ -904,7 +1023,7 @@ C     (23)  ISPG == 401      STACK OF EM VOLUMES
       MRC_HEADER(24) = NSYMBT ! NUMBER OF ADDITIONAL HEADER BYTES
       MRC_HEADER(56) = NLABL  ! NO. OF LABELS
 
-      !write(3,*) ' In lunsetvin_mrc, iversion', iversion,ispg
+      !write(3,*) ' In lunsetvin_mrc; iversion', iversion,ispg
 
       IRTFLG = 0
       END
@@ -929,7 +1048,6 @@ C     GET ISBARE FROM HEADER OBJECT STATIC LOCATION
       IRTFLG = 0
       END
 
-
 C     --------------------- LUNSETISBARE_MRC -------------------------
 
       SUBROUTINE LUNSETISBARE_MRC(LUN,ISBARE,IRTFLG)
@@ -955,23 +1073,33 @@ C     SET ISBARE IN MRC HEADER OBJECT (STATIC AREA)
 
 C     ------------------------- LUNSETFILE_MRC -----------------------
 
-      SUBROUTINE LUNSETFILE_MRC(LUN,FILNAM,DSP,IRTFLG)
+      SUBROUTINE LUNSETFILE_MRC(LUN,FILNAM, DSP,IRTFLG)
 
 #include "LUNHDR.INC"
 
       INTEGER                :: LUN,IRTFLG
       CHARACTER(LEN=*)       :: FILNAM
       CHARACTER(LEN=1)       :: DSP
+      CHARACTER(LEN=1)       :: NULL = CHAR(0)
 
-      INTEGER                :: NLET
+      INTEGER                :: NLET,LOCDOT
+      CHARACTER(LEN=4)       :: FIL_EXT
 
-      IF (FILNAM(1:1) .NE. CHAR(0)) THEN
+      IF (FILNAM(1:1) .NE. NULL) THEN
 C        SET CURRENT FILENAME IN HEADER OBJECT 
          NLET           = LNBLNKN(FILNAM)
          LUNFILNAM(LUN) = FILNAM(1:NLET)
+
+#if defined(NEVER_SP_DBUGIO)
+C23456
+         write(3,*) '  '
+         ilent = lnblnkn(filnam)
+         write(3,*)' In lunsetfile; filnam: ', filnam(1:ilent)
+         write(3,*)' In lunsetfile; lunfilnam(lun): ', lunfilnam(lun)
+#endif
       ENDIF
 
-      IF (DSP .NE. CHAR(0)) THEN
+      IF (DSP .NE. NULL) THEN
 
 C        POINT TO HEADER OBJECT
          CALL LUNGETOBJ_MRC(LUN,MRC_HEADER,IRTFLG)
@@ -981,8 +1109,24 @@ C        SET DSP IN STATIC HEADER OBJECT
          MRC_HEADER(257) = 0
          IF (DSP == 'N') MRC_HEADER(257) = 1
 
+         IF (FILNAM(1:1) .NE. NULL) THEN
+            NLET     = LNBLNKN(FILNAM)
+            LOCDOT   = INDEX(FILNAM(1:NLET),'.',BACK=.TRUE.)
+
+            IF (LOCDOT > 0) THEN
+               FIL_EXT = FILNAM(LOCDOT+1:NLET)
+               NLET    = lnblnkn(FIL_EXT)
+
+               IF (NLET < 4) FIL_EXT(4:4) = ' '         
+               MRC_HEADER(27) = TRANSFER(FIL_EXT(1:4),I4V)
+            ENDIF
+         ENDIF
+
+
       ENDIF
 
+
+
       IRTFLG = 0
       END
 
@@ -1037,11 +1181,13 @@ C     ------------------------- LUNSET_STATSIMG_MRC -------------------
 
       INTEGER  :: LUN,IMGSTATS,IRTFLG
 
+C     IMGSTATS IS THE CURRENT STACKED OR MAIN IMAGE NUMBER IN STATS
+
 C     POINT TO MRC HEADER OBJECT
       CALL LUNGETOBJ_MRC(LUN,MRC_HEADER,IRTFLG)
       IF (IRTFLG .NE. 0) RETURN
 
-      !write(3,*)' In lunset_statsimg_mrc, imgstats: ',imgstats
+      !write(3,*)' In lunset_statsimg_mrc; imgstats: ',imgstats
           
 C     SET MRC_HEADER VALUE
       MRC_HEADER(25) = IMGSTATS ! LOCATION: 25  IMGNUM FOR STATISTICS
@@ -1056,6 +1202,7 @@ C     ------------------------- LUNGET_STATSIMG_MRC -------------------
 #include "LUNHDR.INC"
 
       INTEGER  :: LUN,IMGSTATS,IMGNUM,NSTACK,IRTFLG
+C     IMGSTATS IS THE CURRENT STACKED OR MAIN IMAGE NUMBER IN STATS
 
 C     POINT TO MRC HEADER OBJECT
       CALL LUNGETOBJ_MRC(LUN,MRC_HEADER,IRTFLG)
@@ -1069,18 +1216,20 @@ C     GET MRC_HEADER VALUE
       IRTFLG = 0
       END
 
-C     ------------------------- LUNSETSTATS_MRC ----------------------------
+C     ------------------------- LUNSETSTATS_MRC -----------------------
 
       SUBROUTINE LUNSETSTATS_MRC(LUN,IMAMIT,FMINT,FMAXT,AVT,SIGT,IRTFLG)
 
 #include "LUNHDR.INC"
 
       INTEGER  :: LUN,IMAMIT,IRTFLG
-      REAL     :: FMINT,FMAXT,AVT,SIGT
+      REAL     :: FMINT,FMAXT,AVT,SIGT,f21
 
       INTEGER  :: MZ,NSTACK,IMGNUM,IVERSION,IMGSTATS
       INTEGER  :: I4V
 
+C     IMGSTATS IS THE CURRENT STACKED OR MAIN IMAGE NUMBER IN STATS
+
 C     POINT TO MRC HEADER OBJECT
       CALL LUNGETOBJ_MRC(LUN,MRC_HEADER,IRTFLG)
       IF (IRTFLG .NE. 0) RETURN
@@ -1110,24 +1259,22 @@ C        NEED IMGNUM FOR IMGSTATS
 
       ENDIF
 
-      !write(3,*)' In lunsetstats_mrc, imgnum,stats:',imgnum,imgstats
-
-
 C     SET NUMBER OF IMAGE IN STATS
       CALL LUNSET_STATSIMG_MRC(LUN,IMGSTATS,IRTFLG)
       IF (IRTFLG .NE. 0) RETURN
        
+
       IRTFLG = 0
       END
 
-C     ------------------------- LUNGETSTATS_MRC ----------------------------
+C     ------------------------- LUNGETSTATS_MRC -----------------------
 
       SUBROUTINE LUNGETSTATS_MRC(LUN,IMAMIT,FMINT,FMAXT,AVT,SIGT,IRTFLG)
 
 #include "LUNHDR.INC"
 
       INTEGER  :: LUN,IMAMIT,IRTFLG
-      REAL     :: FMINT,FMAXT,AVT,SIGT
+      REAL     :: FMINT,FMAXT,AVT,SIGT,f21
 
       INTEGER  :: IMGSTATS,IMGNUM,NSTACK
 
@@ -1144,7 +1291,7 @@ C     GET MRC_HEADER VALUES
 C     MRC FILE ENCODES IMAMI IN RELATIVE VALUES FOR MIN/MAX      
       IMAMIT = 1
       IF (FMAXT < FMINT) IMAMIT = 0
-      IF (AVT   < FMINT) IMAMIT = 0
+      IF (AVT   < FMINT)  IMAMIT = 0
       IF (SIGT  < 0.0)   IMAMIT = 0
 
 C     IF ALL ZERO STATISTICS ARE PROBABLY NOT SET!! 
@@ -1157,6 +1304,20 @@ C     ARE STATS FOR THE CURRENT MRC IMAGE?
 C        THIS IS A MRC STACKED IMAGE BUT IMG NOT = IMG IN STATISTICS
          IMAMIT = 0
          !FMAXT  = FMINT - 1
+
+#if defined(SP_DBUG)
+!      f21 = TRANSFER(mrc_header(21),f21)
+
+!      write(3,'(A,I5,2X,F8.1,2X,F8.2)')
+!     &     '  In lunGetstats_mrc; lun,fmaxt,mrc_header(21):',
+!     &        lun,fmaxt,f21
+
+!      write(3,'(A,I5,2X,3(2x,I8))')
+!     &     '  In lunGetstats_mrc; nstack,imgnum,imgstats,imamit:',
+!     &                            nstack,imgnum,imgstats,imamit
+C      write(3,*)'  '
+#endif
+
          CALL LUNSETSTATS_MRC(LUN,IMAMIT,FMINT,FMAXT,AVT,SIGT,IRTFLG)
 
       ELSEIF (NSTACK > 1 .AND. IMGNUM < 0 ) THEN
@@ -1165,9 +1326,24 @@ C        THIS IS A MRC STACK BUT NO IMAGE SPECIFIED
          FMAXT  = FMINT - 1
       ENDIF
 
-      !write(3,*)' In lungetstats_mrc stats:',fmint,fmaxt,avt,sigt
-      !write(3,*)' In lungetstats_mrc fmin,fmax,imami:',fmint,fmaxt,imamit
-      !write(3,*)' In lungetstats_mrc imgstats,imgnum: ',imgstats,imgnum
+#if defined(SP_DBUG)
+
+!      f21 = TRANSFER(mrc_header(21),f21)
+!      write(3,'(A,I5,2X,F8.1,2X,F8.2)')
+!     &     '  In lunGetstats_mrc; lun,fmaxt,mrc_header(21):',
+!     &        lun,fmaxt,f21
+
+!      write(3,'(A,3I7)')
+!     &     '  In lunGetstats_mrc;  mrc_header 17,18,19: ',
+!     &         mrc_header(17),mrc_header(18),mrc_header(19)
+
+!      write(3,'(A,I5,2X,3(2x,I8))')
+!     &     '  In lunGetstats_mrc; nstack,imgnum,imgstats,imamit:',
+!     &                            nstack,imgnum,imgstats,imamit
+
+!      write(3,*)' Leaving lunGetstats_mrc ------'
+!      write(3,*)'  '
+#endif
 
       IRTFLG = 0
       END
@@ -1210,6 +1386,26 @@ C     PUT UNKNOWN STAT'S IMAGE NUMBER IN FILE HEADER
       CALL LUNSET_STATSIMG_MRC(LUN,0,IRTFLG)
       IF (IRTFLG .NE. 0) RETURN
 
+#if defined(SP_BACK)
+      CALL BACKTRACE 
+#endif
+ 
+#if  defined(SP_DBUG)
+      f21 = TRANSFER(mrc_header(21),f21)
+!      write(3,'(A,I5,2X,F8.1,2X,F8.2)')
+!     &     '  In lunZerostats_mrc; lun,fmax,mrc_header(21):',
+!     &        lun,fmax,f21
+
+!      write(3,'(A,3I7)')
+!     &     '  In lunZerostats_mrc;  mrc_header 17,18,19: ',
+!     &         mrc_header(17),mrc_header(18),mrc_header(19)
+
+!      write(3,*)' Leaving lunZerostats_mrc ------'
+!      write(3,*)'  '
+#endif
+
+
+
       IRTFLG = 0
       END
 
@@ -1283,11 +1479,11 @@ C     POINT TO HEADER OBJECT
       CELLAY = PIXSIZ * NY
       CELLAZ = PIXSIZ * NZ
 
-c      write(3,*) ' In lunsetpixsiz_mrc, nx...: ',nx,ny,nz
-c      write(3,*) ' In lunsetpixsiz_mrc, sizex...: ',
-c     &                                   sizex,sizey,sizez
-c      write(3,*) ' In lunsetpixsiz_mrc, cellax...: ',
-c     &                                   cellax,cellay,cellaz
+!      write(3,*) ' In lunsetpixsiz_mrc, nx...: ',nx,ny,nz
+!      write(3,*) ' In lunsetpixsiz_mrc, sizex...: ',
+!     &                                  sizex,sizey,sizez
+!      write(3,*) ' In lunsetpixsiz_mrc, cellax...: ',
+!     &                                  cellax,cellay,cellaz
 
 
 C     SET HEADER VALUES FOR PIXEL SIZE * NO. PIXELS IN CELL
@@ -1323,14 +1519,14 @@ C     POINT TO HEADER OBJECT
       CELLAY = SIZEY * NY
       CELLAZ = SIZEZ * NZ
 
-c      write(3,*) ' In lunsetpixsiz_mrc, nx...: ',nx,ny,nz
-c      write(3,*) ' In lunsetpixsiz_mrc, sizex...: ',
-c     &                                   sizex,sizey,sizez
-c      write(3,*) ' In lunsetpixsiz_mrc, cellax...: ',
-c     &                                   cellax,cellay,cellaz
+!      write(3,*) ' In lunsetpixsiz_mrc; nx...: ',nx,ny,nz
+!      write(3,*) ' In lunsetpixsiz_mrc; sizex...: ',
+!     &                                  sizex,sizey,sizez
+!      write(3,*) ' In lunsetpixsiz_mrc; cellax...: ',
+!     &                                  cellax,cellay,cellaz
 
 
-C     SET HEADER VALUES FOR PIXEL SIZE * NO. PIXELS IN CELL
+!     SET HEADER VALUES FOR PIXEL SIZE * NO. PIXELS IN CELL
       MRC_HEADER(11) = TRANSFER(CELLAX, IV4)
       MRC_HEADER(12) = TRANSFER(CELLAY, IV4)
       MRC_HEADER(13) = TRANSFER(CELLAZ, IV4)
@@ -1339,8 +1535,7 @@ C     SET HEADER VALUES FOR PIXEL SIZE * NO. PIXELS IN CELL
       END
 
 
-
-C     ------------------------- LUNSETANGS_MRC ----------------------------
+!     ------------------------- LUNSETANGS_MRC ------------------------
 
       SUBROUTINE LUNSETANGS_MRC(LUN,NANG,ANGS,IRTFLG)   !UNUSED??
 
@@ -1370,7 +1565,7 @@ C     SET HEADER VALUES FOR ANGLES
       IRTFLG = 0
       END
 
-C     ------------------------- LUNGETANGS_MRC ----------------------------
+C     ------------------------- LUNGETANGS_MRC ------------------------
 
       SUBROUTINE LUNGETANGS_MRC(LUN,NANG,ANGS,IRTFLG)  !! UNUSED
 
@@ -1400,7 +1595,7 @@ C     RETRIEVE HEADER VALUES FOR ANGLES
       IRTFLG = 0
       END
 
-C     ------------------------- LUNGETSIZE_MRC ----------------------------
+C     ------------------------- LUNGETSIZE_MRC ------------------------
 
       SUBROUTINE LUNGETSIZE_MRC(LUN,NX,NY,NZ,IRTFLG)
 
@@ -1435,12 +1630,12 @@ C     RETRIEVE CURRENT FILENAME (INCLUDES IMGNUM IF STACKED IMAGE)
      &    INDEX(FILNAM(1:NLET),'.MRCS') > 0) THEN 
          NZ = 1    ! RELION MRC IMAGE STACK
       ENDIF
-      !write(3,*) ' In lunsetmrchdr, filnam:',filnam(1:nlet), nz
+      !write(3,*) ' In lunsetmrchdr; filnam: ',filnam(1:nlet), nz
 
       IRTFLG = 0
       END
 
-C     ------------------------- LUNGETVALS_R_MRC ------------------------
+C     ------------------------- LUNGETVALS_R_MRC ----------------------
 
       SUBROUTINE LUNGETVALS_R_MRC(LUN,IGO,NVAL,BUFOUT,IRTFLG)
 
@@ -1505,7 +1700,7 @@ C     GET REAL RETURN VALUES
       IRTFLG = 0
       END
 
-C     ------------------------- LUNSETVALS_R_MRC ------------------------
+C     ------------------------- LUNSETVALS_R_MRC ----------------------
 
       SUBROUTINE LUNSETVALS_R_MRC(LUN,IGO,NVAL,BUFVALS,IRTFLG)
 
@@ -1556,7 +1751,7 @@ C     HACK FOR TRANSLATING MRC IAPLOC INSTEAD OF SPIDER LOCATIONS
 
 C     SET HEADER VALUES WRITTEN AS I*4
       DO I = IGOMRC,IEND
-         !write(6,*) ' bufvals: ',jenis(i),bufvals(i-igomrc+1)
+         !write(3,*) ' Bufvals: ',jenis(i),bufvals(i-igomrc+1)
 
          IF (JENIS(I) == 2) THEN
             MRC_HEADER(I) = TRANSFER(BUFVALS(I-IGOMRC+1),I4V)   
@@ -1575,7 +1770,7 @@ C           CONVERT REAL VALUE TO INTEGER
       IRTFLG = 0
       END
 
-C     ------------------------- LUNGETTYPE_MRC ----------------------------
+C     ------------------------- LUNGETTYPE_MRC ------------------------
 
       SUBROUTINE LUNGETTYPE_MRC(LUN,ITYPE,IRTFLG)
 
@@ -1596,65 +1791,75 @@ C     RETURN FILE TYPE USING SPIDER'S CONVENTION
       IRTFLG = 0
       END
 
-C     ------------------------- LUNGETSTK_MRC----------------------------
+C     ------------------------- LUNGETSTK_MRC -------------------------
 
-       SUBROUTINE LUNGETSTK_MRC(LUN,MZ,NSTACK,IMGNUM,IRTFLG)
+       SUBROUTINE LUNGETSTK_MRC(LUN,MZ,NSTK,ISTK,IRTFLG)
 
 #include "LUNHDR.INC"
 
-      INTEGER   :: LUN,MZ,NSTACK,IMGNUM,IRTFLG
+      INTEGER   :: LUN,MZ,NSTK,IMGNUM,IRTFLG
 
 C     POINT TO MRC HEADER OBJECT
       CALL LUNGETOBJ_MRC(LUN,MRC_HEADER,IRTFLG)
       IF (IRTFLG .NE. 0) RETURN
 
 C     GET RETURN VALUES
-      MZ     = MRC_HEADER(10)    ! CAN BE NSTACK 
-      IMGNUM = MRC_HEADER(259)   ! CURRENT IMAGE IN HEADER
-      NSTACK = MRC_HEADER(260)   ! NUMBER OF IMAGES/VOLUMES IN STACK
+      MZ   = MRC_HEADER(10)    ! CAN BE NSTK 
+      ISTK = MRC_HEADER(259)   ! CURRENT IMG/VOL IN HEADER
+      NSTK = MRC_HEADER(260)   ! NUMBER OF IMAGES/VOLUMES IN STACK
 
       IRTFLG = 0
       END
 
-C     ------------------------- LUNSETSTK_MRC----------------------------
+C     ------------------------- LUNSETSTK_MRC--------------------------
 
-      SUBROUTINE LUNSETSTK_MRC(LUN,IMGNUM,NSTACK,IRTFLG)
+      SUBROUTINE LUNSETSTK_MRC(LUN,ISTK,NSTK,IRTFLG)
 
 #include "LUNHDR.INC"
 
-      INTEGER  :: LUN,IMGNUM,NSTACK,IRTFLG
+      INTEGER  :: LUN,ISTK,NSTK,IRTFLG
 
 C     POINT TO MRC HEADER OBJECT
       CALL LUNGETOBJ_MRC(LUN,MRC_HEADER,IRTFLG)
       IF (IRTFLG .NE. 0) RETURN
 
 C     SET STACK RELATED STATIC HEADER VALUES
-      MRC_HEADER(259) = IMGNUM  ! CURRENT IMAGE IN HEADER
-      MRC_HEADER(260) = NSTACK  ! NUMBER OF IMAGES/VOLUMES IN STACK
+      MRC_HEADER(259) = ISTK  ! CURRENT IMG/VOL IN HEADER
+      MRC_HEADER(260) = NSTK  ! NUMBER OF IMAGES/VOLUMES IN STACK
  
-      ! write(3,*)' In lunsetstk_mrc, nstack: ',nstack
+      ! write(3,*)' In lunsetstk_mrc; istk,nstk: ',istk,nstk
 
       IRTFLG = 0
       END
 
-C     ------------------------- LUNGETNSTACK_MRC----------------------------
+C     ------------------------- LUNGETNSTACK_MRC ----------------------
 
-       SUBROUTINE LUNGETNSTACK_MRC(LUN, NX,NY,NZ,MZ,NSTACK,IRTFLG)
+       SUBROUTINE LUNGETNSTACK_MRC(LUN, NX,NY,NZ, NZ3,NSTK_FLG,IRTFLG)
 
-C      PURPOSE: GET SPIDER'S NSTACK FROM MRC HEADER INFO 
+C      PURPOSE: GET SPIDER'S NSTACK FROM MRC HEADER INFO (NOT FILE)
 C               MRC FILES LACK STANDARD ENCODING FOR STACK SIZE
 C               AND SOME VOLUMES LOOK LIKE STACKS SO THIS IS COMPLEX!!
-
-C      RETURNS:   NZ   MZ    NSTACK 
+C
+C      RETURNS:   NX,NY,NZ, NZ3,NSTK_FLG 
+C
+C      VARIABLES FOR MRC 2014
+C                 ISPG (23)   NZ (3)     MZ (10)
+C       IMAGE           0      1          1
+C       IMAGE STACK     0     NSTK       NSTK
+C       VOLUME (Z)      1     NZ         NZ
+C       VOLUME STACK  401     NZ*NSTK    NZ/NSTK
+       
+C      IMPLICIT NONE
 
 #include "LUNHDR.INC"
       INCLUDE 'CMLIMIT.INC'
 
-      INTEGER                :: LUN,NX,NY,NZ,MZ,NSTACK,IRTFLG
+      INTEGER                :: LUN,NX,NY,NZ, MZ,NSTK_FLG,IRTFLG
 
       CHARACTER (LEN=MAXNAM) :: FILNAM     
       CHARACTER (LEN=1)      :: DSP
-      INTEGER                :: NZMRC,NLET,IVERSION,ISPG
+      CHARACTER (LEN=4)      :: cloc27
+      INTEGER                :: NZ3,NLET,IVERSION,ISPG
 
       INTEGER                :: lnblnkn   ! FUNCTION
 
@@ -1665,69 +1870,154 @@ C     POINT TO MRC HEADER OBJECT
 C     GET HEADER VALUES
       NX       = MRC_HEADER(1) 
       NY       = MRC_HEADER(2) 
-      NZMRC    = MRC_HEADER(3)   ! NO. OF IMAGES IN RELION mrcs FILES!
-      MZ       = MRC_HEADER(10)  ! CAN BE EITHER NSTACK OR NZ 
+      NZ3      = MRC_HEADER(3)   ! NO. OF IMAGES IN RELION mrcs FILES!
+
+      MZ       = MRC_HEADER(10)  ! CAN BE EITHER NSTK OR NZ 
+      cloc27   = TRANSFER(MRC_HEADER(27),cloc27)   
       IVERSION = MRC_HEADER(28)
       ISPG     = MRC_HEADER(23)
-      !write(3,*)' In lungetnstack, :', iversion,ispg
-      !write(3,*)' In lungetnstack, :', nzmrc,mz,nz,nstack
+
+#if defined(SP_DBUGIO)
+C23456
+      write(3,*)  '  '
+      write(3,*)' In lungetnstack; iversion,ispg: ', iversion,ispg
+      write(3,*)' In lungetnstack; nz3,mz:        ', nz3,mz
+#endif
 
 C     GET CURRENT FILE NAME FROM LUNFILNAM COMMON
       CALL LUNGETFILE_MRC(LUN,FILNAM,NLET,DSP,IRTFLG)
       IF (IRTFLG .NE. 0) RETURN
-      !write(3,*)' In lungetnstack, nlet,filnam:', nlet,filnam(1:nlet)
 
-      IF (INDEX(FILNAM(1:NLET),'.mrcs') > 0 .OR.
-     &    INDEX(FILNAM(1:NLET),'.MRCS') > 0) THEN
-C        HACK FOR RELION mrcs IMAGE STACKS HAVING NZ > 1
-C        IN RELION  THIS WAS A STACK OF IMAGES NOT A VOLUME
-         NZ     = 1        ! DO NOT WANT TO OVERWRITE THIS??
-         NSTACK = NZMRC    ! WAS NZ IN FILE
+#if defined(SP_DBUGIO)
+C23456
+      write(3,*)' In lungetnstack; dsp,nlet:        ', dsp,nlet
+      write(3,*)' In lungetnstack; filnam:          ', filnam(1:nlet)
+#endif
 
-      ELSEIF (INDEX(FILNAM(1:NLET),'.map') > 0 .OR.
-     &        INDEX(FILNAM(1:NLET),'.MAP') > 0) THEN
-C        HACK FOR EMD VOLUME 
-         NZ     = NZMRC    ! DO NOT WANT TO OVERWRITE THIS??
-         NSTACK = -2       ! WAS NZ IN FILE
-         !write(3,*)' In lungetnstack 1, :', nz,nstack
 
-      ELSEIF (INDEX(FILNAM(1:NLET),'@@') > 0 .AND. 
-     &        NZMRC == 1 .AND. MZ == 1) THEN
-C        HACK FOR IMAGE STACKS CONTAINING ONLY ONE IMAGE
-         NZ     = 1        ! 
-         NSTACK = 1        !  
-         !write(3,*)' In lungetnstack 2, :', nz,nstack
+      IF (IVERSION >= 20140 .AND. ISPG == 0) THEN
+C        IMAGE OR IMAGES STACK
 
-      ELSEIF (ISPG == 0 .AND. MZ > 1 .AND. IVERSION == 20140) THEN
-C        STACK OF IMAGES IN NEW MRC FORMAT VERSION
-         NZ     = 1
-         NSTACK = MZ
-         !write(3,*)' In lungetnstack 3, :', nz,nstack
+         IF (NZ3 == 1 .AND. MZ == 1) THEN ! --------------------
+C           SINGLE IMAGE FILE - MRC VERSION 20140
+            NZ       = 1
+            NSTK_FLG = -2
 
-      ELSEIF (ISPG >= 410) THEN
-C        STACK OF VOLUMES IN NEW MRC FORMAT VERSION
-         NZ     = NZMRC
-         NSTACK = MZ
-         !write(3,*)' In lungetnstack 4, :', nz,nstack
+#if defined(SP_DBUGIO)
+            write(3,*)' In lungetnstack 11; nz,nstk_flg:', nz,nstk_flg
+#endif
 
-      ELSEIF (MZ > 1 .AND. NZMRC == MZ) THEN
-C        VOLUME 
-         NZ     = NZMRC
-         NSTACK = -2
-         !write(3,*)' In lungetnstack 5, :', nz,nstack
+         ELSEIF (NZ3 == 1 .AND. MZ > 1) THEN  ! ------------
+C           IMAGE STACK FILE IN - MRC VERSION 20140
+            NZ       = 1
+            NSTK_FLG = MZ
 
-      ELSE
+#if defined(SP_DBUGIO)
+            write(3,*)' In lungetnstack 22; nz,nstk_flg:', nz,nstk_flg
+#endif
+         ENDIF
+
+
+      ELSEIF (IVERSION >= 20140 .AND. ISPG == 1) THEN  ! ------------
+C        SINGLE VOLUME FILE - MRC VERSION 20140
+         NZ       = NZ3  ! nz3=348 mz=348  ispg=1 ll 
+         NSTK_FLG = -2
+
+#if defined(SP_DBUGIO)
+         write(3,*)' In lungetnstack 33; nz,nstk_flg:', nz,nstk_flg
+#endif
+
+
+      ELSEIF (IVERSION >= 20140 .AND. ISPG >= 401 ) THEN ! ----------
+C        STACK OF VOLUMES IN FILE - MRC VERSION 20140
+
+         NZ       = MZ
+         NSTK_FLG = NZ3 / MZ
+
+#if defined(SP_DBUGIO)
+         write(3,*)' In lungetnstack 44; nz,nstk_flg:', nz,nstk_flg
+#endif
+
+
+
+      ELSEIF (INDEX(FILNAM(1:NLET),'.mrcs') > 0 .OR.
+     &        INDEX(FILNAM(1:NLET),'.MRCS') > 0) THEN ! ----------
+
+C        MAY NEED HACK FOR RELION mrcs IMAGE STACKS HAVING NZ > 1
+C        IN RELION  THIS WAS A STACK OF IMAGES NOT A VOLUME
+C          NZ       = 1        
+C          MZ       = 1
+C          NSTK_FLG = NZ3      ! WAS NZ IN FILE
+
+         NZ       = 1
+         NSTK_FLG = NZ3
+
+#if defined(SP_DBUGIO)
+         write(3,*)' In lungetnstack 55; nz,nstk_flg:', nz,nstk_flg
+#endif 
+ 
+
+      ELSEIF (INDEX(FILNAM(1:NLET),'.map') > 0 .OR.
+     &        INDEX(FILNAM(1:NLET),'.MAP') > 0) THEN  ! ----------
+C        HACK FOR EMD VOLUME 
+
+         NZ       = NZ3      ! 
+         NSTK_FLG = -2       ! ???????
+
+#if defined(SP_DBUGIO)
+         write(3,*)' In lungetnstack 66; nz,nstk_flg:', nz,nstk_flg
+#endif
+
+      ELSEIF (INDEX(FILNAM(1:NLET),'@@') >0 .AND. 
+     &        NZ3 == 1 .AND. MZ == 1) THEN            ! ----------
+C        HACK FOR IMAGE STACKS CONTAINING ONLY ONE IMAGE
+         NZ       = 1        ! 
+         NSTK_FLG = 1        ! 
+ 
+#if defined(SP_DBUGIO)
+         write(3,*)' In lungetnstack 77; nz,nstk_flg:', nz,nstk_flg
+#endif
+
+      ELSEIF (MZ > 1 .AND. NZ3 == MZ) THEN            ! ----------
+C        SINGLE VOLUME                            
+         NZ       = NZ3
+         NSTK_FLG = -2     ! NOT STACK, RETURN NEGATIVE (-2)
+
+#if defined(SP_DBUGIO)
+         write(3,*)' In lungetnstack 88; nz,nstk_flg:', nz,nstk_flg
+#endif
+
+      ELSE                                            ! ----------
 C        VOLUME/IMAGE.  NOT A STACK
-         NZ     = NZMRC
-         NSTACK = -2     ! NOT STACK, RETURN NEGATIVE (-2)
-         !write(3,*)' In lungetnstack 6, :', nz,nstack
+         NZ       = NZ3
+         NSTK_FLG = -2     ! NOT STACK, RETURN NEGATIVE (-2)
+
+#if defined(SP_DBUGIO)
+         write(3,*)' In lungetnstack 99; nz,nstk_flg:', nz,nstk_flg
+#endif
       ENDIF
 
-      !write(3,*)' In lungetnstack, ispg,nz,nstack:',ispg,nz,nstack
+
+#if defined(SP_DBUGIO)
+C23456  
+      write(3,*)' In lungetnstack 99999; dsp,nlet: ', dsp,nlet
+      write(3,*)' In lungetnstack 99999; filnam:   ', filnam(1:nlet)
+      write(3,*)' In lungetnstack 99999; iversion,ispg:', iversion,ispg
+      write(3,*)' In lungetnstack 99999; loc27:        ', loc27
+
+      write(3,*)' In lungetnstack 99999, nz,mz:    ', nz,mz
+      write(3,*)' In lungetnstack 99999, nstk_flg; ', nstk_flg
+      write(3,*)  '    '
+#endif
+
       IRTFLG = 0
       END
 
-C     ------------------------- LUNSETNSTACK_MRC----------------------------
+
+
+
+
+C     -------------------- LUNSETNSTACK_MRC --------------------------
 
        SUBROUTINE LUNSETNSTACK_MRC(LUN, NZ,NSTACK,IRTFLG)
 
@@ -1764,7 +2054,7 @@ C        A RELION COMPATIBLE IMAGE STACK
          NZMRC  = NSTACK         
          MZ     = 1
 
-      ELSEIF (NSTACK >= 1 .AND. NZ == 1 .AND.
+      ELSEIF (NSTACK >= 1 .AND. NZ == NSTACK .AND.
      &        IVERSION == 20140 .AND. ISPG == 0) THEN
 C        A 2014 STANDARD STACK OF IMAGES
          NZMRC  = NZ                     
@@ -1911,51 +2201,87 @@ C     SET RESERVED REGISTER VALUES AS NEEDED (SELDOM USED NOW??)
       IRTFLG = 0
       END
 
-C     ------------------------- LUNGETLABELS_MRC ----------------------------
+C     ------------------------- LUNGETLABELS_MRC -----------------------
 
       SUBROUTINE LUNGETLABELS_MRC(LUN,NLABL,LABELS,IRTFLG)
 
 #include "LUNHDR.INC"
 
       INTEGER            :: LUN,NLABL,IRTFLG 
-      CHARACTER(LEN=800) :: LABELS
+C     CHARACTER(LEN=800) :: LABELS    ; GFORT COMPILER ERROR SEPT 2025
+      CHARACTER(LEN=*)   :: LABELS
 
       INTEGER            :: INOW,I,IGO,IEND,IFLIP
+      INTEGER            :: IGOL,IENDL,IGOH,IENDH,IL
+
       CHARACTER(LEN=4)   :: CSTR
 
 C     POINT TO MRC HEADER OBJECT
       CALL LUNGETOBJ_MRC(LUN,MRC_HEADER,IRTFLG)
       IF (IRTFLG .NE. 0) RETURN
 
-      IF (NLABL > 0) THEN
-C        GET LABELS
+      IRTFLG = 1    ! Default error return Sept 2025
 
-         INOW = 1
-         DO I = 57,56 + NLABL * 20      ! 57...57+2*20
-            LABELS(INOW:INOW+3) = TRANSFER(MRC_HEADER(I),CSTR(1:4))
-            INOW = INOW + 4
-         ENDDO
+      !write(3,*)' In lungetlabels_mrc, nlabl:',nlabl
 
-         CALL LUNGETFLIP(LUN,IFLIP,IRTFLG)
-         IF (IFLIP == 1 ) THEN
-            IEND = NLABL * 80
-            CALL REVERSEBYTES(LABELS,IEND,IRTFLG)
-         ENDIF
+      IF (NLABL < 0 .OR. NLABL > 80) THEN
+          write(3,*) ' In lungetlabels_mrc, Bad nlabl: ',nlabl
+          RETURN  ! Stop if we would overflow
+      ENDIF
 
-C        STRIP LEADING BLANKS FROM LABELS (UNTIDY HACK)
-         DO ILAB=1,NLABL
-            IGO  = (ILAB - 1) * 80 + 1
-            IEND = IGO + 80 - 1
-            DO I = IGO,IEND
-               IF (LABELS(I:I) .NE. ' ') THEN
-                   LABELS(IGO:IEND) = LABELS(I:IEND)
-                  EXIT
-               ENDIF
-            ENDDO
-         ENDDO
+C     GET THE EXISTING NLABL LABELS
+
+      IGOL  = 1
+      IENDL = NLABL * 20
+
+      IGOH  = 57
+      IENDH = 56 + NLABL * 20
+
+      IL    = -3
+
+      !write(3,*)' In lungetlabels_mrc, len(labels):',len(labels)
+      !write(3,*)' In lungetlabels_mrc, nlabl,igoh,iendh,il: ',
+      !&                                 nlabl,igoh,iendh,il 
+ 
+      DO IH = IGOH,IENDH      ! 57...57+2*20
+
+        IL = IL + 4
+
+        !write(3,*)' In lungetlabels_mrc, ih,il:',ih,il
  
+        LABELS(IL:IL+3) = TRANSFER(MRC_HEADER(IH),CSTR(1:4))
+
+        !write(3,*)' In lungetlabels_mrc, ih,il,labels: ',
+        !&                                ih,il,labels(il:il+3) 
+      ENDDO
+      IGOL  = 1
+
+      !write(3,*)' In lungetlabels_mrc, labels(1:80): ',
+      !&                                labels(1:80) 
+
+      CALL LUNGETFLIP(LUN,IFLIP,IRTFLG)
+
+      IF (IFLIP == 1 ) THEN
+c        write(3,*) ' In lungetlabels, iflip: ',iflip
+
+         IEND = NLABL * 80
+         CALL REVERSEBYTES(LABELS,IEND,IRTFLG)
       ENDIF
 
+C     STRIP LEADING BLANKS FROM LABELS (UNTIDY HACK)
+      DO ILAB = 1,NLABL
+         IGO  = (ILAB - 1) * 80 + 1
+         IEND = IGO + 80 - 1
+         IF (IEND > LEN(LABELS)) RETURN   ! Stop if overflow
+
+         DO I = IGO,IEND
+            IF (LABELS(I:I) .NE. ' ') THEN
+                LABELS(IGO:IEND) = LABELS(I:IEND)
+                EXIT
+            ENDIF
+         ENDDO
+      ENDDO
+
       IRTFLG = 0
       END
 
@@ -1966,7 +2292,8 @@ C     ------------------------- LUNSAYINFO_MRC ------------------------
       INCLUDE 'CMLIMIT.INC'
       INCLUDE 'CMBLOCK.INC'
 
-      INTEGER              :: LUN,SAYIT,IRTFLG
+      INTEGER              :: LUN,IRTFLG
+      LOGICAL              :: SAYIT
 
       INTEGER              :: ITYPE,NSTACK,NX,NY,NZ,IMGNUM
       INTEGER              :: LENLABEL1,HEDBYT
@@ -1992,7 +2319,11 @@ C     SET ICOMM AND MYPID
 
 C     RETRIEVE SPIDER'S ITYPE  
       CALL LUNGETTYPE_MRC(LUN,ITYPE,IRTFLG)
-      !write(6,*) 'In lunsayinfo_mrc,  type:',itype
+
+#if defined(SP_DBUGIO)
+C23456      
+      !write(3,*) 'In lunsayinfo_mrc   0 | type:',itype
+#endif
 
 C     RETRIEVE MRC MODE 
       CALL LUNGETMODE_MRC(LUN,MRCMODE,IRTFLG)
@@ -2011,18 +2342,31 @@ C     RETRIEVE MRC MODE
 
 C     RETRIEVE CURRENT HEADER NSTACK & IMGNUM
       CALL LUNGETSTK_MRC(LUN,MZ,NSTACK,IMGNUM,IRTFLG)
-      !write(3,*)' In lunsayinfo,  mz,nstack,imgnum 1:',mz,nstack,imgnum
+
+#if defined(SP_DBUGIO)
+C23456      
+      write(3,*)' In lunsayinfo_mrc  1 | mz,nstack,imgnum: ',
+     &                                   mz,nstack,imgnum
+#endif
 
 C     RETRIEVE SIZE
       CALL LUNGETNSTACK_MRC(LUN, NX,NY,NZ,MZ,NSTACK,IRTFLG)
-      !write(3,*)' In lunsayinfo,  mz,nstack,imgnum 2:',mz,nstack,imgnum
+
+#if defined(SP_DBUGIO)
+C23456      
+      write(3,*)' In lunsayinfo_mrc   2 | nz,mz,nstack:     ',
+     &                                    nz,mz,nstack 
+#endif
 
       IF     (ITYPE == 1 .AND. NSTACK > 0) THEN
           TYPEF = 'MRC-' // MODE_STR // ' S2'
+
       ELSEIF (ITYPE == 3 .AND. NSTACK > 0) THEN
           TYPEF = 'MRC-' // MODE_STR // ' S3'
+
       ELSEIF (ITYPE == 1) THEN
           TYPEF = 'MRC-' // MODE_STR // ' 2'
+
       ELSEIF (ITYPE == 3) THEN
           TYPEF = 'MRC-' // MODE_STR // ' 3'
       ENDIF
@@ -2034,7 +2378,14 @@ C     GET DATA ORIGIN & HANDEDNES
 
 C     RETRIEVE CURRENT FILENAME (INCLUDES IMGNUM IF STACKED IMAGE)
       CALL LUNGETFILE_MRC(LUN,FILNAM,NLET,DSP,IRTFLG)
-      !write(3,*) ' In lungetfile, nlet,filnam:', nlet,filnam(1:nlet)
+
+#if defined(SP_DBUGIO)
+C23456
+      write(3,*)' In lunsayinfo_mrc   3 | nlet,filnam: ',
+     &                                    nlet,filnam(1:nlet)
+
+      write(3,*) ' '
+#endif
       
 C     GET HEADER EXTRA LENGTH = NSYMBT 
       CALL LUNGETVIN_MRC(LUN,IVERSION,ISPG,NSYMBT,NLABL,IRTFLG)
@@ -2081,7 +2432,17 @@ C           SIMPLE IMAGE
       ENDIF     ! END OF USE_SPIRE
 
 
-      !write(3,*) ' In lunsayinfo - imgnum,nstack,mz:',imgnum,nstack,mz
+#if defined(SP_DBUGIO)
+      write(3,*) ' '
+      write(3,*)' In lunsayinfo_mrc   4 | imgnum,nstack,mz: ',
+     &                                    imgnum,nstack,mz
+      write(3,*)' In lunsayinfo_mrc   4 | filnam: ',filnam(:nlet)
+      write(3,*) ' '
+#endif
+
+
+
+
       IF (VERBOSE .AND. IFOUND .NE. -4) THEN
 C         PRINT FILE OPENING INFORMATION
 
@@ -2096,7 +2457,8 @@ C           HAS FILENAME BUT NO LABEL1
          ELSEIF (LENT > 0 .AND. LENT < 70) THEN
 C           HAS FILENAME AND LABEL1 THAT FIT ON ONE LINE
             IF (MYPID <= 0) THEN
-             WRITE(NOUT,*) ' ',FILNAM(:NLET),'     /',LABEL1(:LENLABEL1)
+               WRITE(NOUT,*) ' ',FILNAM(:NLET),'     /',
+     &                       LABEL1(1:LENLABEL1)
             ENDIF
 
          ELSEIF (LENT > 0) THEN
@@ -2108,7 +2470,14 @@ C           HAS FILENAME AND LABEL1 THAT DO NOT FIT ON SINGLE LINE
             ENDIF
          ENDIF
 
-      !write(3,*)' In lunsayinfo - imgnum,nstack,mz:',imgnum,nstack,mz
+
+#if defined(SP_DBUGIO)
+         write(3,*)' In lunsayinfo_mrc   5 | imgnum,nstack,mz:',
+     &                                       imgnum,nstack,mz
+         write(3,*) '  '
+#endif
+
+
 
          IF (NSTACK >= 0 .AND. IMGNUM == 0 .AND. NZ > 1) THEN
 C           OVERALL STACKED VOLUME FILE
@@ -2137,8 +2506,37 @@ C           STACKED VOLUME
      &                ' HEADER BYTES: ',I0,'  AXIS:(',A,')')
             ENDIF
 
+         ELSE IF (IMGNUM == 1 .AND. NSTACK < 0 ) THEN
+C           SIMPLE IMAGE
+
+#if defined(SP_DBUGIO)
+            write(3,*)' In lunsayinfo_mrc   6 | nz,mz:',
+     &                                          nz,mz
+            write(3,*)' In lunsayinfo_mrc   6 | imgnum,nstack:',
+     &                                          imgnum,nstack
+            write(3,*) ' '
+#endif
+
+            IF (MYPID <= 0) THEN
+               WRITE(NOUT,921)TYPEF(:LT),NX,NY,  DTP,
+     &                        HEDBYT,CAXIS(:2)
+921            FORMAT('  (',A,') ',2(I0,1X), 2X,A,
+     &                ' HEADER BYTES: ',I0,'  AXIS:(',A,')')
+            ENDIF
+
+
+
          ELSE IF (IMGNUM > 0) THEN
 C           STACKED IMAGE
+
+#if defined(SP_DBUGIO)
+            write(3,*)' In lunsayinfo_mrc  7 | nz,mz:',
+     &                                         nz,mz
+            write(3,*)' In lunsayinfo_mrc  7 | imgnum,nstack:',
+     &                                         imgnum,nstack
+            write(3,*) ' '
+#endif
+
             IF (MYPID <= 0) THEN
                WRITE(NOUT,920)TYPEF(:LT),NX,NY, IMGNUM, DTP,
      &                        HEDBYT,CAXIS(:2)
@@ -2146,6 +2544,7 @@ C           STACKED IMAGE
      &                ' HEADER BYTES: ',I0,'  AXIS:(',A,')')
             ENDIF
 
+
          ELSE IF (NZ > 1) THEN
 C           SIMPLE VOLUME
             IF (MYPID <= 0) THEN
@@ -2169,6 +2568,908 @@ C           SIMPLE IMAGE
 @
 
 
+1.20
+log
+@changed debug output, added comments
+@
+text
+@d10 1
+d78 2
+a79 1
+C
+d190 3
+d220 7
+a226 1
+      !write(3,*)' In lunredhed_mrc, mrc_header:',mrc_header(1:9)
+d241 1
+a241 1
+C     WRITES HEADER OBJECT INTO FILE'S MRC IMAGE HEADER
+d247 1
+a247 1
+      INTEGER *8 :: IPOSMRC 
+d251 2
+a252 1
+      INTEGER      :: MYPID = -1
+a256 1
+
+a259 1
+      IPOSMRC = 1
+d264 8
+a271 1
+      !write(3,*)' In lunwrthed_mrc; header(25): ',mrc_header(25),lun 
+a273 1
+
+d282 1
+d286 1
+d368 29
+d596 2
+a597 1
+C     SET AXIS ORIGIN LOCATION & VOLUME HANDEDNESS BEFORE LUNSETPOS_MRC
+d602 5
+d611 1
+d613 2
+a614 1
+       
+d621 3
+a623 1
+C           CAXIS DOES NOT CONTAIN: 'UL L', 'UL R', 'LL L' or 'LL R' (ALWAYS HAS L)
+d627 4
+a630 2
+         ENDIF       
+      ENDIF
+d654 3
+a656 1
+      !write(3,*)' In lunsethand_mrc; caxis: ',mrc_header(26),caxis
+a764 2
+      !write(3,*)' In lunsetstk_mrc; iversion: ',mrc_header(23),nstack
+
+d800 1
+a800 1
+      INTEGER         :: LUN,MRCMODE,IRTFLG
+d814 1
+a814 1
+C     ------------------------- LUNGETMODSIZ_MRC ----------------------
+d816 2
+a817 2
+      SUBROUTINE LUNGETMODSIZ_MRC(LUN,MRCMODE,NX,NY,NZMRC,
+     &                            MX,MY,MZ,IRTFLG)
+d821 1
+a821 1
+      INTEGER  :: LUN,MRCMODE,NX,NY,NZMRC,MX,MY,MZ,IRTFLG
+a826 1
+      MRCMODE = MRC_HEADER(4)
+d829 1
+a829 1
+      NZMRC   = MRC_HEADER(3)  ! NO. OF IMAGES IN RELION mrcs FILES!
+d834 1
+a834 1
+      !write(3,*) ' In lungetmodsiz_mrc: ',mrcmode,nx,ny,nz,mx,my,mz
+d858 1
+a858 1
+C     ------------------------- LUNGETVIN_MRC ----------------------------
+d953 1
+a953 1
+      SUBROUTINE LUNSETFILE_MRC(LUN,FILNAM,DSP,IRTFLG)
+d960 1
+d962 2
+a963 1
+      INTEGER                :: NLET
+d965 1
+a965 1
+      IF (FILNAM(1:1) .NE. CHAR(0)) THEN
+d969 8
+d979 1
+a979 1
+      IF (DSP .NE. CHAR(0)) THEN
+d989 14
+d1005 2
+a1142 18
+#if defined (SP_DBUG)
+!      f21 = TRANSFER(mrc_header(21),f21)
+!      write(3,'(A,I5,2X,F8.1,2X,F8.2)')
+C!     &     '  In lunSetstats_mrc; lun,fmaxt,mrc_header(21):',
+!     &        lun,fmaxt,f21
+
+!      write(3,'(A,3I7)')
+!     &     '  In lunSetstats_mrc;  mrc_header 17,18,19: ',
+!     &         mrc_header(17),mrc_header(18),mrc_header(19)
+
+!      write(3,'(A,I5,2X,3(2x,I8))')
+!     &     '  In lunSetstats_mrc; nstack,imgnum,imgstats,imamit:',
+!     &                            nstack,imgnum,imgstats,imamit
+
+!      write(3,*)'  '
+!      write(3,*)' Leaving lunSetstats_mrc ------'
+!      write(3,*)'  '
+#endif
+d1206 1
+a1206 1
+#if  defined(SP_DBUG)
+d1673 1
+a1673 1
+       SUBROUTINE LUNGETSTK_MRC(LUN,MZ,NSTACK,IMGNUM,IRTFLG)
+d1677 1
+a1677 1
+      INTEGER   :: LUN,MZ,NSTACK,IMGNUM,IRTFLG
+d1684 3
+a1686 3
+      MZ     = MRC_HEADER(10)    ! CAN BE NSTACK 
+      IMGNUM = MRC_HEADER(259)   ! CURRENT IMAGE IN HEADER
+      NSTACK = MRC_HEADER(260)   ! NUMBER OF IMAGES/VOLUMES IN STACK
+d1693 1
+a1693 1
+      SUBROUTINE LUNSETSTK_MRC(LUN,IMGNUM,NSTACK,IRTFLG)
+d1697 1
+a1697 1
+      INTEGER  :: LUN,IMGNUM,NSTACK,IRTFLG
+d1704 2
+a1705 2
+      MRC_HEADER(259) = IMGNUM  ! CURRENT IMAGE IN HEADER
+      MRC_HEADER(260) = NSTACK  ! NUMBER OF IMAGES/VOLUMES IN STACK
+d1707 1
+a1707 1
+      ! write(3,*)' In lunsetstk_mrc; nstack: ',nstack
+d1714 1
+a1714 1
+       SUBROUTINE LUNGETNSTACK_MRC(LUN, NX,NY,NZ,MZ,NSTACK,IRTFLG)
+d1716 1
+a1716 1
+C      PURPOSE: GET SPIDER'S NSTACK FROM MRC HEADER INFO 
+d1720 10
+a1729 1
+C      RETURNS:   NZ   MZ    NSTACK 
+d1734 1
+a1734 1
+      INTEGER                :: LUN,NX,NY,NZ,MZ,NSTACK,IRTFLG
+d1738 2
+a1739 1
+      INTEGER                :: NZMRC,NLET,IVERSION,ISPG
+d1750 4
+a1753 2
+      NZMRC    = MRC_HEADER(3)   ! NO. OF IMAGES IN RELION mrcs FILES!
+      MZ       = MRC_HEADER(10)  ! CAN BE EITHER NSTACK OR NZ 
+d1757 6
+a1762 2
+      !write(3,*)' In lungetnstack; iversion,ispg :', iversion,ispg
+      !write(3,*)' In lungetnstack; nzmrc,mz,nz,nstack:', nzmrc,mz,nz,nstack
+a1766 1
+      !write(3,*)' In lungetnstack; nlet,filnam:', nlet,filnam(1:nlet)
+d1768 56
+a1823 3
+      IF (INDEX(FILNAM(1:NLET),'.mrcs') > 0 .OR.
+     &    INDEX(FILNAM(1:NLET),'.MRCS') > 0) THEN
+C        HACK FOR RELION mrcs IMAGE STACKS HAVING NZ > 1
+d1825 11
+a1835 10
+         NZ     = 1        ! DO NOT WANT TO OVERWRITE THIS??
+         NSTACK = NZMRC    ! WAS NZ IN FILE
+
+C      elseif (index(filnam(1:nlet),'.mrc') > 0 .or.
+c     &        index(filnam(1:nlet),'.mrc') > 0) then
+c        cp from mrcv will be required to read volumes as volumes
+c        not sure if this will break things  Tapu Sept 2025
+c        this  broke things  dean sept 2025
+c        nz     = 1        ! do not want to overwrite this??
+c        nstack = nzmrc    ! was nz in file
+d1838 1
+a1838 1
+     &        INDEX(FILNAM(1:NLET),'.MAP') > 0) THEN
+a1839 3
+         NZ     = NZMRC    ! DO NOT WANT TO OVERWRITE THIS??
+         NSTACK = -2       ! WAS NZ IN FILE
+         !write(3,*)' In lungetnstack 1, :', nz,nstack
+d1841 9
+a1849 2
+      ELSEIF (INDEX(FILNAM(1:NLET),'@@') > 0 .AND. 
+     &        NZMRC == 1 .AND. MZ == 1) THEN
+d1851 11
+a1861 21
+         NZ     = 1        ! 
+         NSTACK = 1        !  
+         !write(3,*)' In lungetnstack 2, :', nz,nstack
+
+      ELSEIF (ISPG == 0 .AND. MZ > 1 .AND. IVERSION == 20140) THEN
+C        STACK OF IMAGES IN NEW MRC FORMAT VERSION
+         NZ     = 1
+         NSTACK = MZ
+         !write(3,*)' In lungetnstack 3, :', nz,nstack
+
+      ELSEIF (ISPG >= 410) THEN
+C        STACK OF VOLUMES IN NEW MRC FORMAT VERSION
+         NZ     = NZMRC
+         NSTACK = MZ
+         !write(3,*)' In lungetnstack 4, :', nz,nstack
+
+      ELSEIF (MZ > 1 .AND. NZMRC == MZ) THEN
+C        VOLUME 
+         NZ     = NZMRC
+         NSTACK = -2
+         !write(3,*)' In lungetnstack 5, :', nz,nstack
+d1863 5
+a1867 1
+      ELSE
+d1869 6
+a1874 3
+         NZ     = NZMRC
+         NSTACK = -2     ! NOT STACK, RETURN NEGATIVE (-2)
+         !write(3,*)' In lungetnstack 6, :', nz,nstack
+d1877 13
+a1889 1
+      !write(3,*)' In lungetnstack, ispg,nz,nstack:',ispg,nz,nstack
+d1893 5
+a1897 1
+C     ------------------------- LUNSETNSTACK_MRC-----------------------
+d1934 1
+a1934 1
+      ELSEIF (NSTACK >= 1 .AND. NZ == 1 .AND.
+d2199 5
+a2203 1
+      !write(3,*) 'In lunsayinfo_mrc,  type:',itype
+d2222 6
+a2227 2
+      !write(3,*)' In lunsayinfo_mrc,  mz,nstack,imgnum 1:',
+c    &                                 mz,nstack,imgnum
+d2231 6
+a2236 2
+      !write(3,*)' In lunsayinfo_mrc, mz,nstack,imgnum 2:',
+c    &                                mz,nstack,imgnum
+d2240 1
+d2243 1
+d2246 1
+d2258 8
+a2265 1
+      !write(3,*)' After lungetfile, nlet,filnam:', nlet,filnam(1:nlet)
+d2312 10
+a2321 2
+      !write(3,*)' In lunsayinfo_mrc - imgnum,nstack,mz:',
+      !&                                imgnum,nstack,mz
+d2350 8
+a2357 2
+         !write(3,*)' In lunsayinfo_mrc; imgnum,nstack,mz:',
+         !&                              imgnum,nstack,mz
+d2386 20
+d2408 9
+d2423 1
+@
+
+
+1.19
+log
+@DEBUG OUTPUT ADDED
+@
+text
+@d4 1
+a4 1
+C                 NATIVE MRC FILE SUPPORT         JUL 2019 ArDean Leith
+d9 1
+a9 1
+C                 DEBUG OUTPUT ADDED              oct 2025 ArDean Leith
+d171 1
+a171 1
+      !write(6,*) ' In lunnewhed_mrc: ',lun,LUNMRCHDRBUF(LUN)%ipt 
+d215 1
+a215 1
+      !write(6,*)' In lunredhed_mrc, mrc_header:',mrc_header(1:9)
+d254 1
+a254 1
+      !write(6,*)' In lunwrthed_mrc; header(25): ',mrc_header(25),lun 
+d423 1
+a423 1
+      !write(6,*)' In lunsetpos_mrc; imgnum,lunmrcpos(lun): ',
+d425 1
+a425 1
+      !write(6,*)' In lunsetpos_mrc; ihedlen,nx,ny,nz,nbyt,imgnum: ',
+d427 2
+a428 2
+      !write(6,*)' In lunsetpos_mrc; nbyt_per_rec: ', nbyt_per_rec
+      !write(6,*)' In lunsetpos_mrc; lunmrcpos: ',lunmrcpos(lun)
+d524 1
+a524 1
+        write(6,*) ' In lungetmap_mrc; mrc_header 17,18,19:  ',
+a525 1
+        write(6,*) ' In lungetmap_mrc; map c,r,s: ',mapc,mapr,maps
+d595 1
+a595 1
+      !write(6,*)' In lunsethand_mrc; caxis: ',mrc_header(26),caxis
+d620 1
+a620 1
+      !write(6,*)' In lungethand_mrc; lun,caxis: ',lun,caxis
+d704 1
+a704 1
+      !write(6,*)' In lunsetstk_mrc; iversion: ',mrc_header(23),nstack
+d730 1
+a730 1
+      !write(6,*) ' In lunsetmodsiz_mrc: ',mrcmode,nx,ny,nz,mx,my,mz
+d749 1
+a749 1
+      !write(6,*) ' In lunsetmode_mrc; mrcmode: ',mrcmode
+d776 1
+a776 1
+      !write(6,*) ' In lungetmodsiz_mrc: ',mrcmode,nx,ny,nz,mx,my,mz
+d795 1
+a795 1
+      !write(6,*) ' In lungetmod_mrc; mrcmode: ',mrcmode
+d820 1
+a820 1
+      ! write(6,*) ' In lungetvin_mrc; iversion', iversion
+d845 1
+a845 1
+      !write(6,*) ' In lunsetvin_mrc; iversion', iversion,ispg
+d983 1
+a983 1
+      !write(6,*)' In lunset_statsimg_mrc; imgstats: ',imgstats
+d1060 16
+a1075 16
+      f21 = TRANSFER(mrc_header(21),f21)
+      write(3,'(A,I5,2X,F8.1,2X,F8.2)')
+     &     '  In lunSetstats_mrc; lun,fmaxt,mrc_header(21):',
+     &        lun,fmaxt,f21
+
+      write(3,'(A,3I7)')
+     &     '  In lunSetstats_mrc;  mrc_header 17,18,19: ',
+     &         mrc_header(17),mrc_header(18),mrc_header(19)
+
+      write(3,'(A,I5,2X,3(2x,I8))')
+     &     '  In lunSetstats_mrc; nstack,imgnum,imgstats,imamit:',
+     &                            nstack,imgnum,imgstats,imamit
+
+      write(3,*)'  '
+      write(3,*)' Leaving lunSetstats_mrc ------'
+      write(3,*)'  '
+d1105 1
+a1105 1
+      IF (AVT   < FMINT) IMAMIT = 0
+d1120 1
+a1120 1
+      f21 = TRANSFER(mrc_header(21),f21)
+d1122 8
+a1129 8
+      write(3,'(A,I5,2X,F8.1,2X,F8.2)')
+     &     '  In lunGetstats_mrc; lun,fmaxt,mrc_header(21):',
+     &        lun,fmaxt,f21
+
+      write(3,'(A,I5,2X,3(2x,I8))')
+     &     '  In lunGetstats_mrc; nstack,imgnum,imgstats,imamit:',
+     &                            nstack,imgnum,imgstats,imamit
+      write(3,*)'  '
+d1142 12
+a1153 12
+      f21 = TRANSFER(mrc_header(21),f21)
+      write(3,'(A,I5,2X,F8.1,2X,F8.2)')
+     &     '  In lunGetstats_mrc; lun,fmaxt,mrc_header(21):',
+     &        lun,fmaxt,f21
+
+      write(3,'(A,3I7)')
+     &     '  In lunGetstats_mrc;  mrc_header 17,18,19: ',
+     &         mrc_header(17),mrc_header(18),mrc_header(19)
+
+      write(3,'(A,I5,2X,3(2x,I8))')
+     &     '  In lunGetstats_mrc; nstack,imgnum,imgstats,imamit:',
+     &                            nstack,imgnum,imgstats,imamit
+d1155 2
+a1156 2
+      write(3,*)' Leaving lunGetstats_mrc ------'
+      write(3,*)'  '
+d1206 7
+a1212 7
+      write(3,'(A,I5,2X,F8.1,2X,F8.2)')
+     &     '  In lunZerostats_mrc; lun,fmax,mrc_header(21):',
+     &        lun,fmax,f21
+
+      write(3,'(A,3I7)')
+     &     '  In lunZerostats_mrc;  mrc_header 17,18,19: ',
+     &         mrc_header(17),mrc_header(18),mrc_header(19)
+d1214 2
+a1215 2
+      write(3,*)' Leaving lunZerostats_mrc ------'
+      write(3,*)'  '
+d1293 5
+a1297 5
+c      write(6,*) ' In lunsetpixsiz_mrc, nx...: ',nx,ny,nz
+c      write(6,*) ' In lunsetpixsiz_mrc, sizex...: ',
+c     &                                  sizex,sizey,sizez
+c      write(6,*) ' In lunsetpixsiz_mrc, cellax...: ',
+c     &                                  cellax,cellay,cellaz
+d1333 5
+a1337 5
+c      write(6,*) ' In lunsetpixsiz_mrc; nx...: ',nx,ny,nz
+c      write(6,*) ' In lunsetpixsiz_mrc; sizex...: ',
+c     &                                  sizex,sizey,sizez
+c      write(6,*) ' In lunsetpixsiz_mrc; cellax...: ',
+c     &                                  cellax,cellay,cellaz
+d1340 1
+a1340 1
+C     SET HEADER VALUES FOR PIXEL SIZE * NO. PIXELS IN CELL
+d1349 1
+a1349 1
+C     ------------------------- LUNSETANGS_MRC ------------------------
+d1444 1
+a1444 1
+      !write(6,*) ' In lunsetmrchdr; filnam: ',filnam(1:nlet), nz
+d1565 1
+a1565 1
+         !write(6,*) ' Bufvals: ',jenis(i),bufvals(i-igomrc+1)
+d1641 1
+a1641 1
+      ! write(6,*)' In lunsetstk_mrc; nstack: ',nstack
+d1678 3
+a1680 2
+      !write(6,*)' In lungetnstack; iversion,ispg :', iversion,ispg
+      !write(6,*)' In lungetnstack; nzmrc,mz,nz,nstack:', nzmrc,mz,nz,nstack
+d1685 1
+a1685 1
+      !write(6,*)' In lungetnstack; nlet,filnam:', nlet,filnam(1:nlet)
+d1707 1
+a1707 1
+         !write(6,*)' In lungetnstack 1, :', nz,nstack
+d1714 1
+a1714 1
+         !write(6,*)' In lungetnstack 2, :', nz,nstack
+d1720 1
+a1720 1
+         !write(6,*)' In lungetnstack 3, :', nz,nstack
+d1726 1
+a1726 1
+         !write(6,*)' In lungetnstack 4, :', nz,nstack
+d1732 1
+a1732 1
+         !write(6,*)' In lungetnstack 5, :', nz,nstack
+d1738 1
+a1738 1
+         !write(6,*)' In lungetnstack 6, :', nz,nstack
+d1741 1
+a1741 1
+      !write(6,*)' In lungetnstack, ispg,nz,nstack:',ispg,nz,nstack
+d1772 2
+a1773 2
+      !write(6,*)' In lunsetnstack, nlet,filnam:', nlet,filnam(1:nlet)
+      !write(6,*)' In lunsetnstack, :', iversion,ispg,nz,nstack
+d1950 1
+a1950 1
+      !write(6,*)' In lungetlabels_mrc, nlabl:',nlabl
+d1953 1
+a1953 1
+          write(6,*) ' In lungetlabels_mrc, Bad nlabl: ',nlabl
+d1967 2
+a1968 2
+      !write(6,*)' In lungetlabels_mrc, len(labels):',len(labels)
+      !write(6,*)' In lungetlabels_mrc, nlabl,igoh,iendh,il: ',
+d1975 1
+a1975 1
+        !write(6,*)' In lungetlabels_mrc, ih,il:',ih,il
+d1979 1
+a1979 1
+        !write(6,*)' In lungetlabels_mrc, ih,il,labels: ',
+d1984 1
+a1984 1
+      !write(6,*)' In lungetlabels_mrc, labels(1:80): ',
+d1990 1
+a1990 1
+c        write(6,*) ' In lungetlabels, iflip: ',iflip
+d2047 1
+a2047 1
+      !write(6,*) 'In lunsayinfo_mrc,  type:',itype
+d2066 1
+a2066 1
+      !write(6,*)' In lunsayinfo_mrc,  mz,nstack,imgnum 1:',
+d2071 1
+a2071 1
+      !write(6,*)' In lunsayinfo_mrc, mz,nstack,imgnum 2:',
+d2091 1
+a2091 1
+      !write(6,*)' After lungetfile, nlet,filnam:', nlet,filnam(1:nlet)
+d2138 1
+a2138 1
+      !write(6,*)' In lunsayinfo_mrc - imgnum,nstack,mz:',
+d2168 1
+a2168 1
+         !write(6,*)' In lunsayinfo_mrc; imgnum,nstack,mz:',
+@
+
+
+1.18
+log
+@NBYT, NBYT_PER_VAL CONFUSED in some routines
+@
+text
+@d9 1
+d245 1
+d254 1
+a254 1
+      !write(6,*)' In lunwrthed_mrc; header(25): ',mrc_header(25),lun   
+d522 7
+a528 1
+      ! write(6,*) ' In lungetmap_mrc; map c,r,s: ',mapc,mapr,maps
+d978 2
+d999 1
+d1020 1
+a1020 1
+      REAL     :: FMINT,FMAXT,AVT,SIGT
+d1025 2
+a1055 3
+      !write(6,*)' In lunsetstats_mrc; imgnum,stats: ',imgnum,imgstats
+
+
+d1060 19
+d1089 1
+a1089 1
+      REAL     :: FMINT,FMAXT,AVT,SIGT
+d1119 14
+d1141 18
+a1158 4
+      !write(6,*)' In lungetstats_mrc; stats:',fmint,fmaxt,avt,sigt
+      !write(6,*)' In lungetstats_mrc; fmint,fmaxt,imamit: ',
+      !&                               fmint,fmaxt,imamit
+      !write(6,*)' In lungetstats_mrc; imgstats,imgnum:',imgstats,imgnum
+d1200 20
+@
+
+
+1.17
+log
+@removed debug msg
+@
+text
+@d8 1
+d304 1
+a304 1
+      SUBROUTINE LUNGETPOSINFO_MRC(LUN,NBYT,IHEDLEN,IRTFLG)
+d308 1
+a308 1
+      INTEGER         :: LUN,NBYT,IHEDLEN,IRTFLG
+d328 2
+a329 1
+         NBYT =  1           ! SIGNED    8 BIT INTEGER*1 
+d331 2
+a332 1
+         NBYT =  2           ! SIGNED   16 BIT INTEGER*2
+d334 2
+a335 1
+         NBYT = -2           ! UNSIGNED 16 BIT INTEGER*2
+d337 2
+a338 1
+         NBYT =  4           ! REAL*4  
+d340 1
+a340 1
+         NBYT   = 0          ! NOT A VALID MRC FILE
+d342 1
+d354 5
+a358 1
+      INTEGER         :: LUN,IMGNUM,IRTFLG
+d360 1
+a360 4
+      INTEGER * 8     :: LUNMRCPOS 
+      INTEGER         :: LUNMRCNBYT
+      COMMON /LUNMRC/    LUNMRCPOS(100),LUNMRCNBYT(100)
+      INTEGER         :: LUNARA,LUNSTK,LUNARB,LUNFLIP
+d373 1
+a373 1
+      CALL LUNGETPOSINFO_MRC(LUN,NBYT,IHEDLEN,IRTFLG)
+d380 1
+a380 1
+      LUNMRCNBYT(LUN) = NBYT       ! PRESERVES NEGATIVE FOR SIGN
+d382 1
+a382 1
+      NBYT_PER_VAL    = ABS(NBYT)   
+d394 1
+d437 6
+a442 2
+      INTEGER         :: LUN,NX,NY,NZ,IRTFLG
+      LOGICAL         :: RESET
+d444 1
+a444 4
+      INTEGER * 8     :: LUNMRCPOS 
+      INTEGER         :: LUNMRCNBYT
+      COMMON /LUNMRC/    LUNMRCPOS(100),LUNMRCNBYT(100)
+      INTEGER         :: LUNARA,LUNSTK,LUNARB,LUNFLIP
+d470 1
+a470 1
+
+a734 5
+
+      INTEGER * 8     :: LUNMRCPOS 
+      INTEGER         :: LUNMRCNBYT
+      COMMON /LUNMRC/    LUNMRCPOS(100),LUNMRCNBYT(100)
+
+@
+
+
+1.16
+log
+@LUNGETLABELS_MRC changed,  debug output added, lungetnstack changes reversed
+Handle invalid index (LUN=0, etc.)  Sept 2025
+IS_MRC = (LUNMRCPOS(LUN) .NE. 0)
+other bugs fixed
+@
+text
+@d2087 2
+a2088 2
+         write(6,*)' In lunsayinfo_mrc; imgnum,nstack,mz:',
+     &                                   imgnum,nstack,mz
+@
+
+
+1.15
+log
+@label overflow trap
+@
+text
+@d1 7
+a7 1
+C++*********************************************************************
+a8 3
+C LUNSETMRCHDR.F    DERIVED FROM LUNSETHDR.F    JUN 2019  ArDean Leith
+C                   NATIVE MRC FILE SUPPORT     JUL 2019  ArDean Leith
+C                    
+d15 1
+d110 1
+a110 1
+C      RMS      = TRANSFER(MRC_HEADER(55),FVAL) ! DEVIATION FROM MEAN DENSITY          
+d169 1
+a169 1
+      !write(3,*) ' In lunnewhed_mrc: ',lun,LUNMRCHDRBUF(LUN)%ipt 
+d213 1
+a213 1
+      !write(3,*)' In lunredhed_mrc, mrc_header:',mrc_header(1:9)
+d250 2
+a251 1
+      !write(3,*)' In lunwrthed_mrc, header(25): ',mrc_header(25),lun   
+d413 6
+a418 7
+      !write(3,*) ' In lunsetpos_mrc, imgnum,lunmrcpos(lun): ',
+      !&                               imgnum,lunmrcpos(lun)
+
+      !write(3,*)' In lunsetpos_mrc, ihedlen,nx,ny,nz,nbyt,imgnum:',
+      !&                              ihedlen,nx,ny,nz,nbyt,imgnum
+      !write(3,*)' In lunsetpos_mrc, nbyt_per_rec:', nbyt_per_rec
+      !write(3,*)' In lunsetpos_mrc lunmrcpos:',lunmrcpos(lun)
+d486 7
+a492 1
+      IS_MRC = (LUNMRCPOS(LUN) .NE. 0)
+d511 1
+a511 1
+      ! write(6,*) ' In lungetmap_mrc, map c,r,s: ',mapc,mapr,maps
+d516 1
+a516 1
+C     ------------------------- WHICH_HAND_MRC ----------------------------
+d579 1
+a579 1
+      !write(3,*)' In lunsethand_mrc, caxis: ',mrc_header(26),caxis
+d603 2
+a604 1
+      !write(3,*)' In lungethand_mrc, lun,caxis: ',lun,caxis
+d688 1
+a688 1
+      !write(3,*)' In lunsetstk_mrc, iversion: ',mrc_header(23),nstack
+d693 1
+a693 1
+C     ------------------------- LUNSETMODSIZ_MRC ----------------------------
+d719 1
+a719 1
+C     ------------------------- LUNSETMODE_MRC ----------------------------
+d738 1
+a738 1
+      !write(3,*) ' In lunsetmode_mrc: ',mrcmode
+d784 1
+a784 1
+      !write(6,*) ' In lungetmod_mrc: ',mrcmode
+d809 1
+a809 1
+      ! write(6,*) ' In lungetvin_mrc, iversion', iversion
+d834 1
+a834 1
+      !write(3,*) ' In lunsetvin_mrc, iversion', iversion,ispg
+a858 1
+
+d970 1
+a970 1
+      !write(3,*)' In lunset_statsimg_mrc, imgstats: ',imgstats
+d998 1
+a998 1
+C     ------------------------- LUNSETSTATS_MRC ----------------------------
+d1039 1
+a1039 1
+      !write(3,*)' In lunsetstats_mrc, imgnum,stats:',imgnum,imgstats
+d1049 1
+a1049 1
+C     ------------------------- LUNGETSTATS_MRC ----------------------------
+d1094 4
+a1097 3
+      !write(3,*)' In lungetstats_mrc stats:',fmint,fmaxt,avt,sigt
+      !write(3,*)' In lungetstats_mrc fmin,fmax,imami:',fmint,fmaxt,imamit
+      !write(3,*)' In lungetstats_mrc imgstats,imgnum: ',imgstats,imgnum
+d1213 5
+a1217 5
+c      write(3,*) ' In lunsetpixsiz_mrc, nx...: ',nx,ny,nz
+c      write(3,*) ' In lunsetpixsiz_mrc, sizex...: ',
+c     &                                   sizex,sizey,sizez
+c      write(3,*) ' In lunsetpixsiz_mrc, cellax...: ',
+c     &                                   cellax,cellay,cellaz
+d1253 5
+a1257 5
+c      write(3,*) ' In lunsetpixsiz_mrc, nx...: ',nx,ny,nz
+c      write(3,*) ' In lunsetpixsiz_mrc, sizex...: ',
+c     &                                   sizex,sizey,sizez
+c      write(3,*) ' In lunsetpixsiz_mrc, cellax...: ',
+c     &                                   cellax,cellay,cellaz
+d1269 1
+a1269 2
+
+C     ------------------------- LUNSETANGS_MRC ----------------------------
+d1299 1
+a1299 1
+C     ------------------------- LUNGETANGS_MRC ----------------------------
+d1329 1
+a1329 1
+C     ------------------------- LUNGETSIZE_MRC ----------------------------
+d1364 1
+a1364 1
+      !write(3,*) ' In lunsetmrchdr, filnam:',filnam(1:nlet), nz
+d1369 1
+a1369 1
+C     ------------------------- LUNGETVALS_R_MRC ------------------------
+d1434 1
+a1434 1
+C     ------------------------- LUNSETVALS_R_MRC ------------------------
+d1485 1
+a1485 1
+         !write(6,*) ' bufvals: ',jenis(i),bufvals(i-igomrc+1)
+d1504 1
+a1504 1
+C     ------------------------- LUNGETTYPE_MRC ----------------------------
+d1525 1
+a1525 1
+C     ------------------------- LUNGETSTK_MRC----------------------------
+d1545 1
+a1545 1
+C     ------------------------- LUNSETSTK_MRC----------------------------
+d1561 1
+a1561 1
+      ! write(3,*)' In lunsetstk_mrc, nstack: ',nstack
+d1566 1
+a1566 1
+C     ------------------------- LUNGETNSTACK_MRC----------------------------
+d1573 1
+a1573 1
+
+d1598 2
+a1599 2
+      !write(3,*)' In lungetnstack, :', iversion,ispg
+      !write(3,*)' In lungetnstack, :', nzmrc,mz,nz,nstack
+d1604 1
+a1604 1
+      !write(3,*)' In lungetnstack, nlet,filnam:', nlet,filnam(1:nlet)
+d1613 8
+d1626 1
+a1626 1
+         !write(3,*)' In lungetnstack 1, :', nz,nstack
+d1633 1
+a1633 1
+         !write(3,*)' In lungetnstack 2, :', nz,nstack
+d1639 1
+a1639 1
+         !write(3,*)' In lungetnstack 3, :', nz,nstack
+d1645 1
+a1645 1
+         !write(3,*)' In lungetnstack 4, :', nz,nstack
+d1651 1
+a1651 1
+         !write(3,*)' In lungetnstack 5, :', nz,nstack
+d1657 1
+a1657 1
+         !write(3,*)' In lungetnstack 6, :', nz,nstack
+d1660 1
+a1660 1
+      !write(3,*)' In lungetnstack, ispg,nz,nstack:',ispg,nz,nstack
+d1664 1
+a1664 1
+C     ------------------------- LUNSETNSTACK_MRC----------------------------
+d1691 2
+a1692 2
+      !write(3,*)' In lunsetnstack, nlet,filnam:', nlet,filnam(1:nlet)
+      !write(3,*)' In lunsetnstack, :', iversion,ispg,nz,nstack
+d1848 1
+a1848 1
+C     ------------------------- LUNGETLABELS_MRC ----------------------------
+d1855 2
+a1856 2
+C     CHARACTER(LEN=800) :: LABELS
+      CHARACTER(LEN=*) :: LABELS
+d1859 2
+d1867 1
+a1867 1
+      write(3,*) ' nlabl: ',nlabl
+d1869 1
+a1869 2
+      IF (NLABL > 0) THEN
+C        GET LABELS
+d1871 6
+a1876 2
+         INOW = 1
+         DO I = 57,56 + NLABL * 20      ! 57...57+2*20
+d1878 2
+a1879 1
+      write(3,*) ' nlabl,inow,i: ',nlabl,inow,i,MRC_HEADER(I)
+d1881 2
+d1884 7
+a1890 3
+           LABELS(INOW:INOW+3) = TRANSFER(MRC_HEADER(I),CSTR(1:4))
+            INOW = INOW + 4
+         ENDDO
+d1892 1
+a1892 5
+         CALL LUNGETFLIP(LUN,IFLIP,IRTFLG)
+         IF (IFLIP == 1 ) THEN
+            IEND = NLABL * 80
+            CALL REVERSEBYTES(LABELS,IEND,IRTFLG)
+         ENDIF
+d1894 1
+a1894 11
+C        STRIP LEADING BLANKS FROM LABELS (UNTIDY HACK)
+         DO ILAB=1,NLABL
+            IGO  = (ILAB - 1) * 80 + 1
+            IEND = IGO + 80 - 1
+            DO I = IGO,IEND
+               IF (LABELS(I:I) .NE. ' ') THEN
+                   LABELS(IGO:IEND) = LABELS(I:IEND)
+                  EXIT
+               ENDIF
+            ENDDO
+         ENDDO
+d1896 17
+d1915 14
+d1985 2
+a1986 1
+      !write(3,*)' In lunsayinfo,  mz,nstack,imgnum 1:',mz,nstack,imgnum
+d1990 2
+a1991 1
+      !write(3,*)' In lunsayinfo,  mz,nstack,imgnum 2:',mz,nstack,imgnum
+d2010 1
+a2010 1
+      !write(3,*) ' In lungetfile, nlet,filnam:', nlet,filnam(1:nlet)
+d2057 3
+a2059 1
+      !write(3,*) ' In lunsayinfo - imgnum,nstack,mz:',imgnum,nstack,mz
+d2074 2
+a2075 1
+             WRITE(NOUT,*) ' ',FILNAM(:NLET),'     /',LABEL1(:LENLABEL1)
+d2087 2
+a2088 1
+      !write(3,*)' In lunsayinfo - imgnum,nstack,mz:',imgnum,nstack,mz
+@
+
+
+1.14
+log
+@LOGICAL              :: SAYI  not Integer
+@
+text
+@d10 1
+a10 1
+C=* Copyright 1985-2020 Health Research Inc.,                          *
+d1837 2
+a1838 1
+      CHARACTER(LEN=800) :: LABELS
+d1847 2
+d1854 5
+a1858 1
+            LABELS(INOW:INOW+3) = TRANSFER(MRC_HEADER(I),CSTR(1:4))
+@
+
+
+1.13
+log
+@added: CALL LUNSETSTATS_MRC
+@
+text
+@a11 1
+C=* Email: spider@@health.ny.gov                                        *
+d1885 2
+a1886 1
+      INTEGER              :: LUN,SAYIT,IRTFLG
+@
+
+
 1.12
 log
 @changes for fmin....
diff --git src/RCS/macf.f,v src/RCS/macf.f,v
index ace26f38..02c00832 100644
--- src/RCS/macf.f,v
+++ src/RCS/macf.f,v
@@ -1,4 +1,4 @@
-head	1.18;
+head	1.19;
 access;
 symbols
 	pre_mrcs:1.18
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.19
+date	2025.11.10.22.33.26;	author dean;	state Exp;
+branches;
+next	1.18;
+
 1.18
 date	2018.10.03.14.34.09;	author leith;	state Exp;
 branches;
@@ -120,9 +125,9 @@ desc
 @
 
 
-1.18
+1.19
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -136,7 +141,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -255,6 +260,17 @@ C
 @
 
 
+1.18
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.17
 log
 @LEN=MAXNAM) :: FILNAM
diff --git src/RCS/macf_p.f,v src/RCS/macf_p.f,v
index 447c2b18..7ad221c1 100644
--- src/RCS/macf_p.f,v
+++ src/RCS/macf_p.f,v
@@ -1,4 +1,4 @@
-head	1.18;
+head	1.19;
 access;
 symbols
 	pre_mrcs:1.18
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.19
+date	2025.11.10.22.33.26;	author dean;	state Exp;
+branches;
+next	1.18;
+
 1.18
 date	2018.10.03.14.34.09;	author leith;	state Exp;
 branches;
@@ -120,9 +125,9 @@ desc
 @
 
 
-1.18
+1.19
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -137,7 +142,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -270,6 +275,17 @@ C                   OTHERWISE AC COEFFS. ARE SET TO ZERO.
 @
 
 
+1.18
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.17
 log
 @GPL_2010
diff --git src/RCS/mahal.f,v src/RCS/mahal.f,v
index cb4d1c25..0b0821ac 100644
--- src/RCS/mahal.f,v
+++ src/RCS/mahal.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.33.26;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.09;	author leith;	state Exp;
 branches;
@@ -85,9 +90,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -101,7 +106,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -181,6 +186,17 @@ C***********************************************************************
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @GPL_2010
diff --git src/RCS/make_close_list.f,v src/RCS/make_close_list.f,v
index 120335f8..979020bc 100644
--- src/RCS/make_close_list.f,v
+++ src/RCS/make_close_list.f,v
@@ -1,4 +1,4 @@
-head	1.5;
+head	1.6;
 access;
 symbols
 	pre_mrcs:1.5
@@ -7,6 +7,11 @@ locks; strict;
 comment	@c @;
 
 
+1.6
+date	2025.11.10.22.33.27;	author dean;	state Exp;
+branches;
+next	1.5;
+
 1.5
 date	2018.10.03.14.34.09;	author leith;	state Exp;
 branches;
@@ -37,9 +42,9 @@ desc
 @@
 
 
-1.5
+1.6
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -52,7 +57,7 @@ C=* SPIDER - Modular Image Processing System.                          *
 C=* Authors: J. Frank & A. Leith                                       *
 C=* Copyright 1985-2011  Health Research Inc.                          *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -156,6 +161,17 @@ C              DO NOT DISCARD IF NOT MIRRORED OR WANT MIRRORED
 @
 
 
+1.5
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.4
 log
 @#ifndef __INTEL_COMPILER added for ifort use
diff --git src/RCS/makeall,v src/RCS/makeall,v
old mode 100755
new mode 100644
diff --git src/RCS/maked,v src/RCS/maked,v
old mode 100755
new mode 100644
diff --git src/RCS/makedqz,v src/RCS/makedqz,v
old mode 100755
new mode 100644
diff --git src/RCS/makelft,v src/RCS/makelft,v
old mode 100755
new mode 100644
diff --git src/RCS/makemp,v src/RCS/makemp,v
old mode 100755
new mode 100644
diff --git src/RCS/makenqz,v src/RCS/makenqz,v
old mode 100755
new mode 100644
diff --git src/RCS/makeqz,v src/RCS/makeqz,v
old mode 100755
new mode 100644
diff --git src/RCS/maktab.f,v src/RCS/maktab.f,v
index 82545068..797feb2e 100644
--- src/RCS/maktab.f,v
+++ src/RCS/maktab.f,v
@@ -1,4 +1,4 @@
-head	1.14;
+head	1.15;
 access;
 symbols
 	pre_mrcs:1.14
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.15
+date	2025.11.10.22.33.27;	author dean;	state Exp;
+branches;
+next	1.14;
+
 1.14
 date	2018.10.03.14.34.09;	author leith;	state Exp;
 branches;
@@ -100,9 +105,9 @@ desc
 @
 
 
-1.14
+1.15
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -116,7 +121,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -300,6 +305,17 @@ C      **************************** LIMCHK *************
 @
 
 
+1.14
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.13
 log
 @*** empty log message ***
diff --git src/RCS/malfi3.f,v src/RCS/malfi3.f,v
index 33505e35..d67e2ed2 100644
--- src/RCS/malfi3.f,v
+++ src/RCS/malfi3.f,v
@@ -1,4 +1,4 @@
-head	1.12;
+head	1.13;
 access;
 symbols
 	pre_mrcs:1.12
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.13
+date	2025.11.10.22.33.27;	author dean;	state Exp;
+branches;
+next	1.12;
+
 1.12
 date	2018.10.03.14.34.09;	author leith;	state Exp;
 branches;
@@ -90,9 +95,9 @@ desc
 @
 
 
-1.12
+1.13
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -105,7 +110,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -268,6 +273,17 @@ C	FQ=CMPLX(1.0,0.0)
 @
 
 
+1.12
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.11
 log
 @GPL_2010
diff --git src/RCS/mapdist.f,v src/RCS/mapdist.f,v
index 9ee13e96..fc0855e8 100644
--- src/RCS/mapdist.f,v
+++ src/RCS/mapdist.f,v
@@ -1,4 +1,4 @@
-head	1.16;
+head	1.17;
 access;
 symbols
 	pre_mrcs:1.16
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.17
+date	2025.11.10.22.33.27;	author dean;	state Exp;
+branches;
+next	1.16;
+
 1.16
 date	2018.10.03.14.34.09;	author leith;	state Exp;
 branches;
@@ -110,9 +115,9 @@ desc
 @
 
 
-1.16
+1.17
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -128,7 +133,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -339,6 +344,17 @@ C                 WRITE STATISTICS ON STANDARD OUTPUT
 @
 
 
+1.16
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.15
 log
 @fixed bug, out messages, nx
diff --git src/RCS/mapdoc.f,v src/RCS/mapdoc.f,v
index e448047b..a6d0883f 100644
--- src/RCS/mapdoc.f,v
+++ src/RCS/mapdoc.f,v
@@ -1,4 +1,4 @@
-head	1.15;
+head	1.16;
 access;
 symbols
 	pre_mrcs:1.15
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.16
+date	2025.11.10.22.33.27;	author dean;	state Exp;
+branches;
+next	1.15;
+
 1.15
 date	2018.10.03.14.34.09;	author leith;	state Exp;
 branches;
@@ -105,9 +110,9 @@ desc
 @
 
 
-1.15
+1.16
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -122,7 +127,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2013  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -304,6 +309,17 @@ C******************************
 @
 
 
+1.15
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.14
 log
 @output formating <>
diff --git src/RCS/mapfilt.f,v src/RCS/mapfilt.f,v
index 41945a32..ef795981 100644
--- src/RCS/mapfilt.f,v
+++ src/RCS/mapfilt.f,v
@@ -1,4 +1,4 @@
-head	1.15;
+head	1.16;
 access;
 symbols
 	pre_mrcs:1.15
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.16
+date	2025.11.10.22.33.28;	author dean;	state Exp;
+branches;
+next	1.15;
+
 1.15
 date	2018.10.03.14.34.09;	author leith;	state Exp;
 branches;
@@ -105,9 +110,9 @@ desc
 @
 
 
-1.15
+1.16
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -122,7 +127,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2013  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -302,6 +307,17 @@ C******************************
 @
 
 
+1.15
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.14
 log
 @output formating, <>
diff --git src/RCS/mapim.f,v src/RCS/mapim.f,v
index 9da29ee6..26276df5 100644
--- src/RCS/mapim.f,v
+++ src/RCS/mapim.f,v
@@ -1,4 +1,4 @@
-head	1.7;
+head	1.8;
 access;
 symbols
 	pre_mrcs:1.7
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.8
+date	2025.11.10.22.33.28;	author dean;	state Exp;
+branches;
+next	1.7;
+
 1.7
 date	2018.10.03.14.34.09;	author leith;	state Exp;
 branches;
@@ -65,9 +70,9 @@ desc
 @
 
 
-1.7
+1.8
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -81,7 +86,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -140,6 +145,17 @@ C            CHECK THIS VOXEL FOR REPLACEMENT
 @
 
 
+1.7
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.6
 log
 @GPL_2010
diff --git src/RCS/mapstat.f,v src/RCS/mapstat.f,v
index d43df3a0..da346c34 100644
--- src/RCS/mapstat.f,v
+++ src/RCS/mapstat.f,v
@@ -1,4 +1,4 @@
-head	1.12;
+head	1.13;
 access;
 symbols
 	pre_mrcs:1.12
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.13
+date	2025.11.10.22.33.28;	author dean;	state Exp;
+branches;
+next	1.12;
+
 1.12
 date	2018.10.03.14.34.09;	author leith;	state Exp;
 branches;
@@ -90,9 +95,9 @@ desc
 @
 
 
-1.12
+1.13
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -107,7 +112,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -283,6 +288,17 @@ C      CLOSE THE DOC FILE
 @
 
 
+1.12
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.11
 log
 @prompt
diff --git src/RCS/mask.f,v src/RCS/mask.f,v
index 7681c283..09ee463a 100644
--- src/RCS/mask.f,v
+++ src/RCS/mask.f,v
@@ -1,4 +1,4 @@
-head	1.33;
+head	1.34;
 access;
 symbols
 	pre_mrcs:1.33
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.34
+date	2025.11.10.22.33.28;	author dean;	state Exp;
+branches;
+next	1.33;
+
 1.33
 date	2018.10.03.14.34.09;	author leith;	state Exp;
 branches;
@@ -195,9 +200,9 @@ desc
 @
 
 
-1.33
+1.34
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @ 
@@ -215,7 +220,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -664,6 +669,17 @@ C          DISK MASKING
 @
 
 
+1.33
+log
+@email_health_dept
+@
+text
+@d16 1
+a16 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.32
 log
 @prompt for ma x
diff --git src/RCS/maskmu.f,v src/RCS/maskmu.f,v
index 49e931b9..e0c74837 100644
--- src/RCS/maskmu.f,v
+++ src/RCS/maskmu.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.33.28;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.09;	author leith;	state Exp;
 branches;
@@ -85,9 +90,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -100,7 +105,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -167,6 +172,17 @@ C       OPTION FOR CONTINUOUS-VALUED MASKS ('MM C')
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @enter
diff --git src/RCS/matinv.f,v src/RCS/matinv.f,v
index 65944343..e287ccd7 100644
--- src/RCS/matinv.f,v
+++ src/RCS/matinv.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.33.29;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.34.09;	author leith;	state Exp;
 branches;
@@ -70,9 +75,9 @@ desc
 @
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -85,7 +90,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -183,6 +188,17 @@ C--*******************************************************************
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @GPL_2010
diff --git src/RCS/maxf.f,v src/RCS/maxf.f,v
index 4a316b2e..70dd3976 100644
--- src/RCS/maxf.f,v
+++ src/RCS/maxf.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.33.29;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.09;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -90,7 +95,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -236,6 +241,17 @@ C     WRITE(NDAT,181)C,IMAX,IMAX1,AV,SIG
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/mccf.f,v src/RCS/mccf.f,v
index ca8d1fd9..edd93e4c 100644
--- src/RCS/mccf.f,v
+++ src/RCS/mccf.f,v
@@ -1,4 +1,4 @@
-head	1.7;
+head	1.8;
 access;
 symbols
 	pre_mrcs:1.7
@@ -21,6 +21,11 @@ locks; strict;
 comment	@c @;
 
 
+1.8
+date	2025.11.10.22.33.29;	author dean;	state Exp;
+branches;
+next	1.7;
+
 1.7
 date	2018.10.03.14.34.09;	author leith;	state Exp;
 branches;
@@ -62,9 +67,9 @@ desc
 @
 
 
-1.7
+1.8
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -77,7 +82,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -208,6 +213,17 @@ C
 @
 
 
+1.7
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.6
 log
 @GPL_2010
diff --git src/RCS/mccf_p.f,v src/RCS/mccf_p.f,v
index 534d31b2..628d4d1a 100644
--- src/RCS/mccf_p.f,v
+++ src/RCS/mccf_p.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -21,6 +21,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.33.29;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.09;	author leith;	state Exp;
 branches;
@@ -72,9 +77,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -87,7 +92,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -230,6 +235,17 @@ C                    OTHERWISE AC COEFFS. ARE SET TO ZERO.
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/mcircl.f,v src/RCS/mcircl.f,v
index 5fb747f3..e467e065 100644
--- src/RCS/mcircl.f,v
+++ src/RCS/mcircl.f,v
@@ -1,4 +1,4 @@
-head	1.17;
+head	1.18;
 access;
 symbols
 	pre_mrcs:1.17
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.18
+date	2025.11.10.22.33.29;	author dean;	state Exp;
+branches;
+next	1.17;
+
 1.17
 date	2018.10.03.14.34.09;	author leith;	state Exp;
 branches;
@@ -115,9 +120,9 @@ desc
 @
 
 
-1.17
+1.18
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -129,7 +134,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -274,6 +279,17 @@ C          ENTER 3 POINTS TO DETERMINE CIRCLE
 @
 
 
+1.17
+log
+@email_health_dept
+@
+text
+@d10 1
+a10 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.16
 log
 @intensity possible
diff --git src/RCS/md2.f,v src/RCS/md2.f,v
index c1e6f4c0..868f025f 100644
--- src/RCS/md2.f,v
+++ src/RCS/md2.f,v
@@ -1,4 +1,4 @@
-head	1.13;
+head	1.14;
 access;
 symbols
 	pre_mrcs:1.13
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.14
+date	2025.11.10.22.33.29;	author dean;	state Exp;
+branches;
+next	1.13;
+
 1.13
 date	2018.10.03.14.34.09;	author leith;	state Exp;
 branches;
@@ -95,9 +100,9 @@ desc
 @
 
 
-1.13
+1.14
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -110,7 +115,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2012  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -269,6 +274,17 @@ C             SQUARE SHAPED BOX
 @
 
 
+1.13
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.12
 log
 @md2_nolun added
diff --git src/RCS/md3.f,v src/RCS/md3.f,v
index 508a77f8..561b235c 100644
--- src/RCS/md3.f,v
+++ src/RCS/md3.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.33.29;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.09;	author leith;	state Exp;
 branches;
@@ -85,9 +90,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -100,7 +105,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -187,6 +192,17 @@ C       AUTOMATIC ARRAYS
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @GPL_2010
diff --git src/RCS/meanshift.f,v src/RCS/meanshift.f,v
index b56b5328..cd14b974 100644
--- src/RCS/meanshift.f,v
+++ src/RCS/meanshift.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -7,6 +7,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.33.29;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.09;	author leith;	state Exp;
 branches;
@@ -57,9 +62,9 @@ desc
 @@
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -74,7 +79,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2016  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -397,6 +402,17 @@ C            following line overcomes ifort compiler optimize bug
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @HACK TO OVERCOME IFORT OPTIMIZE BUG
diff --git src/RCS/median.f,v src/RCS/median.f,v
index e25d4e72..3478b880 100644
--- src/RCS/median.f,v
+++ src/RCS/median.f,v
@@ -1,4 +1,4 @@
-head	1.19;
+head	1.20;
 access;
 symbols
 	pre_mrcs:1.19
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.20
+date	2025.11.10.22.33.29;	author dean;	state Exp;
+branches;
+next	1.19;
+
 1.19
 date	2018.10.03.14.34.09;	author leith;	state Exp;
 branches;
@@ -125,9 +130,9 @@ desc
 @
 
 
-1.19
+1.20
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -140,7 +145,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -224,6 +229,17 @@ C***********************************************************************
 @
 
 
+1.19
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.18
 log
 @GPL_2010
diff --git src/RCS/meed.f,v src/RCS/meed.f,v
index 590bf646..23ebfd67 100644
--- src/RCS/meed.f,v
+++ src/RCS/meed.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.33.29;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.09;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -91,7 +96,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -141,6 +146,17 @@ C***********************************************************************
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/mehist.f,v src/RCS/mehist.f,v
index 484c8e1e..8e97e719 100644
--- src/RCS/mehist.f,v
+++ src/RCS/mehist.f,v
@@ -1,4 +1,4 @@
-head	1.5;
+head	1.6;
 access;
 symbols
 	pre_mrcs:1.5
@@ -19,6 +19,11 @@ locks; strict;
 comment	@c @;
 
 
+1.6
+date	2025.11.10.22.33.29;	author dean;	state Exp;
+branches;
+next	1.5;
+
 1.5
 date	2018.10.03.14.34.09;	author leith;	state Exp;
 branches;
@@ -49,9 +54,9 @@ desc
 @@
 
 
-1.5
+1.6
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -65,7 +70,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -216,6 +221,17 @@ C           THRESHOLD THIS PIXEL
 @
 
 
+1.5
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.4
 log
 @GPL_2010
diff --git src/RCS/mirror.f,v src/RCS/mirror.f,v
index afc605d0..446fc965 100644
--- src/RCS/mirror.f,v
+++ src/RCS/mirror.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.33.29;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.09;	author leith;	state Exp;
 branches;
@@ -80,9 +85,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -95,7 +100,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2012  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -199,6 +204,17 @@ C--*********************************************************************
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @reformatted, comments, nx
diff --git src/RCS/mlc.f,v src/RCS/mlc.f,v
index 2f27bbf5..78650a67 100644
--- src/RCS/mlc.f,v
+++ src/RCS/mlc.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.33.29;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.09;	author leith;	state Exp;
 branches;
@@ -80,9 +85,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -95,7 +100,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -134,6 +139,17 @@ C***********************************************************************
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @GPL_2010
diff --git src/RCS/mline.f,v src/RCS/mline.f,v
index bbdc0431..5d0343a9 100644
--- src/RCS/mline.f,v
+++ src/RCS/mline.f,v
@@ -1,4 +1,4 @@
-head	1.17;
+head	1.18;
 access;
 symbols
 	pre_mrcs:1.17
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.18
+date	2025.11.10.22.33.29;	author dean;	state Exp;
+branches;
+next	1.17;
+
 1.17
 date	2018.10.03.14.34.09;	author leith;	state Exp;
 branches;
@@ -115,9 +120,9 @@ desc
 @
 
 
-1.17
+1.18
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -131,7 +136,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -398,6 +403,17 @@ C       ---------  MLINE  --------- (ABANDONED FEB 2014) ---------------
 @
 
 
+1.17
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.16
 log
 @mline2 now aliases
diff --git src/RCS/mline3.f,v src/RCS/mline3.f,v
index 61fcea20..9d2fa200 100644
--- src/RCS/mline3.f,v
+++ src/RCS/mline3.f,v
@@ -1,4 +1,4 @@
-head	1.7;
+head	1.8;
 access;
 symbols
 	pre_mrcs:1.7
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.8
+date	2025.11.10.22.33.30;	author dean;	state Exp;
+branches;
+next	1.7;
+
 1.7
 date	2018.10.03.14.34.09;	author leith;	state Exp;
 branches;
@@ -65,9 +70,9 @@ desc
 @
 
 
-1.7
+1.8
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -78,7 +83,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -173,6 +178,17 @@ C **********************************************************************
 @
 
 
+1.7
+log
+@email_health_dept
+@
+text
+@d9 1
+a9 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.6
 log
 @enter
diff --git src/RCS/mod1.f,v src/RCS/mod1.f,v
index b65a6f58..099e508b 100644
--- src/RCS/mod1.f,v
+++ src/RCS/mod1.f,v
@@ -1,4 +1,4 @@
-head	1.16;
+head	1.17;
 access;
 symbols
 	pre_mrcs:1.16
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.17
+date	2025.11.10.22.33.30;	author dean;	state Exp;
+branches;
+next	1.16;
+
 1.16
 date	2018.10.03.14.34.10;	author leith;	state Exp;
 branches;
@@ -109,9 +114,9 @@ desc
 @@
 
 
-1.16
+1.17
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -128,7 +133,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -263,6 +268,17 @@ C       OPEN INPUT FILE, NO FOURIER INPUT ALLOWED
 @
 
 
+1.16
+log
+@email_health_dept
+@
+text
+@d15 1
+a15 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.15
 log
 @MAXNAM ==
diff --git src/RCS/mont.f,v src/RCS/mont.f,v
index cc97d2be..50f6cccd 100644
--- src/RCS/mont.f,v
+++ src/RCS/mont.f,v
@@ -1,4 +1,4 @@
-head	1.20;
+head	1.21;
 access;
 symbols
 	pre_mrcs:1.20
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.21
+date	2025.11.10.22.33.30;	author dean;	state Exp;
+branches;
+next	1.20;
+
 1.20
 date	2018.10.03.14.34.10;	author leith;	state Exp;
 branches;
@@ -130,9 +135,9 @@ desc
 @
 
 
-1.20
+1.21
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -149,7 +154,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2015  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -370,6 +375,17 @@ C          PUT OUT THE ROW OF IMAGES
 @
 
 
+1.20
+log
+@email_health_dept
+@
+text
+@d15 1
+a15 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.19
 log
 @dealloc buf
diff --git src/RCS/motif.f,v src/RCS/motif.f,v
index e613f983..4364bf69 100644
--- src/RCS/motif.f,v
+++ src/RCS/motif.f,v
@@ -1,4 +1,4 @@
-head	1.6;
+head	1.7;
 access;
 symbols
 	pre_mrcs:1.6
@@ -11,6 +11,11 @@ locks; strict;
 comment	@c @;
 
 
+1.7
+date	2025.11.10.22.33.30;	author dean;	state Exp;
+branches;
+next	1.6;
+
 1.6
 date	2018.10.03.14.34.10;	author leith;	state Exp;
 branches;
@@ -46,9 +51,9 @@ desc
 @@
 
 
-1.6
+1.7
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -61,7 +66,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -546,6 +551,17 @@ c        write(6,*) ' ---------------- '
 @
 
 
+1.6
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.5
 log
 @mainly cosmetic
diff --git src/RCS/motif1.f,v src/RCS/motif1.f,v
index 0dab8cec..5d0c702a 100644
--- src/RCS/motif1.f,v
+++ src/RCS/motif1.f,v
@@ -1,4 +1,4 @@
-head	1.4;
+head	1.5;
 access;
 symbols
 	pre_mrcs:1.4
@@ -11,6 +11,11 @@ locks; strict;
 comment	@c @;
 
 
+1.5
+date	2025.11.10.22.33.30;	author dean;	state Exp;
+branches;
+next	1.4;
+
 1.4
 date	2018.10.03.14.34.10;	author leith;	state Exp;
 branches;
@@ -36,9 +41,9 @@ desc
 @@
 
 
-1.4
+1.5
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -52,7 +57,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2011  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -320,6 +325,17 @@ C       ------------------- DEFAULT ------------------------------ '??'
 @
 
 
+1.4
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.3
 log
 @improved
diff --git src/RCS/motif_init.f,v src/RCS/motif_init.f,v
index 8e21d0bc..f0a563b4 100644
--- src/RCS/motif_init.f,v
+++ src/RCS/motif_init.f,v
@@ -1,4 +1,4 @@
-head	1.5;
+head	1.6;
 access;
 symbols
 	pre_mrcs:1.5
@@ -11,6 +11,11 @@ locks; strict;
 comment	@c @;
 
 
+1.6
+date	2025.11.10.22.33.30;	author dean;	state Exp;
+branches;
+next	1.5;
+
 1.5
 date	2018.10.03.14.34.10;	author leith;	state Exp;
 branches;
@@ -41,9 +46,9 @@ desc
 @@
 
 
-1.5
+1.6
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -56,7 +61,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -227,6 +232,17 @@ C          OUTPUT FFT OF SQUARED SEARCH VOLUME
 @
 
 
+1.5
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.4
 log
 @cosmetic
diff --git src/RCS/motif_lsd.f,v src/RCS/motif_lsd.f,v
index 4861ae6a..554e7445 100644
--- src/RCS/motif_lsd.f,v
+++ src/RCS/motif_lsd.f,v
@@ -1,4 +1,4 @@
-head	1.4;
+head	1.5;
 access;
 symbols
 	pre_mrcs:1.4
@@ -11,6 +11,11 @@ locks; strict;
 comment	@c @;
 
 
+1.5
+date	2025.11.10.22.33.30;	author dean;	state Exp;
+branches;
+next	1.4;
+
 1.4
 date	2018.10.03.14.34.10;	author leith;	state Exp;
 branches;
@@ -36,9 +41,9 @@ desc
 @@
 
 
-1.4
+1.5
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @cpgi$g opt=O3
@@ -53,7 +58,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -314,6 +319,17 @@ c$omp  end parallel do
 @
 
 
+1.4
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.3
 log
 @BUFVOL(I,J,K) < 1E-10) BUFVOL(I,J,K) = 9E+20 bug,  other cosmetic fixes, etc.
diff --git src/RCS/mpi.f,v src/RCS/mpi.f,v
index 1c8120ae..f9825f11 100644
--- src/RCS/mpi.f,v
+++ src/RCS/mpi.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -11,6 +11,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.33.30;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.10;	author leith;	state Exp;
 branches;
@@ -61,9 +66,9 @@ desc
 @@
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -79,7 +84,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2012 Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -390,6 +395,17 @@ C--*********************************************************************
 
 
 
+@
+
+
+1.9
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
 @
 
 
diff --git src/RCS/mpoint.f,v src/RCS/mpoint.f,v
index b22e2b93..aef2ca13 100644
--- src/RCS/mpoint.f,v
+++ src/RCS/mpoint.f,v
@@ -1,4 +1,4 @@
-head	1.13;
+head	1.14;
 access;
 symbols
 	pre_mrcs:1.13
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.14
+date	2025.11.10.22.33.30;	author dean;	state Exp;
+branches;
+next	1.13;
+
 1.13
 date	2018.10.03.14.34.10;	author leith;	state Exp;
 branches;
@@ -95,9 +100,9 @@ desc
 @
 
 
-1.13
+1.14
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -108,7 +113,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -156,6 +161,17 @@ C **********************************************************************
 @
 
 
+1.13
+log
+@email_health_dept
+@
+text
+@d9 1
+a9 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.12
 log
 @enter
diff --git src/RCS/mr2to3d.f,v src/RCS/mr2to3d.f,v
index f8b31000..9030adb6 100644
--- src/RCS/mr2to3d.f,v
+++ src/RCS/mr2to3d.f,v
@@ -1,4 +1,4 @@
-head	1.17;
+head	1.18;
 access;
 symbols
 	pre_mrcs:1.17
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.18
+date	2025.11.10.22.33.30;	author dean;	state Exp;
+branches;
+next	1.17;
+
 1.17
 date	2018.10.03.14.34.10;	author leith;	state Exp;
 branches;
@@ -115,9 +120,9 @@ desc
 @
 
 
-1.17
+1.18
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -131,7 +136,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -230,6 +235,17 @@ C            [ X*COS(THETA(I)) - Z*SIN(THETA(I)) - P(I)]^2 ->MIN
 @
 
 
+1.17
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.16
 log
 @GPL_2010
diff --git src/RCS/mralign.f,v src/RCS/mralign.f,v
index 24c5f953..ca3f3e7d 100644
--- src/RCS/mralign.f,v
+++ src/RCS/mralign.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.33.30;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.10;	author leith;	state Exp;
 branches;
@@ -80,9 +85,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -96,7 +101,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -161,6 +166,17 @@ C     X' = SCALE * R(PSI) * X + SHIFT
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @GPL_2010
diff --git src/RCS/mrand.f,v src/RCS/mrand.f,v
index fcdf5550..c5a3a196 100644
--- src/RCS/mrand.f,v
+++ src/RCS/mrand.f,v
@@ -1,4 +1,4 @@
-head	1.5;
+head	1.6;
 access;
 symbols
 	pre_mrcs:1.5
@@ -21,6 +21,11 @@ locks; strict;
 comment	@c @;
 
 
+1.6
+date	2025.11.10.22.33.30;	author dean;	state Exp;
+branches;
+next	1.5;
+
 1.5
 date	2018.10.03.14.34.10;	author leith;	state Exp;
 branches;
@@ -52,9 +57,9 @@ desc
 @
 
 
-1.5
+1.6
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -64,7 +69,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -167,6 +172,17 @@ C       WRITE(NOUT,100)OUT
 @
 
 
+1.5
+log
+@email_health_dept
+@
+text
+@d8 1
+a8 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.4
 log
 @GPL_2010
diff --git src/RCS/mrang2.f,v src/RCS/mrang2.f,v
index 7e75885d..d5674b41 100644
--- src/RCS/mrang2.f,v
+++ src/RCS/mrang2.f,v
@@ -1,4 +1,4 @@
-head	1.12;
+head	1.13;
 access;
 symbols
 	pre_mrcs:1.12
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.13
+date	2025.11.10.22.33.30;	author dean;	state Exp;
+branches;
+next	1.12;
+
 1.12
 date	2018.10.03.14.34.10;	author leith;	state Exp;
 branches;
@@ -90,9 +95,9 @@ desc
 @
 
 
-1.12
+1.13
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -106,7 +111,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -161,6 +166,17 @@ C     BUT IN SINGLE PRECISION COMPILER MAKES OPTIMIZATION ERROR.
 @
 
 
+1.12
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.11
 log
 @GPL_2010
diff --git src/RCS/mrcalerr.f,v src/RCS/mrcalerr.f,v
index b1ac58ed..5a86a0f4 100644
--- src/RCS/mrcalerr.f,v
+++ src/RCS/mrcalerr.f,v
@@ -1,4 +1,4 @@
-head	1.14;
+head	1.15;
 access;
 symbols
 	pre_mrcs:1.14
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.15
+date	2025.11.10.22.33.30;	author dean;	state Exp;
+branches;
+next	1.14;
+
 1.14
 date	2018.10.03.14.34.10;	author leith;	state Exp;
 branches;
@@ -100,9 +105,9 @@ desc
 @
 
 
-1.14
+1.15
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -116,7 +121,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -209,6 +214,17 @@ C700	CONTINUE
 @
 
 
+1.14
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.13
 log
 @GPL_2010
diff --git src/RCS/mrcg3.f,v src/RCS/mrcg3.f,v
index fc907dc1..6213a00a 100644
--- src/RCS/mrcg3.f,v
+++ src/RCS/mrcg3.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.33.30;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.10;	author leith;	state Exp;
 branches;
@@ -85,9 +90,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -101,7 +106,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -149,6 +154,17 @@ C       GO OVER X-Y-Z
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @GPL_2010
diff --git src/RCS/mrcg3d.f,v src/RCS/mrcg3d.f,v
index f5330dfb..0092eee9 100644
--- src/RCS/mrcg3d.f,v
+++ src/RCS/mrcg3d.f,v
@@ -1,4 +1,4 @@
-head	1.13;
+head	1.14;
 access;
 symbols
 	pre_mrcs:1.13
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.14
+date	2025.11.10.22.33.30;	author dean;	state Exp;
+branches;
+next	1.13;
+
 1.13
 date	2018.10.03.14.34.10;	author leith;	state Exp;
 branches;
@@ -95,9 +100,9 @@ desc
 @
 
 
-1.13
+1.14
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -111,7 +116,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -165,6 +170,17 @@ C          SUBTRACT CENTER OF GRAVITY
 @
 
 
+1.13
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.12
 log
 @GPL_2010
diff --git src/RCS/mrcp.f,v src/RCS/mrcp.f,v
index 135d21df..f1e30aba 100644
--- src/RCS/mrcp.f,v
+++ src/RCS/mrcp.f,v
@@ -1,4 +1,4 @@
-head	1.23;
+head	1.24;
 access;
 symbols
 	pre_mrcs:1.23
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.24
+date	2025.11.10.22.33.30;	author dean;	state Exp;
+branches;
+next	1.23;
+
 1.23
 date	2018.10.03.14.34.10;	author leith;	state Exp;
 branches;
@@ -145,9 +150,9 @@ desc
 @
 
 
-1.23
+1.24
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -163,7 +168,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2018  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -399,6 +404,17 @@ C                   HAVE A POSITIVE PIXEL, FIND DISTANCE FROM CENTER
 @
 
 
+1.23
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.22
 log
 @integer bug
diff --git src/RCS/mrdoc.f,v src/RCS/mrdoc.f,v
index 583a9e1a..1435b8d3 100644
--- src/RCS/mrdoc.f,v
+++ src/RCS/mrdoc.f,v
@@ -1,4 +1,4 @@
-head	1.22;
+head	1.23;
 access;
 symbols
 	pre_mrcs:1.22
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.23
+date	2025.11.10.22.33.30;	author dean;	state Exp;
+branches;
+next	1.22;
+
 1.22
 date	2018.10.03.14.34.10;	author leith;	state Exp;
 branches;
@@ -140,9 +145,9 @@ desc
 @
 
 
-1.22
+1.23
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -157,7 +162,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -266,6 +271,17 @@ C***********************************************************************
 @
 
 
+1.22
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.21
 log
 @PROMPTS & DOC FILE HEADERS lundoc
diff --git src/RCS/mrdoccor.f,v src/RCS/mrdoccor.f,v
index e4c6e65e..37d054c9 100644
--- src/RCS/mrdoccor.f,v
+++ src/RCS/mrdoccor.f,v
@@ -1,4 +1,4 @@
-head	1.14;
+head	1.15;
 access;
 symbols
 	pre_mrcs:1.14
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.15
+date	2025.11.10.22.33.30;	author dean;	state Exp;
+branches;
+next	1.14;
+
 1.14
 date	2018.10.03.14.34.10;	author leith;	state Exp;
 branches;
@@ -100,9 +105,9 @@ desc
 @
 
 
-1.14
+1.15
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -117,7 +122,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -216,6 +221,17 @@ C***********************************************************************
 @
 
 
+1.14
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.13
 log
 @PROMPTS & DOC FILE HEADERS & lundoc
diff --git src/RCS/mread.f,v src/RCS/mread.f,v
index 066890b9..9dcf5694 100644
--- src/RCS/mread.f,v
+++ src/RCS/mread.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.33.30;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.34.10;	author leith;	state Exp;
 branches;
@@ -70,9 +75,9 @@ desc
 @
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -86,7 +91,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -174,6 +179,17 @@ C     I DO NOT KNOW IF SAVE IS NEEDED FEB 99 al
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @GPL_2010
diff --git src/RCS/mrectl.f,v src/RCS/mrectl.f,v
index 2e44e10b..4a7b0dae 100644
--- src/RCS/mrectl.f,v
+++ src/RCS/mrectl.f,v
@@ -1,4 +1,4 @@
-head	1.14;
+head	1.15;
 access;
 symbols
 	pre_mrcs:1.14
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.15
+date	2025.11.10.22.33.30;	author dean;	state Exp;
+branches;
+next	1.14;
+
 1.14
 date	2018.10.03.14.34.10;	author leith;	state Exp;
 branches;
@@ -100,9 +105,9 @@ desc
 @
 
 
-1.14
+1.15
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -114,7 +119,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -186,6 +191,17 @@ C       LOOP OVER ALL ROWS
 @
 
 
+1.14
+log
+@email_health_dept
+@
+text
+@d10 1
+a10 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.13
 log
 @enter
diff --git src/RCS/mreigen.f,v src/RCS/mreigen.f,v
index 211a1c83..5884d336 100644
--- src/RCS/mreigen.f,v
+++ src/RCS/mreigen.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.33.31;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.10;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -91,7 +96,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -137,6 +142,17 @@ C***********************************************************************
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/mrerror.f,v src/RCS/mrerror.f,v
index 2c9c0660..55baf741 100644
--- src/RCS/mrerror.f,v
+++ src/RCS/mrerror.f,v
@@ -1,4 +1,4 @@
-head	1.16;
+head	1.17;
 access;
 symbols
 	pre_mrcs:1.16
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.17
+date	2025.11.10.22.33.31;	author dean;	state Exp;
+branches;
+next	1.16;
+
 1.16
 date	2018.10.03.14.34.10;	author leith;	state Exp;
 branches;
@@ -110,9 +115,9 @@ desc
 @
 
 
-1.16
+1.17
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -127,7 +132,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -220,6 +225,17 @@ C           OVERWRITE INPUT POINTS WITH ALIGNED POINTS
 @
 
 
+1.16
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.15
 log
 @PROMPTS & DOC FILE HEADERS & lundoc
diff --git src/RCS/mrgetinfo.f,v src/RCS/mrgetinfo.f,v
index 88e69fdf..2ffeaee8 100644
--- src/RCS/mrgetinfo.f,v
+++ src/RCS/mrgetinfo.f,v
@@ -1,4 +1,4 @@
-head	1.27;
+head	1.28;
 access;
 symbols
 	pre_mrcs:1.27
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.28
+date	2025.11.10.22.33.31;	author dean;	state Exp;
+branches;
+next	1.27;
+
 1.27
 date	2018.10.03.14.34.10;	author leith;	state Exp;
 branches;
@@ -165,9 +170,9 @@ desc
 @
 
 
-1.27
+1.28
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -181,7 +186,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -420,6 +425,17 @@ C     COMMENTS TEMP MODIFIED TO READ IN MARKER ANGLES FILE
 @
 
 
+1.27
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.26
 log
 @enter
diff --git src/RCS/mrk.f,v src/RCS/mrk.f,v
index 82512dfb..d178de65 100644
--- src/RCS/mrk.f,v
+++ src/RCS/mrk.f,v
@@ -1,4 +1,4 @@
-head	1.31;
+head	1.32;
 access;
 symbols
 	pre_mrcs:1.31
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.32
+date	2025.11.10.22.33.31;	author dean;	state Exp;
+branches;
+next	1.31;
+
 1.31
 date	2018.10.03.14.34.10;	author leith;	state Exp;
 branches;
@@ -185,9 +190,9 @@ desc
 @
 
 
-1.31
+1.32
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -202,7 +207,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -516,6 +521,17 @@ C------------- UNUSED BELOW ---------------------------
 @
 
 
+1.31
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.30
 log
 @PROMPTS & DOC FILE HEADERS & lundoc
diff --git src/RCS/mrk3.f,v src/RCS/mrk3.f,v
index 8f16764f..7298df13 100644
--- src/RCS/mrk3.f,v
+++ src/RCS/mrk3.f,v
@@ -1,4 +1,4 @@
-head	1.23;
+head	1.24;
 access;
 symbols
 	pre_mrcs:1.23
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.24
+date	2025.11.10.22.33.31;	author dean;	state Exp;
+branches;
+next	1.23;
+
 1.23
 date	2018.10.03.14.34.10;	author leith;	state Exp;
 branches;
@@ -145,9 +150,9 @@ desc
 @
 
 
-1.23
+1.24
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -164,7 +169,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -310,6 +315,17 @@ C     STORE ALIGNED COORDINATES, ERROR PER POINT, AND THE TOTAL ERROR
 @
 
 
+1.23
+log
+@email_health_dept
+@
+text
+@d15 1
+a15 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.22
 log
 @cosmetic
diff --git src/RCS/mrkur3.f,v src/RCS/mrkur3.f,v
index 6da46b9b..2988c25a 100644
--- src/RCS/mrkur3.f,v
+++ src/RCS/mrkur3.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.33.31;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.10;	author leith;	state Exp;
 branches;
@@ -80,9 +85,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -96,7 +101,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -171,6 +176,17 @@ C**3  FORMAT('-',F3.2,' ',<IMAX>A1)
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @GPL_2010
diff --git src/RCS/mrncolor.f,v src/RCS/mrncolor.f,v
index 0e1b456f..06994e2a 100644
--- src/RCS/mrncolor.f,v
+++ src/RCS/mrncolor.f,v
@@ -1,4 +1,4 @@
-head	1.15;
+head	1.16;
 access;
 symbols
 	pre_mrcs:1.15
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.16
+date	2025.11.10.22.33.32;	author dean;	state Exp;
+branches;
+next	1.15;
+
 1.15
 date	2018.10.03.14.34.10;	author leith;	state Exp;
 branches;
@@ -105,9 +110,9 @@ desc
 @
 
 
-1.15
+1.16
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -119,7 +124,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -341,6 +346,17 @@ C          WRITE 2 LINES MORE OF THIS:
 @
 
 
+1.15
+log
+@email_health_dept
+@
+text
+@d10 1
+a10 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.14
 log
 @enter
diff --git src/RCS/mrnewangle.f,v src/RCS/mrnewangle.f,v
index c7e3316e..c50b1733 100644
--- src/RCS/mrnewangle.f,v
+++ src/RCS/mrnewangle.f,v
@@ -1,4 +1,4 @@
-head	1.23;
+head	1.24;
 access;
 symbols
 	pre_mrcs:1.23
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.24
+date	2025.11.10.22.33.32;	author dean;	state Exp;
+branches;
+next	1.23;
+
 1.23
 date	2018.10.03.14.34.10;	author leith;	state Exp;
 branches;
@@ -145,9 +150,9 @@ desc
 @
 
 
-1.23
+1.24
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -163,7 +168,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -268,6 +273,17 @@ C           OUTPUT THE ANGLES
 @
 
 
+1.23
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.22
 log
 @PROMPTS & DOC FILE HEADERS lundoc
diff --git src/RCS/mrproj.f,v src/RCS/mrproj.f,v
index 9414b98b..078b2921 100644
--- src/RCS/mrproj.f,v
+++ src/RCS/mrproj.f,v
@@ -1,4 +1,4 @@
-head	1.13;
+head	1.14;
 access;
 symbols
 	pre_mrcs:1.13
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.14
+date	2025.11.10.22.33.32;	author dean;	state Exp;
+branches;
+next	1.13;
+
 1.13
 date	2018.10.03.14.34.10;	author leith;	state Exp;
 branches;
@@ -95,9 +100,9 @@ desc
 @
 
 
-1.13
+1.14
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -111,7 +116,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -169,6 +174,17 @@ C     ROTATE ABOUT Y, Z2 (THETA, PSI)
 @
 
 
+1.13
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.12
 log
 @GPL_2010
diff --git src/RCS/mrprrep.f,v src/RCS/mrprrep.f,v
index f10faf9f..b79e0749 100644
--- src/RCS/mrprrep.f,v
+++ src/RCS/mrprrep.f,v
@@ -1,4 +1,4 @@
-head	1.17;
+head	1.18;
 access;
 symbols
 	pre_mrcs:1.17
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.18
+date	2025.11.10.22.33.32;	author dean;	state Exp;
+branches;
+next	1.17;
+
 1.17
 date	2018.10.03.14.34.10;	author leith;	state Exp;
 branches;
@@ -115,9 +120,9 @@ desc
 @
 
 
-1.17
+1.18
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -133,7 +138,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014 Health Research Inc.,                          *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -326,6 +331,17 @@ C NOW STORE PROJECTION ARRAY INTO FILE
 @
 
 
+1.17
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.16
 log
 @cosmetic
diff --git src/RCS/mrputinfo.f,v src/RCS/mrputinfo.f,v
index e275b183..0c6e60c5 100644
--- src/RCS/mrputinfo.f,v
+++ src/RCS/mrputinfo.f,v
@@ -1,4 +1,4 @@
-head	1.19;
+head	1.20;
 access;
 symbols
 	pre_mrcs:1.19
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.20
+date	2025.11.10.22.33.32;	author dean;	state Exp;
+branches;
+next	1.19;
+
 1.19
 date	2018.10.03.14.34.10;	author leith;	state Exp;
 branches;
@@ -125,9 +130,9 @@ desc
 @
 
 
-1.19
+1.20
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -142,7 +147,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -279,6 +284,17 @@ C          STORE ANGLES
 @
 
 
+1.19
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.18
 log
 @prompts improved & cosmetic
diff --git src/RCS/mrquater.f,v src/RCS/mrquater.f,v
index ccf53e64..193b9b8a 100644
--- src/RCS/mrquater.f,v
+++ src/RCS/mrquater.f,v
@@ -1,4 +1,4 @@
-head	1.14;
+head	1.15;
 access;
 symbols
 	pre_mrcs:1.14
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.15
+date	2025.11.10.22.33.32;	author dean;	state Exp;
+branches;
+next	1.14;
+
 1.14
 date	2018.10.03.14.34.10;	author leith;	state Exp;
 branches;
@@ -100,9 +105,9 @@ desc
 @
 
 
-1.14
+1.15
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -118,7 +123,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -227,6 +232,17 @@ C
 @
 
 
+1.14
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.13
 log
 @PROMPTS & DOC FILE HEADERS & lundoc
diff --git src/RCS/mrrefl.f,v src/RCS/mrrefl.f,v
index 4631e04d..50ba052d 100644
--- src/RCS/mrrefl.f,v
+++ src/RCS/mrrefl.f,v
@@ -1,4 +1,4 @@
-head	1.16;
+head	1.17;
 access;
 symbols
 	pre_mrcs:1.16
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.17
+date	2025.11.10.22.33.32;	author dean;	state Exp;
+branches;
+next	1.16;
+
 1.16
 date	2018.10.03.14.34.10;	author leith;	state Exp;
 branches;
@@ -110,9 +115,9 @@ desc
 @
 
 
-1.16
+1.17
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -127,7 +132,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -254,6 +259,17 @@ C             INTENSITY IN Z-COMPONENT, WHICH IS THE ONE ONE SEES:
 @
 
 
+1.16
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.15
 log
 @GPL_2010
diff --git src/RCS/mrreplace.f,v src/RCS/mrreplace.f,v
index e7fab4d5..81401065 100644
--- src/RCS/mrreplace.f,v
+++ src/RCS/mrreplace.f,v
@@ -1,4 +1,4 @@
-head	1.21;
+head	1.22;
 access;
 symbols
 	pre_mrcs:1.21
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.22
+date	2025.11.10.22.33.32;	author dean;	state Exp;
+branches;
+next	1.21;
+
 1.21
 date	2018.10.03.14.34.10;	author leith;	state Exp;
 branches;
@@ -135,9 +140,9 @@ desc
 @
 
 
-1.21
+1.22
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -151,7 +156,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -360,6 +365,17 @@ C     AUTHOR: M.RADERMACHER, 5/97
 @
 
 
+1.21
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.20
 log
 @LEN=MAXNAM) :: FIL1,FIL2
diff --git src/RCS/mrrotate.f,v src/RCS/mrrotate.f,v
index 44e6d213..00862be8 100644
--- src/RCS/mrrotate.f,v
+++ src/RCS/mrrotate.f,v
@@ -1,4 +1,4 @@
-head	1.14;
+head	1.15;
 access;
 symbols
 	pre_mrcs:1.14
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.15
+date	2025.11.10.22.33.32;	author dean;	state Exp;
+branches;
+next	1.14;
+
 1.14
 date	2018.10.03.14.34.10;	author leith;	state Exp;
 branches;
@@ -100,9 +105,9 @@ desc
 @
 
 
-1.14
+1.15
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -116,7 +121,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -222,6 +227,17 @@ C       LIMIT PRECISION
 @
 
 
+1.14
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.13
 log
 @GPL_2010
diff --git src/RCS/mrrsurf.f,v src/RCS/mrrsurf.f,v
index 9e4f267d..d559bebf 100644
--- src/RCS/mrrsurf.f,v
+++ src/RCS/mrrsurf.f,v
@@ -1,4 +1,4 @@
-head	1.16;
+head	1.17;
 access;
 symbols
 	pre_mrcs:1.16
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.17
+date	2025.11.10.22.33.32;	author dean;	state Exp;
+branches;
+next	1.16;
+
 1.16
 date	2018.10.03.14.34.10;	author leith;	state Exp;
 branches;
@@ -110,9 +115,9 @@ desc
 @
 
 
-1.16
+1.17
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -127,7 +132,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -437,6 +442,17 @@ C     WRITE(6,200) NL1,NL2,NS1,NS2,SW,NSAM,NROW,NSLICE,CS,CQ
 @
 
 
+1.16
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.15
 log
 @(LEN=MAXNAM) :: FLN1,FLN3D
diff --git src/RCS/mrrt.f,v src/RCS/mrrt.f,v
index bc48398a..bf46cb97 100644
--- src/RCS/mrrt.f,v
+++ src/RCS/mrrt.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.33.32;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.10;	author leith;	state Exp;
 branches;
@@ -85,9 +90,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -101,7 +106,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -188,6 +193,17 @@ C--*********************************************************************
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @LEN=MAXNAM):: DOCFIL,   many cosmetic
diff --git src/RCS/mrscale.f,v src/RCS/mrscale.f,v
index 0f4a57c2..6b0a96ad 100644
--- src/RCS/mrscale.f,v
+++ src/RCS/mrscale.f,v
@@ -1,4 +1,4 @@
-head	1.13;
+head	1.14;
 access;
 symbols
 	pre_mrcs:1.13
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.14
+date	2025.11.10.22.33.32;	author dean;	state Exp;
+branches;
+next	1.13;
+
 1.13
 date	2018.10.03.14.34.10;	author leith;	state Exp;
 branches;
@@ -95,9 +100,9 @@ desc
 @
 
 
-1.13
+1.14
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -111,7 +116,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -182,6 +187,17 @@ C     SUMS UP THE SQUARES OF THE COORDS
 @
 
 
+1.13
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.12
 log
 @GPL_2010
diff --git src/RCS/mrscale3.f,v src/RCS/mrscale3.f,v
index d1ecd927..ec18c4b5 100644
--- src/RCS/mrscale3.f,v
+++ src/RCS/mrscale3.f,v
@@ -1,4 +1,4 @@
-head	1.12;
+head	1.13;
 access;
 symbols
 	pre_mrcs:1.12
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.13
+date	2025.11.10.22.33.32;	author dean;	state Exp;
+branches;
+next	1.12;
+
 1.12
 date	2018.10.03.14.34.10;	author leith;	state Exp;
 branches;
@@ -90,9 +95,9 @@ desc
 @
 
 
-1.12
+1.13
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -106,7 +111,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -168,6 +173,17 @@ C     SUMS UP THE SQUARES OF THE COORDS
 @
 
 
+1.12
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.11
 log
 @GPL_2010
diff --git src/RCS/mrshift.f,v src/RCS/mrshift.f,v
index abc2aaa3..d2b680fd 100644
--- src/RCS/mrshift.f,v
+++ src/RCS/mrshift.f,v
@@ -1,4 +1,4 @@
-head	1.12;
+head	1.13;
 access;
 symbols
 	pre_mrcs:1.12
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.13
+date	2025.11.10.22.33.32;	author dean;	state Exp;
+branches;
+next	1.12;
+
 1.12
 date	2018.10.03.14.34.10;	author leith;	state Exp;
 branches;
@@ -90,9 +95,9 @@ desc
 @
 
 
-1.12
+1.13
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -106,7 +111,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -166,6 +171,17 @@ C***********************************************************************
 @
 
 
+1.12
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.11
 log
 @GPL_2010
diff --git src/RCS/mrsurf.f,v src/RCS/mrsurf.f,v
index 5c6d0e08..851d5a09 100644
--- src/RCS/mrsurf.f,v
+++ src/RCS/mrsurf.f,v
@@ -1,4 +1,4 @@
-head	1.17;
+head	1.18;
 access;
 symbols
 	pre_mrcs:1.17
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.18
+date	2025.11.10.22.33.32;	author dean;	state Exp;
+branches;
+next	1.17;
+
 1.17
 date	2018.10.03.14.34.10;	author leith;	state Exp;
 branches;
@@ -115,9 +120,9 @@ desc
 @
 
 
-1.17
+1.18
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @ 
@@ -134,7 +139,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -546,6 +551,17 @@ C     WRITE(6,200) NL1,NL2,NS1,NS2,SW,NSAM,NROW,NSLICE,CS,CQ
 @
 
 
+1.17
+log
+@email_health_dept
+@
+text
+@d15 1
+a15 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.16
 log
 @(LEN=MAXNAM):: FLN1........
diff --git src/RCS/mrtheta.f,v src/RCS/mrtheta.f,v
index 116499f8..0b937e82 100644
--- src/RCS/mrtheta.f,v
+++ src/RCS/mrtheta.f,v
@@ -1,4 +1,4 @@
-head	1.13;
+head	1.14;
 access;
 symbols
 	pre_mrcs:1.13
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.14
+date	2025.11.10.22.33.32;	author dean;	state Exp;
+branches;
+next	1.13;
+
 1.13
 date	2018.10.03.14.34.10;	author leith;	state Exp;
 branches;
@@ -95,9 +100,9 @@ desc
 @
 
 
-1.13
+1.14
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -111,7 +116,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -187,6 +192,17 @@ C         COMPUTE VIEW WITH X-Z POINTS
 @
 
 
+1.13
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.12
 log
 @GPL_2010
diff --git src/RCS/msum.f,v src/RCS/msum.f,v
index eb90f522..d6dc014d 100644
--- src/RCS/msum.f,v
+++ src/RCS/msum.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.33.32;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.10;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -91,7 +96,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -141,6 +146,17 @@ C***********************************************************************
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/mtnv.f,v src/RCS/mtnv.f,v
index 7b56adb9..77e883fd 100644
--- src/RCS/mtnv.f,v
+++ src/RCS/mtnv.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.33.32;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.10;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -90,7 +95,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -144,6 +149,17 @@ C***********************************************************************
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/mtpr.f,v src/RCS/mtpr.f,v
index 7e6b3fc5..2627f971 100644
--- src/RCS/mtpr.f,v
+++ src/RCS/mtpr.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.33.32;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.10;	author leith;	state Exp;
 branches;
@@ -80,9 +85,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -95,7 +100,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -159,6 +164,17 @@ C       WRITE(LUN51,30)J(I),VNAM(I),(R(I,K),K=I1,I3)
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @GPL_2010
diff --git src/RCS/mtrian.f,v src/RCS/mtrian.f,v
index 9d087cac..b2cd4142 100644
--- src/RCS/mtrian.f,v
+++ src/RCS/mtrian.f,v
@@ -1,4 +1,4 @@
-head	1.14;
+head	1.15;
 access;
 symbols
 	pre_mrcs:1.14
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.15
+date	2025.11.10.22.33.32;	author dean;	state Exp;
+branches;
+next	1.14;
+
 1.14
 date	2018.10.03.14.34.10;	author leith;	state Exp;
 branches;
@@ -100,9 +105,9 @@ desc
 @
 
 
-1.14
+1.15
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -113,7 +118,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -234,6 +239,17 @@ C       I DO NOT KNOW IF SAVE IS NEEDED FEB 99 al
 @
 
 
+1.14
+log
+@email_health_dept
+@
+text
+@d9 1
+a9 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.13
 log
 @enter
diff --git src/RCS/mult.f,v src/RCS/mult.f,v
index 6f8eafdb..d56b006d 100644
--- src/RCS/mult.f,v
+++ src/RCS/mult.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.33.33;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.10;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -91,7 +96,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -135,6 +140,17 @@ C***********************************************************************
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/mx.f,v src/RCS/mx.f,v
index b40d81dd..36f2950c 100644
--- src/RCS/mx.f,v
+++ src/RCS/mx.f,v
@@ -1,4 +1,4 @@
-head	1.7;
+head	1.8;
 access;
 symbols
 	pre_mrcs:1.7
@@ -19,6 +19,11 @@ locks; strict;
 comment	@c @;
 
 
+1.8
+date	2025.11.10.22.33.33;	author dean;	state Exp;
+branches;
+next	1.7;
+
 1.7
 date	2018.10.03.14.34.10;	author leith;	state Exp;
 branches;
@@ -59,9 +64,9 @@ desc
 @@
 
 
-1.7
+1.8
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -75,7 +80,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -136,6 +141,17 @@ C-************************************************************************
 @
 
 
+1.7
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.6
 log
 @GPL_2010
diff --git src/RCS/mygetenv.f,v src/RCS/mygetenv.f,v
index d4921f9f..8731c09b 100644
--- src/RCS/mygetenv.f,v
+++ src/RCS/mygetenv.f,v
@@ -1,4 +1,4 @@
-head	1.14;
+head	1.15;
 access;
 symbols
 	pre_mrcs:1.14
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.15
+date	2025.11.10.22.33.33;	author dean;	state Exp;
+branches;
+next	1.14;
+
 1.14
 date	2018.10.03.14.34.11;	author leith;	state Exp;
 branches;
@@ -100,9 +105,9 @@ desc
 @
 
 
-1.14
+1.15
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -116,7 +121,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -179,6 +184,17 @@ C       READ IN THE ENVIRONMENT VARIABLE 'INPUT'.
 @
 
 
+1.14
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.13
 log
 @typo
diff --git src/RCS/mymods.f,v src/RCS/mymods.f,v
index 02a95134..3b79d208 100644
--- src/RCS/mymods.f,v
+++ src/RCS/mymods.f,v
@@ -1,4 +1,4 @@
-head	1.15;
+head	1.16;
 access;
 symbols
 	pre_mrcs:1.15
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.16
+date	2025.11.10.22.33.33;	author dean;	state Exp;
+branches;
+next	1.15;
+
 1.15
 date	2018.10.03.14.34.11;	author leith;	state Exp;
 branches;
@@ -104,9 +109,9 @@ desc
 @@
 
 
-1.15
+1.16
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -116,7 +121,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -283,6 +288,17 @@ C       IO FILES WILL BE CLOSED IN THE CALLING PROGRAM
 @
 
 
+1.15
+log
+@email_health_dept
+@
+text
+@d8 1
+a8 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.14
 log
 @GPL_2010
diff --git src/RCS/myread.f,v src/RCS/myread.f,v
index c750b8e0..b6a69a09 100644
--- src/RCS/myread.f,v
+++ src/RCS/myread.f,v
@@ -1,4 +1,4 @@
-head	1.12;
+head	1.13;
 access;
 symbols
 	pre_mrcs:1.12
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.13
+date	2025.11.10.22.33.33;	author dean;	state Exp;
+branches;
+next	1.12;
+
 1.12
 date	2018.10.03.14.34.11;	author leith;	state Exp;
 branches;
@@ -90,9 +95,9 @@ desc
 @
 
 
-1.12
+1.13
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -106,7 +111,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -218,6 +223,17 @@ C     & IBI,8,51,3,3)
 @
 
 
+1.12
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.11
 log
 @GPL_2010
diff --git src/RCS/mytime.f,v src/RCS/mytime.f,v
index 7e7883be..97fa6f34 100644
--- src/RCS/mytime.f,v
+++ src/RCS/mytime.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.33.33;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.11;	author leith;	state Exp;
 branches;
@@ -79,9 +84,9 @@ desc
 @@
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -95,7 +100,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -144,6 +149,17 @@ C      CALL DATE_AND_TIME(DATET,TIMET,ZONE,VALUES) (fails on altix)
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @GPL_2010
diff --git src/RCS/mywr0.f,v src/RCS/mywr0.f,v
index 7302ea98..5f00096b 100644
--- src/RCS/mywr0.f,v
+++ src/RCS/mywr0.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.33.33;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.11;	author leith;	state Exp;
 branches;
@@ -85,9 +90,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -101,7 +106,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -163,6 +168,17 @@ C***********************************************************************
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @GPL_2010
diff --git src/RCS/mywr1.f,v src/RCS/mywr1.f,v
index 0f85d699..d3f42526 100644
--- src/RCS/mywr1.f,v
+++ src/RCS/mywr1.f,v
@@ -1,4 +1,4 @@
-head	1.13;
+head	1.14;
 access;
 symbols
 	pre_mrcs:1.13
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.14
+date	2025.11.10.22.33.33;	author dean;	state Exp;
+branches;
+next	1.13;
+
 1.13
 date	2018.10.03.14.34.11;	author leith;	state Exp;
 branches;
@@ -95,9 +100,9 @@ desc
 @
 
 
-1.13
+1.14
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -111,7 +116,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -171,6 +176,17 @@ C***********************************************************************
 @
 
 
+1.13
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.12
 log
 @GPL_2010
diff --git src/RCS/mywr2.f,v src/RCS/mywr2.f,v
index f842f8cf..8eebc431 100644
--- src/RCS/mywr2.f,v
+++ src/RCS/mywr2.f,v
@@ -1,4 +1,4 @@
-head	1.12;
+head	1.13;
 access;
 symbols
 	pre_mrcs:1.12
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.13
+date	2025.11.10.22.33.34;	author dean;	state Exp;
+branches;
+next	1.12;
+
 1.12
 date	2018.10.03.14.34.11;	author leith;	state Exp;
 branches;
@@ -90,9 +95,9 @@ desc
 @
 
 
-1.12
+1.13
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -106,7 +111,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -169,6 +174,17 @@ C  11   FORMAT(1X,I4,1X,A4,3X,G11.4,5X,G11.4,F11.2,8X,F7.4,5X,F9.3)
 @
 
 
+1.12
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.11
 log
 @GPL_2010
diff --git src/RCS/narea.f,v src/RCS/narea.f,v
index 0b52fcc2..4b3d6bde 100644
--- src/RCS/narea.f,v
+++ src/RCS/narea.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.33.34;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.34.11;	author leith;	state Exp;
 branches;
@@ -70,9 +75,9 @@ desc
 @
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -86,7 +91,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -148,6 +153,17 @@ C	IF(IX(I).GT.IXP(I,IP)+NXE(I)) GOTO 20 ! CHANGED 8/13/87
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @GPL_2010
diff --git src/RCS/negate.f,v src/RCS/negate.f,v
index 3c34c6ee..0a4f1d21 100644
--- src/RCS/negate.f,v
+++ src/RCS/negate.f,v
@@ -1,4 +1,4 @@
-head	1.5;
+head	1.6;
 access;
 symbols
 	pre_mrcs:1.5
@@ -23,6 +23,11 @@ locks; strict;
 comment	@c @;
 
 
+1.6
+date	2025.11.10.22.33.34;	author dean;	state Exp;
+branches;
+next	1.5;
+
 1.5
 date	2018.10.03.14.34.11;	author leith;	state Exp;
 branches;
@@ -53,9 +58,9 @@ desc
 @@
 
 
-1.5
+1.6
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -68,7 +73,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -110,6 +115,17 @@ C--*******************************************************************
 @
 
 
+1.5
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.4
 log
 @GPL_2010
diff --git src/RCS/negati.f,v src/RCS/negati.f,v
index f4b40e53..4c18cbe3 100644
--- src/RCS/negati.f,v
+++ src/RCS/negati.f,v
@@ -1,4 +1,4 @@
-head	1.5;
+head	1.6;
 access;
 symbols
 	pre_mrcs:1.5
@@ -23,6 +23,11 @@ locks; strict;
 comment	@c @;
 
 
+1.6
+date	2025.11.10.22.33.34;	author dean;	state Exp;
+branches;
+next	1.5;
+
 1.5
 date	2018.10.03.14.34.11;	author leith;	state Exp;
 branches;
@@ -53,9 +58,9 @@ desc
 @@
 
 
-1.5
+1.6
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -68,7 +73,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -117,6 +122,17 @@ C        FOLLOWING IS F90 ARRAY OPERATION
 @
 
 
+1.5
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.4
 log
 @GPL_2010
diff --git src/RCS/nextversion.f,v src/RCS/nextversion.f,v
index a7c16679..79164ded 100644
--- src/RCS/nextversion.f,v
+++ src/RCS/nextversion.f,v
@@ -1,4 +1,4 @@
-head	1.23;
+head	1.24;
 access;
 symbols
 	pre_mrcs:1.23
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.24
+date	2025.09.26.16.01.18;	author dean;	state Exp;
+branches;
+next	1.23;
+
 1.23
 date	2018.10.03.14.34.11;	author leith;	state Exp;
 branches;
@@ -145,28 +150,29 @@ desc
 @
 
 
-1.23
+1.24
 log
-@email_health_dept
+@cosmetic,  debug output commented out
+.l
 @
 text
 @ 
 C++*********************************************************************
 C
-C NEXTVERSION.F                                                  3/2/94
-C                       ADDED CXNUMB                AUG 00 ARDEAN LEITH
-C                       NEXTRESULTS IN BIN DIR      FEB 09 ARDEAN LEITH
-C                       OUTPUT FORMATTING           AUG 14 ARDEAN LEITH
-C                       OUTPUT FORMATTING,DELETE    JAN 16 ARDEAN LEITH
+C NEXTVERSION.F         ORIGINAL                  3/2/94
+C                       ADDED CXNUMB              AUG 2000 ARDEAN LEITH
+C                       NEXTRESULTS IN BIN DIR    FEB 2009 ARDEAN LEITH
+C                       OUTPUT FORMATTING         AUG 2014 ARDEAN LEITH
+C                       OUTPUT FORMATTING,DELETE  JAN 2016 ARDEAN LEITH
 C
 C **********************************************************************
-C *  AUTHOR: MAHIEDDINE LADJADJ                                            *
+C=*  AUTHOR: MAHIEDDINE LADJADJ                                        *
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2016  Health Research Inc.,                         *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -241,10 +247,21 @@ C          RESULTS EXTENSION SET BY CALLER
 
 C       SET DEFAULT VALUE USING LAST 3 DIGITS OF SYSTEM CLOCK
         CALL SYSTEM_CLOCK(INUMB,IDUM,IDUM)
+
+        !write(6,*)' In nextversion 1; inumb,nchar: ',inumb,nchar
+
         INUMB                   = MOD(INUMB,1000)
+
+        !write(6,*)' In nextversion 2; inumb,nchar: ',inumb,nchar
+
         FILOUT(NCHAR+1:NCHAR+1) = '.' 
+
+        !write(6,*)' In nextversion 3; inumb,nchar: ',inumb,nchar,nlet
+
         CALL INTTOCHAR(INUMB,FILOUT(NCHAR+2:NCHAR+4),NLET,3)
 
+        !write(6,*)' In nextversion 4; nchar,filout: ',nchar, filout
+
 #ifndef SP_IBMSP3
 C       OMIT THIS FOR NOW ON PARALLEL ARCH. al Oct 00
 
@@ -289,9 +306,6 @@ C       READ THE FILE FILENAME.NBR' FOUND AND STORED IN SPIDER_JUNK.TMP
 C       DELETE THE TEMP FILE.
         CLOSE(LUNT,STATUS='DELETE')
 
-C       DELETE THE TEMP FILE.
-cc      SCRIPT = 'rm -f SPIDER_JUNK.TMP' // NULL
-cc      CALL system(SCRIPT)  NO LONGER NEEDED AFTER STATUS=DELETE
 
 #endif
 
@@ -315,6 +329,38 @@ C       GET CXNUMB FROM FILOUT
 @
 
 
+1.23
+log
+@email_health_dept
+@
+text
+@d4 5
+a8 5
+C NEXTVERSION.F                                                  3/2/94
+C                       ADDED CXNUMB                AUG 00 ARDEAN LEITH
+C                       NEXTRESULTS IN BIN DIR      FEB 09 ARDEAN LEITH
+C                       OUTPUT FORMATTING           AUG 14 ARDEAN LEITH
+C                       OUTPUT FORMATTING,DELETE    JAN 16 ARDEAN LEITH
+d11 1
+a11 1
+C *  AUTHOR: MAHIEDDINE LADJADJ                                            *
+d15 1
+a15 1
+C=* Copyright 1985-2016  Health Research Inc.,                         *
+d17 1
+a17 1
+C=* Email: spider@@health.ny.gov                                        *
+d92 3
+d96 3
+d100 3
+d105 2
+a150 3
+C       DELETE THE TEMP FILE.
+cc      SCRIPT = 'rm -f SPIDER_JUNK.TMP' // NULL
+cc      CALL system(SCRIPT)  NO LONGER NEEDED AFTER STATUS=DELETE
+@
+
+
 1.22
 log
 @startup msg flag
diff --git src/RCS/noise.f,v src/RCS/noise.f,v
index e0e24363..4c1af9ef 100644
--- src/RCS/noise.f,v
+++ src/RCS/noise.f,v
@@ -1,4 +1,4 @@
-head	1.28;
+head	1.29;
 access;
 symbols
 	pre_mrcs:1.28
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.29
+date	2025.11.10.22.33.34;	author dean;	state Exp;
+branches;
+next	1.28;
+
 1.28
 date	2018.10.03.14.34.11;	author leith;	state Exp;
 branches;
@@ -170,9 +175,9 @@ desc
 @
 
 
-1.28
+1.29
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -185,7 +190,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -522,6 +527,17 @@ C          PUSH Y2(I) INTO OUTPUT DOC. FILE
 @
 
 
+1.28
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.27
 log
 @simplified for 1 minimum
diff --git src/RCS/norm3.f,v src/RCS/norm3.f,v
index 376c6312..3438d68a 100644
--- src/RCS/norm3.f,v
+++ src/RCS/norm3.f,v
@@ -1,4 +1,4 @@
-head	1.19;
+head	1.23;
 access;
 symbols
 	pre_mrcs:1.18
@@ -24,6 +24,26 @@ locks; strict;
 comment	@c @;
 
 
+1.23
+date	2025.11.10.22.33.58;	author dean;	state Exp;
+branches;
+next	1.22;
+
+1.22
+date	2025.10.16.19.21.03;	author dean;	state Exp;
+branches;
+next	1.21;
+
+1.21
+date	2025.10.07.13.47.59;	author dean;	state Exp;
+branches;
+next	1.20;
+
+1.20
+date	2025.09.24.18.31.23;	author dean;	state Exp;
+branches;
+next	1.19;
+
 1.19
 date	2019.11.04.17.35.09;	author leith;	state Exp;
 branches;
@@ -125,9 +145,9 @@ desc
 @
 
 
-1.19
+1.23
 log
-@mrc_support
+@*** empty log message ***
 @
 text
 @
@@ -140,14 +160,15 @@ C           ERROR MESSAGES                         NOV 10 ArDean Leith
 C           NORMVALSP ADDED                        AUG 11 ArDean Leith
 C           NORMVALSP ADDED                        AUG 11 ArDean Leith
 C           USED SETPRMB, IMPLICIT                 JUL 19 ArDean Leith
+C           ADDED DEBUG OUTPUT                     OCT 25 ArDean Leith
 C
 C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2019  Health Research Inc.,                         *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -174,7 +195,7 @@ C        FMAX         MAXIMUM OF VOLUME                        (RET.)
 C        FMIN         MINIMUM OF VOLUME                        (RET.)
 C        AV           AVERAGE OF VOLUME                        (RET.)
 C
-C    NOTE:    THIS USES UNLABELED COMMON!!
+C    NOTE:    THIS USES LEGACY UNLABELED COMMON!!
 C             SIG RETURNED IN COMMON  (LEGACY ISSUE)
 C
 C--*********************************************************************
@@ -183,23 +204,24 @@ C--*********************************************************************
 
       IMPLICIT NONE
 
-      INTEGER          :: LUN,NX,NY,NZ
-      REAL             :: FMAX,FMIN,AV
+      INTEGER            :: LUN,NX,NY,NZ,nynz
+      REAL               :: FMAX,FMIN,AV
 
-      REAL             :: BUF        
-      COMMON BUF(1)
+      INTEGER, PARAMETER :: MAX_UNLABELED_COM = 5000000
+C     Sept 2025 al to fix for Gfort warning on threaded use
+      REAL , SAVE        :: BUF(MAX_UNLABELED_COM) ! LEGACY COMMON BLOCK
 
-      INTEGER          :: NSAMC,NROWC,IREC,NLABEL,IFORM,IMAMI,IHIST
-      REAL             :: FMAXC,FMINC,AVC,SIG
+      INTEGER            :: NSAMC,NROWC,IREC,NLABEL,IFORM,IMAMI,IHIST
+      REAL               :: FMAXC,FMINC,AVC,SIG
       COMMON /MASTER/NSAMC,NROWC,IREC,NLABEL,IFORM,IMAMI,FMAXC,FMINC,
      &                    AVC,SIG,IHIST
 
-      INTEGER          :: LUNT,NIN,NOUT
+      INTEGER            :: LUNT,NIN,NOUT
       COMMON /UNITS/LUNT,NIN,NOUT
 
-      DOUBLE PRECISION :: DAV,DAV2,DTOP,FNALL,DTEMP
-      REAL             :: B,DIFF 
-      INTEGER          :: NE,IRECT,K
+      DOUBLE PRECISION   :: DAV,DAV2,DTOP,FNALL,DTEMP
+      REAL               :: B,DIFF 
+      INTEGER            :: NE,IRECT,K
 
       FNALL = FLOAT(NX) * FLOAT(NY) * FLOAT(NZ)
       IF (FNALL <= 0) THEN
@@ -208,6 +230,12 @@ C--*********************************************************************
          RETURN
       ENDIF
 
+#if defined(SP_DBUGIO)
+      nynz = ny * nz
+      write(3,'(A,5i6)')   '  In norm3; nx,ny,nz,nynz: ',nx,ny,nz,nynz
+      write(3,'(A,f12.2)') '  In norm3; fnall: ',fnall
+#endif
+
       DAV  = 0.0
       DAV2 = 0.0
 
@@ -215,7 +243,9 @@ C--*********************************************************************
       FMAX = -FMIN
 
       DO IRECT = 1,NY*NZ
+
          CALL REDLIN(LUN,BUF,NX,IRECT)
+
          DO K = 1,NX
             B    = BUF(K)
             FMAX = MAX(B,FMAX)
@@ -226,11 +256,11 @@ C--*********************************************************************
       ENDDO
 
       AV    = DAV / FNALL
-      AVC   = AV
-      FMAXC = FMAX
-      FMINC = FMIN
+      AVC   = AV            ! SET IN COMMON /MASTER/
+      FMAXC = FMAX          ! SET IN COMMON /MASTER/
+      FMINC = FMIN          ! SET IN COMMON /MASTER/
 
-      DTOP  = DAV2 - DAV * DAV / FNALL
+      DTOP  = DAV2 - DAV * DAV / FNALL   ! NOT IN COMMON /MASTER/
 
       DIFF  = FMAX - FMIN
       IF (DIFF <= TINY(DIFF)) THEN
@@ -249,21 +279,26 @@ C        DIVISION BY ZERO
 
       ELSE
 C        CAN CALCULATE SIG
-         SIG = DSQRT( DTOP / DBLE(FNALL - 1.0))
+         SIG = DSQRT( DTOP / DBLE(FNALL - 1.0)) ! NOT IN COMMON /MASTER/
       ENDIF
 
+C     VALUES ARE SET IN COMMON BY NAME ABOVE ! SET IN COMMON /MASTER/
 
-      !write(6,*)' In norm3, before setprmb, fmin,fmax: ',fmin,fmax
 
-C     VALUES ARE SET IN COMMON BY NAME ABOVE
+#if defined(SP_DBUGIO)
+      write(3,'(A,5(2x,i6),f8.2)')
+     &     '  In norm3; lun,nx,ny,irect,k,b: ',lun,nx,ny,irect,k,b
 
-C     WRITE(3,90) FMIN,FMAX,AV,SIG
-90    FORMAT('  FMIN: ', 1PG10.3,
-     &       '  FMAX: ', 1PG10.3,
-     &       '  AV: ',   1PG12.5,
-     &       '  SIG: ',  1PG12.5)
+      write(3,90) fmin,fmax,av,sig
+90    format('  Fmin: ', 1PG10.3,
+     &       '  Fmax: ', 1PG10.3,
+     &       '  Av: ',   1PG12.5,
+     &       '  Sig: ',  1PG12.5)
 
-C     SET VALUES IN FILE HEADER
+      write(3,*)' In norm3; Calling setprmb; lun,fmax: ',lun,fmax
+#endif
+
+C     PLACE STAT VALUES IN FILE HEADER
       CALL SETPRMB(LUN,FMAX,FMIN,AV,SIG)
 
       END
@@ -662,6 +697,139 @@ C          TRAP FOR BLANK IMAGE AREA IMPRECISION
 @
 
 
+1.22
+log
+@changed debug output, added comments
+@
+text
+@d107 3
+a109 3
+      AVC   = AV            ; SET IN COMMON /MASTER/
+      FMAXC = FMAX          ; SET IN COMMON /MASTER/
+      FMINC = FMIN          ; SET IN COMMON /MASTER/
+d111 1
+a111 1
+      DTOP  = DAV2 - DAV * DAV / FNALL   ; NOT IN COMMON /MASTER/
+d130 1
+a130 1
+         SIG = DSQRT( DTOP / DBLE(FNALL - 1.0)) ; NOT IN COMMON /MASTER/
+d133 1
+a133 1
+C     VALUES ARE SET IN COMMON BY NAME ABOVE ; SET IN COMMON /MASTER/
+@
+
+
+1.21
+log
+@added debug output
+@
+text
+@d55 1
+a55 1
+      INTEGER            :: LUN,NX,NY,NZ
+d81 6
+d94 1
+d96 1
+d107 3
+a109 3
+      AVC   = AV
+      FMAXC = FMAX
+      FMINC = FMIN
+d111 1
+a111 1
+      DTOP  = DAV2 - DAV * DAV / FNALL
+d130 1
+a130 1
+         SIG = DSQRT( DTOP / DBLE(FNALL - 1.0))
+d133 1
+a133 2
+C     VALUES ARE SET IN COMMON BY NAME ABOVE
+
+a134 2
+#if defined(SP_DBUG)
+      write(3,*) '  In norm3         ---------- '
+d136 1
+d138 1
+a138 2
+     &     '  In norm3; lun,nx,ny,irect,k,b: ',
+     &                  lun,nx,ny,irect,k,b
+d141 1
+a141 1
+90    FORMAT('  Fmin: ', 1PG10.3,
+d146 1
+a146 4
+      write(3,'(A,I5,2X,F8.1,2X,F8.2)')
+     &     '  In norm3; Calling setprmb, lun,fmax: ',
+     &                                   lun,fmax
+      write(3,*)'  '
+d149 1
+a149 1
+C     SET VALUES IN FILE HEADER
+@
+
+
+1.20
+log
+@MAX_UNLABELED_COM length defined
+@
+text
+@d11 1
+d19 1
+a19 1
+C=* Email: spider@@health.ny.gov                                        *
+d59 2
+a60 1
+      REAL               :: BUF(MAX_UNLABELED_COM) ! LEGACY COMMON BLOCK
+d125 1
+a126 1
+      !write(6,*)' In norm3, before setprmb, fmin,fmax: ',fmin,fmax
+d128 2
+a129 1
+C     VALUES ARE SET IN COMMON BY NAME ABOVE
+d131 15
+a145 5
+C     WRITE(3,90) FMIN,FMAX,AV,SIG
+90    FORMAT('  FMIN: ', 1PG10.3,
+     &       '  FMAX: ', 1PG10.3,
+     &       '  AV: ',   1PG12.5,
+     &       '  SIG: ',  1PG12.5)
+@
+
+
+1.19
+log
+@mrc_support
+@
+text
+@d16 1
+a16 1
+C=* Copyright 1985-2019  Health Research Inc.,                         *
+d45 1
+a45 1
+C    NOTE:    THIS USES UNLABELED COMMON!!
+d54 2
+a55 2
+      INTEGER          :: LUN,NX,NY,NZ
+      REAL             :: FMAX,FMIN,AV
+d57 2
+a58 2
+      REAL             :: BUF        
+      COMMON BUF(1)
+d60 2
+a61 2
+      INTEGER          :: NSAMC,NROWC,IREC,NLABEL,IFORM,IMAMI,IHIST
+      REAL             :: FMAXC,FMINC,AVC,SIG
+d65 1
+a65 1
+      INTEGER          :: LUNT,NIN,NOUT
+d68 3
+a70 3
+      DOUBLE PRECISION :: DAV,DAV2,DTOP,FNALL,DTEMP
+      REAL             :: B,DIFF 
+      INTEGER          :: NE,IRECT,K
+@
+
+
 1.18
 log
 @email_health_dept
diff --git src/RCS/normas.f,v src/RCS/normas.f,v
index 629b935d..c3b9374a 100644
--- src/RCS/normas.f,v
+++ src/RCS/normas.f,v
@@ -1,4 +1,4 @@
-head	1.20;
+head	1.21;
 access;
 symbols
 	pre_mrcs:1.20
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.21
+date	2025.11.10.22.33.34;	author dean;	state Exp;
+branches;
+next	1.20;
+
 1.20
 date	2018.10.03.14.34.11;	author leith;	state Exp;
 branches;
@@ -130,9 +135,9 @@ desc
 @
 
 
-1.20
+1.21
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -145,7 +150,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -229,6 +234,17 @@ c$omp   end parallel do
 @
 
 
+1.20
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.19
 log
 @GPL_2010
diff --git src/RCS/normasc.f,v src/RCS/normasc.f,v
index d57fcc75..a20e4b3e 100644
--- src/RCS/normasc.f,v
+++ src/RCS/normasc.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -23,6 +23,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.33.34;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.11;	author leith;	state Exp;
 branches;
@@ -83,9 +88,9 @@ desc
 @@
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C
@@ -102,7 +107,7 @@ C=*                                                                    *
 C=* HEALTH RESEARCH INCORPORATED (HRI),                                *   
 C=* ONE UNIVERSITY PLACE, RENSSELAER, NY 12144-3455.                   *
 C=*                                                                    *
-C=* Email:  spider@@health.ny.gov                                       *
+C=* Email:  spider@@wadsworth.org                                       *
 C=*                                                                    *
 C=* This program is free software; you can redistribute it and/or      *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -193,6 +198,17 @@ C          TRAP FOR BLANK IMAGE AREA
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d15 1
+a15 1
+C=* Email:  spider@@health.ny.gov                                       *
+@
+
+
 1.10
 log
 @USE_OMP
diff --git src/RCS/normm.f,v src/RCS/normm.f,v
index cf86b2fb..5f2e1585 100644
--- src/RCS/normm.f,v
+++ src/RCS/normm.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.33.35;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.11;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*******************************************************************
@@ -90,7 +95,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -162,6 +167,17 @@ C--*******************************************************************
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/noyau.f,v src/RCS/noyau.f,v
index 2b283a21..3006c3d0 100644
--- src/RCS/noyau.f,v
+++ src/RCS/noyau.f,v
@@ -1,4 +1,4 @@
-head	1.27;
+head	1.28;
 access;
 symbols
 	pre_mrcs:1.27
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.28
+date	2025.11.10.22.33.35;	author dean;	state Exp;
+branches;
+next	1.27;
+
 1.27
 date	2018.10.03.14.34.11;	author leith;	state Exp;
 branches;
@@ -165,9 +170,9 @@ desc
 @
 
 
-1.27
+1.28
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -189,7 +194,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2013  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -351,6 +356,17 @@ C        TRUNCATED TREE OUTPUT APPENDED TO LUNK
 
 
 
+@
+
+
+1.27
+log
+@email_health_dept
+@
+text
+@d20 1
+a20 1
+C=* Email: spider@@health.ny.gov                                        *
 @
 
 
diff --git src/RCS/nrml.f,v src/RCS/nrml.f,v
index c33f8722..975e3d1c 100644
--- src/RCS/nrml.f,v
+++ src/RCS/nrml.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.33.35;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.11;	author leith;	state Exp;
 branches;
@@ -80,9 +85,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -95,7 +100,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -136,6 +141,17 @@ c$omp parallel do private(i)
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @GPL_2010
diff --git src/RCS/numdig.f,v src/RCS/numdig.f,v
index 954e500c..92e2ae39 100644
--- src/RCS/numdig.f,v
+++ src/RCS/numdig.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.33.35;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.34.11;	author leith;	state Exp;
 branches;
@@ -70,9 +75,9 @@ desc
 @
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -87,7 +92,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -138,6 +143,17 @@ C         MINVAL IS MINIMUM LENGTH
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @GPL_2010
diff --git src/RCS/od.f,v src/RCS/od.f,v
index 83231778..e3f83b98 100644
--- src/RCS/od.f,v
+++ src/RCS/od.f,v
@@ -1,4 +1,4 @@
-head	1.15;
+head	1.16;
 access;
 symbols
 	pre_mrcs:1.15
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.16
+date	2025.11.10.22.33.35;	author dean;	state Exp;
+branches;
+next	1.15;
+
 1.15
 date	2018.10.03.14.34.11;	author leith;	state Exp;
 branches;
@@ -105,9 +110,9 @@ desc
 @
 
 
-1.15
+1.16
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -123,7 +128,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -184,6 +189,17 @@ C--*********************************************************************
 @
 
 
+1.15
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.14
 log
 @(LEN=MAXNAM) :: FILNAM
diff --git src/RCS/opauxfile.f,v src/RCS/opauxfile.f,v
index e2649d95..fee93e52 100644
--- src/RCS/opauxfile.f,v
+++ src/RCS/opauxfile.f,v
@@ -1,4 +1,4 @@
-head	1.32;
+head	1.33;
 access;
 symbols
 	pre_mrcs:1.32
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.33
+date	2025.11.10.22.33.35;	author dean;	state Exp;
+branches;
+next	1.32;
+
 1.32
 date	2018.10.03.14.34.11;	author leith;	state Exp;
 branches;
@@ -190,9 +195,9 @@ desc
 @
 
 
-1.32
+1.33
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C **********************************************************************
@@ -213,7 +218,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2018  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -426,6 +431,17 @@ C          OPEN FILE FOR  SEQUENTIAL ACCESS
 @
 
 
+1.32
+log
+@email_health_dept
+@
+text
+@d19 1
+a19 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.31
 log
 @new  coi opauxfile.f   
diff --git src/RCS/openchk.f,v src/RCS/openchk.f,v
index b503a238..732a3a56 100644
--- src/RCS/openchk.f,v
+++ src/RCS/openchk.f,v
@@ -1,4 +1,4 @@
-head	1.18;
+head	1.19;
 access;
 symbols
 	pre_mrcs:1.18
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.19
+date	2025.11.10.22.33.35;	author dean;	state Exp;
+branches;
+next	1.18;
+
 1.18
 date	2018.10.03.14.34.11;	author leith;	state Exp;
 branches;
@@ -119,9 +124,9 @@ desc
 @@
 
 
-1.18
+1.19
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -139,7 +144,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2013  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -273,6 +278,17 @@ C        WANT TO CREATE ???? TYPE
 @
 
 
+1.18
+log
+@email_health_dept
+@
+text
+@d16 1
+a16 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.17
 log
 @prompts changed
diff --git src/RCS/opendoc.f,v src/RCS/opendoc.f,v
index f16d87b5..899a7887 100644
--- src/RCS/opendoc.f,v
+++ src/RCS/opendoc.f,v
@@ -1,4 +1,4 @@
-head	1.48;
+head	1.49;
 access;
 symbols
 	pre_mrcs:1.48
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.49
+date	2025.11.10.22.33.35;	author dean;	state Exp;
+branches;
+next	1.48;
+
 1.48
 date	2018.10.03.14.34.11;	author leith;	state Exp;
 branches;
@@ -270,9 +275,9 @@ desc
 @
 
 
-1.48
+1.49
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -293,7 +298,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2013  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -519,6 +524,17 @@ C          WRITE HEADER INTO FILE
 @
 
 
+1.48
+log
+@email_health_dept
+@
+text
+@d19 1
+a19 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.47
 log
 @NO INCORE IF IRTFLG = -8
diff --git src/RCS/openfil.f,v src/RCS/openfil.f,v
index 7df3fbb8..9bc082d2 100644
--- src/RCS/openfil.f,v
+++ src/RCS/openfil.f,v
@@ -1,4 +1,4 @@
-head	1.54;
+head	1.57;
 access;
 symbols
 	pre_mrcs:1.52
@@ -24,6 +24,21 @@ locks; strict;
 comment	@c @;
 
 
+1.57
+date	2025.10.03.14.18.26;	author dean;	state Exp;
+branches;
+next	1.56;
+
+1.56
+date	2025.09.29.14.44.36;	author dean;	state Exp;
+branches;
+next	1.55;
+
+1.55
+date	2025.09.21.15.26.05;	author dean;	state Exp;
+branches;
+next	1.54;
+
 1.54
 date	2020.01.21.16.16.54;	author leith;	state Exp;
 branches;
@@ -300,9 +315,9 @@ desc
 @
 
 
-1.54
+1.57
 log
-@comments only
+@cosmetic email removed
 @
 text
 @
@@ -323,14 +338,15 @@ C               OPENINLN INTEGER*8               OCT 2010 ArDean Leith
 C               NZ LIMITED TO 100000 BUG         JAN 2015 ArDean Leith 
 C               MRC SUPPORT                      MAY 2019 ArDean Leith
 C               OPEN ON 2 LUNS RECODED           AUG 2019 ArDean Leith
+C               FLIP FLAG IN LUNFLIP FIXED       SEP 2025 ArDean Leith
 C
 C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2019  Health Research Inc.,                         *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -410,20 +426,20 @@ C                |
 C                ? Inline stack
 C                |-------------> OPNINSTK ----> ...
 C
-C       NOTE: SHOULD NEVER BE CALL WITH MRC FILES     
+C       NOTE: SHOULD NEVER BE CALLED WITH MRC FILES     
 C
 C23456789 123456789 123456789 123456789 123456789 123456789 123456789 12
 C--*********************************************************************
 
-	SUBROUTINE OPENFIL(LUNT,FILNAM,LUNSENT,NX,NY,NZ,NSTACK,
+        SUBROUTINE OPENFIL(LUNT,FILNAM,LUNSENT,NX,NY,NZ,NSTACK,
      &                     ITYPE,DISP,KEEPEXT,IRTFLG)
 
         INCLUDE 'CMLIMIT.INC'
         INCLUDE 'CMBLOCK.INC'
         INCLUDE 'LABLOCK.INC'
 
-        INTEGER                      :: LUNARA,LUNSTK,LUNARB
-        COMMON /LUNARA/ LUNARA(100),LUNSTK(100),LUNARB(100)
+        INTEGER                      :: LUNARA,LUNSTK,LUNARB,LUNFLIP
+        COMMON /LUNARA/ LUNARA(100),LUNSTK(100),LUNARB(100),LUNFLIP(100)
 
         INTEGER                      :: LUNT,LUNSENT
         CHARACTER(LEN=*)             :: FILNAM
@@ -434,12 +450,11 @@ C--*********************************************************************
 
         CHARACTER(LEN=MAXNAM)        :: FILNM
         CHARACTER(LEN=2*MAXNAM)      :: MSG
-        CHARACTER(LEN=1)             :: NULL = CHAR(0)
         LOGICAL                      :: EX,CALLERRT,OPENED
         INTEGER, PARAMETER           :: I_8 = SELECTED_INT_KIND(12)
-	INTEGER(KIND=I_8)            :: NWORDS_8
+        INTEGER(KIND=I_8)            :: NWORDS_8
         INTEGER(KIND=I_8), PARAMETER :: ZERO_8 = 0
-        INTEGER                      :: LUN
+        INTEGER                      :: LUN,IFLIP
 
         LOGICAL                      :: IS_MRC
 
@@ -452,36 +467,36 @@ C       INCLUSION FOR OPTIONAL MPI INITIALIZATION. MAY ALTER MYPID
 C       SET FLAG FOR ERRONEOUS RETURN
         IRTFLG = 1
        
-C	CHECK IF USER WANTS TO USE THE IN-LINE BUFFER.
+C        CHECK IF USER WANTS TO USE THE IN-LINE BUFFER.
         INLNED = 0
         IF (FILNAM(1:1) == '_') THEN
-C	   USE AN IN-LINE BUFFER.
+C           USE AN IN-LINE BUFFER.
            CALL INLNBUF(FILNAM,NLET,INLNED,IRTFLGT)
            IF (IRTFLGT .NE. 0)  RETURN
 
-	   IF (DISP == 'U' .OR. DISP == 'N') THEN
-	      EX = .FALSE.
-	   ELSE
-	      EX = .TRUE.
-	   ENDIF
+           IF (DISP == 'U' .OR. DISP == 'N') THEN
+              EX = .FALSE.
+           ELSE
+              EX = .TRUE.
+           ENDIF
            FILNM = FILNAM(1:NLET)
 
         ELSE
 C          USE REGULAR FILE
            INLNED = 0
-	   LUNC   = LUN
+           LUNC   = LUN
 
 C          NULLIFY THE INLINE POINTER (CLOSEINLN IS INSIDE OPENINLN.F)
            CALL CLOSEINLN(LUN,IRTFLGT)
 
-           !write(3,*) ' In openfil, keepext,filnam:',keepext,filnam
+           !write(3,*)' In openfil, keepext,filnam:',keepext,filnam
 
            IF (KEEPEXT) THEN
               FILNM = FILNAM
               NLET  = lnblnk(FILNM)
            ELSE
               CALL FILNAMANDEXT(FILNAM,DATEXC,FILNM,NLET,.TRUE.,IRTFLGT)
-	      IF (IRTFLGT .NE.0) RETURN
+              IF (IRTFLGT .NE.0) RETURN
            ENDIF
            !write(3,*) ' In openfil, filnm: ',filnm(:nlet),disp
 
@@ -509,7 +524,7 @@ C       LUNARB(LUN) = LUN
 
         CALLERRT = (DISP(1:1) .NE. 'Z' .AND. DISP(1:1) .NE. 'E')
 
-10	IF (DISP == 'U' .OR. DISP == 'N') THEN
+10      IF (DISP == 'U' .OR. DISP == 'N') THEN
 C         USER WANTS A NEW FILE TO WRITE INTO ---------------------- NEW
 
           IF (EX) THEN
@@ -524,7 +539,7 @@ C           BE REPLACED.  OLD FILES ARE DELETED FIRST
      &         CALL BCAST_MPI('OPENFIL','IER',IER,1,'I',ICOMM)
 #endif
 
-	    IF (IER .NE. 0) THEN
+            IF (IER .NE. 0) THEN
                MSG =  'OPENFIL; DELETING FILE: ' // FILNM(1:NLET)
                CALL ERRT(101,MSG,NE)
                RETURN
@@ -544,8 +559,13 @@ C         SET FILE'S FMIN.... TO AVOID FLT. PT. ERROR ON DEC
 C         DOES NOT ALTER STATS: FMIN... IN COMMON BLOCK
           CALL LUNSETSTAT(LUN,0,0.0,0.0,0.0,0.0,IRTFLGT)
 
-	  IF (INLNED == 0) THEN
-C	     REGULAR FILE, NOT INLINE FILE
+C         SET NATIVE-ENDDEDNESS OF NEW FILE
+          IFLIP = 0  ;      
+C         CALL LUNGETFLIP(LUNT,IFLIP,IRTFLG) ! bug fixed sept 2025
+          CALL LUNSETFLIP(LUN, IFLIP,IRTFLG)
+
+          IF (INLNED == 0) THEN
+C             REGULAR FILE, NOT INLINE FILE
 
              LENREC = LENOPENFILE(NX*4)
              IF (MYPID <= 0) THEN
@@ -588,7 +608,7 @@ C            SAVE ISTACK IN NON-VOLATILE PART OF HEADER OBJECT
              CALL OPENINLN(LUN,INLNED,.TRUE.,NX,NWORDS_8,
      &                     .TRUE.,IRTFLGT)
              IF (IRTFLGT .NE. 0)  RETURN
-	  ENDIF
+          ENDIF
           !write(3,*)' In openfil,opened filnm: ', filnm(1:nlet)
 
 C         PUSH HEADER OBJECT INFO INTO NEW FILE
@@ -600,18 +620,18 @@ C         PUSH HEADER OBJECT INFO INTO NEW FILE
 
 C         --------------------------------------------------------- OLD
 
-	ELSEIF (DISP == 'O' .OR. DISP == 'K' .OR.
+        ELSEIF (DISP == 'O' .OR. DISP == 'K' .OR.
      &          DISP == 'Z' .OR. 
      &          DISP == 'E' .OR. DISP == 'M') THEN
 
 C         FILE EXISTS, AND IS ACCESSED WITH 'OLD', OPEN THE FILE
 
-	  IF (.NOT. EX) THEN
+          IF (.NOT. EX) THEN
 C            ERROR -- FILE DOES NOT EXIST, BUT BEING OPENED WITH 'OLD
              IF (MYPID <= 0)
      &          WRITE(NOUT,*) '*** FILE NOT FOUND: ',FILNM(1:NLET)
 
-C	     FOR DISP=Z, DO NOT STOP THE BATCH JOB BY CALLING ERRT
+C             FOR DISP=Z, DO NOT STOP THE BATCH JOB BY CALLING ERRT
              IF (CALLERRT) THEN
                 MSG = 'OPENFIL; FILE NOT FOUND: ' // FILNM(1:NLET)
                 CALL ERRT(101,MSG,NE)
@@ -633,10 +653,14 @@ C            SEE IF FILE ALREADY OPEN ON DIFFERENT LUN THAN CURRENT
              IF (MYPID <= 0) THEN
                 INQUIRE(FILE=FILNM(1:NLET),IOSTAT=IRTFLG,OPENED=OPENED,
      &                  NUMBER=LUNOPENED)
-
-c                write(3,*)  ' Inquire file: ',filnm(1:nlet),
-c     &                      '  Opened:',opened,' On lun:',lunopened,
-c     &                      '  Irtflg: ',irtflg  
+                   
+                !if (opened) then
+                !write(3,*) ' In openfil, Inquired: ',filnm(1:nlet)
+                !write(3,*) ' In openfil, Inquired: ',filnm(1:nlet),
+                !&                     '  Opened:',opened,' On lun:',lunopened,
+                !&                     '  Irtflg: ',irtflg  
+                !endif
+                                
              ENDIF   ! END OF: MYPID <= 0
 
 #ifdef USE_MPI
@@ -645,7 +669,7 @@ c     &                      '  Irtflg: ',irtflg
                CALL BCAST_MPI('OPENFIL','OPENED',   OPENED, 1,'L',ICOMM)
                CALL BCAST_MPI('OPENFIL','LUNOPENED',LUNOPENED,
      &                         1,'I',ICOMM)
-             ENDIF
+             ENDIF  ! END OF: (ONLYONE_RED)
 #endif
 
              IF (OPENED) THEN
@@ -657,12 +681,20 @@ C               MUST REDIRECT OLD LUNS TO CURRENT LUN BEFORE OPENING
                       CALL LUNSETLUNB(I,LUN,IRTFLG)
                    ENDIF
                 ENDDO                      
-             ENDIF
-             !write(3,*)' In openfil, lun,lunopened: ',lun,lunopened
+             ENDIF   ! END OF: IF(OPENED)
+             
+             !write(3,*)' In openfil, ------------ A ----------'
+             !write(3,*)' In openfil, lun,lunopened,mypid:',lun,lunopened,mypid
+
 
 C            NOW WE CAN OPEN THIS FILE ON LUN
              IF (MYPID <= 0) THEN
                LENREC = LENOPENFILE(256*4)  ! USED FOR SPIDER FILE
+
+               !write(3,*)  ' In openfil, ------------ B ----------'
+               !write(3,*)' In openfil, opening now on lun:',lun 
+               !write(3,*)' --------------- END OF B --------' 
+
                OPEN(LUN,FILE=FILNM(1:NLET),STATUS='OLD',
      &               ACCESS='DIRECT',
      &               FORM='UNFORMATTED',RECL=LENREC,IOSTAT=IER)
@@ -681,7 +713,12 @@ C              UNKNOWN OPENING ERROR
              ENDIF  ! END OF: IER .NE. 0 
              !write(3,*)' In openfil, filnm:', filnm(1:nlet)
 
-          ENDIF     ! END OF:  IF (INLNED .EQ. 0)
+          ENDIF   ! END OF:  IF (INLNED .EQ. )
+
+          !write(3,*)' In openfil, ------------ C ----------'
+          !write(3,*)' In openfil, callin lunredhed on lun:',lun 
+          !write(3,*)' In openfil, callin lunredhed on lun:',lun 
+          !write(3,*)' --------------- END OF C --------' 
 
 C         READ OVERALL HEADER FROM SPIDER FILE 
           CALL LUNREDHED(LUN,256,0,.TRUE.,IRTFLGT)
@@ -707,9 +744,11 @@ C         NEED NX VALUE
           CALL LUNGETSIZE(LUN,NX,NY,NZ,IRTFLGT)
           IF (IRTFLGT .NE. 0) RETURN
 
-          !write(3,*)' In openfil, nx,itype:',nx,itype
-          !print *,  'Reading header of: ',filnm(:nlet)
-          !print *,  'nx...: ',lun,nx,ny,nz,itype
+          !write(3,*)' In openfil --------------- D --------'
+          !write(3,*)' Read header of: ',filnm(:nlet)
+          !write(3,*)' In openfil, lun,itype:',lun,itype
+          !write(3,*)' In openfil, Nx...: ',lun,nx,ny,nz,itype
+          !write(3,*)' -------   END of D  -------- ' 
 
           IF (ITYPE == 0 .OR. 
      &          NX <= 0       .OR. NY <= 0       .OR. NZ <= 0 .OR.
@@ -721,11 +760,16 @@ C           FLIP BYTES IN HEADER OBJECT
             CALL LUNFLIPHDR(LUN,IRTFLGT)
             CALL LUNSETFLIP(LUN,1,IRTFLG)
 
+            !write(3,*)' In openfil --------------- E --------OK '
+            !write(3,*)' In openfil, lun,lunflip(lun):',lun,lunflip(lun)
+            !write(3,*)' --------------- END OF E --------' 
+
 C           NEED ITYPE & SIZE
             CALL LUNGETTYPE(LUN,ITYPE,IRTFLGT)
             CALL LUNGETSIZE(LUN,NX,NY,NZ,IRTFLGT)
-            IF (IRTFLGT .NE. 0) RETURN
 
+            IF (IRTFLGT .NE. 0) RETURN
+ 
             IF (ITYPE == 0 ) THEN
 C              PROBABLY NOT A SPIDER IMAGE
                IF (CALLERRT) THEN
@@ -762,7 +806,7 @@ C              PROBABLY NOT A SPIDER IMAGE
                ENDIF
                IRTFLG = 5   ! RETURN ERROR FLAG FOR NON-SPIDER IMAGE
 
-             ELSEIF (NY > 1000000) THEN
+            ELSEIF (NY > 1000000) THEN
 C              PROBABLY NOT A SPIDER IMAGE
                IF (CALLERRT) THEN
                  CALL ERRT(102,
@@ -770,34 +814,48 @@ C              PROBABLY NOT A SPIDER IMAGE
                ENDIF
                IRTFLG = 5   !RETURN ERROR FLAG FOR NON-SPIDER IMAGE
 
-             ELSEIF (NZ > 1000000) THEN
+            ELSEIF (NZ > 1000000) THEN
 C              PROBABLY NOT A SPIDER IMAGE
                IF (CALLERRT) THEN
                  CALL ERRT(102,
      &                 'INVALID HEADER, NZ (LIMIT=10000000)',NZ)
                ENDIF
                IRTFLG = 5   ! RETURN ERROR FLAG FOR NON-SPIDER IMAGE
-            ENDIF
 
+            ENDIF
+            !write(3,*)' In openfil, callerrt,irtflg:',callerrt,irtflg
+             
             IF (IRTFLG == 5) THEN
 C              RETURN ERROR FLAG FOR NON-SPIDER IMAGE
                FILNAM = FILNM(1:NLET)
                RETURN
             ENDIF 
 
+
             IF (VERBOSE) 
      &         WRITE(NOUT,*) ' NON-NATIVE BYTE ORDERED SPIDER FILE'
           ENDIF
 
+C         FIND NATIVE-ENDDEDNESS OF INPUT     
+          CALL LUNGETFLIP(LUN,IFLIPIN,IRTFLG)
+
+          !write(3,*)' In openfil --------------- F --------'
+          !write(3,'(a,4i6)')'  In openfil: lun,iflipin,: ', lun,iflipin 
+          !write(3,*)' --------------- END OF F --------' 
 
           IF (INLNED == 0) THEN
 C            REOPEN SPIDER FILE WITH FINAL RECORD LENGTH
              CLOSE(LUN)
              LENREC = LENOPENFILE(NX*4)
              IF (MYPID <= 0) THEN
-  	        OPEN(LUN,FILE=FILNM(1:NLET),STATUS='OLD',
+        
+                !write(3,*)'  7777777 In openfil: lun,filnm: ', lun,filnm
+
+                  OPEN(LUN,FILE=FILNM(1:NLET),STATUS='OLD',
      &                  FORM='UNFORMATTED',
      &                  ACCESS='DIRECT',IOSTAT=IER,RECL=LENREC)
+c               SET ENDDEDNESS OF INPUT     
+                CALL LUNSETFLIP(LUN,IFLIPIN,IRTFLG)
              ENDIF
 #ifdef USE_MPI
              IF (ONLYONE_RED) THEN
@@ -816,8 +874,16 @@ C            REOPEN SPIDER FILE WITH FINAL RECORD LENGTH
            CALL ERRT(101,MSG,NE)
            RETURN
         ENDIF    ! END OF:  (DISP == 'O' .OR. ......
+        
+        !write(3,*)' In openfil --------------- G --------'
+C       FIND NATIVE-ENDDEDNESS OF INPUT     
+        CALL LUNGETFLIP(LUN,IFLIPIN,IRTFLG)
+          
+        !write(3,'(a,4i6)')'  In openfil: lun,iflipin,: ', lun,iflipin 
+        !write(3,'(a,4i6)')'  In opfiles: lun(lun): ',lunflip(lun) 
+        !write(3,*)' --------------- END OF G LEAVING OPENFIL --------' 
 
-2000	CONTINUE
+2000        CONTINUE
 
 C       SAVE ISTACK IN NON-VOLATILE PART OF HEADER OBJECT
         CALL LUNGETISTACK(LUN,ISTACK,IRTFLGT)
@@ -851,11 +917,188 @@ C          NOT A STACK, RETURN -2
            NSTACK = -2
         ENDIF
 
-C       SET FLAG FOR NORMAL RETURN	
+C       SET FLAG FOR NORMAL RETURN        
         IRTFLG = 0
 
+        END
+
+@
+
+
+1.56
+log
+@LUNSETFLIP bug fixed
+tabs replaced
+@
+text
+@d27 1
+a27 1
+C=* Email: spider@@health.ny.gov                                        *
+a243 2
+
+
+@
+
+
+1.55
+log
+@gfort compiler changes
+getflip and setflip logic bugs fixed
+@
+text
+@d20 1
+d112 1
+a112 1
+	SUBROUTINE OPENFIL(LUNT,FILNAM,LUNSENT,NX,NY,NZ,NSTACK,
+a130 1
+        CHARACTER(LEN=1)             :: NULL = CHAR(0)
+d133 1
+a133 1
+	INTEGER(KIND=I_8)            :: NWORDS_8
+d148 1
+a148 1
+C	CHECK IF USER WANTS TO USE THE IN-LINE BUFFER.
+d151 1
+a151 1
+C	   USE AN IN-LINE BUFFER.
+d155 5
+a159 5
+	   IF (DISP == 'U' .OR. DISP == 'N') THEN
+	      EX = .FALSE.
+	   ELSE
+	      EX = .TRUE.
+	   ENDIF
+d165 1
+a165 1
+	   LUNC   = LUN
+d170 1
+a170 1
+           !write(3,*) ' In openfil, keepext,filnam:',keepext,filnam
+d177 1
+a177 1
+	      IF (IRTFLGT .NE.0) RETURN
+d205 1
+a205 1
+10	IF (DISP == 'U' .OR. DISP == 'N') THEN
+d220 1
+a220 1
+	    IF (IER .NE. 0) THEN
+d242 2
+a243 1
+          CALL LUNGETFLIP(LUNT,IFLIP,IRTFLG)
+d247 2
+a248 2
+	  IF (INLNED == 0) THEN
+C	     REGULAR FILE, NOT INLINE FILE
+d291 1
+a291 1
+	  ENDIF
+d303 1
+a303 1
+	ELSEIF (DISP == 'O' .OR. DISP == 'K' .OR.
+d309 1
+a309 1
+	  IF (.NOT. EX) THEN
+d314 1
+a314 1
+C	     FOR DISP=Z, DO NOT STOP THE BATCH JOB BY CALLING ERRT
+d337 1
+a337 1
+		!if (opened) then
+d343 1
+a343 1
+				
+d365 1
+a365 1
+	     
+d507 1
+a507 1
+	     
+d534 1
+a534 1
+  	        OPEN(LUN,FILE=FILNM(1:NLET),STATUS='OLD',
+d557 1
+a557 1
+	
+d561 1
+a561 1
+	  
+d566 1
+a566 1
+2000	CONTINUE
+d600 1
+a600 1
+C       SET FLAG FOR NORMAL RETURN	
+d603 1
+a603 1
 	END
+@
+
+
+1.54
+log
+@comments only
+@
+text
+@d19 1
+a19 1
+C
+d24 1
+a24 1
+C=* Copyright 1985-2019  Health Research Inc.,                         *
+d106 1
+a106 1
+C       NOTE: SHOULD NEVER BE CALL WITH MRC FILES     
+d118 2
+a119 2
+        INTEGER                      :: LUNARA,LUNSTK,LUNARB
+        COMMON /LUNARA/ LUNARA(100),LUNSTK(100),LUNARB(100)
+d135 1
+a135 1
+        INTEGER                      :: LUN
+d240 6
+d335 8
+a342 4
+
+c                write(3,*)  ' Inquire file: ',filnm(1:nlet),
+c     &                      '  Opened:',opened,' On lun:',lunopened,
+c     &                      '  Irtflg: ',irtflg  
+d351 1
+a351 1
+             ENDIF
+d363 5
+a367 2
+             ENDIF
+             !write(3,*)' In openfil, lun,lunopened: ',lun,lunopened
+d372 5
+d395 6
+a400 1
+          ENDIF     ! END OF:  IF (INLNED .EQ. 0)
+d426 5
+a430 3
+          !write(3,*)' In openfil, nx,itype:',nx,itype
+          !print *,  'Reading header of: ',filnm(:nlet)
+          !print *,  'nx...: ',lun,nx,ny,nz,itype
+d442 4
+d449 1
+d451 1
+a451 1
 
+d488 1
+a488 1
+             ELSEIF (NY > 1000000) THEN
+d496 1
+a496 1
+             ELSEIF (NZ > 1000000) THEN
+d503 1
+d505 2
+a506 1
+
+d513 1
+d518 6
+d530 3
+d536 2
+d556 8
 @
 
 
diff --git src/RCS/openfil_mrc.f,v src/RCS/openfil_mrc.f,v
index 7aa3fffa..938cfc80 100644
--- src/RCS/openfil_mrc.f,v
+++ src/RCS/openfil_mrc.f,v
@@ -1,10 +1,35 @@
-head	1.11;
+head	1.16;
 access;
 symbols;
 locks; strict;
 comment	@c @;
 
 
+1.16
+date	2025.11.10.22.33.56;	author dean;	state Exp;
+branches;
+next	1.15;
+
+1.15
+date	2025.10.25.15.36.34;	author dean;	state Exp;
+branches;
+next	1.14;
+
+1.14
+date	2025.10.16.19.46.48;	author dean;	state Exp;
+branches;
+next	1.13;
+
+1.13
+date	2025.09.26.17.18.40;	author dean;	state Exp;
+branches;
+next	1.12;
+
+1.12
+date	2025.09.26.13.55.32;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2020.07.01.14.10.07;	author leith;	state Exp;
 branches;
@@ -65,22 +90,25 @@ desc
 @@
 
 
-1.11
+1.16
 log
-@HACK TO HANDLE .mrcs files with bad NZ (REMOVED[D
+@*** empty log message ***
 @
 text
-@C++*********************************************************************
+@C***********************************************************************
 C
 C OPENFIL_MRC.F ADAPTED FROM OPENFIL             MAY 2019 ArDean Leith
+C               BUGS FIXED lnblnkn               SEP 2025 ArDean Leith 
+C               DEBUG OUTPUT                     OCT 2025 ArDean Leith
+C               REMOVED  GETMRCIMGNUM            OCT 2025 ArDean Leith
 C
 C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2020  Health Research Inc.,                         *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -96,30 +124,31 @@ C=* along with this program. If not, see <http://www.gnu.org/licenses> *
 C=*                                                                    *
 C **********************************************************************
 C
-C  OPENFIL_MRC(LUNT,FILNAM_AT,NLET,NX,NY,NZ,NSTACK, ITYPE,DSP,IRTFLG
+C  OPENFIL_MRC(LUNT,FILNAM,NLET,NX,NY,NZ, NSTK_FLG, ITYPE,DSPT,IRTFLG
 C
-C  PURPOSE:       OPEN NEW OR OLD MRC DATA FILE FOR RANDOM 
-C                 ACCESS READING/WRITING.  
+C  PURPOSE:        OPEN NEW OR OLD MRC DATA FILE FOR RANDOM ACCESS(IO)
+C                  ONLY USED IN: OPFILEC!
 C
 C  PARAMETERS:
-C        LUNT       UNIT NUMBER FOR FILNAM_AT                   (SENT)
-C        FILNAM_AT  FULL FILE NAME (STACKS HAVE @@)              (SENT)
-C        NX,NY,NZ   DIMENSIONS OF IMAGE                 (SENT OR RET.)
-C        NSTACK     STACK INDICATOR                      (SENT / RET.)
-C                     ON INPUT: 
-C                        FOR NEW FILE  0 : NOT A STACK, 
-C                                     >0 : STACK
-C                     ON OUTPUT: 
-C                        <0 :  NOT A STACK 
-C               ????     =0 :  BARE STACK (NO IMAGE SPECIFIED)????
-C                        >0 :  CURRENT STACK SIZE
+C        LUNT      UNIT NUMBER FOR FILNAM                       (SENT)
+C        FILNAM    FULL FILE NAME                      
+C                    (STACKS HAVE @@ EXCEPT FOR MRCS)            (SENT)
+C
+C        NX,NY,NZ  DIMENSIONS OF IMAGE/VOL               (SENT OR RET)
+C
+C        NSTK_FLG  STACK INDICATOR  (NOT SENT)                   (RET)
+C                  ON OUTPUT: 
+C                     -2 :  NOT A STACK   (NO @@)
+C                     -1 :  AST FOR NSTK  (@@* or *@@)   
+C                     =0 :  BARE STACK (NO IMAGE SPECIFIED)
+C                     >0 :  CURRENT STACK SIZE
 C 
-C        ITYPE      SPIDER FILE TYPE SPECIFIER.                 (RET.)
-C        DSPT       CHARACTER VAR. CONTAINING DISPOSITION       (SENT)
+C        ITYPE     SPIDER FILE TYPE SPECIFIER.                   (RET)
+C        DSPT      CHAR VAR. CONTAINING DISPOSITION             (SENT)
 C     
-C        IRTFLG     ERROR RETURN FLAG.                          (RET.)
-C                     0 : NORMAL RETURN
-C                     1 : ERROR RETURN
+C        IRTFLG    ERROR RETURN FLAG.                            (RET)
+C                    0 : NORMAL RETURN
+C                    1 : ERROR RETURN
 C  VARIABLES:
 C
 C  CALL TREE:   
@@ -129,7 +158,7 @@ C
 C23456789 123456789 123456789 123456789 123456789 123456789 123456789 12
 C--*********************************************************************
 
-      SUBROUTINE OPENFIL_MRC(LUNT,FILNAM_AT,NLET,NX,NY,NZ,NSTACK,
+      SUBROUTINE OPENFIL_MRC(LUNT,FILNAM,NLET,NX,NY,NZ, NSTK_FLG,
      &                       ITYPE, DSPT,IRTFLG)
 
       IMPLICIT NONE
@@ -137,23 +166,28 @@ C--*********************************************************************
       INCLUDE 'CMBLOCK.INC'
       INCLUDE 'CMLIMIT.INC'
 
-      CHARACTER(LEN=*)        :: FILNAM_AT
-      INTEGER                 :: LUNT,NLET, NX,NY,NZ,NSTACK,ITYPE
+      CHARACTER(LEN=*)        :: FILNAM
+      INTEGER                 :: LUNT,NLET, NX,NY,NZ,NSTK_FLG,ITYPE
       INTEGER                 :: IRTFLG
       CHARACTER(LEN=1)        :: DSP,DSPT
 
-      CHARACTER (LEN=MAXNAM)  :: FILNAM
-      INTEGER                 :: LUN,NE,I,MAXIM
+      CHARACTER(LEN=MAXNAM)   :: FIL_NOAT,FIL_DIRS,FIL_BASE
+      CHARACTER(LEN=4)        :: FIL_EXT
+      INTEGER                 :: LOCAT, LOCAST, IMGNUM,NSTK_MAX
+      LOGICAL                 :: IS_MRC,IS_STK,ISBARESTK
+ 
+      INTEGER                 :: LUN,NE,I,MAXIM,ilent
       CHARACTER(LEN=2)        :: DISP
       CHARACTER(LEN=4)        :: CAXIS
 
       INTEGER                 :: MRCMODE
       REAL                    :: SCALEX,SCALEY,SCALEZ
       LOGICAL                 :: ISBARE,EX,ISOPEN
-      INTEGER                 :: IMGNUM,LOCAT,LUNOP,LENT 
-      LOGICAL                 :: WANTUL,ISMRCSFILE
+      INTEGER                 :: LUNOP,LENT,IMGNUMT,MZT
+      LOGICAL                 :: WANTUL
 
-      LOGICAL                 :: ISDIGI,lnblnkn  ! FUNCTIONS
+      LOGICAL                 :: ISDIGI   ! FUNCTIONS
+      INTEGER                 :: lnblnkn  ! FUNCTIONS  
 
 
 C     WANT TO OPEN OLD OR NEW MRC FILE FOR STREAM ACCESS
@@ -161,101 +195,226 @@ C     WANT TO OPEN OLD OR NEW MRC FILE FOR STREAM ACCESS
       LUN = LUNT
       DSP = DSPT      ! MAY BE ALTERED BELOW
 
-C     ALL MRC STACKS WILL HAVE AN @@ IN NAME
-      LOCAT = INDEX(FILNAM_AT,'@@')
-       
-
-      IF (LOCAT <= 0) THEN
-C        NOT SPECIFIED AS A STACK
-         IMGNUM = -1
-         NSTACK = -2
-         FILNAM = FILNAM_AT      
-      ELSE
-C        GET STACKED IMAGE NUMBER (ZERO IF BARESTACK)
-C        OUTPUTS IMGNUM    0 : BARE STACK
-C                         -1 : NOT A STACK   (NO @@)
-C                         >1 : STACKED IMAGE NUMBER
-
-         CALL GETMRCIMGNUM(FILNAM_AT,LOCAT, FILNAM,IMGNUM,IRTFLG)
-         IF (IRTFLG .NE. 0) RETURN
 
-         NSTACK = 1
-         IF (IMGNUM > 0) NSTACK = IMGNUM
-         !write(3,*)' In openfil_mrc - imgnum,nstack:',imgnum,nstack
-
-      ENDIF
-      !write(3,*)' In openfil_mrc, filnam :',filnam
+#if defined(SP_DBUGIO)
+      !ilent = len(filnam)
+      !write(3,*)' In openfil_mrc, ilent for filnam: ',ilent
+      !ilent = len(fil_noat)
+      !write(3,*)' In openfil_mrc, ilent for fil_noat: ',ilent
+      if (dsp == 'N') then
+         write(3,*)' In openfil_mrc, nx,ny,nz: ',nx,ny,nz
+         write(3,*)' '
+      endif
+#endif
+
+C     GET_FILNAM_NSTK RETURNS NSTK_FLG AND OTHER STACK INFO
+C                  -2 :  NOT A STACK   (NO @@)
+C                  -1 :  AST FOR NSTK  (@@* or *@@)   
+C                   0 :  BARE STACK    (@@ OR MRCS WITHOUT @@)
+C                  >0 :  STACKED IMAGE NUMBER
+
+      CALL GET_FILNAM_NSTK(FILNAM,FIL_NOAT,FIL_DIRS,FIL_BASE,FIL_EXT,
+     &                     IS_MRC,LOCAST, IS_STK ,NSTK_FLG, IRTFLG)
+
+#if defined(SP_DBUGIO)
+      write(3,*)' In openfil_mrc, get_filnam_nstk returned ----------'
+      write(3,*)' In openfil_mrc; got is_mrc,locast: ',is_mrc,locast
+      write(3,*)' In openfil_mrc; got is_stk,nstk_flg: ',is_stk,nstk_flg
+      ilent = len(fil_noat)
+      write(3,*)' In openfil_mrc; got fil_noat: ',fil_noat(:ilent)
+      write(3,*) '  '
+#endif
       
 C     CREATE A MRC HEADER OBJECT FOR THIS LUN (CAN REUSE EXISTING)
       CALL LUNNEWHED_MRC(LUN,IRTFLG)
       IF (IRTFLG .NE. 0) RETURN
-
-C     PUT FILENAME AND DSP IN STATIC AREA OF THE HEADER OBJECT
-      CALL LUNSETFILE_MRC(LUN,FILNAM,DSP,IRTFLG)
-      IF (IRTFLG .NE. 0) RETURN
-
-c     PUT ISBARE IN STATIC (OFF-FILE) AREA OF THE HEADER OBJECT
-      ISBARE = (IMGNUM == 0)
+          
+C     PUT ISBARE IN STATIC (OFF-FILE) AREA OF THE HEADER OBJECT
+      ISBARE = (NSTK_FLG == 0)
       CALL LUNSETISBARE_MRC(LUN,ISBARE,IRTFLG)
       IF (IRTFLG .NE. 0) RETURN
 
       EX = .FALSE.
-      IF (DSP == 'N' .AND. LOCAT > 0) THEN
+      IF (DSP == 'N') THEN
 C        MAY BE OPENING A NEW IMAGE IN AN EXISTING STACK?
 C        SEE IF THE MRC STACK ALREADY EXISTS
          INQUIRE(FILE=FILNAM,EXIST=EX,OPENED=ISOPEN,NUMBER=LUNOP)
-      ENDIF
 
-      IF (DSP == 'O' .OR. (DSP == 'N' .AND. EX)) THEN
-C        OPEN AN ALREADY EXISTING MRC FILE
-         CALL OPENFIL_O_MRC(LUN,FILNAM,NLET,DSP,IMGNUM,
-     &                      NX,NY,NZ,NSTACK,  IRTFLG)
+         IF (ISOPEN .AND. LUNOP .NE. LUN) THEN
+            LENT = lnblnkn(FILNAM)
+            WRITE(NOUT,98) LUN,FILNAM(:LENT),LUNOP
+98          FORMAT('  *** ERROR FILE: ',A, 
+     &             ' ALREADY OPEN ON UNIT: ',I3)
+            IRTFLG = 1
+            RETURN
+         ENDIF
+      ENDIF
 
-C        HACK TO HANDLE .mrcs files with bad NZ (REMOVED 6/30/20) al
+      IF (DSP == 'O' .OR. (DSP == 'N' .AND. EX)) THEN  !-----------
+C        OPEN AN ALREADY EXISTING MRC FILE, RETURNS NSTK_FLG
+
+#if defined (SP_DBUGIO)
+         write(3,*)' In openfil_mrc; B4 openfil_o_mrc -------'
+#endif
+
+         IMGNUM = 0    ! NOT USED
+C        NSTK_FLG      IS NOT NEEDED BY OR SENT TO: OPENFIL_O_MRC ???
+         CALL OPENFIL_O_MRC(LUN,FIL_NOAT,NLET,DSP,IMGNUM,
+     &                     NX,NY,NZ, NSTK_FLG,IRTFLG)
+
+#if defined (SP_DBUGIO)
+        !ilent = lnblnkn(fil_noat)
+        !write(3,*)' Back openfil_mrc; fil_noat: ',fil_noat(:ilent)
+         write(3,*)' Back in openfil_mrc; imgnum, nz:', 
+     &                                    imgnum, nz
+         write(3,*)' Back in openfil_mrc; nstk_flg,irtflg:', 
+     &                                    nstk_flg,irtflg
+         write(3,*)' Back in openfil_mrc; Calling lungetstk_mrc '
+         write(3,*)'  '
+#endif
+
+         CALL LUNGETSTK_MRC(LUN,MZT,NSTK_MAX,IMGNUMT,IRTFLG)
     
-         !write(3,*)' In openfil_mrc, after openfil_o_mrc irtflg:',irtflg
-         !write(3,*)' In openfil_mrc, after openfil_o_mrc filnam:',filnam
-         !write(3,*)' In openfil_mrc, after openfil_o_mrc imgnum:',imgnum
-         !write(3,*)' In openfil_mrc, nstack: ',nstack
-         !write(3,*)' In openfil_mrc - nz,nstack:', nz,nstack
+#if defined (SP_DBUGIO)
+         write(3,*)' Back in openfil_mrc; mzt,imgnum: ',mzt,imgnum
+         write(3,*)' Back in openfil_mrc; nstk_max,irtflg: ',
+     &                                    nstk_max,irtflg
+#endif
+
+         IF (NSTK_MAX > 0) THEN
+            NSTK_MAX = MAX(IMGNUM,NSTK_MAX)   ! USED BELOW
+         ENDIF
 
-      ELSEIF (DSP == 'N') THEN
-C        OPEN AND INITIALIZE A NEW MRC FILE
+#if defined (SP_DBUGIO)
+         write(3,*)' In openfil_mrc; nstk_max: ', nstk_max
+         write(3,*)' '
+#endif
 
-         SCALEX  = 1.0    ! ?????????
-         SCALEY  = 1.0
-         SCALEZ  = 1.0
-         MRCMODE = 2      ! USE 32 BIT REALS ALWAYS FOR NOW???
-         
-         CALL OPENFIL_N_MRC(LUN,FILNAM,
+
+      ELSEIF (DSP == 'N') THEN  !---------------------------------
+C        OPEN AND INITIALIZE A NEW MRC FILE AND IMAGE
+
+         SCALEX   = 1.0    ! ?????????
+         SCALEY   = 1.0
+         SCALEZ   = 1.0
+         MRCMODE  = 2      ! USE 32 BIT REALS ALWAYS FOR NOW???
+
+         IMGNUM   = 1
+         IF (NSTK_FLG > 0) IMGNUM = NSTK_FLG
+         NSTK_MAX = IMGNUM
+
+
+#if defined (SP_DBUGIO)
+         ilent = lnblnkn(fil_noat)
+         write(3,*)' In openfil_mrc, B4 openfil_n_mrc; ilent: ',ilent 
+
+         write(3,*)' In openfil_mrc, B4 openfil_n_mrc; fil_noat: ',
+     &                                           fil_noat(:ilent)
+
+         write(3,*)' In openfil_mrc, B4 openfil_n_mrc; nz,nstk_flg: ',
+     &                                                 nz,nstk_flg
+#endif
+
+         CALL OPENFIL_N_MRC(LUN,FIL_NOAT,
      &                      MRCMODE,
-     &                      NX,NY,NZ,NSTACK,
+     &                      NX,NY,NZ, NSTK_FLG,
      &                      SCALEX,SCALEY,SCALEZ,IRTFLG)
-      ENDIF
+
+         NSTK_MAX = MAX(IMGNUM,NSTK_MAX)
+
+#if defined (SP_DBUGIO)
+         write(3,*) '      '
+         write(3,*)' In openfil_mrc; nstk_flg:      ',nstk_flg 
+         write(3,*)' In openfil_mrc; irtflg,imgnum: ',irtflg,imgnum 
+         write(3,*)' In openfil_mrc; nstk_max       ', nstk_max 
+#endif
+
+      ENDIF     !--------------------------------------------
+
       IF (IRTFLG .NE. 0) RETURN
 
-C     SET IMGNUM AND NSTACK IN STATIC AREA OF FILE HEADER
-      CALL LUNSETSTK_MRC(LUN,IMGNUM,NSTACK,IRTFLG)
+
+
+
+
+#if defined (SP_DBUGIO)
+      write(3,*) '     '
+      ilent = lnblnkn(filnam)
+      write(3,*)' In openfil_mrc, filnam:           ',filnam(:ilent)
+      write(3,*)' In openfil_mrc; nstk_flg:         ',nstk_flg 
+      write(3,*)' In openfil_mrc; irtflg,imgnum:    ',imgnum 
+      write(3,*)' In openfil_mrc; nstk_max          ', nstk_max 
+#endif
+
+C     SET IMGNUM AND NSTK_MAX IN STATIC AREA OF FILE HEADER
+      CALL LUNSETSTK_MRC(LUN,IMGNUM,NSTK_MAX,IRTFLG)
       IF (IRTFLG .NE. 0) RETURN
      
-C     SET AXIS ORIGIN LOCATION & VOLUME HANDEDNESS BEFORE LUNSETPOS_MRC
-      CALL WHICH_HAND_MRC(LUN,FILNAM,CAXIS,IRTFLG)
+#if defined (SP_DBUGIO)
+      write(3,*)' In openfil_mrc;  After lunsetstk_mrc ' 
+#endif
 
-C     SET READ/WRITE FILE OFFSETS FOR THIS IMAGE IN LUN COMMON 
-      CALL LUNSETPOS_MRC(LUN,IMGNUM,IRTFLG)
-      IF (IRTFLG .NE. 0) RETURN
+C     IF (FCHAR(1:2) .NE.  '31' .AND. FCHAR(4:5) .NE.  'HE') THEN
+C     IF (FCHAR(1:2) .NE.  '31') THEN
+C     IF (FCHAR(4:5) .NE.  'HE') THEN
+C
+      IF ((FCHAR(1:2) == '31' .AND. FCHAR(4:5) == 'HE') .OR.
+     &    (FCHAR(4:9) == 'FROM M')) THEN 
+
+C        DO NOT WRITE HEADER INTO FILE, JUST SET READ/WRITE POSITION
+         CALL LUNSET_HEDPOS_MRC(LUN,IRTFLG)
+      
+#if defined (SP_DBUGIO)
+         write(3,*)  ' '
+         write(3,*)' In openfil_mrc; After lunset_hedpos_mrc  '
+         write(3,*) '  '
+#endif
+         IF (IRTFLG .NE. 0) THEN
+            LENT = lnblnkn(FILNAM)
+            WRITE(NOUT,99) IRTFLG,LUN,FILNAM(:LENT)
+99          FORMAT( '  *** ERROR(',I4,') ON UNIT: ',I3,' FILE: ',A)
+            RETURN
+         ENDIF
+
+      ELSE
+
+C        SET AXIS ORIGIN LOCATION & VOLUME HANDEDNESS BEFORE SETPOS
+         CALL WHICH_HAND_MRC(LUN,FIL_NOAT,CAXIS,IRTFLG)
+         IF (IRTFLG .NE. 0) RETURN
+
+#if defined (SP_DBUGIO)
+         write(3,*)  '  '
+         write(3,*)' In openfil_mrc; After which_hand_mrc '
+         ilent = lnblnkn(fil_noat)
+         write(3,*)' In openfil_mrc, fil_noat: ',fil_noat(:ilent)
+         write(3,*)' In openfil_mrc, caxis:    ',caxis
+#endif
+
+C        SET READ/WRITE FILE OFFSETS FOR THIS IMAGE IN LUN COMMON 
+         CALL LUNSETPOS_MRC(LUN,NSTK_FLG,IRTFLG)
+         IF (IRTFLG .NE. 0) RETURN
+
+#if defined (SP_DBUGIO)
+         write(3,*)  ' '
+         write(3,*)' In openfil_mrc; After lunsetpos_mrc  '
+         write(3,*) '  '
+#endif
 
-      IF (FCHAR(1:2) .NE.  '31' .OR. FCHAR(4:5) .ne.  'HE') THEN
 C        WRITE HEADER INTO FILE TO PRESERVE ANY ALTERED VALUES
          CALL LUNWRTHED_MRC(LUN,IRTFLG)
+
          IF (IRTFLG .NE. 0) THEN
             LENT = lnblnkn(FILNAM)
             WRITE(NOUT,99) IRTFLG,LUN,FILNAM(:LENT)
-99          FORMAT( '  *** ERROR(',I4,') ON UNIT: ',I3,' FILE: ',A)
             RETURN
          ENDIF
       ENDIF
 
+  
+#if defined (SP_DBUGIO)
+      write(3,*)' In openfil_mrc; After lunwrthed_mrc ' 
+      write(3,*)' ' 
+#endif
 
 C     GET IMAGE TYPE (2D/3D or FOURIER) (RETURNED TO CALLER)
       CALL LUNGETTYPE_MRC(LUN,ITYPE,IRTFLG)
@@ -266,18 +425,219 @@ C     PUT COMMON VALUES INTO COMMON AREA (NOT NEEDED IN FUTURE?)
       IF (IRTFLG .NE. 0) RETURN
 
 C     WRITE FILE OPENING INFO TO RESULTS/TERMINAL
+
+      !!!!!!!!!!!NSTK_FLG = IMGNUM
+
+#if defined (SP_DBUGIO)
+      write(3,*)' In openfil_mrc; imgnum,nstk_flg: ',
+     &                            imgnum,nstk_flg 
+      write(3,*)' In openfil_mrc; Call lunsayinfo_mrc; lun: ',lun
+      write(3,*)' '
+#endif
+
       CALL LUNSAYINFO_MRC(LUN,.TRUE.,IRTFLG)
       
 C     SET FLAG FOR NORMAL RETURN	
       IRTFLG = 0
 
-      !write(6,*)' In openfil_mrc, ret. itype,iform: ',itype,iform
-      !write(3,*)' In openfil_mrc, ret. irtflg: ',irtflg
+#if defined (SP_DBUGIO)
+       write(3,*)'    '
+       write(3,*)' LEAVING openfil_mrc; imgnum,nstk_flg : ',
+     &                                  imgnum,nstk_flg  
+#endif
       
       END
 
 
-C     ------------------- GETMRCIMGNUM ---------------------------------
+C     ------------------------- ISMRCFILE  ----------------------------
+
+ 
+       LOGICAL FUNCTION ISMRCFILE(FILNAM)
+
+       IMPLICIT NONE
+
+       CHARACTER(LEN=*) :: FILNAM
+
+       INTEGER          :: NLETI
+       INTEGER          :: lnblnk
+
+       NLETI = lnblnk(FILNAM)
+
+C      IF IT IHAS .MRC, .MRCS, OR .MAP IT IS LIKELY TO BE MRC FILE 
+       ISMRCFILE = (INDEX(FILNAM(1:NLETI),'.MRC') > 0 .OR.
+     &              INDEX(FILNAM(1:NLETI),'.mrc') > 0  .OR.
+     &              INDEX(FILNAM(1:NLETI),'.map') > 0 .OR.
+     &              INDEX(FILNAM(1:NLETI),'.MAP') > 0)
+
+       END
+
+
+@
+
+
+1.15
+log
+@defined (SP_DBUGIO)
+altered stack name handling
+@
+text
+@d1 1
+a1 1
+C++*********************************************************************
+d4 3
+a6 2
+C                       BUGS FIXED lnblnkn       SEP 2025 ArDean Leith 
+C                       DEBUG OUTPUT             OCT 2025 ArDean Leith
+d30 1
+a30 1
+C  OPENFIL_MRC(LUNT,FILNAM,NLET,NX,NY,NZ,NSTK, ITYPE,DSP,IRTFLG
+d32 2
+a33 2
+C  PURPOSE:       OPEN NEW OR OLD MRC DATA FILE FOR RANDOM 
+C                 ACCESS READING/WRITING.  
+d36 12
+a47 11
+C        LUNT       UNIT NUMBER FOR FILNAM                   (SENT)
+C        FILNAM     FULL FILE NAME (STACKS HAVE @@)           (SENT)
+C        NX,NY,NZ   DIMENSIONS OF IMAGE                  (SENT OR RET.)
+C        NSTK       STACK INDICATOR                      (SENT / RET.)
+C                     ON INPUT: 
+C                        FOR NEW FILE  0 : NOT A STACK, 
+C                                     >0 : STACK
+C                     ON OUTPUT: 
+C                        <0 :  NOT A STACK 
+C               ????     =0 :  BARE STACK (NO IMAGE SPECIFIED)????
+C                        >0 :  CURRENT STACK SIZE
+d49 2
+a50 2
+C        ITYPE      SPIDER FILE TYPE SPECIFIER.                 (RET.)
+C        DSPT       CHARACTER VAR. CONTAINING DISPOSITION       (SENT)
+d52 3
+a54 3
+C        IRTFLG     ERROR RETURN FLAG.                          (RET.)
+C                     0 : NORMAL RETURN
+C                     1 : ERROR RETURN
+d64 1
+a64 1
+      SUBROUTINE OPENFIL_MRC(LUNT,FILNAM,NLET,NX,NY,NZ,NSTK,
+d73 1
+a73 1
+      INTEGER                 :: LUNT,NLET, NX,NY,NZ,NSTK,ITYPE
+d80 1
+a80 1
+      LOGICAL                 :: ISMRC,ISBARESTK
+d82 1
+a82 1
+      INTEGER                 :: LUN,NE,I,MAXIM,iend
+d89 1
+a89 1
+      INTEGER                 :: LUNOP,LENT 
+a100 21
+C     GETS NSTK STACK: IMG NUMBER FROM FILE NAME 
+C                  -2 :  AST IN STACK   
+C                  -1 :  NOT A STACK   (NO @@)
+C                   0 :  BARE STACK
+C                  >1 :  STACKED IMAGE NUMBER
+
+      CALL GET_IMG_STK(FILNAM,FIL_NOAT,FIL_DIRS,FIL_BASE,FIL_EXT,
+     &                ISMRC,LOCAST,NSTK,IRTFLG)
+
+#if defined (SP_DBUGIO)
+      iend = lnblnkn(fil_noat)
+      write(3,*)' In openfil_mrc; fil_noat: ',    fil_noat(1:iend)
+      iend = lnblnkn(fil_noat)
+      write(3,*)' In openfil_mrc; fil_dirs: ',    fil_dirs(1:iend)
+      iend = lnblnkn(fil_noat)
+      write(3,*)' In openfil_mrc; fil_base: ',    fil_base(1:iend)
+      iend = lnblnkn(fil_noat)
+      write(3,*)' In openfil_mrc; fil_ext: ',     fil_ext(1:iend)
+      write(3,*)' In openfil_mrc; ismrc,locast: ',ismrc,locast
+      write(3,*)' In openfil_mrc; nstk,irtflg:  ',nstk,irtflg
+#endif      
+d102 29
+d134 3
+a136 7
+
+C     PUT FILENAME AND DSP IN STATIC AREA OF THE HEADER OBJECT
+      CALL LUNSETFILE_MRC(LUN,FILNAM,DSP,IRTFLG)
+      IF (IRTFLG .NE. 0) RETURN
+
+c     PUT ISBARE IN STATIC (OFF-FILE) AREA OF THE HEADER OBJECT
+      ISBARE = (NSTK == 0)
+d145 9
+d156 2
+a157 2
+      IF (DSP == 'O' .OR. (DSP == 'N' .AND. EX)) THEN
+C        OPEN AN ALREADY EXISTING MRC FILE
+d160 1
+a160 1
+         write(3,*)' In openfil_mrc; Calling openfil_o_mrc -------'
+d163 4
+a166 2
+         CALL OPENFIL_O_MRC(LUN,FIL_NOAT,NLET,DSP,NSTK,
+     &                     NX,NY,NZ,NSTK,IRTFLG)
+d168 10
+a177 2
+         NSTK_MAX = 1
+         IF (NSTK > 1) NSTK_MAX = NSTK
+d179 1
+a179 1
+C        HACK TO HANDLE .mrcs files with bad NZ (REMOVED 6/30/20) al
+d182 3
+a184 5
+      write(3,*)' In openfil_mrc, After openfil_o_mrc; irtflg: ',irtflg
+      write(3,*)' In openfil_mrc, After openfil_o_mrc; fil_noat:',
+     &                                                 fil_noat
+      write(3,*)' In openfil_mrc, After openfil_o_mrc; nz,nstk: ',
+     &                                                 nz,nstk
+d187 12
+a198 2
+      ELSEIF (DSP == 'N') THEN
+C        OPEN AND INITIALIZE A NEW MRC FILE
+d204 1
+d206 3
+a208 1
+         NSTK_MAX = 1
+d211 8
+a218 4
+      write(3,*)' In openfil_mrc, B4 openfil_n_mrc; fil_noat:',
+     &                                              fil_noat
+      write(3,*)' In openfil_mrc, B4 openfil_n_mrc; nz,nstk: ',
+     &                                                 nz,nstk
+d223 1
+a223 1
+     &                      NX,NY,NZ,NSTK,
+d225 11
+a235 1
+      ENDIF
+d239 14
+a252 1
+C     SET IMGNUM AND NSTK IN STATIC AREA OF FILE HEADER
+d255 44
+a298 3
+    
+C     SET AXIS ORIGIN LOCATION & VOLUME HANDEDNESS BEFORE LUNSETPOS_MRC
+      CALL WHICH_HAND_MRC(LUN,FILNAM,CAXIS,IRTFLG)
+d300 5
+a304 3
+C     SET READ/WRITE FILE OFFSETS FOR THIS IMAGE IN LUN COMMON 
+      CALL LUNSETPOS_MRC(LUN,NSTK,IRTFLG)
+      IF (IRTFLG .NE. 0) RETURN
+a305 1
+      IF (FCHAR(1:2) .NE.  '31' .OR. FCHAR(4:5) .NE.  'HE') THEN
+a311 1
+99          FORMAT( '  *** ERROR(',I4,') ON UNIT: ',I3,' FILE: ',A)
+d316 6
+d332 7
+a338 2
+#if defined (SP_DBUG)
+      write(3,*)' In openfil_mrc; Calling lunsayinfo_mrc; lun: ',lun
+a344 37
+      
+      END
+
+#ifdef NEVER
+C     ------------------- GETMRCIMGNUM --------------------------------
 
       SUBROUTINE GETMRCIMGNUM(FILNAM_AT,LOCAT, FILNAM,IMGNUM,IRTFLG)
 
@@ -293,36 +653,72 @@ C                   >1  :  STACKED IMAGE NUMBER
       CHARACTER(LEN=*)    :: FILNAM_AT,FILNAM
       INTEGER             :: NLET,NSTACK,IMGNUM,MAXIM,IRTFLG
 
+      CHARACTER (LEN=MAXNAM) :: FILNAM_BASE, FIL_NOAT
+
       INTEGER             :: LOCAT,LOCSLASH,NLEN,NDIGITS,IGO  
 
-      LOGICAL             :: ISDIGI,lnblnkn
+      LOGICAL             :: ISDIGI 
+      INTEGER             :: lnblnkn
+
+      CHARACTER(LEN=MAXNAM) :: FIL_DIRS,FIL_BASE,FIL_EXT
+      LOGICAL               :: ISMRC,ISBARESTK
+      INTEGER               :: IMG_INSTK
+
 
 
 C     IF PRESENT, EXTRACT STACK FILENAME AND NUMBER e.g. 056@@file.mrcs
 
       LOCAT = INDEX(FILNAM_AT,'@@')
       NLEN  = lnblnkn(FILNAM_AT)
-      
+d347 3
+a349 2
+         write(3,*)' In getmrcimgnum; locat,nlen,filnam_at:',
+     &                                locat,nlen,filnam_at
+a350 1
+
+a351 69
       IF (LOCAT <= 0) THEN
          IMGNUM = -1           ! NOT A STACK
          IRTFLG = 0
          RETURN
+       ENDIF
+  
+      CALL GET_IMGNUM(FILNAM_AT,FIL_NOAT,FIL_DIRS,FIL_BASE,FIL_EXT,
+     &                ISMRC,ISBARESTK,LOCAT,IMG_INSTK,IMGNUM,IRTFLG)
 
-      ELSEIF (ISDIGI(FILNAM_AT(LOCAT-1:LOCAT-1) )) THEN
- 
-C        EXTRACT IMAGE NUMBER WITHIN STACK FILE
+#if defined (SP_DBUGIO)
+         write(3,*)' In getmrcimgnum; filnam_at:',
+     &                                filnam_at
+
+         write(3,*)' In getmrcimgnum; filnam_base:',
+     &                                filnam_base
+         write(3,*)' In getmrcimgnum; locat,imgnum:',
+     &                                locat,imgnum
+
+#endif
 
          LOCSLASH = INDEX(FILNAM_AT(1:LOCAT),'/',BACK=.TRUE.)
          IGO      = 1 
          IF (LOCSLASH > 0) IGO = LOCSLASH + 1
 
+#if defined (SP_DBUGIO)
+         write(3,*)' In getmrcimgnum; locat,locslash,igo:',
+     &                                locat,locslash,igo
+
+         write(3,*)' In getmrcimgnum; filnam_at(igo:locat-1):',
+     &                                filnam_at(igo:locat-1)
+#endif
+
          CALL GETFILENUM(FILNAM_AT(IGO:LOCAT-1),IMGNUM,
      &                   NDIGITS,.TRUE.,IRTFLG)
          IF (IRTFLG .NE. 0) RETURN
 
-         !write(6,*)' In getmrcimgnum - imgnum,ndigits:',imgnum,ndigits
-         !write(6,*)' In getmrcimgnum - stack name:',filnam_at(1:nlen)
-         !write(6,*)' In getmrcimgnum - igo,locat:',igo,locat
+#if defined (SP_DBUGIO)
+         write(3,*)' In getmrcimgnum - imgnum,ndigits:',imgnum,ndigits
+
+         !write(3,*)' In getmrcimgnum - stack name:',filnam_at(1:nlen)
+         !write(3,*)' In getmrcimgnum - igo,locat:',igo,locat
+#endif
 
          IF (IMGNUM <= 0) THEN
             WRITE(NOUT,*) 'STACK NAME:',FILNAM_AT(1:NLEN)
@@ -333,7 +729,7 @@ C        EXTRACT IMAGE NUMBER WITHIN STACK FILE
 
          FILNAM = FILNAM_AT(1:IGO-1) // FILNAM_AT(LOCAT+1:NLEN)
 
-      ELSE
+      
 C        NO NUMBER BEFORE @@ INDICATES BARE STACK
          IMGNUM = 0
          IF (LOCAT > 1)  THEN
@@ -341,40 +737,287 @@ C        NO NUMBER BEFORE @@ INDICATES BARE STACK
          ELSE
            FILNAM = FILNAM_AT(2:NLEN)
          ENDIF
-      ENDIF
       
-      NLET  = lnblnkn(FILNAM)
+
+      nlet = lnblnkn(filnam)
+
       !write(3,*)' In getmrcimgnum - filnam_at:',filnam_at(1:25)
-      !write(6,*)' In getmrcimgnum - filnam_at: ',filnam_at(:nlen)
-      !write(6,*)' In getmrcimgnum - filnam   : ',filnam(:nlet),irtflg
+      !write(3,*)' In getmrcimgnum - filnam_at: ',filnam_at(:nlen)
+      !write(3,*)' In getmrcimgnum - filnam   : ',filnam(:nlet),irtflg
 
       IRTFLG = 0
-      END
+a352 1
+#endif
+d371 1
+a371 1
+     &              INDEX(FILNAM(1:NLETI),'.mrc') > 0 .OR.
+@
 
 
-C     ------------------------- ISMRCFILE  ----------------------------
+1.14
+log
+@debug output altered
+@
+text
+@d29 1
+a29 1
+C  OPENFIL_MRC(LUNT,FILNAM_AT,NLET,NX,NY,NZ,NSTACK, ITYPE,DSP,IRTFLG
+d35 4
+a38 4
+C        LUNT       UNIT NUMBER FOR FILNAM_AT                   (SENT)
+C        FILNAM_AT  FULL FILE NAME (STACKS HAVE @@)              (SENT)
+C        NX,NY,NZ   DIMENSIONS OF IMAGE                 (SENT OR RET.)
+C        NSTACK     STACK INDICATOR                      (SENT / RET.)
+d62 1
+a62 1
+      SUBROUTINE OPENFIL_MRC(LUNT,FILNAM_AT,NLET,NX,NY,NZ,NSTACK,
+d70 2
+a71 2
+      CHARACTER(LEN=*)        :: FILNAM_AT
+      INTEGER                 :: LUNT,NLET, NX,NY,NZ,NSTACK,ITYPE
+d75 6
+a80 2
+      CHARACTER (LEN=MAXNAM)  :: FILNAM
+      INTEGER                 :: LUN,NE,I,MAXIM
+d87 2
+a88 2
+      INTEGER                 :: IMGNUM,LOCAT,LUNOP,LENT 
+      LOGICAL                 :: WANTUL,ISMRCSFILE
+d91 1
+a91 1
+      INTEGER                 :: lnblnkn  ! FUNCTIONS  bad Sept 2025
+d99 20
+a118 5
+C     ALL MRC STACKS WILL HAVE AN @@ IN NAME
+      LOCAT = INDEX(FILNAM_AT,'@@')
 
+#if defined (SP_DBUG)
+      write(3,*)' In openfil_mrc; locat:',locat
+a120 25
+      IF (LOCAT <= 0) THEN
+C        NOT SPECIFIED AS A STACK
+         IMGNUM = -1
+         NSTACK = -2
+         FILNAM = FILNAM_AT
+      
+      ELSE
+C        GET STACKED IMAGE NUMBER (ZERO IF BARESTACK)
+C        OUTPUTS IMGNUM    0 : BARE STACK
+C                         -1 : NOT A STACK   (NO @@)
+C                         >1 : STACKED IMAGE NUMBER
+
+         CALL GETMRCIMGNUM(FILNAM_AT,LOCAT, FILNAM,IMGNUM,IRTFLG)
+         IF (IRTFLG .NE. 0) RETURN
+
+         NSTACK = 1
+         IF (IMGNUM > 0) NSTACK = IMGNUM
+
+      ENDIF
+
+#if defined (SP_DBUG)
+      write(3,*)' In openfil_mrc; filnam(1:nlet): ',filnam(1:nlet)
+      write(3,*)' In openfil_mrc; &&&& imgnum,nstack: ',imgnum,nstack
+#endif      
+      
+d130 1
+a130 1
+      ISBARE = (IMGNUM == 0)
+d135 1
+a135 1
+      IF (DSP == 'N' .AND. LOCAT > 0) THEN
+d144 1
+a144 1
+#if defined (SP_DBUG)
+d148 5
+a152 2
+         CALL OPENFIL_O_MRC(LUN,FILNAM,NLET,DSP,IMGNUM,
+     &                     NX,NY,NZ,NSTACK,IRTFLG)
+d156 1
+a156 1
+#if defined (SP_DBUG)
+d158 4
+a161 7
+      write(3,*)' In openfil_mrc, After openfil_o_mrc; filnam(:nlet):',
+     &                                                 filnam(1:nlet)
+      write(3,*)' In openfil_mrc, After openfil_o_mrc; imgnum: ',imgnum
+      write(3,*)' In openfil_mrc, After openfil_o_mrc; nstack: ',nstack
+      write(3,*)' In openfil_mrc, After openfil_o_mrc; nz,nstack: ',
+     &                                                 nz,nstack
+
+d167 15
+a181 6
+         SCALEX  = 1.0    ! ?????????
+         SCALEY  = 1.0
+         SCALEZ  = 1.0
+         MRCMODE = 2      ! USE 32 BIT REALS ALWAYS FOR NOW???
+         
+         CALL OPENFIL_N_MRC(LUN,FILNAM,
+d183 1
+a183 1
+     &                      NX,NY,NZ,NSTACK,
+d186 1
+d189 2
+a190 2
+C     SET IMGNUM AND NSTACK IN STATIC AREA OF FILE HEADER
+      CALL LUNSETSTK_MRC(LUN,IMGNUM,NSTACK,IRTFLG)
+d197 1
+a197 1
+      CALL LUNSETPOS_MRC(LUN,IMGNUM,IRTFLG)
+d233 1
+a233 1
+
+d250 2
+d257 5
+d267 6
+d278 13
+d292 1
+a292 3
+      ELSEIF (ISDIGI(FILNAM_AT(LOCAT-1:LOCAT-1) )) THEN
  
-       LOGICAL FUNCTION ISMRCFILE(FILNAM)
+C        EXTRACT IMAGE NUMBER WITHIN STACK FILE
+d298 8
+d310 3
+a312 1
+         !write(3,*)' In getmrcimgnum - imgnum,ndigits:',imgnum,ndigits
+d315 1
+d326 1
+a326 1
+      ELSE
+d334 1
+a334 1
+      ENDIF
+d344 1
+@
 
-       IMPLICIT NONE
 
-       CHARACTER(LEN=*) :: FILNAM
+1.13
+log
+@debug output commented out
+@
+text
+@d5 1
+d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+d97 4
+a100 2
+      !write(6,*)' In openfil_mrc; locat:',locat
+      
+d106 2
+a107 1
+         FILNAM = FILNAM_AT      
+a118 1
+         !write(3,*)' In openfil_mrc; imgnum,nstack: ',imgnum,nstack
+d121 5
+a125 1
+      !write(6,*)' In openfil_mrc; nstack: ',nstack
+d150 3
+a152 1
+        !write(6,*)' In openfil_mrc; nstack,imgnum: ',nstack,imgnum
+d154 1
+a154 1
+        CALL OPENFIL_O_MRC(LUN,FILNAM,NLET,DSP,IMGNUM,
+d157 1
+a157 1
+C     HACK TO HANDLE .mrcs files with bad NZ (REMOVED 6/30/20) al
+d159 10
+a168 6
+      !write(6,*)' In openfil_mrc, after openfil_o_mrc; irtflg: ',irtflg
+      !write(6,*)' In openfil_mrc, after openfil_o_mrc; filnam: ',filnam
+      !write(6,*)' In openfil_mrc, after openfil_o_mrc; imgnum: ',imgnum
+      !write(6,*)' In openfil_mrc, after openfil_o_mrc; nstack: ',nstack
+      !write(6,*)' In openfil_mrc, after openfil_o_mrc; nz,nstack: ',
+      !&                                                nz,nstack
+d188 1
+a188 1
+     
+d196 1
+a196 1
+      IF (FCHAR(1:2) .NE.  '31' .OR. FCHAR(4:5) .ne.  'HE') THEN
+d199 1
+a207 1
 
-       INTEGER          :: NLETI
-       INTEGER          :: lnblnk
+d217 4
+a220 1
+      !write(6,*)' In openfil_mrc; Calling lunsayinfo_mrc; lun: ',lun
+a225 2
 
-       NLETI = lnblnk(FILNAM)
+      !write(6,*)' In openfil_mrc; returning irtflg: ',irtflg
+d230 1
+a230 1
+C     ------------------- GETMRCIMGNUM ---------------------------------
+d274 3
+a276 3
+         !write(6,*)' In getmrcimgnum - imgnum,ndigits:',imgnum,ndigits
+         !write(6,*)' In getmrcimgnum - stack name:',filnam_at(1:nlen)
+         !write(6,*)' In getmrcimgnum - igo,locat:',igo,locat
+d296 3
+a298 2
+      
+      nlet  = lnblnkn(filnam)
+d300 2
+a301 2
+      !write(6,*)' In getmrcimgnum - filnam_at: ',filnam_at(:nlen)
+      !write(6,*)' In getmrcimgnum - filnam   : ',filnam(:nlet),irtflg
+@
 
-C      IF IT IHAS .MRC, .MRCS, OR .MAP IT IS LIKELY TO BE MRC FILE 
-       ISMRCFILE = (INDEX(FILNAM(1:NLETI),'.MRC') > 0 .OR.
-     &              INDEX(FILNAM(1:NLETI),'.mrc') > 0 .OR.
-     &              INDEX(FILNAM(1:NLETI),'.map') > 0 .OR.
-     &              INDEX(FILNAM(1:NLETI),'.MAP') > 0)
 
-       END
+1.12
+log
+@lnblnkn bug fixed
+@
+text
+@d204 1
+a204 1
+      write(6,*)' In openfil_mrc, Calling lunsayinfo_mrc; lun: ',lun
+@
 
 
+1.11
+log
+@HACK TO HANDLE .mrcs files with bad NZ (REMOVED[D
+@
+text
+@d4 1
+d10 1
+a10 1
+C=* Copyright 1985-2020  Health Research Inc.,                         *
+d85 2
+a86 1
+      LOGICAL                 :: ISDIGI,lnblnkn  ! FUNCTIONS
+d96 2
+a97 1
+       
+d115 1
+a115 1
+         !write(3,*)' In openfil_mrc - imgnum,nstack:',imgnum,nstack
+d118 1
+a118 1
+      !write(3,*)' In openfil_mrc, filnam :',filnam
+a141 2
+         CALL OPENFIL_O_MRC(LUN,FILNAM,NLET,DSP,IMGNUM,
+     &                      NX,NY,NZ,NSTACK,  IRTFLG)
+d143 6
+a148 1
+C        HACK TO HANDLE .mrcs files with bad NZ (REMOVED 6/30/20) al
+d150 6
+a155 5
+         !write(3,*)' In openfil_mrc, after openfil_o_mrc irtflg:',irtflg
+         !write(3,*)' In openfil_mrc, after openfil_o_mrc filnam:',filnam
+         !write(3,*)' In openfil_mrc, after openfil_o_mrc imgnum:',imgnum
+         !write(3,*)' In openfil_mrc, nstack: ',nstack
+         !write(3,*)' In openfil_mrc - nz,nstack:', nz,nstack
+d204 2
+d211 1
+a211 2
+      !write(6,*)' In openfil_mrc, ret. itype,iform: ',itype,iform
+      !write(3,*)' In openfil_mrc, ret. irtflg: ',irtflg
+d234 2
+a235 1
+      LOGICAL             :: ISDIGI,lnblnkn
+d283 1
+a283 1
+      NLET  = lnblnkn(FILNAM)
 @
 
 
diff --git src/RCS/openfil_n_mrc.f,v src/RCS/openfil_n_mrc.f,v
index 9dafc233..f4088969 100644
--- src/RCS/openfil_n_mrc.f,v
+++ src/RCS/openfil_n_mrc.f,v
@@ -1,10 +1,15 @@
-head	1.4;
+head	1.5;
 access;
 symbols;
 locks; strict;
 comment	@c @;
 
 
+1.5
+date	2025.11.10.22.33.58;	author dean;	state Exp;
+branches;
+next	1.4;
+
 1.4
 date	2020.01.21.16.19.37;	author leith;	state Exp;
 branches;
@@ -30,22 +35,23 @@ desc
 @@
 
 
-1.4
+1.5
 log
-@cosmetic changes
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
 C
 C OPENFIL_N_MRC.F ADAPTED FROM OPENFIL           MAY 2019 ArDean Leith
+C                 DEBUG OUTPUT                   OCT 2025 ArDean Leith
 C
 C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2020   Health Research Inc.,                         *
+C=* Copyright 1985-2025   Health Research Inc.,                        *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -61,46 +67,70 @@ C=* along with this program. If not, see <http://www.gnu.org/licenses> *
 C=*                                                                    *
 C **********************************************************************
 C
-C  OPENFIL_N_MRC(LUN,FILNAM,DATEXT, MRCMODE, NX,NY,NZ,NSTACK,
+C  OPENFIL_N_MRC(LUN,FILNAM,DATEXT, MRCMODE, NX,NY,NZ, NSTK_FLG,
 C                SCALEX,SCALEY,SCALEZ,IRTFLG
 C
 C  PURPOSE: OPEN NEW MRC FILE FOR STREAM ACCESS, LITTLE ENDED
 C
 C  PARAMETERS:
-C       LUN       LOGICAL UNIT NUMBER FOR FILNAM.               (SENT)
-C       FILNM     CHARACTER ARRAY, CONTAINING FILE NAME WITH @@  (SENT)
-C       FILNAM    CHARACTER ARRAY, CONTAINING FILE NAME NO @@    (SENT)
-C       LUN       LOGICAL UNIT NUMBER FOR FILNAM.               (SENT)
-C       NX,NY,NZ  DIMENSIONS OF IMAGE                   (SENT OR RET.)
-C       NSTACK    STACK INDICATOR                        (SENT / RET.)
-C                   ON INPUT: 
-C                     -2 : NOT A STACK  
-C                     >0 : MRC STACK
-C                   ON OUTPUT: 
-C                     -1  :  NOT A STACK 
-C                     >=0 :  MAX IMAGE NUMBER NOW IN STACK.
+C       LUN           LOGICAL UNIT NUMBER FOR FILNAM            (SENT)
+C       FILNAM        CHAR  ARRAY, CONTAINING FILE NAME NO @@    (SENT)
+C       LUN           LOGICAL UNIT NUMBER FOR FILNAM            (SENT)
+C       NX,NY,NZ      DIMENSIONS OF IMAGE/VOL             (SENT & RET)
+C
+C       NSTK_FLG      STACK INDICATOR                     (SENT / RET)
+C                     ON INPUT: 
+C                       -2 :  AST FOR NSTK  (@@* or *@@)   
+C                       -1 :  NOT A STACK   (NO @@)
+C                        0 :  BARE STACK    (@@)
+C                       >1 :  STACKED MRC IMAGE/VOLUME? NUMBER
+C
+C                     ON OUTPUT: 
+C                       -1 :  NOT A STACK 
+C                      >=0 :  MAX IMAGE NUMBER NOW IN STACK
 C 
-C       IRTFLG    ERROR RETURN FLAG.                            (RET.)
-C                   0 : NORMAL RETURN
-C                   1 : ERROR RETURN
+C       IRTFLG        ERROR RETURN FLAG.                         (RET)
+C                       0 : NORMAL RETURN
+C                       1 : ERROR RETURN
 C
-C  VARIABLES: ITYPE (TYPE)  FILE TYPE SPECIFIER. 
-C               +1    R     2-D IMAGE
-C               +3    R3    3-D VOLUME FILE
+C  VARIABLES: 
+C        ITYPE     (TYPE)  FILE TYPE SPECIFIER. 
+C             +1     R     2-D IMAGE
+C             +3     R3    3-D VOLUME FILE
 C
-C        ISPG == 0        IMAGE OR IMAGE STACK
-C        ISPG == 1        VOLUMES
-C        ISPG == 401      STACK OF EM VOLUMES
+C        ISPG == 0         IMAGE OR IMAGE STACK
+C        ISPG == 1         VOLUMES
+C        ISPG == 401       STACK OF EM VOLUMES  if Version = 20140
 C
-C        MZ   ==  1       IMAGE 
-C        MZ   >=  1       IMAGE STACK
-C        MZ   == NZ       VOLUME
-C        MZ   NZ/NUMVOLS  VOLUME STACK
+C        MZ   ==  1        IMAGE 
+C        MZ   >=  1        IMAGE STACK
+C        MZ   == 1            IMAGE STACK
+C        MZ   == NZ        VOLUME
+C        MZ   NZ/NUMVOLS   VOLUME STACK
 C
 C        DMAX  < DMIN                        MAX & MIN UNDETERMINED
 C        DMEAN < (SMALLER OF DMIN and DMAX)  DMEAN     UNDETERMINED
 C        RMS   < 0.0                         RMS       UNDETERMINED
 C
+C  MRC FILE HEADER:
+C     MZ identifies the # of sections along Z in 
+C     each of the volumes that are in a volume stack
+C
+C     2014 MRC STANDARD (IVERSION = 20140)    
+C                       ISPG(23)  NZ(3)          MZ(10)
+C       Single image       0       1              1
+C       Image stack        0       1              >= 1
+C       Single volume      1      >1 (#SLICES)    = NZ
+C       Volume stack      401     >1*#VOLS        = NZ / #VOLS  
+C
+C     RELION STANDARD -  MRCS     (IVERSION = 1)
+C                        ISPG     NZ             MZ
+C       Single image       0       1              1
+C       Image stack        0       1              >= 1
+C       Single volume      0      >1 (#SLICES)    = NZ??
+C       No Volume stack    0      >1*#VOLS        = NZ / #VOLS  
+C
+C
 C  CALL TREE:   
 C     OPFILEC --> OPENFIL_MRC --> OPENFIL_O_MRC -->
 C                             --> OPENFIL_N_MRC -->
@@ -110,7 +140,7 @@ C--*********************************************************************
 
       SUBROUTINE OPENFIL_N_MRC(LUN,FILNAM,
      &                         MRCMODE,
-     &                         NX,NY,NZ,NSTACK,
+     &                         NX,NY,NZ, NSTK_FLG,
      &                         SCALEX,SCALEY,SCALEZ,IRTFLG)
  
 C     PURPOSE: OPEN NEW MRC FILE FOR STREAM ACCESS, LITTLE ENDED
@@ -121,19 +151,30 @@ C     PURPOSE: OPEN NEW MRC FILE FOR STREAM ACCESS, LITTLE ENDED
       INCLUDE 'CMLIMIT.INC'
  
       INTEGER                 :: LUN,MRCMODE
-      CHARACTER(LEN=*)        :: FILNAM
-      INTEGER                 :: NX,NY,NZ,NSTACK
+
+      CHARACTER(LEN=*),INTENT(IN) :: FILNAM
+
+      INTEGER                 :: NX,NY,NZ, NSTK_FLG
       REAL                    :: SCALEX,SCALEY,SCALEZ
       INTEGER                 :: IRTFLG
 
       LOGICAL                 :: WANTUL,IS_MRCS 
       INTEGER                 :: NLABL,NSYMBT,MACHST,NE,IOFFSET
-      INTEGER                 :: MX,MY,MZ,IVERSION,NZMRC
-      INTEGER                 :: NSYMBYT,ISPG
+      INTEGER                 :: MX,MY,MZ,IVERSION
+      INTEGER                 :: NSYMBYT,ISPG,LNBLNKN,ILENT
+
       CHARACTER(LEN=1)        :: NULL = CHAR(0)
 
 
-      !write(3,*)' In openfil_n_mrc, filnam,nstack: ',filnam,nz,nstack
+      ILENT = LNBLNKN(FILNAM)
+
+#if defined (SP_DBUGIO)
+      write(3,*)'  '
+      write(3,*)' In openfil_n_mrc; nx,ny,nz,nstk_flg: ', 
+     &                              nx,ny,nz,nstk_flg
+      !write(3,*)' In openfil_n_mrc; ilent:  ',ilent
+       write(3,*)' In openfil_n_mrc; filnam: ',filnam(1:ilent)
+#endif
 
 C     OPEN NEW MRC FILE FOR STREAM ACCESS, LITTLE ENDED
 
@@ -150,69 +191,95 @@ C     SO: MZ = NZ / NUMBER OF VOLUMES
 C     I AM TRYING TO HANDLE ALL COMMON FOULED UP MRC STACKS
       MX  = NX
       MY  = NY
-
-      !write(3,*)' In openfil_n_mrc, filnam: ',filnam,nx,ny,nz,nstack
-
+ 
 C     SEE IF USER WANTS RELION COMPATIBLE IMAGE/STACK
       IS_MRCS = (INDEX(FILNAM,'MRCS') > 1  .OR.
      &           INDEX(FILNAM,'mrcs') > 1)
 
-      !write(3,*)' In openfil_n_mrc, filnam: ',is_mrcs, nstack
-      IF ( IS_MRCS .OR. (NZ > 1 .AND. NSTACK > 1) )  THEN
+#if defined (SP_DBUGIO)
+      write(3,*)' In openfil_n_mrc, is_mrcs: ',is_mrcs
+#endif
+
+C     PUT FILENAME IN STATIC AREA OF THE HEADER OBJECT
+      CALL LUNSETFILE_MRC(LUN,FILNAM,NULL,IRTFLG)
+      IF (IRTFLG .NE. 0) RETURN
+
+      IF ( IS_MRCS .OR. (NZ > 1 .AND. NSTK_FLG > 1) )  THEN
 C        HACK TO CREATE RELION COMPATIBLE STACKS
          IVERSION = 1
-         ISPG     = 0    
-         NZMRC    = MAX(NSTACK,1)        ! NUMBER OF IMAGES 
-         MZ       = NSTACK
-         !write(3,*)' In openfil_n_mrc, ismrcs,nstack,nzmrc: ', is_mrcs, nstack,nzmrc
-      ELSEIF (NZ == 1 .AND. NSTACK < 0) THEN
+         ISPG     = 0
+         NZ       = MAX(NSTK_FLG,1)    ! NUMBER OF IMAGES NOT SLICES!
+         MZ       = NZ
+
+#if defined (SP_DBUGIO)
+         write(3,*)' In openfil_n_mrc, is_mrcs,nz: ',is_mrcs,nz
+#endif
+ 
+      ELSEIF (NZ == 1 .AND. NSTK_FLG < 0) THEN
 C        JUST A SINGLE IMAGE
          IVERSION = 20140        
          ISPG     = 0    
-         NZMRC    = 1           ! IMAGE           
-         MZ       = 1
-         NSTACK   = -2
-      ELSEIF (NZ == 1 .AND. NSTACK >= 1) THEN
+         NZ       = 1            ! IMAGE (NOT A VOLUME OR STACK)        
+         MZ       = 1            ! IMAGE (NOT A VOLUME)
+         NSTK_FLG = -2           ! NOT A STACK
+
+
+#if defined (SP_DBUGIO)
+         write(3,*)' In openfil_n_mrc, nz,nstk_flg: ',nz,nstk_flg
+#endif
+
+      ELSEIF (NZ == 1 .AND. NSTK_FLG >= 1) THEN
 C        A 2014 STANDARD IMAGE STACK
          IVERSION = 20140        
          ISPG     = 0    
-         NZMRC    = NZ          ! IMAGE           
-         MZ       = NSTACK
-      ELSEIF (NZ > 1 .AND. NSTACK < 0 ) THEN
-C        SINGLE VOLUME
+         NZ       = 1            ! IMAGE (NOT A VOLUME) (SINGLE SLICE) 
+         MZ       = NSTK_FLG     ! STACK SIZE, NUMBER OF IMAGES IN STACK
+
+      ELSEIF (NZ > 1 .AND. NSTK_FLG < 0 ) THEN
+C        A 2014 SINGLE VOLUME
          IVERSION = 20140
          ISPG     = 1    
-         NZMRC    = NZ          ! NUMBER OF IMAGES??
-         MZ       = NZ
-         NSTACK   = -2
-         !write(3,*)' In openfil_n_mrc, nstack,nzmrc: ', nstack,nzmrc,nz
-      ELSEIF (NZ > 1 .AND. NSTACK > 0 ) THEN
-C        STACK OF EM VOLUMES
-         IVERSION = 20140       ! SO NZ IS NOT FOR STACK
+C        MZ       = MZ           ! VOLUME 
+         NSTK_FLG = -1           ! NOT A STACK
+
+      ELSEIF (NZ > 1 .AND. NSTK_FLG > 0 ) THEN
+C        A 2014 STACK OF EM VOLUMES  (WHAT SOFTWARE USES VOLUME STACKS?)
+         IVERSION = 20140        ! SO NZ IS NOT FOR STACK
          ISPG     = 401    
-         NZMRC    = NZ          ! NUMBER OF VOLUMES
-         MZ       = NZ * NSTACK
-         NSTACK   = MZ          ! STACK SIZE
+C        NZ       = NZ           ! NUMBER OF VOLUMES
+         MZ       = NZ * NSTK_FLG
+         NSTK_FLG = MZ           ! STACK SIZE  (MASY BE WRONG)
+
       ELSE 
-         CALL ERRT(102,'BAD STACK OR VOLUME PARAMETERS',NSTACK)
+         CALL ERRT(102,'BAD STACK OR VOLUME PARAMETERS',NSTK_FLG)
          IRTFLG = 1
          RETURN
       ENDIF
-
-      !write(3,*)' In openfil_n_mrc, set:', nx,ny,nz,MX,MY,MZ
-
+ 
 C     MODE IS ALWAYS 32 BIT REAL FOR NEW FILES (FOR NOW)
-      CALL LUNSETMODSIZ_MRC(LUN,MRCMODE,NX,NY,NZMRC,
+      CALL LUNSETMODSIZ_MRC(LUN,MRCMODE,NX,NY,NZ,
      &                                  MX,MY,MZ,IRTFLG)
       IF (IRTFLG .NE. 0) RETURN
 
+#if defined (SP_DBUGIO)
+      write(3,*)' End openfil_n_mrc; nstk_flg: ', nstk_flg
+      write(3,*)' end openfil_n_mrc; nx,ny,NZ: ', nx,ny,nz
+      write(3,*)' End openfil_n_mrc; mx,my,mz: ', mx,my,mz
+#endif
+
+
 C     SET EXTRA HEADER BYTES, NO. OF LABELS USED, VERSION, ETC
       NSYMBT = 0                      ! RESET BY LUNSETXXX_MRC
       NLABL  = 1                      ! RESET BY LUNSETXXX_MRC
-      !write(3,*)' In oprnfil_n, set:', iversion,ispg,nzmrc,mz,nstack
+
       CALL LUNSETVIN_MRC(LUN,IVERSION,ISPG,NSYMBT,NLABL,IRTFLG)
       IF (IRTFLG .NE. 0) RETURN
 
+#if defined (SP_DBUGIO)
+      !write(3,*)' End openfil_n; iversion,ispg,nlabl: ',
+      ! &                         iversion,ispg,nlabl
+#endif
+
 C     SET:  N?START,CELLANGS,AXES,NSYMBYT,MAP,MACHST,LABELS,...
       CALL LUNSETXXX_MRC(LUN,IRTFLG)
       IF (IRTFLG .NE. 0) RETURN
@@ -233,6 +300,129 @@ C     SET FLAG FOR NORMAL RETURN
 
 
 
+@
+
+
+1.4
+log
+@cosmetic changes
+@
+text
+@d4 1
+d10 1
+a10 1
+C=* Copyright 1985-2020   Health Research Inc.,                         *
+d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+d28 1
+a28 1
+C  OPENFIL_N_MRC(LUN,FILNAM,DATEXT, MRCMODE, NX,NY,NZ,NSTACK,
+d34 15
+a48 12
+C       LUN       LOGICAL UNIT NUMBER FOR FILNAM.               (SENT)
+C       FILNM     CHARACTER ARRAY, CONTAINING FILE NAME WITH @@  (SENT)
+C       FILNAM    CHARACTER ARRAY, CONTAINING FILE NAME NO @@    (SENT)
+C       LUN       LOGICAL UNIT NUMBER FOR FILNAM.               (SENT)
+C       NX,NY,NZ  DIMENSIONS OF IMAGE                   (SENT OR RET.)
+C       NSTACK    STACK INDICATOR                        (SENT / RET.)
+C                   ON INPUT: 
+C                     -2 : NOT A STACK  
+C                     >0 : MRC STACK
+C                   ON OUTPUT: 
+C                     -1  :  NOT A STACK 
+C                     >=0 :  MAX IMAGE NUMBER NOW IN STACK.
+d50 18
+a67 16
+C       IRTFLG    ERROR RETURN FLAG.                            (RET.)
+C                   0 : NORMAL RETURN
+C                   1 : ERROR RETURN
+C
+C  VARIABLES: ITYPE (TYPE)  FILE TYPE SPECIFIER. 
+C               +1    R     2-D IMAGE
+C               +3    R3    3-D VOLUME FILE
+C
+C        ISPG == 0        IMAGE OR IMAGE STACK
+C        ISPG == 1        VOLUMES
+C        ISPG == 401      STACK OF EM VOLUMES
+C
+C        MZ   ==  1       IMAGE 
+C        MZ   >=  1       IMAGE STACK
+C        MZ   == NZ       VOLUME
+C        MZ   NZ/NUMVOLS  VOLUME STACK
+d73 19
+d101 1
+a101 1
+     &                         NX,NY,NZ,NSTACK,
+d112 4
+a115 2
+      CHARACTER(LEN=*)        :: FILNAM
+      INTEGER                 :: NX,NY,NZ,NSTACK
+d121 3
+a123 2
+      INTEGER                 :: MX,MY,MZ,IVERSION,NZMRC
+      INTEGER                 :: NSYMBYT,ISPG
+d127 9
+a135 1
+      !write(3,*)' In openfil_n_mrc, filnam,nstack: ',filnam,nz,nstack
+d152 1
+a152 3
+
+      !write(3,*)' In openfil_n_mrc, filnam: ',filnam,nx,ny,nz,nstack
+
+d157 9
+a165 2
+      !write(3,*)' In openfil_n_mrc, filnam: ',is_mrcs, nstack
+      IF ( IS_MRCS .OR. (NZ > 1 .AND. NSTACK > 1) )  THEN
+d168 9
+a176 5
+         ISPG     = 0    
+         NZMRC    = MAX(NSTACK,1)        ! NUMBER OF IMAGES 
+         MZ       = NSTACK
+         !write(3,*)' In openfil_n_mrc, ismrcs,nstack,nzmrc: ', is_mrcs, nstack,nzmrc
+      ELSEIF (NZ == 1 .AND. NSTACK < 0) THEN
+d180 10
+a189 4
+         NZMRC    = 1           ! IMAGE           
+         MZ       = 1
+         NSTACK   = -2
+      ELSEIF (NZ == 1 .AND. NSTACK >= 1) THEN
+d193 5
+a197 4
+         NZMRC    = NZ          ! IMAGE           
+         MZ       = NSTACK
+      ELSEIF (NZ > 1 .AND. NSTACK < 0 ) THEN
+C        SINGLE VOLUME
+d200 6
+a205 7
+         NZMRC    = NZ          ! NUMBER OF IMAGES??
+         MZ       = NZ
+         NSTACK   = -2
+         !write(3,*)' In openfil_n_mrc, nstack,nzmrc: ', nstack,nzmrc,nz
+      ELSEIF (NZ > 1 .AND. NSTACK > 0 ) THEN
+C        STACK OF EM VOLUMES
+         IVERSION = 20140       ! SO NZ IS NOT FOR STACK
+d207 4
+a210 3
+         NZMRC    = NZ          ! NUMBER OF VOLUMES
+         MZ       = NZ * NSTACK
+         NSTACK   = MZ          ! STACK SIZE
+d212 1
+a212 1
+         CALL ERRT(102,'BAD STACK OR VOLUME PARAMETERS',NSTACK)
+d216 1
+a216 3
+
+      !write(3,*)' In openfil_n_mrc, set:', nx,ny,nz,MX,MY,MZ
+
+d218 1
+a218 1
+      CALL LUNSETMODSIZ_MRC(LUN,MRCMODE,NX,NY,NZMRC,
+d222 7
+d232 1
+a232 1
+      !write(3,*)' In oprnfil_n, set:', iversion,ispg,nzmrc,mz,nstack
+d235 5
 @
 
 
diff --git src/RCS/openfil_o_mrc.f,v src/RCS/openfil_o_mrc.f,v
index abd8bf93..211a9cef 100644
--- src/RCS/openfil_o_mrc.f,v
+++ src/RCS/openfil_o_mrc.f,v
@@ -1,10 +1,30 @@
-head	1.8;
+head	1.12;
 access;
 symbols;
 locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.33.56;	author dean;	state Exp;
+branches;
+next	1.11;
+
+1.11
+date	2025.10.16.19.27.07;	author dean;	state Exp;
+branches;
+next	1.10;
+
+1.10
+date	2025.10.07.13.32.35;	author dean;	state Exp;
+branches;
+next	1.9;
+
+1.9
+date	2025.09.26.14.40.26;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2020.01.21.16.19.03;	author leith;	state Exp;
 branches;
@@ -50,22 +70,25 @@ desc
 @@
 
 
-1.8
+1.12
 log
-@code for fmin... retrieval altered
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
 C
 C OPENFIL_O_MRC.F   ADAPTED FROM OPENFIL         MAY 2019 ArDean Leith
+C                   NLABEL BUG                   SEP 2025 ArDean Leith
+C                   DEBUG OUTPUT ADDED           SEP 2025 ArDean Leith
+C                   IRTFLG AND NLABL CHANGED     SEP 2025 ArDean Leith
 C
 C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2019  Health Research Inc.,                         *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -81,27 +104,51 @@ C=* along with this program. If not, see <http://www.gnu.org/licenses> *
 C=*                                                                    *
 C **********************************************************************
 C
-C  OPENFIL_O_MRC(LUNT,FILNAM,NLET,IMGNUM, NX,NY,NZ,NSTACK, IRTFLG)
+C  OPENFIL_O_MRC(LUNT,FILNAM,NLET,DSP,IMGNUM,
+C                NX,NY,NZ, NSTK_FLG, IRTFLG)
 C
 C  PURPOSE: OPEN EXISTING MRC DATA FILE FOR READ/WRITE  
 C
 C  PARAMETERS:
 C       LUNT     LOGICAL UNIT NUMBER FOR FILNAM.                (SENT)
 C       FILNAM   FILE NAME (NO @@)                               (SENT)
-C       NLET     LENGTH OF FILE NAME                            (RET.)
+C       NLET     LENGTH OF FILE NAME                            (SENT)
 C       DSP      OLD OR NEW FILE                                (SENT)
 C       IMGNUM   IMAGE NUMBER IF STACKED                        (SENT)
-C       NX,NY,NZ DIMENSIONS OF IMAGE                            (RET.)
-C       NSTACK   STACK INDICATOR                                (RET.)
+C
+C       NX,NY    X & Y DIMENSIONS OF IMAGE/VOL                  (RET)
+C       NZ       Z  DIMENSION OF VOL OR MRCS_NSTK               (RET)
+C       NSTK_FLG STACK INDICATOR                                (RET)
 C                   -2  :  NOT A STACK 
-C                   >=0 :  MAX IMAGE NUMBER NOW IN STACK.
-C       IRTFLG   ERROR RETURN FLAG.                             (RET.)
+C                   -1  :  AST FOR NSTK  (@@* or *@@) 
+C                    0  :  BARE STACK    (@@)
+C                   >=0 :  MAX IMAGE NUMBER NOW IN STACK
+C
+C       GET_IMG_STK  GETS NSTK_FLG: NSTK or NOT or BARE 
+C                  -2 :  NOT A STACK   (NO @@)
+C                  -1 :  AST FOR NSTK  (@@* or *@@)   
+C                   0 :  BARE STACK    (@@)
+C                  >1 :  STACKED IMAGE NUMBER
+C
+C       IRTFLG   ERROR RETURN FLAG.                             (RET)
 C                   0 : NORMAL RETURN
 C                   1 : ERROR RETURN
 C
-C  VARIABLES:
-C       (23) ISPG == 0     CONTAINS IMAGE OR IMAGE STACK
-C       (23) ISPG == 1     CONTAINS VOLUMES
+C  VARIABLES:  
+C           (FOR MRC 2014)
+C                 ISPG (23)   NZ (1)     MZ (10)
+C       IMAGE           0      1          1
+C       IMAGE STACK     0     NSTK       NSTK
+C       VOLUME (Z)            NZ         NZ
+C       VOLUME STACK  401     NZ*NSTK    NZ/NSTK
+C
+C           (FOR MRCS)
+C                 ISPG (23)   NZ (1)     MZ (10)
+C       IMAGE           0     1          1
+C       IMAGE STACK     0     NSTK       1
+C       VOLUME (Z)            NZ         NZ
+C
+C       (23) ISPG == 1     CONTAINS SINGLE VOLUME
 C       (23) ISPG == 401   CONTAINS STACK OF EM VOLUMES
 C       (24) NSYMBT        NO. OF EXTRA SYMMETRY, ETC. BYTES
 C       (56) NLABL         NO. OF 80 CHAR TEXT LABELS IN #57..256
@@ -114,7 +161,7 @@ C23456789 123456789 123456789 123456789 123456789 123456789 123456789 12
 C--*********************************************************************
 
       SUBROUTINE OPENFIL_O_MRC(LUNT,FILNAM,NLET,DSP,IMGNUM,
-     &                         NX,NY,NZ,NSTACK, IRTFLG)
+     &                         NX,NY,NZ, NSTK_FLG, IRTFLG)
 
       IMPLICIT NONE
 
@@ -123,11 +170,12 @@ C--*********************************************************************
 
       CHARACTER(LEN=*)        :: FILNAM
       CHARACTER(LEN=1)        :: DSP
-      INTEGER                 :: LUNT,NLET,IMGNUM, NX,NY,NZ,NSTACK
+      INTEGER                 :: LUNT,NLET,IMGNUM
+      INTEGER                 :: NX,NY,NZ,NSTK_FLG
       INTEGER                 :: IRTFLG
 
       INTEGER                 :: LUN,NE
-      INTEGER                 :: I,NZMRC,MX,MY,MZ
+      INTEGER                 :: I,MX,MY,MZ
       INTEGER                 :: IVERSION,NSYMBT,IHEDLEN,NLABL,NBYT
       CHARACTER(LEN=1)        :: ENDED
       CHARACTER(LEN=2)        :: DISP
@@ -140,7 +188,7 @@ C--*********************************************************************
       REAL                    :: SCALEX,SCALEY,SCALEZ
       INTEGER                 :: IMAMIT
       REAL                    :: FMINT,FMAXT,AVT,SIGT
-      INTEGER                 :: ISPG,INOW,IGO,IEND,ILAB
+      INTEGER                 :: ISPG,INOW,IGO,IEND,ILAB,iflip
       LOGICAL                 :: ENDOK
       INTEGER                 :: LOCAT   
       INTEGER                 :: MAPC,MAPR,MAPS
@@ -156,40 +204,63 @@ C     PURPOSE:  OPEN EXISTING MRC FILE FOR STREAM ACCESS
            
       LUN = LUNT
 
-C     SET READ TO CONVERT TO LITTLE ENDEDNESS
+C     SET READ FOR NATIVE LITTLE ENDIANNESS  
       DISP(1:1) = 'O'
       ENDED     = 'L'
       DISP(2:2) = ENDED
 
-      !write(3,*)' In openfil_o_mrc, nlet,filnam:',nlet,filnam(:nlet)
-      !write(3,*)' In openfil_o_mrc, imgnum:',imgnum
+#if defined (SP_DBUGIO)
+      write(3,*)' In openfil_o_mrc; imgnum:   ', imgnum
+      write(3,*)' In openfil_o_mrc; filnam:   ', filnam(:nlet)
+      write(3,*)' In openfil_o_mrc; disp:     ', disp
+      write(3,*)'   '
+      write(3,*)' In openfil_o_mrc; calling loadhed_mrc    '
+      write(3,*)'  '
+#endif
 
-C     OPEN EXISTING FILE, CREATE HEADER OBJECT, AND CHECK ENDEDNESS 
-      !write(6,*)' In openfil_o_mrc, call loadhed_mrc, disp:',disp
+C     OPEN EXISTING FILE, READ HEADER & LOAD IN HEADER OBJECT  
       CALL LOADHED_MRC(LUN,FILNAM,NLET,DISP,IRTFLG)
-      
+
+#if defined (SP_DBUGIO)
+      write(3,*)' In openfil_o_mrc; After calling loadhed_mrc 111  '
+#endif
+
 C     DETERMINE CURRENT FILE ENDED-NESS AS READ IN
       CALL LUNGETMAP_MRC(LUN,MAPC,MAPR,MAPS,IRTFLG)
-      !write(3,*)' In openfil_o_mrc, mapc,r,s: ',mapc,mapr,maps
 
+#if defined (SP_DBUGIO)
+      write(3,*)' In openfil_o_mrc; mapc,mapr,maps: ',mapc,mapr,maps
+#endif
+
+C     CHECK ENDIANNESS 
       ENDOK = ((MAPC == 1) .OR. (MAPR == 1) .OR. (MAPS == 1))
-      IF (ENDOK)  CALL LUNSETFLIP(LUN,0,IRTFLG)
+      IF (ENDOK)  THEN
 
-      IF (.NOT. ENDOK) THEN
+         CALL LUNSETFLIP(LUN,0,IRTFLG)   ! NO FLIP NEEDED
+
+      ELSE
 C        NOT RIGHT ENDEDNESS, TRY CONVERT FROM BIG ENDED 
         
          ENDED     = 'B'
          DISP(2:2) = ENDED
 
-C        OPEN FILE, CREATE HEADER OBJECT AND CHECK ENDEDNESS 
+ 
+C        OPEN FILE, CREATE HEADER OBJECT 
 
-         !write(6,*)' In openfil_o_mrc, call loadhed_mrc, disp:',disp
+#if defined(SP_DBUGIO)
+         write(3,*)' In openfil_o_mrc, Call loadhed_mrc, disp:',disp
+#endif
+
+C        OPEN EXISTING FILE, READ HEADER & LOAD IN HEADER OBJECT  
          CLOSE (LUN)
          CALL LOADHED_MRC(LUN,FILNAM,NLET,DISP, IRTFLG)
 
 C        DETERMINE CURRENT FILE ENDED-NESS AS READ IN
          CALL LUNGETMAP_MRC(LUN,MAPC,MAPR,MAPS,IRTFLG)
-         !write(3,*)' In openfil_o_mrc, mapc,r,s: ',mapc,mapr,maps
+
+#if defined(SP_DBUGIO)
+         write(3,*)' In openfil_o_mrc; mapc,mapr,maps: ',mapc,mapr,maps
+#endif
 
          ENDOK = ((MAPC == 1) .OR. (MAPR == 1) .OR. (MAPS == 1))
 
@@ -201,21 +272,31 @@ C           MUST FLIP FILE CONTENTS WHEN READ IN
          ENDIF
 
       ENDIF
-      
+
       IF (MYPID <= 0 .AND. IRTFLG .NE. 0) THEN        
 C         NEITHER ENDEDNESS SEEMS OK --> OPENING ERROR 
-          MSG = 'OPENFIL_O_MRC; OPENING FILE: ' // FILNAM(1:NLET)
+
+                           WRITE(NDAT,904) MAPC,MAPR,MAPS
+          IF (NDAT .NE. 6) WRITE(6,904)    MAPC,MAPR,MAPS
+904       FORMAT(' *** HEADER MAPC,MAPR,MAPS: ',I8,' ',I8,' ',I8,
+     &           ' ARE NONSENSE ')
+
+          MSG = 'OLD FILE HEADER NOT MRC/MAP:  ' // FILNAM(1:NLET)
           CALL ERRT(101,MSG,NE)
-          IRTFLG =1
+          IRTFLG = 1
           RETURN
       ENDIF
 
-C     GET IMAGE/VOLUME SIZE PARAMETERS AND MODE
-      CALL LUNGETMODSIZ_MRC(LUN,MRCMODE,NX,NY,NZMRC, MX,MY,MZ,IRTFLG)
+C     PUT FILNAM IN COMMON LUN HEADER
+      CALL LUNSETFILE_MRC(LUN,FILNAM(1:NLET),NULL,IRTFLG)
+
+C     GET FILE  MODE
+      CALL LUNGETMODE_MRC(LUN,MRCMODE,IRTFLG)
       IF (IRTFLG .NE. 0) RETURN        
 
-      !write(6,*)' In openfil_o_mrc, mrcmode: ',mrcmode
-      !write(3,*)' In openfil_o_mrc, size (x,y,z),mz: ',nx,ny,nzmrc,mz
+#if defined(SP_DBUGIO)
+      write(3,*)' In openfil_o_mrc; mrcmode: ',mrcmode
+#endif
 
       IF (MYPID <= 0 .AND. (MRCMODE == 3 .OR. MRCMODE == 4)) THEN
          CALL ERRT(102,'UNSUPPORTED MRC TRANSFORM FILE, MODE',MRCMODE)
@@ -223,95 +304,169 @@ C     GET IMAGE/VOLUME SIZE PARAMETERS AND MODE
          RETURN
       ENDIF
 
-      !write(3,*)' In openfil_o_mrc, imgnum,mz: ',imgnum,mz
+C     GET MRC FILE PARAMETERS: IVERSION,ISPG,NSYMBT,NLABL
+      CALL LUNGETVIN_MRC(LUN,IVERSION,ISPG,NSYMBT,NLABL,IRTFLG)
 
+#if defined (SP_DBUGIO)
+      write(3,*)' In openfil_o_mrc; iversion,ispg: ', iversion,ispg
+      write(3,*)' In openfil_o_mrc; nsymbt, nlabl: ', nsymbt, nlabl
+#endif
+      IF (IRTFLG .NE. 0) RETURN 
+       
 C     READ NLABL LABELS FROM FILE (<= 800 CHAR)
       CALL LUNGETLABELS_MRC(LUN,NLABL,LABELS,IRTFLG)
-      IF (IRTFLG .NE. 0) RETURN        
+      IF (IRTFLG .NE. 0) RETURN
 
-C     GET MRC FILE PARAMETERS: IVERSION,ISPG,NSYMBT,NLABL
-      CALL LUNGETVIN_MRC(LUN,IVERSION,ISPG,NSYMBT,NLABL,IRTFLG)
-      !write(3,*)' In openfil_o_mrc, ispg,iversion: ', ispg,iversion
-      !write(6,*)' In openfil_o_mrc, nsymbt, nlabl: ', nsymbt, nlabl
+#if defined (SP_DBUGIO)
+      write(3,*)' In openfil_o_mrc; nlabl: ',nlabl
+      !write(3,*)' In openfil_o_mrc; First label: ' ,labels(1:80)
+      call lungetflip(lun,iflip,irtflg)
+      write(3,*)' In openfil_o_mrc, iflip: ',iflip
+#endif
+
+C     GET MRC FILE PARAMETERS: NZ,MZ, & NSTK_FLG
+C               (SHOULD HANDLE .mrcs FILES OK)
+
+C     GET IMAGE/VOLUME SIZE PARAMETERS AND MODE
+      CALL LUNGETMODSIZES_MRC(LUN,NX,NY,NZ, 
+     &                        MX,MY,MZ,IRTFLG)
       IF (IRTFLG .NE. 0) RETURN        
-  
-C     GET MRC FILE PARAMETERS:  NZ,MZ, & NSTACK.(HANDLES .mrcs FILES OK)
-      CALL LUNGETNSTACK_MRC(LUN, NX,NY,NZ,MZ,NSTACK,IRTFLG)
+
+
+      CALL LUNGETNSTACK_MRC(LUN, NX,NY,NZ, MZ, NSTK_FLG,IRTFLG)
       IF (IRTFLG .NE. 0) RETURN        
 
-      !write(3,*)' In openfil_o_mrc, filnam: ',filnam(1:nlet)
-      !write(3,*)' In openfil_o_mrc, nz,mz,nstack: ',nz,mz,nstack !!!!!
-      !write(3,*)' In openfil_o_mrc,imgnum,mz,nstack: ',imgnum,mz,nstack
+C     NZ FROM FILE IS NOT VOLUME DIMENSION IF MRC VERSION: 2014*
+C                 ISPG (23)   NZ (1)     MZ (10)
+C       IMAGE           0      1          1
+C       IMAGE STACK     0     NSTK       NSTK
+C       VOLUME (Z)            NZ         NZ
 
-C     BARE STACK REFERENCE WITHOUT '@@' ALLOWED FROM 'ST' & 'LI'
-      IF (MZ > 1 .AND. IMGNUM < -1 ) THEN 
-C        BARE STACK REFERENCE NOT ALLOWED WITHOUT '@@' NORMALLY
-         CALL ERRT(101,'STACK INDICATOR (@@) MISSING',NE)
-         IRTFLG = 3
-         RETURN
+
+#if defined (SP_DBUGIO)
+      write(3,*)' In openfil_o_mrc  88 ; nx,ny:    ', nx,ny
+      write(3,*)' In openfil_o_mrc; 88 ; ispg:     ', ispg 
+      write(3,*)' In openfil_o_mrc  88 ; nz,mz:    ', nz,mz
+      write(3,*)' In openfil_o_mrc; 88 ; nstk_flg: ', nstk_flg
+#endif
+
+      IF (NSTK_FLG > = 0) THEN
+         IMGNUM = NSTK_FLG
       ENDIF
 
+#if defined (SP_DBUGIO)
+      write(3,*)' In openfil_o_mrc; imgnum,nstk_flg: ',imgnum,nstk_flg
+#endif
+
+C      BARE STACK REFERENCE WITHOUT '@@' ALLOWED FROM 'ST' & 'LI'  ?????
+C      IF (MZ > 1 .AND. IMGNUM == 0 ) THEN 
+C        BARE STACK REFERENCE NOT ALLOWED WITHOUT '@@' NORMALLY
+C         CALL ERRT(101,'STACK INDICATOR (@@) MISSING',NE)
+C         IRTFLG = 3
+C         RETURN
+C      ENDIF
+
 C     ENSURE STACKED IMAGE EXISTS
-      IF (DSP == 'O' .AND. (IMGNUM > 1 .AND. IMGNUM > NSTACK)) THEN
+      IF (DSP == 'O' .AND. (IMGNUM > 1 .AND. IMGNUM > NSTK_FLG)) THEN
          CALL ERRT(102,'IMAGE EXCEEDS HIGHEST IMAGE IN STACK',MZ)
          IRTFLG = 1
          RETURN        
       ENDIF
 
-      !write(3,*)' In openfil_o_mrc, dsp :'  , dsp 
-      !write(3,*)' In openfil_o_mrc, imgnum:', imgnum 
-      !write(3,*)' In openfil_o_mrc, nstack:', nstack
+C     UPDATE MZ AND NSTK_FLG IN MRC HEADER FOR NEW STACKED IMAGE
 
-C     UPDATE MZ AND NSTACK IN MRC HEADER FOR NEW STACKED IMAGE
       IF (DSP == 'N' .AND.
-     &    IMGNUM > 1 .AND. 
-     &    (NSTACK > 0 .or. MZ == 1) .AND. 
-     &    IMGNUM > NSTACK) THEN
+     &    IMGNUM  > 1 .AND. 
+     &    (NSTK_FLG > 0 .or. MZ == 1) .AND. 
+     &    IMGNUM > NSTK_FLG) THEN
+
+         NSTK_FLG = IMGNUM
+      
          ! EXTENDING STACK WITH A NEW IMAGE/VOLUME
-         !write(3,*)' In openfil_o_mrc2, dsp,imgnum:', dsp,imgnum,nstack
-         NSTACK = IMGNUM      
-         CALL LUNSETNSTACK_MRC(LUN, NZ,NSTACK,IRTFLG)
+
+#if defined (SP_DBUGIO)
+         write(3,*)' In openfil_o_mrc 2 Set|   nz,nstk_flg: ',  
+     &                                         nz,nstk_flg
+         write(3,*)' In openfil_o_mrc 2; Calling lunsetnstack ----'
+#endif
+
+         CALL LUNSETNSTACK_MRC(LUN, NZ, NSTK_FLG,IRTFLG)
          IF (IRTFLG .NE. 0) RETURN        
       ENDIF
 
+
 C     SET SPIDER IFORM IN COMMON CMBLOCK
       IFORM = 2
       IF (NZ > 1) IFORM = 3 
 
-C     SET IMGNUM AND NSTACK IN STATIC HEADER
-      !write(6,*)' In openfil_o_mrc - imgnum,nstack:',imgnum,nstack 
-      CALL LUNSETSTK_MRC(LUN,IMGNUM,NSTACK,IRTFLG)
+C     SET IMGNUM AND NSTK_FLG IN STATIC HEADER
+
+#if defined (SP_DBUGIO)
+      write(3,*)'  '
+      write(3,*)' In openfil_o_mrc 3  Set| imgnum,nstk_flg: ',
+     &                                     imgnum,nstk_flg
+      write(3,*)' In openfil_o_mrc 3  Calling lunsetstk ----'
+#endif
+ 
+      CALL LUNSETSTK_MRC(LUN,IMGNUM,NSTK_FLG,IRTFLG)
       IF (IRTFLG .NE. 0) RETURN        
 
-      IF (FCHAR(4:5) ==  'HE' .AND.  FCHAR(1:2) ==  '31') THEN
+#if defined (SP_DBUGIO)
+      write(3,*)' In openfil_o_mrc| fchar(1:2),fchar(4:5): ',
+     &                              fchar(1:2),'  ',fchar(4:5)
+      write(3,*) '    '
+#endif
+
+      IF (FCHAR(1:2) == '31' .AND. FCHAR(4:5) == 'HE') THEN
+
+C     IF (FCHAR(4:5) ==  'HE' .AND.  FCHAR(1:2) ==  '31') THEN
 C        SPECIAL KLUDGE FOR 'MRC HED' SO IT DOESN'T ALTER STATS
-C        SET FLAG FOR NORMAL RETURN	
+C        SET FLAG FOR NORMAL RETURN
+
+#if defined (SP_DBUGIO)
+         write(3,*)' In openfil_o_mrc; special return for MRC HED '
+         write(3,*)'    '
+#endif
+
          IRTFLG = 0
          RETURN
       ENDIF
 
 C     ADJUST FMIN...  FOR DIFFERENT MRC HEADER POSSIBILITIES
 C     DOES NOT PUT FILE VALUES FOR FMIN... INTO COMMON: CMBLOCK   
-C     FILE VALUES FOR FMIN... INTO COMMON: CMBLOCK SET LATER IN LUNSETCOMMON   
+C     FILE VALUES FOR FMIN... IN COMMON: CMBLOCK SET LATER WITH  
+C     LUNSETCOMMON
+
       CALL LUNGETSTATS_MRC(LUN,IMAMIT,FMINT,FMAXT,AVT,SIGT,IRTFLG)
       IF (IRTFLG .NE. 0) RETURN        
  
-      !write(3,*)' In openfil_o_mrc imami,fmin:',imami,fmin 
+#if defined (SP_DBUGIO)
+      write(3,*)' In openfil_o_mrc 4  Got imamit,fmaxt: ',imamit,fmaxt 
+#endif
 
-C     ENSURE THAT STAT'S IMAGE NUMBER IS SET CORRECTLY     
-      IF (IMAMI == 1 .AND. NSTACK <= 0) THEN
+C     ENSURE THAT STAT'S IMAGE NUMBER IS SET CORRECTLY 
+    
+      IF (IMAMIT == 1 .AND. NSTK_FLG <= 0) THEN
 C        NOT A STACK, SO FMIN/FMAX SHOULD BE OK FOR THIS MRC FILE
          CALL LUNSET_STATSIMG_MRC(LUN,1,IRTFLG)
 
-      ELSEIF (IMAMI == 0) THEN
-C        NO IDENTIFIABLE STATS IN MRC IMAGE 
-         !write(3,*)'In openfil_o_mrc, fmin,fmax,imami:',fmin,fmax,imami
+      ELSEIF (IMAMIT == 0) THEN
+C        NO IDENTIFIABLE STATS IN MRC IMAGE
+ 
+#if defined (SP_DBUGIO)
+         write(3,*)' In openfil_o_mrc 5; imamit: ',imamit
+         write(3,*)' In openfil_o_mrc 5; Calling lunset_statsimg '
+         write(3,*)'  '
+#endif
 
          CALL LUNSET_STATSIMG_MRC(LUN,0,IRTFLG)
+
       ENDIF
 
-      !write(6,*)' In openfil_o_mrc - iform,nz: ',iform,nz,nstack 
-      !write(6,*)' In openfil_o_mrc - nx,ny,nz: ',nx,ny,nz,nstack 
+#if defined (SP_DBUGIO)
+      write(3,*)' From openfil_o_mrc; iform:    ', iform 
+      write(3,*)' from openfil_o_mrc; nx,ny,nz: ', nx,ny,nz 
+#endif
 
 C     SET FLAG FOR NORMAL RETURN	
       IRTFLG = 0
@@ -325,6 +480,8 @@ C     ------------------- LOADHED_MRC ---------------------------------
 
 C     COPY MRC FILE HEADER INTO: MRC HEADER
 
+C     DISP  IS INPUT FOR OPSTREAMFILE USE
+
       IMPLICIT NONE
 
       INCLUDE 'CMBLOCK.INC'
@@ -342,17 +499,19 @@ C     INCLUSION FOR OPTIONAL MPI INITIALIZATION.
 
 C     WANT TO OPEN EXISTING MRC FILE FOR STREAM ACCESS
         
-c     write(6,*)' Opening old MRC file: ',FILNAM(1:nlet),
-c     &          '  Convert:',disp  
-
-      IRTFLG = 999   ! DO NOT ECHO OPENING INFO
+      IRTFLG  = 0
+      !IRTFLG = 999   ! DO NOT ECHO OPENING INFO  (sept 2025 al)
       CALL OPSTREAMFILE(.FALSE.,FILNAM(1:NLET),NULL,LUN,
      &                  'UNFORMATTED',DISP,' ',.TRUE.,IRTFLG)
 
-      !write(6,*)' Opened  old MRC file: ',FILNAM(1:nlet),
-c     &           '  Convert:',DISP,' Irtflg: ',irtflg  
+#if defined(NEVER_SP_DBUGIO)
+C23456  
+      write(3,*)' Opened old file; Disp,irtflg: ',disp,irtflg  
+      write(3,*)' Opened old file:              ',filnam(1:nlet)
+#endif
       IF (IRTFLG .NE. 0) RETURN
 
+
 #ifdef USE_MPI
       IF (ONLYONE_RED) THEN
          CALL BCAST_MPI('OPENFIL_MRC','IRTFLG',IRTFLG,1,'I',ICOMM)
@@ -365,19 +524,415 @@ c     &           '  Convert:',DISP,' Irtflg: ',irtflg
       IF (IRTFLG .NE. 0) RETURN
 
 C     READ OVERALL HEADER FROM MRC FILE 
+
       CALL LUNREDHED_MRC(LUN,.TRUE.,IRTFLG)
 
       IF (IRTFLG .NE. 0 .AND. MYPID <= 0) THEN
          WRITE(NOUT,*) '*** ERROR READING HEADER OF: ',FILNAM(:NLET)
          IF (IRTFLG .NE. 0) RETURN
       ENDIF
-     
+
       END
 
 
 
 
 
+@
+
+
+1.11
+log
+@debug output added, comments added
+@
+text
+@d30 2
+a31 1
+C  OPENFIL_O_MRC(LUNT,FILNAM,NLET,IMGNUM, NX,NY,NZ,NSTACK, IRTFLG)
+d38 1
+a38 1
+C       NLET     LENGTH OF FILE NAME                            (RET.)
+d41 4
+a44 2
+C       NX,NY,NZ DIMENSIONS OF IMAGE                            (RET.)
+C       NSTACK   STACK INDICATOR                                (RET.)
+d46 11
+a56 2
+C                   >=0 :  MAX IMAGE NUMBER NOW IN STACK.
+C       IRTFLG   ERROR RETURN FLAG.                             (RET.)
+d60 15
+a74 3
+C  VARIABLES:
+C       (23) ISPG == 0     CONTAINS IMAGE OR IMAGE STACK
+C       (23) ISPG == 1     CONTAINS VOLUMES
+d87 1
+a87 1
+     &                         NX,NY,NZ,NSTACK, IRTFLG)
+d96 2
+a97 1
+      INTEGER                 :: LUNT,NLET,IMGNUM, NX,NY,NZ,NSTACK
+d101 1
+a101 1
+      INTEGER                 :: I,NZMRC,MX,MY,MZ
+d130 1
+a130 1
+C     SET READ TO CONVERT TO LITTLE ENDIANNESS  (Why Sept 2025 al)
+d135 7
+a141 3
+#if defined (SP_DBUG)
+      write(3,*)' In openfil_o_mrc; nlet,filnam: ',nlet,filnam(:nlet)
+      write(3,*)' In openfil_o_mrc; imgnum,nstack: ',imgnum,nstack
+d144 5
+a148 3
+C     OPEN EXISTING FILE, CREATE HEADER OBJECT, AND CHECK ENDIANNESS 
+#if defined (SP_DBUG)
+      write(3,*)' In openfil_o_mrc, Call loadhed_mrc, disp:',disp
+a150 2
+      CALL LOADHED_MRC(LUN,FILNAM,NLET,DISP,IRTFLG)
+      
+d153 2
+a154 1
+#if defined (SP_DBUG)
+d158 1
+d160 3
+a162 1
+      IF (ENDOK)  CALL LUNSETFLIP(LUN,0,IRTFLG)
+d164 1
+a164 1
+      IF (.NOT. ENDOK) THEN
+d170 2
+a171 1
+C        OPEN FILE, CREATE HEADER OBJECT AND CHECK ENDEDNESS 
+d173 2
+a174 2
+#if defined (SP_DBUG)
+         write(3,*)' In openfil_o_mrc, call loadhed_mrc, disp:',disp
+d177 1
+d184 2
+a185 2
+#if defined (SP_DBUG)
+        write(3,*)' In openfil_o_mrc; mapc,mapr,maps: ',mapc,mapr,maps
+d198 1
+a198 1
+      
+d201 7
+a207 1
+          MSG = 'OPENFIL_O_MRC; OPENING FILE: ' // FILNAM(1:NLET)
+d209 1
+a209 1
+          IRTFLG =1
+d213 5
+a217 2
+C     GET IMAGE/VOLUME SIZE PARAMETERS AND MODE
+      CALL LUNGETMODSIZ_MRC(LUN,MRCMODE,NX,NY,NZMRC, MX,MY,MZ,IRTFLG)
+d220 1
+a220 1
+#if defined (SP_DBUG)
+a221 1
+      write(3,*)' In openfil_o_mrc; size (x,y,z),mz: ',nx,ny,nzmrc,mz
+d233 3
+a235 3
+#if defined (SP_DBUG)
+      !write(3,*)' In openfil_o_mrc; iversion,ispg: ', iversion,ispg
+      !write(3,*)' In openfil_o_mrc; nsymbt, nlabl: ', nsymbt, nlabl
+d237 19
+a257 2
+  
+C     GET MRC FILE PARAMETERS: NZ,MZ, & NSTACK.(HANDLES .mrcs FILES OK)
+d259 1
+a259 1
+      CALL LUNGETNSTACK_MRC(LUN, NX,NY,NZ,MZ,NSTACK,IRTFLG)
+d262 12
+a273 4
+#if defined (SP_DBUG)
+      write(3,*)' In openfil_o_mrc; filnam: ',filnam(1:nlet)
+      write(3,*)' In openfil_o_mrc; nz,mz,nstack: ',nz,mz,nstack 
+      write(3,*)' In openfil_o_mrc; imgnum,mz,nstack: ',imgnum,mz,nstack
+d276 6
+a281 9
+C     READ NLABL LABELS FROM FILE (<= 800 CHAR)
+      CALL LUNGETLABELS_MRC(LUN,NLABL,LABELS,IRTFLG)
+      IF (IRTFLG .NE. 0) RETURN
+  
+#if defined (SP_DBUG)
+      write(3,*)' In openfil_o_mrc; nlabl,labels: ',nlabl,labels(1:80)
+      
+      call lungetflip(lun,iflip,irtflg)
+      write(3,*) ' In openfil_o_mrcs, iflip: ',iflip
+d284 2
+a285 2
+C     BARE STACK REFERENCE WITHOUT '@@' ALLOWED FROM 'ST' & 'LI'
+      IF (MZ > 1 .AND. IMGNUM < -1 ) THEN 
+d287 4
+a290 4
+         CALL ERRT(101,'STACK INDICATOR (@@) MISSING',NE)
+         IRTFLG = 3
+         RETURN
+      ENDIF
+d293 1
+a293 1
+      IF (DSP == 'O' .AND. (IMGNUM > 1 .AND. IMGNUM > NSTACK)) THEN
+d299 1
+a299 5
+#if defined (SP_DBUG)
+      write(3,*)' In openfil_o_mrc; dsp: '  , dsp 
+      write(3,*)' In openfil_o_mrc; imgnum:', imgnum 
+      write(3,*)' In openfil_o_mrc; nstack:', nstack
+#endif
+a300 1
+C     UPDATE MZ AND NSTACK IN MRC HEADER FOR NEW STACKED IMAGE
+d302 6
+a307 3
+     &    IMGNUM > 1 .AND. 
+     &    (NSTACK > 0 .or. MZ == 1) .AND. 
+     &    IMGNUM > NSTACK) THEN
+d309 8
+a316 3
+         !write(3,*)'In openfil_o_mrc2; dsp,imgnum: ',dsp,imgnum,nstack
+         NSTACK = IMGNUM      
+         CALL LUNSETNSTACK_MRC(LUN, NZ,NSTACK,IRTFLG)
+d320 1
+d325 3
+a327 4
+C     SET IMGNUM AND NSTACK IN STATIC HEADER
+#if defined (SP_DBUG)
+      write(3,*)' In openfil_o_mrc; set imgnum,nstack: ',imgnum,nstack
+      write(3,*)' In openfil_o_mrc; Calling lunsetstk.mrc ----'
+d329 3
+d334 1
+a334 1
+      CALL LUNSETSTK_MRC(LUN,IMGNUM,NSTACK,IRTFLG)
+d337 9
+a345 1
+      IF (FCHAR(4:5) ==  'HE' .AND.  FCHAR(1:2) ==  '31') THEN
+d347 7
+a353 1
+C        SET FLAG FOR NORMAL RETURN	
+d366 2
+a367 2
+#if defined (SP_DBUG)
+      write(3,*)' In openfil_o_mrc; Got imamit,fmaxt: ',imamit,fmaxt 
+d372 1
+a372 1
+      IF (IMAMIT == 1 .AND. NSTACK <= 0) THEN
+d379 3
+a381 3
+#if defined (SP_DBUG)
+         write(3,*)' In openfil_o_mrc; imamit is 0: ',imamit
+         write(3,*)' In openfil_o_mrc; calling lunset_statsimg '
+d389 3
+a391 3
+#if defined (SP_DBUG)
+      write(3,*)' From openfil_o_mrc; iform,nz: ',iform,nz,nstack 
+      write(3,*)' From openfil_o_mrc; nx,ny,nz: ',nx,ny,nz,nstack 
+d406 2
+d425 2
+a426 5
+      !write(3,*)' Opening old MRC file: ',filnam(1:nlet),
+      !&         '  Disp:',disp  
+
+      !IRTFLG = 0
+      IRTFLG = 999   ! DO NOT ECHO OPENING INFO  (sept 2025 al)
+d430 5
+a434 2
+      !write(3,*)' Opened  old MRC file: ',filnam(1:nlet),
+      !&         ' Disp:',disp,' Irtflg: ',irtflg  
+d437 1
+d450 1
+d457 1
+a457 1
+     
+@
+
+
+1.10
+log
+@IRTFLG = 999   ! DO NOT ECHO OPENING INFO  (sept 2025 al)[D[D
+@
+text
+@d110 4
+a113 2
+      !write(6,*)' In openfil_o_mrc; nlet,filnam: ',nlet,filnam(:nlet)
+      !write(6,*)' In openfil_o_mrc; imgnum,nstack: ',imgnum,nstack
+d116 4
+a119 1
+      !write(6,*)' In openfil_o_mrc, call loadhed_mrc, disp:',disp
+d124 3
+a126 1
+      !write(6,*)' In openfil_o_mrc; mapc,mapr,maps: ',mapc,mapr,maps
+d139 4
+a142 1
+         !write(6,*)' In openfil_o_mrc, call loadhed_mrc, disp:',disp
+d148 4
+a151 1
+        !write(6,*)' In openfil_o_mrc; mapc,mapr,maps: ',mapc,mapr,maps
+d176 4
+a179 2
+      !write(6,*)' In openfil_o_mrc; mrcmode: ',mrcmode
+      !write(6,*)' In openfil_o_mrc; size (x,y,z),mz: ',nx,ny,nzmrc,mz
+a186 1
+
+d190 4
+a193 2
+      !write(6,*)' In openfil_o_mrc; iversion,ispg: ', iversion,ispg
+      !write(6,*)' In openfil_o_mrc; nsymbt, nlabl: ', nsymbt, nlabl
+d195 1
+d197 2
+a198 1
+C     GET MRC FILE PARAMETERS:  NZ,MZ, & NSTACK.(HANDLES .mrcs FILES OK)
+d202 5
+a206 3
+      !write(6,*)' In openfil_o_mrc; filnam: ',filnam(1:nlet)
+      !write(6,*)' In openfil_o_mrc; nz,mz,nstack: ',nz,mz,nstack !!!!!
+      !write(6,*)' In openfil_o_mrc; imgnum,mz,nstack: ',imgnum,mz,nstack
+d210 4
+a213 2
+      IF (IRTFLG .NE. 0) RETURN  
+      !write(6,*)' In openfil_o_mrc; nlabl,labels: ',nlabl,labels(1:80)
+d215 3
+a217 2
+      !call lungetflip(lun,iflip,irtflg)
+      !write(6,*) ' In  openfil_o_mrcs, iflip: ',iflip
+d234 5
+a238 3
+      !write(6,*)' In openfil_o_mrc; dsp: '  , dsp 
+      !write(6,*)' In openfil_o_mrc; imgnum:', imgnum 
+      !write(6,*)' In openfil_o_mrc; nstack:', nstack
+d246 1
+a246 1
+         !write(6,*)' In openfil_o_mrc2; dsp,imgnum: ', dsp,imgnum,nstack
+d257 6
+a262 1
+      !write(6,*)' In openfil_o_mrc; imgnum,nstack: ',imgnum,nstack 
+d275 1
+a275 1
+C     FILE VALUES FOR FMIN... INTO COMMON: CMBLOCK SET LATER IN 
+d281 7
+a287 4
+      !write(6,*)' In openfil_o_mrc; imami,fmin: ',imami,fmin 
+
+C     ENSURE THAT STAT'S IMAGE NUMBER IS SET CORRECTLY     
+      IF (IMAMI == 1 .AND. NSTACK <= 0) THEN
+d291 8
+a298 3
+      ELSEIF (IMAMI == 0) THEN
+C        NO IDENTIFIABLE STATS IN MRC IMAGE 
+         !write(6,*)'In openfil_o_mrc, fmin,fmax,imami:',fmin,fmax,imami
+d301 1
+d304 4
+a307 2
+      !write(6,*)' In openfil_o_mrc; iform,nz: ',iform,nz,nstack 
+      !write(6,*)' In openfil_o_mrc; nx,ny,nz: ',nx,ny,nz,nstack 
+d338 1
+a338 1
+      !write(6,*)' Opening old MRC file: ',filnam(1:nlet),
+d346 1
+a346 1
+      !write(6,*)' Opened  old MRC file: ',filnam(1:nlet),
+@
+
+
+1.9
+log
+@DEBUG output added, nlabl and irtflg returned values fixed
+@
+text
+@d105 1
+a105 1
+C     SET READ TO CONVERT TO LITTLE ENDEDNESS
+d113 1
+a113 1
+C     OPEN EXISTING FILE, CREATE HEADER OBJECT, AND CHECK ENDEDNESS 
+d297 2
+a298 2
+c     write(6,*)' Opening old MRC file: ',FILNAM(1:nlet),
+c     &          '  Convert:',disp  
+d300 2
+a301 2
+      irtflg = 0
+      !IRTFLG = 999   ! DO NOT ECHO OPENING INFO
+d305 2
+a306 2
+c      write(6,*)' Opened  old MRC file: ',filnam(1:nlet),
+c     &          '  Convert:',DISP,' Irtflg: ',irtflg  
+@
+
+
+1.8
+log
+@code for fmin... retrieval altered
+@
+text
+@d4 3
+d12 1
+a12 1
+C=* Copyright 1985-2019  Health Research Inc.,                         *
+d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+d89 1
+a89 1
+      INTEGER                 :: ISPG,INOW,IGO,IEND,ILAB
+d110 2
+a111 2
+      !write(3,*)' In openfil_o_mrc, nlet,filnam:',nlet,filnam(:nlet)
+      !write(3,*)' In openfil_o_mrc, imgnum:',imgnum
+d119 1
+a119 1
+      !write(3,*)' In openfil_o_mrc, mapc,r,s: ',mapc,mapr,maps
+d138 1
+a138 1
+         !write(3,*)' In openfil_o_mrc, mapc,r,s: ',mapc,mapr,maps
+d163 2
+a164 2
+      !write(6,*)' In openfil_o_mrc, mrcmode: ',mrcmode
+      !write(3,*)' In openfil_o_mrc, size (x,y,z),mz: ',nx,ny,nzmrc,mz
+a171 5
+      !write(3,*)' In openfil_o_mrc, imgnum,mz: ',imgnum,mz
+
+C     READ NLABL LABELS FROM FILE (<= 800 CHAR)
+      CALL LUNGETLABELS_MRC(LUN,NLABL,LABELS,IRTFLG)
+      IF (IRTFLG .NE. 0) RETURN        
+d175 3
+a177 2
+      !write(3,*)' In openfil_o_mrc, ispg,iversion: ', ispg,iversion
+      !write(6,*)' In openfil_o_mrc, nsymbt, nlabl: ', nsymbt, nlabl
+d184 11
+a194 3
+      !write(3,*)' In openfil_o_mrc, filnam: ',filnam(1:nlet)
+      !write(3,*)' In openfil_o_mrc, nz,mz,nstack: ',nz,mz,nstack !!!!!
+      !write(3,*)' In openfil_o_mrc,imgnum,mz,nstack: ',imgnum,mz,nstack
+d211 3
+a213 3
+      !write(3,*)' In openfil_o_mrc, dsp :'  , dsp 
+      !write(3,*)' In openfil_o_mrc, imgnum:', imgnum 
+      !write(3,*)' In openfil_o_mrc, nstack:', nstack
+d221 1
+a221 1
+         !write(3,*)' In openfil_o_mrc2, dsp,imgnum:', dsp,imgnum,nstack
+d232 1
+a232 1
+      !write(6,*)' In openfil_o_mrc - imgnum,nstack:',imgnum,nstack 
+d245 3
+a247 1
+C     FILE VALUES FOR FMIN... INTO COMMON: CMBLOCK SET LATER IN LUNSETCOMMON   
+d251 1
+a251 1
+      !write(3,*)' In openfil_o_mrc imami,fmin:',imami,fmin 
+d260 1
+a260 1
+         !write(3,*)'In openfil_o_mrc, fmin,fmax,imami:',fmin,fmax,imami
+d265 2
+a266 2
+      !write(6,*)' In openfil_o_mrc - iform,nz: ',iform,nz,nstack 
+      !write(6,*)' In openfil_o_mrc - nx,ny,nz: ',nx,ny,nz,nstack 
+d300 2
+a301 1
+      IRTFLG = 999   ! DO NOT ECHO OPENING INFO
+d305 2
+a306 2
+      !write(6,*)' Opened  old MRC file: ',FILNAM(1:nlet),
+c     &           '  Convert:',DISP,' Irtflg: ',irtflg  
 @
 
 
diff --git src/RCS/openinln.f,v src/RCS/openinln.f,v
index 11ba78d3..e862bb42 100644
--- src/RCS/openinln.f,v
+++ src/RCS/openinln.f,v
@@ -1,4 +1,4 @@
-head	1.49;
+head	1.50;
 access;
 symbols
 	pre_mrcs:1.49
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.50
+date	2025.11.10.22.33.35;	author dean;	state Exp;
+branches;
+next	1.49;
+
 1.49
 date	2018.10.03.14.34.11;	author leith;	state Exp;
 branches;
@@ -275,9 +280,9 @@ desc
 @
 
 
-1.49
+1.50
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -293,7 +298,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2012  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -842,6 +847,17 @@ C      CALL memcpy_(IPTNOW(IGOM1 + 1),BUF(1),NB*4) DOES NOT WORK!!
 @
 
 
+1.49
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.48
 log
 @TOBEDEALLOC OVERFLOW BUG fixed   for deleting non-existing inline file
diff --git src/RCS/openstk.f,v src/RCS/openstk.f,v
index 282c6c9f..194f562c 100644
--- src/RCS/openstk.f,v
+++ src/RCS/openstk.f,v
@@ -1,4 +1,4 @@
-head	1.97;
+head	1.99;
 access;
 symbols
 	pre_mrcs:1.97
@@ -24,6 +24,16 @@ locks; strict;
 comment	@c @;
 
 
+1.99
+date	2025.11.10.22.33.58;	author dean;	state Exp;
+branches;
+next	1.98;
+
+1.98
+date	2025.09.21.15.33.46;	author dean;	state Exp;
+branches;
+next	1.97;
+
 1.97
 date	2018.10.03.14.34.11;	author leith;	state Exp;
 branches;
@@ -515,9 +525,9 @@ desc
 @
 
 
-1.97
+1.99
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -539,9 +549,9 @@ C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2016  Health Research Inc.,                         *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -603,6 +613,7 @@ C--*********************************************************************
         CHARACTER (LEN=MAXNAM)   :: FILNOAT,FILNPE
         CHARACTER (LEN=2*MAXNAM) :: MSG
 	LOGICAL                  :: EX,ISDIGI,CALLERRTRED,INDXD
+        INTEGER                  :: IMUSED
 
 #ifdef USE_MPI
         include 'mpif.h'
@@ -794,8 +805,16 @@ C	      FOR DISP=Z, DO NOT STOP THE BATCH JOB BY CALLING ERRT
            ENDIF
 
 C          OPEN EXISTING OVERALL STACK FILE, RETURNS MAXIM IN NSTACK
+
+           !write(3,*)'    '
+           !write(3,*)' --------- open old before openfil------------------'
+
 	   CALL OPENFIL(0,FILNOAT,LUN, NX,NY,NZ,NSTACK,
      &                  ITYPE,'O',.FALSE.,IRTFLGT)
+
+           !write(3,*)' --------- open old after openfil------------------'
+           !write(3,*)' In openstk,lun,nstack,irt.:',lun,nstack,irtflgt
+
            IF (IRTFLGT .NE. 0)  RETURN
 
            IF (NSTACK <= -2) THEN
@@ -819,19 +838,23 @@ C             STOP IF REQUESTED IMAGE NOT IN STACK
 C          SET OFFSET INTO LUNSTK FOR THIS STACKED IMAGE
 
            CALL LUNSETIMGOFF(LUN,IMGNUM,NX,IRTFLGT)
-           IF (IRTFLGT .NE. 0) RETURN
+           !write(3,*)' In openstk,lun,imgnum,nx,irt:',lun,imgnum,irtflgt
+            IF (IRTFLGT .NE. 0) RETURN
 
 C          GET SPECIFIED IMAGE HEADER FROM STACK FILE LOCATION
            CALL LUNREDHED(LUN,NX,IMGNUM,CALLERRTRED,IRTFLGT)
+
+           !write(3,*)' In openstk,lun,imgnum,tred+++:',lun,imgnum,callerrtred
+
            IF (IRTFLGT .NE. 0) RETURN
 
 C          RECOVER IMAGE PARAMETERS FROM SPECIFIC IMAGE HEADER
 
 C          GET IMUSED FOR THIS CURRENT IMAGE
+           IMUSED = IMGNUM
            CALL LUNGETINUSE(LUN,IMUSED,IRTFLGT)
 
-
-           !write(6,*) '  in openstk, imgnum,imused:',imgnum,imused
+           !write(3,*)' In openstk,lun,imgnum,imused----:',lun,imgnum,imused
 
            IF (IMUSED .NE. IMGNUM) THEN
 C             NO EXISTING IMAGE WITHIN STACK??
@@ -840,6 +863,8 @@ C             NO EXISTING IMAGE WITHIN STACK??
 C                SOME VERY OLD STACKS DID NOT HAVE IMGNUM IN THEM
                  CALL LUNGET25(LUN,IVAL,IRTFLGT)
 
+                 !write(3,*)' After lunget25,lun,ival,irtflgt:',lun,ival,irtflgt
+
                  IF (IVAL .NE. 1) THEN
 C                   STACK MAY LACK IMAGE OR HAS BAD EM2EM HEADER
 
@@ -847,7 +872,7 @@ C                   GET RECORD INFO (CAN BE FROM OVERALL HEADER)
                     CALL LUNGETLAB(LUN,NDUM1,NDUM2,NRECS,
      &                                 NDUM3,NDUM4,IRTFLGT)
 
-                    !write(6,*) '  imgnum,nrecs:',imgnum,nrecs,disp
+                    !write(3,*)' In openstk, imgnum,nrecs,disp:',imgnum,nrecs,disp(1:1)
 
                     IF (IMGNUM > 0 .AND. NRECS <= 0 .AND.
      &                   DISP == 'Z') THEN
@@ -910,6 +935,44 @@ C       SET FLAG FOR NORMAL RETURN
 @
 
 
+1.98
+log
+@gfort changes
+@
+text
+@d22 1
+a22 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
+1.97
+log
+@email_health_dept
+@
+text
+@d20 1
+a20 1
+C=* Copyright 1985-2016  Health Research Inc.,                         *
+d84 1
+d276 4
+d282 4
+d309 2
+a310 1
+           IF (IRTFLGT .NE. 0) RETURN
+d314 3
+d322 1
+d325 1
+a325 2
+
+           !write(6,*) '  in openstk, imgnum,imused:',imgnum,imused
+d334 2
+d343 1
+a343 1
+                    !write(6,*) '  imgnum,nrecs:',imgnum,nrecs,disp
+@
+
+
 1.96
 log
 @'FS' ON MISSING STACKED IMAGE bug,  ==
diff --git src/RCS/opfilec.f,v src/RCS/opfilec.f,v
index d1ed9631..3dd80a3c 100644
--- src/RCS/opfilec.f,v
+++ src/RCS/opfilec.f,v
@@ -1,4 +1,4 @@
-head	1.56;
+head	1.63;
 access;
 symbols
 	pre_mrcs:1.53
@@ -24,6 +24,41 @@ locks; strict;
 comment	@c @;
 
 
+1.63
+date	2025.11.10.22.33.56;	author dean;	state Exp;
+branches;
+next	1.62;
+
+1.62
+date	2025.10.25.15.20.21;	author dean;	state Exp;
+branches;
+next	1.61;
+
+1.61
+date	2025.10.16.19.43.47;	author dean;	state Exp;
+branches;
+next	1.60;
+
+1.60
+date	2025.10.03.14.23.38;	author dean;	state Exp;
+branches;
+next	1.59;
+
+1.59
+date	2025.09.26.16.47.39;	author dean;	state Exp;
+branches;
+next	1.58;
+
+1.58
+date	2025.09.26.14.05.22;	author dean;	state Exp;
+branches;
+next	1.57;
+
+1.57
+date	2025.09.21.15.28.16;	author dean;	state Exp;
+branches;
+next	1.56;
+
 1.56
 date	2020.01.21.16.21.38;	author leith;	state Exp;
 branches;
@@ -310,9 +345,9 @@ desc
 @
 
 
-1.56
+1.63
 log
-@comment
+@*** empty log message ***
 @
 text
 @
@@ -331,14 +366,15 @@ C                        FOURIER ERRT            DEC 2010 ArDean Leith
 C                        KEEPEXT LOGIC           JUN 2014 ArDean Leith
 C                        INDEX(FILNAM,'.' BUG    AUG 2014 ArDean Leith
 C                        MRC SUPPORT             MAY 2019 ArDean Leith
+C                        DEBUG OUTPUT ADDED      SEP 2025 ArDean Leith 
 C
 C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2019  Health Research Inc.,                         *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -354,8 +390,9 @@ C=* along with this program. If not, see <http://www.gnu.org/licenses> *
 C=*                                                                    *
 C **********************************************************************
 C
-C  OPFILEC(LUNT,ASKNAM,FILNAM,LUN,DISPT,NX,NY,ITYPE,NZ,
-C          MAXIM,PROMPT,FOUROK,IRTFLG)
+C
+C  OPFILEC(LUNT,ASKNAM,FILNAM,LUN,DISPT,ITYPE,
+C          NX,NY,NZ,MAXIM, PROMPT,FOUROK,IRTFLG)
 C
 C  PURPOSE:         SOLICITS SPIDER OR MRC FILE NAME AND OPENS FILE
 C  
@@ -381,11 +418,12 @@ C                   'U'  -   IT IS NOT KNOWN IF THE FILE EXISTS.
 C                            NX, NY, NZ, AND ITYPE MUST 
 C                            BE SENT.  IF THE FILE ALREADY EXISTS, IT 
 C                            WILL BE REPLACED.
-C                   'K & M'-    NO LONGER USED.
+C                   'K & M'-    NO LONGER USED
+C
 C        ITYPE      IFORM FOR FILE                        (SENT OR RET) 
 C        NX         IMAGE SIZE                            (SENT OR RET)
 C        NY         IMAGE SIZE                            (SENT OR RET)
-C        NZ         IMAGE SIZE                            (SENT OR RET)
+C        NZ         VOLUME SIZE                           (SENT OR RET)
 C        MAXIM      STACK INDICATOR                          (SENT/RET)
 C                   ON INPUT (IF NEW):
 C                        0 IS FOR SPECIFIC IMAGE           
@@ -393,11 +431,11 @@ C                       +1 STACK
 C                       -1 INDEXED STACK                               
 C                   ON INPUT (IF EXISTING):
 C                        0 IS FOR SPECIFIC IMAGE ONLY         
-C                       <0 or >0 ALLOWS WHOLE STACK OPERATION                              
+C                       <0 or >0 ALLOWS WHOLE STACK OPERATION            C                  
 C                   ON OUTPUT:
 C                       -2 NON-STACK IMAGE                
 C                       -1 STACKED IMAGE                  
-C                     >= 0 IS CURRENT MAX. IMAGE NO. FOR STACK             
+C                     >= 0 IS CURRENT MAX. IMAGE NO. FOR STACK           C  
 C        PROMPT     PROMPT FOR FILNAME                           (SENT)
 C                       AT END:  ~  SKIPS FILE ON PROMPT
 C                                ~7 CAN OPEN A STACK WITHOUT @@
@@ -454,36 +492,46 @@ C23456789012345678901234567890123456789012345678901234567890123456789012
 C--*********************************************************************
 
         SUBROUTINE OPFILEC(LUNT,ASKNAM,FILNAM,LUN,DISPT,ITYPE,
-     &                  NX,NY,NZ,MAXIM,PROMPT,FOUROK,IRTFLG)
+     &                  NX,NY,NZ,MAXIM, PROMPT,FOUROK,IRTFLG)
 
         IMPLICIT NONE
 
         INCLUDE 'CMBLOCK.INC'
         INCLUDE 'CMLIMIT.INC'
 
+        integer           :: lunara,lunstk,lunarb,lunflip,iflip
+        common /lunara/ lunara(100),lunstk(100),lunarb(100),lunflip(100)
+
+
         CHARACTER (LEN=*) :: FILNAM,PROMPT,DISPT
         INTEGER           :: LUNT,LUN,ITYPE,NX,NY,NZ,MAXIM,IRTFLG
         LOGICAL           :: ASKNAM,FOUROK
 
-        INTEGER           :: LENP,NLETI,NBUFSIZT,IRTFLGT,NE
-        INTEGER           :: NSTACK
+        INTEGER           :: LENP,NLETI,NBUFSIZT,IRTFLGT,NE, IRTFLG26
+        INTEGER           :: NSTACK,NSTK_FLG, ilent
         CHARACTER (LEN=1) :: DSP,DISP
         LOGICAL           :: OPSTKNOAT,KEEPEXT
         CHARACTER (LEN=1) :: NULL = CHAR(0)
 
         INTEGER           :: lnblnkn,lnblnk
-        LOGICAL           :: ISMRCFILE
+        LOGICAL           :: ISMRCFILE          ! FUNCTION
+        LOGICAL           :: ISMRC            
 
 C       HACK TO OPEN NEW FILES GREATER THAN NBUFSIZ (DANGEROUS)
         DISP = DISPT
         IF (DISP(1:1) == 'B') DISP = 'U'
-        !write(3,*)' In opfilec, itype: ',itype
+
+C       HACK TO OPEN MRC FILE WITHOUT RESETTING HEADER VALUES
+        IRTFLG26   = 1                    ! NEVER USED!
+        IF (IRTFLG == 26) IRTFLG26 = 26   ! NEVER USED!!
+
+        !write(3,*)' In opfilec; itype: ',itype
 
         LENP = lnblnkn(PROMPT)
-C       CAN PASS ~7  AT END OF PROMTP TO OPEN* TO OPEN A STACK WITHOUT @@
+C       CAN PASS ~7 AT END OF PROMTP TO OPEN* TO OPEN A STACK WITHOUT @@
         OPSTKNOAT = (PROMPT(LENP-1:LENP) == '~7')
 
-C       CAN PASS ~9  AT END OF PROMTP TO OPEN* TO KEEP INCOMING EXTENSION
+C       CAN PASS ~9 AT END OF PROMTP TO OPEN* TO KEEP INCOMING EXTENSION
         KEEPEXT = (PROMPT(LENP-1:LENP) == '~9')
 
         KEEPEXT = (KEEPEXT      .AND. 
@@ -498,9 +546,11 @@ C       SET DEFAULT ERROR RETURN IRTFLG
            CALL ERRT(102,'PGM. ERROR: LUN MUST BE 1...100',LUN)
            RETURN
         ENDIF
-        !write(3,*)' In opfilec, asknam,keepext: ',asknam,keepext
-        !write(3,*)' In opfilec, itype,dispt: ',itype,disp
-        !write(3,*)' In opfilec, filnam(:20): ',filnam(1:20)
+
+#if defined (SP_DBUGIO)
+        write(3,*)' In opfilec; asknam,keepext: ', asknam,keepext
+        write(3,*)' In opfilec; itype,disp:     ', itype,disp
+#endif
 
         IF (ASKNAM) THEN
 C          SOLICIT FILE NAME, KEEPS EXTENSION IF PROMPT ENDS WITH: ~9 
@@ -510,6 +560,11 @@ C          SOLICIT FILE NAME, KEEPS EXTENSION IF PROMPT ENDS WITH: ~9
            NLETI = lnblnk(FILNAM)
         ENDIF
 
+#if defined (SP_DBUGIO)
+        write(3,*)' In opfilec; filnam(1:nleti):   ', filnam(1:nleti)
+#endif
+
+
         DSP = 'O'
         IF (DISP(1:1) .NE. 'O' .AND. 
      &      DISP(1:1) .NE. 'Z' .AND.
@@ -521,28 +576,55 @@ C          HACK TO OPEN FILES GREATER THAN NBUFSIZ (DANGEROUS)
            IF (DISPT(1:1) == 'B') NBUFSIZT = HUGE(NBUFSIZT)
 
 C          CHECK THAT NECESSARY SIZE... INFO IS HERE
+
+           !write(3,*)' In opfilec; itype,nx,ny,nz: ',itype,nx,ny,nz
+
            CALL OPENCHK(NX,NY,NZ,ITYPE,NBUFSIZT,IRTFLGT)
+           !write(3,*)' In opfilec; irtflgt: ',irtflgt
+
            IF (IRTFLGT .NE. 0) RETURN    
-           DSP = 'N'
+           DSP =  'N'
         ENDIF
 
-        IF (ISMRCFILE(FILNAM)) THEN
+        ISMRC = ISMRCFILE(FILNAM)
 
-C          WANT TO OPEN OLD OR NEW MRC FILE FOR STREAM ACCESS
-           CALL OPENFIL_MRC(LUN,FILNAM,NLETI,NX,NY,NZ,NSTACK,ITYPE,
-     &                      DSP,IRTFLG)
+
+
+        IF (ISMRC) THEN
+
+C          WANT TO OPEN OLD OR NEW MRC FILE FOR STREAM ACCESS xxxxxxxx
+
+#if defined (SP_DBUGIO)
+           !write(3,*)' In opfilec; nx,ny,nz: ',nx,ny,nz
+           ilent = lnblnkn(filnam)
+           write(3,*)' In opfilec; filnam:   ',filnam(1:ilent)
+           write(3,*)' In opfilec; Calling openfil_mrc --------'
+           write(3,*)' ' 
+#endif
+
+           NSTK_FLG =  0   ! UNUSED BY OPENFIL_MRC  ON INPUT
+           CALL OPENFIL_MRC(LUN,FILNAM,NLETI,NX,NY,NZ, NSTK_FLG,
+     &                      ITYPE, DSP,IRTFLG)
            IF (IRTFLG .NE. 0) RETURN
-           IFORM = ITYPE
-           MAXIM = NSTACK
 
-           RETURN           ! END OF MRC CODE
+           MAXIM = NSTK_FLG
+
+#if defined (SP_DBUGIO)
+           write(3,*)' In opfilec; nz,maxim: ', nz,maxim
+           write(3,*)' Finished in opfilc  for MRC , Returning ------ '
+           write(3,*)'   '  
+#endif
+           RETURN           ! END OF MRC CODE xxxxxxxxxxxxxxxxxxxxxxx
+
 
         ELSE
-C          WANT TO OPEN NEW OR OLD SPIDER FILE
+C          WANT TO OPEN OLD OR NEW SPIDER FILE
+           !write(3,*)' In opfilc Calling: lunnewhdr'
 
 C          CREATE A NEW HEADER OBJECT FOR THIS LUN, SET LUN FOR SPIDER
            CALL LUNNEWHDR(LUN,IRTFLGT)
            IF (IRTFLGT .NE. 0) RETURN
+           !write(3,*)' In opfilc after callin: lunnewhdr'
 
 C          PUT FILENAME AND DSP IN OFF-FILE AREA OF THE HEADER OBJECT
            CALL LUNSETFILE(LUN,FILNAM,DSP,IRTFLGT)
@@ -552,31 +634,42 @@ C          PUT ISBARE IN STATIC AREA OF HEADER OBJECT
            CALL LUNBAREFILE(LUN,FILNAM,IRTFLGT)
            IF (IRTFLGT .NE. 0) RETURN
 
+           !write(3,*)' In opfilc Callin: lunsetluns: ', lun
+
 C          MAKE SURE THE STACK OFFSET IS ALWAYS ZEROED, LUNARB SET ...
            CALL LUNSETLUNS(LUN,0,0,LUN,0,IRTFLGT)
            IF (IRTFLGT .NE. 0) RETURN
 
+           !write(3,*)' In opfilc after set luns; filnam: ',filnam
+
            IRTFLG = 0
            IF (INDEX(FILNAM,'@@') == 0) THEN
 
-C             NOT AN IMAGE STACK, BUT MAY BE AN INLINE FILE. 
-C             NOTE: THIS IS THE PATH FOR 'REGULAR' SPIDER IMAGE FILES.
+C             NOT AN IMAGE STACK, BUT MAY BE AN INLINE or 'REGULAR'                    SPIDER FILE.
 
-              !write(3,*)' In opfilec, call openfil itype:',itype,nstack
+#if defined (SP_DBUGIO)
+              !write(3,*)' In opfilec, B4 openfil itype,nstack:',
+      !&                                           itype,nstack
+              !write(3,*)' In opfilec, B4 openfil disp: ',disp
+              !write(3,*)' In opfilec; B4 openfil  ---------------'
+#endif
+  
               NSTACK = 0
-	      CALL OPENFIL(LUNT,FILNAM,LUN,NX,NY,NZ,NSTACK,
+              CALL OPENFIL(LUNT,FILNAM,LUN,NX,NY,NZ,NSTACK,
      &                     ITYPE,DISP(1:1),KEEPEXT,IRTFLG)
 
-              !write(3,*)' In opfilec, openfil returned filnam:',filnam
-              !write(3,*)' In opfilec, nstack,irtflg:',nstack,irtflg
+#if defined (SP_DBUGIO)
+              !write(3,*)' In opfilec; got filnam:',filnam
+              !write(3,*)' In opfilec; nstack,irtflg: ',nstack,irtflg
+#endif
 
               IF (IRTFLG .NE. 0) RETURN
 
 C             RETURNS NSTACK -2 FOR NON-STACK or MAXIM
 
               IF (NSTACK >= 0 .AND. .NOT. OPSTKNOAT ) THEN 
-C                BARE STACK REFERENCE ALLOWED WITHOUT '@@' FROM 'ST' & 'LI'
-C                BARE STACK REFERENCE NOT ALLOWED WITHOUT '@@' NORMALLY
+C                BARE STACK REF ALLOWED WITHOUT '@@' FROM 'ST'& 'LI'
+C                BARE STACK REF NOT ALLOWED WITHOUT '@@' NORMALLY
                  CALL ERRT(101,'STACK INDICATOR (@@) MISSING',NE)
                  IRTFLG = 3
                  RETURN
@@ -591,10 +684,20 @@ C             INLINE IMAGE STACK ACCESS WANTED
            ELSE
 C             WANT TO ACCESS A FILE BASED SPIDER IMAGE STACK
               NSTACK = MAXIM
+
+#if defined (SP_DBUGIO)
+              !write(3,*)' In opfilc;; lunt,lun,nstack: ',
+              !&     lunt,lun,nstack,itype,'  ',filnam(:33)
+#endif
+
               CALL OPENSTK(LUNT,FILNAM,LUN,NX,NY,NZ,
      &                     NSTACK,ITYPE,DISP(1:1),IRTFLG)
 
-           ENDIF
+#if defined (SP_DBUGIO)
+              !write(3,*)' In opfilc; filnam: ',filnam
+#endif
+
+            ENDIF
 
 C
 C          RETURN IF THERE IS ANY ERROR OPENING FILE IN OPEN*
@@ -604,25 +707,409 @@ C          RETURN IF THERE IS ANY ERROR OPENING FILE IN OPEN*
      &          DISP(1:1) == 'Z'  .OR. 
      &          DISP(1:1) == 'E') .AND.
      &          ITYPE < 0 .AND. .NOT. FOUROK) THEN
-C             CAN NOT USE EXISTING FOURIER FILE
+C            CAN NOT USE EXISTING FOURIER FILE
              CALL ERRT(101,'OPERATION DOES NOT ACCEPT FOURIER FILES',NE)
              IRTFLG = 2
              RETURN
 
            ELSEIF (.NOT. OPSTKNOAT .AND. 
      &             MAXIM == 0 .AND. NSTACK >= 0) THEN
-C             THIS OPERATION DOES NOT ACCEPT WHOLE STACKS 
+C            THIS OPERATION DOES NOT ACCEPT WHOLE STACKS 
              CALL ERRT(101,'OPERATION DOES NOT WORK ON WHOLE STACKS',NE)
-              IRTFLG = 4
-              RETURN
+             IRTFLG = 4
+             RETURN
            ENDIF
 
            IFORM = ITYPE
-           MAXIM = NSTACK
+           MAXIM = NSTACK 
+
+#if defined (SP_DBUGIO)
+           !write(3,*)' End opfilc; maxim,nstack: ',maxim,nstack
+           !call lungetflip(lunt,iflip,irtflg)
+           !write(3,*)' In opfilec: lunt,iflip: ',     lunt,iflip
+           !write(3,*)' In opfilec: lunflip(lunt): ',  lunflip(lunt) 
+           !write(3,*)' Leaving opfilc; iform,maxim: ',iform,maxim
+           !write(3,*)' ------------ LEAVING OPFILC --------'
+#endif
 
-        ENDIF   ! END OF: SPIDER FILE
+        ENDIF      ! END OF: SPIDER FILE
 
         END
+
+
+
+
+
+
+@
+
+
+1.62
+log
+@removed debug output
+@
+text
+@d41 3
+a43 2
+C  OPFILEC(LUNT,ASKNAM,FILNAM,LUN,DISPT,NX,NY,ITYPE,NZ,
+C          MAXIM,PROMPT,FOUROK,IRTFLG)
+d69 2
+a70 1
+C                   'K & M'-    NO LONGER USED.
+d74 1
+a74 1
+C        NZ         IMAGE SIZE                            (SENT OR RET)
+d82 1
+a82 1
+C                       <0 or >0 ALLOWS WHOLE STACK OPERATION                              
+d86 1
+a86 1
+C                     >= 0 IS CURRENT MAX. IMAGE NO. FOR STACK             
+d143 1
+a143 1
+     &                  NX,NY,NZ,MAXIM,PROMPT,FOUROK,IRTFLG)
+d158 2
+a159 2
+        INTEGER           :: LENP,NLETI,NBUFSIZT,IRTFLGT,NE
+        INTEGER           :: NSTACK
+d165 2
+a166 1
+        LOGICAL           :: ISMRCFILE
+d172 4
+d198 4
+a201 3
+        !write(3,*)' In opfilec; asknam,keepext: ',asknam,keepext
+        !write(3,*)' In opfilec; itype,disp:     ',itype,disp
+        !write(3,*)' In opfilec; filnam(1:20):   ',filnam(1:20)
+d211 5
+d237 5
+a241 5
+#if defined (SP_DBUGIO)
+        write(3,*)' In opfilc; ismrcfile(filnam):',ismrcfile(filnam)
+#endif
+ 
+        IF (ISMRCFILE(FILNAM)) THEN
+d243 1
+a243 1
+C          WANT TO OPEN OLD OR NEW MRC FILE FOR STREAM ACCESS
+d246 4
+a249 2
+           write(3,*)' In opfilc; nstack,filnam: ',nstack,filnam(1:30)
+           write(3,*)' In opfilc; Calling openfil_mrc --------'
+d252 4
+a255 3
+ 
+           CALL OPENFIL_MRC(LUN,FILNAM,NLETI,NX,NY,NZ,NSTACK,ITYPE,
+     &                      DSP,IRTFLG)
+a256 2
+           IFORM = ITYPE
+           MAXIM = NSTACK
+d258 8
+a265 1
+           !write(3,*)' In opfilc returning after openfil_mrc ------7'
+a266 1
+           RETURN           ! END OF MRC CODE
+d269 2
+a270 2
+C          WANT TO OPEN NEW OR OLD SPIDER FILE
+           !write(3,*)' In opfilc callin: lunnewhdr'
+d285 1
+a285 1
+           !write(3,*)' In opfilc callin: lunsetluns: ', lun
+d290 1
+d296 1
+a296 2
+C             NOT AN IMAGE STACK, BUT MAY BE AN INLINE FILE. 
+C             NOTE: THIS IS THE PATH FOR 'REGULAR' SPIDER IMAGE FILES.
+d298 7
+a304 4
+              !write(3,*)' In opfilc; calling openfil  ---------------'
+              !write(3,*)' In opfilec, call openfil itype:',itype,nstack
+              !write(3,*)' In opfilec, call openfil disp:  ',disp
+ 
+d309 1
+d312 1
+d319 2
+a320 2
+C                BARE STACK REFERENCE ALLOWED WITHOUT '@@' FROM 'ST'& 'LI'
+C                BARE STACK REFERENCE NOT ALLOWED WITHOUT '@@' NORMALLY
+d336 1
+d339 1
+d344 1
+d346 2
+d358 1
+a358 1
+C             CAN NOT USE EXISTING FOURIER FILE
+d365 1
+a365 1
+C             THIS OPERATION DOES NOT ACCEPT WHOLE STACKS 
+d367 2
+a368 2
+              IRTFLG = 4
+              RETURN
+d372 1
+a372 1
+           MAXIM = NSTACK
+d374 2
+a375 1
+           !write(3,*)' In opfilc '
+d380 2
+a381 1
+           !write(3,*)' ------------ LEAVING OPFILC --------' 
+d383 1
+a383 1
+        ENDIF   ! END OF: SPIDER FILE
+@
+
+
+1.61
+log
+@debug output altered
+@
+text
+@d172 1
+a172 1
+C       CAN PASS ~7  AT END OF PROMTP TO OPEN* TO OPEN A STACK WITHOUT @@
+d175 1
+a175 1
+C       CAN PASS ~9  AT END OF PROMTP TO OPEN* TO KEEP INCOMING EXTENSION
+d224 1
+a224 1
+#if defined (SP_DBUG)
+d232 3
+a234 2
+#if defined (SP_DBUG)
+           write(3,*)' In opfilc Calling openfil_mrc --------'
+d283 1
+a283 1
+	      CALL OPENFIL(LUNT,FILNAM,LUN,NX,NY,NZ,NSTACK,
+d286 2
+a287 2
+              !write(3,*)' In opfilec, openfil returned filnam:',filnam
+	      !write(3,*)' In opfilec, nstack,irtflg: ',nstack,irtflg
+d294 1
+a294 1
+C                BARE STACK REFERENCE ALLOWED WITHOUT '@@' FROM 'ST' & 'LI'
+d310 3
+a312 2
+              !write(3,*)' In opfilc; calling openstk; lunt,lun,nstack: ',
+              !&                  lunt,lun,nstack,itype,'  ',filnam(:33)
+d317 2
+a318 2
+              !write(3,*)' In opfilc; after calling openstk  ---------'
+           ENDIF
+a340 6
+           !write(3,*)' In opfilc --------------- AA --------'
+           !call lungetflip(lunt,iflip,irtflg)
+           !write(3,*)'  In opfilec: lunt,iflip: ',   lunt,iflip
+           !write(3,*)'  In opfilec: lunflip(lunt): ',lunflip(lunt) 
+           !write(3,*)' ------------ END OF AA LEAVING OPFILC --------' 
+
+d343 5
+d349 1
+d354 6
+@
+
+
+1.60
+log
+@commented out debug output
+@
+text
+@d169 1
+a169 1
+        !write(6,*)' In opfilec; itype: ',itype
+d191 3
+a193 3
+        !write(6,*)' In opfilec; asknam,keepext: ',asknam,keepext
+        !write(6,*)' In opfilec; itype,disp:     ',itype,disp
+        !write(6,*)' In opfilec; filnam(1:20):   ',filnam(1:20)
+d215 1
+a215 1
+           !write(6,*)' In opfilec; itype,nx,ny,nz: ',itype,nx,ny,nz
+d218 1
+a218 1
+           !write(6,*)' In opfilec; irtflgt: ',irtflgt
+d224 4
+a227 4
+        !write(6,*)' '
+        !write(6,*)' In opfilc; ismrcfile(filnam):',ismrcfile(filnam)
+        !write(6,*)' In opfilc --------------- VV -------3'
+  
+d232 4
+a235 2
+           !write(6,*)' In opfilc calling openfil_mrc 6'
+           !write(6,*)' In opfilc --------------- VV -------6 
+d243 1
+a243 1
+           !write(6,*)' In opfilc returning after openfil_mrc------7'
+d249 1
+a249 1
+           !write(6,*)' In opfilc callin: lunnewhdr'
+d254 1
+a254 1
+           !write(6,*)' In opfilc after callin: lunnewhdr'
+d264 1
+a264 1
+           !write(6,*)' In opfilc callin: lunsetluns: ', lun
+d269 1
+a269 1
+           !write(6,*)' In opfilc after set luns; filnam: ',filnam
+d277 3
+a279 3
+              !write(6,*)' In opfilc; calling openfil  ---------------'
+              !write(6,*)' In opfilec, call openfil itype:',itype,nstack
+              !write(6,*)' In opfilec, call openfil disp:  ',disp
+d285 2
+a286 2
+              !write(6,*)' In opfilec, openfil returned filnam:',filnam
+	      !write(6,*)' In opfilec, nstack,irtflg: ',nstack,irtflg
+d309 1
+a309 1
+              !write(6,*)' In opfilc; calling openstk; lunt,lun,nstack: ',
+d315 1
+a315 1
+              !write(6,*)' In opfilc; after calling openstk  ---------'
+d339 1
+a339 1
+           !write(6,*)' In opfilc --------------- AA --------'
+d341 3
+a343 3
+           !write(6,*)'  In opfilec: lunt,iflip: ',   lunt,iflip
+           !write(6,*)'  In opfilec: lunflip(lunt): ',lunflip(lunt) 
+           !write(6,*)' ------------ END OF AA LEAVING OPFILC --------' 
+d347 1
+a347 1
+           !write(6,*)' Leaving opfilc; iform,maxim: ',iform,maxim
+@
+
+
+1.59
+log
+@debug output commented out
+@
+text
+@a190 1
+        !write(6,*)' In opfilc --------------- UU --------'
+a225 1
+        !write(6,*)' In opfilc calling openfil_mrc'
+d234 1
+a234 1
+
+d247 1
+d252 1
+d262 2
+d267 1
+d275 1
+a275 1
+              !write(6,*)' In opfilc --------------- WW --------'
+d307 3
+d313 1
+a337 1
+C          find native-enddedness of input     
+d345 1
+@
+
+
+1.58
+log
+@dubug output added
+@
+text
+@d18 1
+d25 1
+a25 1
+C=* Email: spider@@health.ny.gov                                        *
+d168 1
+d243 1
+a243 1
+           ;write(6,*)' In opfilc returning after openfil_mrc------7'
+@
+
+
+1.57
+log
+@common /lunara/ lunara(100),lunstk(100),lunarb(100),lunflip(100)
+common /lunara/ lunara(100),lunstk(100),lunarb(100),lunflip(100)
+debuggin comments added and removed
+@
+text
+@d17 1
+a17 1
+C
+d167 1
+a167 1
+        !write(3,*)' In opfilec, itype: ',itype
+d188 5
+a192 5
+        !write(3,*)' '
+        !write(3,*)' In opfilc --------------- UU --------'
+        !write(3,*)' In opfilec, asknam,keepext: ',asknam,keepext
+        !write(3,*)' In opfilec, itype,disp: ',itype,disp
+        !write(3,*)' In opfilec, filnam(1:20): ',filnam(1:20)
+d214 1
+a214 1
+           !write(3,*)' In opfilec, itype,nx,ny,nz: ',itype,nx,ny,nz
+d217 1
+a217 1
+           !write(3,*)' in opfilec, irtflgt: ',irtflgt
+d223 5
+a227 3
+        !write(3,*)' '
+        !write(3,*)' In opfilc --------------- VV --------'
+ 
+d231 4
+d241 2
+d270 4
+a273 6
+              !write(3,*)' '
+              !write(3,*)' In opfilc --------------- WW --------'
+              !write(3,*)' In opfilec, call openfil itype:',itype,nstack
+              !write(3,*)' In opfilec, call openfil disp:  ',disp
+              !write(3,*)' '
+
+d278 2
+a279 2
+              !write(3,*)' In opfilec, openfil returned filnam:',filnam
+	      !write(3,*)' In opfilec, nstack,irtflg:',nstack,irtflg
+d328 1
+a328 2
+           !write(3,*)' '
+           !write(3,*)' In opfilc --------------- AA --------'
+d331 3
+a333 3
+           !write(3,*)'  In opfilec: lunt,iflip: ',   lunt,iflip
+           !write(3,*)'  In opfilec: lunflip(lunt): ',lunflip(lunt) 
+           !write(3,*)' ------------ END OF AA LEAVING OPFILC --------' 
+@
+
+
+1.56
+log
+@comment
+@
+text
+@d22 1
+a22 1
+C=* Copyright 1985-2019  Health Research Inc.,                         *
+d147 4
+d188 2
+d191 2
+a192 2
+        !write(3,*)' In opfilec, itype,dispt: ',itype,disp
+        !write(3,*)' In opfilec, filnam(:20): ',filnam(1:20)
+d213 3
+d217 2
+d220 1
+a220 1
+           DSP = 'N'
+d223 3
+d262 2
+d265 3
+d273 1
+a273 1
+              !write(3,*)' In opfilec, nstack,irtflg:',nstack,irtflg
+d321 8
 @
 
 
diff --git src/RCS/opfiles.f,v src/RCS/opfiles.f,v
index bf548085..ec272253 100644
--- src/RCS/opfiles.f,v
+++ src/RCS/opfiles.f,v
@@ -1,4 +1,4 @@
-head	1.37;
+head	1.46;
 access;
 symbols
 	pre_mrcs:1.25
@@ -14,6 +14,51 @@ locks; strict;
 comment	@c @;
 
 
+1.46
+date	2025.11.10.22.33.56;	author dean;	state Exp;
+branches;
+next	1.45;
+
+1.45
+date	2025.10.25.15.26.48;	author dean;	state Exp;
+branches;
+next	1.44;
+
+1.44
+date	2025.10.21.19.08.51;	author dean;	state Exp;
+branches;
+next	1.43;
+
+1.43
+date	2025.10.16.20.41.21;	author dean;	state Exp;
+branches;
+next	1.42;
+
+1.42
+date	2025.10.16.19.41.18;	author dean;	state Exp;
+branches;
+next	1.41;
+
+1.41
+date	2025.10.03.14.17.43;	author dean;	state Exp;
+branches;
+next	1.40;
+
+1.40
+date	2025.09.26.17.24.55;	author dean;	state Exp;
+branches;
+next	1.39;
+
+1.39
+date	2025.09.26.14.16.26;	author dean;	state Exp;
+branches;
+next	1.38;
+
+1.38
+date	2025.09.21.15.30.16;	author dean;	state Exp;
+branches;
+next	1.37;
+
 1.37
 date	2020.02.06.15.18.23;	author leith;	state Exp;
 branches;
@@ -204,17 +249,16 @@ desc
 @@
 
 
-1.37
+1.46
 log
-@nextfile(s)  bare and series numbering 
-cosmetic
+@*** empty log message ***
 @
 text
 @ 
 C++*********************************************************************
 C                                                                      
-C  OPFILES.F   NEW                              12/15/06  ArDean Leith    
-C              BAD NUMBRT() TRAP                05/21/09  ArDean Leith  
+C  OPFILES.F   NEW                              12/15/06  ArDean Leith
+C              BAD NUMBRT() TRAP                05/21/09  ArDean Leith 
 C              ASKNAM, PROMPTEX                 12/06/10  ArDean Leith 
 C              NX...                            03/26/12  ArDean Leith 
 C              COPY NON SPIDER INPUT            05/26/14  ArDean Leith 
@@ -223,14 +267,16 @@ C              LOCAST, ASKLIST FOR ILIST        10/02/14  ArDean Leith
 C              DO NOT CHECK .MRC FOR XMIPP       7/25/19  ArDean Leith
 C              MRC SUPPORT                       8/05/19  ArDean Leith
 C              COMMENTS                          2/06/20  ArDean Leith
+C              DEBUG OUTPUT ADDED, NTOT SET 0    9/26/25  ArDean Leith 
+C              ADDED CALL TREE                  10/16/25  ArDean Leith
 C
-C ********************************************************************** 
+C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2020  Health Research Inc.,                         *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -244,9 +290,9 @@ C=* General Public License for more details.                           *
 C=* You should have received a copy of the GNU General Public License  *
 C=* along with this program. If not, see <http://www.gnu.org/licenses> *
 C=*                                                                    *
-C ********************************************************************** 
+C **********************************************************************
 C 
-C  CONTAINS:  OPFILES, GETOLDIMG, GETNEWIMG, NEXTFILE, NEXTFILES 
+C  CONTAINS: OPFILES, GETOLDIMG, GETNEWIMG, NEXTFILE, NEXTFILES
 C
 C  OPFILES(LUNCP,LUNIMG,LUNDOC,LUNXM,  ASKNAM,FILPAT,NLET, DISP,
 C          ITYPE,NX,NY,NZ,MAXIM, PROMPT,
@@ -261,15 +307,16 @@ C           COMPLETE THE IMPLEMENTATION IN MORE OPERATIONS
 C           ALSO WORKS FOR MRC FILES NOW
 C
 C  PARAMETERS:
-C        LUNCP      UNIT TO COPY HEADER VALUES FROM               (SENT)
-C        LUNIMG     UNIT TO OPEN FILE ON                          (SENT)
-C        LUNDOC     UNIT TO OPEN LIST DOC FILES ON                (SENT)
-C        LUNXM      UNIT TO OPEN XMIPP SELFILE ON                 (SENT)
-C        ASKNAM     FLAG TO ASK FOR FILE NAME                     (SENT)
-C        FILPAT     FILE NAME PATTERN                             (RET)
-C        NLET       CHARS IN FILE NAME PATTERN                    (RET)
-C        DISP       CHARACTER CONTAINING ONE OF THE               (SENT) 
-C                   FOLLOWING DISPOSITION SPECIFICATIONS:
+C        LUNCP     UNIT TO COPY HEADER VALUES FROM               (SENT)
+C        LUNIMG    UNIT TO OPEN FILE ON                          (SENT)
+C        LUNDOC    UNIT TO OPEN LIST DOC FILES ON                (SENT)
+C        LUNXM     UNIT TO OPEN XMIPP SELFILE ON                 (SENT)
+C        ASKNAM    FLAG TO ASK FOR FILE NAME                     (SENT)
+C        FILPAT    FILE NAME PATTERN                             (RET)
+C        NLET      CHARS IN FILE NAME PATTERN                    (RET)
+C        DISP      CHARACTER CONTAINING ONE OF THE              (SENT)
+C 
+C                  FOLLOWING DISPOSITION SPECIFICATIONS:
 C                   'O'   -  FILE IS ASSUMED TO EXIST.  DIMENSIONS,
 C                            ITYPE AND HEADER INFO (IN COMMON) ARE 
 C                            RETURNED TO THE CALLING PROGRAM. 
@@ -282,16 +329,19 @@ C                   'N'  -   WANT NEW FILE. SEND NX, NY, NZ & ITYPE.
 C                   'U'  -   IT IS NOT KNOWN IF THE FILE EXISTS.  
 C                            SEND NX, NY, NZ & ITYPE. IF FILE 
 C                            ALREADY EXISTS, IT WILL BE REPLACED.
-C        ITYPE      IFORM FOR FILE                        (SENT OR RET) 
-C        NX,NY,NZ   IMAGE SIZE                            (SENT OR RET)
+C        ITYPE     IFORM FOR FILE                        (SENT OR RET) 
 C
-C        MAXIM      STACK INDICATOR                          (SENT/RET)
+C        NX,NY,NZ  IMG/VOL SIZE                          (SENT OR RET)
+C
+C        MAXIM     STACK INDICATOR OR NUMBER FOR IMAGES     (SENT/RET)
 C                   ON INPUT: STACK INDICATOR IF DISP == 'I'     (SENT)
 C                   ON OUTPUT:                                    (RET)
 C                       -2 A NON-STACK IMAGE                
 C                       -1 A SINGLE STACKED IMAGE                  
-C                     >= 0 CURRENT MAX. IMAGE NO. IN STACK             
-C        PROMPT     PROMPT FOR FILNAME                           (SENT)
+C                     >= 0 NSTK:  CURRENT MAX. IMAGE NO. IN STACK 
+C                   IF NOT STACK MAXIM IS NUMBER IN LIST
+C            
+C        PROMPT    PROMPT FOR FILNAME                           (SENT)
 C                     IF NOT (ASKNAM) THIS IS FILE NAME          (SENT)
 C                     ~ (TILDE) IN LAST CHAR. SAYS SKIP
 C                       "FILE" AT END OF PROMPT
@@ -300,68 +350,74 @@ C                        NEXT-TO-NEXT-TO LAST
 C                        ACCEPTS AN EXTENSION
 C                        (OTHERWISE DISCARDED!)
 C                     ~6 KEEPS OLD DATE/TIME
-C        FOUROK     CAN USE EXISTING FOURIER FILES?              (SENT)
-C        ILIST      IMAGE NUMBER LIST                             (RET)
+C
+C        FOUROK    CAN USE EXISTING FOURIER FILES?              (SENT)
+C
+C        ILIST     IMAGE NUMBER LIST                             (RET)
 C                     IF NIMAXT < 0 MUST BE SENT
 C                     NOT USED IF SINGLE IMAGE/SELFILE 
-C        NIMAXT     MAX LENGTH OF IMAGE NUMBER LIST              (SENT)
+C
+C        NIMAXT    MAX LENGTH OF IMAGE NUMBER LIST              (SENT)
 C                     <0 MEANS DO NOT ASK FOR LIST
-C        NTOT:      # OF IMAGES IN IMAGE NUMBER LIST              (RET)
-C                   ZERO FOR SINGLE IMAGE AND NO * 
-C        IMGNUM     IMAGE NUMBER THAT IS CURRENTLY OPEN      (SENT/RET)
-C                   ON INPUT:   IF (BARESTACK) IS # WANTED
-C                   ON OUTPUT:  <0 IS SELFILE IN USE 
-C        ILIST      IMAGE NUMBER LIST                             (RET)
-C                     IF NIMAXT < 0 MUST BE SENT
-C                     UNUSED IF SINGLE IMAGE/SELFILE 
-C        UNUSED     UNUSED PARAMETER                                (?)
-C        NTOT       # OF IMAGES IN IMAGE NUMBER LIST              (RET)
-C                     ZERO FOR SINGLE IMAGE AND NO * 
-C        IRTFLG     ERROR FLAG (0 IS NORMAL)                      (RET)
+C
+C        UNUSED    UNUSED PARAMETER                                (?)
+C
+C        NTOT:     # OF IMAGES IN IMAGE NUMBER LIST              (RET)
+C                     ZERO FOR SINGLE IMAGE AND NO *
+C 
+C        IMGNUM    IMAGE NUMBER THAT IS CURRENTLY OPEN      (SENT/RET)
+C                     ON INPUT:  IF (BARESTACK) IS # WANTED
+C                     ON OUTPUT: <0 IS SELFILE IN USE 
+C
+C        IRTFLG    ERROR FLAG (0 IS NORMAL)                      (RET)
 C                      -1 GOTO PREVIOUS QUESTION
 C                      -5 NOT A SPIDER OR MRC FILE
-C 
+C
 C  CALL TREE:
 C
-C     OPFILES 
-C        v
-C     FILERD
-C        v 
-C     FILELIST
-C        |  Templated stack: STK@@*** 
-C        ` ---> FILNAMANDEXT --> OPFILEC --> GETOLDIMG
-C        |                               --> GETNEWIMG
+C     OPFILES Uses (E.G. STK@@*)~~9  prompt for filename
+C        v    '~9' in last 3 char. of prompt accepts ext. on filename 
 C        |
-C        |  Whole barestack: STK@@     
-C        ` ---> FILNAMANDEXT --> OPFILEC --> GETOLDIMG
-C        |                               --> GETNEWIMG
+C        |
+C        ` ->  FILERD  
+C        |        ` ->  ECHONAME
+C 
+C        ` ->  FILELIST
+C        |
+C        |  Templated stack: stk@@* 
+C        |    ` ---> FILNAMANDEXT --> OPFILEC --> GETOLDIMG
+C        |                                    --> GETNEWIMG
+C        |
+C        |  Whole barestack: stk@@     
+C        |    ` ---> FILNAMANDEXT --> OPFILEC --> GETOLDIMG
+C        |                                    --> GETNEWIMG
 C        | 
-C        |  File template:   IMG***  
-C        ` ---> FILGET       --> OPFILEC  
+C        |  File template:   img***  
+C        |     ` ---> FILGET      --> OPFILEC  
 C        | 
-C        |  Simple file:    IMG001
-C        ` --------------------> OPFILEC  
+C        |  Simple file:    img001
+C        |    ` --------------------> OPFILEC  
 C        | 
 C        |  MRC file:       *.MRC or *.MRCS
-C        ` -> OPFILES_MRC
-C           |
-C           |  Templated stack:  **@@STK.MRC
-C           ` ---> FILGET_AT --> OPFILEC --> OPENFIL_MRC --> OPENFIL_O_MRC 
-C           |                                            --> OPENFIL_N_MRC
-C           |
-C           |  Whole barestack:  @@STK.MRC 
-C           ` ---> FILGET_AT --> OPFILEC --> OPENFIL_MRC --> OPENFIL_O_MRC
-C           |                                            --> OPENFIL_N_MRC
-C           | 
-C           |  File template:    IMG***.MRC
-C           ` ---> FILGET_AT --> OPFILEC --> OPENFIL_MRC --> OPENFIL_O_MRC
-C           |                                            --> OPENFIL_N_MRC
-C           | 
-C           |  Simple file:      IMG001.MRC
-C           ` -----------------> OPFILEC --> OPENFIL_MRC --> OPENFIL_O_MRC  
-C                                                        --> OPENFIL_N_MRC
+C             ` -> OPFILES_MRC
+C             |
+C             | Templated stack:  *@@stk.MRC
+C             |  ` ---> FILGET_AT --> OPFILEC --> OPENFIL_MRC --> OPENFIL_O_MRC
+C             |                                            `  --> OPENFIL_N_MRC
+C             |
+C             |  Whole barestack:  @@stk.MRC 
+C             |   ` ---> FILGET_AT --> OPFILEC --> OPENFIL_MRC --> OPENFIL_O_MRC
+C             |                                                --> OPENFIL_N_MRC
+C             | 
+C             |  File template:    img***.MRC
+C             |   ` ---> FILGET_AT --> OPFILEC --> OPENFIL_MRC --> OPENFIL_O_MRC
+C             |                                                --> OPENFIL_N_MRC
+C             | 
+C             |  Simple file:      img001.MRC
+C             |   ` -----------------> OPFILEC --> OPENFIL_MRC --> OPENFIL_O_MRC
+C                                                              --> OPENFIL_N_MRC
 C
-C23456789 123456789 123456789 123456789 123456789 123456789 123456789 12 
+C23456789 123456789 123456789 123456789 123456789 123456789 123456789 12
 C--********************************************************************* 
 
        SUBROUTINE OPFILES(LUNCP,LUNIMG,LUNDOC,LUNXM,
@@ -374,20 +430,20 @@ C--*********************************************************************
        IMPLICIT NONE
        INCLUDE 'CMBLOCK.INC' 
        INCLUDE 'CMLIMIT.INC' 
- 
+       
        INTEGER                   :: LUNCP,LUNIMG,LUNDOC
        LOGICAL                   :: ASKNAM
        CHARACTER(LEN=*)          :: FILPAT 
        INTEGER                   :: NLET
        CHARACTER(LEN=1)          :: DISP
-       INTEGER                   :: ITYPE,NX,NY,NZ,MAXIM
+       INTEGER                   :: ITYPE,NX,NY,NZ,MAXIM,NSTK_FLG
        CHARACTER(LEN=*)          :: PROMPT 
        LOGICAL                   :: FOUROK
        INTEGER                   :: ILIST(*)
        INTEGER                   :: NIMAXT,UNUSED,NTOT,IMGNUM, IRTFLG
 
        INTEGER                   :: LUNOP,NLETT,LOCTILDE,LOCAT,LOCAST
-       INTEGER                   :: IMGWANT,IMGNUMIN,LENE,I
+       INTEGER                   :: IMGWANT,IMGNUMIN,LENE,I,IFLIPIN
        INTEGER                   :: NIMAXP,LUNXM,NDUM
        LOGICAL                   :: ISOPEN,GOTFILE
        LOGICAL                   :: SAYIT,ASKLIST
@@ -399,14 +455,13 @@ C--*********************************************************************
        CHARACTER (LEN=1)         :: DISPT 
        CHARACTER (LEN=1)         :: NULL = CHAR(0)
 
-       LOGICAL                   :: IS_MRC,IS_BARE
+       LOGICAL                   :: IS_MRC, IS_BARE
        LOGICAL                   :: ISMRCFILE    ! FUNCTION 
 
        INTEGER                   :: LNBLNKN      ! FUNCTION
-
+  
        LOCTILDE = INDEX(PROMPT,'~') ! unfinished
 
-       !write(3,*)' In opfiles, imgnum: ',imgnum
 
        IF (ASKNAM .AND. PROMPT == NULL) THEN
 C         ASK FOR FILE NAME, CAN ACCEPT EXTENSION
@@ -416,11 +471,11 @@ C         ASK FOR FILE NAME, CAN ACCEPT EXTENSION
      &        DISP == 'U') THEN
 C            NEW FILE, USE DEFAULT PROMPT
              PROMPTEX = 
-     &          'OUTPUT FILE NAME OR TEMPLATE (E.G. STK@@****)~~9'
+     &          'OUTPUT FILE NAME OR TEMPLATE (E.G. stk-file@@*)~~9'
           ELSE
 C            OLD FILE, USE DEFAULT PROMPT
              PROMPTEX = 
-     &          'INPUT FILE NAME OR TEMPLATE (E.G. STK@@****)~~9'
+     &          'INPUT FILE NAME OR TEMPLATE (E.G. stk-file@@*)~~9'
           ENDIF
        
           CALL FILERD(FILPAT,NLET,NULL,PROMPTEX,IRTFLG)
@@ -440,20 +495,19 @@ C         USE FILENAME SENT IN: PROMPT
  
        LOCAT    = INDEX(FILPAT(1:NLET),'@@')   
        LOCAST   = INDEX(FILPAT(1:NLET),'*')
-       
-       !write(3,*)' locast,locat:',locast,locat,filpat(1:nlet)
-       !write(6,*)' ilist:',ilist(1)
-       !write(6,*)' locast,locat,nstack:',locast,locat,maxim
-       !write(3,*)' in opfiles, nimaxt:',nimaxt
-
+     
        ASKLIST = (NIMAXT > 0)   ! ASK FOR IMAGE NUMBER(S)
        NIMAXP  = ABS(NIMAXT)    ! ILIST DIMENSION, IF ILIST IN USE
  
-       !write(3,*)' in opfiles, nimaxt: ',nimaxt
-       !write(3,*)' in opfiles, asklist: ',asklist
-       !write(3,*)' In opfiles, imgnum: ',imgnum
-
-       IMGWANT = MAX(1,IMGNUM)   ! DEFAULT IMAGE NUMBER               
+       !write(3,*)' In opfiles; locast,locat:   ', locast,locat
+       !write(3,*)' In opfiles; nstack:         ', nstack
+       !write(3,*)' In opfiles; nimaxt:         ', nimaxt
+       !write(3,*)' In opfiles; imgnum:         ', imgnum
+       !write(3,*)' In opfiles, nimaxt:         ',nimaxt
+       !write(3,*)' In opfiles, locast,asklist: ',locast,asklist 
+
+       IMGWANT = MAX(1,IMGNUM)   ! DEFAULT IMAGE NUMBER 
+       NTOT    = 0               ! DEFAULT NUMBER UNUSED        
        
        IF (LOCAST > 0 .AND. ASKLIST) THEN
 C         GET LIST OF IMAGES FROM DOC. FILE OR INPUT LINE
@@ -472,10 +526,14 @@ C         ILIST CONTAINS TEMPLATED SERIES,
 C         START WITH FIRST FILE IN THIS SERIES
           IMGWANT = ILIST(1)
           NTOT    = NIMAXP
-          !write(3,*)' In opfiles, imgwant bb: ',imgwant
-
+ 
        ELSEIF (.NOT. ASKLIST) THEN
           NTOT = NIMAXP
+
+       ELSEIF (LOCAST == 0 .AND. ASKLIST .AND. 
+     &        (IMGWANT < 0 .OR.  IMGWANT > 10000000)) THEN
+C         SIMPLE FILE NAME 
+          IMGWANT = 0
        ENDIF
 
        IF (IMGWANT < 0 .OR. IMGWANT > 10000000) THEN
@@ -484,33 +542,79 @@ C         START WITH FIRST FILE IN THIS SERIES
           RETURN
        ENDIF
 
-       !write(3,*)' In opfiles, nimaxt: ',nimaxt
-       !write(3,*)' In opfiles, ilist: ',ilist(1:5)
-       !write(3,*)' In opfiles, asklist,nimaxp: ',asklist,nimaxp
-       !write(3,*)' In opfiles, maxim,ntot,imgwant: ',maxim,ntot,imgwant
 
 C      SEE IF THIS IS A MRC FILE
        IS_MRC = ISMRCFILE(FILPAT)
 
-       !write(3,*)' In opfiles, imgwant cc: ',imgwant
+
+#if defined (SP_DBUGIO)
+       write(3,*)'   '
+       write(3,*)' In opfiles; asklist,nimaxp: ', 
+     &                         asklist,nimaxp 
+       write(3,*)' In opfiles; filpat: ',filpat(1:36)
+       write(3,*)' In opfiles; ntot,ilist(:2): ', ntot,ilist(1:2)
+       write(3,*)' In opfiles; locast:         ', locast
+       write(3,*)' In opfiles; is_mrc:         ', is_mrc
+      !write(3,*)' In opfiles; imgnum,imgwant: ', imgnum,imgwant
+       write(3,*)'    '
+#endif
+
+
        IF (IS_MRC) THEN
-C         OPEN MRC FILE
+C         OPEN MRC FILE ----------------------------
+
+#if defined (SP_DBUGIO)
+          write(3,*)' In opfiles xxxx ; Calling opfiles_mrc -----'
+#endif
+
+C        FOR OPFILES_MRC:
+C          IMGNUM   IMAGE NUMBER                    (SENT/RET)
+C                   ON INPUT:   IMAGE NUMBER THAT IS WANTED
+C                   ON OUTPUT:  >=0 IMAGE NUMBER CURRENTLY OPEN 
+C                                <0 IS SELFILE IN USE 
+C
+C          NSTK_FLG STACK INDICATOR                  (SENT/RET)
+C                   ON INPUT: STACK INDICATOR IF DISP == 'I' (SENT)
+C                   ON OUTPUT:                       (RET)
+C                       -2 NON-STACK IMAGE                
+C                       -1 STACKED IMAGE WITH * 
+c                        0 BARE STACK                  
+C                     >= 0 IS CURRENT MAX. IMAGE NO. FOR STACK           C                          IF NOT A STACK, THIS IS NUMBER IN LIST
+
+          NSTK_FLG = MAXIM 
+
           CALL OPFILES_MRC(LUNCP,LUNIMG,LUNDOC,
      &                     FILPAT,NLET, DISP,
-     &                     ITYPE,NX,NY,NZ,MAXIM,
-     &                     IMGWANT, IRTFLG) 
-          
-          IMGNUM = IMGWANT
+     &                     ITYPE,NX,NY,NZ, NSTK_FLG,
+     &                     IMGWANT, IRTFLG)
+ 
+          IMGNUM = IMGWANT      ! RETURNED BELOW
+          MAXIM  = NSTK_FLG     ! RETURNED BELOW
+
+#if defined (SP_DBUGIO)
+          write(3,*)' From opfiles_mrc: ' 
+          write(3,*)' Opfiles returns: nz:      ', nz 
+          write(3,*)' Opfiles returns: maxim:   ', maxim 
+          write(3,*)' Opfiles returns: ntot:    ', ntot 
+          write(3,*)' Opfiles returns: imgnum:  ', imgnum 
+          write(3,*)' Opfiles returns: irtflg:  ', irtflg 
+          write(3,*)'   ' 
+#endif
 
           RETURN
-       ENDIF
+       ENDIF  ! -------------- end of mrc --------------------
+
+
+
 
        IMGNUMIN = IMGNUM
        IMGNUM   = 0 
-       !write(3,*) ' In opfiles - imgnum 0: ',imgnum
+
+       !write(3,*) ' In opfiles NOT MRC - imgnum 0: ',imgnum
+       !write(3,*) ' In opfiles; locat,locast: ',locat,locast
 
        IF (LOCAT > 0 .AND. LOCAST > LOCAT) THEN
-C         TEMPLATED STACKED FILE: STK@@**** -------------- _9@@* or STK@@**
+C         TEMPLATED STACKED FILE: STK@@* -------------- _9@@* or STK@@*
 
           FILNAM = FILPAT(1:LOCAT)
             
@@ -529,18 +633,17 @@ C            CONCATENATE EXTENSION ONTO FILNAM
              ENDIF
           ENDIF
 
-          !write(6,*) ' In opfiles - imgwant,imgnum1: ',imgwant,imgnum
+          !write(3,*)'In opfiles - imgwant,imgnum1: ',imgwant,imgnum
 
 C         OPEN THE STACK FILE HEADER 
           MAXIM  = 1  
-	  CALL OPFILEC(LUNCP,.FALSE.,FILNAM,LUNIMG,DISP,
+          CALL OPFILEC(LUNCP,.FALSE.,FILNAM,LUNIMG,DISP,
      &                 ITYPE,NX,NY,NZ, 
-     & 		       MAXIM,' ',FOUROK,IRTFLG) 
-	  IF (IRTFLG .NE. 0) GOTO 9000 
-
-          !write(6,*) ' In opfiles - locast: ',locat,locast,filnam
-          !write(6,*) ' In opfiles - imgwant,imgnum2: ',imgwant,imgnum
+     &                 MAXIM,' ',FOUROK,IRTFLG) 
+          IF (IRTFLG .NE. 0) GOTO 9000 
 
+          !write(3,*) ' In opfiles - locast: ',locat,locast,filnam
+          !write(3,*) ' In opfiles - imgwant,imgnum2: ',imgwant,imgnum
 
 C         OPEN FIRST FILE IN STACK SERIES
           IMGWANT  = ILIST(1)
@@ -550,7 +653,6 @@ C         OPEN FIRST FILE IN STACK SERIES
               GOTO 9000
           ENDIF
 
-
 C         THIS IS NOT A BARE STACK FILE
           CALL LUNSETISBARE(LUNIMG,.FALSE.,IRTFLG)
 
@@ -558,12 +660,12 @@ C         THIS IS NOT A BARE STACK FILE
           IF (DISP == 'U' .OR. DISP == 'N') THEN
 C            WANT A NEW SPIDER STACK FILE FOR OUTPUT
 
-             !write(6,*) ' In opfiles - imgwant,imgnum: ',imgwant,imgnum
+             !write(3,*)' In opfiles  imgwant,imgnum: ',imgwant,imgnum
 
              CALL GETNEWIMG(LUNCP,LUNIMG,LUNDOC,FILPAT,IMGWANT,
      &                      SAYIT,IMGNUM,IRTFLG)
 
-             !write(6,*) ' In opfiles - imgwant,imgnum3: ',imgwant,imgnum
+             !write(3,*) ' In opfiles mgwant,imgnum3:',imgwant,imgnum
 
           ELSE
 C            WANT TO USE EXISTING SPIDER STACK FILE
@@ -575,9 +677,8 @@ C            WANT TO USE EXISTING SPIDER STACK FILE
 C         RETRIEVE CURRENT MAXIMUM IMAGE NUMBER FROM OVERALL HEADER
           CALL LUNGETMAXIM(LUNIMG,MAXIM,IRTFLG)
 
-          !write(6,'(a,a,a,i6,a,i6,a,i6)')' opened templated stack: ',
-!     &          filpat(1:nlet),' at image: ',imgnum, 
-!     &          '  maxim: ',maxim
+          !write(3,'(a,a,a,i6,a,i6,a,i6)')' opened templated stack: ',
+          !&      filpat(1:nlet),' at image: ',imgnum,'  maxim: ',maxim
 
        ELSEIF (LOCAT == NLET) THEN
 C         WHOLE BARESTACK:  STK@@  --------------------------_9@@ or STK@@
@@ -607,8 +708,8 @@ C             OPEN NEW BARE INDEXED STACK
 
           CALL OPFILEC(LUNCP,.FALSE.,FILPAT,LUNIMG,DISPT,
      &                 ITYPE,NX,NY,NZ, 
-     & 		       MAXIM,'INPUT',FOUROK,IRTFLG) 
-	  IF (IRTFLG .NE. 0) GOTO 9000
+     &                 MAXIM,'INPUT',FOUROK,IRTFLG) 
+          IF (IRTFLG .NE. 0) GOTO 9000
 
 C         OPEN FIRST FILE IN STACK, UNLESS SPECIFIED FOR NEW BARE STACK
           IMGWANT = 1
@@ -623,10 +724,11 @@ C            NEW BARE STACK, OPEN REQUESTED FILE IN STACK
              CALL GETNEWIMG(LUNCP,LUNIMG,LUNDOC,FILPAT,IMGWANT,
      &                      SAYIT,IMGNUM,IRTFLG)
              IF (IRTFLG .NE. 0) GOTO 9000
-         
+  
+       
           ELSE
 C            EXISTING BARE STACK, OPEN FIRST FILE IN STACK
-	     CALL GETOLDIMG(LUNIMG,LUNDOC,FILPAT, IMGWANT,
+             CALL GETOLDIMG(LUNIMG,LUNDOC,FILPAT, IMGWANT,
      &                      SAYIT,FOUROK,IMGNUM,IRTFLG)
              IF (IRTFLG .NE. 0) GOTO 9000
 
@@ -643,11 +745,12 @@ C            CREATE IMAGE NUMBER LIST IN: ILIST
           ENDIF
 
           !write(3,*)' Opened bare stack:',filpat(1:nlet),' img:',imgnum
-          !write(6,*)' Opened imgnum, stack:',imgnum,filpat(1:nlet)
+          !write(3,*)' Opened imgnum, stack:',imgnum,filpat(1:nlet)
           !write(3,*)' Opened imgwant,ntot:',imgwant,imgnum,ntot
 
+
        ELSEIF (LOCAST > 0) THEN
-C         A SIMPLE FILE TEMPLATE: IMG*** ----------------------- IMG***
+C         A SIMPLE TEMPLATED FILE: IMG*** -------------------- IMG***
 
 C         FIND IMGNUM FOR FIRST FILE IN THE SERIES
           IMGNUM = ILIST(1)
@@ -659,67 +762,103 @@ C         FIND IMGNUM FOR FIRST FILE IN THE SERIES
 
 C         SUBSTITUTE IMGNUM INTO FILPAT 
           CALL  FILGET(FILPAT,FILNAM,NLET,IMGNUM,IRTFLG)
-	  IF (IRTFLG .NE. 0) GOTO 9000 
+          IF (IRTFLG .NE. 0) GOTO 9000 
 
 C         OPEN FIRST FILE IN THE SERIES
           MAXIM = 0 
-	  CALL OPFILEC(LUNCP,.FALSE.,FILNAM,LUNIMG,DISP,
+          CALL OPFILEC(LUNCP,.FALSE.,FILNAM,LUNIMG,DISP,
      &                 ITYPE,NX,NY,NZ, 
-     & 		       MAXIM,' ',FOUROK,IRTFLG) 
-	  IF (IRTFLG .NE. 0) GOTO 9000 
+     &                 MAXIM,' ',FOUROK,IRTFLG) 
+          IF (IRTFLG .NE. 0) GOTO 9000 
+
+#if defined(SP_DBUGIO)
+          write(3,*)' In opfiles; filpat,imgnum,ntot: ',
+     &                            filpat(:nlet),imgnum,ntot
+          write(3,*)' In opfiles; filnam: ', filnam(:nlet)
+#endif
 
-          !write(6,*)' Opened templated file: ',filpat(1:nlet),
-          !&              '  for:',ntot,' images.'
 
        ELSE
-C         SINGLE SIMPLE INPUT FILE: IMG001 -------------------- IMG001
-C         OR XMIPP SELFILE LISTING FILE: SELX ----------------- SELFILE
-C         OR TRYING TO COPY NON-SPIDER FILE   ----------------- NONSPIFILE
+C         SINGLE INPUT FILE: IMG001 ------------------------ IMG001
+C         SINGLE STACKED FILE: IMGSTK ---------------------- IMGSTK@@1
+C         OR XMIPP SELFILE LISTING FILE: SELX -------------- SELFILE
+C         OR TRY TO COPY NON-SPIDER FILE   ----------------- NONSPIFILE
+
+#if defined(SP_DBUGIO)
+          !write(3,*) ' In opfiles ; Simple file: ',filpat(:nlet)
+#endif
                
 C         CHECK FOR XMIPP SELFILE LIST
           IF (LUNXM > 0 .AND. .NOT. ISMRCFILE(FILPAT) ) THEN
-             !write(6,*)' Filpat for openxmsel: ',filpat(:nlet) 
+             !write(3,*)' Filpat for openxmsel: ',filpat(:nlet) 
              CALL OPENXMSELFILE(FILPAT,LUNXM,FILNAM,NLET,NTOT,IRTFLG)
-             !write(6,*)' Filnam from openxmsel: ',ntot,':',filnam(:nlet) 
-
+             !write(3,*)' Filnam from openxmsel: ',ntot,':', filnam(:nlet) 
              INQUIRE(FILE=FILNAM(:NLET),EXIST=GOTFILE)
            
              IF (NTOT > 0 .AND. GOTFILE) THEN
 C               OPEN FIRST FILE IN XMIPP SELFILE LIST
                 MAXIM = 0  
-	        CALL OPFILEC(LUNCP,.FALSE.,FILNAM(:NLET),LUNIMG,DISP,
+                CALL OPFILEC(LUNCP,.FALSE.,FILNAM(:NLET),LUNIMG,DISP,
      &                       ITYPE,NX,NY,NZ, 
-     & 		             MAXIM,'dum~9',FOUROK,IRTFLG) 
-	        IF (IRTFLG .NE. 0) GOTO 9000 
+     &                              MAXIM,'dum~9',FOUROK,IRTFLG) 
+                IF (IRTFLG .NE. 0) GOTO 9000 
 
                 IMGNUM     = -1
-                !write(6,*)' Opened selfile image: ',filnam(1:nlet) 
+                !write(3,*)' Opened selfile image: ',filnam(1:nlet) 
                 RETURN
 
              ENDIF
           ENDIF
 
-C         SINGLE SIMPLE INPUT FILE: IMG001 ------------------ IMG001
+C         SINGLE SIMPLE  INPUT FILE: IMG001   ----------------- IMG001
+C         SINGLE STACKED INPUT FILE: IMGSTK@@3 ----------------- IMGSTK@@3
+
+#if defined(SP_DBUGIO)
+          !write(3,*)' In opfiles, filpat,itype:     ',filpat(1:nlet)
+          !write(3,*)' In opfiles, itype,nx:',itype,nx
+           write(3,*)' In opfiles, Calling opfilec,  disp: ',disp
+#endif
 
-          !write(3,*)' In opfiles, simple file: ',filpat(1:nlet),itype,nx 
           MAXIM = 0  
-	  CALL OPFILEC(LUNCP,.FALSE.,FILPAT,LUNIMG,DISP,
+          CALL OPFILEC(LUNCP,.FALSE.,FILPAT,LUNIMG,DISP,
      &                 ITYPE,NX,NY,NZ, 
-     & 		       MAXIM,PROMPT,FOUROK,IRTFLG) 
+     &                 MAXIM,PROMPT,FOUROK,IRTFLG) 
 
+#if defined(SP_DBUGIO)
+         !write(3,*)' Back In opfiles, Opened: ',irtflg,filpat(1:nlet)
+          write(3,*)' Back from opfiles, itype,irtflg: ',itype,irtflg
+#endif
+ 
 C         RETURN FILENAME WITH ANY EXTENSION IF NOT SPIDER IMAGE
           IF (IRTFLG == 5) NLET = lnblnkn(FILPAT)
-	  IF (IRTFLG .NE. 0) GOTO 9000 
+          IF (IRTFLG .NE. 0) GOTO 9000 
 
           NTOT       = 0
           IMGNUM     = 1
 
-          !write(3,*)' In opfiles, Opened simple: ',filpat(1:nlet)
-       ENDIF
+#if defined(SP_DBUGIO)
+          !write(3,*)' In opfiles, Opened simple : ',filpat(1:nlet)
+          !write(3,*)' In opfiles: itype,nimaxt: ',
+          !&                       itype,nimaxt 
+          !find native-enddedness of input     
+          !call lungetflip(luncp,iflipin,irtflg)
+          !write(3,*)' In opfiles: luncp,iflipin: ',luncp,iflipin
+#endif
+ 
+      ENDIF
 
-9000   RETURN
+#if defined(SP_DBUGIO)
+          write(3,*)' Opfiles returning: maxim:  ', maxim 
+          write(3,*)' Opfiles returning: ntot:   ', ntot 
+          write(3,*)' Opfiles returning: imgnum: ', imgnum 
+          write(3,*)' Opfiles returning: irtflg: ', irtflg 
+          write(3,*)' Opfiles returning for SPIDER  -----------------'
+          write(3,*)'    ' 
+#endif
 
-       END 
+9000  RETURN
+
+      END 
  
 
 
@@ -741,24 +880,23 @@ C    PARAMETERS:
 C        LUN        LUN NUMBER FOR FILNAM                         (SENT)
 C        LUNXM      LUN FOR XM SELFILE                            (SENT) 
 C        FILPAT     FILENAME PATTERN                              (SENT)
-C        NWANT      IMAGE NUMBER WANTED (<0 IS SELFILE)           (SENT) 
+C        NWANT      IMAGE NUMBER WANTED (<0 IS SELFILE)           (SENT)
 C        SAYIT      SAY FILE OPENING INFO.                        (SENT)
-C        FOUROK     FOURIER INPUT OK FLAG                         (SENT) 
-C        NGOT       IMAGE NUMBER FOUND                            (RET.) 
+C        FOUROK     FOURIER INPUT OK FLAG                         (SENT)
+C        NGOT       IMAGE NUMBER FOUND                            (RET.)
 C        IRTFLG     ERROR RETURN FLAG.                            (RET.)
 C                   IRTFLG = -1    END OF FILE BEFORE NWANT
 C                   IRTFLG =  0    NORMAL RETURN, IMAGE IS STACK
 C                   IRTFLG =  2    IMAGE NOT IN USE
 C
-C
-C  CALL TREE:
+C    CALL TREE:
 C
 C       GETOLDIMG 
 C          |
 C          |  Templated simple image:  IMG*** 
 C          ` ---> FILGET --> OPFILEC  
 C          |                         
-C          |  Templated stacked image: STK@@*(**     
+C          |  Templated stacked image: STK@@*     
 C          ` ---> LUN***
 C          | 
 C          |  Whole image stack: STK@@  
@@ -770,7 +908,7 @@ C
 C23456789 123456789 123456789 123456789 123456789 123456789 123456789 12
 C--*********************************************************************
  
-	SUBROUTINE GETOLDIMG(LUN,LUNXM,FILPAT,NWANT, SAYIT,
+        SUBROUTINE GETOLDIMG(LUN,LUNXM,FILPAT,NWANT, SAYIT,
      &                       FOUROK,NGOT,IRTFLG)
 
         INCLUDE 'CMLIMIT.INC'
@@ -798,9 +936,8 @@ C--*********************************************************************
 C       IS THIS A MRC FILE SET
         CALL LUNGETIS_MRC(LUN,IS_MRC,IRTFLG)
 
-
-        !write(6,*)' locast,locat:',locast,locat,nlet,filpat(1:nlet)
-        !write(6,*)' getoldimg, nwant,: ',nwant,':',filpat(1:nlet)
+        !write(3,*)' locast,locat:',locast,locat,nlet,filpat(1:nlet)
+        !write(3,*)' getoldimg, nwant,: ',nwant,':',filpat(1:nlet)
         
         IF (NWANT < 0) THEN
 C          XMIPP SELFILE SIMPLE IMAGE ------------------------- SELAAA
@@ -812,21 +949,21 @@ C          RECOVER EXISTING IMAGE SIZE & TYPE
  
 C          LOAD FILNAM FROM SELFILE
            CALL GETNEXT_XMSEL(LUNXM,.TRUE.,FILNAM,NLET,IRTFLG)
-	   IF (IRTFLG .NE. 0) RETURN 
+           IF (IRTFLG .NE. 0) RETURN 
 
 C          OPEN EXISTING FILE: FILNAM  (HAS EXTENSION)
            MAXIM = 0  
-	   CALL OPFILEC(0,.FALSE.,FILNAM(:NLET),LUN,'O',ITYPE,
+           CALL OPFILEC(0,.FALSE.,FILNAM(:NLET),LUN,'O',ITYPE,
      &                 NX,NY,NZ, 
-     & 		       MAXIM,'~9',FOUROK,IRTFLG) 
-	   IF (IRTFLG .NE. 0) RETURN 
+     &                        MAXIM,'~9',FOUROK,IRTFLG) 
+           IF (IRTFLG .NE. 0) RETURN 
 
 C          NEW IMAGE SIZE SHOULD BE SAME AS PREVIOUS FILE
            CALL SIZCHK(NULL,NX1,NY1,NZ1,ITYPE1,
      &                      NX ,NY, NZ, ITYPE, IRTFLG)
-	   IF (IRTFLG .NE. 0) RETURN 
+           IF (IRTFLG .NE. 0) RETURN 
  
-           !write(6,*)' Opened old xmipp selfile file: ',filnam(1:nlet)
+           !write(3,*)' Opened old xmipp selfile file: ',filnam(1:nlet)
 
            NGOT   = NWANT   
            IRTFLG = 0
@@ -840,20 +977,20 @@ C          TEMPLATED SIMPLE IMAGE --------------------------- IMG***
            CLOSE(LUN)    ! USUALLY STILL OPEN
  
            CALL  FILGET(FILPAT,FILNAM,NLET,NWANT,IRTFLG)
-	   IF (IRTFLG .NE. 0) RETURN 
+           IF (IRTFLG .NE. 0) RETURN 
 
            MAXIM = 0  
-	   CALL OPFILEC(0,.FALSE.,FILNAM,LUN,'O',ITYPE,
+           CALL OPFILEC(0,.FALSE.,FILNAM,LUN,'O',ITYPE,
      &                 NX,NY,NZ, 
-     & 		       MAXIM,' ',FOUROK,IRTFLG) 
-	   IF (IRTFLG .NE. 0) RETURN 
+     &                        MAXIM,' ',FOUROK,IRTFLG) 
+           IF (IRTFLG .NE. 0) RETURN 
 
 C          IMAGE SIZE SHOULD BE SAME
            CALL SIZCHK(NULL,NX1,NY1,NZ1,ITYPE1,
      &                      NX ,NY, NZ, ITYPE, IRTFLG)
-	   IF (IRTFLG .NE. 0) RETURN 
+           IF (IRTFLG .NE. 0) RETURN 
 
-           !write(6,*)' Opened old templated file: ',filnam(1:nlet),maxim
+           !write(3,*)' Opened old templated file: ',filnam(1:nlet), maxim
 
            NGOT   = NWANT   
            IRTFLG = 0
@@ -864,19 +1001,20 @@ C          IMAGE SIZE SHOULD BE SAME
 C          TEMPLATED STACKED MRC IMAGE ---------------------- **@@STK.mrc
 C          BARE STACKED MRC IMAGE      ----------------------   @@STK.mrc
            
-          !write(3,*) ' In getoldimg, nwant: ',nwant,locat,locast,filpat
+           !write(3,*)' In getoldimg, nwant: ',nwant,locat,locast,filpat
            CALL GETOLDIMG_MRC(LUN,FILPAT,NWANT,SAYIT,
      &                        FILNAM,NGOT,IRTFLG)
            RETURN
 
         ELSEIF (LOCAT  > 0 .AND. LOCAST > LOCAT) THEN
-C          TEMPLATED STACKED SPIDER IMAGE --------------------- STK@@***
+C          TEMPLATED STACKED SPIDER IMAGE --------------------- STK@@*
 
 C          MUST LOAD OVERALL HEADER FIRST FOR LUNREDHED (MAY BE MT NOW!)
            CALL LUNGETSIZE(LUN,NX,NY,NZ,IRTFLG)
            CALL LUNREDHED(LUN,NX,0,.FALSE.,IRTFLG)
            IF (IRTFLG .NE. 0) THEN
-              !write(6,*) ' lunredhed,lun,NX,irtflg:',lun,NX,irtflg
+              !write(3,*)' In opfiles lunredhed; lun,nx,irtflg:',
+c    &                                           lun,nx,irtflg
               CALL ERRT(102,'REDHED FAILED ON LUN',LUN) 
               IRTFLG = 2
               RETURN
@@ -887,6 +1025,8 @@ C          LOAD SPECIFIED IMAGE HEADER
            IF (IRTFLG == 0) THEN
 C             NEED IMUSED FROM THIS STACKED IMAGE
               CALL LUNGETINUSE(LUN,IMUSED,IRTFLG)
+              !write(3,*)' In opfiles lungetinuse, lun,imused:',
+c     &                                            lun,imused
            ENDIF
            IF (IRTFLG .NE. 0 .OR. IMUSED == 0) THEN
               CALL ERRT(102,'IMAGE NOT IN STACK',NWANT) 
@@ -899,7 +1039,8 @@ C             NEED IMUSED FROM THIS STACKED IMAGE
            CALL LUNSETIMNUM(LUN,FILNAM,NWANT,'O',IRTFLG)
            NLET = lnblnkn(FILNAM)
 
-           !write(6,*)' Opened old templated stacked file: ',FILNAM(:NLET)
+           !write(3,*)' Opened old templated stacked file: ',
+           !filnam(:nlet)
 
         ELSEIF (LOCAT == NLET) THEN
 C          WHOLE IMAGE STACK ------------------------------ STK@@ or _1@@
@@ -937,8 +1078,8 @@ C             INCREMENT NGOT AND TRY AGAIN
 
            NLET = lnblnkn(FILNAM)
 
-           !write(6,*)' Opened old bare stacked file: ',FILNAM(1:NLET)
-           !write(6,*)' ngot,NX:',ngot,NX,lun,imused,irtflg
+           !write(3,*)' Opened old bare stacked file: ',filnam(1:nlet)
+           !write(3,*)' Ngot,nx:',ngot,nx,lun,imused,irtflg
         ENDIF
 
 C       SET OFFSETS FOR REDLIN/WRTLIN ON THIS LUN
@@ -951,7 +1092,7 @@ C       SET COMMON BLOCK VARIABLES
         CALL LUNSETCOMMON(LUN,IRTFLG)
 
 
-	END
+        END
 
 
 C **********************************************************************
@@ -987,12 +1128,12 @@ C          |
 C          |  Whole image stack: STK@@  
 C          ` ---> LUNS***  
 C          | 
-C          |  Templated stacked MRC image: *@@MRC or *@@.MRCS
+C          |  Templated stacked MRC image: file*@@MRC or *@@file.MRCS
 C          ` ---> GETNEWIMG_MRC    --> OPFILEC  
 C
 C **********************************************************************
 
-	SUBROUTINE GETNEWIMG(LUNCP,LUN,LUNXM,FILPAT,NWANTT, 
+        SUBROUTINE GETNEWIMG(LUNCP,LUN,LUNXM,FILPAT,NWANTT, 
      &                       SAYIT,NGOT,IRTFLG)
 
         IMPLICIT NONE
@@ -1036,16 +1177,16 @@ C          GET PREVIOUS FILE SIZE AND TYPE (SHOULD BE SAME)
  
 C          LOAD FILE NAME FROM SELFILE
            CALL GETNEXT_XMSEL(LUNXM,.TRUE.,FILNAM,NLET,IRTFLG)
-	   IF (IRTFLG .NE. 0) RETURN 
+           IF (IRTFLG .NE. 0) RETURN 
 
 C          OPEN FILNAM
            MAXIM = 0  
-	   CALL OPFILEC(0,.FALSE.,FILNAM(1:NLET),LUN,'U',ITYPE1,
+           CALL OPFILEC(0,.FALSE.,FILNAM(1:NLET),LUN,'U',ITYPE1,
      &                 NX1,NY1,NZ1, 
-     & 		       MAXIM,'~9',FOUROK,IRTFLG) 
-	   IF (IRTFLG .NE. 0) RETURN 
+     &                        MAXIM,'~9',FOUROK,IRTFLG) 
+           IF (IRTFLG .NE. 0) RETURN 
 
-           !write(6,*)' Opened new Xmipp selfile file: ',filnam(1:nlet)
+           !write(3,*)' Opened new Xmipp selfile file: ',filnam(1:nlet)
 
            NGOT = NWANT   
            RETURN
@@ -1061,16 +1202,16 @@ C          GET IT FROM OPFILES OR PREVIOUS CALL
  
 C          CREATE FILE NAME
            CALL FILGET(FILPAT,FILNAM,NLET,NWANT,IRTFLG)
-	   IF (IRTFLG .NE. 0) RETURN 
+           IF (IRTFLG .NE. 0) RETURN 
 
            MAXIM = 0
            CLOSE(LUN)    ! MAY BE STILL OPEN FROM FIRST CALL  
-	   CALL OPFILEC(LUNCP,.FALSE.,FILNAM,LUN,'U',ITYPE,
+           CALL OPFILEC(LUNCP,.FALSE.,FILNAM,LUN,'U',ITYPE,
      &                 NX,NY,NZ, 
-     & 		       MAXIM,' ',FOUROK,IRTFLG) 
-	   IF (IRTFLG .NE. 0) RETURN 
+     &                 MAXIM,' ',FOUROK,IRTFLG) 
+           IF (IRTFLG .NE. 0) RETURN 
 
-           !write(6,*)' Opened new templated file: ',filnam(1:nlet)
+           !write(3,*)' Opened new templated file: ',filnam(1:nlet)
 
            NGOT   = NWANT   
            IRTFLG = 0
@@ -1078,7 +1219,7 @@ C          CREATE FILE NAME
 
         ELSEIF (IS_MRC .AND. LOCAT > 0 .AND. LOCAST < LOCAT) THEN
 
-C          TEMPLATED STACKED MRC IMAGE ---------------------- **@@STK.mrc
+C          TEMPLATED STACKED MRC IMAGE ---------------------- *@@STK.mrc
 C          BARE MRC IMAGE ------------------------------------ @@STK.mrc
            
            CALL GETNEWIMG_MRC(LUN,FILPAT,NWANT,SAYIT,
@@ -1087,7 +1228,7 @@ C          BARE MRC IMAGE ------------------------------------ @@STK.mrc
 
 
         ELSEIF (LOCAT > 0) THEN
-C          STACKED IMAGE ------------------------------- STK@@*  or STK@@
+C          STACKED IMAGE ------------------------------- STK@@ or @@STK@@
 
            CALL LUNGETISBARE(LUN,ISBARE,IRTFLG)
 
@@ -1108,9 +1249,9 @@ C             UPDATE OVERALL HEADER WITH MAXIMUM IMAGE NUMBER
 C          NEED ISTACK 
            CALL LUNCOPYSTK(LUN,ISTACK,IRTFLGT)
 
-           !write(6,*)' In getnewimg - isbare,filpat: ',isbare, filpat
-           !write(6,*)' In getnewimg -nwant,maxim,istak: ',nwant,maxim,istack
-
+           !write(3,*)' In getnewimg - isbare,filpat: ',isbare, filpat
+           !write(3,*)' In getnewimg - nwant,maxim,istak: ',  
+c      &                                nwant,maxim,istack
 
           IF (ISTACK < 0) THEN
 C             MAKING A NEW INDEXED STACKED FILE, UPDATE INDX LOCATION
@@ -1151,11 +1292,11 @@ C          WRITE OUT FILE OPENING INFO TO SCREEN
 
            NGOT = NWANT
 
-           !write(6,*)' Opened new stacked file: ',FILNAM(1:NLET)
+           !write(3,*)' Opened new stacked file: ',FILNAM(1:NLET)
 
         ENDIF
 
-	END
+        END
 
 
 C++*********************************************************************
@@ -1164,12 +1305,12 @@ C  NEXTFILES.F  NEW                              12/15/06 ArDean Leith
 C               OVERUN OUTPUT LIST = -99          1/15/12 ArDean Leith
 C **********************************************************************
 C
-C NEXTFILES(NINDX1, NINDX2, INUMBR1,INUMBR2, 
-C           FOUROK,NLIST1,NLIST2,   
-C           NSTACK1,NSTACK2,   
-C           LUN1,LUNCP,LUN2, FILPAT1,FILPAT2,
-C           IMGNUM1,IMGNUM2,IRTFLG) 
-C
+C  NEXTFILES(NINDX1, NINDX2, INUMBR1,INUMBR2, 
+C            FOUROK,LUNXM1,LUNXM2,
+C            NLIST1,NLIST2,   NSTACK1,NSTACK2,   
+C            LUN1,LUNCP,LUN2, FILPAT1,FILPAT2,
+C            IMGNUM1,IMGNUM2, IRTFLG) 
+C 
 C PURPOSE:  GETS NEXT INPUT AND OUTPUT FILES FOR A STACK ORIENTED 
 C           OPERATION.  STACKS MUST BE OPENED WITH OPFILES!!!
 C
@@ -1183,8 +1324,8 @@ C             LUN1             LUN FOR INPUT  (0 = NO FILE IN)   (SENT)
 C             LUNCP            LUN FOR OUTPUT HEADER COPY        (SENT)
 C             LUN2             LUN FOR OUTPUT (0 = NO FILE OUT)  (SENT)
 C             FILPAT,FILPAT2   FILE NAME PATTERNS                (SENT)
-C             IMGNUM1,IMGNUM2  IMAGE NUMBERS                (SENT/RET.)
-C             IRTFLG           ERROR (0 IS OK, -1 IS END STACK)  (RET.)
+C             IMGNUM1,IMGNUM2  IMAGE NUMBERS                 (SENT/RET)
+C             IRTFLG           ERROR (0 IS OK, -1 IS END STACK)   (RET)
 C
 C  CALL TREE:
 C     AFTER OPFILES HAVE BEEN CALLED:
@@ -1224,6 +1365,13 @@ C--*********************************************************************
       NINDX1 = NINDX2 + 1
       NINDX2 = NINDX2 + 1
 
+#if defined (SP_DBUGIO)
+      write(3,*)' In Nextfiles-0; lun1,lun2:       ', lun1,lun2
+      write(3,*)' In Nextfiles-0; nindx1,nindx2:   ', nindx1,nindx2
+      write(3,*)' In Nextfiles-0; nstack1,nstack2: ', nstack1,nstack2
+      write(3,*)' In Nextfiles-0; imgnum1,imgnum2: ', imgnum1,imgnum2
+#endif
+
       IF (LUN1 > 0) THEN  
 C        OPEN NEXT INPUT FILE 
          GOTAST1 = (INDEX(FILPAT1,'*') > 0)
@@ -1263,13 +1411,10 @@ C           OPEN NEXT INPUT FILE
 
          ENDIF
 
-         !write(3,*)' In nextfiles, nwant1: ',nwant1
-         !write(6,'(a,8i5)')' In nextfiles, nwant1: ',
-         !                                  nwant1,lun1,nwant1,imgnum1
          CALL GETOLDIMG(LUN1,LUNXM1,FILPAT1,NWANT1,SAYIT, 
      &                  FOUROK,IMGNUM1,IRTFLG)
 
-         !write(3,*)' gotoldimg, nstacki1,gotast1: ',nstack1,gotast1
+         write(3,*)' Gotoldimg, nwant1,imgnum1: ',nwant1,imgnum1
 
          IF (IRTFLG < 0)    RETURN    ! END OF WHOLE-STACK
          IF (IRTFLG .NE. 0) RETURN    ! ERROR
@@ -1280,7 +1425,6 @@ C           INPUT FROM A BARE STACK
             NINDX2 = IMGNUM1
          ENDIF
       ENDIF
-      ! write(6,*) 'In nextfiles1: l1,l2,irtflg:',lun1,lun2,irtflg
 
 
       IF (LUN2 > 0) THEN  
@@ -1291,10 +1435,17 @@ C        IS THIS IS A BARE STACK OPERATION?  (OK FOR SPIDER & MRC)
          CALL LUNGETISBARE(LUN2,IS_BARE2,IRTFLG)
 
 
-!        !write(6,'(a,8i5)')'  out: nindx2,ngot2,nstack2,imgnum2: ',
-!     &                             nindx2,ngot2,nstack2,imgnum2
-!         write(6,*) 'nextfiles2: l2,imgnum2,gotast2:',
-!     &                         lun2,imgnum2,gotast2
+#if defined (SP_DBUGIO)
+         write(3,*) '  '
+         write(3,*)' In nextfiles2-1; nindx2,inumbr2,nstack2,: ',
+     &                                nindx2,inumbr2,nstack2
+
+         write(3,*)' In nextfiles2-1: imgnum2,gotast2:',
+     &                                imgnum2,gotast2
+         write(3,*) ' '
+
+#endif
+
          IF (IMGNUM2 == -1 .AND. LUNXM2 > 0  ) THEN
 C           XMIPP SELFILE LISTED IMAGE
             NWANT2 = -1
@@ -1305,7 +1456,10 @@ C           MRC OR SPIDER BARE STACK INPUT   (NO LIST AVAILABLE)
 C           BARE STACK INPUT , USE SAME  OUTPUT IMAGE NUMBER
             NWANT2 = IMGNUM1
 
-            !write(3,*)'In nextfiles, :',isbare,nstack2,nwant2
+#if defined (SP_DBUGIO)
+            write(3,*)'  In nextfiles2-2; is_bare2,nstack2,nwant2:', 
+     &                                    is_bare2,nstack2,nwant2
+#endif
 
          ELSEIF (IS_BARE2 ) THEN
 C           MRC OR SPIDER BARE STACK OUTPUT   (NO LIST)
@@ -1317,8 +1471,10 @@ C              BARE STACK INPUT , USE SAME  OUTPUT IMAGE NUMBER
                 NWANT2 = IMGNUM1
             ENDIF
 
-            !write(3,*)'In nextfiles, :',isbare,nstack2,nwant2
-
+#if defined (SP_DBUGIO)
+            write(3,*)'  In nextfiles-3; is_bare2,nstack2,nwant2:', 
+     &                                   is_bare2,nstack2,nwant2
+#endif
 
          ELSEIF (NSTACK2 == -2  .OR.
      &           NSTACK2 == -1  .OR.
@@ -1327,32 +1483,62 @@ C              BARE STACK INPUT , USE SAME  OUTPUT IMAGE NUMBER
 C           NON-STACK IMAGE WITH/WITHOUT TEMPLATE LIST 
             IF (NINDX2 > NLIST2) THEN
 C               OVERUN OUTPUT LIST
-                !write(6,*) 'nindx2 > nlist2',nindx2,nlist2
                 IRTFLG = -99
+                write(3,*) 'In nextfiles-3b nindx2 > nlist2: ',
+     &                      nindx2,nlist2
+                write(3,*) 'In nextfiles-3b irtflg: ', irtflg
                 RETURN
             ENDIF
+
 C           OPEN NEXT OUTPUT FILE 
             NWANT2 = INUMBR2(NINDX2)
          ENDIF
 
-         !write(3,*)' In nextfiles, nwant2,nindx2:',nwant2,nindx2
-         !write(6,'(a,8i5)') 
-         !& ' Calling getnew,nwant2,imgnum2,nstack2:',
-         !                   nwant2,imgnum2,nstack2
+#if defined (SP_DBUGIO)
+         write(3,*)' In nextfiles2 -4; nstack2,nindx2,nwant2; ',
+     &                                 nstack2,nindx2,nwant2
+  
+         write(3,*)' In nextfiles2 -4; is_bare2,nlist2:', 
+     &                                 is_bare2,nlist2
+
+         write(3,*)' In nextfiles2 -4 Calling getnewimg; imgnum2: ',
+     &                                                   imgnum2
+#endif
 
          CALL GETNEWIMG(LUNCP,LUN2,LUNXM2,FILPAT2,NWANT2,
      &                  SAYIT,IMGNUM2,IRTFLG)
 
-         !write(3,'(a,8i5)') ' Getnew,nwant2,imgnum2,nstack2,irtflg:',
-      !&                              nwant2,imgnum2,nstack2,irtflg
+#if defined (SP_DBUGIO)
+         write(3,*)' After Gotnewimg, nwant2,imgnum2: ',
+     &                                nwant2,imgnum2
+#endif
+
+         IF (IRTFLG .NE. 0) then
+           write(3,*)' Leaving nextfiles   !!!!!!!! ; irtflg: ',irtflg
+           RETURN     ! ERROR
+         ENDIF
 
-         IF (IRTFLG .NE. 0) RETURN     ! ERROR
 
       ENDIF
-      !write(3,'(a,5i5)')' In nextfiles, nlist1,nstack1,imgnum1:',
-      !&                                 nlist1,nstack1,imgnum1
-      !write(3,'(a,5i5)')' In nextfiles, ngot2,nstack2,imgnum2:',
-      !&                                 ngot2,nstack2,imgnum2
+
+#if defined (SP_DBUGIO)
+      write(3,*)' Leaving nextfiles; nwant1,nwant2: ',nwant1,nwant2
+
+      write(3,*)' Leaving nextfiles, nlist1,nlist2:',
+     &                               nlist1,nlist2
+
+      write(3,*)' Leaving nextfiles; nstack1,nstack2: ',
+     &                               nstack1,nstack2
+
+      write(3,*)' Leaving nextfiles; imgnum1,imgnum2: ',
+     &                               imgnum1,imgnum2
+
+      write(3,*)' Leaving nextfiles; irtflg: ',irtflg
+      write(3,*)'     '
+
+
+#endif
+
 
       END
 
@@ -1397,7 +1583,7 @@ C          |        |
 C          |        |  Templated simple image:  IMG*** 
 C          |        ` ---> FILGET --> OPFILEC  
 C          |        |                         
-C          |        |  Templated stacked image: STK@@*(**     
+C          |        |  Templated stacked image: STK@@*     
 C          |        ` ---> LUN***
 C          |        | 
 C          |        |  Whole image stack:       STK@@  
@@ -1413,7 +1599,7 @@ C                   |
 C                   |  Templated simple image:  IMG*** 
 C                   ` ---> FILGET --> OPFILEC  
 C                   |                         
-C                   |  Templated stacked image: STK@@*(**     
+C                   |  Templated stacked image: STK@@*     
 C                   ` ---> LUN***
 C                   | 
 C                   |  Whole image stack:       STK@@  
@@ -1458,12 +1644,12 @@ C     IS THIS IS A BARE STACK OPERATION?
       CALL LUNGETISBARE(LUN1,IS_BARE1,IRTFLG)
       IF (IRTFLG .NE. 0) RETURN
 
-C      write(3,*)' In nextfile, gotast, filpat1:  ', gotast,filpat1
-C      write(6,*)' In nextfile, nindx1,isbare:    ',nindx1,is_bare1
-C      write(3,*)' In nextfile, ----------------------: '
-C      write(3,'(A,5i6)')
-C     &         '  In nextfile, num1,nindx1,nlist1,nwant1,nstack1: ',
-C     &                      imgnum1,nindx1,nlist1,nwant1,nstack1
+      !write(3,*)' In nextfile, gotast, filpat1:  ', gotast,filpat1
+      !write(3,*)' In nextfile, nindx1,isbare:    ',nindx1,is_bare1
+      !write(3,*)' In nextfile, ----------------------: '
+      !write(3,'(A,5i6)')
+      !&         '  In nextfile, num1,nindx1,nlist1,nwant1,nstack1: ',
+      !&                      imgnum1,nindx1,nlist1,nwant1,nstack1
 
       IF (IMGNUM1 == -1  .AND. LUNXM1 > 0 ) THEN
 C        XMIPP SELFILE LISTED IMAGE
@@ -1475,8 +1661,8 @@ C        MRC OR SPIDER BARE STACK INPUT   (NO LIST)
          IF (IMGNUM1 < 0) IMGNUM1 = 1
          NWANT1 = IMGNUM1 + 1
 
-C        write(3,'(A,5i6)')'  In nextfile, nwant1,nstack1: ',
-C       &                                  nwant1,nstack1
+         !write(3,'(A,5i6)')'  In nextfile, nwant1,nstack1: ',
+         !&                                 nwant1,nstack1
 
         IF (NWANT1 > NSTACK1) THEN
 C           FINISHED THE WHOLE STACK
@@ -1537,11 +1723,1373 @@ C        BARE STACK, OUTPUT IMAGE HAS SAME # AS INPUT ALWAYS
          NINDX1 = IMGNUM1
       ENDIF
 
-      !   write(3,'(a,5i5)')' In nextfile, nlist1,nstack1,imgnum1:',
+      !write(3,'(a,5i5)')' In nextfile, nlist1,nstack1,imgnum1:',
       !&                                   nlist1,nstack1,imgnum1
       END
 
 
+#ifdef NEVER
+      PURE LOGICAL FUNCTION LITTLE_ENDIAN()
+      
+      INTEGER(INT8)  :: J(2)
+      INTEGER(INT16) :: I
+      
+      I = 1
+      J = TRANSFER(SOURCE=I,MOLD=J,SIZE=2)
+      
+      IF (J(1) == 1) THEN
+         LITTLE_ENDIAN = .TRUE.
+      ELSE
+         LITTLE_ENDIAN = .FALSE.
+      ENDIF
+      
+      END FUNCTION
+      
+      
+      SUBROUTINE ENDIAN(LITEND)
+
+C     CHECKS IF THIS IS A LITTLE ENDIAN MACHINE
+C     RETURNS LITEND =.TRUE. IF IT IS, LITEND =.FALSE. IF NOT
+
+      INTEGER*1 J(2)
+      INTEGER*2 I
+      EQUIVALENCE (I,J)
+      
+      LOGICAL LITEND
+
+      I = 1
+      IF (J(1) .EQ. 1) THEN
+         LITEND = .TRUE.
+      ELSE
+         LITEND = .FALSE.
+      ENDIF
+
+      END
+      
+      PROGRAM TESTI
+      ! Posted by Perseus in comp.lang.fortran on 4 July 2005.
+      ! and Paul Van Delst and David Flower on 5 July 2005.
+
+      LOGICAL, PARAMETER :: BIGEND = IACHAR(TRANSFER(1,"A")) == 0
+
+      IF (BIGEND) THEN
+        PRINT *, "BIG ENDIAN"
+      ELSE
+        PRINT *, "LITTLE ENDIAN"
+      ENDIF
+
+END PROGRAM TESTI
+
+PROGRAM DETERMINE_ENDIANNESS
+    IMPLICIT NONE
+    INTEGER :: UNIT, IOSTAT
+    INTEGER(4) :: VALUE
+    CHARACTER(LEN=4) :: BYTES
+
+    ! OPEN THE FILE IN UNFORMATTED MODE
+    OPEN(UNIT=10, FILE="FILE.DAT", FORM="UNFORMATTED", ACCESS="STREAM", STATUS="OLD", IOSTAT=IOSTAT)
+    IF (IOSTAT /= 0) THEN
+        PRINT *, "ERROR OPENING FILE."
+        STOP
+    END IF
+
+    ! READ THE FIRST 4 BYTES (ASSUMING THE FILE STARTS WITH A KNOWN INTEGER)
+    READ(10) VALUE
+    CLOSE(10)
+
+    ! CONVERT THE INTEGER TO BYTES FOR ANALYSIS
+    CALL MOVE_ALLOC(TRANSFER(VALUE, BYTES), BYTES)
+
+    ! CHECK THE BYTE ORDER
+    IF (BYTES == 'EXPECTED_BIG_ENDIAN_BYTES') THEN
+        PRINT *, "FILE IS BIG ENDIAN."
+    ELSE IF (BYTES == 'EXPECTED_LITTLE_ENDIAN_BYTES') THEN
+        PRINT *, "FILE IS LITTLE ENDIAN."
+    ELSE
+        PRINT *, "UNABLE TO DETERMINE ENDIANNESS."
+    END IF
+END PROGRAM DETERMINE_ENDIANNESS
+
+
+
+#endif
+
+@
+
+
+1.45
+log
+@defined(SP_DBUGIO) altered
+@
+text
+@d39 1
+a39 1
+C  CONTAINS:  OPFILES, GETOLDIMG, GETNEWIMG, NEXTFILE, NEXTFILES
+d54 10
+a63 9
+C        LUNCP      UNIT TO COPY HEADER VALUES FROM               (SENT)
+C        LUNIMG     UNIT TO OPEN FILE ON                          (SENT)
+C        LUNDOC     UNIT TO OPEN LIST DOC FILES ON                (SENT)
+C        LUNXM      UNIT TO OPEN XMIPP SELFILE ON                 (SENT)
+C        ASKNAM     FLAG TO ASK FOR FILE NAME                     (SENT)
+C        FILPAT     FILE NAME PATTERN                             (RET)
+C        NLET       CHARS IN FILE NAME PATTERN                    (RET)
+C        DISP       CHARACTER CONTAINING ONE OF THE               (SENT) 
+C                   FOLLOWING DISPOSITION SPECIFICATIONS:
+d76 3
+a78 2
+C        ITYPE      IFORM FOR FILE                        (SENT OR RET) 
+C        NX,NY,NZ   IMAGE SIZE                            (SENT OR RET)
+d80 1
+a80 1
+C        MAXIM      STACK INDICATOR                          (SENT/RET)
+d85 4
+a88 2
+C                     >= 0 CURRENT MAX. IMAGE NO. IN STACK             
+C        PROMPT     PROMPT FOR FILNAME                           (SENT)
+d97 4
+a100 2
+C        FOUROK     CAN USE EXISTING FOURIER FILES?              (SENT)
+C        ILIST      IMAGE NUMBER LIST                             (RET)
+d103 2
+a104 1
+C        NIMAXT     MAX LENGTH OF IMAGE NUMBER LIST              (SENT)
+d106 7
+a112 4
+C        UNUSED     UNUSED PARAMETER                                (?)
+C        NTOT:      # OF IMAGES IN IMAGE NUMBER LIST              (RET)
+C                     ZERO FOR SINGLE IMAGE AND NO * 
+C        IMGNUM     IMAGE NUMBER THAT IS CURRENTLY OPEN      (SENT/RET)
+d115 2
+a116 1
+C        IRTFLG     ERROR FLAG (0 IS NORMAL)                      (RET)
+d122 2
+a123 2
+C     OPFILES Uses (E.G. STK@@****)~~9  prompt for filename
+C        v    '~9' in last 3 char. of prompt accepts extension on filename 
+d131 1
+a131 1
+C        |  Templated stack: STK@@*** 
+d135 1
+a135 1
+C        |  Whole barestack: STK@@     
+d139 1
+a139 1
+C        |  File template:   IMG***  
+d142 1
+a142 1
+C        |  Simple file:    IMG001
+d148 1
+a148 1
+C             | Templated stack:  **@@STK.MRC
+d152 1
+a152 1
+C             |  Whole barestack:  @@STK.MRC 
+d156 1
+a156 1
+C             |  File template:    IMG***.MRC
+d160 1
+a160 1
+C             |  Simple file:      IMG001.MRC
+d183 1
+a183 1
+       INTEGER                   :: ITYPE,NX,NY,NZ,MAXIM
+d218 1
+a218 1
+     &          'OUTPUT FILE NAME OR TEMPLATE (E.G. STK@@****)~~9'
+d222 1
+a222 1
+     &          'INPUT FILE NAME OR TEMPLATE (E.G. STK@@****)~~9'
+d242 1
+a242 5
+
+       !write(3,*)' In opfiles; locast,locat,nstack:',locast,locat,maxim
+       !write(3,*)' In opfiles; nimaxt:',nimaxt
+       !write(3,*)' In opfiles; imgnum: ',imgnum
+       
+d246 6
+a251 2
+       !write(3,*)' In opfiles, nimaxt: ',nimaxt
+       !write(3,*)' In opfiles, locast, asklist: ',locast,asklist 
+d254 1
+a254 1
+              
+d289 1
+d295 1
+d299 5
+a303 5
+       write(3,*)' In opfiles; locast,imgnum,imgwant: ',
+     &                         locast,imgnum,imgwant
+       write(3,*)' In opfiles; is_mrc: ',         is_mrc
+       write(3,*)' In opfiles; ilist(1:4): ',     ilist(1:4)
+       write(3,*)' In opfiles; maxim,ntot: ',     maxim,ntot
+d306 1
+d311 1
+a311 1
+          write(3,*)' In opfiles xxxx ; Calling opfiles_mrc '
+d314 16
+d332 5
+a336 4
+     &                     ITYPE,NX,NY,NZ,MAXIM,
+     &                     IMGWANT, IRTFLG) 
+          
+          IMGNUM = IMGWANT
+d339 7
+a345 1
+          write(3,*)' Opfiles returning: imgnum,irtflg: ',imgnum,irtflg 
+d352 2
+d361 1
+a361 1
+C         TEMPLATED STACKED FILE: STK@@**** -------------- _9@@* or STK@@**
+d386 1
+a386 1
+     &                        MAXIM,' ',FOUROK,IRTFLG) 
+d455 1
+a455 1
+     &                        MAXIM,'INPUT',FOUROK,IRTFLG) 
+d557 1
+a557 1
+C         SINGLE SIMPLE  INPUT FILE:  IMG001   ----------------- IMG001
+d569 1
+a569 1
+     &                        MAXIM,PROMPT,FOUROK,IRTFLG) 
+d572 1
+a572 1
+          !write(3,*)' Back In opfiles, Opened: ',irtflg,filpat(1:nlet)
+d583 1
+d585 2
+a586 4
+          !write(3,*)' In opfiles: itype,maxim,nimaxt,ntot: ',
+          !&                       itype,maxim,nimaxt,ntot 
+          !write(3,*)' In opfiles: imgnum,irtflg: ',
+          !&                       imgnum,irtflg 
+d589 3
+a591 1
+          !write(3,*)' In opfiles: luncp,iflipin: ',luncp,iflipin 
+d595 6
+a600 3
+      !write(3,*)' Opfiles returning: maxim,nimaxt,ntot,imgnum,irtflg: ', 
+      !&                               maxim,nimaxt,ntot,imgnum,irtflg 
+      write(3,*)' ------- LEAVING OPFILES AT END --------' 
+d643 1
+a643 1
+C          |  Templated stacked image: STK@@*(**     
+d754 1
+a754 1
+C          TEMPLATED STACKED SPIDER IMAGE --------------------- STK@@***
+d875 1
+a875 1
+C          |  Templated stacked MRC image: *@@MRC or *@@.MRCS
+d966 1
+a966 1
+C          TEMPLATED STACKED MRC IMAGE ---------------------- **@@STK.mrc
+d975 1
+a975 1
+C          STACKED IMAGE ------------------------------- STK@@*  or STK@@
+a999 1
+
+d1052 6
+a1057 6
+C NEXTFILES(NINDX1, NINDX2, INUMBR1,INUMBR2, 
+C           FOUROK,NLIST1,NLIST2,   
+C           NSTACK1,NSTACK2,   
+C           LUN1,LUNCP,LUN2, FILPAT1,FILPAT2,
+C           IMGNUM1,IMGNUM2,IRTFLG) 
+C
+d1071 2
+a1072 2
+C             IMGNUM1,IMGNUM2  IMAGE NUMBERS                (SENT/RET.)
+C             IRTFLG           ERROR (0 IS OK, -1 IS END STACK)  (RET.)
+d1113 4
+a1116 3
+      write(3,*)' In Nextfiles; lun1,lun2: ',lun1,lun2
+      write(3,*)' In Nextfiles; nindx1,nindx2: ', nindx1,nindx2
+      write(3,*)' In Nextfiles; nlist1,nlist2: ', nlist1,nlist2
+d1161 1
+a1161 1
+         !write(3,*)' gotoldimg, nstack1,gotast1: ',nstack1,gotast1
+d1183 7
+a1189 2
+         write(3,*)' In nextfiles2; nindx2,inumbr2,nstack2,: ',
+     &                              nindx2,inumbr2,nstack2
+a1190 2
+         write(3,*)' In nextfiles2: imgnum2,gotast2:',
+     &                              imgnum2,gotast2
+d1203 4
+a1206 1
+            !write(3,*)'  In nextfiles, :',isbare,nstack2,nwant2
+d1219 2
+a1220 1
+            !write(3,*)' In nextfiles, :',isbare,nstack2,nwant2
+a1229 1
+                !write(3,*) 'nindx2 > nlist2',nindx2,nlist2
+d1231 3
+d1236 1
+d1241 10
+a1250 4
+         !write(3,*)' In nextfiles, nwant2,nindx2:',nwant2,nindx2
+         !write(3,'(a,8i5)') 
+         !& ' Calling getnew,nwant2,imgnum2,nstack2:',
+         !                   nwant2,imgnum2,nstack2
+d1256 2
+a1257 1
+         write(3,'(a,8i5)')' Leaving nextfiles; irtflg: ',irtflg
+d1260 5
+a1264 1
+         IF (IRTFLG .NE. 0) RETURN     ! ERROR
+d1271 8
+a1278 2
+      write(3,'(a,5i5)')' Leaving nextfiles, nlist1,nlist2:',
+     &                                       nlist1,nlist2
+d1280 2
+a1281 2
+      write(3,'(a,8i5)')' Leaving nextfiles; nstack1,nstack2: ',
+     &                                       nstack1,nstack2
+a1282 2
+      write(3,'(a,8i5)')' Leaving nextfiles; imgnum1,imgnum2: ',
+     &                                       imgnum1,imgnum2
+a1283 1
+      write(3,'(a,8i5)')' Leaving nextfiles; irtflg: ',irtflg
+d1330 1
+a1330 1
+C          |        |  Templated stacked image: STK@@*(**     
+d1346 1
+a1346 1
+C                   |  Templated stacked image: STK@@*(**     
+@
+
+
+1.44
+log
+@debugio output
+@
+text
+@d99 1
+d101 1
+a101 1
+C                   ZERO FOR SINGLE IMAGE AND NO * 
+d103 2
+a104 8
+C                   ON INPUT:   IF (BARESTACK) IS # WANTED
+C                   ON OUTPUT:  <0 IS SELFILE IN USE 
+C        ILIST      IMAGE NUMBER LIST                             (RET)
+C                     IF NIMAXT < 0 MUST BE SENT
+C                     UNUSED IF SINGLE IMAGE/SELFILE 
+C        UNUSED     UNUSED PARAMETER                                (?)
+C        NTOT       # OF IMAGES IN IMAGE NUMBER LIST              (RET)
+C                     ZERO FOR SINGLE IMAGE AND NO * 
+d108 1
+a108 1
+C 
+d153 1
+a153 1
+C23456789 123456789 123456789 123456789 123456789 123456789 123456789 12 
+a231 2
+
+       !write(3,*)' In opfiles; ilist:',ilist(1)
+d282 2
+a283 2
+#if defined (SP_DBUG)
+       write(3,*)' In opfiles, asklist,nimaxp: ', 
+d285 2
+a286 2
+       write(3,*)' In opfiles, filpat: ',filpat(1:36)
+       write(3,*)' In opfiles, locast,imgnum,imgwant: ',
+d288 3
+a290 3
+       write(3,*)' In opfiles, is_mrc: ',         is_mrc
+       write(3,*)' In opfiles, ilist: ',          ilist(1:5)
+       write(3,*)' In opfiles, maxim,ntot: ',     maxim,ntot
+d296 2
+a297 2
+#if defined (SP_DBUG)
+          write(3,*)' In opfiles, calling opfiles_mrc '
+a305 1
+          NTOT   = 0          !???????????? needed
+d307 2
+a308 4
+#if defined (SP_DBUG)
+        write(3,*)
+     &    ' Opfiles_mrc returned: maxim,nimaxt,ntot,imgnum,irtflg: ',
+     &                            maxim,nimaxt,ntot,imgnum,irtflg 
+d458 1
+a458 2
+C         A SIMPLE FILE TEMPLATE: IMG*** ----------------------- IMG***
+C         A SIMPLE FILE: IMG*** ----------------------- IMG***
+d476 1
+a476 1
+     &                        MAXIM,' ',FOUROK,IRTFLG) 
+d479 5
+a483 1
+          !write(3,*)' Opened templated: ',filpat(:nlet),' for:',ntot,' images.'
+d487 1
+a487 1
+C         SINGLE INPUT FILE: IMG001 -------------------------- IMG001
+d489 1
+a489 1
+C         OR XMIPP SELFILE LISTING FILE: SELX --------------- SELFILE
+d534 1
+a534 1
+          write(3,*)' Back in opfiles, itype,irtflg: ',itype,irtflg
+d584 1
+a584 1
+C        NWANT      IMAGE NUMBER WANTED (<0 IS SELFILE)           (SENT) 
+d586 2
+a587 2
+C        FOUROK     FOURIER INPUT OK FLAG                         (SENT) 
+C        NGOT       IMAGE NUMBER FOUND                            (RET.) 
+d593 1
+a593 2
+C
+C  CALL TREE:
+d705 1
+a705 1
+           !write(3,*) ' In getoldimg, nwant: ',nwant,locat,locast,filpat
+d717 2
+a718 2
+              !write(3,*) ' In opfiles lunredhed; lun,nx,irtflg:',
+c    &                                            lun,nx,irtflg
+d743 2
+a744 1
+           !write(3,*)' Opened old templated stacked file: ',filnam(:nlet)
+d1070 6
+a1114 4
+         !write(3,*)' In nextfiles, nwant1: ',nwant1
+         !write(3,'(a,8i5)')' In nextfiles, nwant1: ',
+         !                                  nwant1,lun1,nwant1,imgnum1
+
+d1118 1
+a1118 1
+         !write(3,*)' gotoldimg, nstacki1,gotast1: ',nstack1,gotast1
+a1128 1
+      !write(3,*) 'In nextfiles1: l1,l2,irtflg:',lun1,lun2,irtflg
+d1139 7
+a1145 4
+         !write(3,'(a,8i5)')'  out: nindx2,ngot2,nstack2,imgnum2: ',
+        !&                          nindx2,ngot2,nstack2,imgnum2
+         !write(3,*) 'nextfiles2: lun2,imgnum2,gotast2:',
+        !&                        lun2,imgnum2,gotast2
+d1157 1
+a1157 1
+            !write(3,*)'In nextfiles, :',isbare,nstack2,nwant2
+d1169 3
+a1171 1
+            !write(3,*)'In nextfiles, :',isbare,nstack2,nwant2
+d1196 3
+a1198 2
+         !write(3,'(a,8i5)') ' Getnew,nwant2,imgnum2,nstack2,irtflg:',
+      !&                              nwant2,imgnum2,nstack2,irtflg
+d1203 16
+a1218 4
+      !write(3,'(a,5i5)')' In nextfiles, nlist1,nstack1,imgnum1:',
+      !&                                 nlist1,nstack1,imgnum1
+      !write(3,'(a,5i5)')' In nextfiles, ngot2,nstack2,imgnum2:',
+      !&                                 ngot2,nstack2,imgnum2
+@
+
+
+1.43
+log
+@imporved call tree, debug output
+@
+text
+@d499 1
+d501 1
+d528 1
+d531 2
+a532 1
+          !write(3,*)' In opfiles, Calling opfilec,  disp: ',disp
+d539 4
+a542 2
+          !write(3,*)' In opfiles, Opened: ',irtflg,filpat(1:nlet)
+          !write(3,*)' Back in opfiles, itype,irtflg: ',itype,irtflg
+d561 5
+a565 3
+      !write(3,*)' Returning spi: maxim,nimaxt,ntot,imgnum,irtflg: ', 
+      !&                          maxim,nimaxt,ntot,imgnum,irtflg 
+      !write(3,*)' ------- LEAVING OPFILES AT END --------' 
+@
+
+
+1.42
+log
+@debug output to unit 3
+@
+text
+@d15 1
+d116 9
+a124 5
+C     OPFILES 
+C        v
+C     FILERD
+C        v 
+C     FILELIST
+d126 2
+a127 2
+C        ` ---> FILNAMANDEXT --> OPFILEC --> GETOLDIMG
+C        |                               --> GETNEWIMG
+d130 2
+a131 2
+C        ` ---> FILNAMANDEXT --> OPFILEC --> GETOLDIMG
+C        |                               --> GETNEWIMG
+d134 1
+a134 1
+C        ` ---> FILGET       --> OPFILEC  
+d137 1
+a137 1
+C        ` --------------------> OPFILEC  
+d140 17
+a156 17
+C        ` -> OPFILES_MRC
+C           |
+C           |  Templated stack:  **@@STK.MRC
+C           ` ---> FILGET_AT --> OPFILEC --> OPENFIL_MRC --> OPENFIL_O_MRC 
+C           |                                            --> OPENFIL_N_MRC
+C           |
+C           |  Whole barestack:  @@STK.MRC 
+C           ` ---> FILGET_AT --> OPFILEC --> OPENFIL_MRC --> OPENFIL_O_MRC
+C           |                                            --> OPENFIL_N_MRC
+C           | 
+C           |  File template:    IMG***.MRC
+C           ` ---> FILGET_AT --> OPFILEC --> OPENFIL_MRC --> OPENFIL_O_MRC
+C           |                                            --> OPENFIL_N_MRC
+C           | 
+C           |  Simple file:      IMG001.MRC
+C           ` -----------------> OPFILEC --> OPENFIL_MRC --> OPENFIL_O_MRC  
+C                                                        --> OPENFIL_N_MRC
+a171 3
+        integer                  :: lunara,lunstk,lunarb,lunflip
+        common /lunara/ lunara(100),lunstk(100),lunarb(100),lunflip(100)
+ 
+a297 1
+       write(3,*)' In opfiles, lunflip(lunimg): ',lunflip(lunimg)
+a552 1
+          !write(3,*)' In opfiles: lunflip(luncp): ',lunflip(luncp) 
+@
+
+
+1.41
+log
+@cosmetic comments
+@
+text
+@d194 1
+a194 1
+       LOGICAL                   :: IS_MRC,IS_BARE
+d198 1
+a198 1
+
+d235 5
+a239 4
+       !write(6,*)' In opfiles; ilist:',ilist(1)
+       !write(6,*)' In opfiles; locast,locat,nstack:',locast,locat,maxim
+       !write(6,*)' In opfiles; nimaxt:',nimaxt
+       !write(6,*)' In opfiles; imgnum: ',imgnum
+d244 2
+a245 2
+       !write(6,*)' In opfiles, nimaxt: ',nimaxt
+       !write(6,*)' In opfiles, locast, asklist: ',locast,asklist 
+d247 2
+a248 3
+       IMGWANT = MAX(1,IMGNUM)   ! DEFAULT IMAGE NUMBER               
+       !write(6,*)' in opfiles, locast, asklist,imgnum,imgwant: ',
+c     &                         locast,asklist,imgnum,imgwant 
+d259 1
+a259 1
+          !write(6,*)' In opfiles, imgwant aa: ',imgwant
+d267 1
+a267 2
+          !write(6,*)' In opfiles, imgwant bb: ',imgwant
+
+a282 5
+       !write(6,*)' In opfiles, nimaxt: ',nimaxt
+       !write(6,*)' In opfiles, ilist: ',ilist(1:5)
+       !write(6,*)' In opfiles, asklist,nimaxp: ',asklist,nimaxp
+       !write(6,*)' In opfiles, maxim,ntot,imgwant: ',maxim,ntot,imgwant
+ 
+d286 12
+a297 1
+       !write(6,*)' In opfiles, is_mrc, filpat: ',is_mrc, filpat(1:33)
+d300 1
+a300 1
+C         OPEN MRC FILE
+d302 3
+a304 1
+          !write(6,*)' In opfiles, calling opfiles_mrc '
+d314 5
+a318 2
+         !write(6,*)' RETURNING mrc: maxim,nimaxt,ntot,imgnum,irtflg: ',
+         !&                          maxim,nimaxt,ntot,imgnum,irtflg 
+d321 2
+a322 1
+       ENDIF
+d327 2
+a328 2
+       !write(6,*) ' In opfiles NOT MRC - imgnum 0: ',imgnum
+       !write(6,*) ' In opfiles; locat,locast: ',locat,locast
+d350 1
+a350 1
+          !write(6,*)'In opfiles - imgwant,imgnum1: ',imgwant,imgnum
+d354 1
+a354 1
+	  CALL OPFILEC(LUNCP,.FALSE.,FILNAM,LUNIMG,DISP,
+d356 2
+a357 2
+     & 		       MAXIM,' ',FOUROK,IRTFLG) 
+	  IF (IRTFLG .NE. 0) GOTO 9000 
+d359 2
+a360 2
+          !write(6,*) ' In opfiles - locast: ',locat,locast,filnam
+          !write(6,*) ' In opfiles - imgwant,imgnum2: ',imgwant,imgnum
+d377 1
+a377 1
+             !write(6,*)' In opfiles  imgwant,imgnum: ',imgwant,imgnum
+d382 1
+a382 1
+             !write(6,*) ' In opfiles mgwant,imgnum3:',imgwant,imgnum
+d394 1
+a394 1
+          !write(6,'(a,a,a,i6,a,i6,a,i6)')' opened templated stack: ',
+d425 2
+a426 2
+     & 		       MAXIM,'INPUT',FOUROK,IRTFLG) 
+	  IF (IRTFLG .NE. 0) GOTO 9000
+d441 2
+a442 1
+         
+d445 1
+a445 1
+	     CALL GETOLDIMG(LUNIMG,LUNDOC,FILPAT, IMGWANT,
+d461 4
+a464 3
+          !write(6,*)' Opened bare stack:',filpat(1:nlet),' img:',imgnum
+          !write(6,*)' Opened imgnum, stack:',imgnum,filpat(1:nlet)
+          !write(6,*)' Opened imgwant,ntot:',imgwant,imgnum,ntot
+d480 1
+a480 1
+	  IF (IRTFLG .NE. 0) GOTO 9000 
+d484 1
+a484 1
+	  CALL OPFILEC(LUNCP,.FALSE.,FILNAM,LUNIMG,DISP,
+d486 4
+a489 2
+     & 		       MAXIM,' ',FOUROK,IRTFLG) 
+	  IF (IRTFLG .NE. 0) GOTO 9000 
+a490 1
+          !write(6,*)' Opened templated: ',filpat(:nlet), ' for:',ntot,' images.'
+d498 1
+a498 1
+          !write(6,*) ' In opfiles ; Simple file: ',filpat(:nlet)
+d502 1
+a502 1
+             !write(6,*)' Filpat for openxmsel: ',filpat(:nlet) 
+d504 1
+a504 1
+             !write(6,*)' Filnam from openxmsel: ',ntot,':',filnam(:nlet) 
+d510 1
+a510 1
+	        CALL OPFILEC(LUNCP,.FALSE.,FILNAM(:NLET),LUNIMG,DISP,
+d512 2
+a513 2
+     & 		             MAXIM,'dum~9',FOUROK,IRTFLG) 
+	        IF (IRTFLG .NE. 0) GOTO 9000 
+d516 1
+a516 1
+                !write(6,*)' Opened selfile image: ',filnam(1:nlet) 
+d525 3
+a527 3
+          !write(6,*)' In opfiles, filpat,itype:     ',filpat(1:nlet)
+          !write(6,*)' In opfiles, itype,nx:',itype,nx
+          !write(6,*)' In opfiles, Calling opfilec,  disp: ',disp
+d530 1
+a530 1
+	  CALL OPFILEC(LUNCP,.FALSE.,FILPAT,LUNIMG,DISP,
+d532 1
+a532 1
+     & 		       MAXIM,PROMPT,FOUROK,IRTFLG) 
+d534 2
+a535 2
+          !write(6,*)' In opfiles, Opened: ',irtflg,filpat(1:nlet)
+          !write(6,*)' Back in opfiles, itype,irtflg: ',itype,irtflg
+d539 1
+a539 1
+	  IF (IRTFLG .NE. 0) GOTO 9000 
+d544 2
+a545 2
+          !write(6,*)' In opfiles, Opened simple : ',filpat(1:nlet)
+          !write(6,*)' In opfiles: itype,maxim,nimaxt,ntot: ',
+d547 1
+a547 1
+          !write(6,*)' In opfiles: imgnum,irtflg: ',
+d551 2
+a552 2
+          !write(6,*)' In opfiles: luncp,iflipin: ',luncp,iflipin 
+          !write(6,*)' In opfiles: lunflip(luncp): ',lunflip(luncp) 
+d555 1
+a555 1
+      !write(6,*)' Returning spi: maxim,nimaxt,ntot,imgnum,irtflg: ', 
+d557 1
+a557 1
+      !write(6,*)' ------- LEAVING OPFILES AT END --------' 
+d612 1
+a612 1
+	SUBROUTINE GETOLDIMG(LUN,LUNXM,FILPAT,NWANT, SAYIT,
+d640 2
+a641 3
+
+        !write(6,*)' locast,locat:',locast,locat,nlet,filpat(1:nlet)
+        !write(6,*)' getoldimg, nwant,: ',nwant,':',filpat(1:nlet)
+d653 1
+a653 1
+	   IF (IRTFLG .NE. 0) RETURN 
+d657 1
+a657 1
+	   CALL OPFILEC(0,.FALSE.,FILNAM(:NLET),LUN,'O',ITYPE,
+d659 2
+a660 2
+     & 		       MAXIM,'~9',FOUROK,IRTFLG) 
+	   IF (IRTFLG .NE. 0) RETURN 
+d665 1
+a665 1
+	   IF (IRTFLG .NE. 0) RETURN 
+d667 1
+a667 1
+           !write(6,*)' Opened old xmipp selfile file: ',filnam(1:nlet)
+d681 1
+a681 1
+	   IF (IRTFLG .NE. 0) RETURN 
+d684 1
+a684 1
+	   CALL OPFILEC(0,.FALSE.,FILNAM,LUN,'O',ITYPE,
+d686 2
+a687 2
+     & 		       MAXIM,' ',FOUROK,IRTFLG) 
+	   IF (IRTFLG .NE. 0) RETURN 
+d692 1
+a692 1
+	   IF (IRTFLG .NE. 0) RETURN 
+d694 1
+a694 1
+           !write(6,*)' Opened old templated file: ',filnam(1:nlet),maxim
+d705 1
+a705 1
+           !write(6,*) ' In getoldimg, nwant: ',nwant,locat,locast,filpat
+d717 1
+a717 1
+              !write(6,*) ' In opfiles lunredhed; lun,nx,irtflg:',
+d729 1
+a729 1
+              !write(6,*)' In opfiles lungetinuse, lun,imused:',
+d743 1
+a743 1
+           !write(6,*)' Opened old templated stacked file: ',filnam(:nlet)
+d781 2
+a782 2
+           !write(6,*)' Opened old bare stacked file: ',filnam(1:nlet)
+           !write(6,*)' Ngot,nx:',ngot,nx,lun,imused,irtflg
+d795 1
+a795 1
+	END
+d836 1
+a836 1
+	SUBROUTINE GETNEWIMG(LUNCP,LUN,LUNXM,FILPAT,NWANTT, 
+d868 1
+a868 1
+        !write(6,*)' In getnewimg - nwant,locat:',nwant,locat,filpat
+d880 1
+a880 1
+	   IF (IRTFLG .NE. 0) RETURN 
+d884 1
+a884 1
+	   CALL OPFILEC(0,.FALSE.,FILNAM(1:NLET),LUN,'U',ITYPE1,
+d886 2
+a887 2
+     & 		       MAXIM,'~9',FOUROK,IRTFLG) 
+	   IF (IRTFLG .NE. 0) RETURN 
+d889 1
+a889 1
+           !write(6,*)' Opened new Xmipp selfile file: ',filnam(1:nlet)
+d905 1
+a905 1
+	   IF (IRTFLG .NE. 0) RETURN 
+d909 1
+a909 1
+	   CALL OPFILEC(LUNCP,.FALSE.,FILNAM,LUN,'U',ITYPE,
+d912 1
+a912 1
+	   IF (IRTFLG .NE. 0) RETURN 
+d914 1
+a914 1
+           !write(6,*)' Opened new templated file: ',filnam(1:nlet)
+d952 2
+a953 2
+           !write(6,*)' In getnewimg - isbare,filpat: ',isbare, filpat
+           !write(6,*)' In getnewimg - nwant,maxim,istak: ',  
+d996 1
+a996 1
+           !write(6,*)' Opened new stacked file: ',FILNAM(1:NLET)
+d1000 1
+a1000 1
+	END
+d1108 2
+a1109 2
+         !write(6,*)' In nextfiles, nwant1: ',nwant1
+         !write(6,'(a,8i5)')' In nextfiles, nwant1: ',
+d1115 1
+a1115 1
+         !write(6,*)' gotoldimg, nstacki1,gotast1: ',nstack1,gotast1
+d1126 1
+a1126 1
+      !write(6,*) 'In nextfiles1: l1,l2,irtflg:',lun1,lun2,irtflg
+d1137 1
+a1137 1
+         !write(6,'(a,8i5)')'  out: nindx2,ngot2,nstack2,imgnum2: ',
+d1139 1
+a1139 1
+         !write(6,*) 'nextfiles2: lun2,imgnum2,gotast2:',
+d1152 1
+a1152 1
+            !write(6,*)'In nextfiles, :',isbare,nstack2,nwant2
+d1164 1
+a1164 1
+            !write(6,*)'In nextfiles, :',isbare,nstack2,nwant2
+d1173 1
+a1173 1
+                !write(6,*) 'nindx2 > nlist2',nindx2,nlist2
+d1181 2
+a1182 2
+         !write(6,*)' In nextfiles, nwant2,nindx2:',nwant2,nindx2
+         !write(6,'(a,8i5)') 
+d1189 1
+a1189 1
+         !write(6,'(a,8i5)') ' Getnew,nwant2,imgnum2,nstack2,irtflg:',
+d1195 1
+a1195 1
+      !write(6,'(a,5i5)')' In nextfiles, nlist1,nstack1,imgnum1:',
+d1197 1
+a1197 1
+      !write(6,'(a,5i5)')' In nextfiles, ngot2,nstack2,imgnum2:',
+d1304 4
+a1307 4
+      !write(6,*)' In nextfile, gotast, filpat1:  ', gotast,filpat1
+      !write(6,*)' In nextfile, nindx1,isbare:    ',nindx1,is_bare1
+      !write(6,*)' In nextfile, ----------------------: '
+      !write(6,'(A,5i6)')
+d1321 1
+a1321 1
+         !write(6,'(A,5i6)')'  In nextfile, nwant1,nstack1: ',
+d1346 1
+a1346 1
+      !write(6,*)' In nextfile, nindx1,nlist1,nstack1,imgnum1: ',
+d1348 1
+a1348 1
+      !write(6,*)'  In nextfile, calling get, nwant1,imgnum1,nstack1:',
+d1355 1
+a1355 1
+         !write(6,*) ' Call gotoldimg, nwant1: ',nwant1,imgnum1
+d1359 1
+a1359 1
+         !write(6,*)' Gotoldimg, nlist1,nwant1,imgnum1: ',
+d1368 1
+a1368 1
+         !write(6,*) ' Call gotnewimg, nwant1: ',nwant1,imgnum1
+d1372 1
+a1372 1
+         !write(6,*) ' Getnewimg, nwant1,imgnum1,nstack1,irtflg:',
+d1383 1
+a1383 1
+      !write(6,'(a,5i5)')' In nextfile, nlist1,nstack1,imgnum1:',
+@
+
+
+1.40
+log
+@removed debug outputs,  cosmetic
+@
+text
+@d15 1
+d307 2
+a308 3
+c        write(6,*)' RETURNING mrc: maxim,nimaxt,ntot,imgnum,irtflg: ', 
+c     &                             maxim,nimaxt,ntot,imgnum,irtflg 
+c        write(6,*)' ------- LEAVING OPFILES  for MRC  END --------' 
+d316 2
+a317 1
+       !write(6,*) ' In opfiles - imgnum 0: ',imgnum
+d339 1
+a339 1
+          !write(6,*) ' In opfiles - imgwant,imgnum1: ',imgwant,imgnum
+d366 1
+a366 1
+             !write(6,*) ' In opfiles a- imgwant,imgnum: ',imgwant,imgnum
+d371 1
+a371 1
+          !write(6,*) ' In opfiles b- imgwant,imgnum3:',imgwant,imgnum
+d384 1
+a384 2
+!     &          filpat(1:nlet),' at image: ',imgnum, 
+!     &          '  maxim: ',maxim
+d455 1
+d476 1
+a476 1
+          !write(6,*)' Opened templated file: ',filpat(1:nlet), '  for:',ntot,' images.'
+d479 6
+a484 3
+C         SINGLE SIMPLE INPUT FILE: IMG001 ------------------- IMG001
+C         OR XMIPP SELFILE LISTING FILE: SELX ---------------- SELFILE
+C         OR TRYING TO COPY NON-SPIDER FILE   ---------------- NONSPIFILE
+d508 2
+a509 1
+C         SINGLE SIMPLE INPUT FILE: IMG001 ------------------ IMG001
+d513 1
+a513 2
+          !write(6,*)' In opfiles, calling opfilec,  disp: ',disp
+          !write(6,*)' In opfiles, calling opfilec uuuuuuuuu '
+a520 1
+          !write(6,*) '   '
+d522 1
+a522 2
+          !write(6,*) '   '
+
+a529 1
+          !write(6,*)' In opfiles --------------- 000 --------'
+d532 1
+a532 1
+!     &                              itype,maxim,nimaxt,ntot 
+d534 1
+a534 2
+!     &                            imgnum,irtflg 
+	  
+a536 1
+	
+a538 1
+          !write(6,*)' ------- LEAVING OPFILES END OF 000 --------' 
+d541 3
+a543 3
+      !write(6,*)' RETURNING spi: maxim,nimaxt,ntot,imgnum,irtflg: ', 
+!     &                           maxim,nimaxt,ntot,imgnum,irtflg 
+      !write(6,*)' ------- LEAVING OPFILES END --------' 
+d898 1
+a898 1
+     & 		       MAXIM,' ',FOUROK,IRTFLG) 
+d1113 1
+a1113 1
+      ! write(6,*) 'In nextfiles1: l1,l2,irtflg:',lun1,lun2,irtflg
+d1124 4
+a1127 4
+!        !write(6,'(a,8i5)')'  out: nindx2,ngot2,nstack2,imgnum2: ',
+!     &                             nindx2,ngot2,nstack2,imgnum2
+!         write(6,*) 'nextfiles2: l2,imgnum2,gotast2:',
+!     &                         lun2,imgnum2,gotast2
+d1291 6
+a1296 6
+C     write(6,*)' In nextfile, gotast, filpat1:  ', gotast,filpat1
+C     write(6,*)' In nextfile, nindx1,isbare:    ',nindx1,is_bare1
+C     write(6,*)' In nextfile, ----------------------: '
+C     write(6,'(A,5i6)')
+C     &         '  In nextfile, num1,nindx1,nlist1,nwant1,nstack1: ',
+C     &                      imgnum1,nindx1,nlist1,nwant1,nstack1
+d1308 2
+a1309 2
+C        write(6,'(A,5i6)')'  In nextfile, nwant1,nstack1: ',
+C       &                                  nwant1,nstack1
+d1370 1
+a1370 1
+      !   write(6,'(a,5i5)')' In nextfile, nlist1,nstack1,imgnum1:',
+@
+
+
+1.39
+log
+@DEBUG OUTPUT ADDED, NTOT 0 RETURNED
+@
+text
+@d21 1
+a21 1
+C=* Email: spider@@health.ny.gov                                        *
+d234 4
+a237 4
+       !write(6,*)' In opfiles, ilist:',ilist(1)
+       !write(6,*)' In opfiles, locast,locat,nstack:',locast,locat,maxim
+       write(6,*)' In opfiles, nimaxt:',nimaxt
+       write(6,*)' In opfiles, imgnum: ',imgnum
+a238 2
+ 
+
+d291 1
+a291 1
+       write(6,*)' In opfiles, is_mrc, filpat: ',is_mrc, filpat(1:33)
+d296 1
+a296 1
+          write(6,*)' In opfiles, calling opfiles_mrc '
+d306 3
+a308 3
+        write(6,*)' RETURNING mrc: maxim,nimaxt,ntot,imgnum,irtflg: ', 
+     &                             maxim,nimaxt,ntot,imgnum,irtflg 
+        write(6,*)' ------- LEAVING OPFILES  for MRC  END --------' 
+d508 2
+a509 3
+           write(6,*)' In opfiles, calling opfilec,  disp: ',disp
+
+       write(6,*)' In opfiles, calling opfilec uuuuuuuuu '
+d518 1
+a518 1
+        write(6,*)' Back in opfiles, itype,irtflg: ',itype,irtflg
+d528 6
+a533 6
+          write(6,*)' In opfiles --------------- 000 --------'
+          write(6,*)' In opfiles, Opened simple : ',filpat(1:nlet)
+          write(6,*)' In opfiles: itype,maxim,nimaxt,ntot: ',
+     &                              itype,maxim,nimaxt,ntot 
+          write(6,*)' In opfiles: imgnum,irtflg: ',
+     &                            imgnum,irtflg 
+d540 1
+a540 1
+           write(6,*)' ------- LEAVING OPFILES END OF 000 --------' 
+d543 3
+a545 3
+      write(6,*)' RETURNING spi: maxim,nimaxt,ntot,imgnum,irtflg: ', 
+     &                           maxim,nimaxt,ntot,imgnum,irtflg 
+      write(6,*)' ------- LEAVING OPFILES END --------' 
+d1100 1
+d1130 1
+a1153 1
+
+@
+
+
+1.38
+log
+@debugging comments removed 
+common /lunara/ lunara(100),lunstk(100),lunarb(100),lunflip(100
+other gfort complaints fixed
+@
+text
+@d14 2
+a15 2
+C
+C ********************************************************************** 
+d236 2
+a237 2
+       !write(3,*)' In opfiles, nimaxt:',nimaxt
+       !write(3,*)' In opfiles, imgnum: ',imgnum
+d239 1
+d244 2
+a245 2
+       !write(3,*)' in opfiles, nimaxt: ',nimaxt
+       !write(3,*)' in opfiles, locast, asklist: ',locast,asklist   !was here
+d248 1
+a248 1
+       !write(3,*)' in opfiles, locast, asklist,imgnum,imgwant: ',
+d260 1
+a260 1
+          !write(3,*)' In opfiles, imgwant aa: ',imgwant
+d268 1
+a268 1
+          !write(3,*)' In opfiles, imgwant bb: ',imgwant
+d285 5
+a289 5
+       !write(3,*)' In opfiles, nimaxt: ',nimaxt
+       !write(3,*)' In opfiles, ilist: ',ilist(1:5)
+       !write(3,*)' In opfiles, asklist,nimaxp: ',asklist,nimaxp
+       !write(3,*)' In opfiles, maxim,ntot,imgwant: ',maxim,ntot,imgwant
+
+d293 2
+d297 3
+d306 5
+d318 1
+a318 3
+
+       !write(3,*) '     '
+       !write(3,*) ' In opfiles - imgnum 0: ',imgnum
+a351 1
+
+d367 1
+a367 1
+             !write(6,*) ' In opfiles - imgwant,imgnum: ',imgwant,imgnum
+d372 1
+a372 1
+             !write(6,*) ' In opfiles - imgwant,imgnum3:',imgwant,imgnum
+d451 1
+a451 1
+          !write(3,*)' Opened bare stack:',filpat(1:nlet),' img:',imgnum
+d453 1
+a453 1
+          !write(3,*)' Opened imgwant,ntot:',imgwant,imgnum,ntot
+d477 1
+a477 1
+          !write(3,*)' Opened templated file: ',filpat(1:nlet), '  for:',ntot,' images.'
+d480 3
+a482 3
+C         SINGLE SIMPLE INPUT FILE: IMG001 -------------------- IMG001
+C         OR XMIPP SELFILE LISTING FILE: SELX ----------------- SELFILE
+C         OR TRYING TO COPY NON-SPIDER FILE   ----------------- NONSPIFILE
+a488 1
+
+d508 5
+a512 3
+          !write(3,*)' In opfiles, filpat,itype:     ',filpat(1:nlet)
+          !write(3,*)' In opfiles, itype,nx:',itype,nx
+          !write(3,*)' In opfiles, CALLING opfilec,  disp: ',disp
+a513 1
+ 
+d519 4
+a522 6
+          !write(3,*)' In opfiles, Opened: ',irtflg,filpat(1:nlet)
+          !write(3,*) '   '
+          !write(3,*)' Back in opfiles, itype,irtflg: ',itype,irtflg
+          !write(3,*) '   '
+
+
+d531 6
+a536 3
+          !write(3,*)' '
+          !write(3,*)' In opfiles --------------- 000 --------'
+          !write(3,*)' In opfiles, Opened simple: ',filpat(1:nlet)
+d541 3
+a543 3
+          !write(3,'(a,4i6)')'  In opfiles: luncp,iflipin,: ',luncp,iflipin 
+          !write(3,'(a,4i6)')'  In opfiles: lunflip(luncp): ',lunflip(luncp) 
+          !write(3,*)' ------------ END OF 000 LEAVING OPFILES --------' 
+d546 4
+d632 2
+a633 2
+        !write(3,*)' locast,locat:',locast,locat,nlet,filpat(1:nlet)
+        !write(3,*)' getoldimg, nwant,: ',nwant,':',filpat(1:nlet)
+d659 1
+a659 1
+           !write(3,*)' Opened old xmipp selfile file: ',filnam(1:nlet)
+d686 1
+a686 1
+           !write(3,*)' Opened old templated file: ',filnam(1:nlet),maxim
+d697 1
+a697 1
+           !write(3,*) ' In getoldimg, nwant: ',nwant,locat,locast,filpat
+d709 2
+a710 1
+              !write(3,*) ' In opfiles lunredhed,lun,nx,irtflg:',lun,nx,irtflg
+d721 2
+a722 1
+              !write(3,*) ' In opfiles lungetinuse, lun,imused:',lun,imused
+d735 1
+a735 1
+           !write(3,*)' Opened old templated stacked file: ',FILNAM(:NLET)
+d773 2
+a774 2
+           !write(3,*)' Opened old bare stacked file: ',filnam(1:nlet)
+           !write(3,*)' Ngot,nx:',ngot,nx,lun,imused,irtflg
+d860 1
+a860 1
+        !write(3,*)' In getnewimg - nwant,locat:',nwant,locat,filpat
+d881 1
+a881 1
+           !write(3,*)' Opened new Xmipp selfile file: ',filnam(1:nlet)
+d906 1
+a906 1
+           !write(3,*)' Opened new templated file: ',filnam(1:nlet)
+d944 3
+a946 2
+           !write(3,*)' In getnewimg - isbare,filpat: ',isbare, filpat
+           !write(3,*)' In getnewimg -nwant,maxim,istak: ',nwant,maxim,istack
+d988 1
+a988 1
+           !write(3,*)' Opened new stacked file: ',FILNAM(1:NLET)
+d1100 2
+a1101 2
+         !write(3,*)' In nextfiles, nwant1: ',nwant1
+         !write(3,'(a,8i5)')' In nextfiles, nwant1: ',
+d1106 1
+a1106 1
+         !write(3,*)' gotoldimg, nstacki1,gotast1: ',nstack1,gotast1
+d1117 1
+a1117 1
+      ! write(3,*) 'In nextfiles1: l1,l2,irtflg:',lun1,lun2,irtflg
+d1128 1
+a1128 1
+!        !write(3,'(a,8i5)')'  out: nindx2,ngot2,nstack2,imgnum2: ',
+d1130 1
+a1130 1
+!         write(3,*) 'nextfiles2: l2,imgnum2,gotast2:',
+d1142 1
+a1142 1
+            !write(3,*)'In nextfiles, :',isbare,nstack2,nwant2
+d1154 1
+a1154 1
+            !write(3,*)'In nextfiles, :',isbare,nstack2,nwant2
+d1164 1
+a1164 1
+                !write(3,*) 'nindx2 > nlist2',nindx2,nlist2
+d1172 2
+a1173 2
+         !write(3,*)' In nextfiles, nwant2,nindx2:',nwant2,nindx2
+         !write(3,'(a,8i5)') 
+d1180 1
+a1180 1
+         !write(3,'(a,8i5)') ' Getnew,nwant2,imgnum2,nstack2,irtflg:',
+d1186 1
+a1186 1
+      !write(3,'(a,5i5)')' In nextfiles, nlist1,nstack1,imgnum1:',
+d1188 1
+a1188 1
+      !write(3,'(a,5i5)')' In nextfiles, ngot2,nstack2,imgnum2:',
+d1295 4
+a1298 4
+C     write(3,*)' In nextfile, gotast, filpat1:  ', gotast,filpat1
+C     write(3,*)' In nextfile, nindx1,isbare:    ',nindx1,is_bare1
+C     write(3,*)' In nextfile, ----------------------: '
+C     write(3,'(A,5i6)')
+d1312 1
+a1312 1
+C        write(3,'(A,5i6)')'  In nextfile, nwant1,nstack1: ',
+d1337 1
+a1337 1
+      !write(3,*)' In nextfile, nindx1,nlist1,nstack1,imgnum1: ',
+d1339 1
+a1339 1
+      !write(3,*)'  In nextfile, calling get, nwant1,imgnum1,nstack1:',
+d1346 1
+a1346 1
+         !write(3,*) ' Call gotoldimg, nwant1: ',nwant1,imgnum1
+d1350 1
+a1350 1
+         !write(3,*)' Gotoldimg, nlist1,nwant1,imgnum1: ',
+d1359 1
+a1359 1
+         !write(3,*) ' Call gotnewimg, nwant1: ',nwant1,imgnum1
+d1363 1
+a1363 1
+         !write(3,*) ' Getnewimg, nwant1,imgnum1,nstack1,irtflg:',
+d1374 1
+a1374 1
+      !   write(3,'(a,5i5)')' In nextfile, nlist1,nstack1,imgnum1:',
+@
+
+
+1.37
+log
+@nextfile(s)  bare and series numbering 
+cosmetic
+@
+text
+@d4 2
+a5 2
+C  OPFILES.F   NEW                              12/15/06  ArDean Leith    
+C              BAD NUMBRT() TRAP                05/21/09  ArDean Leith  
+d19 1
+a19 1
+C=* Copyright 1985-2020  Health Research Inc.,                         *
+d35 1
+a35 1
+C ********************************************************************** 
+d37 1
+a37 1
+C  CONTAINS:  OPFILES, GETOLDIMG, GETNEWIMG, NEXTFILE, NEXTFILES 
+d165 3
+d181 1
+a181 1
+       INTEGER                   :: IMGWANT,IMGNUMIN,LENE,I
+a199 1
+       !write(3,*)' In opfiles, imgnum: ',imgnum
+d233 5
+a238 4
+       !write(3,*)' locast,locat:',locast,locat,filpat(1:nlet)
+       !write(6,*)' ilist:',ilist(1)
+       !write(6,*)' locast,locat,nstack:',locast,locat,maxim
+       !write(3,*)' in opfiles, nimaxt:',nimaxt
+d244 1
+a244 2
+       !write(3,*)' in opfiles, asklist: ',asklist
+       !write(3,*)' In opfiles, imgnum: ',imgnum
+d247 2
+d271 5
+a291 1
+       !write(3,*)' In opfiles, imgwant cc: ',imgwant
+d306 3
+a351 1
+
+d364 1
+a364 1
+             !write(6,*) ' In opfiles - imgwant,imgnum3: ',imgwant,imgnum
+d469 1
+a469 2
+          !write(6,*)' Opened templated file: ',filpat(1:nlet),
+          !&              '  for:',ntot,' images.'
+d501 5
+a505 1
+          !write(3,*)' In opfiles, simple file: ',filpat(1:nlet),itype,nx 
+d511 7
+d525 2
+d528 8
+a535 1
+       ENDIF
+d537 1
+a537 1
+9000   RETURN
+d539 1
+a539 1
+       END 
+d619 2
+a620 2
+        !write(6,*)' locast,locat:',locast,locat,nlet,filpat(1:nlet)
+        !write(6,*)' getoldimg, nwant,: ',nwant,':',filpat(1:nlet)
+d646 1
+a646 1
+           !write(6,*)' Opened old xmipp selfile file: ',filnam(1:nlet)
+d673 1
+a673 1
+           !write(6,*)' Opened old templated file: ',filnam(1:nlet),maxim
+d684 1
+a684 1
+          !write(3,*) ' In getoldimg, nwant: ',nwant,locat,locast,filpat
+d696 1
+a696 1
+              !write(6,*) ' lunredhed,lun,NX,irtflg:',lun,NX,irtflg
+d707 1
+d720 1
+a720 1
+           !write(6,*)' Opened old templated stacked file: ',FILNAM(:NLET)
+d758 2
+a759 2
+           !write(6,*)' Opened old bare stacked file: ',FILNAM(1:NLET)
+           !write(6,*)' ngot,NX:',ngot,NX,lun,imused,irtflg
+d866 1
+a866 1
+           !write(6,*)' Opened new Xmipp selfile file: ',filnam(1:nlet)
+d891 1
+a891 1
+           !write(6,*)' Opened new templated file: ',filnam(1:nlet)
+d929 2
+a930 2
+           !write(6,*)' In getnewimg - isbare,filpat: ',isbare, filpat
+           !write(6,*)' In getnewimg -nwant,maxim,istak: ',nwant,maxim,istack
+d972 1
+a972 1
+           !write(6,*)' Opened new stacked file: ',FILNAM(1:NLET)
+d1085 1
+a1085 1
+         !write(6,'(a,8i5)')' In nextfiles, nwant1: ',
+d1101 1
+a1101 1
+      ! write(6,*) 'In nextfiles1: l1,l2,irtflg:',lun1,lun2,irtflg
+d1112 1
+a1112 1
+!        !write(6,'(a,8i5)')'  out: nindx2,ngot2,nstack2,imgnum2: ',
+d1114 1
+a1114 1
+!         write(6,*) 'nextfiles2: l2,imgnum2,gotast2:',
+d1148 1
+a1148 1
+                !write(6,*) 'nindx2 > nlist2',nindx2,nlist2
+d1157 1
+a1157 1
+         !write(6,'(a,8i5)') 
+d1279 4
+a1282 4
+C      write(3,*)' In nextfile, gotast, filpat1:  ', gotast,filpat1
+C      write(6,*)' In nextfile, nindx1,isbare:    ',nindx1,is_bare1
+C      write(3,*)' In nextfile, ----------------------: '
+C      write(3,'(A,5i6)')
+d1362 86
 @
 
 
diff --git src/RCS/opfiles_mrc.f,v src/RCS/opfiles_mrc.f,v
index c43d8414..31b2b173 100644
--- src/RCS/opfiles_mrc.f,v
+++ src/RCS/opfiles_mrc.f,v
@@ -1,10 +1,35 @@
-head	1.7;
+head	1.12;
 access;
 symbols;
 locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.33.56;	author dean;	state Exp;
+branches;
+next	1.11;
+
+1.11
+date	2025.10.25.15.29.18;	author dean;	state Exp;
+branches;
+next	1.10;
+
+1.10
+date	2025.10.16.19.42.57;	author dean;	state Exp;
+branches;
+next	1.9;
+
+1.9
+date	2025.09.26.17.21.26;	author dean;	state Exp;
+branches;
+next	1.8;
+
+1.8
+date	2025.09.26.14.24.25;	author dean;	state Exp;
+branches;
+next	1.7;
+
 1.7
 date	2020.02.06.15.16.57;	author leith;	state Exp;
 branches;
@@ -45,9 +70,9 @@ desc
 @@
 
 
-1.7
+1.12
 log
-@COMMENTS
+@*** empty log message ***
 @
 text
 @ 
@@ -55,14 +80,15 @@ C++*********************************************************************
 C                                                                      
 C  OPFILES_MRC.F    CREATED FROM OPFILES         7/30/19  ArDean Leith
 C                   COMMENTS                     2/06/20  ArDean Leith
+C                   DEBUG OUTPUT ADDED           9/26/25  ArDean Leith
 C
-C ********************************************************************** 
+C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2020  Health Research Inc.,                         *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=*                                                                    *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -76,13 +102,13 @@ C=* General Public License for more details.                           *
 C=* You should have received a copy of the GNU General Public License  *
 C=* along with this program. If not, see <http://www.gnu.org/licenses> *
 C=*                                                                    *
-C ********************************************************************** 
+C **********************************************************************
 C 
 C  CONTAINS: OPFILES_MRC, GETOLDIMG_MRC, GETNEWIMG_MRC 
 C
 C  OPFILES_MRC(LUNCP,LUNIMG,LUNDOC,LUNXM,  
 C              ASKNAM,FILPAT,NLET, DISP,
-C              ITYPE,NX,NY,NZ,MAXIM,FOUROK,
+C              ITYPE,NX,NY,NZ,MAXIM,
 C              IMGNUM, IRTFLG)
 C 
 C  PURPOSE: SOLICITS FILE NAME(S) AND OPENS FILE(S)
@@ -90,14 +116,14 @@ C           SUPPORT ROUTINE FOR CONVERTING OPERATIONS TO
 C           WORK ON WHOLE STACK OR WITH SELECTION DOC FILE.
 C
 C  PARAMETERS:
-C        LUNCP      UNIT TO COPY HEADER VALUES FROM               (SENT)
-C        LUNIMG     UNIT TO OPEN FILE ON                          (SENT)
-C        LUNDOC     UNIT TO OPEN LIST DOC FILES ON                (SENT)
-C        LUNXM      UNIT TO OPEN XMIPP SELFILE ON                 (SENT)
-C        ASKNAM     FLAG TO ASK FOR FILE NAME                     (SENT)
+C        LUNCP      UNIT TO COPY HEADER VALUES FROM              (SENT)
+C        LUNIMG     UNIT TO OPEN FILE ON                         (SENT)
+C        LUNDOC     UNIT TO OPEN LIST DOC FILES ON               (SENT)
+C        LUNXM      UNIT TO OPEN XMIPP SELFILE ON                (SENT)
+C        ASKNAM     FLAG TO ASK FOR FILE NAME                    (SENT)
 C        FILPAT     FILE NAME PATTERN                             (RET)
 C        NLET       CHARS IN FILE NAME PATTERN                    (RET)
-C        DISP       CHARACTER CONTAINING ONE OF THE               (SENT) 
+C        DISP       CHARACTER CONTAINING ONE OF THE              (SENT) C
 C                   FOLLOWING DISPOSITION SPECIFICATIONS:
 C                   'O'   -  FILE IS ASSUMED TO EXIST.  DIMENSIONS,
 C                            ITYPE AND HEADER INFO (IN COMMON) ARE 
@@ -111,28 +137,24 @@ C                   'N'  -   WANT NEW FILE. SEND NX, NY, NZ & ITYPE.
 C                   'U'  -   IT IS NOT KNOWN IF THE FILE EXISTS.  
 C                            SEND NX, NY, NZ & ITYPE. IF FILE 
 C                            ALREADY EXISTS, IT WILL BE REPLACED.
-C        ITYPE      IFORM FOR FILE                         (SENT OR RET) 
-C        NX,NY,NZ   IMAGE SIZE                             (SENT OR RET)
+C        ITYPE      IFORM FOR FILE                        (SENT OR RET) C
+C        NX,NY,NZ   IMAGE SIZE                            (SENT OR RET)
 C
 C        MAXIM      STACK INDICATOR                          (SENT/RET)
 C                   ON INPUT: STACK INDICATOR IF DISP == 'I'     (SENT)
 C                   ON OUTPUT:                                    (RET)
 C                       -2 NON-STACK IMAGE                
-C                       -1 STACKED IMAGE                  
-C                     >= 0 IS CURRENT MAX. IMAGE NO. FOR STACK             
-C        PROMPT     PROMPT FOR FILNAME                            (SENT)
-C                     IF NOT (ASKNAM) THIS IS FILE NAME           (SENT)
-C                     ~ (TILDE) IN LAST CHAR. SAYS SKIP
-C                       "FILE" AT END OF PROMPT
-C                     ~9 IN NEXT TO LAST OR
-C                        NEXT-TO-NEXT-TO LAST
-C                        ACCEPTS AN EXTENSION
-C                        (OTHERWISE DISCARDED!)
-C                     ~6 KEEPS OLD DATE/TIME
-C        IMGNUM     IMAGE NUMBER                              (SENT/RET)
-C                     ON INPUT:   IMAGE NUMBER THAT IS WANTED
-C                     ON OUTPUT:  >=0 IMAGE NUMBER CURRENTLY OPEN 
-C                                 <0 IS SELFILE IN USE 
+C                       -1 STACKED IMAGE WITH * 
+c                        0 BARE STACK                  
+C                     >= 0 IS CURRENT MAX. IMAGE NO. FOR STACK           C                     IF NOT STACK IS NUMBER IN LIST
+C 
+C        ILIST      IMAGE NUMBER LIST                             (RET)
+CC
+C        IMGNUM     IMAGE NUMBER                             (SENT/RET)
+C                   ON INPUT:   IMAGE NUMBER THAT IS WANTED
+C                   ON OUTPUT:  >=0 IMAGE NUMBER CURRENTLY OPEN 
+C                                <0 IS SELFILE IN USE 
+C
 C        IRTFLG     ERROR FLAG (0 IS NORMAL)                      (RET)
 C                      -1 GO TO PREVIOUS QUESTION
 C 
@@ -147,30 +169,31 @@ C           v     If: MRC file: *.MRC or *.MRCS
 C           v 
 C        OPFILES_MRC
 C           |
-C           |   Templated stack: **@@STK.MRC
+C           |   Templated stack: *@@stk.MRC
 C           ` ---> FILGET_AT --> OPFILEC --> OPENFIL_MRC --> OPENFIL_O_MRC 
 C           |                            --> OPENFIL_MRC --> OPENFIL_N_MRC
 C           |
-C           |   Whole barestack:  @@STK.MRC 
+C           |   Whole barestack:  @@stk.MRC 
 C           ` ---> FILGET_AT --> OPFILEC --> OPENFIL_MRC --> OPENFIL_O_MRC
 C           |                            --> OPENFIL_MRC --> OPENFIL_N_MRC
 C           | 
-C           |   File template:   IMG***.MRC
+C           |   File template:   img***.MRC
 C           ` ---> FILGET_AT --> OPFILEC --> OPENFIL_MRC --> OPENFIL_O_MRC
 C           |                            --> OPENFIL_MRC --> OPENFIL_N_MRC
 C           | 
-C           |   Simple file:     IMG001.MRC
+C           |   Simple file:     img001.MRC
 C           ` -----------------> OPFILEC --> OPENFIL_MRC --> OPENFIL_O_MRC  
 C                                        --> OPENFIL_MRC --> OPENFIL_N_MRC
 C
-C23456789 123456789 123456789 123456789 123456789 123456789 123456789 12 
+C23456789 123456789 123456789 123456789 123456789 123456789 123456789 12
 C--********************************************************************* 
-
        SUBROUTINE OPFILES_MRC(LUNCP,LUNIMG,LUNDOC,
      &                        FILPAT,NLET, DISP,
      &                        ITYPE,NX,NY,NZ,MAXIM,
      &                        IMGNUM, IRTFLG) 
  
+C      OPFILES NEEDS: MAXIM, IMGNUM
+
        IMPLICIT NONE
 
        INCLUDE 'CMBLOCK.INC' 
@@ -189,8 +212,8 @@ C--*********************************************************************
        CHARACTER (LEN=2*MAXNAM)  :: MESG 
        CHARACTER (LEN=1)         :: NULL = CHAR(0)
 
-       INTEGER                   :: LOCAT,LOCAST,LENE
-       INTEGER                   :: LUNOP,NLETT,I
+       INTEGER                   :: LOCAT,LOCAST,LENE,MZT,NSTACKT
+       INTEGER                   :: LUNOP,NLETT,I,ilent
 
        LOGICAL                   :: ISOPEN,IS_BAREL
        CHARACTER (LEN=MAXNAM)    :: FILNAMT 
@@ -203,13 +226,21 @@ C--*********************************************************************
        LOCAST   = INDEX(FILPAT(1:NLET),'*')
        IS_BAREL = (LOCAT > 1 .AND. FILPAT(LOCAT-1:LOCAT-1) == '/')
        
-       !write(3,*)' In opfiles_mrc,locast,locat,:',locast,locat,is_barel
-       !write(3,*)' In opfiles_mrc, imgnum:',imgnum,filpat
+#if defined (SP_DBUGIO)
+       ilent = lnblnkn(filpat)
+       write(3,*)' '
+       write(3,*)' In opfiles_mrc, nlet:        ', nlet
+       write(3,*)' In opfiles_mrc, filpat:      ', filpat(1:ilent)
+       write(3,*)' In opfiles_mrc; imgnum:      ', imgnum
+       write(3,*)' In opfiles_mrc; locat,locast:', locat,locast
+       write(3,*)' In opfiles_mrc; is_barel:    ', is_barel
+       if (disp == 'n' .or. disp == 'u') then
+          write(3,*)' In opfiles_mrc; nx,ny,nz:    ', nx,ny,nz
+       endif
+#endif
 
        IF (LOCAST > 0 .AND. LOCAST < LOCAT) THEN
-C         TEMPLATED STACKED MRC FILE: ***@@STK.MRC --------- **@@STK.MRC
-
-          !write(3,*)' In opfiles_mrc, opening: ',filpat(1:nlet)
+C         TEMPLATED STACKED MRC FILE: *@@file.MRC ---------  *@@file.MRC
         
 C         SUBSTITUTE STACKED IMGNUM INTO FILE NAME PATTERN -> FILNAM 
           CALL FILGET_AT(FILPAT,IMGNUM,FILNAM,NLET,IRTFLG)
@@ -219,41 +250,74 @@ C         OPEN IMGNUM IN EXISTING MRC STACK FILE
           SAYIT  = .TRUE.
           MAXIM  = 0          ! OPEN SPECIFIC IMAGE  
 
-          !write(3,*)' In opfiles_mrc, opening: ',filnam(1:nlet)
+#if defined (SP_DBUGIO)
+          ilent = lnblnkn(filnam)
+          write(3,*)' In opfiles_mrc; Calling opfilec: ',filnam(1:ilent)
+          write(3,*)' In opfiles_mrc;  TEMPLATED STACKED MRC '
+#endif
 
-	  CALL OPFILEC(0,.FALSE.,FILNAM,LUNIMG,DISP,
-     &                 ITYPE,NX,NY,NZ, 
-     & 		       MAXIM,' ',FOUROK,IRTFLG) 
+          CALL OPFILEC(0,.FALSE.,FILNAM,LUNIMG,DISP,
+     &                 ITYPE,NX,NY,NZ, MAXIM,
+     &                 ' ',FOUROK,IRTFLG) 
           IF (IRTFLG .NE. 0) RETURN
-
+        
 C         THIS IS NOT A BARE STACK REQUEST
           CALL LUNSETISBARE_MRC(LUNIMG,.FALSE.,IRTFLG)
 
-          !write(3,*)' In opfiles_mrc, maxim: ',maxim,imgnum
+#if defined (SP_DBUGIO)
+          write(3,*)' In opfiles_mrc; maxim:  ', maxim
+          write(3,*)' In opfiles_mrc;  7777777; imgnum: ', imgnum
+#endif
           RETURN
 
+
+
        ELSEIF (LOCAST > 0) THEN
-C         A SIMPLE FILE TEMPLATE: IMG***.mrc ------------- IMG***.mrc
+C         A SIMPLE TEMPLATED FILE: IMG***.mrc ------------- img***.mrc
 
 C         SUBSTITUTE IMGNUM INTO FILE NAME PATTERN -> FILNAM   
-          CALL  FILGET(FILPAT,FILNAM,NLET,IMGNUM,IRTFLG)
-	  IF (IRTFLG .NE. 0) RETURN 
+          CALL FILGET(FILPAT,FILNAM,NLET,IMGNUM,IRTFLG)
+
+#if defined (SP_DBUGIO)
+          write(3,*)' In opfiles_mrc; maxim:  ', maxim
+          write(3,*)' In opfiles_mrc; imgnum: ', imgnum
+          write(3,*)' In opfiles_mrc; 8888888  irtflg: ', irtflg
+          write(3,*)'   '
+#endif
+          IF (IRTFLG .NE. 0) RETURN 
 
 C         OPEN THE FILE
-          MAXIM = 0 
-	  CALL OPFILEC(LUNCP,.FALSE.,FILNAM,LUNIMG,DISP,
+          MAXIM = -1 
+          CALL OPFILEC(LUNCP,.FALSE.,FILNAM,LUNIMG,DISP,
      &                 ITYPE,NX,NY,NZ, 
-     & 		       MAXIM,' ',FOUROK,IRTFLG) 
-	  IF (IRTFLG .NE. 0) RETURN 
+     &                 MAXIM,' ',FOUROK,IRTFLG) 
+
+#if defined (SP_DBUGIO)
+          write(3,*)' In opfiles_mrc; 9999999  irtflg,maxim: ', 
+     &                                         irtflg,maxim
+#endif
+          IF (IRTFLG .NE. 0) RETURN 
+          
+          CALL LUNSETNSTACK_MRC(LUNIMG, NZ, MAXIM,IRTFLG)
 
 C         THIS IS NOT A BARE STACK REQUEST
           CALL LUNSETISBARE_MRC(LUNIMG,.FALSE.,IRTFLG)
 
-c          write(3,*)' Opened templated file: ',filnam(1:20),
-c     &              '  for:',imgnum
+C         THIS IS NOT A STACK
+          CALL LUNSETSTK_MRC(LUNIMG,0,-2,IRTFLG)
+
+#if defined (SP_DBUGIO)
+          write(3,*)' In opfiles_mrc; 1010101 ;irtflg,maxim:  ',
+     &                                         irtflg,maxim
+          ilent = lnblnkn(filnam)
+          write(3,*)' In opfiles_mrc; Opened templated file; imgnum: ',
+     &                                    imgnum,'  ', filnam(1:ilent)
+          write(3,*) '  '
+#endif
+
 
        ELSEIF (LOCAT == 1 .OR. IS_BAREL) THEN
-C         WHOLE BARESTACK:  @@STK.mrc  ---------------------- @@STK.mrc
+C         WHOLE BARESTACK:  @@file.mrc  ---------------------- @@file.mrc
 
 C         SUBSTITUTE STACKED IMGNUM INTO FILE NAME PATTERN -> FILNAM   
           
@@ -266,7 +330,11 @@ C         SUBSTITUTE STACKED IMGNUM INTO FILE NAME PATTERN -> FILNAM
 C         OPEN FIRST FILE IN MRC STACK
           IMGNUM = 1
           MAXIM  = 1
-         !write(3,*)' In opfiles_mrc, filnamnoat: ',filnamnoat(1:nlet)
+
+#if defined (NEVERSP_DBUGIO)
+          ilent = lnblnkn(filnamnoat)
+          write(3,*)' In opfiles_mrc; filnamnoat: ',filnamnoat(1:ilent)
+#endif
 
           INQUIRE(FILE=FILNAMNOAT,OPENED=ISOPEN,NUMBER=LUNOP)
           MESG = '  FILE: ' // FILNAMNOAT(1:NLET)//'  ALREADY OPENED ON' 
@@ -279,40 +347,100 @@ C         OPEN FIRST FILE IN MRC STACK
 
 C         SUBSTITUTE STACKED IMGNUM INTO FILE NAME PATTERN -> FILNAM   
           CALL FILGET_AT(FILPAT,IMGNUM,FILNAM,NLET,IRTFLG)
-          !write(3,*)' In opfiles_mrc, filpat: ',filpat(1:nlet)
-          !write(3,*)' In opfiles_mrc, filnam: ',filnam(1:nlet)
+
+
+#if defined (NEVERSP_DBUGIO)
+          ilent = lnblnkn(filpat)
+          write(3,*)' In opfiles_mrc; filpat: ',filpat(1:ilent)
+          ilent = lnblnkn(filnam)
+          write(3,*)' In opfiles_mrc; filnam: ',filnam(1:ilent)
+#endif
         
 C         OPEN FIRST FILE
           CALL OPFILEC(LUNCP,.FALSE.,FILNAM,LUNIMG,DISP,
      &                 ITYPE,NX,NY,NZ, 
-     & 		       MAXIM,'UNUSED',FOUROK,IRTFLG) 
-	  IF (IRTFLG .NE. 0) RETURN
+     &                       MAXIM,'UNUSED',FOUROK,IRTFLG) 
+          IF (IRTFLG .NE. 0) RETURN
 
 C         THIS WAS A BARE STACK REQUEST
           CALL LUNSETISBARE_MRC(LUNIMG,.TRUE.,IRTFLG)
 
-          !write(3,*)' In opfiles_mrc, opened: ',filnam(1:nlet)
-          !write(3,*)' In opfiles_mrc, imgnum: ',imgnum
+#if defined (SP_DBUGIO)
+          ilent = lnblnkn(filnam)
+          write(3,*)' In opfiles_mrc; Opened: ',filnam(1:ilent)
+          write(3,*)' In opfiles_mrc; imgnum: ',imgnum 
+#endif
+
 
        ELSE
-C         SINGLE SIMPLE INPUT FILE: ------------------------ IMG001.mrc
-C         STACKED IMAGE FILE:  ------------------------------ 2@@STK.mrc
-                
-          MAXIM = 0        ! SPECIFIC IMAGE WANTED  
-	  CALL OPFILEC(LUNCP,.FALSE.,FILPAT,LUNIMG,DISP,
-     &                 ITYPE,NX,NY,NZ, 
-     & 		       MAXIM,'UNUSED',FOUROK,IRTFLG) 
+C         SINGLE SIMPLE INPUT FILE: ------------------------ img001.mrc
+C         STACKED IMAGE FILE:  ----------------------------- 2@@file.mrc
+C         STACKED IMAGE FILE:  ----------------------------- file@@2.mrc
+C         STACKED IMAGE FILE:  ------------------------------ aaa@@2.mrc
+                  
+          MAXIM = 0        ! SPECIFIC IMAGE WANTED 
+  
+#if defined (SP_DBUGIO)
+          write(3,*)' In opfiles_mrc; Open stacked or simple image: ',
+     &                                filpat(1:nlet)
+          write(3,*)' In opfiles_mrc; imgnum,maxim: ',imgnum,maxim
+          write(3,*)' In opfiles_mrc; nx,ny,nz:     ', nx,ny,nz
+          write(3,*)' In opfiles_mrc; Calling opfilec for: simp/stk '
+          write(3,*)'  '
+#endif
+
+          CALL OPFILEC(LUNCP,.FALSE.,FILPAT,LUNIMG,DISP,
+     &                ITYPE,NX,NY,NZ, 
+     &                MAXIM,'UNUSED~7~9',FOUROK,IRTFLG) 
+
+#if defined (SP_DBUGIO)
+          ilent = lnblnkn(filpat)
+          write(3,*)'  '
+          write(3,*)' After opfilec ------------- in opfiles_mrc ---'
+          write(3,*)' In opfiles_mrc; nlet,maxim,irtflg: ',
+     &                                nlet,maxim,irtflg
+          write(3,*)' In opfiles_mrc; nx,ny,nz: ', nx,ny,nz
+#endif
 
 C         RETURN FILENAME WITH ANY EXTENSION IF NOT SPIDER IMAGE
           IF (IRTFLG == 5) NLET = lnblnkn(FILPAT)
-	  IF (IRTFLG .NE. 0) RETURN 
 
-          ! write(3,*)' In opfiles_mrc, imami : ',imami
-          ! write(3,*)' In opfiles_mrc, openrf simple file: ',filpat
+          IF (IRTFLG .NE. 0) THEN
+
+#if defined (SP_DBUG)
+            write(3,*)' In opfiles_mrc; non-zero, imgnum,irtflg : ',
+     &                                            imgnum,irtflg
+            ilent = lnblnkn(filpat)
+            write(3,*)' In opfiles_mrc; Opened simple file: ',  
+     &                                          filpat(1:ilent)
+            write(3,*)' In opfiles_mrc; *** Returning irtflg: ',irtflg
+#endif
+            RETURN
+          ENDIF
 
-          IMGNUM = 1
+#if defined (SP_DBUGIO)
+          write(3,*)' In opfiles_mrc   www; imgnum,locat: ',imgnum,locat
+#endif
 
-       ENDIF
+          IF (LOCAT <= 0 ) THEN
+C            THIS IS NOT A STACK
+             CALL LUNSETSTK_MRC(LUNIMG,IMGNUM,-2,IRTFLG)
+          ENDIF
+    
+#if defined (SP_DBUGIO)
+          write(3,*)' In opfiles_mrc  vvv ; imgnum,irtflg: ',
+     &                                      imgnum,irtflg
+          ilent = lnblnkn(filpat)
+          write(3,*)' In opfiles_mrc; Opened simple: ',filpat(:ilent)
+#endif
+
+       ENDIF    ! 
+
+
+#if defined (SP_DBUGIO)
+       write(3,*)' In opfiles_mrc; ### Returning maxim: ',maxim
+       write(3,*)
+#endif
 
        END 
  
@@ -338,7 +466,7 @@ C                   IRTFLG =  2    IMAGE NOT IN USE
 C
 C **********************************************************************
 
-	SUBROUTINE GETNEWIMG_MRC(LUN,FILPAT,NWANT,SAYIT,
+        SUBROUTINE GETNEWIMG_MRC(LUN,FILPAT,NWANT,SAYIT,
      &                           FILNAM,NGOT,IRTFLG)
 
         IMPLICIT NONE
@@ -369,14 +497,14 @@ C **********************************************************************
         LOCAST = INDEX(FILPAT(1:NLET),'*')
         LOCAT  = INDEX(FILPAT(1:NLET),'@@')
 
-        !write(3,*)' !!!locast,locat,filpat:',locast,locat,filpat(1:nlet)
+        !write(6,*)'locast,locat,filpat:',locast,locat,filpat(1:nlet)
 
         IMGNUM = NWANT
 
         IF (LOCAST > 1 .or. (LOCAT  > 0 .AND. LOCAST < LOCAT)) THEN
 C          SUBSTITUTE IMGNUM INTO FILE NAME PATTERN -> FILNAM   
            CALL FILGET_AT(FILPAT,IMGNUM,FILNAM,NLET,IRTFLG)
-	   IF (IRTFLG .NE. 0) RETURN 
+          IF (IRTFLG .NE. 0) RETURN 
         ENDIF
 
         IF (LOCAT <= 0 .AND. LOCAST > 1) THEN
@@ -386,20 +514,20 @@ C          NEW IMAGE, NEEDS TO KNOW: ITYPE,NX,NY,NZ!
 C          GET IT FROM OPFILES OR PREVIOUS CALL
 
            CALL LUNGETSIZE_MRC(LUN,NX,NY,NZ,IRTFLG)
-	   IF (IRTFLG .NE. 0) RETURN 
+           IF (IRTFLG .NE. 0) RETURN 
            CALL LUNGETTYPE_MRC(LUN,ITYPE,IRTFLG)
-	   IF (IRTFLG .NE. 0) RETURN 
+           IF (IRTFLG .NE. 0) RETURN 
 
            CLOSE(LUN)    ! MAY BE STILL OPEN FROM FIRST CALL  
 
 C          OPEN NEW FILE
            MAXIM = 0
-	   CALL OPFILEC(LUNCP,.FALSE.,FILNAM,LUN,'U',ITYPE,
+           CALL OPFILEC(LUNCP,.FALSE.,FILNAM,LUN,'U',ITYPE,
      &                  NX,NY,NZ, 
-     & 		        MAXIM,'UNUSED',FOUROK,IRTFLG) 
-	   IF (IRTFLG .NE. 0) RETURN 
+     &                        MAXIM,'UNUSED',FOUROK,IRTFLG) 
+           IF (IRTFLG .NE. 0) RETURN 
 
-           !write(3,*)' In getnewimg_mrc opened new templated file: ',
+           !write(6,*)' In getnewimg_mrc opened new templated file: ',
            !&                 filnam(1:nlet)
 
            NGOT   = NWANT   
@@ -438,7 +566,7 @@ C             SET CURRENT IMGNUM AND NSTACK IN STATIC HEADER
 C          SET OFFSETS FOR REDLIN/WRTLIN FOR IMAGE OPENED ON THIS LUN
            CALL LUNSETPOS_MRC(LUN,IMGNUM,IRTFLG)
            IF (IRTFLG .NE. 0) RETURN
-           !write(3,'(a,8i5)') ' In getnu_mrc22, lun,imgnum:',lun,imgnum
+           !write(6,'(a,8i5)') ' In getnu_mrc22, lun,imgnum:',lun,imgnum
 
 
 C          PUSH HEADER OBJECT INTO FILE TO SAVE STATS, NSTACK, & IMGNUM
@@ -458,12 +586,12 @@ C          WRITE OUT FILE OPENING INFO TO SCREEN
 
            NGOT = IMGNUM
 
-           !write(3,*)' In getnewimg_mrc opened new stacked file: ',
+           !write(6,*)' In getnewimg_mrc opened new stacked file: ',
        !&                 filnam(1:nlet)
 
         ENDIF
 
-	END
+        END
 
 
 C++*********************************************************************
@@ -491,7 +619,7 @@ C
 C23456789 123456789 123456789 123456789 123456789 123456789 123456789 12
 C--*********************************************************************
  
-	SUBROUTINE GETOLDIMG_MRC(LUN,FILPAT,NWANT,SAYIT,
+        SUBROUTINE GETOLDIMG_MRC(LUN,FILPAT,NWANT,SAYIT,
      &                           FILNAM,NGOT,IRTFLG)
 
         IMPLICIT NONE
@@ -521,14 +649,14 @@ C--*********************************************************************
         LOCAST = INDEX(FILPAT(1:NLET),'*')
         LOCAT  = INDEX(FILPAT(1:NLET),'@@')
 
-        ! write(3,*)' In getoldimg_mrc locast,locat,nlet,filpat:',
+        ! write(6,*)' In getoldimg_mrc locast,locat,nlet,filpat:',
         !&            locast,locat,nlet,filpat(1:nlet)
-        !write(3,*)' In getoldimg_mrc, nwant,: ',nwant,':',filpat(1:nlet)
+        !write(6,*)' In getoldimg_mrc, nwant,: ',nwant,':',filpat(1:nlet)
 
         IF (LOCAST > 0 .OR. (LOCAST == 0 .AND. LOCAT > 0)) THEN 
 C          SUBSTITUTE STACKED IMGNUM INTO FILE NAME PATTERN -> FILNAM   
            CALL FILGET_AT(FILPAT,NWANT,FILNAM,NLET,IRTFLG)
-	   IF (IRTFLG .NE. 0) RETURN 
+          IF (IRTFLG .NE. 0) RETURN 
         ENDIF
 
         IF (LOCAST > 0 .AND. LOCAT == 0) THEN 
@@ -541,10 +669,10 @@ C          LUNSETFILE, LUNSETPOS_MRC LUNSET_STATSIMG_MRC,
 C          LUNSETISBARE_MRC, LUNSETCOMMON_MRC, LUNSAYINFO_MRC
 
            MAXIM = 0  
-	   CALL OPFILEC(0,.FALSE.,FILNAM,LUN,NULL,ITYPE,
+          CALL OPFILEC(0,.FALSE.,FILNAM,LUN,NULL,ITYPE,
      &                  NX,NY,NZ, 
-     & 		        MAXIM,' ',FOUROK,IRTFLG) 
-	   IF (IRTFLG .NE. 0) RETURN 
+     &                        MAXIM,' ',FOUROK,IRTFLG) 
+          IF (IRTFLG .NE. 0) RETURN 
 
            !write(6,*)' In getoldimg_mrc opened old templated file: ',
            !          filpat(1:nlet), maxim
@@ -563,7 +691,7 @@ C          FIND NUMBER OF IMAGES IN STACK
                 
 C          CHECK IF IMAGE CAN FIT IN STACK
            IF (NWANT > NSTACK) THEN
-             CALL ERRT(102,'GETOLDIMG_MRC, NO SUCH IMAGE',NWANT)
+             CALL ERRT(102,'GETOLDIMG_MRC,  NO SUCH IMAGE',NWANT)
              IRTFLG = 1
              RETURN
            ENDIF
@@ -579,20 +707,20 @@ C          SET FILENAME,  IN LUN - FILENAME
 C          SET AXIS ORIGIN LOCATION & VOLUME HANDEDNESS IF NEEDED
            CALL WHICH_HAND_MRC(LUN,FILNAM,CAXIS,IRTFLG)
 
-C          SET IMAGE OFFSET FOR READ/WRITE
+C          SET IMAGE  OFFSET FOR READ/WRITE
            CALL LUNSETPOS_MRC(LUN,NWANT,IRTFLG)
            IF (IRTFLG .NE. 0) RETURN
 
 C          PUT COMMON VALUES INTO COMMON AREA (NOT NEEDED IN FUTURE?)
            CALL LUNSETCOMMON_MRC(LUN,IRTFLG)
            IF (IRTFLG .NE. 0) RETURN
-           !write(3,*)' In getoldimg_mrc after lunsetcommon: ',filnam(1:nlet)
+           !write(6,*)' In getoldimg_mrc after lunsetcommon: ',filnam(1:nlet)
 
 C          WRITE OUT FILE OPENING INFO IF WANTED
            CALL LUNSAYINFO_MRC(LUN,SAYIT,IRTFLG)
            IF (IRTFLG .NE. 0) RETURN
 
-cc         write(3,*)' In getoldimg_mrc opened old templated stk file: ',
+cc         write(6,*)' In getoldimg_mrc opened old templated stk file: ',
 cc     &               filnam(1:nlet)
 
 C          RETURN IMAGE NUMBER THAT WAS WANTED
@@ -604,8 +732,455 @@ C          RETURN IMAGE NUMBER THAT WAS WANTED
         ENDIF
         IRTFLG = 1
 
+        END
+
+@
+
+
+1.11
+log
+@defined (SP_DBUG) changes
+comments
+@
+text
+@d35 1
+a35 1
+C              NTOT,IMGNUM, IRTFLG)
+d42 5
+a46 5
+C        LUNCP      UNIT TO COPY HEADER VALUES FROM               (SENT)
+C        LUNIMG     UNIT TO OPEN FILE ON                          (SENT)
+C        LUNDOC     UNIT TO OPEN LIST DOC FILES ON                (SENT)
+C        LUNXM      UNIT TO OPEN XMIPP SELFILE ON                 (SENT)
+C        ASKNAM     FLAG TO ASK FOR FILE NAME                     (SENT)
+d49 1
+a49 1
+C        DISP       CHARACTER CONTAINING ONE OF THE               (SENT) C
+d63 2
+a64 2
+C        ITYPE      IFORM FOR FILE                         (SENT OR RET) C
+C        NX,NY,NZ   IMAGE SIZE                             (SENT OR RET)
+d70 4
+a73 2
+C                       -1 STACKED IMAGE                  
+C                     >= 0 IS CURRENT MAX. IMAGE NO. FOR STACK           C 
+d75 5
+a79 7
+C                     IF NIMAXT < 0 MUST BE SENT
+C                     NOT USED IF SINGLE IMAGE/SELFILE 
+C        NIMAXT     MAX LENGTH OF IMAGE NUMBER LIST              (SENT)
+C                     <0 MEANS DO NOT ASK FOR LIST
+C
+C        NTOT:      # OF IMAGES IN IMAGE NUMBER LIST              (RET)
+C                     ZERO FOR SINGLE IMAGE AND NO * 
+a80 4
+C        IMGNUM     IMAGE NUMBER                              (SENT/RET)
+C                     ON INPUT:   IMAGE NUMBER THAT IS WANTED
+C                     ON OUTPUT:  >=0 IMAGE NUMBER CURRENTLY OPEN 
+C                                 <0 IS SELFILE IN USE 
+d95 1
+a95 1
+C           |   Templated stack: **@@STK.MRC
+d99 1
+a99 1
+C           |   Whole barestack:  @@STK.MRC 
+d103 1
+a103 1
+C           |   File template:   IMG***.MRC
+d107 1
+a107 1
+C           |   Simple file:     IMG001.MRC
+d118 2
+d138 2
+a139 2
+       INTEGER                   :: LOCAT,LOCAST,LENE
+       INTEGER                   :: LUNOP,NLETT,I
+d153 10
+a162 5
+       write(3,*)' In opfiles_mrc, nlet: ',          nlet
+       write(3,*)' In opfiles_mrc, filpat(:nlet): ', filpat(1:nlet)
+       write(3,*)' In opfiles_mrc; locat,locast:',   locat,locast
+       write(3,*)' In opfiles_mrc; is_barel:',       is_barel
+       write(3,*)' In opfiles_mrc; imgnum:',         imgnum
+d166 1
+a166 5
+C         TEMPLATED STACKED MRC FILE: ***@@STK.MRC --------- **@@STK.MRC
+
+#if defined (SP_DBUGIO)
+          write(3,*)' In opfiles_mrc, Opening ggg: ',filpat(1:nlet)
+#endif
+d177 3
+a179 1
+          write(3,*)' In opfiles_mrc, Calling opfilec: ',filnam(1:nlet)
+d183 2
+a184 2
+     &                 ITYPE,NX,NY,NZ, 
+     &                       MAXIM,' ',FOUROK,IRTFLG) 
+d186 1
+a186 1
+
+d191 2
+a192 1
+          write(3,*)' In opfiles_mrc; maxim,imgnum: ',maxim,imgnum
+d197 1
+d199 1
+a199 1
+C         A SIMPLE FILE TEMPLATE: IMG***.mrc ------------- IMG***.mrc
+d202 8
+a209 1
+          CALL  FILGET(FILPAT,FILNAM,NLET,IMGNUM,IRTFLG)
+d213 1
+a213 1
+          MAXIM = 0 
+d216 6
+a221 1
+     &                       MAXIM,' ',FOUROK,IRTFLG) 
+d223 2
+d229 3
+d233 6
+a238 2
+          write(6,*)' Opened templated file: ',filnam(1:20),
+     &              '  with:',imgnum
+d243 1
+a243 1
+C         WHOLE BARESTACK:  @@STK.mrc  ---------------------- @@STK.mrc
+d256 5
+a260 1
+         !write(6,*)' In opfiles_mrc; filnamnoat: ',filnamnoat(1:nlet)
+d273 8
+a280 2
+          !write(6,*)' In opfiles_mrc; filpat: ',filpat(1:nlet)
+          !write(6,*)' In opfiles_mrc; filnam: ',filnam(1:nlet)
+d286 1
+a286 1
+         IF (IRTFLG .NE. 0) RETURN
+d291 5
+a295 2
+          !write(6,*)' In opfiles_mrc; Opened: ',filnam(1:nlet)
+          !write(6,*)' In opfiles_mrc; imgnum: ',imgnum 
+d299 4
+a302 3
+C         SINGLE SIMPLE INPUT FILE: ------------------------ IMG001.mrc
+C         STACKED IMAGE FILE:  ------------------------------ 2@@STK.mrc
+C         STACKED IMAGE FILE:  --------------------------- aaaSTK@@2.mrc
+d305 1
+a305 1
+ 
+d307 1
+a307 1
+          write(3,*)' In opfiles_mrc; Opening stacked/simple image: ',
+d310 3
+a312 1
+          write(3,*)' In opfiles_mrc; Calling opfilec ---------- '
+d317 1
+a317 1
+     &                MAXIM,'UNUSED',FOUROK,IRTFLG) 
+d320 3
+a322 1
+          write(3,*)' After opfilec; filpat: ',filpat
+d325 1
+d332 1
+d336 3
+a338 1
+            write(3,*)' In opfiles_mrc; Opened simple file: ',filpat
+a339 1
+            write(3,*)
+d344 3
+a346 1
+          IMGNUM = 1
+d348 7
+a354 2
+#if defined (SP_DBUG)
+          write(3,*)' In opfiles_mrc; %%%, imgnum,irtflg : ',
+d356 2
+a357 1
+          write(3,*)' In opfiles_mrc; Opened simple file: ',filpat
+d360 2
+a361 1
+       ENDIF    ! -------------------------- 2@@STK.mrc  or cow.mrc
+d363 1
+a363 1
+#if defined (SP_DBUG)
+@
+
+
+1.10
+log
+@debug output altered
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+d34 2
+a35 2
+C              ITYPE,NX,NY,NZ,MAXIM,FOUROK,
+C              IMGNUM, IRTFLG)
+d49 1
+a49 1
+C        DISP       CHARACTER CONTAINING ONE OF THE               (SENT) 
+d63 1
+a63 1
+C        ITYPE      IFORM FOR FILE                         (SENT OR RET) 
+d71 10
+a80 10
+C                     >= 0 IS CURRENT MAX. IMAGE NO. FOR STACK             
+C        PROMPT     PROMPT FOR FILNAME                            (SENT)
+C                     IF NOT (ASKNAM) THIS IS FILE NAME           (SENT)
+C                     ~ (TILDE) IN LAST CHAR. SAYS SKIP
+C                       "FILE" AT END OF PROMPT
+C                     ~9 IN NEXT TO LAST OR
+C                        NEXT-TO-NEXT-TO LAST
+C                        ACCEPTS AN EXTENSION
+C                        (OTHERWISE DISCARDED!)
+C                     ~6 KEEPS OLD DATE/TIME
+d154 1
+a154 1
+#if defined (SP_DBUG)
+d165 2
+a166 2
+#if defined (SP_DBUG)
+          write(3,*)' In opfiles_mrc, Opening: ',filpat(1:nlet)
+d177 1
+a177 1
+#if defined (SP_DBUG)
+d189 1
+a189 1
+#if defined (SP_DBUG)
+d212 1
+a212 1
+#if defined (SP_DBUG)
+d214 1
+a214 1
+     &              '  for:',imgnum
+d263 2
+a264 1
+C         STACKED IMAGE FILE:  ----------------------------- 2@@STK.mrc
+a265 1
+
+d268 1
+a268 1
+#if defined (SP_DBUG)
+d272 1
+a272 1
+          write(3,*)' Calling opfilec ------------- '
+d279 1
+a279 1
+#if defined (SP_DBUG)
+d386 1
+a386 1
+          IF (IRTFLG .NE. 0) RETURN 
+d388 1
+a388 1
+          IF (IRTFLG .NE. 0) RETURN 
+d394 1
+a394 1
+          CALL OPFILEC(LUNCP,.FALSE.,FILNAM,LUN,'U',ITYPE,
+d397 1
+a397 1
+          IF (IRTFLG .NE. 0) RETURN 
+@
+
+
+1.9
+log
+@removed debug msg
+@
+text
+@d154 7
+a160 2
+       !write(6,*)' In opfiles_mrc,locast,locat,:',locast,locat,is_barel
+       !write(6,*)' In opfiles_mrc, imgnum:',imgnum,filpat
+d165 3
+a167 1
+          !write(6,*)' In opfiles_mrc, opening: ',filpat(1:nlet)
+d177 3
+a179 1
+          !write(6,*)' In opfiles_mrc, opening: ',filnam(1:nlet)
+d181 1
+a181 1
+	  CALL OPFILEC(0,.FALSE.,FILNAM,LUNIMG,DISP,
+d183 1
+a183 1
+     & 		       MAXIM,' ',FOUROK,IRTFLG) 
+d189 3
+a191 1
+          !write(6,*)' In opfiles_mrc; maxim: ',maxim,imgnum
+d194 1
+d200 1
+a200 1
+	  IF (IRTFLG .NE. 0) RETURN 
+d204 1
+a204 1
+	  CALL OPFILEC(LUNCP,.FALSE.,FILNAM,LUNIMG,DISP,
+d206 2
+a207 2
+     & 		       MAXIM,' ',FOUROK,IRTFLG) 
+	  IF (IRTFLG .NE. 0) RETURN 
+d212 5
+a216 2
+c         write(6,*)' Opened templated file: ',filnam(1:20),
+c     &              '  for:',imgnum
+d251 2
+a252 2
+     & 		       MAXIM,'UNUSED',FOUROK,IRTFLG) 
+	  IF (IRTFLG .NE. 0) RETURN
+d257 3
+a259 2
+          !write(6,*)' In opfiles_mrc; opened: ',filnam(1:nlet)
+          !write(6,*)' In opfiles_mrc; imgnum: ',imgnum
+d263 21
+a283 6
+C         STACKED IMAGE FILE:  ------------------------------ 2@@STK.mrc
+                
+          MAXIM = 0        ! SPECIFIC IMAGE WANTED  
+	  CALL OPFILEC(LUNCP,.FALSE.,FILPAT,LUNIMG,DISP,
+     &                 ITYPE,NX,NY,NZ, 
+     & 		       MAXIM,'UNUSED',FOUROK,IRTFLG) 
+a286 1
+	  IF (IRTFLG .NE. 0) RETURN 
+d288 10
+a297 2
+          ! write(6,*)' In opfiles_mrc; imami : ',imami
+          ! write(6,*)' In opfiles_mrc; openrf simple file: ',filpat
+d301 12
+a312 2
+       ENDIF
+       !write(6,*)' In opfiles_mrc; maxim: ',maxim
+d338 1
+a338 1
+	SUBROUTINE GETNEWIMG_MRC(LUN,FILPAT,NWANT,SAYIT,
+d376 1
+a376 1
+	   IF (IRTFLG .NE. 0) RETURN 
+d386 1
+a386 1
+	   IF (IRTFLG .NE. 0) RETURN 
+d388 1
+a388 1
+	   IF (IRTFLG .NE. 0) RETURN 
+d394 1
+a394 1
+	   CALL OPFILEC(LUNCP,.FALSE.,FILNAM,LUN,'U',ITYPE,
+d396 2
+a397 2
+     & 		        MAXIM,'UNUSED',FOUROK,IRTFLG) 
+	   IF (IRTFLG .NE. 0) RETURN 
+d463 1
+a463 1
+	END
+d491 1
+a491 1
+	SUBROUTINE GETOLDIMG_MRC(LUN,FILPAT,NWANT,SAYIT,
+d528 1
+a528 1
+	   IF (IRTFLG .NE. 0) RETURN 
+d541 1
+a541 1
+	   CALL OPFILEC(0,.FALSE.,FILNAM,LUN,NULL,ITYPE,
+d543 2
+a544 2
+     & 		        MAXIM,' ',FOUROK,IRTFLG) 
+	   IF (IRTFLG .NE. 0) RETURN 
+d563 1
+a563 1
+             CALL ERRT(102,'GETOLDIMG_MRC, NO SUCH IMAGE',NWANT)
+d579 1
+a579 1
+C          SET IMAGE OFFSET FOR READ/WRITE
+d604 1
+a604 1
 	END
+@
+
+
+1.8
+log
+@DEBUG OUTPUT ADDED
+@
+text
+@d264 1
+a264 1
+       write(6,*)' In opfiles_mrc, maxim !!!!!!!! : ',maxim
+@
 
+
+1.7
+log
+@COMMENTS
+@
+text
+@d6 1
+d8 1
+a8 1
+C ********************************************************************** 
+d12 1
+a12 1
+C=* Copyright 1985-2020  Health Research Inc.,                         *
+d28 1
+a28 1
+C ********************************************************************** 
+d115 1
+a115 1
+C23456789 123456789 123456789 123456789 123456789 123456789 123456789 12 
+a116 1
+
+d154 2
+a155 2
+       !write(3,*)' In opfiles_mrc,locast,locat,:',locast,locat,is_barel
+       !write(3,*)' In opfiles_mrc, imgnum:',imgnum,filpat
+d160 1
+a160 1
+          !write(3,*)' In opfiles_mrc, opening: ',filpat(1:nlet)
+d170 1
+a170 1
+          !write(3,*)' In opfiles_mrc, opening: ',filnam(1:nlet)
+d180 1
+a180 1
+          !write(3,*)' In opfiles_mrc, maxim: ',maxim,imgnum
+d200 1
+a200 1
+c          write(3,*)' Opened templated file: ',filnam(1:20),
+d217 1
+a217 1
+         !write(3,*)' In opfiles_mrc, filnamnoat: ',filnamnoat(1:nlet)
+d230 2
+a231 2
+          !write(3,*)' In opfiles_mrc, filpat: ',filpat(1:nlet)
+          !write(3,*)' In opfiles_mrc, filnam: ',filnam(1:nlet)
+d242 2
+a243 2
+          !write(3,*)' In opfiles_mrc, opened: ',filnam(1:nlet)
+          !write(3,*)' In opfiles_mrc, imgnum: ',imgnum
+d258 2
+a259 2
+          ! write(3,*)' In opfiles_mrc, imami : ',imami
+          ! write(3,*)' In opfiles_mrc, openrf simple file: ',filpat
+d264 1
+d321 1
+a321 1
+        !write(3,*)' !!!locast,locat,filpat:',locast,locat,filpat(1:nlet)
+d351 1
+a351 1
+           !write(3,*)' In getnewimg_mrc opened new templated file: ',
+d390 1
+a390 1
+           !write(3,'(a,8i5)') ' In getnu_mrc22, lun,imgnum:',lun,imgnum
+d410 1
+a410 1
+           !write(3,*)' In getnewimg_mrc opened new stacked file: ',
+d473 1
+a473 1
+        ! write(3,*)' In getoldimg_mrc locast,locat,nlet,filpat:',
+d475 1
+a475 1
+        !write(3,*)' In getoldimg_mrc, nwant,: ',nwant,':',filpat(1:nlet)
+d538 1
+a538 1
+           !write(3,*)' In getoldimg_mrc after lunsetcommon: ',filnam(1:nlet)
+d544 1
+a544 1
+cc         write(3,*)' In getoldimg_mrc opened old templated stk file: ',
 @
 
 
diff --git src/RCS/opsf3_p.f,v src/RCS/opsf3_p.f,v
index abdf6ced..e0724188 100644
--- src/RCS/opsf3_p.f,v
+++ src/RCS/opsf3_p.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.33.35;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.11;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -90,7 +95,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -141,6 +146,17 @@ C***********************************************************************
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/opsf_p.f,v src/RCS/opsf_p.f,v
index 46bb08cc..54e571fa 100644
--- src/RCS/opsf_p.f,v
+++ src/RCS/opsf_p.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.33.35;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.11;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -90,7 +95,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -135,6 +140,17 @@ C***********************************************************************
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/opstreamfile.f,v src/RCS/opstreamfile.f,v
index e7dc4a5e..4904d9cf 100644
--- src/RCS/opstreamfile.f,v
+++ src/RCS/opstreamfile.f,v
@@ -1,4 +1,4 @@
-head	1.35;
+head	1.37;
 access;
 symbols
 	pre_mrcs:1.33
@@ -21,6 +21,16 @@ locks; strict;
 comment	@c @;
 
 
+1.37
+date	2025.10.21.19.07.57;	author dean;	state Exp;
+branches;
+next	1.36;
+
+1.36
+date	2025.10.07.13.50.04;	author dean;	state Exp;
+branches;
+next	1.35;
+
 1.35
 date	2020.01.13.16.09.11;	author leith;	state Exp;
 branches;
@@ -201,23 +211,25 @@ desc
 @@
 
 
-1.35
+1.37
 log
-@cosmetic
+@debug output
 @
 text
 @
-C ++********************************************************************
+C **********************************************************************
 C
 C OPSTREAMFILE  STREAM IO                        FEB 2013 ArDean Leith
 C               CONVERT LITTLE ENDED OPTION      JAN 2018 ArDean Leith
+C               ADDED DEBUG OUTPUT               OCT 2025 ArDean Leith
+C
 C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2019  Health Research Inc.,                         *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -271,7 +283,7 @@ C***********************************************************************
         INTEGER           :: LENE,IRTFLGT,LUN,IDUM,LENOPEN,LENOPENFILE
         INTEGER           :: LENOPN,LENREC
 
-        CALL SET_MPI(ICOMM,MYPID,MPIERR) ! SETS ICOMM AND MYPID  #ifdef USE_MPI
+        CALL SET_MPI(ICOMM,MYPID,MPIERR) ! SETS ICOMM AND MYPID
 
         SAYIT = (IRTFLG .NE. 999)
 
@@ -329,6 +341,7 @@ C       SET STATUS FOR OPEN
 
         IF (DISP(1:1) == 'S') STATVAR = 'SCRATCH'
 
+
         IF (DISP(1:1) == 'O') THEN
 C          CHECK FOR FILE EXISTENCE 
            IF (MYPID <= 0) THEN
@@ -351,20 +364,35 @@ C          CHECK FOR FILE EXISTENCE
               RETURN
 
            ENDIF
-           STATVAR = 'OLD'
+           STATVAR = 'OLD'  
         ENDIF
 
 C       OPEN FILE FOR STREAM ACCESS
 
-C       COMPUTE RECL UNITS (DIFFERS WITH OS &A COMPILER FLAGS)
+#if defined(SP_DBUG)
+        write(3,*)' In opstreamfile; Disp,Statvar,Formvar: ', 
+     &                               disp,' :',statvar,' :',formvar
+
+        write(3,*)' In opstreamfile; convert_to_big,convert_to_little:',
+     &                           convert_to_big,' :',convert_to_little
+#endif
+
+#if defined(SP_BACK)
+ 
+        !CALL BACKTRACE
+#endif
+
+C       COMPUTE RECL UNITS (DIFFERS WITH OS & COMPILER FLAGS)
         LENOPN = LENOPENFILE(LENREC)
 
         IF (MYPID <= 0) THEN
-           IF (STATVAR == 'SCRATCH') THEN
+
+           IF (STATVAR == 'SCRATCH') THEN   !----- SCRATCH FILE ----
+
               IF (CONVERT_TO_LITTLE) THEN
 C                FORCE OUTPUT TO LITTLE_ENDIAN
 
-	         OPEN(UNIT=LUN,STATUS=STATVAR,
+                 OPEN(UNIT=LUN,STATUS=STATVAR,
      &             CONVERT='LITTLE_ENDIAN',
      &             FORM=FORMVAR, ACCESS='STREAM',
      &             IOSTAT=IRTFLGT)
@@ -372,23 +400,24 @@ C                FORCE OUTPUT TO LITTLE_ENDIAN
               ELSEIF (CONVERT_TO_BIG) THEN
 C                FORCE OUTPUT TO BIG_ENDIAN
 
-	         OPEN(UNIT=LUN,STATUS=STATVAR,
+                 OPEN(UNIT=LUN,STATUS=STATVAR,
      &             CONVERT='BIG_ENDIAN',
      &             FORM=FORMVAR, ACCESS='STREAM',
      &             IOSTAT=IRTFLGT)
 
-	      ELSE
+              ELSE
 
-	         OPEN(UNIT=LUN,STATUS=STATVAR,
+                 OPEN(UNIT=LUN,STATUS=STATVAR,
      &             FORM=FORMVAR, ACCESS='STREAM',
      &             IOSTAT=IRTFLGT)
               ENDIF
-           ELSE
+
+           ELSE    ! ----------- NOT A SCRATCH FILE -------------
 
               IF (CONVERT_TO_LITTLE) THEN
 C               FORCE OUTPUT TO LITTLE_ENDIAN
 
-	        OPEN(UNIT=LUN,FILE=FILNAM(1:NCHAR),STATUS=STATVAR,
+                OPEN(UNIT=LUN,FILE=FILNAM(1:NCHAR),STATUS=STATVAR,
      &             CONVERT='LITTLE_ENDIAN',
      &             FORM=FORMVAR, ACCESS='STREAM', 
      &             IOSTAT=IRTFLGT)
@@ -396,13 +425,13 @@ C               FORCE OUTPUT TO LITTLE_ENDIAN
               ELSEIF (CONVERT_TO_BIG) THEN
 C                FORCE OUTPUT TO BIG_ENDIAN
 
-	         OPEN(UNIT=LUN,FILE=FILNAM(1:NCHAR),STATUS=STATVAR,
+                 OPEN(UNIT=LUN,FILE=FILNAM(1:NCHAR),STATUS=STATVAR,
      &             CONVERT='BIG_ENDIAN',
      &             FORM=FORMVAR, ACCESS='STREAM',
      &             IOSTAT=IRTFLGT)
 
               ELSE
-	         OPEN(UNIT=LUN,FILE=FILNAM(1:NCHAR),STATUS=STATVAR,
+                 OPEN(UNIT=LUN,FILE=FILNAM(1:NCHAR),STATUS=STATVAR,
      &             FORM=FORMVAR, ACCESS='STREAM', 
      &             IOSTAT=IRTFLGT)
 
@@ -415,7 +444,6 @@ C                FORCE OUTPUT TO BIG_ENDIAN
         CALL BCAST_MPI('OPSTREAMFILE','IRTFLGT', IRTFLGT,1, 'I',ICOMM)
 #endif
 
-
         IF (IRTFLGT .NE. 0) THEN
            WRITE(NOUT,90) FORMVAR(1:1), FILNAM(:NCHAR)
  90        FORMAT(' ERROR OPENING (',A1,'): ',A)
@@ -430,12 +458,86 @@ C                FORCE OUTPUT TO BIG_ENDIAN
  
         IRTFLG = 0
 
+#if defined(SP_DBUG)
+        write(3,*)' Leaving opstreamfile; irtflg: ',irtflg
+        write(3,*)
+#endif
+
         END
 
 
 @
 
 
+1.36
+log
+@added debug output
+@
+text
+@d164 1
+a164 1
+        CALL BACKTRACE
+d171 3
+a173 1
+           IF (STATVAR == 'SCRATCH') THEN
+d196 2
+a197 1
+           ELSE
+a228 1
+
+d242 5
+@
+
+
+1.35
+log
+@cosmetic
+@
+text
+@d2 1
+a2 1
+C ++********************************************************************
+d6 2
+d12 1
+a12 1
+C=* Copyright 1985-2019  Health Research Inc.,                         *
+d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+d68 1
+a68 1
+        CALL SET_MPI(ICOMM,MYPID,MPIERR) ! SETS ICOMM AND MYPID  #ifdef USE_MPI
+d126 1
+d149 1
+a149 1
+           STATVAR = 'OLD'
+d154 14
+a167 1
+C       COMPUTE RECL UNITS (DIFFERS WITH OS &A COMPILER FLAGS)
+d175 1
+a175 1
+	         OPEN(UNIT=LUN,STATUS=STATVAR,
+d183 1
+a183 1
+	         OPEN(UNIT=LUN,STATUS=STATVAR,
+d188 1
+a188 1
+	      ELSE
+d190 1
+a190 1
+	         OPEN(UNIT=LUN,STATUS=STATVAR,
+d199 1
+a199 1
+	        OPEN(UNIT=LUN,FILE=FILNAM(1:NCHAR),STATUS=STATVAR,
+d207 1
+a207 1
+	         OPEN(UNIT=LUN,FILE=FILNAM(1:NCHAR),STATUS=STATVAR,
+d213 1
+a213 1
+	         OPEN(UNIT=LUN,FILE=FILNAM(1:NCHAR),STATUS=STATVAR,
+@
+
+
 1.34
 log
 @mrc_support
diff --git src/RCS/orcdf.f,v src/RCS/orcdf.f,v
index 8a66a9eb..148aeead 100644
--- src/RCS/orcdf.f,v
+++ src/RCS/orcdf.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.33.36;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.11;	author leith;	state Exp;
 branches;
@@ -85,9 +90,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -101,7 +106,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -192,6 +197,17 @@ C     CDF=1.0-((0.39894228040143  )*EXP(-0.5*Z*Z))*(.319381530*T+
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @GPL_2010
diff --git src/RCS/orient.f,v src/RCS/orient.f,v
index 72480172..c612173d 100644
--- src/RCS/orient.f,v
+++ src/RCS/orient.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -21,6 +21,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.33.36;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.11;	author leith;	state Exp;
 branches;
@@ -81,9 +86,9 @@ desc
 @@
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -93,7 +98,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2012  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -687,6 +692,17 @@ C            CALCULATE GRAD MAGNITUDE
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d8 1
+a8 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @DGR_TO_RAD name
diff --git src/RCS/ormap.f,v src/RCS/ormap.f,v
index 9f6ea59a..7d475b7a 100644
--- src/RCS/ormap.f,v
+++ src/RCS/ormap.f,v
@@ -1,4 +1,4 @@
-head	1.5;
+head	1.6;
 access;
 symbols
 	pre_mrcs:1.5
@@ -7,6 +7,11 @@ locks; strict;
 comment	@c @;
 
 
+1.6
+date	2025.11.10.22.33.36;	author dean;	state Exp;
+branches;
+next	1.5;
+
 1.5
 date	2018.10.03.14.34.11;	author leith;	state Exp;
 branches;
@@ -37,9 +42,9 @@ desc
 @@
 
 
-1.5
+1.6
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -54,7 +59,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-201e  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -625,6 +630,17 @@ C dgm     &           '  Ang:',f6.2,'  Max:',f10.2,)
 
 
 
+@
+
+
+1.5
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
 @
 
 
diff --git src/RCS/ormd.f,v src/RCS/ormd.f,v
index 71ac5f1c..4ebb598e 100644
--- src/RCS/ormd.f,v
+++ src/RCS/ormd.f,v
@@ -1,4 +1,4 @@
-head	1.34;
+head	1.35;
 access;
 symbols
 	pre_mrcs:1.34
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.35
+date	2025.11.10.22.33.36;	author dean;	state Exp;
+branches;
+next	1.34;
+
 1.34
 date	2018.10.03.14.34.11;	author leith;	state Exp;
 branches;
@@ -200,9 +205,9 @@ desc
 @
 
 
-1.34
+1.35
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -219,7 +224,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2013  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -361,6 +366,17 @@ C       INITIALIZE FFTW3 PLANS FOR USE WITHIN OMP || SECTIONS
 @
 
 
+1.34
+log
+@email_health_dept
+@
+text
+@d15 1
+a15 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.33
 log
 @angle bug rewrite
diff --git src/RCS/ormd_p.f,v src/RCS/ormd_p.f,v
index 8a6d36cc..f07b12b1 100644
--- src/RCS/ormd_p.f,v
+++ src/RCS/ormd_p.f,v
@@ -1,4 +1,4 @@
-head	1.23;
+head	1.24;
 access;
 symbols
 	pre_mrcs:1.23
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.24
+date	2025.11.10.22.33.36;	author dean;	state Exp;
+branches;
+next	1.23;
+
 1.23
 date	2018.10.03.14.34.11;	author leith;	state Exp;
 branches;
@@ -145,9 +150,9 @@ desc
 @
 
 
-1.23
+1.24
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -160,7 +165,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2013  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -350,6 +355,17 @@ C          MULTIPLE PEAKS, FIRST REGISTER IS THE NUMBER OF PEAKS SAVED
 @
 
 
+1.23
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.22
 log
 @angle bug rewrite
diff --git src/RCS/outim_q.f,v src/RCS/outim_q.f,v
index 636c5f3a..1ecb15b2 100644
--- src/RCS/outim_q.f,v
+++ src/RCS/outim_q.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.33.36;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.11;	author leith;	state Exp;
 branches;
@@ -79,9 +84,9 @@ desc
 @@
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -95,7 +100,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014 Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -146,6 +151,17 @@ C--*********************************************************************
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @LEN=MAXNAM
diff --git src/RCS/outpr.f,v src/RCS/outpr.f,v
index c2c55044..46535fda 100644
--- src/RCS/outpr.f,v
+++ src/RCS/outpr.f,v
@@ -1,4 +1,4 @@
-head	1.15;
+head	1.16;
 access;
 symbols
 	pre_mrcs:1.15
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.16
+date	2025.11.10.22.33.36;	author dean;	state Exp;
+branches;
+next	1.15;
+
 1.15
 date	2018.10.03.14.34.11;	author leith;	state Exp;
 branches;
@@ -105,9 +110,9 @@ desc
 @
 
 
-1.15
+1.16
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -121,7 +126,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014 Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -177,6 +182,17 @@ C       REWIND AND OVERWRITE EXISTING DOC FILE
 @
 
 
+1.15
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.14
 log
 @LEN=MAXNAM
diff --git src/RCS/outrng.f,v src/RCS/outrng.f,v
index 9f1fd1b1..dc65f464 100644
--- src/RCS/outrng.f,v
+++ src/RCS/outrng.f,v
@@ -1,4 +1,4 @@
-head	1.12;
+head	1.13;
 access;
 symbols
 	pre_mrcs:1.12
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.13
+date	2025.11.10.22.33.36;	author dean;	state Exp;
+branches;
+next	1.12;
+
 1.12
 date	2018.10.03.14.34.11;	author leith;	state Exp;
 branches;
@@ -90,9 +95,9 @@ desc
 @
 
 
-1.12
+1.13
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -105,7 +110,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -163,6 +168,17 @@ C***********************************************************************
 @
 
 
+1.12
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.11
 log
 @GPL_2010
diff --git src/RCS/parabl.f,v src/RCS/parabl.f,v
index 724dd002..fa8ea3bb 100644
--- src/RCS/parabl.f,v
+++ src/RCS/parabl.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.33.36;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.12;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -91,7 +96,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -163,6 +168,17 @@ C       LIMIT INTERPLATION TO +/- 1. RANGE
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @cosmetic
diff --git src/RCS/parabld.f,v src/RCS/parabld.f,v
index dfba91a2..3cdc42bc 100644
--- src/RCS/parabld.f,v
+++ src/RCS/parabld.f,v
@@ -1,4 +1,4 @@
-head	1.7;
+head	1.8;
 access;
 symbols
 	pre_mrcs:1.7
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.8
+date	2025.11.10.22.33.36;	author dean;	state Exp;
+branches;
+next	1.7;
+
 1.7
 date	2018.10.03.14.34.11;	author leith;	state Exp;
 branches;
@@ -65,9 +70,9 @@ desc
 @
 
 
-1.7
+1.8
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -81,7 +86,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -153,6 +158,17 @@ C       LIMIT INTERPLATION TO +/- 1. RANGE
 @
 
 
+1.7
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.6
 log
 @GPL_2010
diff --git src/RCS/parsesympar.f,v src/RCS/parsesympar.f,v
index 5b062365..e3268a78 100644
--- src/RCS/parsesympar.f,v
+++ src/RCS/parsesympar.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -22,6 +22,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.33.36;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.12;	author leith;	state Exp;
 branches;
@@ -72,9 +77,9 @@ desc
 @@
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -91,7 +96,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -228,6 +233,17 @@ C        GET VARIABLE VALUE IN RESPONSE STRING
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d15 1
+a15 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/parst.f,v src/RCS/parst.f,v
index ed39d8ad..24cdf302 100644
--- src/RCS/parst.f,v
+++ src/RCS/parst.f,v
@@ -1,4 +1,4 @@
-head	1.18;
+head	1.19;
 access;
 symbols
 	pre_mrcs:1.18
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.19
+date	2025.11.10.22.33.36;	author dean;	state Exp;
+branches;
+next	1.18;
+
 1.18
 date	2018.10.03.14.34.12;	author leith;	state Exp;
 branches;
@@ -120,9 +125,9 @@ desc
 @
 
 
-1.18
+1.19
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -138,7 +143,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2011  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -348,6 +353,17 @@ C      GENERATION OF STABLE CLUSTERING WITH NKLA CLUSTERS
 @
 
 
+1.18
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.17
 log
 @factor list (KV) added
diff --git src/RCS/patch.f,v src/RCS/patch.f,v
index d12336f6..a1ea05f2 100644
--- src/RCS/patch.f,v
+++ src/RCS/patch.f,v
@@ -1,4 +1,4 @@
-head	1.27;
+head	1.28;
 access;
 symbols
 	pre_mrcs:1.27
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.28
+date	2025.11.10.22.33.36;	author dean;	state Exp;
+branches;
+next	1.27;
+
 1.27
 date	2018.10.03.14.34.12;	author leith;	state Exp;
 branches;
@@ -165,9 +170,9 @@ desc
 @
 
 
-1.27
+1.28
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -188,7 +193,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -677,6 +682,17 @@ C
 @
 
 
+1.27
+log
+@email_health_dept
+@
+text
+@d19 1
+a19 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.26
 log
 @FMIN BUG on 'IN S'
diff --git src/RCS/pdates.f,v src/RCS/pdates.f,v
index 47686b82..37f2a66f 100644
--- src/RCS/pdates.f,v
+++ src/RCS/pdates.f,v
@@ -1,4 +1,4 @@
-head	1.17;
+head	1.18;
 access;
 symbols
 	pre_mrcs:1.17
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.18
+date	2025.11.10.22.33.36;	author dean;	state Exp;
+branches;
+next	1.17;
+
 1.17
 date	2018.10.03.14.34.12;	author leith;	state Exp;
 branches;
@@ -115,9 +120,9 @@ desc
 @
 
 
-1.17
+1.18
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -132,7 +137,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -205,6 +210,17 @@ C        SKIP ONE LINE
 @
 
 
+1.17
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.16
 log
 @output format skip space
diff --git src/RCS/picksl.f,v src/RCS/picksl.f,v
index 0eaa8fda..2eaa5208 100644
--- src/RCS/picksl.f,v
+++ src/RCS/picksl.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.33.36;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.34.12;	author leith;	state Exp;
 branches;
@@ -70,9 +75,9 @@ desc
 @
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -86,7 +91,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -137,6 +142,17 @@ C--*******************************************************************
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @GPL_2010
diff --git src/RCS/picksv.f,v src/RCS/picksv.f,v
index 97d2f184..6e131252 100644
--- src/RCS/picksv.f,v
+++ src/RCS/picksv.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.33.36;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.34.12;	author leith;	state Exp;
 branches;
@@ -70,9 +75,9 @@ desc
 @
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -86,7 +91,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -151,6 +156,17 @@ C **********************************************************************
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @GPL_2010
diff --git src/RCS/pj2d.f,v src/RCS/pj2d.f,v
index 0ca3bbc0..5c2d355c 100644
--- src/RCS/pj2d.f,v
+++ src/RCS/pj2d.f,v
@@ -1,4 +1,4 @@
-head	1.4;
+head	1.5;
 access;
 symbols
 	pre_mrcs:1.4
@@ -7,6 +7,11 @@ locks; strict;
 comment	@c @;
 
 
+1.5
+date	2025.11.10.22.33.36;	author dean;	state Exp;
+branches;
+next	1.4;
+
 1.4
 date	2018.10.03.14.34.12;	author leith;	state Exp;
 branches;
@@ -32,9 +37,9 @@ desc
 @@
 
 
-1.4
+1.5
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -48,7 +53,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2018  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -189,6 +194,17 @@ C      OUTPUT PROJECTION VISUALIZATION FILE
 @
 
 
+1.4
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.3
 log
 @cosmetic
diff --git src/RCS/pj3_fbs.f,v src/RCS/pj3_fbs.f,v
index 540dc419..fde86e8e 100644
--- src/RCS/pj3_fbs.f,v
+++ src/RCS/pj3_fbs.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -7,6 +7,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.33.36;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.12;	author leith;	state Exp;
 branches;
@@ -62,9 +67,9 @@ desc
 @@
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -77,7 +82,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -372,6 +377,17 @@ c                      IF (I2 >= 1 .AND. I2 <= NXP) THEN
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @gpk's bug fix
diff --git src/RCS/pj3_n.f,v src/RCS/pj3_n.f,v
index d673917a..48dd93ae 100644
--- src/RCS/pj3_n.f,v
+++ src/RCS/pj3_n.f,v
@@ -1,4 +1,4 @@
-head	1.5;
+head	1.6;
 access;
 symbols
 	pre_mrcs:1.5
@@ -20,6 +20,11 @@ locks; strict;
 comment	@c @;
 
 
+1.6
+date	2025.11.10.22.33.36;	author dean;	state Exp;
+branches;
+next	1.5;
+
 1.5
 date	2018.10.03.14.34.12;	author leith;	state Exp;
 branches;
@@ -51,9 +56,9 @@ desc
 @
 
 
-1.5
+1.6
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -66,7 +71,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -268,6 +273,17 @@ c        B = 0.0
 @
 
 
+1.5
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.4
 log
 @GPL_2010
diff --git src/RCS/pj3q_n.f,v src/RCS/pj3q_n.f,v
index 87698af2..e50b1124 100644
--- src/RCS/pj3q_n.f,v
+++ src/RCS/pj3q_n.f,v
@@ -1,4 +1,4 @@
-head	1.23;
+head	1.24;
 access;
 symbols
 	pre_mrcs:1.23
@@ -20,6 +20,11 @@ locks; strict;
 comment	@c @;
 
 
+1.24
+date	2025.11.10.22.33.36;	author dean;	state Exp;
+branches;
+next	1.23;
+
 1.23
 date	2018.10.03.14.34.12;	author leith;	state Exp;
 branches;
@@ -140,9 +145,9 @@ desc
 @@
 
 
-1.23
+1.24
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -160,7 +165,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2015  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -364,6 +369,17 @@ C        PROJECT NOW
 @
 
 
+1.23
+log
+@email_health_dept
+@
+text
+@d16 1
+a16 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.22
 log
 @comma before blank bug in ans
diff --git src/RCS/pkd.f,v src/RCS/pkd.f,v
index 681678ef..9cbacce1 100644
--- src/RCS/pkd.f,v
+++ src/RCS/pkd.f,v
@@ -1,4 +1,4 @@
-head	1.17;
+head	1.18;
 access;
 symbols
 	pre_mrcs:1.17
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.18
+date	2025.11.10.22.33.36;	author dean;	state Exp;
+branches;
+next	1.17;
+
 1.17
 date	2018.10.03.14.34.12;	author leith;	state Exp;
 branches;
@@ -115,9 +120,9 @@ desc
 @
 
 
-1.17
+1.18
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C	
@@ -131,7 +136,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -271,6 +276,17 @@ C     Check whether there were any other peaks in the vicinity
 @
 
 
+1.17
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.16
 log
 @GPL_2010
diff --git src/RCS/pksr3.f,v src/RCS/pksr3.f,v
index 2b8c304e..5b0ee882 100644
--- src/RCS/pksr3.f,v
+++ src/RCS/pksr3.f,v
@@ -1,4 +1,4 @@
-head	1.12;
+head	1.13;
 access;
 symbols
 	pre_mrcs:1.12
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.13
+date	2025.11.10.22.33.36;	author dean;	state Exp;
+branches;
+next	1.12;
+
 1.12
 date	2018.10.03.14.34.12;	author leith;	state Exp;
 branches;
@@ -90,9 +95,9 @@ desc
 @
 
 
-1.12
+1.13
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -106,7 +111,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -330,6 +335,17 @@ C           WANT MINIMUM
 @
 
 
+1.12
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.11
 log
 @added trap for sgn=1 integer bug
diff --git src/RCS/plnedg.f,v src/RCS/plnedg.f,v
index 0ba03978..90e8ec9f 100644
--- src/RCS/plnedg.f,v
+++ src/RCS/plnedg.f,v
@@ -1,4 +1,4 @@
-head	1.7;
+head	1.8;
 access;
 symbols
 	pre_mrcs:1.7
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.8
+date	2025.11.10.22.33.36;	author dean;	state Exp;
+branches;
+next	1.7;
+
 1.7
 date	2018.10.03.14.34.12;	author leith;	state Exp;
 branches;
@@ -65,9 +70,9 @@ desc
 @
 
 
-1.7
+1.8
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -81,7 +86,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -135,6 +140,17 @@ C	WRITE(NOUT,513)(PN(1,I),I=1,4)
 @
 
 
+1.7
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.6
 log
 @GPL_2010
diff --git src/RCS/plot1.f,v src/RCS/plot1.f,v
index a9c6d887..0e91f570 100644
--- src/RCS/plot1.f,v
+++ src/RCS/plot1.f,v
@@ -1,4 +1,4 @@
-head	1.18;
+head	1.19;
 access;
 symbols
 	pre_mrcs:1.18
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.19
+date	2025.11.10.22.33.36;	author dean;	state Exp;
+branches;
+next	1.18;
+
 1.18
 date	2018.10.03.14.34.12;	author leith;	state Exp;
 branches;
@@ -120,9 +125,9 @@ desc
 @
 
 
-1.18
+1.19
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -147,7 +152,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -304,6 +309,17 @@ C          OPEN DOC FILE FOR INPUT
 @
 
 
+1.18
+log
+@email_health_dept
+@
+text
+@d23 1
+a23 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.17
 log
 @'PL G' for gnuplot, case, nx
diff --git src/RCS/plot2.f,v src/RCS/plot2.f,v
index 7307ca49..c2a8ab9a 100644
--- src/RCS/plot2.f,v
+++ src/RCS/plot2.f,v
@@ -1,4 +1,4 @@
-head	1.12;
+head	1.13;
 access;
 symbols
 	pre_mrcs:1.12
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.13
+date	2025.11.10.22.33.36;	author dean;	state Exp;
+branches;
+next	1.12;
+
 1.12
 date	2018.10.03.14.34.12;	author leith;	state Exp;
 branches;
@@ -90,9 +95,9 @@ desc
 @
 
 
-1.12
+1.13
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -106,7 +111,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -168,6 +173,17 @@ C       3-D POSTSCRIPT PLOT
 @
 
 
+1.12
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.11
 log
 @GPL_2010
diff --git src/RCS/poj.f,v src/RCS/poj.f,v
index 8f9adf18..1d774869 100644
--- src/RCS/poj.f,v
+++ src/RCS/poj.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.33.36;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.12;	author leith;	state Exp;
 branches;
@@ -80,9 +85,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -96,7 +101,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -172,6 +177,17 @@ C 	INITIALIZE
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @GPL_2010
diff --git src/RCS/polar_cc.f,v src/RCS/polar_cc.f,v
index ead90bda..1735e8d2 100644
--- src/RCS/polar_cc.f,v
+++ src/RCS/polar_cc.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -21,6 +21,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.33.37;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.12;	author leith;	state Exp;
 branches;
@@ -77,9 +82,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -95,7 +100,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2012  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -270,6 +275,17 @@ C       CROSS CORRELATION IN FOURIER SPACE
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @COSMETIC & ERROR TRAP REWRITE
diff --git src/RCS/polfit.f,v src/RCS/polfit.f,v
index 6df5f832..bfa1af2d 100644
--- src/RCS/polfit.f,v
+++ src/RCS/polfit.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.33.38;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.12;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -91,7 +96,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -171,6 +176,17 @@ C        WRITE(6,*)'C(',K,'): ',C(K)
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/polish.f,v src/RCS/polish.f,v
index c96bbdd5..9abba70d 100644
--- src/RCS/polish.f,v
+++ src/RCS/polish.f,v
@@ -1,4 +1,4 @@
-head	1.33;
+head	1.34;
 access;
 symbols
 	pre_mrcs:1.33
@@ -25,6 +25,11 @@ locks; strict;
 comment	@c @;
 
 
+1.34
+date	2025.11.10.22.33.38;	author dean;	state Exp;
+branches;
+next	1.33;
+
 1.33
 date	2018.10.03.14.34.12;	author leith;	state Exp;
 branches;
@@ -195,9 +200,9 @@ desc
 @@
 
 
-1.33
+1.34
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++********************************************************************* 
@@ -214,7 +219,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -710,6 +715,17 @@ C          ALL DONE, CAN RETURN NOW
 @
 
 
+1.33
+log
+@email_health_dept
+@
+text
+@d15 1
+a15 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.32
 log
 @GPL_2010
diff --git src/RCS/pollsq.f,v src/RCS/pollsq.f,v
index aa0ba74d..5b2ff202 100644
--- src/RCS/pollsq.f,v
+++ src/RCS/pollsq.f,v
@@ -1,4 +1,4 @@
-head	1.15;
+head	1.16;
 access;
 symbols
 	pre_mrcs:1.15
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.16
+date	2025.11.10.22.33.38;	author dean;	state Exp;
+branches;
+next	1.15;
+
 1.15
 date	2018.10.03.14.34.12;	author leith;	state Exp;
 branches;
@@ -105,9 +110,9 @@ desc
 @
 
 
-1.15
+1.16
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -122,7 +127,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -264,6 +269,17 @@ C          OUTPUT INTO DOCUMENT FILE:
 @
 
 
+1.15
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.14
 log
 @GPL_2010
diff --git src/RCS/polqs.f,v src/RCS/polqs.f,v
index 1620e343..e4e3955a 100644
--- src/RCS/polqs.f,v
+++ src/RCS/polqs.f,v
@@ -1,4 +1,4 @@
-head	1.30;
+head	1.31;
 access;
 symbols
 	pre_mrcs:1.30
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.31
+date	2025.11.10.22.33.38;	author dean;	state Exp;
+branches;
+next	1.30;
+
 1.30
 date	2018.10.03.14.34.12;	author leith;	state Exp;
 branches;
@@ -180,9 +185,9 @@ desc
 @
 
 
-1.30
+1.31
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -198,7 +203,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -1536,6 +1541,17 @@ C       CLOCK RESETS AT ICMAX!!
 @
 
 
+1.30
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.29
 log
 @LEN=MAXNAM on F_SPEC
diff --git src/RCS/posaxis.f,v src/RCS/posaxis.f,v
index 421debb5..18b7c0ef 100644
--- src/RCS/posaxis.f,v
+++ src/RCS/posaxis.f,v
@@ -1,4 +1,4 @@
-head	1.13;
+head	1.14;
 access;
 symbols
 	pre_mrcs:1.13
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.14
+date	2025.11.10.22.33.38;	author dean;	state Exp;
+branches;
+next	1.13;
+
 1.13
 date	2018.10.03.14.34.12;	author leith;	state Exp;
 branches;
@@ -94,9 +99,9 @@ desc
 @@
 
 
-1.13
+1.14
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -114,7 +119,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2013  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -598,6 +603,17 @@ C          LIST ALL LABELS
 @
 
 
+1.13
+log
+@email_health_dept
+@
+text
+@d16 1
+a16 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.12
 log
 @removed 'enter' from prompts
diff --git src/RCS/postrt.f,v src/RCS/postrt.f,v
index cab41307..7cca6422 100644
--- src/RCS/postrt.f,v
+++ src/RCS/postrt.f,v
@@ -1,4 +1,4 @@
-head	1.17;
+head	1.18;
 access;
 symbols
 	pre_mrcs:1.17
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.18
+date	2025.11.10.22.33.38;	author dean;	state Exp;
+branches;
+next	1.17;
+
 1.17
 date	2018.10.03.14.34.12;	author leith;	state Exp;
 branches;
@@ -115,9 +120,9 @@ desc
 @
 
 
-1.17
+1.18
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -136,7 +141,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -721,6 +726,17 @@ C         SET NEW SCALING VARIABLES
 @
 
 
+1.17
+log
+@email_health_dept
+@
+text
+@d17 1
+a17 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.16
 log
 @CHARACTER(LEN=*):: FILENAME
diff --git src/RCS/pr3d.f,v src/RCS/pr3d.f,v
index 34730fd6..b87eba1b 100644
--- src/RCS/pr3d.f,v
+++ src/RCS/pr3d.f,v
@@ -1,4 +1,4 @@
-head	1.67;
+head	1.68;
 access;
 symbols
 	pre_mrcs:1.67
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.68
+date	2025.09.21.14.53.42;	author dean;	state Exp;
+branches;
+next	1.67;
+
 1.67
 date	2018.10.03.14.34.12;	author leith;	state Exp;
 branches;
@@ -360,9 +365,9 @@ desc
 @
 
 
-1.67
+1.68
 log
-@email_health_dept
+@WANTSQRTS = (FSCOP == .TRUE.) ILLEGAL ON GFORT
 @
 text
 @
@@ -384,7 +389,6 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2016  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -452,7 +456,7 @@ C--*********************************************************************
 
         CALL SET_MPI(ICOMM,MYPID,MPIERR)
 
-        WANTSQRTS = (FSCOP == .TRUE.)
+        WANTSQRTS = FSCOP  ! WANTSQRTS = (FSCOP == .TRUE.) ILLEGAL ON GFORT Sept 2025 al
 
 C       INPUT FIRST IMAGE
         MAXIM = 0
@@ -707,6 +711,19 @@ c*********************
 @
 
 
+1.67
+log
+@email_health_dept
+@
+text
+@a19 1
+C=* Email: spider@@health.ny.gov                                        *
+d87 1
+a87 1
+        WANTSQRTS = (FSCOP == .TRUE.)
+@
+
+
 1.66
 log
 @cosmetic
diff --git src/RCS/pr3d_new.f,v src/RCS/pr3d_new.f,v
index 5986ea20..ce5adce9 100644
--- src/RCS/pr3d_new.f,v
+++ src/RCS/pr3d_new.f,v
@@ -1,4 +1,4 @@
-head	1.67;
+head	1.68;
 access;
 symbols
 	pre_mrcs:1.67
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.68
+date	2025.11.10.22.33.38;	author dean;	state Exp;
+branches;
+next	1.67;
+
 1.67
 date	2018.10.03.14.34.12;	author leith;	state Exp;
 branches;
@@ -360,9 +365,9 @@ desc
 @
 
 
-1.67
+1.68
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -376,7 +381,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2016  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -931,6 +936,17 @@ C           WRITE GNUPLOT FILE OUTPUT
 @
 
 
+1.67
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.66
 log
 @bad resol. if no crossing found
diff --git src/RCS/pr3db.f,v src/RCS/pr3db.f,v
index b550e224..9475122e 100644
--- src/RCS/pr3db.f,v
+++ src/RCS/pr3db.f,v
@@ -1,4 +1,4 @@
-head	1.35;
+head	1.36;
 access;
 symbols
 	pre_mrcs:1.35
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.36
+date	2025.11.10.22.33.38;	author dean;	state Exp;
+branches;
+next	1.35;
+
 1.35
 date	2018.10.03.14.34.12;	author leith;	state Exp;
 branches;
@@ -205,9 +210,9 @@ desc
 @
 
 
-1.35
+1.36
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -220,7 +225,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2012  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -365,6 +370,17 @@ C                  SCALES
 @
 
 
+1.35
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.34
 log
 @cycle, cosmetic
diff --git src/RCS/prb1.f,v src/RCS/prb1.f,v
index 911136b6..2caa9262 100644
--- src/RCS/prb1.f,v
+++ src/RCS/prb1.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.33.38;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.12;	author leith;	state Exp;
 branches;
@@ -80,9 +85,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -95,7 +100,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -162,6 +167,17 @@ C--*********************************************************************
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @from prb1d.f
diff --git src/RCS/prb1d.f,v src/RCS/prb1d.f,v
index 86a739e3..bd7fc08a 100644
--- src/RCS/prb1d.f,v
+++ src/RCS/prb1d.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.33.38;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.12;	author leith;	state Exp;
 branches;
@@ -80,9 +85,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -95,7 +100,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -162,6 +167,17 @@ C--*********************************************************************
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @cosmetic & comments
diff --git src/RCS/prepcub.f,v src/RCS/prepcub.f,v
index df769c6a..ba9ae718 100644
--- src/RCS/prepcub.f,v
+++ src/RCS/prepcub.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -20,6 +20,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.33.38;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.12;	author leith;	state Exp;
 branches;
@@ -76,9 +81,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -93,7 +98,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2011  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -193,6 +198,17 @@ C                   SECOND OR LATER PIXEL ON THIS LINE,
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @comment
diff --git src/RCS/prepcub_s.f,v src/RCS/prepcub_s.f,v
index 6a06807f..b64075f7 100644
--- src/RCS/prepcub_s.f,v
+++ src/RCS/prepcub_s.f,v
@@ -1,4 +1,4 @@
-head	1.19;
+head	1.20;
 access;
 symbols
 	pre_mrcs:1.19
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.20
+date	2025.11.10.22.33.38;	author dean;	state Exp;
+branches;
+next	1.19;
+
 1.19
 date	2018.10.03.14.34.12;	author leith;	state Exp;
 branches;
@@ -125,9 +130,9 @@ desc
 @
 
 
-1.19
+1.20
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -141,7 +146,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -244,6 +249,17 @@ C                   FIRST PIXEL ON THIS LINE,
 @
 
 
+1.19
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.18
 log
 @comment
diff --git src/RCS/prepsl_2.f,v src/RCS/prepsl_2.f,v
index 8642ee0c..c6f2be3b 100644
--- src/RCS/prepsl_2.f,v
+++ src/RCS/prepsl_2.f,v
@@ -1,4 +1,4 @@
-head	1.4;
+head	1.5;
 access;
 symbols
 	pre_mrcs:1.4
@@ -20,6 +20,11 @@ locks; strict;
 comment	@c @;
 
 
+1.5
+date	2025.11.10.22.33.38;	author dean;	state Exp;
+branches;
+next	1.4;
+
 1.4
 date	2018.10.03.14.34.12;	author leith;	state Exp;
 branches;
@@ -45,9 +50,9 @@ desc
 @@
 
 
-1.4
+1.5
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -61,7 +66,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -133,6 +138,17 @@ C
 @
 
 
+1.4
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.3
 log
 @GPL_2010
diff --git src/RCS/prepsl_s.f,v src/RCS/prepsl_s.f,v
index b264e640..a79d7dee 100644
--- src/RCS/prepsl_s.f,v
+++ src/RCS/prepsl_s.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.33.38;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.34.12;	author leith;	state Exp;
 branches;
@@ -70,9 +75,9 @@ desc
 @
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -86,7 +91,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -159,6 +164,17 @@ C
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @GPL_2010
diff --git src/RCS/prjc0.f,v src/RCS/prjc0.f,v
index c87c4efd..16e4eb19 100644
--- src/RCS/prjc0.f,v
+++ src/RCS/prjc0.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.33.38;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.34.12;	author leith;	state Exp;
 branches;
@@ -70,9 +75,9 @@ desc
 @
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -86,7 +91,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -134,6 +139,17 @@ C***********************************************************************
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @GPL_2010
diff --git src/RCS/prjc2.f,v src/RCS/prjc2.f,v
index 7a25de02..9fb92462 100644
--- src/RCS/prjc2.f,v
+++ src/RCS/prjc2.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.33.38;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.12;	author leith;	state Exp;
 branches;
@@ -80,9 +85,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -96,7 +101,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -144,6 +149,17 @@ c$omp parallel do  private(i),schedule(static)
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @GPL_2010
diff --git src/RCS/prjcq.f,v src/RCS/prjcq.f,v
index ec52ed1d..75cdc7de 100644
--- src/RCS/prjcq.f,v
+++ src/RCS/prjcq.f,v
@@ -1,4 +1,4 @@
-head	1.23;
+head	1.24;
 access;
 symbols
 	pre_mrcs:1.23
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.24
+date	2025.11.10.22.33.38;	author dean;	state Exp;
+branches;
+next	1.23;
+
 1.23
 date	2018.10.03.14.34.12;	author leith;	state Exp;
 branches;
@@ -145,9 +150,9 @@ desc
 @
 
 
-1.23
+1.24
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -164,7 +169,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2012  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can reIribute it and/or               *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -320,6 +325,17 @@ C                       PRJOUT IS LOCAL TO EACH THREAD
 @
 
 
+1.23
+log
+@email_health_dept
+@
+text
+@d15 1
+a15 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.22
 log
 @>         SUBROUTINE  PRJCQ_FBS3(CUBE, DM,
diff --git src/RCS/prjs2.f,v src/RCS/prjs2.f,v
index 24fd2c59..ac28805f 100644
--- src/RCS/prjs2.f,v
+++ src/RCS/prjs2.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.33.38;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.12;	author leith;	state Exp;
 branches;
@@ -80,9 +85,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -92,7 +97,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -125,6 +130,17 @@ C THIS ROUTINE PERFORMS A PROJECTION FROM IMAGE TO DATA SPACE...
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d8 1
+a8 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @GPL_2010
diff --git src/RCS/prober.f,v src/RCS/prober.f,v
index 674db675..34bc86e2 100644
--- src/RCS/prober.f,v
+++ src/RCS/prober.f,v
@@ -1,4 +1,4 @@
-head	1.12;
+head	1.13;
 access;
 symbols
 	pre_mrcs:1.12
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.13
+date	2025.11.10.22.33.38;	author dean;	state Exp;
+branches;
+next	1.12;
+
 1.12
 date	2018.10.03.14.34.12;	author leith;	state Exp;
 branches;
@@ -90,9 +95,9 @@ desc
 @
 
 
-1.12
+1.13
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -106,7 +111,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -167,6 +172,17 @@ C--***************************************************************
 @
 
 
+1.12
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.11
 log
 @GPL_2010
diff --git src/RCS/proc_set.f,v src/RCS/proc_set.f,v
index 7f7f6107..d351aa62 100644
--- src/RCS/proc_set.f,v
+++ src/RCS/proc_set.f,v
@@ -1,4 +1,4 @@
-head	1.6;
+head	1.7;
 access;
 symbols
 	pre_mrcs:1.6
@@ -21,6 +21,11 @@ locks; strict;
 comment	@c @;
 
 
+1.7
+date	2025.11.10.22.33.38;	author dean;	state Exp;
+branches;
+next	1.6;
+
 1.6
 date	2018.10.03.14.34.13;	author leith;	state Exp;
 branches;
@@ -56,9 +61,9 @@ desc
 @@
 
 
-1.6
+1.7
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -72,7 +77,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -213,6 +218,17 @@ C      CHECK TO SEE IF VALID LINE
 @
 
 
+1.6
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.5
 log
 @GPL_2010
diff --git src/RCS/prp.f,v src/RCS/prp.f,v
index 429d7865..5cc01ba0 100644
--- src/RCS/prp.f,v
+++ src/RCS/prp.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.33.38;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.13;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -91,7 +96,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -133,6 +138,17 @@ C***********************************************************************
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/prt.f,v src/RCS/prt.f,v
index a7b94279..7c9b254b 100644
--- src/RCS/prt.f,v
+++ src/RCS/prt.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.33.38;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.13;	author leith;	state Exp;
 branches;
@@ -85,9 +90,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -100,7 +105,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -157,6 +162,17 @@ C--*******************************************************************
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @GPL_2010
diff --git src/RCS/pts_on_sphere.f,v src/RCS/pts_on_sphere.f,v
index cd2f2ceb..cd1d88d0 100644
--- src/RCS/pts_on_sphere.f,v
+++ src/RCS/pts_on_sphere.f,v
@@ -1,4 +1,4 @@
-head	1.7;
+head	1.8;
 access;
 symbols
 	pre_mrcs:1.7
@@ -14,6 +14,11 @@ locks; strict;
 comment	@c @;
 
 
+1.8
+date	2025.11.10.22.33.38;	author dean;	state Exp;
+branches;
+next	1.7;
+
 1.7
 date	2018.10.03.14.34.13;	author leith;	state Exp;
 branches;
@@ -54,9 +59,9 @@ desc
 @@
 
 
-1.7
+1.8
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -69,7 +74,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -278,6 +283,17 @@ C         REMOVE BOTTEM HALF OF SPHERE
 @
 
 
+1.7
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.6
 log
 @I8 format, and overlenght lin
diff --git src/RCS/pttern.f,v src/RCS/pttern.f,v
index 2ae75d4a..c9537e0e 100644
--- src/RCS/pttern.f,v
+++ src/RCS/pttern.f,v
@@ -1,4 +1,4 @@
-head	1.23;
+head	1.24;
 access;
 symbols
 	pre_mrcs:1.23
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.24
+date	2025.11.10.22.33.38;	author dean;	state Exp;
+branches;
+next	1.23;
+
 1.23
 date	2018.10.03.14.34.13;	author leith;	state Exp;
 branches;
@@ -145,9 +150,9 @@ desc
 @
 
 
-1.23
+1.24
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -163,7 +168,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -354,6 +359,17 @@ C       ------------------- MBOX -------------------------------------
 @
 
 
+1.23
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.22
 log
 @mline2 used for aliasing
diff --git src/RCS/putlin.f,v src/RCS/putlin.f,v
index 82b4271a..46fdf077 100644
--- src/RCS/putlin.f,v
+++ src/RCS/putlin.f,v
@@ -1,4 +1,4 @@
-head	1.22;
+head	1.23;
 access;
 symbols
 	pre_mrcs:1.22
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.23
+date	2025.11.10.22.33.38;	author dean;	state Exp;
+branches;
+next	1.22;
+
 1.22
 date	2018.10.03.14.34.13;	author leith;	state Exp;
 branches;
@@ -140,9 +145,9 @@ desc
 @
 
 
-1.22
+1.23
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -158,7 +163,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2018  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -457,6 +462,17 @@ C       PLACE BUFFER BACK IN IMAGE FILE
 @
 
 
+1.22
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.21
 log
 @no common buf usage now
diff --git src/RCS/putpt.f,v src/RCS/putpt.f,v
index 570a0795..73bc03f4 100644
--- src/RCS/putpt.f,v
+++ src/RCS/putpt.f,v
@@ -1,4 +1,4 @@
-head	1.16;
+head	1.17;
 access;
 symbols
 	pre_mrcs:1.16
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.17
+date	2025.11.10.22.33.39;	author dean;	state Exp;
+branches;
+next	1.16;
+
 1.16
 date	2018.10.03.14.34.13;	author leith;	state Exp;
 branches;
@@ -110,9 +115,9 @@ desc
 @
 
 
-1.16
+1.17
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -127,7 +132,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -249,6 +254,17 @@ C       ZERO THE STATISTICS ON FILE
 @
 
 
+1.16
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.15
 log
 @LEN=MAXNAM):: DOCNAM
diff --git src/RCS/putpt1.f,v src/RCS/putpt1.f,v
index f9808959..6890a4e5 100644
--- src/RCS/putpt1.f,v
+++ src/RCS/putpt1.f,v
@@ -1,4 +1,4 @@
-head	1.14;
+head	1.15;
 access;
 symbols
 	pre_mrcs:1.14
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.15
+date	2025.11.10.22.33.39;	author dean;	state Exp;
+branches;
+next	1.14;
+
 1.14
 date	2018.10.03.14.34.13;	author leith;	state Exp;
 branches;
@@ -100,9 +105,9 @@ desc
 @
 
 
-1.14
+1.15
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -118,7 +123,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2013  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -239,6 +244,17 @@ C          SET FMIN, FMAX AS UNDETERMINED
 @
 
 
+1.14
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.13
 log
 @nx, prompt improved
diff --git src/RCS/putpt2.f,v src/RCS/putpt2.f,v
index 8b1522bd..96af1378 100644
--- src/RCS/putpt2.f,v
+++ src/RCS/putpt2.f,v
@@ -1,4 +1,4 @@
-head	1.19;
+head	1.20;
 access;
 symbols
 	pre_mrcs:1.19
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.20
+date	2025.11.10.22.33.39;	author dean;	state Exp;
+branches;
+next	1.19;
+
 1.19
 date	2018.10.03.14.34.13;	author leith;	state Exp;
 branches;
@@ -125,9 +130,9 @@ desc
 @
 
 
-1.19
+1.20
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -144,7 +149,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -302,6 +307,17 @@ C          SET FMIN, FMAX AS UNDETERMINED
 @
 
 
+1.19
+log
+@email_health_dept
+@
+text
+@d15 1
+a15 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.18
 log
 @LEN=MAXNAM):: DOCNAM
diff --git src/RCS/putyslice.f,v src/RCS/putyslice.f,v
index c0d794c8..a2c60292 100644
--- src/RCS/putyslice.f,v
+++ src/RCS/putyslice.f,v
@@ -1,4 +1,4 @@
-head	1.4;
+head	1.5;
 access;
 symbols
 	pre_mrcs:1.4
@@ -20,6 +20,11 @@ locks; strict;
 comment	@c @;
 
 
+1.5
+date	2025.11.10.22.33.39;	author dean;	state Exp;
+branches;
+next	1.4;
+
 1.4
 date	2018.10.03.14.34.13;	author leith;	state Exp;
 branches;
@@ -46,9 +51,9 @@ desc
 @
 
 
-1.4
+1.5
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -56,7 +61,7 @@ C=**********************************************************************
 C=* From: SPIDER - MODULAR IMAGE PROCESSING SYSTEM                     *
 C=* Copyright (C)2000  M. Radermacher                                  *
 C=*                                                                    *
-C=* Email:  spider@@health.ny.gov                                       *
+C=* Email:  spider@@wadsworth.org                                       *
 C=*                                                                    *
 C=* This program is free software; you can redistribute it and/or      *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -92,6 +97,17 @@ C       THE LINE CAN BE TRUNCATED AT NSAMF.
 @
 
 
+1.4
+log
+@email_health_dept
+@
+text
+@d6 1
+a6 1
+C=* Email:  spider@@health.ny.gov                                       *
+@
+
+
 1.3
 log
 @GPL License fixed
diff --git src/RCS/putzslice.f,v src/RCS/putzslice.f,v
index 6cc0b19e..9c031e6e 100644
--- src/RCS/putzslice.f,v
+++ src/RCS/putzslice.f,v
@@ -1,4 +1,4 @@
-head	1.4;
+head	1.5;
 access;
 symbols
 	pre_mrcs:1.4
@@ -20,6 +20,11 @@ locks; strict;
 comment	@c @;
 
 
+1.5
+date	2025.11.10.22.33.39;	author dean;	state Exp;
+branches;
+next	1.4;
+
 1.4
 date	2018.10.03.14.34.13;	author leith;	state Exp;
 branches;
@@ -46,9 +51,9 @@ desc
 @
 
 
-1.4
+1.5
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -56,7 +61,7 @@ C=**********************************************************************
 C=* From: SPIDER - MODULAR IMAGE PROCESSING SYSTEM                     *
 C=* Copyright (C)2000  M. Radermacher                                  *
 C=*                                                                    *
-C=* Email:  spider@@health.ny.gov                                       *
+C=* Email:  spider@@wadsworth.org                                       *
 C=*                                                                    *
 C=* This program is free software; you can redistribute it and/or      *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -91,6 +96,17 @@ C       THE LINE CAN BE TRUNCATED AT NSAM2.
 @
 
 
+1.4
+log
+@email_health_dept
+@
+text
+@d6 1
+a6 1
+C=* Email:  spider@@health.ny.gov                                       *
+@
+
+
 1.3
 log
 @GPL License fixed
diff --git src/RCS/pw2sdr.f,v src/RCS/pw2sdr.f,v
index aa7b000f..f06de958 100644
--- src/RCS/pw2sdr.f,v
+++ src/RCS/pw2sdr.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.33.39;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.13;	author leith;	state Exp;
 branches;
@@ -85,9 +90,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C
@@ -99,7 +104,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -207,6 +212,17 @@ C
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d10 1
+a10 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @GPL_2010
diff --git src/RCS/pw2sr.f,v src/RCS/pw2sr.f,v
index c8855b78..6f0f89a1 100644
--- src/RCS/pw2sr.f,v
+++ src/RCS/pw2sr.f,v
@@ -1,4 +1,4 @@
-head	1.16;
+head	1.17;
 access;
 symbols
 	pre_mrcs:1.16
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.17
+date	2025.09.21.14.52.25;	author dean;	state Exp;
+branches;
+next	1.16;
+
 1.16
 date	2018.10.03.14.34.13;	author leith;	state Exp;
 branches;
@@ -110,9 +115,9 @@ desc
 @
 
 
-1.16
+1.17
 log
-@email_health_dept
+@NX,NY   !GFORT ERROR IF NOT BEFOR Q
 @
 text
 @
@@ -158,8 +163,8 @@ C       FOR FOURIER FILE, LSD = NX+2-MOD(NX,2)   eg: 16=18  17=18
         IMPLICIT NONE
         INCLUDE 'CMBLOCK.INC'
 
+        INTEGER      :: NX,NY,LSD !GFORT ERROR IF NOT BEFOR Q,  Sept 2025 al
         REAL         :: Q(LSD,NY)
-        INTEGER      :: NX,NY,LSD
         CHARACTER    :: MODE
 
         INTEGER      :: J,I,JN,II,JJ,JB,NXD2,NYD2
@@ -355,8 +360,8 @@ C       -------------------- PW2SR ------------------------
         SUBROUTINE  PW2SR(Q,NX,NY,MODE)
 
         IMPLICIT NONE
+        INTEGER      :: NX,NY   !GFORT ERROR IF NOT BEFOR Q,  Sept 2025 al
         REAL         :: Q(NX+2-MOD(NX,2), NY)
-        INTEGER      :: NX,NY
         CHARACTER*1  :: MODE
 
         INTEGER      :: NNNN,NSC,J,I,JJ,II,JB
@@ -477,6 +482,20 @@ C              CAN NOT TAKE LOG!!
 @
 
 
+1.16
+log
+@email_health_dept
+@
+text
+@d44 1
+a45 1
+        INTEGER      :: NX,NY,LSD
+d241 1
+a242 1
+        INTEGER      :: NX,NY
+@
+
+
 1.15
 log
 @for PW PH
diff --git src/RCS/pw3sdr.f,v src/RCS/pw3sdr.f,v
index ab7816a1..4a2b6c54 100644
--- src/RCS/pw3sdr.f,v
+++ src/RCS/pw3sdr.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.33.39;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.13;	author leith;	state Exp;
 branches;
@@ -85,9 +90,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C
@@ -101,7 +106,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -284,6 +289,17 @@ C
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @GPL_2010
diff --git src/RCS/pw3sr.f,v src/RCS/pw3sr.f,v
index fdc419b6..fd22f187 100644
--- src/RCS/pw3sr.f,v
+++ src/RCS/pw3sr.f,v
@@ -1,4 +1,4 @@
-head	1.14;
+head	1.15;
 access;
 symbols
 	pre_mrcs:1.14
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.15
+date	2025.09.21.14.50.53;	author dean;	state Exp;
+branches;
+next	1.14;
+
 1.14
 date	2018.10.03.14.34.13;	author leith;	state Exp;
 branches;
@@ -100,9 +105,9 @@ desc
 @
 
 
-1.14
+1.15
 log
-@email_health_dept
+@NX,NY,NZ !GFORT ERROR
 @
 text
 @C++*********************************************************************
@@ -115,7 +120,6 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2018  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -141,8 +145,8 @@ C--*********************************************************************
         SUBROUTINE PW3SR(Q,NX,NY,NZ,MODE)
 
         IMPLICIT NONE
-        REAL         :: Q(NX+2-MOD(NX,2),NY,NZ)
-        INTEGER      :: NX,NY,NZ
+        INTEGER      :: NX,NY,NZ !GFORT ERROR IF NOT BEFOR Q,  Sept 2025 al
+        REAL         :: Q(NX+2-MOD(NX,2),NY,NZ)!GFORT ERROR,  Sept 2025 al
         CHARACTER    :: MODE
 
         LOGICAL      :: EVENY,EVENZ,WANTLOG,WANT2,WANTPH
@@ -352,6 +356,20 @@ C       REPLACE ORIGIN WITH ADJACENT VALUE TO HELP CONTRAST
 @
 
 
+1.14
+log
+@email_health_dept
+@
+text
+@a10 1
+C=* Email: spider@@health.ny.gov                                        *
+d36 2
+a37 2
+        REAL         :: Q(NX+2-MOD(NX,2),NY,NZ)
+        INTEGER      :: NX,NY,NZ
+@
+
+
 1.13
 log
 @parallelized for OMP, comments added
diff --git src/RCS/qali.f,v src/RCS/qali.f,v
index 1c0665c7..b16197b0 100644
--- src/RCS/qali.f,v
+++ src/RCS/qali.f,v
@@ -1,4 +1,4 @@
-head	1.23;
+head	1.24;
 access;
 symbols
 	pre_mrcs:1.23
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.24
+date	2025.11.10.22.33.39;	author dean;	state Exp;
+branches;
+next	1.23;
+
 1.23
 date	2018.10.03.14.34.13;	author leith;	state Exp;
 branches;
@@ -145,9 +150,9 @@ desc
 @
 
 
-1.23
+1.24
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -165,7 +170,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2016  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -336,6 +341,17 @@ C **********************************************************************
 @
 
 
+1.23
+log
+@email_health_dept
+@
+text
+@d16 1
+a16 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.22
 log
 @added nullify xpo,ypo
diff --git src/RCS/qfact.f,v src/RCS/qfact.f,v
index 7b31d228..0120bfcc 100644
--- src/RCS/qfact.f,v
+++ src/RCS/qfact.f,v
@@ -1,4 +1,4 @@
-head	1.20;
+head	1.21;
 access;
 symbols
 	pre_mrcs:1.20
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.21
+date	2025.11.10.22.33.39;	author dean;	state Exp;
+branches;
+next	1.20;
+
 1.20
 date	2018.10.03.14.34.13;	author leith;	state Exp;
 branches;
@@ -130,9 +135,9 @@ desc
 @
 
 
-1.20
+1.21
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -147,7 +152,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -241,6 +246,17 @@ C       ENTER FOURIER INDEX FOR VECTOR LISTING (0,0=NO LISTING)
 
 
 
+@
+
+
+1.20
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
 @
 
 
diff --git src/RCS/qfact_p.f,v src/RCS/qfact_p.f,v
index c87f3621..46385a13 100644
--- src/RCS/qfact_p.f,v
+++ src/RCS/qfact_p.f,v
@@ -1,4 +1,4 @@
-head	1.17;
+head	1.18;
 access;
 symbols
 	pre_mrcs:1.17
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.18
+date	2025.11.10.22.33.39;	author dean;	state Exp;
+branches;
+next	1.17;
+
 1.17
 date	2018.10.03.14.34.13;	author leith;	state Exp;
 branches;
@@ -115,9 +120,9 @@ desc
 @
 
 
-1.17
+1.18
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -132,7 +137,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -322,6 +327,17 @@ c$omp   parallel do private(i,j)
 @
 
 
+1.17
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.16
 log
 @LEN=MAXNAM
diff --git src/RCS/qnrf.f,v src/RCS/qnrf.f,v
index 6b210c57..b80d8952 100644
--- src/RCS/qnrf.f,v
+++ src/RCS/qnrf.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.33.39;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.13;	author leith;	state Exp;
 branches;
@@ -85,9 +90,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -100,7 +105,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -169,6 +174,17 @@ C***********************************************************************
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @updated
diff --git src/RCS/qphi.f,v src/RCS/qphi.f,v
index 41f8b7df..860cc76f 100644
--- src/RCS/qphi.f,v
+++ src/RCS/qphi.f,v
@@ -1,4 +1,4 @@
-head	1.4;
+head	1.5;
 access;
 symbols
 	pre_mrcs:1.4
@@ -20,6 +20,11 @@ locks; strict;
 comment	@c @;
 
 
+1.5
+date	2025.11.10.22.33.39;	author dean;	state Exp;
+branches;
+next	1.4;
+
 1.4
 date	2018.10.03.14.34.13;	author leith;	state Exp;
 branches;
@@ -46,9 +51,9 @@ desc
 @
 
 
-1.4
+1.5
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -56,7 +61,7 @@ C=**********************************************************************
 C=* From: SPIDER - MODULAR IMAGE PROCESSING SYSTEM                     *
 C=* Copyright (C)2000  M. Radermacher                                  *
 C=*                                                                    *
-C=* Email:  spider@@health.ny.gov                                       *
+C=* Email:  spider@@wadsworth.org                                       *
 C=*                                                                    *
 C=* This program is free software; you can redistribute it and/or      *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -84,6 +89,17 @@ C       QUNATISIZE VARIABLE PHI WITH ITS INCREMENT
 @
 
 
+1.4
+log
+@email_health_dept
+@
+text
+@d6 1
+a6 1
+C=* Email:  spider@@health.ny.gov                                       *
+@
+
+
 1.3
 log
 @GPL License fixed
diff --git src/RCS/qstat.f,v src/RCS/qstat.f,v
index fba455b9..c36e8eba 100644
--- src/RCS/qstat.f,v
+++ src/RCS/qstat.f,v
@@ -1,4 +1,4 @@
-head	1.27;
+head	1.30;
 access;
 symbols
 	pre_mrcs:1.25
@@ -24,6 +24,21 @@ locks; strict;
 comment	@c @;
 
 
+1.30
+date	2025.10.16.20.42.59;	author dean;	state Exp;
+branches;
+next	1.29;
+
+1.29
+date	2025.10.16.19.38.33;	author dean;	state Exp;
+branches;
+next	1.28;
+
+1.28
+date	2025.09.26.15.30.02;	author dean;	state Exp;
+branches;
+next	1.27;
+
 1.27
 date	2020.01.08.18.26.14;	author leith;	state Exp;
 branches;
@@ -165,26 +180,27 @@ desc
 @
 
 
-1.27
+1.30
 log
-@commented output
+@call tree, debug outpu altered
 @
 text
 @
 C++*********************************************************************
 C
-C    QSTAT.F           LONG FILE NAMES JAN             89 ArDean Leith
-C                      MODIFIED FOR STACKS             98 ArDean Leith
-C                      ==,NSAM,IMPLICIT                16 ArDean Leith
-C                      (IN HEADER) MSG                 19 ArDean Leith
-C
+C    QSTAT.F           LONG FILE NAMES JAN           1989 ArDean Leith
+C                      MODIFIED FOR STACKS           1998 ArDean Leith
+C                      ==,NSAM,IMPLICIT              2016 ArDean Leith
+C                      (IN HEADER) MSG               2019 ArDean Leith
+C                      DEBUG OUTPUT                  2025 ArDean Leith
+C                      FLOWCHART                     2025 ArDean Leith
 C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2019  Health Research Inc.,                         *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -208,6 +224,41 @@ C                  NX,NY        X & Y DIMENSIONS OF IMAGE
 C                  NZ           Z DIMENSION  OF IMAGE
 C                  NSTACK       STACK/MAXIM INDICATOR
 C
+C     USED BY: FS 
+C     QSTAT
+C        v
+C     OPFILES Uses (E.G. STK@@****)~~9  prompt for filename
+C             '~9' in last 3 char. of prompt accepts extension on filename 
+C        v
+C        ` ->  FILERD  
+C        v      ` ->  ECHONAME 
+C        |
+C        ` ->  FILELIST
+C        v 
+C        |  MRC file:       *.MRC or *.MRCS
+C        ` -> OPFILES_MRC
+C                 |
+C                 |  Templated stack:  **@@STK.MRC
+C                 ` ---> FILGET_AT --> OPFILEC --> OPENFIL_MRC --> OPENFIL_O_MRC C                 |                                            --> OPENFIL_N_MRC
+C                 |
+C                 |  Whole barestack:  @@STK.MRC 
+C                 ` ---> FILGET_AT --> OPFILEC --> OPENFIL_MRC --> OPENFIL_O_MRC
+C                 |                                            --> OPENFIL_N_MRC
+C                 | 
+C                 |  File template:    IMG***.MRC
+C                 ` ---> FILGET_AT --> OPFILEC --> OPENFIL_MRC --> OPENFIL_O_MRC
+C                 |                                            --> OPENFIL_N_MRC
+C                 | 
+C                 |  Simple file:      IMG001.MRC
+C        |        ` -----------------> OPFILEC --> OPENFIL_MRC --> OPENFIL_O_MRC C        |                                                     --> OPENFIL_N_MRC
+C        | 
+C        v
+C      NORM3
+C        ` -> REDLIN
+C        | 
+C        v
+C      REPORTSTAT
+C
 C--*******************************************************************
 
       SUBROUTINE QSTAT(LUN1,LUNM,LUNDOC,LUNXM1)
@@ -225,7 +276,7 @@ C--*******************************************************************
       INTEGER               :: ILIST1(NIMAX)
       INTEGER               :: NILMAX,NLET1,IFORM1,NX1,NY1,NZ1
       INTEGER               :: NDUM,NGOT1,IMG1,IRTFLG
-      INTEGER               :: NXM,NYM,NZM,MAXIMM,ninndx1,npoint
+      INTEGER               :: NXM,NYM,NZM,MAXIMM,npoint
 
       INTEGER               :: ICOMM, MYPID, MPIERR
       INTEGER               :: NSTACK1, IMAMI1, IFORMM, NINDX1, NLET 
@@ -236,6 +287,8 @@ C--*******************************************************************
 
       CALL SET_MPI(ICOMM,MYPID,MPIERR) ! SETS ICOMM AND MYPID
 
+      !write(6,*)' In qstat 0; --------- 0'
+
 C     OPEN INPUT FILE
       NILMAX = NIMAX
       FOUROK = .TRUE.
@@ -246,16 +299,17 @@ C     OPEN INPUT FILE
      &             FOUROK, ILIST1,NILMAX, 
      &             NDUM,NGOT1,IMG1, IRTFLG)
  
-      !write(6,'(a,8i5)')' nstack1,ngot1,img1:',nstack1,ngot1,img1
-      !write(3,'(a,8i5)')' In qstat; ngot,nstack,img:',nstack1,ngot1,img1
-      !write(3,'(a,8i5)')' In qstat; ilist1:',ilist1(1:5)
+      !write(6,*)' In qstat; ilist1:',ilist1(1:5)
+      !write(6,*)' In qstat; ngot1,nstack1,img1:',ngot1,nstack1,img1
+      !write(6,*)' In qstat; irtflg:',irtflg
+
       IF (IRTFLG .NE. 0) RETURN
       
 
       IMAMI1 = IMAMI   ! FROM CMBLOCK
 
       IF (FCHAR(4:4) == 'M') THEN
-C        FIND STATISTICS UNDER A MASKED AREA
+C        FIND STATISTICS UNDER A MASKED AREA -------------------
 
 C        OPEN MASK INPUT FILE
          CALL OPFILEC(0,.TRUE.,FILNAMM,LUNM,'O',IFORMM,
@@ -271,7 +325,7 @@ C        OPEN MASK INPUT FILE
       ISFIRST = .TRUE.
        
       NINDX1  = 1
-      DO                ! LOOP OVER ALL IMAGES/STACKS
+      DO                ! LOOP OVER ALL IMAGES/STACKS -----------
 
         IF (FCHAR(4:4) == 'M') THEN
            CALL NORMM(LUN1,LUNM,NX1,NY1,NZ1,
@@ -294,7 +348,6 @@ C        OPEN MASK INPUT FILE
            CALL NORM3(LUN1,NX1,NY1,NZ1,FMAX,FMIN,AV)
         ENDIF
 
-        !write(3,'(a,8i5)')' In qstat; ngot,nstack,img:',nstack1,ngot1,img1
         CALL REPORTSTAT(NEWCALC, FMIN,FMAX,AV,SIG)
 
 C       OPEN NEXT INPUT FILE, UPDATE NINDX1 
@@ -304,9 +357,13 @@ C       OPEN NEXT INPUT FILE, UPDATE NINDX1
      &                LUN1,    0,  
      &                FILNAM1, 'O',
      &                IMG1,    IRTFLG)
+
+       !write(6,*)' In qstat; ngot1,nstack1,img1: ',ngot1,nstack1,img1
+       !write(6,*)' In qstat; nindx1,irtflg: ',nindx1,irtflg
+ 
         IF (IRTFLG .NE. 0) EXIT      ! ERROR / END OF INPUT STACK
         IMAMI1 = IMAMI
-
+           
       ENDDO
 
 9999  CLOSE(LUN1)
@@ -356,6 +413,86 @@ C     SET VALUES IN LEGACY LOWER REGISTERS
 @
 
 
+1.29
+log
+@debug output altered
+@
+text
+@d4 6
+a9 5
+C    QSTAT.F           LONG FILE NAMES JAN             89 ArDean Leith
+C                      MODIFIED FOR STACKS             98 ArDean Leith
+C                      ==,NSAM,IMPLICIT                16 ArDean Leith
+C                      (IN HEADER) MSG                 19 ArDean Leith
+C                      DEBUG OUTPUT                    25 ArDean Leith
+d39 35
+@
+
+
+1.28
+log
+@debug output commented out
+@
+text
+@d79 3
+a81 3
+      !write(6,*)' In qstat 1; ilist1:',ilist1(1:5)
+      !write(6,*)' In qstat 1; ngot1,nstack1,img1:',ngot1,nstack1,img1
+      !write(6,*)' In qstat 1; irtflg:',irtflg
+d89 1
+a89 1
+C        FIND STATISTICS UNDER A MASKED AREA
+d105 1
+a105 1
+      DO                ! LOOP OVER ALL IMAGES/STACKS
+a127 2
+        !write(6,*)' In qstat 1; ngot1,nstack1,img1:',ngot1,nstack1,img1
+
+a129 3
+        !write(6,*)' In qstat 2; ngot1,nstack1,img1:',ngot1,nstack1,img1
+        !write(6,*)' In qstat 2; nindx1:',nindx1
+
+d138 2
+a139 2
+       !write(6,*)' In qstat 3; ngot1,nstack1,img1: ',ngot1,nstack1,img1
+       !write(6,*)' In qstat 3; nindx1,irtflg: ',nindx1,irtflg
+@
+
+
+1.27
+log
+@commented output
+@
+text
+@d8 1
+a8 1
+C
+d13 1
+a13 1
+C=* Copyright 1985-2019  Health Research Inc.,                         *
+d15 1
+a15 1
+C=* Email: spider@@health.ny.gov                                        *
+d56 1
+a56 1
+      INTEGER               :: NXM,NYM,NZM,MAXIMM,ninndx1,npoint
+d67 2
+d79 4
+a82 3
+      !write(6,'(a,8i5)')' nstack1,ngot1,img1:',nstack1,ngot1,img1
+      !write(3,'(a,8i5)')' In qstat; ngot,nstack,img:',nstack1,ngot1,img1
+      !write(3,'(a,8i5)')' In qstat; ilist1:',ilist1(1:5)
+d128 2
+a129 1
+        !write(3,'(a,8i5)')' In qstat; ngot,nstack,img:',nstack1,ngot1,img1
+d132 3
+d142 4
+d148 1
+a148 1
+
+@
+
+
 1.26
 log
 @IN HEADER msg added to report line
diff --git src/RCS/qstatloc.f,v src/RCS/qstatloc.f,v
index af850250..b63106a4 100644
--- src/RCS/qstatloc.f,v
+++ src/RCS/qstatloc.f,v
@@ -1,4 +1,4 @@
-head	1.3;
+head	1.4;
 access;
 symbols
 	pre_mrcs:1.3
@@ -7,6 +7,11 @@ locks; strict;
 comment	@c @;
 
 
+1.4
+date	2025.11.10.22.33.39;	author dean;	state Exp;
+branches;
+next	1.3;
+
 1.3
 date	2018.10.03.14.34.13;	author leith;	state Exp;
 branches;
@@ -27,9 +32,9 @@ desc
 @@
 
 
-1.3
+1.4
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -43,7 +48,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -226,6 +231,17 @@ C       OPEN NEXT INPUT FILE, UPDATE NINDX
 @
 
 
+1.3
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.2
 log
 @PERMAX = 100.0 * F
diff --git src/RCS/qtheta.f,v src/RCS/qtheta.f,v
index 850c23a6..15d11eaf 100644
--- src/RCS/qtheta.f,v
+++ src/RCS/qtheta.f,v
@@ -1,4 +1,4 @@
-head	1.4;
+head	1.5;
 access;
 symbols
 	pre_mrcs:1.4
@@ -20,6 +20,11 @@ locks; strict;
 comment	@c @;
 
 
+1.5
+date	2025.11.10.22.33.39;	author dean;	state Exp;
+branches;
+next	1.4;
+
 1.4
 date	2018.10.03.14.34.13;	author leith;	state Exp;
 branches;
@@ -46,9 +51,9 @@ desc
 @
 
 
-1.4
+1.5
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -57,7 +62,7 @@ C=**********************************************************************
 C=* From: SPIDER - MODULAR IMAGE PROCESSING SYSTEM                     *
 C=* Copyright (C)2000  M. Radermacher                                  *
 C=*                                                                    *
-C=* Email:  spider@@health.ny.gov                                       *
+C=* Email:  spider@@wadsworth.org                                       *
 C=*                                                                    *
 C=* This program is free software; you can redistribute it and/or      *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -93,6 +98,17 @@ C       QUANTISIZED PHI
 @
 
 
+1.4
+log
+@email_health_dept
+@
+text
+@d7 1
+a7 1
+C=* Email:  spider@@health.ny.gov                                       *
+@
+
+
 1.3
 log
 @GPL License fixed
diff --git src/RCS/quadri.f,v src/RCS/quadri.f,v
index 321c3312..c95e728a 100644
--- src/RCS/quadri.f,v
+++ src/RCS/quadri.f,v
@@ -1,4 +1,4 @@
-head	1.17;
+head	1.18;
 access;
 symbols
 	pre_mrcs:1.17
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.18
+date	2025.11.10.22.33.40;	author dean;	state Exp;
+branches;
+next	1.17;
+
 1.17
 date	2018.10.03.14.34.13;	author leith;	state Exp;
 branches;
@@ -115,9 +120,9 @@ desc
 @
 
 
-1.17
+1.18
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -132,7 +137,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2012  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -475,6 +480,17 @@ c                INSIDE BOUNDARIES OF OUTPUT IMAGE
 @
 
 
+1.17
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.16
 log
 @added: QUADRI_PAD    NSAM --> NX
diff --git src/RCS/quadri_q.f,v src/RCS/quadri_q.f,v
index 309d8389..ed29ae47 100644
--- src/RCS/quadri_q.f,v
+++ src/RCS/quadri_q.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.33.40;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.13;	author leith;	state Exp;
 branches;
@@ -84,9 +89,9 @@ desc
 @@
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -99,7 +104,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -235,6 +240,17 @@ C     HXC & HYC ARE EITHER 1 OR -1
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @GPL_2010
diff --git src/RCS/radav.f,v src/RCS/radav.f,v
index c6c27a8a..07df41fc 100644
--- src/RCS/radav.f,v
+++ src/RCS/radav.f,v
@@ -1,4 +1,4 @@
-head	1.19;
+head	1.20;
 access;
 symbols
 	pre_mrcs:1.19
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.20
+date	2025.11.10.22.33.40;	author dean;	state Exp;
+branches;
+next	1.19;
+
 1.19
 date	2018.10.03.14.34.13;	author leith;	state Exp;
 branches;
@@ -125,9 +130,9 @@ desc
 @
 
 
-1.19
+1.20
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -141,7 +146,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2013  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -275,6 +280,17 @@ C        SPATIAL FREQ.
 @
 
 
+1.19
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.18
 log
 @added half image options
diff --git src/RCS/radavi.f,v src/RCS/radavi.f,v
index 51688ae5..f0136ac4 100644
--- src/RCS/radavi.f,v
+++ src/RCS/radavi.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.33.40;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.13;	author leith;	state Exp;
 branches;
@@ -85,9 +90,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -100,7 +105,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -160,6 +165,17 @@ C         AVERAGE
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @GPL_2010
diff --git src/RCS/ramp_p.f,v src/RCS/ramp_p.f,v
index aa6aa5c5..e4f652ad 100644
--- src/RCS/ramp_p.f,v
+++ src/RCS/ramp_p.f,v
@@ -1,4 +1,4 @@
-head	1.15;
+head	1.16;
 access;
 symbols
 	pre_mrcs:1.15
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.16
+date	2025.11.10.22.33.40;	author dean;	state Exp;
+branches;
+next	1.15;
+
 1.15
 date	2018.10.03.14.34.13;	author leith;	state Exp;
 branches;
@@ -105,9 +110,9 @@ desc
 @
 
 
-1.15
+1.16
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -120,7 +125,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -532,6 +537,17 @@ C     PLANE : Z = AX + BY + C
 
 
 
+@
+
+
+1.15
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
 @
 
 
diff --git src/RCS/rand_p.f,v src/RCS/rand_p.f,v
index 6d7d1d12..8ef35afa 100644
--- src/RCS/rand_p.f,v
+++ src/RCS/rand_p.f,v
@@ -1,4 +1,4 @@
-head	1.7;
+head	1.8;
 access;
 symbols
 	pre_mrcs:1.7
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.8
+date	2025.11.10.22.33.40;	author dean;	state Exp;
+branches;
+next	1.7;
+
 1.7
 date	2018.10.03.14.34.13;	author leith;	state Exp;
 branches;
@@ -65,9 +70,9 @@ desc
 @
 
 
-1.7
+1.8
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -80,7 +85,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -109,6 +114,17 @@ C       RANDOM NUMBER GENERATOR
 @
 
 
+1.7
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.6
 log
 @GPL_2010
diff --git src/RCS/rann.f,v src/RCS/rann.f,v
index 23a9c9f7..843d91e3 100644
--- src/RCS/rann.f,v
+++ src/RCS/rann.f,v
@@ -1,4 +1,4 @@
-head	1.12;
+head	1.13;
 access;
 symbols
 	pre_mrcs:1.12
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.13
+date	2025.11.10.22.33.40;	author dean;	state Exp;
+branches;
+next	1.12;
+
 1.12
 date	2018.10.03.14.34.13;	author leith;	state Exp;
 branches;
@@ -90,9 +95,9 @@ desc
 @
 
 
-1.12
+1.13
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -105,7 +110,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -133,6 +138,17 @@ C***********************************************************************
 @
 
 
+1.12
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.11
 log
 @GPL_2010
diff --git src/RCS/rathin.f,v src/RCS/rathin.f,v
index 7aee984c..dc0cb641 100644
--- src/RCS/rathin.f,v
+++ src/RCS/rathin.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.33.40;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.13;	author leith;	state Exp;
 branches;
@@ -80,9 +85,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -97,7 +102,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -249,6 +254,17 @@ C            CHECK NUMBER OF ITERATIONS
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @GPL_2010
diff --git src/RCS/rawtospider.f,v src/RCS/rawtospider.f,v
index 81c95613..bd4d4378 100644
--- src/RCS/rawtospider.f,v
+++ src/RCS/rawtospider.f,v
@@ -1,4 +1,4 @@
-head	1.66;
+head	1.67;
 access;
 symbols
 	pre_mrcs:1.66
@@ -25,6 +25,11 @@ locks; strict;
 comment	@c @;
 
 
+1.67
+date	2025.11.10.22.33.58;	author dean;	state Exp;
+branches;
+next	1.66;
+
 1.66
 date	2018.10.03.14.34.13;	author leith;	state Exp;
 branches;
@@ -361,9 +366,9 @@ desc
 @
 
 
-1.66
+1.67
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -425,6 +430,7 @@ C--*********************************************************************
  
        NULL = CHAR(0)
 
+       !write(6,*) '  in rawtospider, luns:',lunold,lunnew
 C      GET FILENAME FOR EXISTING RAW IMAGE FILE
        CALL FILERD(FILOLD,NLET,DATEXC,'EXISTING RAW~9',IRTFLG)
        IF (IRTFLG .NE. 0) RETURN
@@ -505,6 +511,9 @@ C      OPEN RAW FILE AS DIRECT ACCESS, UNFORMATTED REC.
      &                   ' ',.TRUE.,IRTFLG)
        IF (IRTFLG .NE. 0) GOTO 9999
 
+       !write(6,*) '  in rawtospider, mode,modea:',mode,modea
+
+
        IF (MODE .EQ. 8) THEN
 C         FOR 8 BIT RAW INTEGER INPUT 
           CALL RAW8TOSPI(LUNOLD,LUNNEW,NSAM,NPIX8,IOFFSET,.TRUE.,
@@ -1198,6 +1207,16 @@ C     SET NO ERROR FLAG
 @
 
 
+1.66
+log
+@email_health_dept
+@
+text
+@d60 1
+d140 3
+@
+
+
 1.65
 log
 @enter
diff --git src/RCS/rcnv2_p.f,v src/RCS/rcnv2_p.f,v
index 3ebec8d5..a486f6eb 100644
--- src/RCS/rcnv2_p.f,v
+++ src/RCS/rcnv2_p.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.33.40;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.13;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -91,7 +96,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -178,6 +183,17 @@ C
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/rcnv3_p.f,v src/RCS/rcnv3_p.f,v
index da4471b3..dfd48f10 100644
--- src/RCS/rcnv3_p.f,v
+++ src/RCS/rcnv3_p.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.33.40;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.13;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -91,7 +96,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -222,6 +227,17 @@ C
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/rconv.f,v src/RCS/rconv.f,v
index 756d3603..0369717e 100644
--- src/RCS/rconv.f,v
+++ src/RCS/rconv.f,v
@@ -1,4 +1,4 @@
-head	1.18;
+head	1.19;
 access;
 symbols
 	pre_mrcs:1.18
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.19
+date	2025.11.10.22.33.40;	author dean;	state Exp;
+branches;
+next	1.18;
+
 1.18
 date	2018.10.03.14.34.13;	author leith;	state Exp;
 branches;
@@ -120,9 +125,9 @@ desc
 @
 
 
-1.18
+1.19
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -137,7 +142,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -367,6 +372,17 @@ C        WRITE OUT PSF FOR VERIFICATION
 @
 
 
+1.18
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.17
 log
 @enter
diff --git src/RCS/rctfone.f,v src/RCS/rctfone.f,v
index 2b089934..d42fc44d 100644
--- src/RCS/rctfone.f,v
+++ src/RCS/rctfone.f,v
@@ -1,4 +1,4 @@
-head	1.3;
+head	1.4;
 access;
 symbols
 	pre_mrcs:1.3
@@ -8,6 +8,11 @@ locks; strict;
 comment	@c @;
 
 
+1.4
+date	2025.11.10.22.33.40;	author dean;	state Exp;
+branches;
+next	1.3;
+
 1.3
 date	2018.10.03.14.34.13;	author leith;	state Exp;
 branches;
@@ -28,9 +33,9 @@ desc
 @@
 
 
-1.3
+1.4
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -42,7 +47,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -273,6 +278,17 @@ C--*********************************************************************
 @
 
 
+1.3
+log
+@email_health_dept
+@
+text
+@d10 1
+a10 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.2
 log
 @==, prompts .
diff --git src/RCS/rctfss.f,v src/RCS/rctfss.f,v
index fe566cc1..de055113 100644
--- src/RCS/rctfss.f,v
+++ src/RCS/rctfss.f,v
@@ -1,4 +1,4 @@
-head	1.22;
+head	1.23;
 access;
 symbols
 	pre_mrcs:1.22
@@ -23,6 +23,11 @@ locks; strict;
 comment	@c @;
 
 
+1.23
+date	2025.11.10.22.33.40;	author dean;	state Exp;
+branches;
+next	1.22;
+
 1.22
 date	2018.10.03.14.34.13;	author leith;	state Exp;
 branches;
@@ -139,9 +144,9 @@ desc
 @
 
 
-1.22
+1.23
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -157,7 +162,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2012  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -462,6 +467,17 @@ C           READS CTF FOR THIS VOLUME
 @
 
 
+1.22
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.21
 log
 @==,  error msgs,
diff --git src/RCS/rdclus.f,v src/RCS/rdclus.f,v
index cfb32b7e..f7894f88 100644
--- src/RCS/rdclus.f,v
+++ src/RCS/rdclus.f,v
@@ -1,4 +1,4 @@
-head	1.24;
+head	1.25;
 access;
 symbols
 	pre_mrcs:1.24
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.25
+date	2025.11.10.22.33.40;	author dean;	state Exp;
+branches;
+next	1.24;
+
 1.24
 date	2018.10.03.14.34.13;	author leith;	state Exp;
 branches;
@@ -150,9 +155,9 @@ desc
 @
 
 
-1.24
+1.25
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -167,7 +172,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -269,6 +274,17 @@ C          KEY        = IMAGE NUMBER
 @
 
 
+1.24
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.23
 log
 @enter
diff --git src/RCS/rddocn.f,v src/RCS/rddocn.f,v
index 15c7f609..0377a7ca 100644
--- src/RCS/rddocn.f,v
+++ src/RCS/rddocn.f,v
@@ -1,4 +1,4 @@
-head	1.20;
+head	1.21;
 access;
 symbols
 	pre_mrcs:1.20
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.21
+date	2025.11.10.22.33.40;	author dean;	state Exp;
+branches;
+next	1.20;
+
 1.20
 date	2018.10.03.14.34.14;	author leith;	state Exp;
 branches;
@@ -130,9 +135,9 @@ desc
 @
 
 
-1.20
+1.21
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -149,7 +154,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -286,6 +291,17 @@ C          SET OPERATION LINE REGISTERS TO MAXKEYS, MAXCOLS, & KEYUSED
 @
 
 
+1.20
+log
+@email_health_dept
+@
+text
+@d15 1
+a15 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.19
 log
 @GPL_2010
diff --git src/RCS/rdpa.f,v src/RCS/rdpa.f,v
index 47d0fb47..3f87b5fc 100644
--- src/RCS/rdpa.f,v
+++ src/RCS/rdpa.f,v
@@ -1,4 +1,4 @@
-head	1.14;
+head	1.15;
 access;
 symbols
 	pre_mrcs:1.14
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.15
+date	2025.11.10.22.33.40;	author dean;	state Exp;
+branches;
+next	1.14;
+
 1.14
 date	2018.10.03.14.34.14;	author leith;	state Exp;
 branches;
@@ -100,9 +105,9 @@ desc
 @
 
 
-1.14
+1.15
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -116,7 +121,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -172,6 +177,17 @@ C***********************************************************************
 @
 
 
+1.14
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.13
 log
 @nout formatting
diff --git src/RCS/rdpr.f,v src/RCS/rdpr.f,v
index 03ab4869..28902557 100644
--- src/RCS/rdpr.f,v
+++ src/RCS/rdpr.f,v
@@ -1,4 +1,4 @@
-head	1.85;
+head	1.87;
 access;
 symbols
 	pre_mrcs:1.85
@@ -25,6 +25,16 @@ locks; strict;
 comment	@c @;
 
 
+1.87
+date	2025.10.25.15.24.30;	author dean;	state Exp;
+branches;
+next	1.86;
+
+1.86
+date	2025.10.21.19.29.08;	author dean;	state Exp;
+branches;
+next	1.85;
+
 1.85
 date	2018.10.03.14.34.14;	author leith;	state Exp;
 branches;
@@ -456,53 +466,55 @@ desc
 @
 
 
-1.85
+1.87
 log
-@email_health_dept
+@#undef SP_DBUGIO
 @
 text
 @
 C++*********************************************************************
 C
-C  RDPR.F -- CREATED 2/8/90 ARDEAN LEITH 
-C	  -- ADD ON-LINE HELP                3/29/93 MAHIEDDINE LADJADJ  
-C         -- CONVERTED FROM READCH                  DEC 96 ARDEAN LEITH
-C         -- F90 CHANGES                            OCT 97 ARDEAN LEITH
-C         -- STRIPS COMMENT                         AUG 99 ARDEAN LEITH
-C         -- LUNDONOW ADDED                         OCT 99 ARDEAN LEITH
-C         -- TRAILING BLANKS IN COMMENT REMOVED     NOV 99 ARDEAN LEITH
-C         -- PUT IN <1> VARIABLE HANDLING           SEP 00 ARDEAN LEITH
-C         -- MULTIPLE VARIABLE SUBSTITUTION         JAN 01 ARDEAN LEITH
-C         -- USED PROC_GETLINE                      JAN 01 ARDEAN LEITH
-C         -- FLAG FOR ; OK                          MAR 01 ARDEAN LEITH
-C         -- ADDED FILNAMSUB                        APR 01 ARDEAN LEITH
-C         -- ADDED VERBOSE FOR ;                    APR 01 ARDEAN LEITH
-C         -- DELAYED PROMPT FOR .NOT. VERBOSE       JUN 01 ARDEAN LEITH
-C         -- MOVED SSUPCASE LATER                   SEP 01 ARDEAN LEITH
-C         -- NO PROMPT FOR .OP COMMENT LINES        MAR 02 ARDEAN LEITH
-C         -- SYMPAR REWRITTEN                       JUN 02 ARDEAN LEITH
-C         -- NO SYMPAR FOR 'RR'                     AUG 02 ARDEAN LEITH
-C         -- '[]' --> '<>'                          SEP 02 ARDEAN LEITH
-C         -- PARAMETERS CHANGED                     APR 05 ARDEAN LEITH
-C         -- [] DEFAULT FOR VARIABLES               OCT 05 ARDEAN LEITH
-C         -- NDOLINE                                MAY 07 ARDEAN LEITH
-C         -- ?prompt?[  FR BUG                      JUN 07 ARDEAN LEITH
-C         -- REMOVED IMCx33 OBSOLETE SYNTAX         JUN 09 ARDEAN LEITH
-C	  -- REMOVED ON-LINE HELP                   AUG 09 ARDEAN LEITH  
-C         -- $DATEXT x11 BUG                        AUG 09 ARDEAN LEITH
-C         -- '@@@@' SUPPORT                           NOV 09 ARDEAN LEITH
-C         -- NDOLINE                                NOV 09 ARDEAN LEITH
-C         -- VMS COMMAND DOES NOT <> --> []         SEP 10 ARDEAN LEITH
-C         -- ! COMMENT DELIMITER                    DEC 11 ARDEAN LEITH
-C         -- RECURSIVE FILNAMSUB                    MAR 12 ARDEAN LEITH
-C         -- IRTFLG 654321                          MAR 12 ARDEAN LEITH
+C  RDPR.F -- CREATED 2/8/90 ArDean Leith 
+C	  -- ADD ON-LINE HELP               3/29/93 Mahieddine Ladjadj 
+C         -- CONVERTED FROM READCH                 DEC 96 ArDean Leith
+C         -- F90 CHANGES                           OCT 97 ArDean Leith
+C         -- STRIPS COMMENT                        AUG 99 ArDean Leith
+C         -- LUNDONOW ADDED                        OCT 99 ArDean Leith
+C         -- TRAILING BLANKS IN COMMENT REMOVED    NOV 99 ArDean Leith
+C         -- PUT IN <1> VARIABLE HANDLING          SEP 00 ArDean Leith
+C         -- MULTIPLE VARIABLE SUBSTITUTION        JAN 01 ArDean Leith
+C         -- USED PROC_GETLINE                     JAN 01 ArDean Leith
+C         -- FLAG FOR ; OK                         MAR 01 ArDean Leith
+C         -- ADDED FILNAMSUB                       APR 01 ArDean Leith
+C         -- ADDED VERBOSE FOR ;                   APR 01 ArDean Leith
+C         -- DELAYED PROMPT FOR .NOT. VERBOSE      JUN 01 ArDean Leith
+C         -- MOVED SSUPCASE LATER                  SEP 01 ArDean Leith
+C         -- NO PROMPT FOR .OP COMMENT LINES       MAR 02 ArDean Leith
+C         -- SYMPAR REWRITTEN                      JUN 02 ArDean Leith
+C         -- NO SYMPAR FOR 'RR'                    AUG 02 ArDean Leith
+C         -- '[]' --> '<>'                         SEP 02 ArDean Leith
+C         -- PARAMETERS CHANGED                    APR 05 ArDean Leith
+C         -- [] DEFAULT FOR VARIABLES              OCT 05 ArDean Leith
+C         -- NDOLINE                               MAY 07 ArDean Leith
+C         -- ?prompt?[  FR BUG                     JUN 07 ArDean Leith
+C         -- REMOVED IMCx33 OBSOLETE SYNTAX        JUN 09 ArDean Leith
+C         -- REMOVED ON-LINE HELP                  AUG 09 ArDean Leith 
+C         -- $DATEXT x11 BUG                       AUG 09 ArDean Leith
+C         -- '@@@@' SUPPORT                          NOV 09 ArDean Leith
+C         -- NDOLINE                               NOV 09 ArDean Leith
+C         -- VMS COMMAND DOES NOT <> --> []        SEP 10 ArDean Leith
+C         -- ! COMMENT DELIMITER                   DEC 11 ArDean Leith
+C         -- RECURSIVE FILNAMSUB                   MAR 12 ArDean Leith
+C         -- IRTFLG 654321                         MAR 12 ArDean Leith
+C         -- ADDED DEBUG_IO OUTPUT                 OCT 25 ArDean Leith
+C
 C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2012  Health Research Inc.,                         *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -521,36 +533,37 @@ C
 C  RDPR(PROMPT,NCHAR,ANS,UPPER,WANTSUB,SAYPRMT,SAYANS,ENDATSEMI,IRTFLG)
 C
 C  PURPOSE: OUTPUTS PROMPT
-C           READS AN ALPHANUMERIC STRING FROM STORED PROC. LINE, TERMINAL,
-C              OR PROMPT.
-C           ECHO & SKIP LINES WHICH ONLY CONTAIN A COMMENT AT START OF LINE
+C           READS AN ALPHANUMERIC STRING FROM STORED PROC. LINE,
+C           TERMINAL,  OR PROMPT.
+C           ECHO & SKIP LINES WHICH ONLY CONTAIN A COMMENT AT 
+C           START OF LINE
 C           HANDLES INTERACTIVE HELP
 C           CAN ECHO LINE TO CURRENT INTERACTIVE DO-LOOP IFLE.
-C           CONVERTS OLD @@B01[X11] PROC. ARG. FORMAT TO TO NEW: () ARG.  
+C           CONVERTS OLD @@B01[X11] PROC. ARG. FORMAT TO TO NEW: () ARG.
 C           CONVERTS OLD <> VARIABLE FORMAT TO NEW [] VARIABLE FORMAT
-C           CAN INVOKE VARIABLE SUBSTITUTION FOR [string]. 
+C           CAN INVOKE VARIABLE SUBSTITUTION FOR [string].
 C           CAN CONVERT TO UPPERCASE
 C           CONVERTS OLD X REGISTER TO  [] VARIABLE FORMAT
 C           SUBSTITUTES FOR {***[]} AND ${ENV} STRINGS
-C               
-C           RETURNS NCHAR=LENGTH OF STRING WITHOUT TRAILING BLANKS OR COMMENT. 
+C           RETURNS NCHAR=LENGTH OF STRING WITHOUT TRAILING BLANKS
+C           OR COMMENT.
 C           COMMENT IS LIMITED TO 80 CHAR.
 C           VARIABLE VALUE RESPONSE IS LIMITED TO 160 CHAR.
 C             
 C           REGISTER SUBSTITUTION OCCURS IN RDPRINC
 C            
 C  PARAMETERS:  PROMPT    INPUT PROMPT                     (SENT)
-C               NCHAR     LAST NON_BLANK CHAR IN           (RETURNED)
-C                            ANS RESPONSE BEFORE COMMENT
+C               NCHAR     LAST NON_BLANK CHAR IN ANS       (RETURNED)
+C                         RESPONSE BEFORE COMMENT
 C               ANS       USER RESPONSE                    (RETURNED)
 C               GETANS    READ ANSWER (NOT PROMPT)         (SENT)
 C               UPPER     CONVERT TO UPPERCASE             (SENT)
 C               WANTSUB   WANT SYM. PARAMETER SUBSTITUTION (SENT)
-C                             HERE NOW (USUAL)
+C                         HERE NOW                         (USUAL)
 C               SAYPRMT   ECHO PROMPT TO OUTPUT            (SENT)
 C               SAYANS    ECHO RAW ANSWER TO OUTPUT        (SENT)
 C               ENDATSEMI IGNORE SEMICOLON COMMENT         (SENT) 
-C                            (FOR vms.f)
+C                            (FOR vms.f or SYS)
 C               IRTFLG    RETURN FLAG (0 IS NORMAL)        (RETURNED)
 C
 C  CALLED BY:   RDPRMC -> RDPR -> SUBSYMPAR &  SSUPCAS & FILNAMSUB
@@ -572,7 +585,7 @@ C23456789012345678901234567890123456789012345678901234567890123456789012
 C--*********************************************************************
 
       SUBROUTINE RDPR(PROMPT,NCHAR,ANS,
-     &       GETANS,UPPER,WANTSUB,SAYPRMT,SAYANS,ENDATSEMI,STRIP,IRTFLG)
+     &     GETANS,UPPER,WANTSUB,SAYPRMT,SAYANS,ENDATSEMI,STRIP,IRTFLG)
 
       INCLUDE 'CMBLOCK.INC'
 
@@ -590,11 +603,16 @@ C--*********************************************************************
 
       LEGACYREGS = (IRTFLG .NE. -999)  ! DO NOT CONVERT x**
       ACCEPTCR   = (IRTFLG == 654321)  ! ACCEPT <CR> FOR RDPRI & M
-  
-      IDOL = INDEX(PROMPT,'$') - 1
-      IF (IDOL .LE. 0) IDOL = LEN(PROMPT)
 
+#undef SP_DBUGIO
+
+#if defined (SP_DBUGIO)
+      write(3,*)' Starting rdpr; irtflg,acceptcr: ',irtflg,acceptcr
+#endif
       IRTFLG = 0
+ 
+      IDOL = INDEX(PROMPT,'$') - 1
+      IF (IDOL .LE. 0) IDOL = LEN(PROMPT)
 
 10    CONTINUE
 C     PROMPT OUTPUT IS DELAYED IN BATCH TO IGNORE COMMENT / BLANK LINES
@@ -647,12 +665,18 @@ C     (IF ; IS PROCEEDED BY SPACE MAYBE THE USER INPUT A BLANK??)
       NCHARA  = NCHAR           ! NOTHING BEFORE ; FLAG
       IF (LOCSEMI > 0) NCHARA = lnblnk(ANS(1:LOCSEMI-1))
 
-      !write(6,*) 'rdpr, nchara,locsemi:',nchara,locsemi,acceptcr
-      !write(6,*) 'rdpr, ANS(NCHARA:NCHARA):',ANS(NCHARA:NCHARA),':'
+#if defined (SP_DBUGIO)
+      write(3,*)' In rdpr; nchar,nchara,locsemi: ',nchar,nchara,locsemi
+      if (nchara > 0) then
+        write(3,*) ' In rdpr; ans(nchara:nchara): ',ans(nchara:nchara)
+      endif
+#endif
 
-      IF (ACCEPTCR .AND. 
-     &   (NCHARA == 0 .OR. ANS(NCHARA:NCHARA) == '*') ) THEN
+C     IF (ACCEPTCR .AND. 
+C     &  (NCHARA == 0 .OR. ANS(NCHARA:NCHARA) == '*') ) THEN
+C     kludge for use with gfort debugger if nchara <= 0 Oct 2025
 
+      IF (ACCEPTCR .AND. (NCHARA <= 0)) THEN
 C        ACCEPT <CR> or *  RESPONSE BEFORE COMMENT
          IF (MYPID <= 0 .AND. SAYPRMT .AND. COPT == 'B') THEN
             WRITE(NOUT,95)  PROMPT(1:IDOL),': ',ANS(1:NCHAR)
@@ -660,7 +684,15 @@ C        ACCEPT <CR> or *  RESPONSE BEFORE COMMENT
          ENDIF
          NCHAR  = 0
          IRTFLG = 0
-         !write(6,*) 'rdpr, nchar:',nchar,irtflg
+         RETURN
+
+      ELSEIF (ACCEPTCR .AND. ANS(NCHARA:NCHARA) == '*')  THEN
+C        ACCEPT <CR> or *  RESPONSE BEFORE COMMENT
+         IF (MYPID <= 0 .AND. SAYPRMT .AND. COPT == 'B') THEN
+            WRITE(NOUT,95)  PROMPT(1:IDOL),': ',ANS(1:NCHAR)
+         ENDIF
+         NCHAR  = 0
+         IRTFLG = 0
          RETURN
 
       ELSEIF (LOCSEMI == 1 .AND. ENDATSEMI) THEN
@@ -669,7 +701,7 @@ C        NOTHING BEFORE COMMENT
 C           ECHO COMMENT
             IF (SAYPRMT .AND. COPT == 'B') 
      &          WRITE(NOUT,90,ADVANCE='NO')  PROMPT(1:IDOL)
-	    IF (NOUT .NE. 0)  WRITE(NOUT,91) ANS(1:NCHAR)
+            IF (NOUT .NE. 0)  WRITE(NOUT,91) ANS(1:NCHAR)
 91          FORMAT(' ',A)
          ENDIF
 C        READ ANOTHER INPUT LINE
@@ -725,6 +757,7 @@ C        MUST COPY INPUT LINE TO CURRENT INTERACTIVE DO-LOOP FILE
          WRITE(LUNDONOW,*) ANS(1:NCHAR)
          NDOLINE = NDOLINE + 1
          !write(6,*) ' rdpr lundo: ',ANS(1:NCHAR),':',NDOLINE !!!!
+
       ELSEIF ((COPT == 'I' .AND. NDOLINE > 0)) THEN
          NDOLINE = NDOLINE + 1
          !write(6,*) ' rdpr ndoline: ',ANS(:NCHAR),':',NDOLINE !!!!
@@ -863,7 +896,7 @@ C           PROBABLE REGISTER START x or X
 
 
 
-C      *********************** DECOMMENT ********************************
+C      *********************** DECOMMENT *******************************
 
        SUBROUTINE DECOMMENT(CINPUT,NCHAROUT,LOCSEMI)
 
@@ -890,6 +923,124 @@ C         STRIP COMMENT & TRAILING BLANKS
 @
 
 
+1.86
+log
+@debugio added
+no longer crashes gfort debug for bad char array length
+@
+text
+@d36 1
+a36 1
+C         -- ADEDED DEBUG_IO OUTPUT                OCT 25 ArDean Leith
+d134 2
+d198 1
+a198 1
+      write(3,*) ' In rdpr; ans(nchara:nchara): ',ans(nchara:nchara)
+@
+
+
+1.85
+log
+@email_health_dept
+@
+text
+@d4 34
+a37 32
+C  RDPR.F -- CREATED 2/8/90 ARDEAN LEITH 
+C	  -- ADD ON-LINE HELP                3/29/93 MAHIEDDINE LADJADJ  
+C         -- CONVERTED FROM READCH                  DEC 96 ARDEAN LEITH
+C         -- F90 CHANGES                            OCT 97 ARDEAN LEITH
+C         -- STRIPS COMMENT                         AUG 99 ARDEAN LEITH
+C         -- LUNDONOW ADDED                         OCT 99 ARDEAN LEITH
+C         -- TRAILING BLANKS IN COMMENT REMOVED     NOV 99 ARDEAN LEITH
+C         -- PUT IN <1> VARIABLE HANDLING           SEP 00 ARDEAN LEITH
+C         -- MULTIPLE VARIABLE SUBSTITUTION         JAN 01 ARDEAN LEITH
+C         -- USED PROC_GETLINE                      JAN 01 ARDEAN LEITH
+C         -- FLAG FOR ; OK                          MAR 01 ARDEAN LEITH
+C         -- ADDED FILNAMSUB                        APR 01 ARDEAN LEITH
+C         -- ADDED VERBOSE FOR ;                    APR 01 ARDEAN LEITH
+C         -- DELAYED PROMPT FOR .NOT. VERBOSE       JUN 01 ARDEAN LEITH
+C         -- MOVED SSUPCASE LATER                   SEP 01 ARDEAN LEITH
+C         -- NO PROMPT FOR .OP COMMENT LINES        MAR 02 ARDEAN LEITH
+C         -- SYMPAR REWRITTEN                       JUN 02 ARDEAN LEITH
+C         -- NO SYMPAR FOR 'RR'                     AUG 02 ARDEAN LEITH
+C         -- '[]' --> '<>'                          SEP 02 ARDEAN LEITH
+C         -- PARAMETERS CHANGED                     APR 05 ARDEAN LEITH
+C         -- [] DEFAULT FOR VARIABLES               OCT 05 ARDEAN LEITH
+C         -- NDOLINE                                MAY 07 ARDEAN LEITH
+C         -- ?prompt?[  FR BUG                      JUN 07 ARDEAN LEITH
+C         -- REMOVED IMCx33 OBSOLETE SYNTAX         JUN 09 ARDEAN LEITH
+C	  -- REMOVED ON-LINE HELP                   AUG 09 ARDEAN LEITH  
+C         -- $DATEXT x11 BUG                        AUG 09 ARDEAN LEITH
+C         -- '@@@@' SUPPORT                           NOV 09 ARDEAN LEITH
+C         -- NDOLINE                                NOV 09 ARDEAN LEITH
+C         -- VMS COMMAND DOES NOT <> --> []         SEP 10 ARDEAN LEITH
+C         -- ! COMMENT DELIMITER                    DEC 11 ARDEAN LEITH
+C         -- RECURSIVE FILNAMSUB                    MAR 12 ARDEAN LEITH
+C         -- IRTFLG 654321                          MAR 12 ARDEAN LEITH
+d42 1
+a42 1
+C=* Copyright 1985-2012  Health Research Inc.,                         *
+d44 1
+a44 1
+C=* Email: spider@@health.ny.gov                                        *
+d63 4
+a66 3
+C           READS AN ALPHANUMERIC STRING FROM STORED PROC. LINE, TERMINAL,
+C              OR PROMPT.
+C           ECHO & SKIP LINES WHICH ONLY CONTAIN A COMMENT AT START OF LINE
+d69 1
+a69 1
+C           CONVERTS OLD @@B01[X11] PROC. ARG. FORMAT TO TO NEW: () ARG.  
+d71 1
+a71 1
+C           CAN INVOKE VARIABLE SUBSTITUTION FOR [string]. 
+d75 2
+a76 2
+C               
+C           RETURNS NCHAR=LENGTH OF STRING WITHOUT TRAILING BLANKS OR COMMENT. 
+d83 2
+a84 2
+C               NCHAR     LAST NON_BLANK CHAR IN           (RETURNED)
+C                            ANS RESPONSE BEFORE COMMENT
+d89 1
+a89 1
+C                             HERE NOW (USUAL)
+d93 1
+a93 1
+C                            (FOR vms.f)
+d115 1
+a115 1
+     &       GETANS,UPPER,WANTSUB,SAYPRMT,SAYANS,ENDATSEMI,STRIP,IRTFLG)
+d133 6
+a138 1
+  
+a141 2
+      IRTFLG = 0
+
+d193 10
+a202 2
+      !write(6,*) 'rdpr, nchara,locsemi:',nchara,locsemi,acceptcr
+      !write(6,*) 'rdpr, ANS(NCHARA:NCHARA):',ANS(NCHARA:NCHARA),':'
+d204 9
+a212 2
+      IF (ACCEPTCR .AND. 
+     &   (NCHARA == 0 .OR. ANS(NCHARA:NCHARA) == '*') ) THEN
+d214 1
+a217 1
+95          FORMAT('  ',A,A,A)
+a220 1
+         !write(6,*) 'rdpr, nchar:',nchar,irtflg
+d229 1
+a229 1
+	    IF (NOUT .NE. 0)  WRITE(NOUT,91) ANS(1:NCHAR)
+d285 1
+d424 1
+a424 1
+C      *********************** DECOMMENT ********************************
+@
+
+
 1.84
 log
 @WRITE PROMPT(1:IDOL),': ',ANS(1:NCHAR)
diff --git src/RCS/rdpra.f,v src/RCS/rdpra.f,v
index 68b35dfd..0f8ad413 100644
--- src/RCS/rdpra.f,v
+++ src/RCS/rdpra.f,v
@@ -1,4 +1,4 @@
-head	1.12;
+head	1.13;
 access;
 symbols
 	pre_mrcs:1.12
@@ -15,6 +15,11 @@ locks; strict;
 comment	@c @;
 
 
+1.13
+date	2025.11.10.22.33.40;	author dean;	state Exp;
+branches;
+next	1.12;
+
 1.12
 date	2018.10.03.14.34.14;	author leith;	state Exp;
 branches;
@@ -80,9 +85,9 @@ desc
 @@
 
 
-1.12
+1.13
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -107,7 +112,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2012  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -387,6 +392,17 @@ C     STRIP SEMICOLON DENOTED COMMENT & TRAILING BLANKS
 @
 
 
+1.12
+log
+@email_health_dept
+@
+text
+@d23 1
+a23 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.11
 log
 @==
diff --git src/RCS/rdprai.f,v src/RCS/rdprai.f,v
index 28c6ac44..f3d4d508 100644
--- src/RCS/rdprai.f,v
+++ src/RCS/rdprai.f,v
@@ -1,4 +1,4 @@
-head	1.18;
+head	1.19;
 access;
 symbols
 	pre_mrcs:1.18
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.19
+date	2025.11.10.22.33.40;	author dean;	state Exp;
+branches;
+next	1.18;
+
 1.18
 date	2018.10.03.14.34.14;	author leith;	state Exp;
 branches;
@@ -120,9 +125,9 @@ desc
 @
 
 
-1.18
+1.19
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -140,7 +145,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -219,6 +224,17 @@ C--*********************************************************************
 @
 
 
+1.18
+log
+@email_health_dept
+@
+text
+@d16 1
+a16 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.17
 log
 @ilo ihi unused
diff --git src/RCS/rdpranc.f,v src/RCS/rdpranc.f,v
index be91998e..626089ba 100644
--- src/RCS/rdpranc.f,v
+++ src/RCS/rdpranc.f,v
@@ -1,4 +1,4 @@
-head	1.26;
+head	1.27;
 access;
 symbols
 	pre_mrcs:1.26
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.27
+date	2025.11.10.22.33.41;	author dean;	state Exp;
+branches;
+next	1.26;
+
 1.26
 date	2018.10.03.14.34.14;	author leith;	state Exp;
 branches;
@@ -160,9 +165,9 @@ desc
 @
 
 
-1.26
+1.27
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -184,7 +189,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -469,6 +474,17 @@ c        write (NOUT,*) ' -----------'
 @
 
 
+1.26
+log
+@email_health_dept
+@
+text
+@d20 1
+a20 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.25
 log
 @enter
diff --git src/RCS/rdpri1s.f,v src/RCS/rdpri1s.f,v
index bd5d3424..04ea29bc 100644
--- src/RCS/rdpri1s.f,v
+++ src/RCS/rdpri1s.f,v
@@ -1,4 +1,4 @@
-head	1.7;
+head	1.8;
 access;
 symbols
 	pre_mrcs:1.7
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.8
+date	2025.11.10.22.33.41;	author dean;	state Exp;
+branches;
+next	1.7;
+
 1.7
 date	2018.10.03.14.34.14;	author leith;	state Exp;
 branches;
@@ -64,9 +69,9 @@ desc
 @@
 
 
-1.7
+1.8
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -82,7 +87,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -138,6 +143,17 @@ C     DO NOT ZERO THE RETURNED VALUES (DIFFERENT FROM NORMAL SPIDER METHOD)
 @
 
 
+1.7
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.6
 log
 @GPL_2010
diff --git src/RCS/rdpri2s.f,v src/RCS/rdpri2s.f,v
index 5d55cb1b..3405335e 100644
--- src/RCS/rdpri2s.f,v
+++ src/RCS/rdpri2s.f,v
@@ -1,4 +1,4 @@
-head	1.2;
+head	1.3;
 access;
 symbols
 	pre_mrcs:1.2
@@ -7,6 +7,11 @@ locks; strict;
 comment	@c @;
 
 
+1.3
+date	2025.11.10.22.33.41;	author dean;	state Exp;
+branches;
+next	1.2;
+
 1.2
 date	2018.10.03.14.34.14;	author leith;	state Exp;
 branches;
@@ -22,9 +27,9 @@ desc
 @@
 
 
-1.2
+1.3
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -39,7 +44,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -101,6 +106,17 @@ C     DO NOT ZERO THE RETURNED VALUES (DIFFERENT FROM NORMAL SPIDER METHOD)
 @
 
 
+1.2
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.1
 log
 @Initial revision
diff --git src/RCS/rdpri3s.f,v src/RCS/rdpri3s.f,v
index 2492d6b8..779115de 100644
--- src/RCS/rdpri3s.f,v
+++ src/RCS/rdpri3s.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.33.41;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.14;	author leith;	state Exp;
 branches;
@@ -80,9 +85,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -97,7 +102,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -160,6 +165,17 @@ C     DO NOT ZERO THE RETURNED VALUES (DIFFERENT FROM NORMAL SPIDER METHOD)
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @GPL_2010
diff --git src/RCS/rdprinc.f,v src/RCS/rdprinc.f,v
index 5a2dec5e..2ec69eb6 100644
--- src/RCS/rdprinc.f,v
+++ src/RCS/rdprinc.f,v
@@ -1,4 +1,4 @@
-head	1.32;
+head	1.33;
 access;
 symbols
 	pre_mrcs:1.32
@@ -25,6 +25,11 @@ locks; strict;
 comment	@c @;
 
 
+1.33
+date	2025.11.10.22.33.41;	author dean;	state Exp;
+branches;
+next	1.32;
+
 1.32
 date	2018.10.03.14.34.14;	author leith;	state Exp;
 branches;
@@ -190,9 +195,9 @@ desc
 @@
 
 
-1.32
+1.33
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -213,7 +218,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2012  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -272,6 +277,17 @@ C        COPY THE RETURNED VALUES
 @
 
 
+1.32
+log
+@email_health_dept
+@
+text
+@d19 1
+a19 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.31
 log
 @IRTFLG = 654321  FLAG TO ACCEPT <CR> or *
diff --git src/RCS/rdpris.f,v src/RCS/rdpris.f,v
index 75e7a789..194597f8 100644
--- src/RCS/rdpris.f,v
+++ src/RCS/rdpris.f,v
@@ -1,4 +1,4 @@
-head	1.12;
+head	1.13;
 access;
 symbols
 	pre_mrcs:1.12
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.13
+date	2025.11.10.22.33.41;	author dean;	state Exp;
+branches;
+next	1.12;
+
 1.12
 date	2018.10.03.14.34.14;	author leith;	state Exp;
 branches;
@@ -90,9 +95,9 @@ desc
 @
 
 
-1.12
+1.13
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -107,7 +112,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -167,6 +172,17 @@ C     DO NOT ZERO THE RETURNED VALUES (DIFFERENT FROM NORMAL SPIDER METHOD)
 @
 
 
+1.12
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.11
 log
 @GPL_2010
diff --git src/RCS/rdprm.f,v src/RCS/rdprm.f,v
index 129cc63a..a58a01c5 100644
--- src/RCS/rdprm.f,v
+++ src/RCS/rdprm.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.33.41;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.14;	author leith;	state Exp;
 branches;
@@ -80,9 +85,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -96,7 +101,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -139,6 +144,17 @@ C--*******************************************************************
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @GPL_2010
diff --git src/RCS/rdprm1s.f,v src/RCS/rdprm1s.f,v
index 1c90bc2b..50e67e76 100644
--- src/RCS/rdprm1s.f,v
+++ src/RCS/rdprm1s.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.33.41;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.34.14;	author leith;	state Exp;
 branches;
@@ -70,9 +75,9 @@ desc
 @
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -86,7 +91,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -133,6 +138,17 @@ C--*******************************************************************
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @GPL_2010
diff --git src/RCS/rdprm2.f,v src/RCS/rdprm2.f,v
index adce6cfa..910ac7d1 100644
--- src/RCS/rdprm2.f,v
+++ src/RCS/rdprm2.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.33.41;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.14;	author leith;	state Exp;
 branches;
@@ -80,9 +85,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -96,7 +101,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -140,6 +145,17 @@ C--*********************************************************************
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @GPL_2010
diff --git src/RCS/rdprm2s.f,v src/RCS/rdprm2s.f,v
index 0402032a..0d872426 100644
--- src/RCS/rdprm2s.f,v
+++ src/RCS/rdprm2s.f,v
@@ -1,4 +1,4 @@
-head	1.12;
+head	1.13;
 access;
 symbols
 	pre_mrcs:1.12
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.13
+date	2025.11.10.22.33.41;	author dean;	state Exp;
+branches;
+next	1.12;
+
 1.12
 date	2018.10.03.14.34.14;	author leith;	state Exp;
 branches;
@@ -90,9 +95,9 @@ desc
 @
 
 
-1.12
+1.13
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -106,7 +111,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -154,6 +159,17 @@ C--*******************************************************************
 @
 
 
+1.12
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.11
 log
 @GPL_2010
diff --git src/RCS/rdprm3s.f,v src/RCS/rdprm3s.f,v
index 78f023c4..b9acfa0c 100644
--- src/RCS/rdprm3s.f,v
+++ src/RCS/rdprm3s.f,v
@@ -1,4 +1,4 @@
-head	1.7;
+head	1.8;
 access;
 symbols
 	pre_mrcs:1.7
@@ -23,6 +23,11 @@ locks; strict;
 comment	@c @;
 
 
+1.8
+date	2025.11.10.22.33.41;	author dean;	state Exp;
+branches;
+next	1.7;
+
 1.7
 date	2018.10.03.14.34.14;	author leith;	state Exp;
 branches;
@@ -63,9 +68,9 @@ desc
 @@
 
 
-1.7
+1.8
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -79,7 +84,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -129,6 +134,17 @@ C--*******************************************************************
 @
 
 
+1.7
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.6
 log
 @GPL_2010
diff --git src/RCS/rdprmc.f,v src/RCS/rdprmc.f,v
index 81660e8e..5c094e2b 100644
--- src/RCS/rdprmc.f,v
+++ src/RCS/rdprmc.f,v
@@ -1,4 +1,4 @@
-head	1.35;
+head	1.36;
 access;
 symbols
 	pre_mrcs:1.35
@@ -25,6 +25,11 @@ locks; strict;
 comment	@c @;
 
 
+1.36
+date	2025.10.21.19.21.52;	author dean;	state Exp;
+branches;
+next	1.35;
+
 1.35
 date	2018.10.03.14.34.14;	author leith;	state Exp;
 branches;
@@ -206,36 +211,37 @@ desc
 @
 
 
-1.35
+1.36
 log
-@email_health_dept
+@KLUDGE TO ACCEPT <CR> IN SUBROUTINE DISP BUT NOT TO UPPERCASE
 @
 text
 @
 C++*********************************************************************
 C
-C    RDPRMC.F -- CREATED FROM RDPRMB.F          08/15/89 ARDEAN LEITH
-C                REWRITTEN                       03/4/98 ARDEAN LEITH
-C                LENGTHENED ANST                11/17/00 ARDEAN LEITH
-C                SKIP BLANK LINE ECHO VERBOSE    03/7/02 ARDEAN LEITH
-C                IQ P SPECIAL LINES             06/26/02 ARDEAN LEITH
-C                NLOG                           11/26/03 ARDEAN LEITH
-C                NO INITIAL BLANKS ON ECHO      03/30/05 ARDEAN LEITH
-C                .OPERATION.... BUG             05/25/05 ARDEAN LEITH
-C                RDPR PARAMETERS                04/14/05 ARDEAN LEITH
-C                TO NOUT ALWAYS                 02/21/06 ARDEAN LEITH
-C                IF (FCHAR(1:2) == 'FR'         07/31/06 ARDEAN LEITH
-C                DEBRAKREG                      09/05/06 ARDEAN LEITH
-C                IF (FCHAR(1:4) == 'FR N'       08/28/09 ARDEAN LEITH
-C                NECHO                          09/20/12 ARDEAN LEITH
+C    RDPRMC.F -- CREATED FROM RDPRMB.F          08/15/89 ArDean Leith
+C                REWRITTEN                       03/4/98 ArDean Leith
+C                LENGTHENED ANST                11/17/00 ArDean Leith
+C                SKIP BLANK LINE ECHO VERBOSE    03/7/02 ArDean Leith
+C                IQ P SPECIAL LINES             06/26/02 ArDean Leith
+C                NLOG                           11/26/03 ArDean Leith
+C                NO INITIAL BLANKS ON ECHO      03/30/05 ArDean Leith
+C                .OPERATION.... BUG             05/25/05 ArDean Leith
+C                RDPR PARAMETERS                04/14/05 ArDean Leith
+C                TO NOUT ALWAYS                 02/21/06 ArDean Leith
+C                IF (FCHAR(1:2) == 'FR'         07/31/06 ArDean Leith
+C                DEBRAKREG                      09/05/06 ArDean Leith
+C                IF (FCHAR(1:4) == 'FR N'       08/28/09 ArDean Leith
+C                NECHO                          09/20/12 ArDean Leith
+C                KLUDGE TO ACCEPT <CR> IN DISP  10/20/25 ArDean Leith 
 C
 C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2014  Health Research Inc.,                         *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -253,20 +259,22 @@ C **********************************************************************
 C
 C  RDPRMC(ANS,NCHAR,STRIP,PROMPT,CDUM,IRTFLG)
 C
-C  PURPOSE: READ AN ALPHANUMERIC STRING, CHECK FOR ANY SPECIAL OPERATION,
-C           RETURN STRING MINUS ANY LEADING OR TRAILING BLANKS, AND NUMBER
-C           OF CHARACTERS IN STRING AND A ERROR FLAG.  NORMALLY CONVERTS
-C           INPUT TO UPPER CASE.  STRIPS OFF ANY TRAILING SPIDER COMMENT
+C  PURPOSE: READ AN ALPHANUMERIC STRING, CHECK FOR ANY SPECIAL CHARS
+C           IN AN OPERATION,
+C           RETURN STRING MINUS ANY LEADING OR TRAILING BLANKS, AND
+C           NUMBER OF CHARACTERS IN STRING AND A ERROR FLAG.  
+C           NORMALLY CONVERTS INPUT TO UPPER CASE.  
+C           STRIPS OFF ANY TRAILING SPIDER COMMENT
 C
-C  PARAMETERS:  ANS       ANSWER                                    RET.
-C               NCHAR     NUMBER OF CHARACTERS IN THE ANSWER        RET.
-C               STRIP     LOGICAL FLAG TO STRIP BLANKS FROM ANS    SENT
-C               PROMPT    SOLICITATION MESSAGE                     SENT
-C               CDUM                                             (UNUSED)
-C               IRTFLG    RETURN FLAG                          SENT/RET.
+C  PARAMETERS:  ANS       ANSWER                                   RET.
+C               NCHAR     NUMBER OF CHARACTERS IN THE ANSWER       RET.
+C               STRIP     LOGICAL FLAG TO STRIP BLANKS FROM ANS   SENT
+C               PROMPT    SOLICITATION MESSAGE                    SENT
+C               CDUM      (UNUSED)
+C               IRTFLG    RETURN FLAG                          SENT/RET
 C                           (0 IS NORMAL, -1 IS GOTO PREVIOUS
 C                           QUESTION, 1 IS END-OF_FILE) 
-C                           IRTFLG: -999 ON INPUT
+C                           IRTFLG: -999 -654321 ON INPUT
 C                           DOES NOT CONVERT INPUT TO UPPERCASE
 C
 C  CALLED BY:   VERY MANY SPIDER ROUTINES
@@ -276,7 +284,7 @@ C--*********************************************************************
 
         SUBROUTINE RDPRMC(ANS,NCHAR,STRIP,PROMPT,CDUM,IRTFLG)
 
-	INCLUDE 'CMBLOCK.INC' 
+        INCLUDE 'CMBLOCK.INC' 
 
         CHARACTER(LEN=*)     :: ANS,PROMPT,CDUM
         CHARACTER(LEN=161)   :: ANST
@@ -286,9 +294,23 @@ C--*********************************************************************
         CALL SET_MPI(ICOMM,MYPID,MPIERR) ! SETS ICOMM AND MYPID
 
 C       SEE IF WANT TO KEEP LOWER CASE INPUT UNALTERED
-        GETANS    = .TRUE.
         UPPER     = (IRTFLG .NE. -999)
 
+C       KLUDGE TO ACCEPT <CR> IN SUBROUTINE DISP BUT NOT TO UPPERCASE 
+        IF (IRTFLG .EQ. 654321) THEN
+           UPPER = .FALSE.  ! BUT RETAIN IRTFLG FOR RDPR USE
+
+        ELSE IF (IRTFLG .EQ. -999) THEN
+           UPPER  = .FALSE.
+           IRTFLG = 0
+
+        ELSE
+           UPPER  = .TRUE.
+           IRTFLG = 0
+        ENDIF
+
+        GETANS    = .TRUE.
+
 C       WANT TO SUBSTITUTE FOR VARIABLES NOW?
         WANTSUB   = .TRUE. 
         IF ((FCHAR(1:2) == 'FR' .AND. NALPH <= 2) .OR.
@@ -300,8 +322,6 @@ C       WANT TO SUBSTITUTE FOR VARIABLES NOW?
         SAYANS    = .FALSE.
         ENDATSEMI = .TRUE.
 
-        IRTFLG = 0
-
 C       MOVE BLANKS TO THE ANSWER STRING, NECESSARY FOR SOME SPIDER CODE
         LENA = LEN(ANS)
         ANS(1:LENA) = ' '
@@ -316,7 +336,7 @@ C       COMMENT IN FIRST COL. AND READ ANOTHER INPUT LINE
 C          IF NULL ANSWER STRING, MUST RETURN ZERO LENGTH ANSWER
            IF (MYPID <= 0) THEN
               WRITE(NOUT,*) ' '
-	      IF (NLOG .NE. 0) THEN
+              IF (NLOG .NE. 0) THEN
                  WRITE(NLOG,*) ' '
                  NECHO = NECHO + 1
               ENDIF
@@ -329,7 +349,7 @@ C       SET RETURNED ANSWER, TRUNCATE TO FIT LENGTH OF ANS IN CALL
         IF (NCHAR > 0)   ANS(1:NCHAR) = ANST(1:NCHAR)
 
         NLET = NCHAR
-	IF (.NOT. SILENT .AND. MYPID <= 0) THEN
+        IF (.NOT. SILENT .AND. MYPID <= 0) THEN
            IF (NCHAR > 0) THEN
 C             CONVERT [_x**] BACK TO X** FOR ECHO
               CALL DEBRAKXREG(ANST,NLET)
@@ -350,6 +370,70 @@ C             CONVERT [_x**] BACK TO X** FOR ECHO
 
         IF (ANS(1:1) == '^' .AND. NCHAR == 1) IRTFLG = -1
 
+        END
+@
+
+
+1.35
+log
+@email_health_dept
+@
+text
+@d4 15
+a18 14
+C    RDPRMC.F -- CREATED FROM RDPRMB.F          08/15/89 ARDEAN LEITH
+C                REWRITTEN                       03/4/98 ARDEAN LEITH
+C                LENGTHENED ANST                11/17/00 ARDEAN LEITH
+C                SKIP BLANK LINE ECHO VERBOSE    03/7/02 ARDEAN LEITH
+C                IQ P SPECIAL LINES             06/26/02 ARDEAN LEITH
+C                NLOG                           11/26/03 ARDEAN LEITH
+C                NO INITIAL BLANKS ON ECHO      03/30/05 ARDEAN LEITH
+C                .OPERATION.... BUG             05/25/05 ARDEAN LEITH
+C                RDPR PARAMETERS                04/14/05 ARDEAN LEITH
+C                TO NOUT ALWAYS                 02/21/06 ARDEAN LEITH
+C                IF (FCHAR(1:2) == 'FR'         07/31/06 ARDEAN LEITH
+C                DEBRAKREG                      09/05/06 ARDEAN LEITH
+C                IF (FCHAR(1:4) == 'FR N'       08/28/09 ARDEAN LEITH
+C                NECHO                          09/20/12 ARDEAN LEITH
+d24 1
+a24 1
+C=* Copyright 1985-2014  Health Research Inc.,                         *
+d26 1
+a26 1
+C=* Email: spider@@health.ny.gov                                        *
+d44 13
+a56 11
+C  PURPOSE: READ AN ALPHANUMERIC STRING, CHECK FOR ANY SPECIAL OPERATION,
+C           RETURN STRING MINUS ANY LEADING OR TRAILING BLANKS, AND NUMBER
+C           OF CHARACTERS IN STRING AND A ERROR FLAG.  NORMALLY CONVERTS
+C           INPUT TO UPPER CASE.  STRIPS OFF ANY TRAILING SPIDER COMMENT
+C
+C  PARAMETERS:  ANS       ANSWER                                    RET.
+C               NCHAR     NUMBER OF CHARACTERS IN THE ANSWER        RET.
+C               STRIP     LOGICAL FLAG TO STRIP BLANKS FROM ANS    SENT
+C               PROMPT    SOLICITATION MESSAGE                     SENT
+C               CDUM                                             (UNUSED)
+C               IRTFLG    RETURN FLAG                          SENT/RET.
+d59 1
+a59 1
+C                           IRTFLG: -999 ON INPUT
+d69 1
+a69 1
+	INCLUDE 'CMBLOCK.INC' 
+d79 15
+a94 1
+        UPPER     = (IRTFLG .NE. -999)
+a106 2
+        IRTFLG = 0
+
+d121 1
+a121 1
+	      IF (NLOG .NE. 0) THEN
+d134 1
+a134 1
+	IF (.NOT. SILENT .AND. MYPID <= 0) THEN
+d155 1
+a155 1
 	END
 @
 
diff --git src/RCS/rdprmi.f,v src/RCS/rdprmi.f,v
index 7db6e67a..40ac6086 100644
--- src/RCS/rdprmi.f,v
+++ src/RCS/rdprmi.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.33.41;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.14;	author leith;	state Exp;
 branches;
@@ -80,9 +85,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -96,7 +101,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -144,6 +149,17 @@ C--*******************************************************************
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @GPL_2010
diff --git src/RCS/rdprop.f,v src/RCS/rdprop.f,v
index 240d1220..5d3b6c8c 100644
--- src/RCS/rdprop.f,v
+++ src/RCS/rdprop.f,v
@@ -1,4 +1,4 @@
-head	1.18;
+head	1.19;
 access;
 symbols
 	pre_mrcs:1.18
@@ -15,6 +15,11 @@ locks; strict;
 comment	@c @;
 
 
+1.19
+date	2025.10.03.14.44.28;	author dean;	state Exp;
+branches;
+next	1.18;
+
 1.18
 date	2018.10.03.14.34.14;	author leith;	state Exp;
 branches;
@@ -110,9 +115,9 @@ desc
 @@
 
 
-1.18
+1.19
 log
-@email_health_dept
+@ANS(IGOBRAK:IGOBRAK) LONGTERM BUG fixed
 @
 text
 @
@@ -127,14 +132,16 @@ C              @@*** VAR INIT BUG                  NOV 2009 ARDEAN LEITH
 C              NECHO                              SEP 2012 ARDEAN LEITH
 C              ! COMMENT BUG                      DEC 2013 ARDEAN LEITH
 C              NO LOAD [] FOR @@ LINE              MAY 2014 ARDEAN LEITH
-C              REG_GET_SEL aCESSES GLOBAL BUG     APR 2015 ARDEAN LEITH
+C              REG_GET_SEL ACESSES GLOBAL BUG     APR 2015 ARDEAN LEITH
+C              ANS(IGOBRAK:IGOBRAK) LONGTERM BUG  APR 2025 ARDEAN LEITH
+C
 C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2015  Health Research Inc.,                         *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -331,28 +338,43 @@ C        MUST COPY INPUT LINE TO CURRENT INTERACTIVE DO-LOOP FILE
          WRITE(LUNDONOW,*) ANS(1:NCHAR)
          NDOLINE = NDOLINE + 1
          !write(6,*) ' rdprop lundo: ',ANS(:NCHAR),':',NDOLINE !!!!
+
       ELSEIF ((COPT == 'I' .AND. NDOLINE > 0)) THEN
          NDOLINE = NDOLINE + 1
          !write(6,*) ' rdprop ndoline: ',ANS(:NCHAR),':',NDOLINE !!!!
       ENDIF
 
 C     CONVERT OLD @@b01[..] ARG. FORMAT TO TO NEW: () ARG.  FORMAT
+      !write(3,*) ' In rdprop; nq12:  ', nq12
+      !write(3,*) ' In rdprop; nchar: ', nchar
+      !write(3,*) ' In rdprop; ans(:nchar): ', ans(:nchar)
+
       IPAT   = INDEX(ANS(1:NCHAR), '@@') 
-      IQUO   = SCAN(ANS(1:NCHAR), NQ12) 
+      IQUO   = SCAN( ANS(1:NCHAR), NQ12) 
+      !write(3,*) ' rdprop ipat,iqo: ', ipat,iquo
+
       IF (IPAT == 1 .AND. IQUO == 0) THEN
-         IGOBRAK  = SCAN(ANS(1:NCHAR), '([')         ! ( first is ok
-         IF (IGOBRAK > IPAT .AND. ANS(IGOBRAK:IGOBRAK) == '[')THEN
-C           PROBABLY USES OLD @@b01[] PROC. ARG. FORMAT 
-            IENDBRAK = INDEX(ANS(1:NCHAR), ']',.TRUE.)
-            CALL GETNEXTTOKEN2(ANS(IGOBRAK:IENDBRAK),1,IGO,IEND)
-            INOT = VERIFY(ANS(IGOBRAK+IGO-1:IEND+IGOBRAK-1), 
-     &                    '[xX0123456789]')
-            IF (INOT == 0) THEN
-C              PROBABLY  @@b01[x11...,], [[var]...
-               ANS(IGOBRAK:IGOBRAK)   = '(' 
-               ANS(IENDBRAK:IENDBRAK) = ')'
-            ENDIF
+         IGOBRAK = SCAN(ANS(1:NCHAR), '([')         ! ( first is ok
+
+         !write(3,*) ' In rdprop; igobrak,ipat: ', igobrak,ipat
+         IF (IGOBRAK > 0 ) THEN 
+           !write(3,*) ' In rdprop; ans(igobrak:igobrak):',
+           !&                       ans(igobrak:igobrak)
+
+           IF (IGOBRAK > IPAT .AND. ANS(IGOBRAK:IGOBRAK) == '[')THEN
+C             PROBABLY USES OLD @@b01[] PROC. ARG. FORMAT 
+              IENDBRAK = INDEX(ANS(1:NCHAR), ']',.TRUE.)
+              CALL GETNEXTTOKEN2(ANS(IGOBRAK:IENDBRAK),1,IGO,IEND)
+              INOT = VERIFY(ANS(IGOBRAK+IGO-1:IEND+IGOBRAK-1), 
+     &                      '[xX0123456789]')
+              IF (INOT == 0) THEN
+C                PROBABLY  @@b01[x11...,], [[var]...
+                 ANS(IGOBRAK:IGOBRAK)   = '(' 
+                 ANS(IENDBRAK:IENDBRAK) = ')'
+              ENDIF
+           ENDIF
          ENDIF
+
       ENDIF
             
 C     SEE IF NEED TO CONVERT OLD x11 REGISTER FORMAT TO [_11]
@@ -467,6 +489,43 @@ c        write(6,*) ' after de_reg: ',CINPUT(1:NCHAR)
 
 
 
+@
+
+
+1.18
+log
+@email_health_dept
+@
+text
+@d13 3
+a15 1
+C              REG_GET_SEL aCESSES GLOBAL BUG     APR 2015 ARDEAN LEITH
+d20 1
+a20 1
+C=* Copyright 1985-2015  Health Research Inc.,                         *
+d22 1
+a22 1
+C=* Email: spider@@health.ny.gov                                        *
+d219 1
+d226 4
+d231 3
+a233 1
+      IQUO   = SCAN(ANS(1:NCHAR), NQ12) 
+d235 19
+a253 12
+         IGOBRAK  = SCAN(ANS(1:NCHAR), '([')         ! ( first is ok
+         IF (IGOBRAK > IPAT .AND. ANS(IGOBRAK:IGOBRAK) == '[')THEN
+C           PROBABLY USES OLD @@b01[] PROC. ARG. FORMAT 
+            IENDBRAK = INDEX(ANS(1:NCHAR), ']',.TRUE.)
+            CALL GETNEXTTOKEN2(ANS(IGOBRAK:IENDBRAK),1,IGO,IEND)
+            INOT = VERIFY(ANS(IGOBRAK+IGO-1:IEND+IGOBRAK-1), 
+     &                    '[xX0123456789]')
+            IF (INOT == 0) THEN
+C              PROBABLY  @@b01[x11...,], [[var]...
+               ANS(IGOBRAK:IGOBRAK)   = '(' 
+               ANS(IENDBRAK:IENDBRAK) = ')'
+            ENDIF
+d255 1
 @
 
 
diff --git src/RCS/rdsl_p.f,v src/RCS/rdsl_p.f,v
index bbfd9a4f..496a3f24 100644
--- src/RCS/rdsl_p.f,v
+++ src/RCS/rdsl_p.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.33.41;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.34.14;	author leith;	state Exp;
 branches;
@@ -70,9 +75,9 @@ desc
 @
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -85,7 +90,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -122,6 +127,17 @@ C***********************************************************************
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @GPL_2010
diff --git src/RCS/readpdb.f,v src/RCS/readpdb.f,v
index 0e72b34f..2b2fcff0 100644
--- src/RCS/readpdb.f,v
+++ src/RCS/readpdb.f,v
@@ -1,4 +1,4 @@
-head	1.29;
+head	1.30;
 access;
 symbols
 	pre_mrcs:1.29
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.30
+date	2025.11.10.22.33.41;	author dean;	state Exp;
+branches;
+next	1.29;
+
 1.29
 date	2018.10.03.14.34.14;	author leith;	state Exp;
 branches;
@@ -175,9 +180,9 @@ desc
 @
 
 
-1.29
+1.30
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -191,7 +196,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2012  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -518,6 +523,17 @@ C            TRILINEAR INTERPOLATION
 @
 
 
+1.29
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.28
 log
 @better size guidance, prompts
diff --git src/RCS/readrq.f,v src/RCS/readrq.f,v
index bcd5cd87..ae5ad392 100644
--- src/RCS/readrq.f,v
+++ src/RCS/readrq.f,v
@@ -1,4 +1,4 @@
-head	1.26;
+head	1.27;
 access;
 symbols
 	pre_mrcs:1.26
@@ -25,6 +25,11 @@ locks; strict;
 comment	@c @;
 
 
+1.27
+date	2025.11.10.22.33.41;	author dean;	state Exp;
+branches;
+next	1.26;
+
 1.26
 date	2018.10.03.14.34.14;	author leith;	state Exp;
 branches;
@@ -161,9 +166,9 @@ desc
 @
 
 
-1.26
+1.27
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++************************************************************ 10/11/79
@@ -186,7 +191,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -287,6 +292,17 @@ c     write(6,*) ' values(1):',values(1)
 @
 
 
+1.26
+log
+@email_health_dept
+@
+text
+@d21 1
+a21 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.25
 log
 @MAXNVAL TO 150 rewrite
diff --git src/RCS/reads.f,v src/RCS/reads.f,v
index 2e7c829d..8e949cf7 100644
--- src/RCS/reads.f,v
+++ src/RCS/reads.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.33.41;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.34.14;	author leith;	state Exp;
 branches;
@@ -70,9 +75,9 @@ desc
 @
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -86,7 +91,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -123,6 +128,17 @@ C***********************************************************************
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @GPL_2010
diff --git src/RCS/readv.f,v src/RCS/readv.f,v
index 90295ed4..760494cd 100644
--- src/RCS/readv.f,v
+++ src/RCS/readv.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -22,6 +22,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.33.42;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.14;	author leith;	state Exp;
 branches;
@@ -73,9 +78,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -87,7 +92,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -148,6 +153,17 @@ C         THE SAME AS READV, BUT NO MPI_BCAST IN REDLIN1P
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d10 1
+a10 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @comments
diff --git src/RCS/redlin.f,v src/RCS/redlin.f,v
index 9a805012..7c90dcfe 100644
--- src/RCS/redlin.f,v
+++ src/RCS/redlin.f,v
@@ -1,4 +1,4 @@
-head	1.42;
+head	1.51;
 access;
 symbols
 	pre_mrcs:1.37
@@ -24,6 +24,51 @@ locks; strict;
 comment	@c @;
 
 
+1.51
+date	2025.10.25.15.21.38;	author dean;	state Exp;
+branches;
+next	1.50;
+
+1.50
+date	2025.10.21.19.14.19;	author dean;	state Exp;
+branches;
+next	1.49;
+
+1.49
+date	2025.10.17.00.05.43;	author dean;	state Exp;
+branches;
+next	1.48;
+
+1.48
+date	2025.10.16.19.20.33;	author dean;	state Exp;
+branches;
+next	1.47;
+
+1.47
+date	2025.10.07.13.43.30;	author dean;	state Exp;
+branches;
+next	1.46;
+
+1.46
+date	2025.10.07.13.43.03;	author dean;	state Exp;
+branches;
+next	1.45;
+
+1.45
+date	2025.10.03.13.30.45;	author dean;	state Exp;
+branches;
+next	1.44;
+
+1.44
+date	2025.10.02.15.43.49;	author dean;	state Exp;
+branches;
+next	1.43;
+
+1.43
+date	2025.09.21.15.14.56;	author dean;	state Exp;
+branches;
+next	1.42;
+
 1.42
 date	2020.06.24.15.28.27;	author leith;	state Exp;
 branches;
@@ -240,29 +285,31 @@ desc
 @
 
 
-1.42
+1.51
 log
-@comments
+@#undef SP_DBUGIO
 @
 text
 @
 C++*********************************************************************
-C   REDLIN.F     USED IOSTAT                    12/8/1997 ArDean Leith
-C                F90 CHANGES                    4/7/1998  ArDean Leith
-C                ENDEDNESS                      FEB 2003  ArDean Leith
-C                MPI CHANGES                    OCT 2008  ArDean Leith
-C                REDLIN_SEL                     NOV 2011  ArDean Leith
-C                MRC SUPPORT                    MAY 2019  ArDean Leith
-C                MORE MRC SUPPORT               DEC 2019  ArDean Leith
-C                REDLIN_SEL HANDLES MRC NOW     JUN 2020  ArDean Leith
-C
+C   REDLIN.F   USED IOSTAT                      12/8/1997 ArDean Leith
+C              F90 CHANGES                      4/7/1998  ArDean Leith
+C              ENDEDNESS                        FEB 2003  ArDean Leith
+C              MPI CHANGES                      OCT 2008  ArDean Leith
+C              REDLIN_SEL                       NOV 2011  ArDean Leith
+C              MRC SUPPORT                      MAY 2019  ArDean Leith
+C              MORE MRC SUPPORT                 DEC 2019  ArDean Leith
+C              REDLIN_SEL HANDLES MRC NOW       JUN 2020  ArDean Leith
+C              FIXED MRC MRCTYP NAME CONFUSION  SEP 2025  ArDean Leith
+C              ADD DEBUG OUTPUT                 OCT 2025  ArDean Leith
+C                
 C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2020  Health Research Inc.,                         *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -305,7 +352,8 @@ C         3   16    INTEGERS  (COMPLEX) FFT    NOT SUPPORTED
 C         4   32    REALS     (COMPLEX) FFT    NOT SUPPORTED      
 C         6   16    INTEGER*2 (UNSIGNED)        -2
 C
-C-**********************************************************************
+C23456789 123456789 123456789 123456789 123456789 123456789 123456789 12
+C--*********************************************************************
 
       SUBROUTINE REDLIN(LUNT,BUF,NB,IREC)
 
@@ -334,7 +382,7 @@ C     INCLUSION FOR OPTIONAL MPI INITIALIZATION.
       INTEGER         :: MYPID = -1
 #include "MPI_INIT.INC"
 
-      IF (ISINLINE(LUNT)) THEN
+      IF (ISINLINE(LUNT))  THEN
 C        USE INLINED BUFFER FOR I/O (SEE OPENINLN.F)
          CALL INLN_REDLIN(LUNT,BUF,NB,IREC)
          RETURN
@@ -343,29 +391,67 @@ C        USE INLINED BUFFER FOR I/O (SEE OPENINLN.F)
 C     FOR LUN EQUIVALENT INPUT == OUTPUT
       LUN = LUNARB(LUNT)
 
-      IF (LUNMRCPOS(LUN) == 0) THEN
+
+#undef SP_DBUGIO
+
+c#if defined(SP_DBUGIO)
+c       if (irec < 2) then
+c         write(3,'(A,5i10)')'  In redlin; lun,lunt,lunmrcpos(lun):',
+c     &                                    lun,lunt,lunmrcpos(lun)  
+c         write(3,'(A,5i6)') '  In redlin; lun,lunflip(lun):',
+c     &                                    lun,lunflip(lun) 
+c         write(3,'(A,5i6)') '  In redlin; nb,irec: ', nb,irec 
+c       endif
+c#endif
+
+      IF (LUNMRCPOS(LUN) == 0) THEN  ! -------- For SPIDER input ------
 
 C       DIRECT ACCESS SPIDER FILE
 C       ADD LUNARA(LUN) (FOR LABEL REC) AND LUNSTK (FOR STACK OFFSET)
 C       TO IREC TO GET THE CORRECT RECORD NUMBER
+
         I = IREC + LUNARA(LUN) + LUNSTK(LUNT)
 
-C       USING IOSTAT; IERR IS SET TO ZERO ON EACH SUCCESSFUL READ. DEC 97 al
+C       USING IOSTAT; IERR ISZEROED ON EACH SUCCESSFUL READ. DEC 97 al
 C       IF USING MPI .AND. ONLYONE_RED IS .FALSE. IT ALWAYS READS
 C       OTHERWISE, USING MPI, READS ONLY ON PROCESSOR MYPID = 0 
 
         IF (MYPID <= 0) READ(LUN,REC=I,IOSTAT=IERR) BUF
 
-      ELSE
+#if defined(SP_DBUGIO)
+        if (irec < 2) then
+          write(3,'(A,5i6)')'  In redlin; lun,nb,i: ',lun,nb,i
+        endif
+#endif
+ 
+
+      ELSE ! --------------------- For MRC input ---------------
 
 C        DIRECT ACCESS MRC FILE
          CALL REDLIN_MRC(LUN,BUF,NB,IREC, MYPID,IERR)
 
-      ENDIF
 
+      ENDIF  ! ------------------ For SPIDER & MRC input ------------
+          
       IF (LUNFLIP(LUN) == 1) THEN
 C        FLIP INPUT BYTES IN BUF ARRAY
-         CALL FLIPBYTESI(BUF,NB,IRTFLG)
+
+#if defined(SP_DBUGIO)
+         if (irec < 2 ) then
+         write(3,'(A,5f16.2)')'  In redlin before flip; buf(1),buf(5):',
+     &                                                  buf(1),buf(5) 
+      endif
+#endif
+
+         CALL FLIPBYTESI(BUF,NB,IRTFLG) 
+
+#if defined(SP_DBUGIO)
+         if (irec < 2 ) then
+         write(3,'(A,5f16.2)')'  In redlin  after flip; buf(1),buf(5):',
+     &                                                  buf(1),buf(5) 
+         endif
+#endif
+ 
       ENDIF
 
 #ifdef USE_MPI
@@ -392,25 +478,26 @@ C     PURPOSE:  READ STREAM ACCESS MRC IMAGE/VOLUME FILE INTO BUF
       REAL            :: BUF(NB)
       INTEGER         :: MYPID,IERR
 
-      INTEGER *8      :: LUNMRCPOS
+      INTEGER *8      :: LUNMRCPOS 
       INTEGER         :: LUNMRCNBYT
       COMMON /LUNMRC/    LUNMRCPOS(100),LUNMRCNBYT(100)
+
       INTEGER         :: LUNARA,LUNSTK,LUNARB,LUNFLIP
       COMMON /LUNARA/   LUNARA(100),LUNSTK(100),LUNARB(100),LUNFLIP(100)
 
-      INTEGER *1      :: I1BUF(NBUFSIZ)
-      INTEGER *2      :: I2BUF(NBUFSIZ)
+      INTEGER *1, SAVE :: I1BUF(NBUFSIZ)
+      INTEGER *2, SAVE :: I2BUF(NBUFSIZ)
 
-      INTEGER         :: NBYT_PER_VAL,NBYT_PER_REC,MRCTYP,NX
-      INTEGER *8      :: IPOSMRC
+      INTEGER          :: NBYT_PER_VAL,NBYT_PER_REC,NX
+
+      INTEGER *8       :: IPOSMRC
 
 C     LUNARA SIGN DENOTES IMAGE ORIGIN
       NX = ABS(LUNARA(LUN))
 
 C     DIFFERENT MRC MODES DIFFER IN DATA LENGTHS
-      MRCTYP       = LUNMRCNBYT(LUN)   
-      NBYT_PER_VAL = ABS(MRCTYP)
-      NBYT_PER_REC = NBYT_PER_VAL * NX
+      NBYT_PER_VAL     = ABS(LUNMRCNBYT(LUN))
+      NBYT_PER_REC     = NBYT_PER_VAL * NX
 
 C     FILE POSITION TO BEGIN READING DEPENDS ON IREC
 
@@ -427,6 +514,24 @@ C        ORIGIN IS UPPER LEFT
          RETURN
       ENDIF
 
+#if defined(SP_DBUGIO)       
+      if (irec < 2 .or. irec .eq. 224) then
+
+        write(3,'(A,5i6)')'  In redlin_mrc; nb,irec:',
+     &                                      nb,irec
+
+        write(3,'(A,5i6)')'  In redlin_mrc; lun,lunara(lun),nx:',
+     &                                      lun,lunara(lun),nx
+
+
+       write(3,'(A,5i6)')'  In redlin_mrc; nbyt_per_val,nbyt_per_rec:',
+     &                                      nbyt_per_val,nbyt_per_rec 
+
+        write(3,'(A,5i10)')'  In redlin_mrc; lunmrcpos(lun),iposmrc:',
+     &                                       lunmrcpos(lun),iposmrc 
+      endif
+#endif
+
 C     READ STREAM ACCESS MRC IMAGE/VOLUME FILE
 
       IF (NBYT_PER_VAL == 4) THEN
@@ -449,24 +554,17 @@ C        MRC FILE CONTAINS 8 BIT INTEGER*1 VALUES
          BUF(1:NB) = I1BUF(1:NB)        ! SPIDER NEEDS REALS
  
       ENDIF
+
+#if defined(SP_DBUGIO)
+      if (irec < 2) then
+        write(3,'(A,i5,3f10.3)')'  In redlin_mrc; irec,buf(1),buf(5):',
+     &                                            irec,buf(1),buf(5) 
+      endif
+#endif
    
       END
 
 
-c      if (irec==1) write(3,'(A,2X,3i9)')
-c     &            '  In redlin, lunflip(lun):',lunflip(lun)
-c      if (irec==1) write(3,'(A,2X,5i9)')
-c     &            '  In redlin, irec,lunmrcpos(),iposmrc:',
-c     &                          irec,lunmrcpos(lun),iposmrc
-c      if (irec==2) write(6,*)' irec,mrctyp,nbyt_per_val,nbyt_per_rec:'
-c     &                        ,irec,mrctyp,nbyt_per_val,nbyt_per_rec,nx
-c      if (irec==1) write(6,*)' irec,lunmrcpos,ipos: ',
-c     &                         irec,lunmrcpos(lun),iposmrc
-c     if (irec==1) write(3,'(A,2X,i9,f8.1)')
-c     &            '  In redlin, i1buf,buf:',i1buf(1),buf(1)
-
-
-
 C     ----------------------------- REDLIN1P  ------------------------
 
 C     SHOULD REPLACE THIS WITH: REDLIN_SEL!!!
@@ -530,6 +628,7 @@ C     USE INLINE BUFFER COMMON AREA
 
 C     INCLUSION FOR OPTIONAL MPI INITIALIZATION.  
       INTEGER    :: MYPID = -1
+
 #include "MPI_INIT.INC"
 
 C     USE REDLIN FOR BOTH SPIDER AND MRC FILES
@@ -553,6 +652,256 @@ C        ALWAYS BROADCASTS IF ONLYONE_RED IS .TRUE. WHEN USING MPI
 
 
 
+@
+
+
+1.50
+log
+@debugio output
+@
+text
+@d102 3
+@
+
+
+1.49
+log
+@bad comment on fliipbytes line!
+@
+text
+@d140 4
+a143 1
+ 
+d145 3
+a147 3
+      if (irec < 2 ) then
+        write(3,'(A,5f16.2)')'  Before flip in redlin; buf(1),buf(5):',
+     &                                                buf(1),buf(5) 
+a149 3
+         
+      IF (LUNFLIP(LUN) == 1) THEN
+C        FLIP INPUT BYTES IN BUF ARRAY
+d155 2
+a156 2
+          write(3,'(A,5f16.2)')' After  flip in redlin; buf(1),buf(5):',
+     &                                                 buf(1),buf(5) 
+d264 1
+a264 1
+      if (irec < 2 .or. irec .eq. 224) then
+@
+
+
+1.48
+log
+@changed debug output
+@
+text
+@d151 1
+a151 1
+c         CALL FLIPBYTESI(BUF,NB,IRTFLG) 
+@
+
+
+1.47
+log
+@FIXED MRC MRCTYP NAME CONFUSION, added debug output
+@
+text
+@d93 1
+a93 1
+      IF (ISINLINE(LUNT)) THEN
+d102 9
+a110 7
+#if defined(SP_DBUGIO)
+       if (irec < 2) then
+         write(3,*)' In redlin; lun,lunt,lunmrcpos,lunflip:',
+     &                     lun,lunt,lunmrcpos(lun),lunflip(lun) 
+         write(3,*)' In redlin; nb,irec: ', nb,irec 
+       endif
+#endif
+d126 1
+a126 1
+#if  defined(SP_DBUGIO)
+d128 1
+a128 1
+          write(3,*)' In redlin; lun,nb,i: ',lun,nb,i
+a134 9
+#if  defined(SP_DBUGIO)
+      if (irec < 2) then
+         write(3,*)' Calling redlin_mrc; lun,lunt,lunmrcpos,lunflip:',
+     &                           lun,lunt,lunmrcpos(lun),lunflip(lun) 
+
+         write(3,*)' Calling redlin_mrc; nb,irec:', nb,irec 
+        endif
+#endif
+
+d138 1
+d141 7
+a147 1
+          
+d151 1
+a151 2
+         CALL FLIPBYTESI(BUF,NB,IRTFLG) 
+      ENDIF
+d154 4
+a157 3
+      if (irec < 2) then
+        write(3,*)' In redlin; buf(1),buf(5):',buf(1),buf(5) 
+      endif
+d159 2
+a160 1
+
+d222 16
+a237 8
+#if defined(SP_DBUGIO)
+       if (irec < 2) then
+         write(3,*)' In redlin_mrc; iposmrc,lunmrcpos,lunflip:',
+     &                           iposmrc,lunmrcpos(lun),lunflip(lun) 
+
+         write(3,*)' In redlin_mrc; lun,nb,irec,nbyt_per_val:',
+     &                              lun,nb,irec,nbyt_per_val 
+       endif
+a239 1
+
+d264 3
+a266 2
+      if (irec < 2) then
+        write(3,*)' In redlin_mrc; buf(1+5):',buf(1),buf(5) 
+@
+
+
+1.46
+log
+@FIXED MRC MRCTYP NAME CONFUSION, added debug output
+@
+text
+@d12 1
+a12 1
+C              ADDDEBUG OUTPUT                  OCT 2025  ArDean Leith
+@
+
+
+1.45
+log
+@FIXED MRC MRCTYP NAME CONFUSION
+cosmetic
+@
+text
+@d12 1
+d102 9
+a110 1
+      IF (LUNMRCPOS(LUN) == 0) THEN
+d115 1
+d118 1
+a118 1
+C       USING IOSTAT; IERR IS SET TO ZERO ON EACH SUCCESSFUL READ. DEC 97 al
+d124 17
+a140 1
+      ELSE
+d145 3
+a147 2
+      ENDIF
+             
+d154 7
+d185 1
+a185 1
+      INTEGER *8      :: LUNMRCPOS
+d192 2
+a193 2
+      INTEGER *1      :: I1BUF(NBUFSIZ)
+      INTEGER *2      :: I2BUF(NBUFSIZ)
+d195 1
+a195 1
+      INTEGER         :: NBYT_PER_VAL,NBYT_PER_REC,NX
+d197 1
+a197 1
+      INTEGER *8      :: IPOSMRC
+d221 11
+d254 6
+d327 1
+@
+
+
+1.44
+log
+@removed some commented out debug output
+@
+text
+@d3 9
+a11 8
+C   REDLIN.F     USED IOSTAT                    12/8/1997 ArDean Leith
+C                F90 CHANGES                    4/7/1998  ArDean Leith
+C                ENDEDNESS                      FEB 2003  ArDean Leith
+C                MPI CHANGES                    OCT 2008  ArDean Leith
+C                REDLIN_SEL                     NOV 2011  ArDean Leith
+C                MRC SUPPORT                    MAY 2019  ArDean Leith
+C                MORE MRC SUPPORT               DEC 2019  ArDean Leith
+C                REDLIN_SEL HANDLES MRC NOW     JUN 2020  ArDean Leith
+d17 1
+a17 1
+C=* Copyright 1985-2020  Health Research Inc.,                         *
+d62 2
+a63 1
+C-**********************************************************************
+d154 1
+d161 2
+a162 1
+      INTEGER         :: NBYT_PER_VAL,NBYT_PER_REC,MRCTYP,NX
+d169 2
+a170 3
+      MRCTYP       = LUNMRCNBYT(LUN)   
+      NBYT_PER_VAL = ABS(MRCTYP)
+      NBYT_PER_REC = NBYT_PER_VAL * NX
+@
+
+
+1.43
+log
+@commented out write(3....
+@
+text
+@d11 1
+a11 1
+C  testing flipbytes sept 2025 al
+d18 1
+a18 1
+C=* Email: spider@@health.ny.gov                                        *
+a117 1
+      !write(3,'(A,2X,3i9)')'  In redlin, lunflip(lun):',lunflip(lun)
+a121 1
+         !write(3,'(A,2X,3i9)')'  redlin is fliping, lunflip(lun):',lunflip(lun)
+a207 14
+
+
+c      if (irec==1) write(3,'(A,2X,3i9)')
+c     &            '  In redlin, lunflip(lun):',lunflip(lun)
+c      if (irec==1) write(3,'(A,2X,5i9)')
+c     &            '  In redlin, irec,lunmrcpos(),iposmrc:',
+c     &                          irec,lunmrcpos(lun),iposmrc
+c      if (irec==2) write(6,*)' irec,mrctyp,nbyt_per_val,nbyt_per_rec:'
+c     &                        ,irec,mrctyp,nbyt_per_val,nbyt_per_rec,nx
+c      if (irec==1) write(6,*)' irec,lunmrcpos,ipos: ',
+c     &                         irec,lunmrcpos(lun),iposmrc
+c     if (irec==1) write(3,'(A,2X,i9,f8.1)')
+c     &            '  In redlin, i1buf,buf:',i1buf(1),buf(1)
+
+@
+
+
+1.42
+log
+@comments
+@
+text
+@d11 1
+a11 1
+C
+d118 2
+a119 1
+
+d122 3
+a124 1
+         CALL FLIPBYTESI(BUF,NB,IRTFLG)
 @
 
 
diff --git src/RCS/redlin8.f,v src/RCS/redlin8.f,v
index bd38c748..938de0e3 100644
--- src/RCS/redlin8.f,v
+++ src/RCS/redlin8.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.33.42;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.14;	author leith;	state Exp;
 branches;
@@ -80,9 +85,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -96,7 +101,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -141,6 +146,17 @@ C     ADD LUNARA(LUN)(FOR LABEL REC) TO NREC TO GET CORRECT RECORD NUMBER
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @GPL_2010
diff --git src/RCS/rednpadvol.f,v src/RCS/rednpadvol.f,v
index 6899d806..28a52a71 100644
--- src/RCS/rednpadvol.f,v
+++ src/RCS/rednpadvol.f,v
@@ -1,4 +1,4 @@
-head	1.4;
+head	1.5;
 access;
 symbols
 	pre_mrcs:1.4
@@ -10,6 +10,11 @@ locks; strict;
 comment	@c @;
 
 
+1.5
+date	2025.11.10.22.33.42;	author dean;	state Exp;
+branches;
+next	1.4;
+
 1.4
 date	2018.10.03.14.34.14;	author leith;	state Exp;
 branches;
@@ -35,9 +40,9 @@ desc
 @@
 
 
-1.4
+1.5
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -54,7 +59,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2011  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -253,6 +258,17 @@ C       FILL REMAINING PADDING SLICES
 @
 
 
+1.4
+log
+@email_health_dept
+@
+text
+@d15 1
+a15 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.3
 log
 @REDMASKNPADVOL added,   REDNPADVOL_SEL added
diff --git src/RCS/redpro2.f,v src/RCS/redpro2.f,v
index cb8967a5..c10ed470 100644
--- src/RCS/redpro2.f,v
+++ src/RCS/redpro2.f,v
@@ -1,4 +1,4 @@
-head	1.13;
+head	1.14;
 access;
 symbols
 	pre_mrcs:1.13
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.14
+date	2025.11.10.22.33.42;	author dean;	state Exp;
+branches;
+next	1.13;
+
 1.13
 date	2018.10.03.14.34.14;	author leith;	state Exp;
 branches;
@@ -95,9 +100,9 @@ desc
 @
 
 
-1.13
+1.14
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -111,7 +116,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -197,6 +202,17 @@ C       PRINT STATISTICS
 @
 
 
+1.13
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.12
 log
 @formatting, cosmetic
diff --git src/RCS/redrec8.f,v src/RCS/redrec8.f,v
index babc4cc8..e000f1f7 100644
--- src/RCS/redrec8.f,v
+++ src/RCS/redrec8.f,v
@@ -1,4 +1,4 @@
-head	1.6;
+head	1.7;
 access;
 symbols
 	pre_mrcs:1.6
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.7
+date	2025.11.10.22.33.43;	author dean;	state Exp;
+branches;
+next	1.6;
+
 1.6
 date	2018.10.03.14.34.14;	author leith;	state Exp;
 branches;
@@ -59,9 +64,9 @@ desc
 @@
 
 
-1.6
+1.7
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -75,7 +80,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -122,6 +127,17 @@ C--*********************************************************************
 @
 
 
+1.6
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.5
 log
 @GPL_2010
diff --git src/RCS/reform.f,v src/RCS/reform.f,v
index 140ee6df..0583c14c 100644
--- src/RCS/reform.f,v
+++ src/RCS/reform.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.33.43;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.14;	author leith;	state Exp;
 branches;
@@ -85,9 +90,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -102,7 +107,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -346,6 +351,17 @@ C            WRITE OUT THE REFORMED X-Y PLANE
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @GPL_2010
diff --git src/RCS/reform0.f,v src/RCS/reform0.f,v
index 8907ec80..cd5ebe66 100644
--- src/RCS/reform0.f,v
+++ src/RCS/reform0.f,v
@@ -1,4 +1,4 @@
-head	1.14;
+head	1.15;
 access;
 symbols
 	pre_mrcs:1.14
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.15
+date	2025.11.10.22.33.43;	author dean;	state Exp;
+branches;
+next	1.14;
+
 1.14
 date	2018.10.03.14.34.14;	author leith;	state Exp;
 branches;
@@ -100,9 +105,9 @@ desc
 @
 
 
-1.14
+1.15
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -117,7 +122,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -281,6 +286,17 @@ C       ROTATE THE VOLUME
 @
 
 
+1.14
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.13
 log
 @enter
diff --git src/RCS/reg_set.f,v src/RCS/reg_set.f,v
index cbb8003d..f9bd5b63 100644
--- src/RCS/reg_set.f,v
+++ src/RCS/reg_set.f,v
@@ -1,4 +1,4 @@
-head	1.42;
+head	1.43;
 access;
 symbols
 	pre_mrcs:1.42
@@ -23,6 +23,11 @@ locks; strict;
 comment	@c @;
 
 
+1.43
+date	2025.11.10.22.33.43;	author dean;	state Exp;
+branches;
+next	1.42;
+
 1.42
 date	2018.10.03.14.34.14;	author leith;	state Exp;
 branches;
@@ -238,9 +243,9 @@ desc
 @@
 
 
-1.42
+1.43
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -268,7 +273,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -2162,6 +2167,17 @@ C     RETURN IF NO ASSOCIATED VALUE OR QEND
 @
 
 
+1.42
+log
+@email_health_dept
+@
+text
+@d26 1
+a26 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.41
 log
 @REG_GET_SEL FOR GLO VAR SEND, ==,  cosmetic
diff --git src/RCS/regparse.f,v src/RCS/regparse.f,v
index a18e28db..3abbd56b 100644
--- src/RCS/regparse.f,v
+++ src/RCS/regparse.f,v
@@ -1,4 +1,4 @@
-head	1.6;
+head	1.7;
 access;
 symbols
 	pre_mrcs:1.6
@@ -23,6 +23,11 @@ locks; strict;
 comment	@c @;
 
 
+1.7
+date	2025.11.10.22.33.43;	author dean;	state Exp;
+branches;
+next	1.6;
+
 1.6
 date	2018.10.03.14.34.14;	author leith;	state Exp;
 branches;
@@ -58,9 +63,9 @@ desc
 @@
 
 
-1.6
+1.7
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -74,7 +79,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -135,6 +140,17 @@ C       RETURNS: REG. NUMBER AND LOCATION OF X.... STRING (IGO..IEND)
 @
 
 
+1.6
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.5
 log
 @GPL_2010
diff --git src/RCS/remez.f,v src/RCS/remez.f,v
index 02afce73..ccff02c2 100644
--- src/RCS/remez.f,v
+++ src/RCS/remez.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.33.43;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.14;	author leith;	state Exp;
 branches;
@@ -85,9 +90,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -102,7 +107,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -423,6 +428,17 @@ C***********************************************************************
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @GPL_2010
diff --git src/RCS/remezp.f,v src/RCS/remezp.f,v
index 00bb7c67..c22686ef 100644
--- src/RCS/remezp.f,v
+++ src/RCS/remezp.f,v
@@ -1,4 +1,4 @@
-head	1.20;
+head	1.21;
 access;
 symbols
 	pre_mrcs:1.20
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.21
+date	2025.11.10.22.33.43;	author dean;	state Exp;
+branches;
+next	1.20;
+
 1.20
 date	2018.10.03.14.34.15;	author leith;	state Exp;
 branches;
@@ -130,9 +135,9 @@ desc
 @
 
 
-1.20
+1.21
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -150,7 +155,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -363,6 +368,17 @@ C            PSF TO BE USED IN RC
 @
 
 
+1.20
+log
+@email_health_dept
+@
+text
+@d16 1
+a16 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.19
 log
 @LEN=MAXNAM):: FILNAM
diff --git src/RCS/repr2_s.f,v src/RCS/repr2_s.f,v
index f32decad..4e3f334c 100644
--- src/RCS/repr2_s.f,v
+++ src/RCS/repr2_s.f,v
@@ -1,4 +1,4 @@
-head	1.16;
+head	1.17;
 access;
 symbols
 	pre_mrcs:1.16
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.17
+date	2025.11.10.22.33.43;	author dean;	state Exp;
+branches;
+next	1.16;
+
 1.16
 date	2018.10.03.14.34.15;	author leith;	state Exp;
 branches;
@@ -110,9 +115,9 @@ desc
 @
 
 
-1.16
+1.17
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -128,7 +133,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -395,6 +400,17 @@ C                   CONTINUE ITERATIONS
 @
 
 
+1.16
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.15
 log
 @formating
diff --git src/RCS/retir.f,v src/RCS/retir.f,v
index 357cd30d..eb119d23 100644
--- src/RCS/retir.f,v
+++ src/RCS/retir.f,v
@@ -1,4 +1,4 @@
-head	1.13;
+head	1.14;
 access;
 symbols
 	pre_mrcs:1.13
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.14
+date	2025.11.10.22.33.43;	author dean;	state Exp;
+branches;
+next	1.13;
+
 1.13
 date	2018.10.03.14.34.15;	author leith;	state Exp;
 branches;
@@ -95,9 +100,9 @@ desc
 @
 
 
-1.13
+1.14
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -107,7 +112,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -170,6 +175,17 @@ C         I = X*RAN(IST) + 1.0
 @
 
 
+1.13
+log
+@email_health_dept
+@
+text
+@d8 1
+a8 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.12
 log
 @GPL_2010
diff --git src/RCS/reversebytes.f,v src/RCS/reversebytes.f,v
index 274a1f1f..10c8e14a 100644
--- src/RCS/reversebytes.f,v
+++ src/RCS/reversebytes.f,v
@@ -1,4 +1,4 @@
-head	1.7;
+head	1.8;
 access;
 symbols
 	pre_mrcs:1.7
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.8
+date	2025.11.10.22.33.43;	author dean;	state Exp;
+branches;
+next	1.7;
+
 1.7
 date	2018.10.03.14.34.15;	author leith;	state Exp;
 branches;
@@ -65,9 +70,9 @@ desc
 @
 
 
-1.7
+1.8
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -81,7 +86,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -131,6 +136,17 @@ C       IN INVERTED ORDER (DCBA)
 @
 
 
+1.7
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.6
 log
 @GPL_2010
diff --git src/RCS/rew.f,v src/RCS/rew.f,v
index da5a9692..88746475 100644
--- src/RCS/rew.f,v
+++ src/RCS/rew.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.33.43;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.15;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -90,7 +95,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -130,6 +135,17 @@ C***********************************************************************
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/rewf.f,v src/RCS/rewf.f,v
index 698eb712..f2a08992 100644
--- src/RCS/rewf.f,v
+++ src/RCS/rewf.f,v
@@ -1,4 +1,4 @@
-head	1.5;
+head	1.6;
 access;
 symbols
 	pre_mrcs:1.5
@@ -19,6 +19,11 @@ locks; strict;
 comment	@c @;
 
 
+1.6
+date	2025.11.10.22.33.43;	author dean;	state Exp;
+branches;
+next	1.5;
+
 1.5
 date	2018.10.03.14.34.15;	author leith;	state Exp;
 branches;
@@ -49,9 +54,9 @@ desc
 @@
 
 
-1.5
+1.6
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -66,7 +71,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -100,6 +105,17 @@ C **********************************************************************
 @
 
 
+1.5
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.4
 log
 @GPL_2010
diff --git src/RCS/rfactsd2.f,v src/RCS/rfactsd2.f,v
index bd4e63e9..1e0b3b25 100644
--- src/RCS/rfactsd2.f,v
+++ src/RCS/rfactsd2.f,v
@@ -1,4 +1,4 @@
-head	1.43;
+head	1.44;
 access;
 symbols
 	pre_mrcs:1.43
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.44
+date	2025.09.21.14.56.10;	author dean;	state Exp;
+branches;
+next	1.43;
+
 1.43
 date	2018.10.03.14.34.15;	author leith;	state Exp;
 branches;
@@ -245,9 +250,9 @@ desc
 @
 
 
-1.43
+1.44
 log
-@email_health_dept
+@WRITE(LUNGP,195) ,L,RVAL(L),FSCVAL(L)  abnormal ,
 @
 text
 @
@@ -271,7 +276,6 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2016  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -603,7 +607,7 @@ C           WRITE GNUPLOT FILE OUTPUT
 
             DO  L=1,INC
                IF (LR(L) .NE. 0) THEN
-                  WRITE(LUNGP,195) ,L,RVAL(L),FSCVAL(L)
+                  WRITE(LUNGP,195) L,RVAL(L),FSCVAL(L)
 195               FORMAT(' ',I5,'  ',F7.2,' ',F10.3)
                ENDIF
            ENDDO
@@ -617,6 +621,19 @@ C           WRITE GNUPLOT FILE OUTPUT
 @
 
 
+1.43
+log
+@email_health_dept
+@
+text
+@a21 1
+C=* Email: spider@@health.ny.gov                                        *
+d353 1
+a353 1
+                  WRITE(LUNGP,195) ,L,RVAL(L),FSCVAL(L)
+@
+
+
 1.42
 log
 @nsel now not needed for gpl plot
diff --git src/RCS/rfactsdo.f,v src/RCS/rfactsdo.f,v
index d317ba79..bc92aad5 100644
--- src/RCS/rfactsdo.f,v
+++ src/RCS/rfactsdo.f,v
@@ -1,4 +1,4 @@
-head	1.40;
+head	1.41;
 access;
 symbols
 	pre_mrcs:1.40
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.41
+date	2025.11.10.22.33.43;	author dean;	state Exp;
+branches;
+next	1.40;
+
 1.40
 date	2018.10.03.14.34.15;	author leith;	state Exp;
 branches;
@@ -230,9 +235,9 @@ desc
 @
 
 
-1.40
+1.41
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -250,7 +255,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -516,6 +521,17 @@ C       WRITE RESULT INTO DOC FILE AND RESULT FILE
 @
 
 
+1.40
+log
+@email_health_dept
+@
+text
+@d16 1
+a16 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.39
 log
 @wantsqrts
diff --git src/RCS/rgri.f,v src/RCS/rgri.f,v
index ff48769f..1afa77e3 100644
--- src/RCS/rgri.f,v
+++ src/RCS/rgri.f,v
@@ -1,4 +1,4 @@
-head	1.21;
+head	1.22;
 access;
 symbols
 	pre_mrcs:1.21
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.22
+date	2025.11.10.22.33.43;	author dean;	state Exp;
+branches;
+next	1.21;
+
 1.21
 date	2018.10.03.14.34.15;	author leith;	state Exp;
 branches;
@@ -135,9 +140,9 @@ desc
 @
 
 
-1.21
+1.22
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -153,7 +158,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2011  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -369,6 +374,17 @@ C          CLEAR TABLES
 @
 
 
+1.21
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.20
 log
 @undefined kv bug
diff --git src/RCS/ringwe.f,v src/RCS/ringwe.f,v
index 4a690663..1dca540b 100644
--- src/RCS/ringwe.f,v
+++ src/RCS/ringwe.f,v
@@ -1,4 +1,4 @@
-head	1.14;
+head	1.15;
 access;
 symbols
 	pre_mrcs:1.14
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.15
+date	2025.11.10.22.33.43;	author dean;	state Exp;
+branches;
+next	1.14;
+
 1.14
 date	2018.10.03.14.34.15;	author leith;	state Exp;
 branches;
@@ -99,9 +104,9 @@ desc
 @@
 
 
-1.14
+1.15
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -116,7 +121,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -178,6 +183,17 @@ C       -------------------- RINGWE --------------------------------
 @
 
 
+1.14
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.13
 log
 @GPL_2010
diff --git src/RCS/rmfilterz.f,v src/RCS/rmfilterz.f,v
index e5522f22..321f8d55 100644
--- src/RCS/rmfilterz.f,v
+++ src/RCS/rmfilterz.f,v
@@ -1,4 +1,4 @@
-head	1.5;
+head	1.6;
 access;
 symbols
 	pre_mrcs:1.5
@@ -20,6 +20,11 @@ locks; strict;
 comment	@c @;
 
 
+1.6
+date	2025.11.10.22.33.43;	author dean;	state Exp;
+branches;
+next	1.5;
+
 1.5
 date	2018.10.03.14.34.15;	author leith;	state Exp;
 branches;
@@ -51,9 +56,9 @@ desc
 @
 
 
-1.5
+1.6
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -61,7 +66,7 @@ C=**********************************************************************
 C=* From: SPIDER - MODULAR IMAGE PROCESSING SYSTEM                     *
 C=* Copyright (C)2000  M. Radermacher                                  *
 C=*                                                                    *
-C=* Email:  spider@@health.ny.gov                                       *
+C=* Email:  spider@@wadsworth.org                                       *
 C=*                                                                    *
 C=* This program is free software; you can redistribute it and/or      *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -115,6 +120,17 @@ C       APPLY MASK:
 @
 
 
+1.5
+log
+@email_health_dept
+@
+text
+@d6 1
+a6 1
+C=* Email:  spider@@health.ny.gov                                       *
+@
+
+
 1.4
 log
 @common debug -> debug1 compiler balks
diff --git src/RCS/rmfilty.f,v src/RCS/rmfilty.f,v
index 754b6da2..3263bf7b 100644
--- src/RCS/rmfilty.f,v
+++ src/RCS/rmfilty.f,v
@@ -1,4 +1,4 @@
-head	1.5;
+head	1.6;
 access;
 symbols
 	pre_mrcs:1.5
@@ -20,6 +20,11 @@ locks; strict;
 comment	@c @;
 
 
+1.6
+date	2025.11.10.22.33.43;	author dean;	state Exp;
+branches;
+next	1.5;
+
 1.5
 date	2018.10.03.14.34.15;	author leith;	state Exp;
 branches;
@@ -51,9 +56,9 @@ desc
 @
 
 
-1.5
+1.6
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -62,7 +67,7 @@ C=**********************************************************************
 C=* From: SPIDER - MODULAR IMAGE PROCESSING SYSTEM                     *
 C=* Copyright (C)2000  M. Radermacher                                  *
 C=*                                                                    *
-C=* Email:  spider@@health.ny.gov                                       *
+C=* Email:  spider@@wadsworth.org                                       *
 C=*                                                                    *
 C=* This program is free software; you can redistribute it and/or      *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -121,6 +126,17 @@ C       PROGRAM TO FILTER Z-SLICES IN A 3D RADON TRANSFORM
 @
 
 
+1.5
+log
+@email_health_dept
+@
+text
+@d7 1
+a7 1
+C=* Email:  spider@@health.ny.gov                                       *
+@
+
+
 1.4
 log
 @common debug -> debug1 compiler balks
diff --git src/RCS/rmfiltz.f,v src/RCS/rmfiltz.f,v
index 7065ed2d..bb7c5104 100644
--- src/RCS/rmfiltz.f,v
+++ src/RCS/rmfiltz.f,v
@@ -1,4 +1,4 @@
-head	1.5;
+head	1.6;
 access;
 symbols
 	pre_mrcs:1.5
@@ -20,6 +20,11 @@ locks; strict;
 comment	@c @;
 
 
+1.6
+date	2025.11.10.22.33.43;	author dean;	state Exp;
+branches;
+next	1.5;
+
 1.5
 date	2018.10.03.14.34.15;	author leith;	state Exp;
 branches;
@@ -51,9 +56,9 @@ desc
 @
 
 
-1.5
+1.6
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -62,7 +67,7 @@ C=**********************************************************************
 C=* From: SPIDER - MODULAR IMAGE PROCESSING SYSTEM                     *
 C=* Copyright (C)2000  M. Radermacher                                  *
 C=*                                                                    *
-C=* Email:  spider@@health.ny.gov                                       *
+C=* Email:  spider@@wadsworth.org                                       *
 C=*                                                                    *
 C=* This program is free software; you can redistribute it and/or      *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -111,6 +116,17 @@ C         PROGRAM TO FILTER Z-SLICES IN A 3D RADON TRANSFORM
 @
 
 
+1.5
+log
+@email_health_dept
+@
+text
+@d7 1
+a7 1
+C=* Email:  spider@@health.ny.gov                                       *
+@
+
+
 1.4
 log
 @common debug -> debug1 compiler balks
diff --git src/RCS/rmiwf.f,v src/RCS/rmiwf.f,v
index 457909e7..d7572047 100644
--- src/RCS/rmiwf.f,v
+++ src/RCS/rmiwf.f,v
@@ -1,4 +1,4 @@
-head	1.4;
+head	1.5;
 access;
 symbols
 	pre_mrcs:1.4
@@ -20,6 +20,11 @@ locks; strict;
 comment	@c @;
 
 
+1.5
+date	2025.11.10.22.33.43;	author dean;	state Exp;
+branches;
+next	1.4;
+
 1.4
 date	2018.10.03.14.34.15;	author leith;	state Exp;
 branches;
@@ -46,9 +51,9 @@ desc
 @
 
 
-1.4
+1.5
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @        SUBROUTINE RMIWF(A,NSAM,NSAMF,C,PST,PINC,NPRO,IFIL)
@@ -58,7 +63,7 @@ C=**********************************************************************
 C=* From: SPIDER - MODULAR IMAGE PROCESSING SYSTEM                     *
 C=* Copyright (C)2000  M. Radermacher                                  *
 C=*                                                                    *
-C=* Email:  spider@@health.ny.gov                                       *
+C=* Email:  spider@@wadsworth.org                                       *
 C=*                                                                    *
 C=* This program is free software; you can redistribute it and/or      *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -116,6 +121,17 @@ C       A(1)=1
 @
 
 
+1.4
+log
+@email_health_dept
+@
+text
+@d8 1
+a8 1
+C=* Email:  spider@@health.ny.gov                                       *
+@
+
+
 1.3
 log
 @GPL License fixed
diff --git src/RCS/rmmakemask.f,v src/RCS/rmmakemask.f,v
index 649c2bb5..dc191663 100644
--- src/RCS/rmmakemask.f,v
+++ src/RCS/rmmakemask.f,v
@@ -1,4 +1,4 @@
-head	1.4;
+head	1.5;
 access;
 symbols
 	pre_mrcs:1.4
@@ -20,6 +20,11 @@ locks; strict;
 comment	@c @;
 
 
+1.5
+date	2025.11.10.22.33.43;	author dean;	state Exp;
+branches;
+next	1.4;
+
 1.4
 date	2018.10.03.14.34.15;	author leith;	state Exp;
 branches;
@@ -46,9 +51,9 @@ desc
 @
 
 
-1.4
+1.5
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -56,7 +61,7 @@ C=**********************************************************************
 C=* From: SPIDER - MODULAR IMAGE PROCESSING SYSTEM                     *
 C=* Copyright (C)2000  M. Radermacher                                  *
 C=*                                                                    *
-C=* Email:  spider@@health.ny.gov                                       *
+C=* Email:  spider@@wadsworth.org                                       *
 C=*                                                                    *
 C=* This program is free software; you can redistribute it and/or      *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -122,6 +127,17 @@ C          89.9 DEGREES CORRESPONDS TO 0.00174533
 @
 
 
+1.4
+log
+@email_health_dept
+@
+text
+@d6 1
+a6 1
+C=* Email:  spider@@health.ny.gov                                       *
+@
+
+
 1.3
 log
 @GPL License fixed
diff --git src/RCS/rmrepl.f,v src/RCS/rmrepl.f,v
index 77a36f66..01776c94 100644
--- src/RCS/rmrepl.f,v
+++ src/RCS/rmrepl.f,v
@@ -1,4 +1,4 @@
-head	1.4;
+head	1.5;
 access;
 symbols
 	pre_mrcs:1.4
@@ -20,6 +20,11 @@ locks; strict;
 comment	@c @;
 
 
+1.5
+date	2025.11.10.22.33.43;	author dean;	state Exp;
+branches;
+next	1.4;
+
 1.4
 date	2018.10.03.14.34.15;	author leith;	state Exp;
 branches;
@@ -46,9 +51,9 @@ desc
 @
 
 
-1.4
+1.5
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -61,7 +66,7 @@ C=**********************************************************************
 C=* From: SPIDER - MODULAR IMAGE PROCESSING SYSTEM                     *
 C=* Copyright (C)2000  M. Radermacher                                  *
 C=*                                                                    *
-C=* Email:  spider@@health.ny.gov                                       *
+C=* Email:  spider@@wadsworth.org                                       *
 C=*                                                                    *
 C=* This program is free software; you can redistribute it and/or      *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -100,6 +105,17 @@ C=**********************************************************************
 @
 
 
+1.4
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email:  spider@@health.ny.gov                                       *
+@
+
+
 1.3
 log
 @GPL License fixed
diff --git src/RCS/rmz_p.f,v src/RCS/rmz_p.f,v
index a3e6f995..52686c95 100644
--- src/RCS/rmz_p.f,v
+++ src/RCS/rmz_p.f,v
@@ -1,4 +1,4 @@
-head	1.14;
+head	1.15;
 access;
 symbols
 	pre_mrcs:1.14
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.15
+date	2025.11.10.22.33.43;	author dean;	state Exp;
+branches;
+next	1.14;
+
 1.14
 date	2018.10.03.14.34.15;	author leith;	state Exp;
 branches;
@@ -100,9 +105,9 @@ desc
 @
 
 
-1.14
+1.15
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -115,7 +120,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -343,6 +348,17 @@ C 455          FORMAT(/2X,'EXTREMAL FREQUENCIES'/,(2X,5F12.7))
 @
 
 
+1.14
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.13
 log
 @GPL_2010
diff --git src/RCS/rot32.f,v src/RCS/rot32.f,v
index 68670a84..7603c936 100644
--- src/RCS/rot32.f,v
+++ src/RCS/rot32.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.33.43;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.15;	author leith;	state Exp;
 branches;
@@ -80,9 +85,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*******************************************************************
@@ -96,7 +101,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2013  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -258,6 +263,17 @@ c                INSIDE BOUNDARIES OF OUTPUT IMAGE
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @VOLUME RECORD BUG
diff --git src/RCS/rot3_p.f,v src/RCS/rot3_p.f,v
index eeb69fc1..dd0a4c3f 100644
--- src/RCS/rot3_p.f,v
+++ src/RCS/rot3_p.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.33.43;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.15;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -91,7 +96,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -362,6 +367,17 @@ C
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/rot_p.f,v src/RCS/rot_p.f,v
index 541ba8d8..6146eff5 100644
--- src/RCS/rot_p.f,v
+++ src/RCS/rot_p.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.33.43;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.15;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -91,7 +96,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -280,6 +285,17 @@ C
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/rotal3.f,v src/RCS/rotal3.f,v
index de8be545..367ba3a7 100644
--- src/RCS/rotal3.f,v
+++ src/RCS/rotal3.f,v
@@ -1,4 +1,4 @@
-head	1.23;
+head	1.24;
 access;
 symbols
 	pre_mrcs:1.23
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.24
+date	2025.11.10.22.33.43;	author dean;	state Exp;
+branches;
+next	1.23;
+
 1.23
 date	2018.10.03.14.34.15;	author leith;	state Exp;
 branches;
@@ -145,9 +150,9 @@ desc
 @
 
 
-1.23
+1.24
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -160,7 +165,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -237,6 +242,17 @@ C       GET  ROTATION AXIS
 @
 
 
+1.23
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.22
 log
 @GPL_2010
diff --git src/RCS/rotas3.f,v src/RCS/rotas3.f,v
index defd6f63..5d2d18fc 100644
--- src/RCS/rotas3.f,v
+++ src/RCS/rotas3.f,v
@@ -1,4 +1,4 @@
-head	1.36;
+head	1.37;
 access;
 symbols
 	pre_mrcs:1.36
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.37
+date	2025.11.10.22.33.43;	author dean;	state Exp;
+branches;
+next	1.36;
+
 1.36
 date	2018.10.03.14.34.15;	author leith;	state Exp;
 branches;
@@ -210,9 +215,9 @@ desc
 @
 
 
-1.36
+1.37
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -225,7 +230,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -353,6 +358,17 @@ C          TRI-QUADRATIC INTERLPOLATION (DEFAULTED IN MAY 2002)
 @
 
 
+1.36
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.35
 log
 @GPL_2010
diff --git src/RCS/rotates.f,v src/RCS/rotates.f,v
index acf24d57..beb9d397 100644
--- src/RCS/rotates.f,v
+++ src/RCS/rotates.f,v
@@ -1,4 +1,4 @@
-head	1.15;
+head	1.16;
 access;
 symbols
 	pre_mrcs:1.15
@@ -7,6 +7,11 @@ locks; strict;
 comment	@c @;
 
 
+1.16
+date	2025.11.10.22.33.43;	author dean;	state Exp;
+branches;
+next	1.15;
+
 1.15
 date	2018.10.03.14.34.15;	author leith;	state Exp;
 branches;
@@ -87,9 +92,9 @@ desc
 @@
 
 
-1.15
+1.16
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -108,7 +113,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -674,6 +679,17 @@ C              WRITE OUTPUT SLICE
 @
 
 
+1.15
+log
+@email_health_dept
+@
+text
+@d17 1
+a17 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.14
 log
 @X & Y CENTER OFFSETS had leading blanks
diff --git src/RCS/rotates3fbs.f,v src/RCS/rotates3fbs.f,v
index c02c0d8d..7c62f889 100644
--- src/RCS/rotates3fbs.f,v
+++ src/RCS/rotates3fbs.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -7,6 +7,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.33.43;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.15;	author leith;	state Exp;
 branches;
@@ -67,9 +72,9 @@ desc
 @@
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -83,7 +88,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2012  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -256,6 +261,17 @@ C                   ROTATED POSITION IS OUTSIDE VOLUME
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @*** empty log message ***
diff --git src/RCS/rotates3l.f,v src/RCS/rotates3l.f,v
index 3b99aa75..10f37571 100644
--- src/RCS/rotates3l.f,v
+++ src/RCS/rotates3l.f,v
@@ -1,4 +1,4 @@
-head	1.2;
+head	1.3;
 access;
 symbols
 	pre_mrcs:1.2
@@ -7,6 +7,11 @@ locks; strict;
 comment	@c @;
 
 
+1.3
+date	2025.11.10.22.33.43;	author dean;	state Exp;
+branches;
+next	1.2;
+
 1.2
 date	2018.10.03.14.34.15;	author leith;	state Exp;
 branches;
@@ -22,9 +27,9 @@ desc
 @@
 
 
-1.2
+1.3
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -37,7 +42,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2011  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -167,6 +172,17 @@ C     &  +   DX *   DY *   DZ *Q1(IOX+1,IOY+1,IOZ+1)
 @
 
 
+1.2
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.1
 log
 @Initial revision
diff --git src/RCS/rotates3q.f,v src/RCS/rotates3q.f,v
index 40707628..d9221159 100644
--- src/RCS/rotates3q.f,v
+++ src/RCS/rotates3q.f,v
@@ -1,4 +1,4 @@
-head	1.2;
+head	1.3;
 access;
 symbols
 	pre_mrcs:1.2
@@ -7,6 +7,11 @@ locks; strict;
 comment	@c @;
 
 
+1.3
+date	2025.11.10.22.33.44;	author dean;	state Exp;
+branches;
+next	1.2;
+
 1.2
 date	2018.10.03.14.34.15;	author leith;	state Exp;
 branches;
@@ -22,9 +27,9 @@ desc
 @@
 
 
-1.2
+1.3
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -37,7 +42,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2011  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the teDRMs of the GNU General Public License as     *
@@ -185,6 +190,17 @@ C                   ROTATED POSITION IS OUTSIDE VOLUME
 @
 
 
+1.2
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.1
 log
 @Initial revision
diff --git src/RCS/rotatesl3q.f,v src/RCS/rotatesl3q.f,v
index 7516692d..ecd473bd 100644
--- src/RCS/rotatesl3q.f,v
+++ src/RCS/rotatesl3q.f,v
@@ -1,4 +1,4 @@
-head	1.2;
+head	1.3;
 access;
 symbols
 	pre_mrcs:1.2
@@ -7,6 +7,11 @@ locks; strict;
 comment	@c @;
 
 
+1.3
+date	2025.11.10.22.33.44;	author dean;	state Exp;
+branches;
+next	1.2;
+
 1.2
 date	2018.10.03.14.34.15;	author leith;	state Exp;
 branches;
@@ -22,9 +27,9 @@ desc
 @@
 
 
-1.2
+1.3
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -38,7 +43,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -197,6 +202,17 @@ C                   ROTATED POSITION IS OUTSIDE VOLUME
 @
 
 
+1.2
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.1
 log
 @Initial revision
diff --git src/RCS/rotl3.f,v src/RCS/rotl3.f,v
index 0fb15710..2c865da9 100644
--- src/RCS/rotl3.f,v
+++ src/RCS/rotl3.f,v
@@ -1,4 +1,4 @@
-head	1.12;
+head	1.13;
 access;
 symbols
 	pre_mrcs:1.12
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.13
+date	2025.11.10.22.33.44;	author dean;	state Exp;
+branches;
+next	1.12;
+
 1.12
 date	2018.10.03.14.34.15;	author leith;	state Exp;
 branches;
@@ -90,9 +95,9 @@ desc
 @
 
 
-1.12
+1.13
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -105,7 +110,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -246,6 +251,17 @@ C**********************************************************
 @
 
 
+1.12
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.11
 log
 @GPL_2010
diff --git src/RCS/rotl3q.f,v src/RCS/rotl3q.f,v
index 6421fc8a..e9cbaf02 100644
--- src/RCS/rotl3q.f,v
+++ src/RCS/rotl3q.f,v
@@ -1,4 +1,4 @@
-head	1.6;
+head	1.7;
 access;
 symbols
 	pre_mrcs:1.6
@@ -21,6 +21,11 @@ locks; strict;
 comment	@c @;
 
 
+1.7
+date	2025.11.10.22.33.44;	author dean;	state Exp;
+branches;
+next	1.6;
+
 1.6
 date	2018.10.03.14.34.15;	author leith;	state Exp;
 branches;
@@ -56,9 +61,9 @@ desc
 @@
 
 
-1.6
+1.7
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -72,7 +77,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -218,6 +223,17 @@ C                   ROTATED POSITION IS OUTSIDE VOLUME
 @
 
 
+1.6
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.5
 log
 @GPL_2010
diff --git src/RCS/rots3.f,v src/RCS/rots3.f,v
index 641d1f58..5985572b 100644
--- src/RCS/rots3.f,v
+++ src/RCS/rots3.f,v
@@ -1,4 +1,4 @@
-head	1.14;
+head	1.15;
 access;
 symbols
 	pre_mrcs:1.14
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.15
+date	2025.11.10.22.33.44;	author dean;	state Exp;
+branches;
+next	1.14;
+
 1.14
 date	2018.10.03.14.34.15;	author leith;	state Exp;
 branches;
@@ -100,9 +105,9 @@ desc
 @
 
 
-1.14
+1.15
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -115,7 +120,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -246,6 +251,17 @@ C        Q2(IX)=AV
 @
 
 
+1.14
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.13
 log
 @GPL_2010
diff --git src/RCS/rots3q.f,v src/RCS/rots3q.f,v
index adbf6bd0..8f3cd629 100644
--- src/RCS/rots3q.f,v
+++ src/RCS/rots3q.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -21,6 +21,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.33.45;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.15;	author leith;	state Exp;
 branches;
@@ -82,9 +87,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -97,7 +102,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -229,6 +234,17 @@ C                   ROTATED POSITION IS OUTSIDE VOLUME
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @GPL_2010
diff --git src/RCS/rprq.f,v src/RCS/rprq.f,v
index 1e3190df..4bc9f4db 100644
--- src/RCS/rprq.f,v
+++ src/RCS/rprq.f,v
@@ -1,4 +1,4 @@
-head	1.29;
+head	1.30;
 access;
 symbols
 	pre_mrcs:1.29
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.30
+date	2025.11.10.22.33.45;	author dean;	state Exp;
+branches;
+next	1.29;
+
 1.29
 date	2018.10.03.14.34.15;	author leith;	state Exp;
 branches;
@@ -175,9 +180,9 @@ desc
 @
 
 
-1.29
+1.30
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -194,7 +199,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2012  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -317,6 +322,17 @@ C     &                 +     DIPX *     DIPY *B(MAP(IQX+1,IQY+1))
 @
 
 
+1.29
+log
+@email_health_dept
+@
+text
+@d15 1
+a15 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.28
 log
 @removed unused psi,theta,psi
diff --git src/RCS/rtq.f,v src/RCS/rtq.f,v
index af8650a3..57792696 100644
--- src/RCS/rtq.f,v
+++ src/RCS/rtq.f,v
@@ -1,4 +1,4 @@
-head	1.12;
+head	1.13;
 access;
 symbols
 	pre_mrcs:1.12
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.13
+date	2025.11.10.22.33.45;	author dean;	state Exp;
+branches;
+next	1.12;
+
 1.12
 date	2018.10.03.14.34.15;	author leith;	state Exp;
 branches;
@@ -90,9 +95,9 @@ desc
 @
 
 
-1.12
+1.13
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -105,7 +110,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -168,6 +173,17 @@ c$omp parallel do private(i,k,yi,ycod,ysid,xi,xold,yold)
 @
 
 
+1.12
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.11
 log
 @GPL_2010
diff --git src/RCS/rtq_q.f,v src/RCS/rtq_q.f,v
index a6434a26..4e897949 100644
--- src/RCS/rtq_q.f,v
+++ src/RCS/rtq_q.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.33.45;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.15;	author leith;	state Exp;
 branches;
@@ -84,9 +89,9 @@ desc
 @@
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -99,7 +104,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -162,6 +167,17 @@ c$omp parallel do private(i,k,yi,ycod,ysid,xi,xold,yold)
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @GPL_2010
diff --git src/RCS/rtqs_q.f,v src/RCS/rtqs_q.f,v
index 7a75c24c..f7e5c2a7 100644
--- src/RCS/rtqs_q.f,v
+++ src/RCS/rtqs_q.f,v
@@ -1,4 +1,4 @@
-head	1.13;
+head	1.14;
 access;
 symbols
 	pre_mrcs:1.13
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.14
+date	2025.11.10.22.33.45;	author dean;	state Exp;
+branches;
+next	1.13;
+
 1.13
 date	2018.10.03.14.34.15;	author leith;	state Exp;
 branches;
@@ -94,9 +99,9 @@ desc
 @@
 
 
-1.13
+1.14
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -109,7 +114,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2017  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -182,6 +187,17 @@ c$omp parallel do private(i,k,yi,ycod,ysid,xi,xold,yold)
 @
 
 
+1.13
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.12
 log
 @cosmetic changes
diff --git src/RCS/rtsf.f,v src/RCS/rtsf.f,v
index c3a20894..6ad5b41d 100644
--- src/RCS/rtsf.f,v
+++ src/RCS/rtsf.f,v
@@ -1,4 +1,4 @@
-head	1.40;
+head	1.41;
 access;
 symbols
 	pre_mrcs:1.40
@@ -7,6 +7,11 @@ locks; strict;
 comment	@c @;
 
 
+1.41
+date	2025.11.10.22.33.45;	author dean;	state Exp;
+branches;
+next	1.40;
+
 1.40
 date	2018.10.03.14.34.15;	author leith;	state Exp;
 branches;
@@ -212,9 +217,9 @@ desc
 @@
 
 
-1.40
+1.41
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C **********************************************************************
@@ -234,7 +239,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -915,6 +920,17 @@ c$omp    parallel do private(iy,yi,ycod,ysid, ix,xi,xold,yold)
 @
 
 
+1.40
+log
+@email_health_dept
+@
+text
+@d18 1
+a18 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.39
 log
 @cosmetic
diff --git src/RCS/rtsq.f,v src/RCS/rtsq.f,v
index 75be5497..9195756f 100644
--- src/RCS/rtsq.f,v
+++ src/RCS/rtsq.f,v
@@ -1,4 +1,4 @@
-head	1.24;
+head	1.25;
 access;
 symbols
 	pre_mrcs:1.24
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.25
+date	2025.11.10.22.33.45;	author dean;	state Exp;
+branches;
+next	1.24;
+
 1.24
 date	2018.10.03.14.34.16;	author leith;	state Exp;
 branches;
@@ -150,9 +155,9 @@ desc
 @
 
 
-1.24
+1.25
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -173,7 +178,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *                            
 C=* Copyright 1985-2012  Health Research Inc.,                         *                            
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *                            
-C=* Email: spider@@health.ny.gov                                        *                            
+C=* Email: spider@@wadsworth.org                                        *                            
 C=*                                                                    *                            
 C=* SPIDER is free software; you can redistribute it and/or            *                            
 C=* modify it under the terms of the GNU General Public License as     *                            
@@ -548,6 +553,17 @@ c$omp    parallel do private(iy,yi,ycod,ysid, ix,xi,xold,yold)
 @
 
 
+1.24
+log
+@email_health_dept
+@
+text
+@d19 1
+a19 1
+C=* Email: spider@@health.ny.gov                                        *                            
+@
+
+
 1.23
 log
 @sub: RTSQ_PADIN added (could replace all rtsq uses)_
diff --git src/RCS/rys1.f,v src/RCS/rys1.f,v
index 8960013c..da7b770b 100644
--- src/RCS/rys1.f,v
+++ src/RCS/rys1.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.33.45;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.34.16;	author leith;	state Exp;
 branches;
@@ -70,9 +75,9 @@ desc
 @
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -86,7 +91,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -154,6 +159,17 @@ C***********************************************************************
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @GPL_2010
diff --git src/RCS/rys3.f,v src/RCS/rys3.f,v
index 5c1e4163..00b11995 100644
--- src/RCS/rys3.f,v
+++ src/RCS/rys3.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.33.45;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.34.16;	author leith;	state Exp;
 branches;
@@ -70,9 +75,9 @@ desc
 @
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -86,7 +91,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -147,6 +152,17 @@ C***********************************************************************
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @GPL_2010
diff --git src/RCS/saqb.f,v src/RCS/saqb.f,v
index 23132df0..8fef6a27 100644
--- src/RCS/saqb.f,v
+++ src/RCS/saqb.f,v
@@ -1,4 +1,4 @@
-head	1.29;
+head	1.30;
 access;
 symbols
 	pre_mrcs:1.29
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.30
+date	2025.11.10.22.33.45;	author dean;	state Exp;
+branches;
+next	1.29;
+
 1.29
 date	2018.10.03.14.34.16;	author leith;	state Exp;
 branches;
@@ -175,9 +180,9 @@ desc
 @
 
 
-1.29
+1.30
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -192,7 +197,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2012  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -934,6 +939,17 @@ C        CALCULATE DISTANCES ...
 @
 
 
+1.29
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.28
 log
 @RDPRI1S BUG,COMMON REMOVED,COSMETIC
diff --git src/RCS/savd.f,v src/RCS/savd.f,v
index 298c8d15..ac31ec19 100644
--- src/RCS/savd.f,v
+++ src/RCS/savd.f,v
@@ -1,4 +1,4 @@
-head	1.15;
+head	1.16;
 access;
 symbols
 	pre_mrcs:1.15
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.16
+date	2025.11.10.22.33.45;	author dean;	state Exp;
+branches;
+next	1.15;
+
 1.15
 date	2018.10.03.14.34.16;	author leith;	state Exp;
 branches;
@@ -105,9 +110,9 @@ desc
 @
 
 
-1.15
+1.16
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -123,7 +128,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -202,6 +207,17 @@ C          GET NAME AND OPEN THE DOC FILE, SETS NDOC
 @
 
 
+1.15
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.14
 log
 @GPL_2010
diff --git src/RCS/savdn1.f,v src/RCS/savdn1.f,v
index 8fedcff1..33950834 100644
--- src/RCS/savdn1.f,v
+++ src/RCS/savdn1.f,v
@@ -1,4 +1,4 @@
-head	1.24;
+head	1.25;
 access;
 symbols
 	pre_mrcs:1.24
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.25
+date	2025.11.10.22.33.45;	author dean;	state Exp;
+branches;
+next	1.24;
+
 1.24
 date	2018.10.03.14.34.16;	author leith;	state Exp;
 branches;
@@ -150,9 +155,9 @@ desc
 @
 
 
-1.24
+1.25
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -170,7 +175,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -245,6 +250,17 @@ C       PUT REGISTERS IN DOC FILE
 @
 
 
+1.24
+log
+@email_health_dept
+@
+text
+@d16 1
+a16 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.23
 log
 @GPL_2010
diff --git src/RCS/savdocq.f,v src/RCS/savdocq.f,v
index d833aeba..4208ec51 100644
--- src/RCS/savdocq.f,v
+++ src/RCS/savdocq.f,v
@@ -1,4 +1,4 @@
-head	1.28;
+head	1.29;
 access;
 symbols
 	pre_mrcs:1.28
@@ -25,6 +25,11 @@ locks; strict;
 comment	@c @;
 
 
+1.29
+date	2025.11.10.22.33.45;	author dean;	state Exp;
+branches;
+next	1.28;
+
 1.28
 date	2018.10.03.14.34.16;	author leith;	state Exp;
 branches;
@@ -171,9 +176,9 @@ desc
 @
 
 
-1.28
+1.29
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -196,7 +201,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -385,6 +390,17 @@ C       LEAVE FILE OPEN, FOR NEXT USE
 @
 
 
+1.28
+log
+@email_health_dept
+@
+text
+@d21 1
+a21 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.27
 log
 @can substitute comment keys
diff --git src/RCS/sclassi.f,v src/RCS/sclassi.f,v
index 9cdfca56..a6633b4e 100644
--- src/RCS/sclassi.f,v
+++ src/RCS/sclassi.f,v
@@ -1,4 +1,4 @@
-head	1.27;
+head	1.28;
 access;
 symbols
 	pre_mrcs:1.27
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.28
+date	2025.11.10.22.33.45;	author dean;	state Exp;
+branches;
+next	1.27;
+
 1.27
 date	2018.10.03.14.34.16;	author leith;	state Exp;
 branches;
@@ -165,9 +170,9 @@ desc
 @
 
 
-1.27
+1.28
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -192,7 +197,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2017  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -422,6 +427,17 @@ C       READS: LUNI AND LUNK (WRITTEN FROM NOYAU)
 
 
 
+@
+
+
+1.27
+log
+@email_health_dept
+@
+text
+@d23 1
+a23 1
+C=* Email: spider@@health.ny.gov                                        *
 @
 
 
diff --git src/RCS/scoran3.f,v src/RCS/scoran3.f,v
index 2c99fa06..9e3bb032 100644
--- src/RCS/scoran3.f,v
+++ src/RCS/scoran3.f,v
@@ -1,4 +1,4 @@
-head	1.32;
+head	1.33;
 access;
 symbols
 	pre_mrcs:1.32
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.33
+date	2025.11.10.22.33.45;	author dean;	state Exp;
+branches;
+next	1.32;
+
 1.32
 date	2018.10.03.14.34.16;	author leith;	state Exp;
 branches;
@@ -190,9 +195,9 @@ desc
 @
 
 
-1.32
+1.33
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -209,7 +214,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -348,6 +353,17 @@ C       SAVE EIGENVECTORS ARRAY TO _EIG FILE
 @
 
 
+1.32
+log
+@email_health_dept
+@
+text
+@d15 1
+a15 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.31
 log
 @GPL_2010
diff --git src/RCS/sdocic.f,v src/RCS/sdocic.f,v
index a9443427..9cf65ffe 100644
--- src/RCS/sdocic.f,v
+++ src/RCS/sdocic.f,v
@@ -1,4 +1,4 @@
-head	1.16;
+head	1.17;
 access;
 symbols
 	pre_mrcs:1.16
@@ -21,6 +21,11 @@ locks; strict;
 comment	@c @;
 
 
+1.17
+date	2025.11.10.22.33.45;	author dean;	state Exp;
+branches;
+next	1.16;
+
 1.16
 date	2018.10.03.14.34.16;	author leith;	state Exp;
 branches;
@@ -106,9 +111,9 @@ desc
 @@
 
 
-1.16
+1.17
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -127,7 +132,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -297,6 +302,17 @@ C       RETRIEVE DATA FROM REGISTER(S) LISTED IN NSEL INTO: IPQ(ILOC+1)
 @
 
 
+1.16
+log
+@email_health_dept
+@
+text
+@d17 1
+a17 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.15
 log
 @GPL_2010
diff --git src/RCS/searchq.f,v src/RCS/searchq.f,v
index eafcb4f9..50ce8692 100644
--- src/RCS/searchq.f,v
+++ src/RCS/searchq.f,v
@@ -1,4 +1,4 @@
-head	1.26;
+head	1.27;
 access;
 symbols
 	pre_mrcs:1.26
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.27
+date	2025.11.10.22.33.45;	author dean;	state Exp;
+branches;
+next	1.26;
+
 1.26
 date	2018.10.03.14.34.16;	author leith;	state Exp;
 branches;
@@ -160,9 +165,9 @@ desc
 @
 
 
-1.26
+1.27
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -183,7 +188,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2015  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -293,6 +298,17 @@ C                FOUND DESIRED DO-LOOP, CAN RETURN NOW
 @
 
 
+1.26
+log
+@email_health_dept
+@
+text
+@d19 1
+a19 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.25
 log
 @==
diff --git src/RCS/secnds.f,v src/RCS/secnds.f,v
index b0f932d7..21cedb9a 100644
--- src/RCS/secnds.f,v
+++ src/RCS/secnds.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.33.45;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.34.16;	author leith;	state Exp;
 branches;
@@ -70,9 +75,9 @@ desc
 @
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @ 
@@ -89,7 +94,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -141,6 +146,17 @@ C       I DO NOT KNOW IF SAVE IS NEEDED FEB 99 al
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d15 1
+a15 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @GPL_2010
diff --git src/RCS/seedfill.f,v src/RCS/seedfill.f,v
index c0dbe91b..c39acb2e 100644
--- src/RCS/seedfill.f,v
+++ src/RCS/seedfill.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.33.45;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.16;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -91,7 +96,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -272,6 +277,17 @@ C          ADD LOCATION FROM PREVIOUS LINE
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @enter
diff --git src/RCS/seeds.f,v src/RCS/seeds.f,v
index e7719c9b..ca756b32 100644
--- src/RCS/seeds.f,v
+++ src/RCS/seeds.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.33.45;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.16;	author leith;	state Exp;
 branches;
@@ -85,9 +90,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -101,7 +106,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -183,6 +188,17 @@ C2      CIRSEED(I,2) = CIRC(I,MAX)
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @output formating, cosmetic
diff --git src/RCS/semis.f,v src/RCS/semis.f,v
index c0537425..8f125b9a 100644
--- src/RCS/semis.f,v
+++ src/RCS/semis.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.33.45;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.16;	author leith;	state Exp;
 branches;
@@ -85,9 +90,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -100,7 +105,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2013  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -208,6 +213,17 @@ C     CALL PRINCIPAL ROUTINE FOR CALCULATIONS
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @detab
diff --git src/RCS/setenv.f,v src/RCS/setenv.f,v
index a1f210b1..d8cb520a 100644
--- src/RCS/setenv.f,v
+++ src/RCS/setenv.f,v
@@ -1,4 +1,4 @@
-head	1.13;
+head	1.14;
 access;
 symbols
 	pre_mrcs:1.13
@@ -21,6 +21,11 @@ locks; strict;
 comment	@c @;
 
 
+1.14
+date	2025.11.10.22.33.45;	author dean;	state Exp;
+branches;
+next	1.13;
+
 1.13
 date	2018.10.03.14.34.16;	author leith;	state Exp;
 branches;
@@ -91,9 +96,9 @@ desc
 @@
 
 
-1.13
+1.14
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -109,7 +114,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2013  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -171,6 +176,17 @@ C       SET THE ENVIRONMENT VARIABLE
 @
 
 
+1.13
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.12
 log
 @ev not in gfort error call removed
diff --git src/RCS/sethedccp4.f,v src/RCS/sethedccp4.f,v
index 5ae6bed8..7491ca5f 100644
--- src/RCS/sethedccp4.f,v
+++ src/RCS/sethedccp4.f,v
@@ -1,4 +1,4 @@
-head	1.22;
+head	1.23;
 access;
 symbols
 	pre_mrcs:1.22
@@ -20,6 +20,11 @@ locks; strict;
 comment	@c @;
 
 
+1.23
+date	2025.09.21.15.13.51;	author dean;	state Exp;
+branches;
+next	1.22;
+
 1.22
 date	2018.10.03.14.34.16;	author leith;	state Exp;
 branches;
@@ -135,9 +140,9 @@ desc
 @@
 
 
-1.22
+1.23
 log
-@email_health_dept
+@gfort complains
 @
 text
 @
@@ -405,6 +410,59 @@ C          WRITE OUT HEADER INFORMATION
 #endif
 
 
+C ------------------------- CCPMVC --------------------------
+
+C     PURPOSE:     PACK 4 CHAR INTO A INTEGER OR FLOAT
+
+C     PARAMETERS:
+C     I1ARRAY      ARRAY TO WHICH CHARS ARE TO BE COPIED       RET.
+C     CIN          CHAR STRING TO BE COPIED INTO I1ARRAY       SENT
+C     REVERSE      FLAG TO INVERT STRING                       SENT
+
+      SUBROUTINE CCPMVC(I1ARRAY,CIN,REVERSE)
+
+      CHARACTER(LEN=4) :: CIN
+      INTEGER * 1      :: I1ARRAY(4)
+      LOGICAL          :: REVERSE
+
+      IF (REVERSE) THEN
+         DO I = 1,4
+            I1ARRAY(I) = ICHAR(CIN(5-I:5-I))
+         ENDDO
+      ELSE
+         DO I = 1,4
+            I1ARRAY(I) = ICHAR(CIN(I:I))
+         ENDDO
+      ENDIF
+
+      END
+
+
+C ------------------------ CCPMVI -------------------------------
+
+      SUBROUTINE CCPMVI (ARR1,ARR2,NUM)
+
+C     PURPOSE:  ASSIGNS THE FIRST NUM WORDS OF ARR2 TO ARR1
+
+      INTEGER  :: NUM
+      REAL     :: ARR1(*),ARR2(*)
+      INTEGER  :: J
+
+      DO J=1,NUM
+         ARR1(J) = ARR2(J)
+      ENDDO
+
+      END
+ 
+@
+
+
+1.22
+log
+@email_health_dept
+@
+text
+@a265 238
 
 
 C ******************************** SETHEDCCP4 *****************************
@@ -643,33 +701,7 @@ C       NOW GO BACK AND ADD IN ONE LABEL
 
 
 
-C ------------------------- CCPMVC --------------------------
-
-C     PURPOSE:     PACK 4 CHAR INTO A INTEGER OR FLOAT
-
-C     PARAMETERS:
-C     I1ARRAY      ARRAY TO WHICH CHARS ARE TO BE COPIED       RET.
-C     CIN          CHAR STRING TO BE COPIED INTO I1ARRAY       SENT
-C     REVERSE      FLAG TO INVERT STRING                       SENT
-
-      SUBROUTINE CCPMVC(I1ARRAY,CIN,REVERSE)
-
-      CHARACTER(LEN=4) :: CIN
-      INTEGER * 1      :: I1ARRAY(4)
-      LOGICAL          :: REVERSE
-
-      IF (REVERSE) THEN
-         DO I = 1,4
-            I1ARRAY(I) = ICHAR(CIN(5-I:5-I))
-         ENDDO
-      ELSE
-         DO I = 1,4
-            I1ARRAY(I) = ICHAR(CIN(I:I))
-         ENDDO
-      ENDIF
-
-      END
-
+d293 17
 @
 
 
diff --git src/RCS/setnumrings.f,v src/RCS/setnumrings.f,v
index 4c544f59..f3907c2a 100644
--- src/RCS/setnumrings.f,v
+++ src/RCS/setnumrings.f,v
@@ -1,4 +1,4 @@
-head	1.2;
+head	1.3;
 access;
 symbols
 	pre_mrcs:1.2
@@ -7,6 +7,11 @@ locks; strict;
 comment	@c @;
 
 
+1.3
+date	2025.11.10.22.33.46;	author dean;	state Exp;
+branches;
+next	1.2;
+
 1.2
 date	2018.10.03.14.34.16;	author leith;	state Exp;
 branches;
@@ -22,9 +27,9 @@ desc
 @@
 
 
-1.2
+1.3
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -36,7 +41,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* Authors: J. Frank & A. Leith                                       *
 C=* Copyright 1985-2012  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -183,6 +188,17 @@ C          ALL THE RINGS ARE POWER-OF-TWO. ADD 2 TO LEN TO USE FFT.
 @
 
 
+1.2
+log
+@email_health_dept
+@
+text
+@d10 1
+a10 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.1
 log
 @Initial revision
diff --git src/RCS/setprm.f,v src/RCS/setprm.f,v
index 737a8de6..473b7c2b 100644
--- src/RCS/setprm.f,v
+++ src/RCS/setprm.f,v
@@ -1,4 +1,4 @@
-head	1.14;
+head	1.15;
 access;
 symbols
 	pre_mrcs:1.14
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.15
+date	2025.11.10.22.33.46;	author dean;	state Exp;
+branches;
+next	1.14;
+
 1.14
 date	2018.10.03.14.34.16;	author leith;	state Exp;
 branches;
@@ -100,9 +105,9 @@ desc
 @
 
 
-1.14
+1.15
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -117,7 +122,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -166,6 +171,17 @@ C     'CMBLOCK HOLDS SIG!!
 @
 
 
+1.14
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.13
 log
 @GPL_2010
diff --git src/RCS/setsympar.f,v src/RCS/setsympar.f,v
index 9823f520..7741147d 100644
--- src/RCS/setsympar.f,v
+++ src/RCS/setsympar.f,v
@@ -1,4 +1,4 @@
-head	1.29;
+head	1.30;
 access;
 symbols
 	pre_mrcs:1.29
@@ -22,6 +22,11 @@ locks; strict;
 comment	@c @;
 
 
+1.30
+date	2025.11.10.22.33.46;	author dean;	state Exp;
+branches;
+next	1.29;
+
 1.29
 date	2018.10.03.14.34.16;	author leith;	state Exp;
 branches;
@@ -173,9 +178,9 @@ desc
 @
 
 
-1.29
+1.30
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -199,7 +204,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2015  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -973,6 +978,17 @@ C     RETURN IF NO ASSOCIATED VALUE xlf90 compiler bug hack
 @
 
 
+1.29
+log
+@email_health_dept
+@
+text
+@d22 1
+a22 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.28
 log
 @==, detab
diff --git src/RCS/setthreads.f,v src/RCS/setthreads.f,v
index 3e375979..33a7da58 100644
--- src/RCS/setthreads.f,v
+++ src/RCS/setthreads.f,v
@@ -1,4 +1,4 @@
-head	1.5;
+head	1.6;
 access;
 symbols
 	pre_mrcs:1.5
@@ -22,6 +22,11 @@ locks; strict;
 comment	@c @;
 
 
+1.6
+date	2025.11.10.22.33.46;	author dean;	state Exp;
+branches;
+next	1.5;
+
 1.5
 date	2018.10.03.14.34.16;	author leith;	state Exp;
 branches;
@@ -52,9 +57,9 @@ desc
 @@
 
 
-1.5
+1.6
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -69,7 +74,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -113,6 +118,17 @@ C      IBM SP HAS PROBLEMS WITH THIS AT NERSC
 @
 
 
+1.5
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.4
 log
 @GPL_2010
diff --git src/RCS/setval.f,v src/RCS/setval.f,v
index f62945b3..7847f744 100644
--- src/RCS/setval.f,v
+++ src/RCS/setval.f,v
@@ -1,4 +1,4 @@
-head	1.23;
+head	1.24;
 access;
 symbols
 	pre_mrcs:1.19
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.24
+date	2025.09.21.14.39.36;	author dean;	state Exp;
+branches;
+next	1.23;
+
 1.23
 date	2019.12.03.19.41.57;	author leith;	state Exp;
 branches;
@@ -145,10 +150,10 @@ desc
 @
 
 
-1.23
+1.24
 log
-@> 10      IF (IS_MRC) THEN
->           CALL RDPRMC(SET,NCHAR,.TRUE.,
+@./coi    setval.f
+gfort compile error fixed
 @
 text
 @
@@ -402,7 +407,8 @@ C         OUTPUT FILE MUST EXIST, IT IS NOT CREATED HERE.
           CALL LUNGETIS_MRC(LUN2,IS_MRC2,IRTFLG)
           IF (IRTFLG .NE. 0) GOTO 9000
 
-          IF (IS_MRC .NE. IS_MRC2) THEN
+C          IF (IS_MRC .NE. IS_MRC2) THEN !gfort error,  Sept 2025 al
+          IF (IS_MRC .NEQV. IS_MRC2) THEN 
              CALL ERRT(101,'INPUT/OUTPUT MUST BE SAME MRC/SPIDER',IDUM)
              IRTFLG =1
              GOTO 9000
@@ -491,6 +497,18 @@ C          UNKNOWN OPTION ------------------------------------------- ?
 @
 
 
+1.23
+log
+@> 10      IF (IS_MRC) THEN
+>           CALL RDPRMC(SET,NCHAR,.TRUE.,
+@
+text
+@d252 2
+a253 1
+          IF (IS_MRC .NE. IS_MRC2) THEN
+@
+
+
 1.22
 log
 @mrc
diff --git src/RCS/sgraf.f,v src/RCS/sgraf.f,v
index 252c36ef..81176f85 100644
--- src/RCS/sgraf.f,v
+++ src/RCS/sgraf.f,v
@@ -1,4 +1,4 @@
-head	1.47;
+head	1.48;
 access;
 symbols
 	pre_mrcs:1.47
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.48
+date	2025.11.10.22.33.46;	author dean;	state Exp;
+branches;
+next	1.47;
+
 1.47
 date	2018.10.03.14.34.16;	author leith;	state Exp;
 branches;
@@ -265,9 +270,9 @@ desc
 @
 
 
-1.47
+1.48
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -292,7 +297,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -746,6 +751,17 @@ C **********************************************************************
 @
 
 
+1.47
+log
+@email_health_dept
+@
+text
+@d23 1
+a23 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.46
 log
 @enter
diff --git src/RCS/sh180_2.f,v src/RCS/sh180_2.f,v
index 0d8716b9..5c248119 100644
--- src/RCS/sh180_2.f,v
+++ src/RCS/sh180_2.f,v
@@ -1,4 +1,4 @@
-head	1.12;
+head	1.13;
 access;
 symbols
 	pre_mrcs:1.12
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.13
+date	2025.11.10.22.33.46;	author dean;	state Exp;
+branches;
+next	1.12;
+
 1.12
 date	2018.10.03.14.34.16;	author leith;	state Exp;
 branches;
@@ -90,9 +95,9 @@ desc
 @
 
 
-1.12
+1.13
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -105,7 +110,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -174,6 +179,17 @@ c$omp parallel do private(i,j,arg,argy,iy,ix)
 @
 
 
+1.12
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.11
 log
 @GPL_2010
diff --git src/RCS/shelk.f,v src/RCS/shelk.f,v
index d8e64c97..42712409 100644
--- src/RCS/shelk.f,v
+++ src/RCS/shelk.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.33.47;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.16;	author leith;	state Exp;
 branches;
@@ -80,9 +85,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C **********************************************************************
@@ -94,7 +99,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -162,6 +167,17 @@ C     I DO NOT KNOW IF SAVE IS NEEDED FEB 99 al
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d10 1
+a10 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @GPL_2010
diff --git src/RCS/shfc_2.f,v src/RCS/shfc_2.f,v
index c58daebc..67e0d863 100644
--- src/RCS/shfc_2.f,v
+++ src/RCS/shfc_2.f,v
@@ -1,4 +1,4 @@
-head	1.12;
+head	1.13;
 access;
 symbols
 	pre_mrcs:1.12
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.13
+date	2025.11.10.22.33.47;	author dean;	state Exp;
+branches;
+next	1.12;
+
 1.12
 date	2018.10.03.14.34.16;	author leith;	state Exp;
 branches;
@@ -90,9 +95,9 @@ desc
 @
 
 
-1.12
+1.13
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -105,7 +110,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -174,6 +179,17 @@ C       CALL  FMRS_2(Y,NSAM,NROW,INS)
 @
 
 
+1.12
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.11
 log
 @GPL_2010
diff --git src/RCS/shfi_2.f,v src/RCS/shfi_2.f,v
index de885753..8ce63ea0 100644
--- src/RCS/shfi_2.f,v
+++ src/RCS/shfi_2.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.33.47;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.16;	author leith;	state Exp;
 branches;
@@ -80,9 +85,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -95,7 +100,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -154,6 +159,17 @@ c$omp parallel do private(i,k,yi,yold,xi,xold)
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @GPL_2010
diff --git src/RCS/shfi_q.f,v src/RCS/shfi_q.f,v
index 2dd5dbdd..fdbce026 100644
--- src/RCS/shfi_q.f,v
+++ src/RCS/shfi_q.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.33.47;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.34.16;	author leith;	state Exp;
 branches;
@@ -69,9 +74,9 @@ desc
 @@
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -84,7 +89,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -139,6 +144,17 @@ c$omp parallel do private(i,k,yi,yold,xi,xold)
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @GPL_2010
diff --git src/RCS/shfm_2.f,v src/RCS/shfm_2.f,v
index c444a555..49732cae 100644
--- src/RCS/shfm_2.f,v
+++ src/RCS/shfm_2.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.33.47;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.16;	author leith;	state Exp;
 branches;
@@ -85,9 +90,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -100,7 +105,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -164,6 +169,17 @@ C       CALL  FMRS_2(X,NSAM,NROW,INS)
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @GPL_2010
diff --git src/RCS/shift1.f,v src/RCS/shift1.f,v
index c5fd7d55..79415025 100644
--- src/RCS/shift1.f,v
+++ src/RCS/shift1.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.33.47;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.16;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -91,7 +96,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -131,6 +136,17 @@ C--*******************************************************************
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/shift2.f,v src/RCS/shift2.f,v
index 84e80138..839cb2b8 100644
--- src/RCS/shift2.f,v
+++ src/RCS/shift2.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.33.47;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.16;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -91,7 +96,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -146,6 +151,17 @@ C--*******************************************************************
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/shift3.f,v src/RCS/shift3.f,v
index 1720c645..b4603947 100644
--- src/RCS/shift3.f,v
+++ src/RCS/shift3.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.33.47;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.34.16;	author leith;	state Exp;
 branches;
@@ -70,9 +75,9 @@ desc
 @
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -85,7 +90,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -131,6 +136,17 @@ C
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @GPL_2010
diff --git src/RCS/shift_3d.f,v src/RCS/shift_3d.f,v
index a737c92f..76035327 100644
--- src/RCS/shift_3d.f,v
+++ src/RCS/shift_3d.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.33.47;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.34.16;	author leith;	state Exp;
 branches;
@@ -70,9 +75,9 @@ desc
 @
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -85,7 +90,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -187,6 +192,17 @@ C
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @GPL_2010
diff --git src/RCS/shift_pf.f,v src/RCS/shift_pf.f,v
index 122b59dc..1cb3f326 100644
--- src/RCS/shift_pf.f,v
+++ src/RCS/shift_pf.f,v
@@ -1,4 +1,4 @@
-head	1.12;
+head	1.13;
 access;
 symbols
 	pre_mrcs:1.12
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.13
+date	2025.11.10.22.33.47;	author dean;	state Exp;
+branches;
+next	1.12;
+
 1.12
 date	2018.10.03.14.34.16;	author leith;	state Exp;
 branches;
@@ -90,9 +95,9 @@ desc
 @
 
 
-1.12
+1.13
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -106,7 +111,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -172,6 +177,17 @@ c$omp   parallel do private(i,j,k,arg,argy,argz,iz,iy,ix)
 @
 
 
+1.12
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.11
 log
 @==, nx, cosmetic
diff --git src/RCS/shiftr.f,v src/RCS/shiftr.f,v
index 588aeb6c..52019d02 100644
--- src/RCS/shiftr.f,v
+++ src/RCS/shiftr.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.33.47;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.16;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -90,7 +95,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -214,6 +219,17 @@ C201	FORMAT(16F7.3)
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/shifts.f,v src/RCS/shifts.f,v
index 55dccc98..48bd783d 100644
--- src/RCS/shifts.f,v
+++ src/RCS/shifts.f,v
@@ -1,4 +1,4 @@
-head	1.6;
+head	1.7;
 access;
 symbols
 	pre_mrcs:1.6
@@ -7,6 +7,11 @@ locks; strict;
 comment	@c @;
 
 
+1.7
+date	2025.11.10.22.33.47;	author dean;	state Exp;
+branches;
+next	1.6;
+
 1.6
 date	2018.10.03.14.34.19;	author leith;	state Exp;
 branches;
@@ -42,9 +47,9 @@ desc
 @@
 
 
-1.6
+1.7
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -58,7 +63,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -640,6 +645,17 @@ C
 @
 
 
+1.6
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.5
 log
 @sh f used for intger fourier shifting now.
diff --git src/RCS/shiftt.f,v src/RCS/shiftt.f,v
index e9a7f8c9..a50b6c91 100644
--- src/RCS/shiftt.f,v
+++ src/RCS/shiftt.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.33.47;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.34.22;	author leith;	state Exp;
 branches;
@@ -70,9 +75,9 @@ desc
 @
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*******************************************************************
@@ -85,7 +90,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -163,6 +168,17 @@ C
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @GPL_2010
diff --git src/RCS/shosli.f,v src/RCS/shosli.f,v
index b87c527d..ced3a48a 100644
--- src/RCS/shosli.f,v
+++ src/RCS/shosli.f,v
@@ -1,4 +1,4 @@
-head	1.7;
+head	1.8;
 access;
 symbols
 	pre_mrcs:1.7
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.8
+date	2025.11.10.22.33.47;	author dean;	state Exp;
+branches;
+next	1.7;
+
 1.7
 date	2018.10.03.14.34.22;	author leith;	state Exp;
 branches;
@@ -65,9 +70,9 @@ desc
 @
 
 
-1.7
+1.8
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -81,7 +86,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -129,6 +134,17 @@ C--********************************************************************
 @
 
 
+1.7
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.6
 log
 @GPL_2010
diff --git src/RCS/shosli2.f,v src/RCS/shosli2.f,v
index 2bd6da14..0255de08 100644
--- src/RCS/shosli2.f,v
+++ src/RCS/shosli2.f,v
@@ -1,4 +1,4 @@
-head	1.6;
+head	1.7;
 access;
 symbols
 	pre_mrcs:1.6
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.7
+date	2025.11.10.22.33.47;	author dean;	state Exp;
+branches;
+next	1.6;
+
 1.6
 date	2018.10.03.14.34.22;	author leith;	state Exp;
 branches;
@@ -60,9 +65,9 @@ desc
 @
 
 
-1.6
+1.7
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -76,7 +81,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -125,6 +130,17 @@ C--*********************************************************************
 @
 
 
+1.6
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.5
 log
 @GPL_2010
diff --git src/RCS/shr.f,v src/RCS/shr.f,v
index 50c9f1a5..0756c6d2 100644
--- src/RCS/shr.f,v
+++ src/RCS/shr.f,v
@@ -1,4 +1,4 @@
-head	1.14;
+head	1.15;
 access;
 symbols
 	pre_mrcs:1.14
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.15
+date	2025.11.10.22.33.47;	author dean;	state Exp;
+branches;
+next	1.14;
+
 1.14
 date	2018.10.03.14.34.22;	author leith;	state Exp;
 branches;
@@ -100,9 +105,9 @@ desc
 @
 
 
-1.14
+1.15
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -116,7 +121,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -212,6 +217,17 @@ C **********************************************************************
 @
 
 
+1.14
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.13
 log
 @GPL_2010
diff --git src/RCS/shrinkq.f,v src/RCS/shrinkq.f,v
index a4b05ac7..9eb13995 100644
--- src/RCS/shrinkq.f,v
+++ src/RCS/shrinkq.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -25,6 +25,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.33.47;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.34.22;	author leith;	state Exp;
 branches;
@@ -71,9 +76,9 @@ desc
 @
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -87,7 +92,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -143,6 +148,17 @@ C          PUT BLANKS AT END OF OUTSTR
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @GPL_2010
diff --git src/RCS/shuffledoc.f,v src/RCS/shuffledoc.f,v
index 5f22e47a..c5e3dd31 100644
--- src/RCS/shuffledoc.f,v
+++ src/RCS/shuffledoc.f,v
@@ -1,4 +1,4 @@
-head	1.21;
+head	1.22;
 access;
 symbols
 	pre_mrcs:1.21
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.22
+date	2025.11.10.22.33.47;	author dean;	state Exp;
+branches;
+next	1.21;
+
 1.21
 date	2018.10.03.14.34.22;	author leith;	state Exp;
 branches;
@@ -135,9 +140,9 @@ desc
 @
 
 
-1.21
+1.22
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -154,7 +159,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2013  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -295,6 +300,17 @@ C         CREATE RANDOM IVAL IN RANGE 0...ILINE-1
 @
 
 
+1.21
+log
+@email_health_dept
+@
+text
+@d15 1
+a15 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.20
 log
 @prompts
diff --git src/RCS/single.f,v src/RCS/single.f,v
index 8547d645..abcfb5fe 100644
--- src/RCS/single.f,v
+++ src/RCS/single.f,v
@@ -1,4 +1,4 @@
-head	1.14;
+head	1.15;
 access;
 symbols
 	pre_mrcs:1.14
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.15
+date	2025.11.10.22.33.47;	author dean;	state Exp;
+branches;
+next	1.14;
+
 1.14
 date	2018.10.03.14.34.23;	author leith;	state Exp;
 branches;
@@ -100,9 +105,9 @@ desc
 @
 
 
-1.14
+1.15
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -117,7 +122,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -219,6 +224,17 @@ C	GET POS FROM LATTICE OPTION
 @
 
 
+1.14
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.13
 log
 @LEN=MAXNAM):: DOCNAM
diff --git src/RCS/sizchk.f,v src/RCS/sizchk.f,v
index a8ab3438..e616b080 100644
--- src/RCS/sizchk.f,v
+++ src/RCS/sizchk.f,v
@@ -1,4 +1,4 @@
-head	1.3;
+head	1.4;
 access;
 symbols
 	pre_mrcs:1.3
@@ -8,6 +8,11 @@ locks; strict;
 comment	@c @;
 
 
+1.4
+date	2025.11.10.22.33.48;	author dean;	state Exp;
+branches;
+next	1.3;
+
 1.3
 date	2018.10.03.14.34.23;	author leith;	state Exp;
 branches;
@@ -28,9 +33,9 @@ desc
 @@
 
 
-1.3
+1.4
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -44,7 +49,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -113,6 +118,17 @@ C           EXISTING STACK FILE FORMAT NOT SAME AS PREVIOUS FORMAT
 @
 
 
+1.3
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.2
 log
 @nx..
diff --git src/RCS/skeleton.f,v src/RCS/skeleton.f,v
index fda66d16..696ec72a 100644
--- src/RCS/skeleton.f,v
+++ src/RCS/skeleton.f,v
@@ -1,4 +1,4 @@
-head	1.5;
+head	1.6;
 access;
 symbols
 	pre_mrcs:1.5
@@ -21,6 +21,11 @@ locks; strict;
 comment	@c @;
 
 
+1.6
+date	2025.11.10.22.33.48;	author dean;	state Exp;
+branches;
+next	1.5;
+
 1.5
 date	2018.10.03.14.34.23;	author leith;	state Exp;
 branches;
@@ -51,9 +56,9 @@ desc
 @@
 
 
-1.5
+1.6
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -67,7 +72,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -288,6 +293,17 @@ C       OUTPUT IMAGE
 @
 
 
+1.5
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.4
 log
 @GPL_2010
diff --git src/RCS/slice.f,v src/RCS/slice.f,v
index f43acc2e..017de494 100644
--- src/RCS/slice.f,v
+++ src/RCS/slice.f,v
@@ -1,4 +1,4 @@
-head	1.19;
+head	1.20;
 access;
 symbols
 	pre_mrcs:1.19
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.20
+date	2025.11.10.22.33.48;	author dean;	state Exp;
+branches;
+next	1.19;
+
 1.19
 date	2018.10.03.14.34.23;	author leith;	state Exp;
 branches;
@@ -125,9 +130,9 @@ desc
 @
 
 
-1.19
+1.20
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -143,7 +148,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -408,6 +413,17 @@ C          SQRT OF NEGATIVE NUMBER OR 1 PIXEL IMAGE
 @
 
 
+1.19
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.18
 log
 @GPL_2010
diff --git src/RCS/smt3.f,v src/RCS/smt3.f,v
index ae540466..2e3529e3 100644
--- src/RCS/smt3.f,v
+++ src/RCS/smt3.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.33.48;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.23;	author leith;	state Exp;
 branches;
@@ -85,9 +90,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -100,7 +105,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -156,6 +161,17 @@ cc$omp parallel do  private(kn,mk,mj,mi,l,i,j)
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @GPL_2010
diff --git src/RCS/smt3_q.f,v src/RCS/smt3_q.f,v
index 5dee5fd5..ee2c16da 100644
--- src/RCS/smt3_q.f,v
+++ src/RCS/smt3_q.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.33.48;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.23;	author leith;	state Exp;
 branches;
@@ -85,9 +90,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -100,7 +105,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -173,6 +178,17 @@ C       PUT ZEROS OUTSIDE ...
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @GPL_2010
diff --git src/RCS/snrb.f,v src/RCS/snrb.f,v
index ed2a5847..7fa798a2 100644
--- src/RCS/snrb.f,v
+++ src/RCS/snrb.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -20,6 +20,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.33.48;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.23;	author leith;	state Exp;
 branches;
@@ -70,9 +75,9 @@ desc
 @@
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -87,7 +92,7 @@ C=* This file is part of:                                              *
 C=* SPIDER - Modular Image Processing System.   Author: J. FRANK       *
 C=* Copyright 1985-2009  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -243,6 +248,17 @@ S0(X)=H(X)*X
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @maxnam needed
diff --git src/RCS/softmask.f,v src/RCS/softmask.f,v
index 4ed1feb5..3ec3b2f6 100644
--- src/RCS/softmask.f,v
+++ src/RCS/softmask.f,v
@@ -1,4 +1,4 @@
-head	1.6;
+head	1.7;
 access;
 symbols
 	pre_mrcs:1.6
@@ -7,6 +7,11 @@ locks; strict;
 comment	@c @;
 
 
+1.7
+date	2025.11.10.22.33.48;	author dean;	state Exp;
+branches;
+next	1.6;
+
 1.6
 date	2018.10.03.14.34.23;	author leith;	state Exp;
 branches;
@@ -42,9 +47,9 @@ desc
 @@
 
 
-1.6
+1.7
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -61,7 +66,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2018  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -538,6 +543,17 @@ C       OPEN NEXT SET OF I/O FILES
 
 
 
+@
+
+
+1.6
+log
+@email_health_dept
+@
+text
+@d15 1
+a15 1
+C=* Email: spider@@health.ny.gov                                        *
 @
 
 
diff --git src/RCS/solv2d.f,v src/RCS/solv2d.f,v
index ef8ef343..175f04d1 100644
--- src/RCS/solv2d.f,v
+++ src/RCS/solv2d.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.33.48;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.34.23;	author leith;	state Exp;
 branches;
@@ -70,9 +75,9 @@ desc
 @
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -86,7 +91,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -159,6 +164,17 @@ C       ***********
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @GPL_2010
diff --git src/RCS/solve.f,v src/RCS/solve.f,v
index 35264a65..5f7cdc13 100644
--- src/RCS/solve.f,v
+++ src/RCS/solve.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.33.48;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.34.23;	author leith;	state Exp;
 branches;
@@ -70,9 +75,9 @@ desc
 @
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -86,7 +91,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -194,6 +199,17 @@ C      SUBTRACT UPWARDS
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @GPL_2010
diff --git src/RCS/sort.f,v src/RCS/sort.f,v
index 7b47bb64..a34e7589 100644
--- src/RCS/sort.f,v
+++ src/RCS/sort.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.33.48;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.34.23;	author leith;	state Exp;
 branches;
@@ -70,9 +75,9 @@ desc
 @
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*******************************************************************
@@ -85,7 +90,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -431,6 +436,17 @@ C     IF THE SEQUENCE IS 11 OR LESS LONG, SORT IT BY A SHELLSORT.
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @GPL_2010
diff --git src/RCS/sorti.f,v src/RCS/sorti.f,v
index 7ec40f96..93e90ec8 100644
--- src/RCS/sorti.f,v
+++ src/RCS/sorti.f,v
@@ -1,4 +1,4 @@
-head	1.2;
+head	1.3;
 access;
 symbols
 	pre_mrcs:1.2
@@ -7,6 +7,11 @@ locks; strict;
 comment	@c @;
 
 
+1.3
+date	2025.11.10.22.33.49;	author dean;	state Exp;
+branches;
+next	1.2;
+
 1.2
 date	2018.10.03.14.34.23;	author leith;	state Exp;
 branches;
@@ -23,9 +28,9 @@ desc
 @
 
 
-1.2
+1.3
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -38,7 +43,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim FIRAnk & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU GeneIRAl Public License as     *
@@ -107,6 +112,17 @@ C***********************************************************************
 @
 
 
+1.2
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.1
 log
 @Initial revision
diff --git src/RCS/sortint.f,v src/RCS/sortint.f,v
index 5f5b4c33..bdd08f9b 100644
--- src/RCS/sortint.f,v
+++ src/RCS/sortint.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.33.49;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.23;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*******************************************************************
@@ -90,7 +95,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -233,6 +238,17 @@ C    IF THE SEQUENCE IS 11 OR LESS LONG, SORT IT BY A SHELLSORT.
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/sortz.f,v src/RCS/sortz.f,v
index cf7bb4ff..0f0a65e0 100644
--- src/RCS/sortz.f,v
+++ src/RCS/sortz.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.33.49;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.34.23;	author leith;	state Exp;
 branches;
@@ -70,9 +75,9 @@ desc
 @
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*******************************************************************
@@ -85,7 +90,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -258,6 +263,17 @@ C     IF THE SEQUENCE IS 11 OR LESS LONG, SORT IT BY A SHELLSORT.
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @GPL_2010
diff --git src/RCS/spdtotiff.f,v src/RCS/spdtotiff.f,v
index 3354fa25..af789d85 100644
--- src/RCS/spdtotiff.f,v
+++ src/RCS/spdtotiff.f,v
@@ -1,4 +1,4 @@
-head	1.24;
+head	1.25;
 access;
 symbols
 	pre_mrcs:1.24
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.25
+date	2025.11.10.22.33.49;	author dean;	state Exp;
+branches;
+next	1.24;
+
 1.24
 date	2018.10.03.14.34.23;	author leith;	state Exp;
 branches;
@@ -150,9 +155,9 @@ desc
 @
 
 
-1.24
+1.25
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -166,7 +171,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -392,6 +397,17 @@ C       SET FLAG FOR NORMAL RETURN
 @
 
 
+1.24
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.23
 log
 @improved
diff --git src/RCS/speak.f,v src/RCS/speak.f,v
index e06f8600..0e1bda33 100644
--- src/RCS/speak.f,v
+++ src/RCS/speak.f,v
@@ -1,4 +1,4 @@
-head	1.32;
+head	1.33;
 access;
 symbols
 	pre_mrcs:1.32
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.33
+date	2025.11.10.22.33.49;	author dean;	state Exp;
+branches;
+next	1.32;
+
 1.32
 date	2018.10.03.14.34.23;	author leith;	state Exp;
 branches;
@@ -190,9 +195,9 @@ desc
 @
 
 
-1.32
+1.33
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -207,7 +212,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2012  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -486,6 +491,17 @@ C        HACK FOR ALMOST BINARY PEAK ERROR
 @
 
 
+1.32
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.31
 log
 @enter
diff --git src/RCS/speak3.f,v src/RCS/speak3.f,v
index f4718504..aa95bdc2 100644
--- src/RCS/speak3.f,v
+++ src/RCS/speak3.f,v
@@ -1,4 +1,4 @@
-head	1.28;
+head	1.29;
 access;
 symbols
 	pre_mrcs:1.28
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.29
+date	2025.11.10.22.33.49;	author dean;	state Exp;
+branches;
+next	1.28;
+
 1.28
 date	2018.10.03.14.34.23;	author leith;	state Exp;
 branches;
@@ -170,9 +175,9 @@ desc
 @
 
 
-1.28
+1.29
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -191,7 +196,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2013  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -565,6 +570,17 @@ C             DO NOT MERGE IF, ALLOC ERROR ON SOME SYSTEMS
 @
 
 
+1.28
+log
+@email_health_dept
+@
+text
+@d17 1
+a17 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.27
 log
 @lundocret bug
diff --git src/RCS/speakc.f,v src/RCS/speakc.f,v
index 5a86e68b..087d3848 100644
--- src/RCS/speakc.f,v
+++ src/RCS/speakc.f,v
@@ -1,4 +1,4 @@
-head	1.28;
+head	1.29;
 access;
 symbols
 	pre_mrcs:1.28
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.29
+date	2025.11.10.22.33.49;	author dean;	state Exp;
+branches;
+next	1.28;
+
 1.28
 date	2018.10.03.14.34.23;	author leith;	state Exp;
 branches;
@@ -170,9 +175,9 @@ desc
 @
 
 
-1.28
+1.29
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -190,7 +195,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2012  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -655,6 +660,17 @@ C        SET SUB-PIXEL RESULTS IN COMMAND LINE REGISTERS 5..7
 @
 
 
+1.28
+log
+@email_health_dept
+@
+text
+@d16 1
+a16 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.27
 log
 @enter
diff --git src/RCS/speakm.f,v src/RCS/speakm.f,v
index 43f3a6ed..cf9613c0 100644
--- src/RCS/speakm.f,v
+++ src/RCS/speakm.f,v
@@ -1,4 +1,4 @@
-head	1.7;
+head	1.8;
 access;
 symbols
 	pre_mrcs:1.7
@@ -21,6 +21,11 @@ locks; strict;
 comment	@c @;
 
 
+1.8
+date	2025.11.10.22.33.49;	author dean;	state Exp;
+branches;
+next	1.7;
+
 1.7
 date	2018.10.03.14.34.23;	author leith;	state Exp;
 branches;
@@ -61,9 +66,9 @@ desc
 @@
 
 
-1.7
+1.8
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -78,7 +83,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2012  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -271,6 +276,17 @@ C           VOLUME, NOT IMPLEMENTED YET
 @
 
 
+1.7
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.6
 log
 @rewrite
diff --git src/RCS/speakr.f,v src/RCS/speakr.f,v
index 82a62b0f..544adb34 100644
--- src/RCS/speakr.f,v
+++ src/RCS/speakr.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -20,6 +20,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.33.49;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.23;	author leith;	state Exp;
 branches;
@@ -71,9 +76,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -89,7 +94,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2012  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -399,6 +404,17 @@ C        HACK FOR ALMOST BINARY PEAK ERROR
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @enter
diff --git src/RCS/sphdecon.f,v src/RCS/sphdecon.f,v
index d18eedee..814ced75 100644
--- src/RCS/sphdecon.f,v
+++ src/RCS/sphdecon.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -7,6 +7,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.33.49;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.23;	author leith;	state Exp;
 branches;
@@ -62,9 +67,9 @@ desc
 @@
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -77,7 +82,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -589,6 +594,17 @@ C      ************* Back to Cartesian *************
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @cosmetic & debug output removal
diff --git src/RCS/spider.f,v src/RCS/spider.f,v
index aa1dc59a..e52788ea 100644
--- src/RCS/spider.f,v
+++ src/RCS/spider.f,v
@@ -1,4 +1,4 @@
-head	1.500;
+head	1.504;
 access;
 symbols
 	pre_mrcs:1.494
@@ -25,6 +25,26 @@ locks; strict;
 comment	@c @;
 
 
+1.504
+date	2025.11.10.22.33.58;	author dean;	state Exp;
+branches;
+next	1.503;
+
+1.503
+date	2025.09.24.18.32.26;	author dean;	state Exp;
+branches;
+next	1.502;
+
+1.502
+date	2025.09.24.18.12.42;	author dean;	state Exp;
+branches;
+next	1.501;
+
+1.501
+date	2025.09.21.14.33.00;	author dean;	state Exp;
+branches;
+next	1.500;
+
 1.500
 date	2020.07.01.14.08.45;	author leith;	state Exp;
 branches;
@@ -2531,9 +2551,9 @@ desc
 @
 
 
-1.500
+1.504
 log
-@version
+@*** empty log message ***
 @
 text
 @
@@ -2545,10 +2565,10 @@ C                                                                      *
 C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
-C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2020  Health Research Inc.,                         *
+C=* SPIDER System Authors:  Joachim Frank, ArDean Leith & Tapu Shaikh  *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -2613,11 +2633,12 @@ C       COMMON BLOCK SPACE RESERVATION USED AT ALBANY, IS NOW ONLY 5 MB.
 C       (MOST ROUTINES NOW USE RUN-TIME ALLOCATION OF MEMORY WHICH 
 C       IS INDEPENDENT OF THE COMMON BLOCK AND MAXDI ASSIGNMENT.
 C       WE USUALLY HAVE > 2 GB RAM AVAILABLE ON ALBANY MACHINES
- 
+C       NAME MAX_UNLABELED_COM IS MORE EASILY SEARCHABLE IN SOURCE FILES
+        INTEGER, PARAMETER  :: MAX_UNLABELED_COM = 5000000
         INTEGER, PARAMETER  :: MAXDI = 5000000
-        INTEGER             :: PLINEGO(MAXDI/5)
-        CHARACTER           :: PDATA(4*4*MAXDI/5)
-        COMMON                 PLINEGO,PDATA
+        INTEGER             :: PLINEGO(MAXDI/5)   ! 1  million ints
+        CHARACTER           :: PDATA(4*4*MAXDI/5) ! 16 million char
+        COMMON                 PLINEGO,PDATA      ! 20 million bytes
 
 C       @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  DECLARATIONS @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 
@@ -2697,7 +2718,7 @@ C       @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ DATA STATEMENTS @@@
 C       @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ VERSION INITIALIZATION @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 
 CHERE               123456789 123456789 123456789 1234567890 
-        DATA CVERS/'VERSION:  UNIX 26.06  ISSUED:  6/30/2020'/
+        DATA CVERS/'VERSION:  UNIX 27.00  ISSUED:  9/26/2025'/
 
         DATA RESULM/'results'/
         DATA LOGM/'LOG'/
@@ -2713,7 +2734,7 @@ C       SOME DO LOOP PARAMETERS
 
 C       @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  CODE @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 
-        IN_PARALLEL = .FALSE.
+        IN_PARALLEL = .FALSE.DEF
         ONLYONE_RED = .TRUE.
         ONLYONE_WRT = .TRUE.
 
@@ -2730,22 +2751,15 @@ C       NOT USING MPI
         MYPID = -1
 #endif
 
-#ifdef SP_MP
-C       NEEDED BY PGI 2013.10 COMPILER
 
-#ifndef USE_MPI
-#ifndef __APPLE__
-#if defined(SP_IFC) || defined(__INTEL_COMPILER)
-        isiz1 = kmp_get_stacksize()
-        CALL kmp_set_stacksize(65536)
-        isiz2 = kmp_get_stacksize()
-#else
-	isiz1 = omp_get_stack_size()
-	CALL omp_set_stack_size(65536)
-	isiz2 = omp_get_stack_size()
-#endif
-        !write(6,*) ' OMP Stack size: ',isiz1,' -->',isiz2
-#endif
+#ifdef SP_MP
+#ifdef SP_GFORTRAN
+c         isize = omp_get_stack_size()
+c        WRITE(6,*) ' Number of threads -----: ', isize
+c        WRITE(3,*) ' Number of threads -----: ', isize
+c
+c        call omp_set_stack_size(65536)
+c        CALL kmp_set_stacksize(65536)
 #endif
 #endif
 
@@ -2777,27 +2791,27 @@ C       INITIALIZE SOME COMMON BLOCK DATA ELEMENTS (SEE: setmode.f)
         LEGACYPAR      = .FALSE. ! () IN DO NO LONGER! DEC 2010
         USE_FBS_INTERP = .FALSE. ! NEW JUL 2011
         NECHO          = 0       ! COUNTER FOR LOG FILE OUTPUT
-        MAXDIM         = MAXDI   ! SET SIZE OF COMMON BUFFER
         NUMFFTWTH      = 0       ! NUMBER OF FFTW3 THREADS
         NULL           = CHAR(0)
         NQ12           = CHAR(34) // CHAR(39)   ! QUOTES
         MRC_AXIS       = 'UL L'
+        MAXDIM         = MAX_UNLABELED_COM  ! SET SIZE OF COMMON BUFFER
 
-C       SET ISEED  TO INITIAL "RANDOM" VALUE USING CLOCK
 #if defined (SP_GFORTRAN)  || defined(__GFORTRAN__)
-        CALL RANDOM_SEED(SIZE = N)
-        ALLOCATE(ISEED(N))
-        CALL SYSTEM_CLOCK(COUNT = ICLOCK)
-        ISEED = ICLOCK + 37 * (/ (I - 1, I = 1, N) /)
-        CALL RANDOM_SEED(PUT = ISEED)
-        DEALLOCATE(ISEED)
+         CALL RANDOM_SEED()
+C        ALLOCATE(ISEED(N))
+C        CALL SYSTEM_CLOCK(COUNT = ICLOCK)
+C        ISEED = ICLOCK + 37 * (/ (I - 1, I = 1, N) /)
+C        CALL RANDOM_SEED(PUT = ISEED)
+C        DEALLOCATE(ISEED)
 #else
+C       SET ISEED  TO INITIAL "RANDOM" VALUE USING CLOCK
         CALL DATE_AND_TIME(VALUES=ITIME)       ! GET CURRENT TIME
         ISEED(1) = ITIME(4) * (360000*ITIME(5) + 6000*ITIME(6) + 
      &             100*ITIME(7) + ITIME(8))
         IF (ISEED(1) == 0 .AND. ISEED(2) == 0) THEN
 C          KLUDGE TO PREVENT ERROR ON SOME INTEL PROCESSORS
-           write(0,*) ' Using default random number seed'
+           WRITE(0,*) ' Using default random number seed'
            CALL RANDOM_SEED()
         ELSE
            CALL RANDOM_SEED(PUT = ISEED)
@@ -2896,7 +2910,7 @@ C           PRINT OUT HEADING WITH VERSION AND RELEASE DATES
 C          GET THE PROJECT AND DATA EXTENSION FROM USER
            NLOG       = 0
            FCHAR(1:3) = 'NC' // CHAR(0)
-           CALL DRIV1(MAXDIM)
+           CALL DRIV1(MAX_UNLABELED_COM)
            NLOG       = NLOGP
         ENDIF
 
@@ -3093,7 +3107,7 @@ C       RESET FFTW3 CACHE
         CALL FMRS_DEPLAN(IRTFLG)
 
 C       TSWITCH IS MAIN SELECTION PROGRAM FOR OPERATIONS OUTSIDE MAIN
-        CALL TSWITCH(IWHICH,ICOM,MAXDIM,IRTFLG)
+        CALL TSWITCH(IWHICH,ICOM,MAX_UNLABELED_COM,IRTFLG)
  
 C       IF OPERATION FOUND OUTSIDE OF SPIDER MAIN, GET NEXT OPERATION
         IF (IRTFLG == 0) GOTO 5000
@@ -4319,6 +4333,122 @@ C          NODE 0 PRINTS THE ANSWER.
 @
 
 
+1.503
+log
+@MAX_UNLABLED_COM added for searchability
+@
+text
+@d13 1
+a13 1
+C=* Email:                                         *
+d163 1
+a163 1
+        DATA CVERS/'VERSION:  UNIX 27.00  ISSUED:  9/18/2025'/
+@
+
+
+1.502
+log
+@SET max_unlabeled_com for easier searchablility for legacy unlabeled common block use
+incremented version number,   added Tapu to main author list
+@
+text
+@d78 2
+a79 2
+C       NAME: MAX_UNLABLED_COM IS MORE EASILY SEARCHABLE IN SOURCE FILES
+        INTEGER, PARAMETER  :: MAX_UNLABLED_COM = 5000000
+d240 1
+a240 1
+        MAXDIM         = MAX_UNLABLED_COM  ! SET SIZE OF COMMON BUFFER
+d355 1
+a355 1
+           CALL DRIV1(MAX_UNLABLED_COM)
+d552 1
+a552 1
+        CALL TSWITCH(IWHICH,ICOM,MAX_UNLABLED_COM,IRTFLG)
+@
+
+
+1.501
+log
+@updated version, changed MP, etc
+@
+text
+@d10 1
+a10 1
+C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
+d78 2
+a79 1
+ 
+d81 3
+a83 3
+        INTEGER             :: PLINEGO(MAXDI/5)
+        CHARACTER           :: PDATA(4*4*MAXDI/5)
+        COMMON                 PLINEGO,PDATA
+a235 1
+        MAXDIM         = MAXDI   ! SET SIZE OF COMMON BUFFER
+d240 1
+a241 1
+C       SET ISEED  TO INITIAL "RANDOM" VALUE USING CLOCK
+d243 6
+a248 6
+        CALL RANDOM_SEED(SIZE = N)
+        ALLOCATE(ISEED(N))
+        CALL SYSTEM_CLOCK(COUNT = ICLOCK)
+        ISEED = ICLOCK + 37 * (/ (I - 1, I = 1, N) /)
+        CALL RANDOM_SEED(PUT = ISEED)
+        DEALLOCATE(ISEED)
+d250 1
+d256 1
+a256 1
+           write(0,*) ' Using default random number seed'
+d355 1
+a355 1
+           CALL DRIV1(MAXDIM)
+d552 1
+a552 1
+        CALL TSWITCH(IWHICH,ICOM,MAXDIM,IRTFLG)
+@
+
+
+1.500
+log
+@version
+@
+text
+@d11 1
+a11 1
+C=* Copyright 1985-2020  Health Research Inc.,                         *
+d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+d162 1
+a162 1
+        DATA CVERS/'VERSION:  UNIX 26.06  ISSUED:  6/30/2020'/
+d178 1
+a178 1
+        IN_PARALLEL = .FALSE.
+d195 1
+d197 7
+a203 15
+C       NEEDED BY PGI 2013.10 COMPILER
+
+#ifndef USE_MPI
+#ifndef __APPLE__
+#if defined(SP_IFC) || defined(__INTEL_COMPILER)
+        isiz1 = kmp_get_stacksize()
+        CALL kmp_set_stacksize(65536)
+        isiz2 = kmp_get_stacksize()
+#else
+	isiz1 = omp_get_stack_size()
+	CALL omp_set_stack_size(65536)
+	isiz2 = omp_get_stack_size()
+#endif
+        !write(6,*) ' OMP Stack size: ',isiz1,' -->',isiz2
+#endif
+@
+
+
 1.499
 log
 @VERSION:  UNIX 26.05
diff --git src/RCS/spireout.f,v src/RCS/spireout.f,v
index 51ff96f5..ba4464d8 100644
--- src/RCS/spireout.f,v
+++ src/RCS/spireout.f,v
@@ -1,4 +1,4 @@
-head	1.5;
+head	1.6;
 access;
 symbols
 	pre_mrcs:1.5
@@ -19,6 +19,11 @@ locks; strict;
 comment	@c @;
 
 
+1.6
+date	2025.11.10.22.33.50;	author dean;	state Exp;
+branches;
+next	1.5;
+
 1.5
 date	2018.10.03.14.34.23;	author leith;	state Exp;
 branches;
@@ -49,9 +54,9 @@ desc
 @@
 
 
-1.5
+1.6
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -65,7 +70,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -108,6 +113,17 @@ C***********************************************************************
 @
 
 
+1.5
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.4
 log
 @GPL_2010
diff --git src/RCS/spotwt.f,v src/RCS/spotwt.f,v
index 9abd566a..209631c6 100644
--- src/RCS/spotwt.f,v
+++ src/RCS/spotwt.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.33.50;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.23;	author leith;	state Exp;
 branches;
@@ -80,9 +85,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -96,7 +101,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -280,6 +285,17 @@ C       THE WINDOW, ALSO COMPUTE AVERAGE DENSITY
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @call tree
diff --git src/RCS/squeez.f,v src/RCS/squeez.f,v
index cff65a07..65208051 100644
--- src/RCS/squeez.f,v
+++ src/RCS/squeez.f,v
@@ -1,4 +1,4 @@
-head	1.17;
+head	1.18;
 access;
 symbols
 	pre_mrcs:1.17
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.18
+date	2025.11.10.22.33.50;	author dean;	state Exp;
+branches;
+next	1.17;
+
 1.17
 date	2018.10.03.14.34.23;	author leith;	state Exp;
 branches;
@@ -115,9 +120,9 @@ desc
 @
 
 
-1.17
+1.18
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -132,7 +137,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -226,6 +231,17 @@ C             WRITE OUTPUT BUFFER TO FILE
 @
 
 
+1.17
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.16
 log
 @GPL_2010
diff --git src/RCS/sslowcas.f,v src/RCS/sslowcas.f,v
index f21c9bbd..92af2e6d 100644
--- src/RCS/sslowcas.f,v
+++ src/RCS/sslowcas.f,v
@@ -1,4 +1,4 @@
-head	1.5;
+head	1.6;
 access;
 symbols
 	pre_mrcs:1.5
@@ -23,6 +23,11 @@ locks; strict;
 comment	@c @;
 
 
+1.6
+date	2025.11.10.22.33.50;	author dean;	state Exp;
+branches;
+next	1.5;
+
 1.5
 date	2018.10.03.14.34.23;	author leith;	state Exp;
 branches;
@@ -53,9 +58,9 @@ desc
 @@
 
 
-1.5
+1.6
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -70,7 +75,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -116,6 +121,17 @@ C--*********************************************************************
 @
 
 
+1.5
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.4
 log
 @GPL_2010
diff --git src/RCS/ssnrb.f,v src/RCS/ssnrb.f,v
index 623ce5b8..e0f45a97 100644
--- src/RCS/ssnrb.f,v
+++ src/RCS/ssnrb.f,v
@@ -1,4 +1,4 @@
-head	1.28;
+head	1.29;
 access;
 symbols
 	pre_mrcs:1.28
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.29
+date	2025.11.10.22.33.50;	author dean;	state Exp;
+branches;
+next	1.28;
+
 1.28
 date	2018.10.03.14.34.23;	author leith;	state Exp;
 branches;
@@ -170,9 +175,9 @@ desc
 @
 
 
-1.28
+1.29
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -188,7 +193,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2012  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -442,6 +447,17 @@ C     &                   N1 * DLIST(3)**2) / FLOAT(N1*(N2-4)))
 @
 
 
+1.28
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.27
 log
 @Integral SNR=
diff --git src/RCS/sspush.f,v src/RCS/sspush.f,v
index 8b8e6861..a468d00e 100644
--- src/RCS/sspush.f,v
+++ src/RCS/sspush.f,v
@@ -1,4 +1,4 @@
-head	1.16;
+head	1.17;
 access;
 symbols
 	pre_mrcs:1.16
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.17
+date	2025.11.10.22.33.50;	author dean;	state Exp;
+branches;
+next	1.16;
+
 1.16
 date	2018.10.03.14.34.23;	author leith;	state Exp;
 branches;
@@ -110,9 +115,9 @@ desc
 @
 
 
-1.16
+1.17
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -126,7 +131,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -194,6 +199,17 @@ C       SET BAD ERROR RETURN
 @
 
 
+1.16
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.15
 log
 @GPL_2010
diff --git src/RCS/ssupcas.f,v src/RCS/ssupcas.f,v
index 5741efa7..0a88eedc 100644
--- src/RCS/ssupcas.f,v
+++ src/RCS/ssupcas.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.33.50;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.23;	author leith;	state Exp;
 branches;
@@ -80,9 +85,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -98,7 +103,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -145,6 +150,17 @@ C--*********************************************************************
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @GPL_2010
diff --git src/RCS/stabk.f,v src/RCS/stabk.f,v
index e513953c..63b27322 100644
--- src/RCS/stabk.f,v
+++ src/RCS/stabk.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.33.50;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.23;	author leith;	state Exp;
 branches;
@@ -80,9 +85,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -96,7 +101,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -193,6 +198,17 @@ C     RESULTS OF THE CLASSIFICATION
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @GPL_2010
diff --git src/RCS/stack.f,v src/RCS/stack.f,v
index 53f467f8..732f8d51 100644
--- src/RCS/stack.f,v
+++ src/RCS/stack.f,v
@@ -1,4 +1,4 @@
-head	1.16;
+head	1.17;
 access;
 symbols
 	pre_mrcs:1.16
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.17
+date	2025.11.10.22.33.50;	author dean;	state Exp;
+branches;
+next	1.16;
+
 1.16
 date	2018.10.03.14.34.23;	author leith;	state Exp;
 branches;
@@ -110,9 +115,9 @@ desc
 @
 
 
-1.16
+1.17
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -128,7 +133,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2013  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -366,6 +371,17 @@ C       CONTINUE UNTIL ASTERICK RECEIVED FOR INPUT FILENAME
 
 
 
+@
+
+
+1.16
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
 @
 
 
diff --git src/RCS/star2doc.f,v src/RCS/star2doc.f,v
index 287389f2..a3f27fbb 100644
--- src/RCS/star2doc.f,v
+++ src/RCS/star2doc.f,v
@@ -1,4 +1,4 @@
-head	1.15;
+head	1.16;
 access;
 symbols
 	pre_mrcs:1.15
@@ -7,6 +7,11 @@ locks; strict;
 comment	@c @;
 
 
+1.16
+date	2025.09.21.14.46.57;	author dean;	state Exp;
+branches;
+next	1.15;
+
 1.15
 date	2018.10.03.14.34.23;	author leith;	state Exp;
 branches;
@@ -87,9 +92,9 @@ desc
 @@
 
 
-1.15
+1.16
 log
-@email_health_dept
+@Gfort Error fixed
 @
 text
 @
@@ -103,14 +108,14 @@ C              MAXLENVAR = 40 --> 120            OCT 2015 ARDEAN LEITH
 C              NVARSTAR BUG                      OCT 2015 ARDEAN LEITH
 C              INTEGER OVERFOW HACK              NOV 2015 ARDEAN LEITH
 C              _ NOT _rln                        SEP 2016 ARDEAN LEITH
-C                                                                 
+C              GFORT:  NONNEGATIVE STRING WIDTH  SEP 2025 ARDEAN LEITH 
+                                                               
 C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2016  Health Research Inc.,                         *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -449,7 +454,9 @@ C           INTERPRET TOKENS AS FLOATS, PLACE IN DLIST
                CTOKEN = ADJUSTL(VARTMP(IWHICH))
                NCHAR  = lnblnkn(CTOKEN)
 
-               READ(CTOKEN(1:NCHAR),'(I)') IDLIST
+C              Gfort Error: Nonnegative width required..  al Sept 2025
+C              READ(CTOKEN(1:NCHAR),'(I)') IDLIST
+               READ(CTOKEN(1:NCHAR),'(I12)') IDLIST
                DLIST(ILOC) = IDLIST
  
                !write(6,*)' Token:',ctoken(1:nchar),i,iloc,idlist
@@ -483,6 +490,25 @@ C     PUT NUMBER OF KEYS IN OPERATION LINE REGISTER
 @
 
 
+1.15
+log
+@email_health_dept
+@
+text
+@d12 2
+a13 1
+C                                                                 
+d18 1
+a18 1
+C=* Copyright 1985-2016  Health Research Inc.,                         *
+a19 1
+C=* Email: spider@@health.ny.gov                                        *
+d358 3
+a360 1
+               READ(CTOKEN(1:NCHAR),'(I)') IDLIST
+@
+
+
 1.14
 log
 @_ NOT _rln
diff --git src/RCS/step.f,v src/RCS/step.f,v
index 209ad097..1fe0e683 100644
--- src/RCS/step.f,v
+++ src/RCS/step.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.33.50;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.23;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -90,7 +95,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -144,6 +149,17 @@ C555	FORMAT(I3,5X,2I5,5X,F10.6)
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/stepi.f,v src/RCS/stepi.f,v
index 8b144497..cfda6d67 100644
--- src/RCS/stepi.f,v
+++ src/RCS/stepi.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.33.50;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.23;	author leith;	state Exp;
 branches;
@@ -80,9 +85,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -95,7 +100,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -161,6 +166,17 @@ C***********************************************************************
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @GPL_2010
diff --git src/RCS/stocha.f,v src/RCS/stocha.f,v
index a962a6cf..a8ca9089 100644
--- src/RCS/stocha.f,v
+++ src/RCS/stocha.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.33.50;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.23;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -92,7 +97,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -250,6 +255,17 @@ C	          U HAS TO HAVE THE AVERAGE SUBSTRATED AND PJ()=1
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/subaf.f,v src/RCS/subaf.f,v
index 98117658..c4d160be 100644
--- src/RCS/subaf.f,v
+++ src/RCS/subaf.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.33.50;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.23;	author leith;	state Exp;
 branches;
@@ -80,9 +85,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -95,7 +100,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -135,6 +140,17 @@ c$omp parallel do private(i)
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @GPL_2010
diff --git src/RCS/subchar.f,v src/RCS/subchar.f,v
index bd93eec1..4edc1af9 100644
--- src/RCS/subchar.f,v
+++ src/RCS/subchar.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -21,6 +21,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.33.50;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.34.23;	author leith;	state Exp;
 branches;
@@ -66,9 +71,9 @@ desc
 @@
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -84,7 +89,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -193,6 +198,17 @@ C           SUBSTITUTE INSERT FOR REMOVE
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @subchars could not insert a blank, <=
diff --git src/RCS/subkmeans.f,v src/RCS/subkmeans.f,v
index f76d5935..b6ff01f3 100644
--- src/RCS/subkmeans.f,v
+++ src/RCS/subkmeans.f,v
@@ -1,4 +1,4 @@
-head	1.13;
+head	1.14;
 access;
 symbols
 	pre_mrcs:1.13
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.14
+date	2025.11.10.22.33.50;	author dean;	state Exp;
+branches;
+next	1.13;
+
 1.13
 date	2018.10.03.14.34.23;	author leith;	state Exp;
 branches;
@@ -95,9 +100,9 @@ desc
 @
 
 
-1.13
+1.14
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -111,7 +116,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -358,6 +363,17 @@ C       OPEN OUTPUT DOC FILE NAME
 @
 
 
+1.13
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.12
 log
 @prompts
diff --git src/RCS/subkmns.f,v src/RCS/subkmns.f,v
index fd68c1c8..e22e417b 100644
--- src/RCS/subkmns.f,v
+++ src/RCS/subkmns.f,v
@@ -1,4 +1,4 @@
-head	1.23;
+head	1.24;
 access;
 symbols
 	pre_mrcs:1.23
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.24
+date	2025.11.10.22.33.50;	author dean;	state Exp;
+branches;
+next	1.23;
+
 1.23
 date	2018.10.03.14.34.23;	author leith;	state Exp;
 branches;
@@ -145,9 +150,9 @@ desc
 @
 
 
-1.23
+1.24
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -162,7 +167,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -370,6 +375,17 @@ C--*************************** PRNTXX ******************************
 @
 
 
+1.23
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.22
 log
 @output factor for all 1.0 simplified echo
diff --git src/RCS/subsympar.f,v src/RCS/subsympar.f,v
index a1bc6b3c..431c9cef 100644
--- src/RCS/subsympar.f,v
+++ src/RCS/subsympar.f,v
@@ -1,4 +1,4 @@
-head	1.28;
+head	1.29;
 access;
 symbols
 	pre_mrcs:1.28
@@ -22,6 +22,11 @@ locks; strict;
 comment	@c @;
 
 
+1.29
+date	2025.11.10.22.33.50;	author dean;	state Exp;
+branches;
+next	1.28;
+
 1.28
 date	2018.10.03.14.34.23;	author leith;	state Exp;
 branches;
@@ -168,9 +173,9 @@ desc
 @
 
 
-1.28
+1.29
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -190,7 +195,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2015  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -243,6 +248,17 @@ C     FOR ISTOP
 @
 
 
+1.28
+log
+@email_health_dept
+@
+text
+@d18 1
+a18 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.27
 log
 @==
diff --git src/RCS/sumali.f,v src/RCS/sumali.f,v
index f5ca8e6b..d0c61cdf 100644
--- src/RCS/sumali.f,v
+++ src/RCS/sumali.f,v
@@ -1,4 +1,4 @@
-head	1.19;
+head	1.20;
 access;
 symbols
 	pre_mrcs:1.19
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.20
+date	2025.11.10.22.33.50;	author dean;	state Exp;
+branches;
+next	1.19;
+
 1.19
 date	2018.10.03.14.34.23;	author leith;	state Exp;
 branches;
@@ -125,9 +130,9 @@ desc
 @
 
 
-1.19
+1.20
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -142,7 +147,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -209,6 +214,17 @@ C         PREFERRED INPUT METHOD
 @
 
 
+1.19
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.18
 log
 @GPL_2010
diff --git src/RCS/sumali3.f,v src/RCS/sumali3.f,v
index eac4972e..db9a7a1b 100644
--- src/RCS/sumali3.f,v
+++ src/RCS/sumali3.f,v
@@ -1,4 +1,4 @@
-head	1.18;
+head	1.19;
 access;
 symbols
 	pre_mrcs:1.18
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.19
+date	2025.11.10.22.33.50;	author dean;	state Exp;
+branches;
+next	1.18;
+
 1.18
 date	2018.10.03.14.34.23;	author leith;	state Exp;
 branches;
@@ -120,9 +125,9 @@ desc
 @
 
 
-1.18
+1.19
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -137,7 +142,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -295,6 +300,17 @@ C
 @
 
 
+1.18
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.17
 log
 @GPL_2010
diff --git src/RCS/sumap.f,v src/RCS/sumap.f,v
index dfc59f9e..1e8fe4d2 100644
--- src/RCS/sumap.f,v
+++ src/RCS/sumap.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.33.50;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.34.24;	author leith;	state Exp;
 branches;
@@ -70,9 +75,9 @@ desc
 @
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -86,7 +91,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -124,6 +129,17 @@ C--*********************************************************************
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @cosmetic
diff --git src/RCS/sumeuler.f,v src/RCS/sumeuler.f,v
index 0272dfeb..8d608e61 100644
--- src/RCS/sumeuler.f,v
+++ src/RCS/sumeuler.f,v
@@ -1,4 +1,4 @@
-head	1.14;
+head	1.15;
 access;
 symbols
 	pre_mrcs:1.14
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.15
+date	2025.11.10.22.33.50;	author dean;	state Exp;
+branches;
+next	1.14;
+
 1.14
 date	2018.10.03.14.34.24;	author leith;	state Exp;
 branches;
@@ -100,9 +105,9 @@ desc
 @
 
 
-1.14
+1.15
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -118,7 +123,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -258,6 +263,17 @@ C  Limit precision
 @
 
 
+1.14
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.13
 log
 @GPL_2010
diff --git src/RCS/sunonly.f,v src/RCS/sunonly.f,v
index b6086cb1..a2dd2988 100644
--- src/RCS/sunonly.f,v
+++ src/RCS/sunonly.f,v
@@ -1,4 +1,4 @@
-head	1.7;
+head	1.8;
 access;
 symbols
 	pre_mrcs:1.7
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.8
+date	2025.11.10.22.33.50;	author dean;	state Exp;
+branches;
+next	1.7;
+
 1.7
 date	2018.10.03.14.34.24;	author leith;	state Exp;
 branches;
@@ -65,9 +70,9 @@ desc
 @
 
 
-1.7
+1.8
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @ 
@@ -97,7 +102,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -173,6 +178,17 @@ C **********************************************************************
 @
 
 
+1.7
+log
+@email_health_dept
+@
+text
+@d28 1
+a28 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.6
 log
 @GPL_2010
diff --git src/RCS/surfarea.f,v src/RCS/surfarea.f,v
index 37da1c4f..0a9c5747 100644
--- src/RCS/surfarea.f,v
+++ src/RCS/surfarea.f,v
@@ -1,4 +1,4 @@
-head	1.16;
+head	1.17;
 access;
 symbols
 	pre_mrcs:1.16
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.17
+date	2025.11.10.22.33.50;	author dean;	state Exp;
+branches;
+next	1.16;
+
 1.16
 date	2018.10.03.14.34.24;	author leith;	state Exp;
 branches;
@@ -110,9 +115,9 @@ desc
 @
 
 
-1.16
+1.17
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -127,7 +132,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -410,6 +415,17 @@ C                 VOXEL IS ABOVE THRESHOLD
 @
 
 
+1.16
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.15
 log
 @' IMAGE RANGE,  ERRT(46,'SURFAREA, IMGS',MEMWANT
diff --git src/RCS/surfcomp.f,v src/RCS/surfcomp.f,v
index 2ae20f4e..c5965f52 100644
--- src/RCS/surfcomp.f,v
+++ src/RCS/surfcomp.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -22,6 +22,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.33.50;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.24;	author leith;	state Exp;
 branches;
@@ -77,9 +82,9 @@ desc
 @@
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C **********************************************************************
@@ -93,7 +98,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -316,6 +321,17 @@ C          FOUND MINIMAL DISTANCE FROM SURFACE 1 TO VOXEL ON SURFACE 2
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @date
diff --git src/RCS/surffit.f,v src/RCS/surffit.f,v
index f6a3f0da..7782c9d0 100644
--- src/RCS/surffit.f,v
+++ src/RCS/surffit.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -22,6 +22,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.33.50;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.34.24;	author leith;	state Exp;
 branches;
@@ -77,9 +82,9 @@ desc
 @@
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -95,7 +100,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -366,6 +371,17 @@ C                 VOXEL IS ABOVE THRESHOLD
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @*** empty log message ***
diff --git src/RCS/surftovol.f,v src/RCS/surftovol.f,v
index 9830af24..f77d0c92 100644
--- src/RCS/surftovol.f,v
+++ src/RCS/surftovol.f,v
@@ -1,4 +1,4 @@
-head	1.5;
+head	1.6;
 access;
 symbols
 	pre_mrcs:1.5
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.6
+date	2025.11.10.22.33.50;	author dean;	state Exp;
+branches;
+next	1.5;
+
 1.5
 date	2018.10.03.14.34.24;	author leith;	state Exp;
 branches;
@@ -54,9 +59,9 @@ desc
 @@
 
 
-1.5
+1.6
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -70,7 +75,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -185,6 +190,17 @@ C               LEAVE RAW DATA IN VOLUME
 @
 
 
+1.5
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.4
 log
 @GPL_2010
diff --git src/RCS/symang.f,v src/RCS/symang.f,v
index cd5c36c0..6c46315c 100644
--- src/RCS/symang.f,v
+++ src/RCS/symang.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -19,6 +19,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.33.50;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.24;	author leith;	state Exp;
 branches;
@@ -79,9 +84,9 @@ desc
 @@
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -97,7 +102,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2011  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -683,6 +688,17 @@ C         CATCH TO CHANGE REALLY SMALL PHI TO 0, FOR OCT.
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @csym and ic were doubly declared
diff --git src/RCS/sympar.f,v src/RCS/sympar.f,v
index 3c8ee4a2..074e31a6 100644
--- src/RCS/sympar.f,v
+++ src/RCS/sympar.f,v
@@ -1,4 +1,4 @@
-head	1.26;
+head	1.27;
 access;
 symbols
 	pre_mrcs:1.26
@@ -22,6 +22,11 @@ locks; strict;
 comment	@c @;
 
 
+1.27
+date	2025.11.10.22.33.50;	author dean;	state Exp;
+branches;
+next	1.26;
+
 1.26
 date	2018.10.03.14.34.24;	author leith;	state Exp;
 branches;
@@ -157,9 +162,9 @@ desc
 @@
 
 
-1.26
+1.27
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -181,7 +186,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2015  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -747,6 +752,17 @@ C       DO NOT CLOSE FILE UNTIL 'FR NE' IS GIVEN!
 @
 
 
+1.26
+log
+@email_health_dept
+@
+text
+@d20 1
+a20 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.25
 log
 @PARSESYMPAR REWRITE,  ==
diff --git src/RCS/tcnp.f,v src/RCS/tcnp.f,v
index dcf5feab..f4920776 100644
--- src/RCS/tcnp.f,v
+++ src/RCS/tcnp.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.33.50;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.24;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -91,7 +96,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -152,6 +157,17 @@ C***********************************************************************
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/tf.f,v src/RCS/tf.f,v
index 5cb590db..6628027d 100644
--- src/RCS/tf.f,v
+++ src/RCS/tf.f,v
@@ -1,4 +1,4 @@
-head	1.14;
+head	1.15;
 access;
 symbols
 	pre_mrcs:1.14
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.15
+date	2025.11.10.22.33.50;	author dean;	state Exp;
+branches;
+next	1.14;
+
 1.14
 date	2018.10.03.14.34.24;	author leith;	state Exp;
 branches;
@@ -100,9 +105,9 @@ desc
 @
 
 
-1.14
+1.15
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*******************************************************************
@@ -115,7 +120,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -176,6 +181,17 @@ C       I DO NOT KNOW IF SAVE IS NEEDED FEB 99 al
 @
 
 
+1.14
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.13
 log
 @CS_zero
diff --git src/RCS/tfd.f,v src/RCS/tfd.f,v
index 4517cf26..7e141af9 100644
--- src/RCS/tfd.f,v
+++ src/RCS/tfd.f,v
@@ -1,4 +1,4 @@
-head	1.22;
+head	1.23;
 access;
 symbols
 	pre_mrcs:1.22
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.23
+date	2025.11.10.22.33.51;	author dean;	state Exp;
+branches;
+next	1.22;
+
 1.22
 date	2018.10.03.14.34.24;	author leith;	state Exp;
 branches;
@@ -140,9 +145,9 @@ desc
 @
 
 
-1.22
+1.23
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -162,7 +167,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2015  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -285,6 +290,17 @@ C        ------------------ TFD_PLUS --------------------------------
 @
 
 
+1.22
+log
+@email_health_dept
+@
+text
+@d18 1
+a18 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.21
 log
 @ACR --> WGH    GEH --> ENV   reversion to keep same as publication
diff --git src/RCS/tfed.f,v src/RCS/tfed.f,v
index f94ce7e6..dd26dc95 100644
--- src/RCS/tfed.f,v
+++ src/RCS/tfed.f,v
@@ -1,4 +1,4 @@
-head	1.29;
+head	1.30;
 access;
 symbols
 	pre_mrcs:1.29
@@ -20,6 +20,11 @@ locks; strict;
 comment	@c @;
 
 
+1.30
+date	2025.09.21.15.07.25;	author dean;	state Exp;
+branches;
+next	1.29;
+
 1.29
 date	2013.11.25.14.39.30;	author leith;	state Exp;
 branches;
@@ -170,9 +175,9 @@ desc
 @@
 
 
-1.29
+1.30
 log
-@CHARACTER, PARAMETER :: MODE    = ' ' was undefined
+@C            GETDEFOCUS VERY BUGGY
 @
 text
 @C **********************************************************************
@@ -181,7 +186,7 @@ C            IMPROPER PS BUG FIXED               SEP   10 ArDean Leith
 C            PROMPTS IMPROVED                    MAY   12 ArDean Leith
 C            CTF ED                              JUN   12 ArDean Leith
 C            DEF. DOC FILE COMMENTS CHANGED      APR   13 ArDean Leith
-C                                                            
+C            GETDEFOCUS VERY BUGGY                                                              
 C=**********************************************************************
 C=* From: SPIDER - MODULAR IMAGE PROCESSING SYSTEM                     *
 C=* Copyright (C)2002, Z. Huang & P. A. Penczek                        *
@@ -4964,6 +4969,17 @@ C     *    Q(I,N1)
 @
 
 
+1.29
+log
+@CHARACTER, PARAMETER :: MODE    = ' ' was undefined
+@
+text
+@d7 1
+a7 1
+C                                                            
+@
+
+
 1.28
 log
 @DEF. DOC FILE COMMENTS CHANGED
diff --git src/RCS/thresh.f,v src/RCS/thresh.f,v
index 78f9fd7f..758794a9 100644
--- src/RCS/thresh.f,v
+++ src/RCS/thresh.f,v
@@ -1,4 +1,4 @@
-head	1.15;
+head	1.16;
 access;
 symbols
 	pre_mrcs:1.15
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.16
+date	2025.11.10.22.33.51;	author dean;	state Exp;
+branches;
+next	1.15;
+
 1.15
 date	2018.10.03.14.34.24;	author leith;	state Exp;
 branches;
@@ -105,9 +110,9 @@ desc
 @
 
 
-1.15
+1.16
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -122,7 +127,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -254,6 +259,17 @@ C--********************************************************************
 @
 
 
+1.15
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.14
 log
 @GPL_2010
diff --git src/RCS/tiltfd.f,v src/RCS/tiltfd.f,v
index 4d3631bd..5554096e 100644
--- src/RCS/tiltfd.f,v
+++ src/RCS/tiltfd.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.33.51;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.24;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -91,7 +96,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -202,6 +207,17 @@ C110	CALL ARCTRG(S,DUM,GAMT2,IER)      ! NAIK 10/2/86
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/tima.f,v src/RCS/tima.f,v
index c1e9fc82..c7a22c61 100644
--- src/RCS/tima.f,v
+++ src/RCS/tima.f,v
@@ -1,4 +1,4 @@
-head	1.9;
+head	1.10;
 access;
 symbols
 	pre_mrcs:1.9
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.10
+date	2025.11.10.22.33.51;	author dean;	state Exp;
+branches;
+next	1.9;
+
 1.9
 date	2018.10.03.14.34.24;	author leith;	state Exp;
 branches;
@@ -75,9 +80,9 @@ desc
 @
 
 
-1.9
+1.10
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -90,7 +95,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -172,6 +177,17 @@ C	UUT AND UVT GIVE THE SUMS OF SQUARES OF UU AND UV
 @
 
 
+1.9
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.8
 log
 @GPL_2010
diff --git src/RCS/title.f,v src/RCS/title.f,v
index 9abdd7ce..06ed64e1 100644
--- src/RCS/title.f,v
+++ src/RCS/title.f,v
@@ -1,4 +1,4 @@
-head	1.16;
+head	1.17;
 access;
 symbols
 	pre_mrcs:1.16
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.17
+date	2025.11.10.22.33.51;	author dean;	state Exp;
+branches;
+next	1.16;
+
 1.16
 date	2018.10.03.14.34.24;	author leith;	state Exp;
 branches;
@@ -110,9 +115,9 @@ desc
 @
 
 
-1.16
+1.17
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -128,7 +133,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2013  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -193,6 +198,17 @@ C                WRITE LAST 60 CHAR OF TITLE
 @
 
 
+1.16
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.15
 log
 @output formatting
diff --git src/RCS/to_peaks.f,v src/RCS/to_peaks.f,v
index e3c54fa1..6d14575e 100644
--- src/RCS/to_peaks.f,v
+++ src/RCS/to_peaks.f,v
@@ -1,4 +1,4 @@
-head	1.3;
+head	1.4;
 access;
 symbols
 	pre_mrcs:1.3
@@ -7,6 +7,11 @@ locks; strict;
 comment	@c @;
 
 
+1.4
+date	2025.11.10.22.33.52;	author dean;	state Exp;
+branches;
+next	1.3;
+
 1.3
 date	2018.10.03.14.34.24;	author leith;	state Exp;
 branches;
@@ -27,9 +32,9 @@ desc
 @@
 
 
-1.3
+1.4
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C **********************************************************************
@@ -42,7 +47,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2016  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -407,6 +412,17 @@ C       FIND CENTER OF GRAVITY OF CIRCLE AT DESIRED RADIUS
 @
 
 
+1.3
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.2
 log
 @nseper in findminmax
diff --git src/RCS/to_polar.f,v src/RCS/to_polar.f,v
index 876fcf8d..fdd14029 100644
--- src/RCS/to_polar.f,v
+++ src/RCS/to_polar.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -21,6 +21,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.33.52;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.34.24;	author leith;	state Exp;
 branches;
@@ -81,9 +86,9 @@ desc
 @@
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C **********************************************************************
@@ -97,7 +102,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2013  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -229,6 +234,17 @@ C       DEPENDENT ON CIRCULAR CLOSURE IN QUADRI!
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @added call for 'PO R'
diff --git src/RCS/to_rays.f,v src/RCS/to_rays.f,v
index 818bf34e..98611f42 100644
--- src/RCS/to_rays.f,v
+++ src/RCS/to_rays.f,v
@@ -1,4 +1,4 @@
-head	1.7;
+head	1.8;
 access;
 symbols
 	pre_mrcs:1.7
@@ -7,6 +7,11 @@ locks; strict;
 comment	@c @;
 
 
+1.8
+date	2025.11.10.22.33.52;	author dean;	state Exp;
+branches;
+next	1.7;
+
 1.7
 date	2018.10.03.14.34.24;	author leith;	state Exp;
 branches;
@@ -47,9 +52,9 @@ desc
 @@
 
 
-1.7
+1.8
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C **********************************************************************
@@ -62,7 +67,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2016  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -219,6 +224,17 @@ C       OUTPUT IMAGE -------------------------------------
 
 
 
+@
+
+
+1.7
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
 @
 
 
diff --git src/RCS/toma.f,v src/RCS/toma.f,v
index b65cb5a9..6d580797 100644
--- src/RCS/toma.f,v
+++ src/RCS/toma.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.33.52;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.34.24;	author leith;	state Exp;
 branches;
@@ -70,9 +75,9 @@ desc
 @
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -86,7 +91,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -186,6 +191,17 @@ C
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @GPL_2010
diff --git src/RCS/traf.f,v src/RCS/traf.f,v
index c7605f64..6a434735 100644
--- src/RCS/traf.f,v
+++ src/RCS/traf.f,v
@@ -1,4 +1,4 @@
-head	1.18;
+head	1.19;
 access;
 symbols
 	pre_mrcs:1.18
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.19
+date	2025.11.10.22.33.52;	author dean;	state Exp;
+branches;
+next	1.18;
+
 1.18
 date	2018.10.03.14.51.08;	author leith;	state Exp;
 branches;
@@ -120,9 +125,9 @@ desc
 @
 
 
-1.18
+1.19
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -140,7 +145,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -281,6 +286,17 @@ C
 @
 
 
+1.18
+log
+@email_health_dept
+@
+text
+@d16 1
+a16 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.17
 log
 @all tf ops have same prompt syntax
diff --git src/RCS/trafc.f,v src/RCS/trafc.f,v
index 46e2e17c..ca68f3cb 100644
--- src/RCS/trafc.f,v
+++ src/RCS/trafc.f,v
@@ -1,4 +1,4 @@
-head	1.31;
+head	1.32;
 access;
 symbols
 	pre_mrcs:1.31
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.32
+date	2025.11.10.22.33.52;	author dean;	state Exp;
+branches;
+next	1.31;
+
 1.31
 date	2018.10.03.14.34.24;	author leith;	state Exp;
 branches;
@@ -185,9 +190,9 @@ desc
 @
 
 
-1.31
+1.32
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -207,7 +212,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2015  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -381,6 +386,17 @@ C                 FOR FULL CTF CORRECTION
 @
 
 
+1.31
+log
+@email_health_dept
+@
+text
+@d18 1
+a18 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.30
 log
 @note added about geh=0
diff --git src/RCS/trafc3.f,v src/RCS/trafc3.f,v
index 9737fbdd..074df59f 100644
--- src/RCS/trafc3.f,v
+++ src/RCS/trafc3.f,v
@@ -1,4 +1,4 @@
-head	1.27;
+head	1.28;
 access;
 symbols
 	pre_mrcs:1.27
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.28
+date	2025.11.10.22.33.52;	author dean;	state Exp;
+branches;
+next	1.27;
+
 1.27
 date	2018.10.03.14.34.24;	author leith;	state Exp;
 branches;
@@ -165,9 +170,9 @@ desc
 @
 
 
-1.27
+1.28
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -186,7 +191,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2015  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -350,6 +355,17 @@ C                    WANT STRAIGHT TRANSFER  FILE
 @
 
 
+1.27
+log
+@email_health_dept
+@
+text
+@d17 1
+a17 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.26
 log
 @GET_TF_INPUT WANT_PIXSIZ params
diff --git src/RCS/trafd.f,v src/RCS/trafd.f,v
index 7091f793..ecac0fa7 100644
--- src/RCS/trafd.f,v
+++ src/RCS/trafd.f,v
@@ -1,4 +1,4 @@
-head	1.22;
+head	1.23;
 access;
 symbols
 	pre_mrcs:1.22
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.23
+date	2025.11.10.22.33.52;	author dean;	state Exp;
+branches;
+next	1.22;
+
 1.22
 date	2018.10.03.14.51.08;	author leith;	state Exp;
 branches;
@@ -140,9 +145,9 @@ desc
 @
 
 
-1.22
+1.23
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -157,7 +162,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2015  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -275,6 +280,17 @@ C        GET COMMON TF INPUTS
 @
 
 
+1.22
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.21
 log
 @GET_TF_INPUT WANT_PIXSIZ params
diff --git src/RCS/trafl.f,v src/RCS/trafl.f,v
index ec4e268a..f3d3fd0a 100644
--- src/RCS/trafl.f,v
+++ src/RCS/trafl.f,v
@@ -1,4 +1,4 @@
-head	1.32;
+head	1.33;
 access;
 symbols
 	pre_mrcs:1.32
@@ -21,6 +21,11 @@ locks; strict;
 comment	@c @;
 
 
+1.33
+date	2025.11.10.22.33.52;	author dean;	state Exp;
+branches;
+next	1.32;
+
 1.32
 date	2018.10.03.14.51.08;	author leith;	state Exp;
 branches;
@@ -187,9 +192,9 @@ desc
 @
 
 
-1.32
+1.33
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -205,7 +210,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2015  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software! you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -590,6 +595,17 @@ C     CLOSE DOCUMENT FILE
 @
 
 
+1.32
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.31
 log
 @removed debug output
diff --git src/RCS/trafsim.f,v src/RCS/trafsim.f,v
index 31d38e83..38505e5a 100644
--- src/RCS/trafsim.f,v
+++ src/RCS/trafsim.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -18,6 +18,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.33.52;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.51.08;	author leith;	state Exp;
 branches;
@@ -63,9 +68,9 @@ desc
 @@
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C**************************************************************************
@@ -78,7 +83,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -717,6 +722,17 @@ C        DO INVERSE FOURIER TRANSFORM
          
          
         
+@
+
+
+1.8
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
 @
 
 
diff --git src/RCS/transpose.f,v src/RCS/transpose.f,v
index 225f78a5..8bfc9f2f 100644
--- src/RCS/transpose.f,v
+++ src/RCS/transpose.f,v
@@ -1,4 +1,4 @@
-head	1.6;
+head	1.7;
 access;
 symbols
 	pre_mrcs:1.6
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.7
+date	2025.11.10.22.33.52;	author dean;	state Exp;
+branches;
+next	1.6;
+
 1.6
 date	2018.10.03.14.51.08;	author leith;	state Exp;
 branches;
@@ -60,9 +65,9 @@ desc
 @
 
 
-1.6
+1.7
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -74,7 +79,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -134,6 +139,17 @@ c  Warning !  luv changes meaning ...
 @
 
 
+1.6
+log
+@email_health_dept
+@
+text
+@d10 1
+a10 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.5
 log
 @GPL_2010
diff --git src/RCS/tridi.f,v src/RCS/tridi.f,v
index 540c6b5b..53b40546 100644
--- src/RCS/tridi.f,v
+++ src/RCS/tridi.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.33.52;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.51.08;	author leith;	state Exp;
 branches;
@@ -80,9 +85,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -96,7 +101,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -204,6 +209,17 @@ C***********************************************************************
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @GPL_2010
diff --git src/RCS/trinter.f,v src/RCS/trinter.f,v
index e1472081..88cf619b 100644
--- src/RCS/trinter.f,v
+++ src/RCS/trinter.f,v
@@ -1,4 +1,4 @@
-head	1.13;
+head	1.14;
 access;
 symbols
 	pre_mrcs:1.13
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.14
+date	2025.11.10.22.33.52;	author dean;	state Exp;
+branches;
+next	1.13;
+
 1.13
 date	2018.10.03.14.51.08;	author leith;	state Exp;
 branches;
@@ -95,9 +100,9 @@ desc
 @
 
 
-1.13
+1.14
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -112,7 +117,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -235,6 +240,17 @@ C       WRITE(6,100)K
 @
 
 
+1.13
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.12
 log
 @removed unnecssary terminal output
diff --git src/RCS/triquad.f,v src/RCS/triquad.f,v
index e3da8a78..0d03ff81 100644
--- src/RCS/triquad.f,v
+++ src/RCS/triquad.f,v
@@ -1,4 +1,4 @@
-head	1.6;
+head	1.7;
 access;
 symbols
 	pre_mrcs:1.6
@@ -21,6 +21,11 @@ locks; strict;
 comment	@c @;
 
 
+1.7
+date	2025.11.10.22.33.52;	author dean;	state Exp;
+branches;
+next	1.6;
+
 1.6
 date	2018.10.03.14.51.08;	author leith;	state Exp;
 branches;
@@ -56,9 +61,9 @@ desc
 @@
 
 
-1.6
+1.7
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -73,7 +78,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -159,6 +164,17 @@ C--*********************************************************************
 @
 
 
+1.6
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.5
 log
 @GPL_2010
diff --git src/RCS/ttest.f,v src/RCS/ttest.f,v
index de063bee..558e6757 100644
--- src/RCS/ttest.f,v
+++ src/RCS/ttest.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.33.52;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.51.08;	author leith;	state Exp;
 branches;
@@ -70,9 +75,9 @@ desc
 @
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -88,7 +93,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -147,6 +152,17 @@ C              FROM TTEST ROUTINE PAGE 466
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @GPL_2010
diff --git src/RCS/ttest1.f,v src/RCS/ttest1.f,v
index 7a06ab0d..fa7b4bbe 100644
--- src/RCS/ttest1.f,v
+++ src/RCS/ttest1.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -22,6 +22,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.33.52;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.51.08;	author leith;	state Exp;
 branches;
@@ -68,9 +73,9 @@ desc
 @
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -84,7 +89,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -134,6 +139,17 @@ C              FROM TTEST ROUTINE PAGE 466
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @GPL_2010
diff --git src/RCS/tvwn3.f,v src/RCS/tvwn3.f,v
index b00e12b8..e17a1ae6 100644
--- src/RCS/tvwn3.f,v
+++ src/RCS/tvwn3.f,v
@@ -1,4 +1,4 @@
-head	1.25;
+head	1.26;
 access;
 symbols
 	pre_mrcs:1.25
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.26
+date	2025.11.10.22.33.52;	author dean;	state Exp;
+branches;
+next	1.25;
+
 1.25
 date	2018.10.03.14.51.08;	author leith;	state Exp;
 branches;
@@ -155,9 +160,9 @@ desc
 @
 
 
-1.25
+1.26
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -185,7 +190,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -589,6 +594,17 @@ C         THE REFINEMENT MAY THROW SOME REFLECTIONS OUT OR ENTER NEW ONES)
 @
 
 
+1.25
+log
+@email_health_dept
+@
+text
+@d26 1
+a26 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.24
 log
 @call tree added
diff --git src/RCS/udoc.f,v src/RCS/udoc.f,v
index 2603e030..6045625c 100644
--- src/RCS/udoc.f,v
+++ src/RCS/udoc.f,v
@@ -1,4 +1,4 @@
-head	1.30;
+head	1.31;
 access;
 symbols
 	pre_mrcs:1.30
@@ -25,6 +25,11 @@ locks; strict;
 comment	@c @;
 
 
+1.31
+date	2025.11.10.22.33.52;	author dean;	state Exp;
+branches;
+next	1.30;
+
 1.30
 date	2018.10.03.14.51.08;	author leith;	state Exp;
 branches;
@@ -181,9 +186,9 @@ desc
 @
 
 
-1.30
+1.31
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -204,7 +209,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -353,6 +358,17 @@ C       DO NOT CLOSE FILE UNTIL 'UD E' IS GIVEN!
 @
 
 
+1.30
+log
+@email_health_dept
+@
+text
+@d19 1
+a19 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.29
 log
 @ERRT PARAM, and SAVE declarations (cosmetic)
diff --git src/RCS/udocic.f,v src/RCS/udocic.f,v
index 6b3c7014..4a2890aa 100644
--- src/RCS/udocic.f,v
+++ src/RCS/udocic.f,v
@@ -1,4 +1,4 @@
-head	1.50;
+head	1.51;
 access;
 symbols
 	pre_mrcs:1.50
@@ -25,6 +25,11 @@ locks; strict;
 comment	@c @;
 
 
+1.51
+date	2025.11.10.22.33.52;	author dean;	state Exp;
+branches;
+next	1.50;
+
 1.50
 date	2018.10.03.14.51.08;	author leith;	state Exp;
 branches;
@@ -281,9 +286,9 @@ desc
 @
 
 
-1.50
+1.51
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -304,7 +309,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -614,6 +619,17 @@ C       SET REGISTER CONTENTS FROM PLIST --------------------------
 @
 
 
+1.50
+log
+@email_health_dept
+@
+text
+@d19 1
+a19 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.49
 log
 @GPL_2010
diff --git src/RCS/unixtounix8.f,v src/RCS/unixtounix8.f,v
index 00b08eaa..58386353 100644
--- src/RCS/unixtounix8.f,v
+++ src/RCS/unixtounix8.f,v
@@ -1,4 +1,4 @@
-head	1.26;
+head	1.27;
 access;
 symbols
 	pre_mrcs:1.26
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.27
+date	2025.11.10.22.33.52;	author dean;	state Exp;
+branches;
+next	1.26;
+
 1.26
 date	2018.10.03.14.51.08;	author leith;	state Exp;
 branches;
@@ -166,9 +171,9 @@ desc
 @
 
 
-1.26
+1.27
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -184,7 +189,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -308,6 +313,17 @@ c******************************
 @
 
 
+1.26
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.25
 log
 @GPL_2010
diff --git src/RCS/unsav.f,v src/RCS/unsav.f,v
index 5f1514fa..ef987f0f 100644
--- src/RCS/unsav.f,v
+++ src/RCS/unsav.f,v
@@ -1,4 +1,4 @@
-head	1.22;
+head	1.23;
 access;
 symbols
 	pre_mrcs:1.22
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.23
+date	2025.11.10.22.33.52;	author dean;	state Exp;
+branches;
+next	1.22;
+
 1.22
 date	2018.10.03.14.51.08;	author leith;	state Exp;
 branches;
@@ -140,9 +145,9 @@ desc
 @
 
 
-1.22
+1.23
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -159,7 +164,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -270,6 +275,17 @@ C          DID NOT EVEN FIND THIS KEY
 @
 
 
+1.22
+log
+@email_health_dept
+@
+text
+@d15 1
+a15 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.21
 log
 @GPL_2010
diff --git src/RCS/unsdal.f,v src/RCS/unsdal.f,v
index 4aa3e41c..c4292d37 100644
--- src/RCS/unsdal.f,v
+++ src/RCS/unsdal.f,v
@@ -1,4 +1,4 @@
-head	1.24;
+head	1.25;
 access;
 symbols
 	pre_mrcs:1.24
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.25
+date	2025.11.10.22.33.52;	author dean;	state Exp;
+branches;
+next	1.24;
+
 1.24
 date	2018.10.03.14.51.08;	author leith;	state Exp;
 branches;
@@ -150,9 +155,9 @@ desc
 @
 
 
-1.24
+1.25
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -169,7 +174,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -370,6 +375,17 @@ C ---------------------------------------------------------------
 @
 
 
+1.24
+log
+@email_health_dept
+@
+text
+@d15 1
+a15 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.23
 log
 @GPL_2010
diff --git src/RCS/updf.f,v src/RCS/updf.f,v
index b76bbc39..52d50193 100644
--- src/RCS/updf.f,v
+++ src/RCS/updf.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.33.52;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.51.08;	author leith;	state Exp;
 branches;
@@ -80,9 +85,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -95,7 +100,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -135,6 +140,17 @@ c$omp parallel do private(i)
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @GPL_2010
diff --git src/RCS/updtc.f,v src/RCS/updtc.f,v
index 2a937bdc..0edf59cc 100644
--- src/RCS/updtc.f,v
+++ src/RCS/updtc.f,v
@@ -1,4 +1,4 @@
-head	1.13;
+head	1.14;
 access;
 symbols
 	pre_mrcs:1.13
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.14
+date	2025.11.10.22.33.52;	author dean;	state Exp;
+branches;
+next	1.13;
+
 1.13
 date	2018.10.03.14.51.08;	author leith;	state Exp;
 branches;
@@ -95,9 +100,9 @@ desc
 @
 
 
-1.13
+1.14
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -110,7 +115,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -168,6 +173,17 @@ c$omp parallel do private(i,j,nsirt,arg,c)
 @
 
 
+1.13
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.12
 log
 @GPL_2010
diff --git src/RCS/updtf.f,v src/RCS/updtf.f,v
index bf602f93..0f66eefd 100644
--- src/RCS/updtf.f,v
+++ src/RCS/updtf.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.33.52;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.51.08;	author leith;	state Exp;
 branches;
@@ -80,9 +85,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*******************************************************************
@@ -94,7 +99,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -128,6 +133,17 @@ c$omp parallel do private(i)
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d10 1
+a10 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @GPL_2010
diff --git src/RCS/updtf_r.f,v src/RCS/updtf_r.f,v
index 9d3c247b..4e46e99f 100644
--- src/RCS/updtf_r.f,v
+++ src/RCS/updtf_r.f,v
@@ -1,4 +1,4 @@
-head	1.6;
+head	1.7;
 access;
 symbols
 	pre_mrcs:1.6
@@ -21,6 +21,11 @@ locks; strict;
 comment	@c @;
 
 
+1.7
+date	2025.11.10.22.33.52;	author dean;	state Exp;
+branches;
+next	1.6;
+
 1.6
 date	2018.10.03.14.51.08;	author leith;	state Exp;
 branches;
@@ -56,9 +61,9 @@ desc
 @@
 
 
-1.6
+1.7
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*******************************************************************
@@ -70,7 +75,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -106,6 +111,17 @@ c$omp parallel do private(i,j)
 @
 
 
+1.6
+log
+@email_health_dept
+@
+text
+@d10 1
+a10 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.5
 log
 @GPL_2010
diff --git src/RCS/uqu.f,v src/RCS/uqu.f,v
index a67a783f..56ebc768 100644
--- src/RCS/uqu.f,v
+++ src/RCS/uqu.f,v
@@ -1,4 +1,4 @@
-head	1.12;
+head	1.13;
 access;
 symbols
 	pre_mrcs:1.12
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.13
+date	2025.11.10.22.33.52;	author dean;	state Exp;
+branches;
+next	1.12;
+
 1.12
 date	2018.10.03.14.51.08;	author leith;	state Exp;
 branches;
@@ -90,9 +95,9 @@ desc
 @
 
 
-1.12
+1.13
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -106,7 +111,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -185,6 +190,17 @@ C       FIND INITIAL VALUES
 @
 
 
+1.12
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.11
 log
 @updated
diff --git src/RCS/util2.f,v src/RCS/util2.f,v
index d9dbc3c8..5aad4888 100644
--- src/RCS/util2.f,v
+++ src/RCS/util2.f,v
@@ -1,4 +1,4 @@
-head	1.183;
+head	1.184;
 access;
 symbols
 	pre_mrcs:1.178
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.184
+date	2025.09.21.15.20.18;	author dean;	state Exp;
+branches;
+next	1.183;
+
 1.183
 date	2020.02.24.17.00.49;	author leith;	state Exp;
 branches;
@@ -951,9 +956,10 @@ desc
 @
 
 
-1.183
+1.184
 log
-@changes when removed getstack... ops
+@CALL COPY1  unused maxdim 
+NSLICE2, NSAMS,NROWS,NSLICES, 0,0.0,FCHAR(4:4)  bug??
 @
 text
 @C++*********************************************************************
@@ -1185,7 +1191,8 @@ C           INPUT BACKGROUND VALUE
         GOTO 9000
 
 C       OPERATION ----------- COPY  ------------------------------ 'CP' 
-3       CALL COPY1(MAXDIM)              
+
+3       CALL COPY1              
         GOTO 9000
 
 C       OPERATION -------- INSERT -------------------------------- 'IN' 
@@ -1325,7 +1332,7 @@ C       OPEN SECOND INPUT FILE
      &              'TOP LEFT COORDINATES',IRTFLG)
 
         CALL PATCH(LUN1,LUN2,NSAM1,NROW1,NSLICE1, NSAM2,NROW2,
-     &             NSLICE2, NSAMS,NROWS,NSLICES, 0,0,FCHAR(4:4),
+     &             NSLICE2, NSAMS,NROWS,NSLICES, 0,0.0,FCHAR(4:4),
      &             FMIN1,FMAX1,.FALSE.)
 
 C       SET UNDETERMINED STATISTICS FLAG
@@ -2258,6 +2265,20 @@ C       OPEN IMAGE INPUT FILE
 @
 
 
+1.183
+log
+@changes when removed getstack... ops
+@
+text
+@d230 2
+a231 1
+3       CALL COPY1(MAXDIM)              
+d371 1
+a371 1
+     &             NSLICE2, NSAMS,NROWS,NSLICES, 0,0,FCHAR(4:4),
+@
+
+
 1.182
 log
 @'AR'  extracted to util2_11.f
diff --git src/RCS/util5.f,v src/RCS/util5.f,v
index af068141..dc703910 100644
--- src/RCS/util5.f,v
+++ src/RCS/util5.f,v
@@ -1,4 +1,4 @@
-head	1.13;
+head	1.14;
 access;
 symbols
 	pre_mrcs:1.13
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.14
+date	2025.11.10.22.33.53;	author dean;	state Exp;
+branches;
+next	1.13;
+
 1.13
 date	2018.10.03.14.51.08;	author leith;	state Exp;
 branches;
@@ -95,9 +100,9 @@ desc
 @
 
 
-1.13
+1.14
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -114,7 +119,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -172,6 +177,17 @@ C **********************************************************************
 @
 
 
+1.13
+log
+@email_health_dept
+@
+text
+@d15 1
+a15 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.12
 log
 @removed ops
diff --git src/RCS/util6.f,v src/RCS/util6.f,v
index 8d291e5e..265207b0 100644
--- src/RCS/util6.f,v
+++ src/RCS/util6.f,v
@@ -1,4 +1,4 @@
-head	1.19;
+head	1.20;
 access;
 symbols
 	pre_mrcs:1.19
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.20
+date	2025.11.10.22.33.53;	author dean;	state Exp;
+branches;
+next	1.19;
+
 1.19
 date	2018.10.03.14.51.08;	author leith;	state Exp;
 branches;
@@ -125,9 +130,9 @@ desc
 @
 
 
-1.19
+1.20
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -143,7 +148,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -273,6 +278,17 @@ C          NROWF IS DEPENDENT ON YOUR FONT IMAGE (KLUDGE)
 @
 
 
+1.19
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.18
 log
 @COMMON /COMMUN1/ removed
diff --git src/RCS/var3d.f,v src/RCS/var3d.f,v
index 843492ad..9e9b16a1 100644
--- src/RCS/var3d.f,v
+++ src/RCS/var3d.f,v
@@ -1,4 +1,4 @@
-head	1.14;
+head	1.15;
 access;
 symbols
 	pre_mrcs:1.14
@@ -17,6 +17,11 @@ locks; strict;
 comment	@c @;
 
 
+1.15
+date	2025.11.10.22.33.54;	author dean;	state Exp;
+branches;
+next	1.14;
+
 1.14
 date	2018.10.03.14.51.08;	author leith;	state Exp;
 branches;
@@ -92,9 +97,9 @@ desc
 @@
 
 
-1.14
+1.15
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -4395,7 +4400,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -4535,7 +4540,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -4758,6 +4763,20 @@ c$omp   parallel do private(i,j,k,lr)
 @
 
 
+1.14
+log
+@email_health_dept
+@
+text
+@d4299 1
+a4299 1
+C=* Email: spider@@health.ny.gov                                        *
+d4439 1
+a4439 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.13
 log
 @enter
diff --git src/RCS/vax32u.f,v src/RCS/vax32u.f,v
index 8f3fb7e3..e699043a 100644
--- src/RCS/vax32u.f,v
+++ src/RCS/vax32u.f,v
@@ -1,4 +1,4 @@
-head	1.14;
+head	1.15;
 access;
 symbols
 	pre_mrcs:1.14
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.15
+date	2025.11.10.22.33.54;	author dean;	state Exp;
+branches;
+next	1.14;
+
 1.14
 date	2018.10.03.14.51.08;	author leith;	state Exp;
 branches;
@@ -100,9 +105,9 @@ desc
 @
 
 
-1.14
+1.15
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @ 
@@ -130,7 +135,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -219,6 +224,17 @@ C     256 = 0000 0001 0000 0000
 @
 
 
+1.14
+log
+@email_health_dept
+@
+text
+@d26 1
+a26 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.13
 log
 @GPL_2010
diff --git src/RCS/vaxtounix.f,v src/RCS/vaxtounix.f,v
index 0a60e93e..84c0565f 100644
--- src/RCS/vaxtounix.f,v
+++ src/RCS/vaxtounix.f,v
@@ -1,4 +1,4 @@
-head	1.27;
+head	1.28;
 access;
 symbols
 	pre_mrcs:1.27
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.28
+date	2025.11.10.22.33.54;	author dean;	state Exp;
+branches;
+next	1.27;
+
 1.27
 date	2018.10.03.14.51.08;	author leith;	state Exp;
 branches;
@@ -165,9 +170,9 @@ desc
 @
 
 
-1.27
+1.28
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -195,7 +200,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -375,6 +380,17 @@ C       SET FLAG FOR NORMAL RETURN
 @
 
 
+1.27
+log
+@email_health_dept
+@
+text
+@d26 1
+a26 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.26
 log
 @enter
diff --git src/RCS/vismap.f,v src/RCS/vismap.f,v
index 5aa65c54..5ed2a8a6 100644
--- src/RCS/vismap.f,v
+++ src/RCS/vismap.f,v
@@ -1,4 +1,4 @@
-head	1.23;
+head	1.24;
 access;
 symbols
 	pre_mrcs:1.23
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.24
+date	2025.11.10.22.33.54;	author dean;	state Exp;
+branches;
+next	1.23;
+
 1.23
 date	2018.10.03.14.51.09;	author leith;	state Exp;
 branches;
@@ -145,9 +150,9 @@ desc
 @
 
 
-1.23
+1.24
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -160,7 +165,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2013  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -634,6 +639,17 @@ C       X-QUADRANTS FINISHED, WRITE ARRAY
 @
 
 
+1.23
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.22
 log
 @file name overwrite bug, cosmetic
diff --git src/RCS/vms.f,v src/RCS/vms.f,v
index 530616e1..fb2f2d15 100644
--- src/RCS/vms.f,v
+++ src/RCS/vms.f,v
@@ -1,4 +1,4 @@
-head	1.31;
+head	1.32;
 access;
 symbols
 	pre_mrcs:1.31
@@ -25,6 +25,11 @@ locks; strict;
 comment	@c @;
 
 
+1.32
+date	2025.11.10.22.33.54;	author dean;	state Exp;
+branches;
+next	1.31;
+
 1.31
 date	2018.10.03.14.51.09;	author leith;	state Exp;
 branches;
@@ -186,9 +191,9 @@ desc
 @
 
 
-1.31
+1.32
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -208,7 +213,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2012  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -359,6 +364,17 @@ C              START OF [_
 @
 
 
+1.31
+log
+@email_health_dept
+@
+text
+@d18 1
+a18 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.30
 log
 @implicit none
diff --git src/RCS/vms_cd.f,v src/RCS/vms_cd.f,v
index 4edd2330..0c5bc892 100644
--- src/RCS/vms_cd.f,v
+++ src/RCS/vms_cd.f,v
@@ -1,4 +1,4 @@
-head	1.3;
+head	1.4;
 access;
 symbols
 	pre_mrcs:1.3
@@ -11,6 +11,11 @@ locks; strict;
 comment	@c @;
 
 
+1.4
+date	2025.11.10.22.33.54;	author dean;	state Exp;
+branches;
+next	1.3;
+
 1.3
 date	2018.10.03.14.51.09;	author leith;	state Exp;
 branches;
@@ -31,9 +36,9 @@ desc
 @@
 
 
-1.3
+1.4
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -48,7 +53,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -112,6 +117,17 @@ cc         write(6,*) comman(:nc)
 @
 
 
+1.3
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.2
 log
 @GPL_2010
diff --git src/RCS/voda.f,v src/RCS/voda.f,v
index 253c9018..d5fcaed1 100644
--- src/RCS/voda.f,v
+++ src/RCS/voda.f,v
@@ -1,4 +1,4 @@
-head	1.17;
+head	1.18;
 access;
 symbols
 	pre_mrcs:1.17
@@ -23,6 +23,11 @@ locks; strict;
 comment	@c @;
 
 
+1.18
+date	2025.11.10.22.33.54;	author dean;	state Exp;
+branches;
+next	1.17;
+
 1.17
 date	2018.10.03.14.51.09;	author leith;	state Exp;
 branches;
@@ -114,9 +119,9 @@ desc
 @
 
 
-1.17
+1.18
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @cp
@@ -132,7 +137,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2011  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -356,6 +361,17 @@ C             SAVE IN DOC FILE
 @
 
 
+1.17
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.16
 log
 @enter
diff --git src/RCS/voea.f,v src/RCS/voea.f,v
index fd6fcadc..ef68571f 100644
--- src/RCS/voea.f,v
+++ src/RCS/voea.f,v
@@ -1,4 +1,4 @@
-head	1.24;
+head	1.25;
 access;
 symbols
 	pre_mrcs:1.24
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.25
+date	2025.11.10.22.33.54;	author dean;	state Exp;
+branches;
+next	1.24;
+
 1.24
 date	2018.10.03.14.51.09;	author leith;	state Exp;
 branches;
@@ -150,9 +155,9 @@ desc
 @
 
 
-1.24
+1.25
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -170,7 +175,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -294,6 +299,17 @@ C           FOR LEGACY DEFAULT
 @
 
 
+1.24
+log
+@email_health_dept
+@
+text
+@d16 1
+a16 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.23
 log
 @legacy defaults replaced for t1,p1
diff --git src/RCS/voept.f,v src/RCS/voept.f,v
index 6677edd8..2d6f93ee 100644
--- src/RCS/voept.f,v
+++ src/RCS/voept.f,v
@@ -1,4 +1,4 @@
-head	1.7;
+head	1.8;
 access;
 symbols
 	pre_mrcs:1.7
@@ -19,6 +19,11 @@ locks; strict;
 comment	@c @;
 
 
+1.8
+date	2025.11.10.22.33.54;	author dean;	state Exp;
+branches;
+next	1.7;
+
 1.7
 date	2018.10.03.14.51.09;	author leith;	state Exp;
 branches;
@@ -59,9 +64,9 @@ desc
 @@
 
 
-1.7
+1.8
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -76,7 +81,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -165,6 +170,17 @@ cc90    FORMAT('(',F4.1,','F4.1,','F4.1,')....(',F4.1,','F4.1,','F4.1,')')
 
 
    
+@
+
+
+1.7
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
 @
 
 
diff --git src/RCS/voia.f,v src/RCS/voia.f,v
index 9621c3a3..6a9fdfd3 100644
--- src/RCS/voia.f,v
+++ src/RCS/voia.f,v
@@ -1,4 +1,4 @@
-head	1.6;
+head	1.7;
 access;
 symbols
 	pre_mrcs:1.6
@@ -19,6 +19,11 @@ locks; strict;
 comment	@c @;
 
 
+1.7
+date	2025.11.10.22.33.54;	author dean;	state Exp;
+branches;
+next	1.6;
+
 1.6
 date	2018.10.03.14.51.09;	author leith;	state Exp;
 branches;
@@ -54,9 +59,9 @@ desc
 @@
 
 
-1.6
+1.7
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -70,7 +75,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -161,6 +166,17 @@ C          COSANG =  DOT(VEC1,VEC2) / SQRT(DIS13)
 @
 
 
+1.6
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.5
 log
 @cosd gfortran conversion wrong
diff --git src/RCS/vomd.f,v src/RCS/vomd.f,v
index 53383b9f..3e19acf8 100644
--- src/RCS/vomd.f,v
+++ src/RCS/vomd.f,v
@@ -1,4 +1,4 @@
-head	1.16;
+head	1.17;
 access;
 symbols
 	pre_mrcs:1.16
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.17
+date	2025.11.10.22.33.54;	author dean;	state Exp;
+branches;
+next	1.16;
+
 1.16
 date	2018.10.03.14.51.09;	author leith;	state Exp;
 branches;
@@ -110,9 +115,9 @@ desc
 @
 
 
-1.16
+1.17
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -129,7 +134,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2012  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -228,6 +233,17 @@ C        FILLS AAA WITH 3 ANGLES PER LINE
 @
 
 
+1.16
+log
+@email_health_dept
+@
+text
+@d15 1
+a15 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.15
 log
 @cosmetic modernization
diff --git src/RCS/vomq.f,v src/RCS/vomq.f,v
index c2073b4f..16bc4f1f 100644
--- src/RCS/vomq.f,v
+++ src/RCS/vomq.f,v
@@ -1,4 +1,4 @@
-head	1.19;
+head	1.20;
 access;
 symbols
 	pre_mrcs:1.19
@@ -23,6 +23,11 @@ locks; strict;
 comment	@c @;
 
 
+1.20
+date	2025.11.10.22.33.54;	author dean;	state Exp;
+branches;
+next	1.19;
+
 1.19
 date	2018.10.03.14.51.09;	author leith;	state Exp;
 branches;
@@ -124,9 +129,9 @@ desc
 @
 
 
-1.19
+1.20
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -143,7 +148,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2013  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -317,6 +322,17 @@ C         ADD LINE TO CURRENT GROUP TOP-LEVEL OUTPUT FILE
 @
 
 
+1.19
+log
+@email_health_dept
+@
+text
+@d15 1
+a15 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.18
 log
 @labels in doc file for cols
diff --git src/RCS/vonea.f,v src/RCS/vonea.f,v
index d84d2164..e4e644ed 100644
--- src/RCS/vonea.f,v
+++ src/RCS/vonea.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -14,6 +14,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.33.54;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.51.09;	author leith;	state Exp;
 branches;
@@ -59,9 +64,9 @@ desc
 @@
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -74,7 +79,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -217,6 +222,17 @@ c             WRITE(6,92) KEY, PSI, THETA(KEY), PHI(KEY)
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @ATAN2(XD,YD) * RAD_TO_DGR  was wrong
diff --git src/RCS/vora.f,v src/RCS/vora.f,v
index 383624df..621fbeaf 100644
--- src/RCS/vora.f,v
+++ src/RCS/vora.f,v
@@ -1,4 +1,4 @@
-head	1.13;
+head	1.14;
 access;
 symbols
 	pre_mrcs:1.13
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.14
+date	2025.11.10.22.33.54;	author dean;	state Exp;
+branches;
+next	1.13;
+
 1.13
 date	2018.10.03.14.51.09;	author leith;	state Exp;
 branches;
@@ -95,9 +100,9 @@ desc
 @
 
 
-1.13
+1.14
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -113,7 +118,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2012  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -259,6 +264,17 @@ C       DEALLOCATE DOC. FILE MEMORY
 @
 
 
+1.13
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.12
 log
 @fixed missing key bug
diff --git src/RCS/vprop.f,v src/RCS/vprop.f,v
index f2a09bec..42ad0056 100644
--- src/RCS/vprop.f,v
+++ src/RCS/vprop.f,v
@@ -1,4 +1,4 @@
-head	1.13;
+head	1.14;
 access;
 symbols
 	pre_mrcs:1.13
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.14
+date	2025.11.10.22.33.54;	author dean;	state Exp;
+branches;
+next	1.13;
+
 1.13
 date	2018.10.03.14.51.09;	author leith;	state Exp;
 branches;
@@ -95,9 +100,9 @@ desc
 @
 
 
-1.13
+1.14
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -111,7 +116,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -228,6 +233,17 @@ C======================================================================
 @
 
 
+1.13
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.12
 log
 @GPL_2010
diff --git src/RCS/vtil2.f,v src/RCS/vtil2.f,v
index 196729dd..80e17a2e 100644
--- src/RCS/vtil2.f,v
+++ src/RCS/vtil2.f,v
@@ -1,4 +1,4 @@
-head	1.88;
+head	1.89;
 access;
 symbols
 	pre_mrcs:1.88
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.89
+date	2025.11.10.22.33.54;	author dean;	state Exp;
+branches;
+next	1.88;
+
 1.88
 date	2018.10.03.14.51.09;	author leith;	state Exp;
 branches;
@@ -470,9 +475,9 @@ desc
 @
 
 
-1.88
+1.89
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -513,7 +518,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2018  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -820,6 +825,17 @@ C----------------------------------------------------------------------
 @
 
 
+1.88
+log
+@email_health_dept
+@
+text
+@d39 1
+a39 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.87
 log
 @pj2d
diff --git src/RCS/vtil3.f,v src/RCS/vtil3.f,v
index e7fc4b0a..f414ee63 100644
--- src/RCS/vtil3.f,v
+++ src/RCS/vtil3.f,v
@@ -1,4 +1,4 @@
-head	1.16;
+head	1.17;
 access;
 symbols
 	pre_mrcs:1.16
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.17
+date	2025.11.10.22.33.54;	author dean;	state Exp;
+branches;
+next	1.16;
+
 1.16
 date	2018.10.03.14.51.09;	author leith;	state Exp;
 branches;
@@ -110,9 +115,9 @@ desc
 @
 
 
-1.16
+1.17
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -126,7 +131,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2015  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -183,6 +188,17 @@ C	DATA FUNC/'TA SP 19 ML'/   ! 19 is SPH
 @
 
 
+1.16
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.15
 log
 @added ML
diff --git src/RCS/warp3.f,v src/RCS/warp3.f,v
index d49dc8e5..1d1a6da2 100644
--- src/RCS/warp3.f,v
+++ src/RCS/warp3.f,v
@@ -1,4 +1,4 @@
-head	1.15;
+head	1.16;
 access;
 symbols
 	pre_mrcs:1.15
@@ -19,6 +19,11 @@ locks; strict;
 comment	@c @;
 
 
+1.16
+date	2025.11.10.22.33.54;	author dean;	state Exp;
+branches;
+next	1.15;
+
 1.15
 date	2018.10.03.14.51.09;	author leith;	state Exp;
 branches;
@@ -99,9 +104,9 @@ desc
 @@
 
 
-1.15
+1.16
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -118,7 +123,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2011  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -928,6 +933,17 @@ C     BACKSUBSTITUTION
 @
 
 
+1.15
+log
+@email_health_dept
+@
+text
+@d15 1
+a15 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.14
 log
 @X WARP BUG
diff --git src/RCS/wate.f,v src/RCS/wate.f,v
index 1ee4af70..f034fa01 100644
--- src/RCS/wate.f,v
+++ src/RCS/wate.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.33.54;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.51.09;	author leith;	state Exp;
 branches;
@@ -70,9 +75,9 @@ desc
 @
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -86,7 +91,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -128,6 +133,17 @@ C***********************************************************************
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @GPL_2010
diff --git src/RCS/watershd.f,v src/RCS/watershd.f,v
index db2f8ca5..e333b217 100644
--- src/RCS/watershd.f,v
+++ src/RCS/watershd.f,v
@@ -1,4 +1,4 @@
-head	1.5;
+head	1.6;
 access;
 symbols
 	pre_mrcs:1.5
@@ -21,6 +21,11 @@ locks; strict;
 comment	@c @;
 
 
+1.6
+date	2025.11.10.22.33.54;	author dean;	state Exp;
+branches;
+next	1.5;
+
 1.5
 date	2018.10.03.14.51.09;	author leith;	state Exp;
 branches;
@@ -51,9 +56,9 @@ desc
 @@
 
 
-1.5
+1.6
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -67,7 +72,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -210,6 +215,17 @@ C          OUTPUT ROW
 @
 
 
+1.5
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.4
 log
 @GPL_2010
diff --git src/RCS/watershed.f,v src/RCS/watershed.f,v
index 78fd6be1..bd830315 100644
--- src/RCS/watershed.f,v
+++ src/RCS/watershed.f,v
@@ -1,4 +1,4 @@
-head	1.6;
+head	1.7;
 access;
 symbols
 	pre_mrcs:1.6
@@ -19,6 +19,11 @@ locks; strict;
 comment	@c @;
 
 
+1.7
+date	2025.11.10.22.33.54;	author dean;	state Exp;
+branches;
+next	1.6;
+
 1.6
 date	2018.10.03.14.51.09;	author leith;	state Exp;
 branches;
@@ -54,9 +59,9 @@ desc
 @@
 
 
-1.6
+1.7
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -69,7 +74,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -352,6 +357,17 @@ C                LOWER-RIGHT
 @
 
 
+1.6
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.5
 log
 @comments, header comments, nx, ==
diff --git src/RCS/wftcirc.f,v src/RCS/wftcirc.f,v
index 7fc3f815..c269c40e 100644
--- src/RCS/wftcirc.f,v
+++ src/RCS/wftcirc.f,v
@@ -1,4 +1,4 @@
-head	1.14;
+head	1.15;
 access;
 symbols
 	pre_mrcs:1.14
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.15
+date	2025.11.10.22.33.54;	author dean;	state Exp;
+branches;
+next	1.14;
+
 1.14
 date	2018.10.03.14.51.09;	author leith;	state Exp;
 branches;
@@ -100,9 +105,9 @@ desc
 @
 
 
-1.14
+1.15
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -116,7 +121,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -242,6 +247,17 @@ C--*******************************************************************
 @
 
 
+1.14
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.13
 log
 @call tree added
diff --git src/RCS/wgbp2.f,v src/RCS/wgbp2.f,v
index c0c5be96..29aa72a6 100644
--- src/RCS/wgbp2.f,v
+++ src/RCS/wgbp2.f,v
@@ -1,4 +1,4 @@
-head	1.33;
+head	1.34;
 access;
 symbols
 	pre_mrcs:1.33
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.34
+date	2025.11.10.22.33.54;	author dean;	state Exp;
+branches;
+next	1.33;
+
 1.33
 date	2018.10.03.14.51.09;	author leith;	state Exp;
 branches;
@@ -195,9 +200,9 @@ desc
 @
 
 
-1.33
+1.34
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -213,7 +218,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2014  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -665,6 +670,17 @@ C     2                 +     DIPX *B(IQX+1)
 @
 
 
+1.33
+log
+@email_health_dept
+@
+text
+@d14 1
+a14 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.32
 log
 @prompts
diff --git src/RCS/winave.f,v src/RCS/winave.f,v
index 2d1edde8..ca699cc1 100644
--- src/RCS/winave.f,v
+++ src/RCS/winave.f,v
@@ -1,4 +1,4 @@
-head	1.18;
+head	1.19;
 access;
 symbols
 	pre_mrcs:1.18
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.19
+date	2025.11.10.22.33.54;	author dean;	state Exp;
+branches;
+next	1.18;
+
 1.18
 date	2018.10.03.14.51.09;	author leith;	state Exp;
 branches;
@@ -120,9 +125,9 @@ desc
 @
 
 
-1.18
+1.19
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -139,7 +144,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -386,6 +391,17 @@ C	THE FOLLOWING LINES TAKE INTO ACCOUNT THE INTERPOLATION
 @
 
 
+1.18
+log
+@email_health_dept
+@
+text
+@d15 1
+a15 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.17
 log
 @GPL_2010
diff --git src/RCS/winave2.f,v src/RCS/winave2.f,v
index 73375628..13940af5 100644
--- src/RCS/winave2.f,v
+++ src/RCS/winave2.f,v
@@ -1,4 +1,4 @@
-head	1.21;
+head	1.22;
 access;
 symbols
 	pre_mrcs:1.21
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.22
+date	2025.11.10.22.33.54;	author dean;	state Exp;
+branches;
+next	1.21;
+
 1.21
 date	2018.10.03.14.51.09;	author leith;	state Exp;
 branches;
@@ -135,9 +140,9 @@ desc
 @
 
 
-1.21
+1.22
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -152,7 +157,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -611,6 +616,17 @@ C END FIXUP .....................................
 @
 
 
+1.21
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.20
 log
 @GPL_2010
diff --git src/RCS/window.f,v src/RCS/window.f,v
index ab4919f6..24cd0f67 100644
--- src/RCS/window.f,v
+++ src/RCS/window.f,v
@@ -1,4 +1,4 @@
-head	1.10;
+head	1.11;
 access;
 symbols
 	pre_mrcs:1.10
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.11
+date	2025.11.10.22.33.54;	author dean;	state Exp;
+branches;
+next	1.10;
+
 1.10
 date	2018.10.03.14.51.09;	author leith;	state Exp;
 branches;
@@ -80,9 +85,9 @@ desc
 @
 
 
-1.10
+1.11
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -96,7 +101,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -261,6 +266,17 @@ C        FILL BLANK SLICES AFTER WINDOW
 @
 
 
+1.10
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.9
 log
 @GPL_2010
diff --git src/RCS/wpdp.f,v src/RCS/wpdp.f,v
index 9e2edaf9..86dcf995 100644
--- src/RCS/wpdp.f,v
+++ src/RCS/wpdp.f,v
@@ -1,4 +1,4 @@
-head	1.21;
+head	1.22;
 access;
 symbols
 	pre_mrcs:1.21
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.22
+date	2025.11.10.22.33.55;	author dean;	state Exp;
+branches;
+next	1.21;
+
 1.21
 date	2018.10.03.14.51.09;	author leith;	state Exp;
 branches;
@@ -135,9 +140,9 @@ desc
 @
 
 
-1.21
+1.22
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -152,7 +157,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -272,6 +277,17 @@ C          DO A MEDIAN FILTRATION AND THEN CALCULATE STATISTICS
 @
 
 
+1.21
+log
+@email_health_dept
+@
+text
+@d13 1
+a13 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.20
 log
 @CHARACTER(LEN=MAXNAM) ::  FINPAT,FINPIC,FILD bug
diff --git src/RCS/wpro_fbs.f,v src/RCS/wpro_fbs.f,v
index 5ed262ed..48d6fd0a 100644
--- src/RCS/wpro_fbs.f,v
+++ src/RCS/wpro_fbs.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -7,6 +7,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.33.56;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.51.09;	author leith;	state Exp;
 branches;
@@ -52,9 +57,9 @@ desc
 @@
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -67,7 +72,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2011  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -238,6 +243,17 @@ C                 CHECK FOR PIXELS OUT OF BOUNDS
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @fbs3 nxp parameter
diff --git src/RCS/wpro_n.f,v src/RCS/wpro_n.f,v
index a7a011ca..fc0857d6 100644
--- src/RCS/wpro_n.f,v
+++ src/RCS/wpro_n.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -20,6 +20,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.33.56;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.51.09;	author leith;	state Exp;
 branches;
@@ -65,9 +70,9 @@ desc
 @@
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -81,7 +86,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2011  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -284,6 +289,17 @@ C                 CHECK FOR PIXELS OUT OF BOUNDS
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @LDPX,LDPY,LDPZ sent from caller not in common
diff --git src/RCS/writepict.f,v src/RCS/writepict.f,v
index 0a95b759..ad32b876 100644
--- src/RCS/writepict.f,v
+++ src/RCS/writepict.f,v
@@ -1,4 +1,4 @@
-head	1.5;
+head	1.6;
 access;
 symbols
 	pre_mrcs:1.5
@@ -20,6 +20,11 @@ locks; strict;
 comment	@c @;
 
 
+1.6
+date	2025.11.10.22.33.56;	author dean;	state Exp;
+branches;
+next	1.5;
+
 1.5
 date	2018.10.03.14.51.09;	author leith;	state Exp;
 branches;
@@ -51,9 +56,9 @@ desc
 @
 
 
-1.5
+1.6
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -61,7 +66,7 @@ C=**********************************************************************
 C=* From: SPIDER - MODULAR IMAGE PROCESSING SYSTEM                     *
 C=* Copyright (C)2000  M. Radermacher                                  *
 C=*                                                                    *
-C=* Email:  spider@@health.ny.gov                                       *
+C=* Email:  spider@@wadsworth.org                                       *
 C=*                                                                    *
 C=* This program is free software; you can redistribute it and/or      *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -114,6 +119,17 @@ C       USE OPFILE, BR
 @
 
 
+1.5
+log
+@email_health_dept
+@
+text
+@d6 1
+a6 1
+C=* Email:  spider@@health.ny.gov                                       *
+@
+
+
 1.4
 log
 @GPL License fixed
diff --git src/RCS/writepictn.f,v src/RCS/writepictn.f,v
index f72fc59f..2a396baa 100644
--- src/RCS/writepictn.f,v
+++ src/RCS/writepictn.f,v
@@ -1,4 +1,4 @@
-head	1.5;
+head	1.6;
 access;
 symbols
 	pre_mrcs:1.5
@@ -20,6 +20,11 @@ locks; strict;
 comment	@c @;
 
 
+1.6
+date	2025.11.10.22.33.56;	author dean;	state Exp;
+branches;
+next	1.5;
+
 1.5
 date	2018.10.03.14.51.09;	author leith;	state Exp;
 branches;
@@ -51,9 +56,9 @@ desc
 @
 
 
-1.5
+1.6
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -61,7 +66,7 @@ C=**********************************************************************
 C=* From: SPIDER - MODULAR IMAGE PROCESSING SYSTEM                     *
 C=* Copyright (C)2000  M. Radermacher                                  *
 C=*                                                                    *
-C=* Email:  spider@@health.ny.gov                                       *
+C=* Email:  spider@@wadsworth.org                                       *
 C=*                                                                    *
 C=* This program is free software; you can redistribute it and/or      *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -109,6 +114,17 @@ C          USE OPFILE, BR
 @
 
 
+1.5
+log
+@email_health_dept
+@
+text
+@d6 1
+a6 1
+C=* Email:  spider@@health.ny.gov                                       *
+@
+
+
 1.4
 log
 @GPL License fixed
diff --git src/RCS/writev.f,v src/RCS/writev.f,v
index 96e8bb36..4674c2f3 100644
--- src/RCS/writev.f,v
+++ src/RCS/writev.f,v
@@ -1,4 +1,4 @@
-head	1.6;
+head	1.7;
 access;
 symbols
 	pre_mrcs:1.6
@@ -22,6 +22,11 @@ locks; strict;
 comment	@c @;
 
 
+1.7
+date	2025.11.10.22.33.56;	author dean;	state Exp;
+branches;
+next	1.6;
+
 1.6
 date	2018.10.03.14.51.09;	author leith;	state Exp;
 branches;
@@ -58,9 +63,9 @@ desc
 @
 
 
-1.6
+1.7
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -72,7 +77,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -116,6 +121,17 @@ C--****************************************************************
 @
 
 
+1.6
+log
+@email_health_dept
+@
+text
+@d10 1
+a10 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.5
 log
 @GPL_2010
diff --git src/RCS/wrsl_p.f,v src/RCS/wrsl_p.f,v
index b03373c2..61c6c26c 100644
--- src/RCS/wrsl_p.f,v
+++ src/RCS/wrsl_p.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.33.56;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.51.09;	author leith;	state Exp;
 branches;
@@ -70,9 +75,9 @@ desc
 @
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -86,7 +91,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -123,6 +128,17 @@ C***********************************************************************
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @GPL_2010
diff --git src/RCS/wrtlin.f,v src/RCS/wrtlin.f,v
index a032a123..05917a93 100644
--- src/RCS/wrtlin.f,v
+++ src/RCS/wrtlin.f,v
@@ -1,4 +1,4 @@
-head	1.37;
+head	1.41;
 access;
 symbols
 	pre_mrcs:1.35
@@ -24,6 +24,26 @@ locks; strict;
 comment	@c @;
 
 
+1.41
+date	2025.10.07.13.45.41;	author dean;	state Exp;
+branches;
+next	1.40;
+
+1.40
+date	2025.10.03.13.55.46;	author dean;	state Exp;
+branches;
+next	1.39;
+
+1.39
+date	2025.10.03.13.54.12;	author dean;	state Exp;
+branches;
+next	1.38;
+
+1.38
+date	2025.10.03.13.35.05;	author dean;	state Exp;
+branches;
+next	1.37;
+
 1.37
 date	2019.12.20.16.39.16;	author leith;	state Exp;
 branches;
@@ -215,26 +235,30 @@ desc
 @
 
 
-1.37
+1.41
 log
-@more mrc support
+@MRC I1BUF UNSAFE IN THREADS
+added debug output
 @
 text
 @
 C++*********************************************************************
-C   WRTLIN.F             IOSTAT ADDED              DEC 97 ArDean Leith
-C                        FILE NAME FOR ERROR       SEP 02 ArDean Leith
-C                        ENDEDNESS                 FEB 03 ArDean Leith
-C                        ONLYONE_WRT               NOV 08 ArDean Leith
-C                        MRC SUPPORT               JUL 19 ArDean Leith
-C                        MORE MRC SUPPORT          DEC 19 ArDean Leith
+C   WRTLIN.F      IOSTAT ADDED                  DEC 1997  ArDean Leith
+C                 FILE NAME FOR ERROR           SEP 2002  ArDean Leith
+C                 ENDEDNESS                     FEB 2003  ArDean Leith
+C                 ONLYONE_WRT                   NOV 2008  ArDean Leith
+C                 MRC SUPPORT                   JUL 2019  ArDean Leith
+C                 MORE MRC SUPPORT              DEC 2019  ArDean Leith
+C                 FIXED MRC NBYT_PER_VAL BUG    SEP 2025  ArDean Leith
+C                 MRC I1BUF UNSAFE IN THREADS   SEP 2025  ArDean Leith
+C
 C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2019  Health Research Inc.,                         *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -279,7 +303,7 @@ C--*********************************************************************
       END MODULE WRTLIN_PIPE_STUFF
 
 
-C     ---------------------- WRTLIN -------------------------------------
+C     ---------------------- WRTLIN ------------------------------------
 
       SUBROUTINE WRTLIN(LUNT,BUF,NB,IREC)
 
@@ -295,6 +319,7 @@ C     USE INLINE BUFFER COMMON AREA
 
       INTEGER         :: IERR,LUNC,NIN,NOUT,NECHO,IFOUND,NPROC,NDAT
       INTEGER         :: LUNARA,LUNSTK,LUNARB,LUNFLIP
+
       COMMON /IOERR/  IERR
       COMMON /UNITS/  LUNC,NIN,NOUT,NECHO,IFOUND,NPROC,NDAT
       COMMON /LUNARA/ LUNARA(100),LUNSTK(100),LUNARB(100),LUNFLIP(100)
@@ -336,6 +361,13 @@ C       TO IREC TO GET THE CORRECT RECORD NUMBER
 
         IERR = 0
         IF (MYPID <= 0) THEN
+
+#if defined (SP_DBUG)
+        if (i < 2) then
+          write(3,*)' In wrtlin; lun,lunflip(lun),nb,i:  ', 
+     &                           lun,lunflip(lun),nb,i 
+        endif
+#endif
            IF (LUNFLIP(LUN) == 0) THEN
               WRITE(LUN,REC=I,IOSTAT=IERR) BUF
            ELSE
@@ -376,7 +408,7 @@ C     PURPOSE:  WRITE BUF TO STREAM ACCESS MRC IMAGE/VOLUME FILE
 
       IMPLICIT NONE
 
-      INCLUDE 'CMLIMIT.INC'   ! NEED: NBUFSIZ
+      INCLUDE 'CMLIMIT.INC'   ! NEED: NBUFSIZ  =  45000
 
       INTEGER         :: LUN,NB,IREC
       REAL            :: BUF(NB)
@@ -385,23 +417,23 @@ C     PURPOSE:  WRITE BUF TO STREAM ACCESS MRC IMAGE/VOLUME FILE
       INTEGER *8      :: LUNMRCPOS
       INTEGER         :: LUNMRCNBYT
       COMMON /LUNMRC/    LUNMRCPOS(100),LUNMRCNBYT(100)
+
       INTEGER         :: LUNARA,LUNSTK,LUNARB,LUNFLIP
       COMMON /LUNARA/   LUNARA(100),LUNSTK(100),LUNARB(100),LUNFLIP(100)
 
-      INTEGER *1      :: I1BUF(NBUFSIZ)
-      INTEGER *2      :: I2BUF(NBUFSIZ)
+      INTEGER *1, SAVE :: I1BUF(NBUFSIZ)
+      INTEGER *2, SAVE :: I2BUF(NBUFSIZ)
 
-      INTEGER         :: I,IX,IRTFLG
-      INTEGER         :: NBYT_PER_VAL,NBYT_PER_REC,MRCMODE,NX,NE
-      INTEGER *8      :: IPOSMRC
+      INTEGER          :: I,IX,IRTFLG
+      INTEGER          :: NBYT_PER_VAL,NBYT_PER_REC,NX,NE
+      INTEGER *8       :: IPOSMRC
 
 C     LUNARA CARRIES NX (PIXELS IN X)
       NX = ABS(LUNARA(LUN))
 
 C     DIFFERENT MRC MODES DIFFER IN DATA LENGTHS
-      MRCMODE      = LUNMRCNBYT(LUN)   
-      NBYT_PER_VAL = ABS(MRCMODE)
-      NBYT_PER_REC = NBYT_PER_VAL * NX
+      NBYT_PER_VAL     = ABS(LUNMRCNBYT(LUN))
+      NBYT_PER_REC     = NBYT_PER_VAL * NX
 
 C     FILE POSITION TO BEGIN WRITING DEPENDS ON IREC AND ORIGIN
 
@@ -427,13 +459,13 @@ C        MRC FILE NEEDS 32 BIT REAL VALUES
 C        MRC FILE NEEDS  16 BIT, INTEGER*2 VALUES        
 
          I2BUF(1:NB) = BUF(1:NB)   
-         IF (MYPID <= 0) WRITE(LUN, POS=IPOSMRC,IOSTAT=IERR) I2BUF(1:NB)
+         IF (MYPID <= 0) WRITE(LUN,POS=IPOSMRC,IOSTAT=IERR) I2BUF(1:NB)
 
       ELSEIF (NBYT_PER_VAL == 1) THEN         
 C        MRC FILE NEEDS   8 BIT INTEGER*1 VALUES 
 
          I1BUF(1:NB) = BUF(1:NB)   
-         IF (MYPID <= 0) WRITE(LUN,POS=IPOSMRC,IOSTAT=IERR)I1BUF(1:NB)
+         IF (MYPID <= 0) WRITE(LUN,POS=IPOSMRC,IOSTAT=IERR) I1BUF(1:NB)
  
       ENDIF
 
@@ -599,6 +631,86 @@ C             MUST RE-OPEN PIPE
 @
 
 
+1.40
+log
+@cosmetic msg
+@
+text
+@d11 1
+d121 7
+@
+
+
+1.39
+log
+@SAVE needed for I1BUF use with threads in gfort
+@
+text
+@d10 1
+@
+
+
+1.38
+log
+@MRC nbyt_per_val bug and confusing mrctyp name
+@
+text
+@d172 2
+a173 2
+      INTEGER *1      :: I1BUF(NBUFSIZ)
+      INTEGER *2      :: I2BUF(NBUFSIZ)
+d175 3
+a177 3
+      INTEGER         :: I,IX,IRTFLG
+      INTEGER         :: NBYT_PER_VAL,NBYT_PER_REC,NX,NE
+      INTEGER *8      :: IPOSMRC
+@
+
+
+1.37
+log
+@more mrc support
+@
+text
+@d3 7
+a9 6
+C   WRTLIN.F             IOSTAT ADDED              DEC 97 ArDean Leith
+C                        FILE NAME FOR ERROR       SEP 02 ArDean Leith
+C                        ENDEDNESS                 FEB 03 ArDean Leith
+C                        ONLYONE_WRT               NOV 08 ArDean Leith
+C                        MRC SUPPORT               JUL 19 ArDean Leith
+C                        MORE MRC SUPPORT          DEC 19 ArDean Leith
+d14 1
+a14 1
+C=* Copyright 1985-2019  Health Research Inc.,                         *
+d16 1
+a16 1
+C=* Email: spider@@health.ny.gov                                        *
+d61 1
+a61 1
+C     ---------------------- WRTLIN -------------------------------------
+d77 1
+d159 1
+a159 1
+      INCLUDE 'CMLIMIT.INC'   ! NEED: NBUFSIZ
+d168 1
+d176 1
+a176 1
+      INTEGER         :: NBYT_PER_VAL,NBYT_PER_REC,MRCMODE,NX,NE
+d183 2
+a184 3
+      MRCMODE      = LUNMRCNBYT(LUN)   
+      NBYT_PER_VAL = ABS(MRCMODE)
+      NBYT_PER_REC = NBYT_PER_VAL * NX
+d210 1
+a210 1
+         IF (MYPID <= 0) WRITE(LUN, POS=IPOSMRC,IOSTAT=IERR) I2BUF(1:NB)
+d216 1
+a216 1
+         IF (MYPID <= 0) WRITE(LUN,POS=IPOSMRC,IOSTAT=IERR)I1BUF(1:NB)
+@
+
+
 1.36
 log
 @mrc_support
diff --git src/RCS/wrtlin8.f,v src/RCS/wrtlin8.f,v
index f86dfc2a..2c752afd 100644
--- src/RCS/wrtlin8.f,v
+++ src/RCS/wrtlin8.f,v
@@ -1,4 +1,4 @@
-head	1.7;
+head	1.8;
 access;
 symbols
 	pre_mrcs:1.7
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.8
+date	2025.11.10.22.33.56;	author dean;	state Exp;
+branches;
+next	1.7;
+
 1.7
 date	2018.10.03.14.51.09;	author leith;	state Exp;
 branches;
@@ -65,9 +70,9 @@ desc
 @
 
 
-1.7
+1.8
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -81,7 +86,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -131,6 +136,17 @@ C     ADD LUNARA(LUN)(FOR LABEL REC) TO NREC TO GET THE CORRECT RECORD NUMBER
 @
 
 
+1.7
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.6
 log
 @GPL_2010
diff --git src/RCS/wrtseq8.f,v src/RCS/wrtseq8.f,v
index 87a39d8b..b28a36ff 100644
--- src/RCS/wrtseq8.f,v
+++ src/RCS/wrtseq8.f,v
@@ -1,4 +1,4 @@
-head	1.11;
+head	1.12;
 access;
 symbols
 	pre_mrcs:1.11
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.12
+date	2025.11.10.22.33.56;	author dean;	state Exp;
+branches;
+next	1.11;
+
 1.11
 date	2018.10.03.14.51.09;	author leith;	state Exp;
 branches;
@@ -91,9 +96,9 @@ desc
 @
 
 
-1.11
+1.12
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -107,7 +112,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -157,6 +162,17 @@ C     WRITE(NOUT,*)' BYTES WRITTEN:',NB
 @
 
 
+1.11
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.10
 log
 @GPL_2010
diff --git src/RCS/wrtvol.f,v src/RCS/wrtvol.f,v
index ed3d4cc1..dbaf72e9 100644
--- src/RCS/wrtvol.f,v
+++ src/RCS/wrtvol.f,v
@@ -1,4 +1,4 @@
-head	1.8;
+head	1.9;
 access;
 symbols
 	pre_mrcs:1.8
@@ -21,6 +21,11 @@ locks; strict;
 comment	@c @;
 
 
+1.9
+date	2025.11.10.22.33.56;	author dean;	state Exp;
+branches;
+next	1.8;
+
 1.8
 date	2018.10.03.14.51.09;	author leith;	state Exp;
 branches;
@@ -66,9 +71,9 @@ desc
 @@
 
 
-1.8
+1.9
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C++*********************************************************************
@@ -81,7 +86,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -138,6 +143,17 @@ C       WRITE VOLUME CONTENTS
 @
 
 
+1.8
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.7
 log
 @comment
diff --git src/RCS/wtf.f,v src/RCS/wtf.f,v
index 70a9e11b..f53d7f4e 100644
--- src/RCS/wtf.f,v
+++ src/RCS/wtf.f,v
@@ -1,4 +1,4 @@
-head	1.22;
+head	1.23;
 access;
 symbols
 	pre_mrcs:1.22
@@ -24,6 +24,11 @@ locks; strict;
 comment	@c @;
 
 
+1.23
+date	2025.11.10.22.33.56;	author dean;	state Exp;
+branches;
+next	1.22;
+
 1.22
 date	2018.10.03.14.51.09;	author leith;	state Exp;
 branches;
@@ -140,9 +145,9 @@ desc
 @
 
 
-1.22
+1.23
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -156,7 +161,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -277,6 +282,17 @@ c$omp   parallel do private(i,j,kx,ww)
 @
 
 
+1.22
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.21
 log
 @GPL_2010
diff --git src/RCS/xmipp.f,v src/RCS/xmipp.f,v
index ad6ec068..b8368648 100644
--- src/RCS/xmipp.f,v
+++ src/RCS/xmipp.f,v
@@ -1,4 +1,4 @@
-head	1.4;
+head	1.5;
 access;
 symbols
 	pre_mrcs:1.4
@@ -8,6 +8,11 @@ locks; strict;
 comment	@c @;
 
 
+1.5
+date	2025.11.10.22.33.56;	author dean;	state Exp;
+branches;
+next	1.4;
+
 1.4
 date	2018.10.03.14.51.09;	author leith;	state Exp;
 branches;
@@ -33,9 +38,9 @@ desc
 @@
 
 
-1.4
+1.5
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @
@@ -49,7 +54,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -276,6 +281,17 @@ C      *********************** GETNEXT_XMSEL ********************************
 @
 
 
+1.4
+log
+@email_health_dept
+@
+text
+@d12 1
+a12 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.3
 log
 @IF (IC < 32 .OR. IC > 126) bug if not checked!!
diff --git src/RCS/xmselfile.f,v src/RCS/xmselfile.f,v
index 086abae3..62627015 100644
--- src/RCS/xmselfile.f,v
+++ src/RCS/xmselfile.f,v
@@ -1,4 +1,4 @@
-head	1.3;
+head	1.4;
 access;
 symbols
 	pre_mrcs:1.3
@@ -8,6 +8,11 @@ locks; strict;
 comment	@c @;
 
 
+1.4
+date	2025.11.10.22.33.56;	author dean;	state Exp;
+branches;
+next	1.3;
+
 1.3
 date	2018.10.03.14.51.09;	author leith;	state Exp;
 branches;
@@ -28,9 +33,9 @@ desc
 @@
 
 
-1.3
+1.4
 log
-@email_health_dept
+@*** empty log message ***
 @
 text
 @C ++********************************************************************
@@ -43,7 +48,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@@health.ny.gov                                        *
+C=* Email: spider@@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -147,6 +152,17 @@ C       DEALLOCATE DOC. FILE MEMORY
 @
 
 
+1.3
+log
+@email_health_dept
+@
+text
+@d11 1
+a11 1
+C=* Email: spider@@health.ny.gov                                        *
+@
+
+
 1.2
 log
 @NDOC --> LUNXM  bug
diff --git src/copy1.f src/copy1.f
index 20f0fafa..2335a3fa 100644
--- src/copy1.f
+++ src/copy1.f
@@ -18,20 +18,22 @@ C               'CP FROM NIK'                       JAN 05 ArDean Leith
 C               'CP TO PDS' GONE                    MAR 09 ArDean Leith
 C               'CP TO SGI' GONE                    MAY 09 ArDean Leith
 C               'CP TO VV'  GONE                    DEC 10 ArDean Leith
-C               'CCP4' NOW JUST MRC                 FEB 12 ArDean Leith
-C               'CP TO JPG'                         APR 13 ArDean Leith
-C               'CP TO VOL'                         MAY 13 ArDean Leith
-C               'CP FROM TIF'                       MAR 14 ArDean Leith
-C               'CP TO MRC' STACKS                  JUN 15 ArDean Leith
-C               REMOVED XPLO OPS                    JAN 18 ArDean Leith
-C               'CP TO STK' NOT FOR MRC             OCT 19 ArDean Leith
+C               'CCP4' NOW JUST MRC              FEB 2012 ArDean Leith
+C               'CP TO JPG'                      APR 2013 ArDean Leith
+C               'CP TO VOL'                      MAY 2013 ArDean Leith
+C               'CP FROM TIF'                    MAR 2014 ArDean Leith
+C               'CP TO MRC' STACKS               JUN 2015 ArDean Leith
+C               REMOVED XPLO OPS                 JAN 2018 ArDean Leith
+C               'CP TO STK' NOT FOR MRC          OCT 2019 ArDean Leith
+C               NO INITIAL PARAMETER SENT        OCT 2025 ArDean Leith
+C
 C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2019  Health Research Inc.,                         *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@health.ny.gov                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -47,25 +49,25 @@ C=* along with this program. If not, see <http://www.gnu.org/licenses> *
 C=*                                                                    *
 C **********************************************************************
 C
-C  COPY1(INT_UNUSED)
+C  COPY1  CALLED FROM UTIL2 FOR 'CP ****'
 C
-C  PARAMETERS:      INT_UNUSED         UNUSED
+C  PARAMETERS:      
 C
 C23456789012345678901234567890123456789012345678901234567890123456789012
 C--*********************************************************************
 
-        SUBROUTINE COPY1(INT_UNUSED)
+        SUBROUTINE COPY1
 
         IMPLICIT NONE
 
         INCLUDE 'CMBLOCK.INC'
         INCLUDE 'CMLIMIT.INC'
 
-        INTEGER               :: INT_UNUSED
         INTEGER               :: ICOMM,MYPID,MPIERR
         INTEGER               :: NILMAX,IRTFLG,NLET,ITYPE,NX,NY,NZ,NE
         INTEGER               :: MAXIM,NDUM,NIMG,IMGNUM,LOCAT,LOCAST
-        LOGICAL               :: VERBOSET       
+        LOGICAL               :: VERBOSET 
+        INTEGER               :: LNBLNKN,LENFCHAR     
 
         CHARACTER(LEN=MAXNAM) :: FILOLD,FILNEW
         INTEGER, ALLOCATABLE  :: ILIST(:)
@@ -75,7 +77,7 @@ C--*********************************************************************
         LOGICAL               :: IS_STACK
         LOGICAL               :: IS_MRC
 
-
+        
         INTEGER,PARAMETER     :: IDELAY  = 3
 
         INTEGER, PARAMETER    :: LUN1    = 14 
@@ -89,9 +91,23 @@ C--*********************************************************************
 C       FROM/'AS','MR','PD','RA','NI','TE','VA','EM','NT','XP'
 C       TO  /'AS','BR','MR','PO','RA','TI','XP','OP','JPG'  
 
+
         CALL SET_MPI(ICOMM,MYPID,MPIERR) ! SETS ICOMM AND MYPID
 
-        IF (FCHAR(4:7) == 'TO O') THEN !----------------- 'CP TO OPEND'
+        LENFCHAR = LNBLNKN(FCHAR)
+
+        !write(6,*)'  In copy1, lenfchar: ',LENFCHAR
+
+ 
+        IF (LENFCHAR .LE. 2) THEN      !----------------- 'CP'
+C          STANDARD COPY (CAN HANDLE MRC INPUT/OUTPUT)
+           INDXD   = .FALSE.
+           FLIPOUT = .FALSE.
+
+           CALL COPYD(LUN1,LUN2,LUNDOC,LUNXM1,LUNXM2,INDXD,FLIPOUT)
+           GOTO 9000
+
+        ELSEIF (FCHAR(4:7) == 'TO O') THEN !------------- 'CP TO OPEND'
 C          STANDARD COPY WITH FLIPPED ENDEDNESS
            INDXD   = .FALSE.
            FLIPOUT = .TRUE.
@@ -104,8 +120,11 @@ C          SPIDER IMAGE(S) FILE INTO VOLUME FILES
            GOTO 9000
 
         ELSEIF (FCHAR(4:8) == 'TO ST') THEN !-------------- 'CP TO STK'
-C          SPIDER STACK(S) INTO A SINGLE STACK  
+C          SPIDER STACK(S) INTO A SINGLE STACK 
+
+           !write(3,*)'  Calling copytostk  ' 
            CALL COPYTOSTK()
+           !write(3,*)'  After   copytostk  ' 
            GOTO 9000
 
         ELSEIF (FCHAR(4:9) == 'TO MRC') THEN !------------- 'CP TO MRC'
@@ -114,36 +133,26 @@ C          COPY SPIDER FILE TO MRC IMAGE/VOLUME
            GOTO 9000
 
         ELSEIF (FCHAR(4:9) == 'FROM M' .OR.
-     &          FCHAR(4:9) == 'FROM C' ) THEN !----------- 'CP FROM MRC'
+     &          FCHAR(4:9) == 'FROM C' ) THEN  !--------- 'CP FROM MRC'
 C          FROM MRC FORMAT TO SPIDER 
            CALL COPYFROMMRC(LUN1,LUN2,LUNDOC,LUNXM1,LUNXM2)
            GOTO 9000
 
-        ENDIF
-
-
-C                                    12345678     1234567890
-        SELECT CASE(FCHAR(4:5))   ! 'CP TO XX' , 'CP FROM XX'
-
-#if defined(SP_IFC) || defined(__INTEL_COMPILER) 
-        CASE ('I')      ! --------------------------------------- 'CP I'
-#else
-#if defined(__GFORTRAN__) 
-        CASE ('I')      ! --------------------------------------- 'CP I'
-#else
-        CASE ('I','I ') ! --------------------------------------- 'CP I'
-#endif
-#endif
+        ELSEIF (FCHAR(4:4) == 'I') THEN        !----------- 'CP I'
 C          STANDARD COPY TO INDEXED STACK
            INDXD   = .TRUE.
            FLIPOUT = .FALSE.
-           CALL COPYD(LUN1,LUN2,LUNDOC,LUNXM1,LUNXM2,INDXD,FLIPOUT)
+           !write(6,*) '  In copy1, calling copyd:',lun1,lun2,flipout
 
-        CASE ('')    ! ------------------------------------------ 'CP'
-C          STANDARD COPY (CAN HANDLE MRC INPUT/OUTPUT)
-           INDXD   = .FALSE.
-           FLIPOUT = .FALSE.
            CALL COPYD(LUN1,LUN2,LUNDOC,LUNXM1,LUNXM2,INDXD,FLIPOUT)
+           GOTO 9000
+
+        ENDIF
+
+
+C                                    12345678     1234567890
+        SELECT CASE(FCHAR(4:5))   ! 'CP TO **' , 'CP FROM **'
+
 
         CASE ('TO')  ! ------------------------------------- 'CP TO **'
 
@@ -154,9 +163,10 @@ C          OPEN INPUT IMAGE(S), (NOT FOURIER)
               CALL ERRT(46,'COPY1; ILIST',NILMAX)
               RETURN
            ENDIF
-
+ 
            ASKNAM = .TRUE.
            FOUROK = .FALSE.
+           IMGNUM = 0         ! needed, sept 2025 
            CALL OPFILES(0,LUN1,LUNDOC,LUNXM1, 
      &                  ASKNAM,FILOLD,NLET, 'O',
      &                  ITYPE,NX,NY,NZ,MAXIM,
@@ -170,6 +180,19 @@ C          OPEN INPUT IMAGE(S), (NOT FOURIER)
            IS_STACK = (MAXIM > 0)                     ! USING A STACK
            BARE     = (LOCAT > 0 .AND. LOCAT == NLET) ! BARESTACK
 
+#if defined (SP_DBUGIO)
+        write(3,*) ' In: copy1 ------------- xxxxxxxxxxxxxxxxxxxxxx'
+        write(3,*) '  filold:   ',filold(1:nlet)
+        write(3,*) '  filold:   ',filold(1:nlet)
+        write(3,*) '  locat :   ',locat
+        write(3,*) '  locast:   ',locast
+        write(3,*) '  nlet:     ',nlet
+        write(3,*) '  is_stack: ',is_stack
+        write(3,*) '  maxim:    ',maxim
+        write(3,*) '  nimg:     ',nimg
+        write(3,*) '  bare:     ',bare
+#endif
+
 
            IF (BARE) THEN
               CALL ERRT(101,
@@ -209,7 +232,8 @@ C             SPIDER IMAGE FILE INTO XPLOR FILES --------- 'CP TO XPLOR'
            CASE ('JP')
 C             SPIDER IMAGE FILE INTO JPG FILES ------------- 'CP TO JPG'
               VERBOSET = VERBOSE  ! FROM CMBLOCK
-              FILNEW   = NULL
+ 
+             FILNEW   = NULL
               CALL COPYTOJPG(LUN1,LUNT,FILNEW,NX,NY,NZ,
      &                       VERBOSET,IDELAY)
 
@@ -235,6 +259,7 @@ C             FROM PDB FILE TO SPIDER VOLUME FILE -------- 'CP FROM PDB'
 
            CASE ('RA')
 C             COPY RAW IMAGE FILE INTO SPIDER IMAGE FILE - 'CP FROM RAW'
+              !write(6,*) '  In copy1, calling rawtospider:',lun1,lun2
               CALL RAWTOSPIDER(LUN1,LUN2,IRTFLG)
 
            CASE ('NI')
@@ -282,21 +307,10 @@ C             NO SUCH COPY FUNCTION
            CALL ERRT(101,'NO SUCH CP OPERATION, CHECK MENU',NE)
 
         END SELECT
+        !write(3,*) '  filold:',filold(1:nlet)
 
 9000    CLOSE(LUN1)
         CLOSE(LUN2)
         IF (ALLOCATED(ILIST)) DEALLOCATE(ILIST)
 
         END
-
-#ifdef NEVER
-        write(6,*) '  filold:',filold(1:nlet)
-        write(6,*) '  locat:',locat
-        write(6,*) '  locast:',locast
-        write(6,*) '  nlet:',nlet
-        write(6,*) '  is_stack:',is_stack
-        write(6,*) '  maxim:',maxim
-        write(6,*) '  nimg: ',nimg
-        write(6,*) '  bare: ',bare
-        stop
-#endif
diff --git src/copyd.f src/copyd.f
index 60dfd247..dee54068 100644
--- src/copyd.f
+++ src/copyd.f
@@ -10,14 +10,15 @@ C              OPFILES                        DEC 10    ARDEAN LEITH
 C              INDEXED STACK BUG              JAN 11    ARDEAN LEITH
 C              INDEXED STACK BUG              FEB 11    ARDEAN LEITH
 C              NON SPIDER IMAGE COPY          MAY 14    ARDEAN LEITH
+C              DEBUG OUTPUT ADDED             SEP 20    ArDean Leith
 C
 C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2014  Health Research Inc.,                         *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@health.ny.gov                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -54,6 +55,7 @@ C--*********************************************************************
         COMMON /IOERR/  IERR
         COMMON /IOBUF/  BUF(NBUFSIZ)
 
+        common /lunara/ lunara(100),lunstk(100),lunarb(100),lunflip(100)
         INTEGER                  :: LUN1,LUN2,LUNDOC,LUNXM1,LUNXM2
         LOGICAL                  :: INDXD,FLIPOUT
 
@@ -79,9 +81,12 @@ C--*********************************************************************
            RETURN
         ENDIF
 
+        !write(3,*)' In copyd 0: lun1,iflipin: ',lun1,iflipin 
+        !write(3,*)' In copyd 0 calling opfiles: lun1: ',lun1 
+
 C       OPEN FIRST INPUT FILE, DISP = 'E' DOES NOT STOP ON ERROR
         MAXIM1 = 0
-        PROMPT = 'INPUT FILE NAME OR TEMPLATE (E.G. STK@****)~~9'
+        PROMPT = 'INPUT FILE NAME OR TEMPLATE (E.G. STK@*)~~9'
         CALL OPFILES(0,LUN1,LUNDOC,LUNXM1,  
      &               .TRUE.,FILNAM1,NLET1, 'E',
      &               IFORM1,NX1,NY1,NZ1,NSTACK1,
@@ -89,19 +94,27 @@ C       OPEN FIRST INPUT FILE, DISP = 'E' DOES NOT STOP ON ERROR
      &              .TRUE., ILIST1,NILMAX, 
      &               NDUM,NGOT1,IMG1, IRTFLG) 
 
+	
+        !write(3,*)' Back in copyd   ------------ 1 ----------' 
+        !write(3,*)' In copyd 1: lun1,iflipin:  ', lun1,iflipin 
+        !write(3,*)' In copyd 1: lunflip(lun1): ', lunflip(lun1) 
+        !write(3,*)' In copyd 1, lun1,flipout:',   lun1,flipout
+        !write(3,*)' In copyd 1: irtflg,filnam1: ',irtflg,filnam1 
+
+
         IF (IRTFLG == 5) THEN
 C          NOT A VALID SPIDER OR MRC INPUT DATA FILE
 
            CALL FILERD(FILNAM2,NLET2,NULL,'OUTPUT FILE NAME',IRTFLG)
            IF (IRTFLG .NE. 0) RETURN 
 
-           !write(6,*) ' Non spider input: ', filnam1(1:nlet1)
-           !write(6,*) ' Non spider output: ',filnam2(1:nlet2)
+           !write(3,*) ' In copyd: Non spider input: ', filnam1(1:nlet1)
+           !write(3,*) ' In copyd: Non spider output: ',filnam2(1:nlet2)
 
            LOCDOT1 = ( INDEX(FILNAM1(1:NLET1),'.',BACK=.TRUE.) )
            LOCDOT2 = ( INDEX(FILNAM2(1:NLET2),'.',BACK=.TRUE.) )
 
-           IF ( LOCDOT2 <= 0 ) THEN
+           IF ( LOCDOT2 <= 0 ) THEN 
 C             APPEND EXTENSION TO FILNAM2
               FILNAM2 = FILNAM2(1:NLET2) // '.' // FILNAM1(LOCDOT1+1:)
               NLET2   = lnblnkn(FILNAM2)
@@ -110,15 +123,20 @@ C             APPEND EXTENSION TO FILNAM2
 C          USE SYSTEM COPY
            COMMAN = 'cp ' // FILNAM1(1:NLET1) //' '// FILNAM2(1:NLET2)
 
-           WRITE(NOUT,'(2X,2A,2X,A)'),
+           WRITE(NOUT,'(2X,2A,2X,A)')
      &           'cp ',FILNAM1(:NLET1),FILNAM2(:NLET2)
            IRET = system(COMMAN)
            GOTO 999
-        ENDIF
+	   
+	ENDIF
+	
+        IF (IRTFLG .NE. 0) GOTO 999
 
-        IF (IRTFLG .NE. 0) RETURN
+        !write(3,'(a,8i5)')' In copyd; nstack1,ngot1,img1:', 
+        !&                             nstack1,ngot1,img1
 
-        !write(6,'(a,8i5)')' In  nstack1,ngot1,img1:',nstack1,ngot1,img1
+C       FIND NATIVE-ENDDEDNESS OF SPIDER INPUT     
+        CALL LUNGETFLIP(LUN1,IFLIPIN,IRTFLG)
 
         NSTACK2 =  1 ! UNUSED
         DISP    = 'U'          
@@ -127,14 +145,38 @@ C          INPUT IS A WHOLE STACK AND WANT INDEXED OUTPUT STACK
            DISP    = 'I'
            NSTACK2 = NSTACK1  ! MAX SIZE
         ENDIF
-
-        IF (FLIPOUT) THEN
-C          STANDARD COPY WITH FLIPPED ENDEDNESS
-           CALL LUNGETFLIP(LUN1,IFLIPIN,IRTFLG)
-           IF (IFLIPIN .NE. 1) IFLIPOUT = 1
-        ENDIF
-        IF (IFLIPOUT == 1) CALL LUNSETFLIP(LUN2,IFLIPOUT,IRTFLG)
-
+	
+        !write(3,*)' In copyd --------------- 0 --------'
+        !write(3,'(A,L5)') ' In copyd 0, flipout:',   flipout
+        !write(3,'(A,4i6)')' In copyd 0: iflipin,: ', iflipin 
+        !write(3,'(A,4i6)')' In copyd 0: lunflip(lun1): ',lunflip(lun1) 
+        !write(3,*)' --------------- END OF 0 --------' 
+
+C       FIND NATIVE-ENDDEDNESS OF INPUT     
+        CALL LUNGETFLIP(LUN1,IFLIPIN,IRTFLG)
+
+C       FIND NATIVE-ENDDEDNESS OF INPUT     
+        IFLIPOUT = 0    ; 
+        IF     (IFLIPIN .EQ. 0 .AND.       FLIPOUT) THEN
+	   IFILPOUT = 1
+        ELSEIF (IFLIPIN .EQ. 0 .AND. .NOT. FLIPOUT) THEN
+           IFLIPOUT = 0
+        ELSEIF (IFLIPIN .EQ. 1 .AND.       FLIPOUT) THEN
+           IFLIPOUT = 0
+        ELSEIF (IFLIPIN .EQ. 1 .AND. .NOT. FLIPOUT) THEN
+           IFLIPOUT = 1
+	ENDIF
+	
+        CALL LUNSETFLIP(LUN2,IFLIPOUT,IRTFLG)
+		
+        !write(3,*)'  '
+        !write(3,*)' In copyd --------------- 0 --------'
+        !write(3,'(A,4i6)')'  In copyd: iflipin,iflipout: ',
+        !&                              iflipin,iflipout 
+        !write(3,'(A,4i6)')'  In copyd: lunflip(lun1),lunflip(lun2): ',
+        !&                              lunflip(lun1),lunflip(lun2) 
+        !write(3,*)' -------------- END OF 0 CALLING OPFILES -------' 
+      	    	
 C	OPEN FIRST OUTPUT FILE
         IMG2 = IMG1
         CALL OPFILES(LUN1,LUN2,LUNDOC,LUNXM2, 
@@ -144,28 +186,36 @@ C	OPEN FIRST OUTPUT FILE
      &             .TRUE., ILIST2,NILMAX, 
      &             NDUM,NGOT2,IMG2, IRTFLG) 
 
-        !write(6,'(A,4i6)')' Out nstack2,ngot2,img2:',nstack2,ngot2,img2
-
-        IFLIPOUT = 0
-        IF (FLIPOUT) THEN
-C          STANDARD COPY WITH FLIPPED ENDEDNESS
-           CALL LUNGETFLIP(LUN1,IFLIPIN,IRTFLG)
-           IF (IFLIPIN .NE. 1) IFLIPOUT = 1
-        ENDIF
-        !write(6,'(A,4i6)')' IFLIPIN, IFLIPOUT:',IFLIPIN, IFLIPOUT 
-
+        !write(3,*)'  '
+        !write(3,*)' In copyd --------------- 1 --------'
+        !write(3,'(A,4i6)')'  In copyd: nstack2,ngot2,img2:',
+        !&                              nstack2,ngot2,img2
+        !write(3,'(A,4i6)')'  In copyd: iflipin,iflipout: ',
+        !&                              iflipin,iflipout 
+        !write(3,'(A,4i6)')'  In copyd: lun1,lun2: ',
+        !&                              lun1,lun2 
+        !write(3,'(A,4i6)')'  In copyd: lunflip(lun1),lunflip(lun2): ',
+        !&                              lunflip(lun1),lunflip(lun2) 
+        !write(3,*)' --------------- END OF 1 --------' 
+    
        IF (IFLIPOUT == 1) THEN
-C          TELL WRITLIN TO FLIP CONTENTS DURING I/O
+C          TELL WRTLIN TO FLIP CONTENTS DURING I/O
            CALL LUNSETFLIP(LUN2,IFLIPOUT,IRTFLG)
+
 C          REPLACE HEADER WITH BYTE-FLIPPED HEADER
-           CALL LUNWRTHED (LUN2,NX1,0,IRTFLG)
+           CALL LUNWRTHED(LUN2,NX1,0,IRTFLG)
         ENDIF
-       !call lungetstat(lun2,imamit,fmint,fmaxt,avt,sigt,irtflg)
-       !write(3,*)' In copyd, stats3:',imamit,fmint,fmaxt,avt,sigt 
+	
+        !write(3,*)'  '
+        !write(3,*)' In copyd --------------- 2 --------'
+        !call lungetstat(lun2,imamit,fmint,fmaxt,avt,sigt,irtflg)
+        !write(3,*)' In copyd, stats3:',imamit,fmint,fmaxt,avt,sigt 
+        !write(3,*)' --------------- END OF 2 --------' 
 
         NINDX1 = 1
         NINDX2 = 1
-        DO                ! LOOP OVER ALL IMAGES/STACKS
+
+        DO       ! LOOP OVER ALL IMAGES/STACKS
 
 C          DO NOT REPORT FILE INFO IF WHOLE STACK (VERBOSE IN COMMON)
 	   IF (NSTACK1 > 0 .AND. NSTACK2 >= 0) VERBOSE = .FALSE. 
@@ -177,19 +227,20 @@ C          COPY THE DESIRED NUMBER OF DATA RECORDS
            ENDDO
 
 C          OPEN NEXT SET OF I/O FILES, UPDATES NINDX1 & NINDX2 
-           !write(3,*)' In copyd, calling nextfiles:',nindx1,nindx2 
+           !write(3,*)' In copyd, Calling nextfiles:',nindx1,nindx2 
+
            CALL NEXTFILES(NINDX1,NINDX2,  ILIST1,ILIST2, 
      &                    .FALSE., LUNXM1,LUNXM2,
      &                    NGOT1,NGOT2,    NSTACK1,NSTACK2,  
      &                    LUN1,LUN1,LUN2, FILNAM1,FILNAM2,
      &                    IMG1,IMG2, IRTFLG)
 
-           !write(3,*) ' In copyd, after nextfiles, irtflg',irtflg
+           !write(3,*) ' In copyd, After nextfiles, irtflg',irtflg
            !if (irtflg .ne. 0) then
-           !write(6,'(A,4i6)') 
-!     &        ' Nextfiles img1,img2,irtflg:',img1,img2,irtflg
-           !write(6,'(A,4i6)') 
-!     &        ' Nextfiles nindx1,nindx2:',nindx1,nindx2
+           !write(3,'(A,4i6)') 
+           !&        ' Nextfiles img1,img2,irtflg:',img1,img2,irtflg
+           !write(3,'(A,4i6)') 
+           !&        ' Nextfiles nindx1,nindx2:',nindx1,nindx2
            !endif
 
            IF (IRTFLG .NE. 0) EXIT      ! ERROR / END OF INPUT STACK
diff --git src/copyfrommrc.f src/copyfrommrc.f
index 2ff80532..13a27ccd 100644
--- src/copyfrommrc.f
+++ src/copyfrommrc.f
@@ -1,31 +1,34 @@
 
 C **********************************************************************
 C
-C COPYFROMMRC   MODIFIED FROM COPYMRC             FEB 02 ArDean Leith         
-C               ISSWAB ADDED                      JUL 02 ArDean Leith
-C               FLIP QUESTION                     MAR 03 ArDean Leith
-C               BAD IRECMRC4 & FLIP               SEP 03 ArDean Leith
-C               SCALING                           JAN 05 ArDean Leith
-C               I*8                               SEP 08 ArDean Leith
-C               NPIX8                             DEC 08 ArDean Leith
-C               BOTLEFT OPTION                    MAY 12 ArDean Leith
-C               STREAM IO                         FEB 13 ArDean Leith
-C               VOL BUG                           JUN 13 ArDean Leith
-C               VOL BUG FIXED                     JUL 13 ArDean Leith
-C               MODE 6 STACK SUPPORT              SEP 14 ArDean Leith
-C               IPOSMRC INTEGER *8                JAN 15 ArDean Leith
-C               BOTLEFT DEFAULT                   JUL 15 ArDean Leith
-C               2015 STACK SUPPORT                JUL 15 ArDean Leith
-C               STACK END BUG                     OCT 15 ArDean Leith
-C               'MRCV'                            DEC 15 ArDean Leith
-C               REWRITE FOR NATIVE MRC SUPPORT    JAN 20 ArDean Leith
+C COPYFROMMRC  MODIFIED FROM COPYMRC             FEB 2002 ArDean Leith
+C              ISSWAB ADDED                      JUL 2002 ArDean Leith
+C              FLIP QUESTION                     MAR 2003 ArDean Leith
+C              BAD IRECMRC4 & FLIP               SEP 2003 ArDean Leith
+C              SCALING                           JAN 2005 ArDean Leith
+C              I*8                               SEP 2008 ArDean Leith
+C              NPIX8                             DEC 2008 ArDean Leith
+C              BOTLEFT OPTION                    MAY 2012 ArDean Leith
+C              STREAM IO                         FEB 2013 ArDean Leith
+C              VOL BUG                           JUN 2013 ArDean Leith
+C              VOL BUG FIXED                     JUL 2013 ArDean Leith
+C              MODE 6 STACK SUPPORT              SEP 2014 ArDean Leith
+C              IPOSMRC INTEGER *8                JAN 2015 ArDean Leith
+C              BOTLEFT DEFAULT                   JUL 2015 ArDean Leith
+C              2015 STACK SUPPORT                JUL 2015 ArDean Leith
+C              STACK END BUG                     OCT 2015 ArDean Leith
+C              'MRCV'                            DEC 2015 ArDean Leith
+C              REWRITE FOR NATIVE MRC SUPPORT    JAN 2020 ArDean Leith
+C              DEBUG OUTPUT ADDED                SEP 2025 ArDean Leith
+C              LUNCP=0, NO COPY FROM MRC HEADER  SEP 2025 ArDean Leith
+c
 C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2020 Health Research Inc.,                          *
+C=* Copyright 1985-2025 Health Research Inc.,                          *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@health.ny.gov                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -66,6 +69,7 @@ C***********************************************************************
         COMMON /IOBUF/ BUF(NBUFSIZ)
 
         INTEGER                  :: LUN1,LUN2,LUNDOC,LUNXM1,LUNXM2
+        INTEGER                  :: LUNCP  ! sept 2025
 
         LOGICAL                  :: VERBOSE_SAVE,ASKNAM
         LOGICAL                  :: IS_MRC,IS_ACTUALLY_A_VOL,IS_BARE
@@ -96,7 +100,7 @@ C***********************************************************************
 
 C       OPEN FIRST INPUT MRC FILE 
 
-        PROMPT  = 'MRC INPUT FILE OR TEMPLATE (E.G. STK@****)~~9'
+        PROMPT  = 'MRC INPUT FILE OR TEMPLATE (E.G. *@STK)~~9'
         CALL FILERD(FILNAM1,NLET1,NULL, PROMPT,IRTFLG)
         IF (IRTFLG .NE. 0) GOTO 999
 
@@ -123,8 +127,8 @@ C       APPEND .mrc IF NEEDED
 C       NSTACK1 RET:  -2   IS NON-STACK IMAGE,  -1 IS STACKED IMG,                  
 C                    >= 0 IS CURRENT MAX. IMG # FOR STACK             
 
-        !write(3,'(a,5i5)')' In copyfrommrc, nstack1,ngot1,img1:',
-        !&                                      nstack1,ngot1,img1
+       !write(6,*)' In copyfrommrc; nstack1,ngot1,img1: ',
+       !&                           nstack1,ngot1,img1
  
 C       BE SURE INPUT IS MRC
         CALL LUNGETIS_MRC(LUN1,IS_MRC,IRTFLG)
@@ -133,13 +137,17 @@ C       BE SURE INPUT IS MRC
            GOTO 999
         ENDIF
 
+        !write(6,*)' In copyfrommrc, is_mrc:',is_mrc
+
+
 C	OPEN FIRST SPIDER OUTPUT FILE
         NSTACK2 =  1   ! PARAMETER NOT USED ON INPUT
         DISP    = 'U'          
         IMG2    = IMG1
+        LUNCP   = 0    ! CAN NOT COPY FROM MRC HEADER
 
         IF (NSTACK1 >= 0) THEN
-           PROMPT = 'SPIDER OUTPUT FILE OR TEMPLATE (E.G. STK@****)~~9'
+           PROMPT = 'SPIDER OUTPUT FILE OR TEMPLATE (E.G. STK@*)~~9'
         ELSE
            PROMPT = 'SPIDER OUTPUT FILE~'
         ENDIF
@@ -176,22 +184,23 @@ C           TREAT THIS IMAGE AS A VOLUME NOT A STACK
         ENDIF
 
         ASKNAM = .FALSE.
-        CALL OPFILES(LUN1,LUN2,LUNDOC,LUNXM2, 
+        CALL OPFILES(LUNCP,LUN2,LUNDOC,LUNXM2, 
      &             ASKNAM,FILNAM2,NLET2,DISP,
      &             IFORM1,NX1,NY1,NZ1,NSTACK2,
      &             FILNAM2,
      &             FOUROK, ILIST2,NILMAX, 
      &             NDUM,NGOT2,IMG2, IRTFLG)
  
-C       NSTACK2 RET:  -2   IS NON-STACK IMAGE,  -1 IS STACKED IMG,                  
+C       NSTACK2 RET: -2   IS NON-STACK IMAGE,  
+C                    -1   IS STACKED IMG              
 C                    >= 0 IS CURRENT MAX. IMG # FOR STACK             
 
-        !write(6,'(A,4i6)')' Out nstack2,ngot2,img2:',nstack2,ngot2,img2
+        !write(6,*)'In opfiles; nstack2,ngot2,img2: ',nstack2,ngot2,img2
 
         CALL WHICH_HAND_MRC(LUN1,FILNAM1,CAXIS,IRTFLG)
         IF (IRTFLG .NE. 0) GOTO 999
 
-        !write(3,*) ' Mrc data axis: ',caxis
+        !write(6,*) ' Mrc data axis: ',caxis
 
         IF (NZ1 <= 1) THEN       ! IMAGE(S) INPUT
            CALL RDPRMC(CSTR,NC,.TRUE.,'DATA ORIGIN CORNER (UL/LL)', 
@@ -232,19 +241,20 @@ C          VOLUME OUTPUT
         DO                ! LOOP OVER ALL IMAGES/STACKS
 
 C          DO NOT REPORT FILE INFO IF WHOLE STACK (VERBOSE IN COMMON)
-	   !!!IF (NSTACK1 > 0 .AND. NSTACK2 >= 0) VERBOSE = .FALSE. 
+           !!!IF (NSTACK1 > 0 .AND. NSTACK2 >= 0) VERBOSE = .FALSE. 
 
 C          COPY THE DESIRED NUMBER OF DATA RECORDS (MRC OK)
            DO IREC = 1,NY1 * NZ1
               CALL REDLIN(LUN1,BUF,NX1,IREC)
               CALL WRTLIN(LUN2,BUF,NX1,IREC)
            ENDDO
-           !write(3,*)' in copyfrommrc,ilist.:   ',ilist1(:3),ilist2(:3) 
-           !write(3,*)' in copyfrommrc,filnam1:  ',filnam1(1:20)
-           !write(3,*)' in copyfrommrc,filnam2:  ',filnam2(1:20)
-           !write(3,*)' in copyfrommrc,ngot1..2: ',ngot1,ngot2 
-           !write(3,*)' In copyfrommrc,nindx1..2:',nindx1,nindx2 
-           !write(3,*)' in copyfrommrc,img1..2:  ',img1,img2 
+
+           !write(6,*)' In copyfrommrc; ilist: ',ilist1(:3),ilist2(:3)
+           !write(6,*)' In copyfrommrc; filnam1:  ',filnam1(:20)
+           !write(6,*)' In copyfrommrc; filnam2:  ',filnam2(:20)
+           !write(6,*)' In copyfrommrc; ngot1..2: ',ngot1,ngot2 
+           !write(6,*)' In copyfrommrc; nindx1..2:',nindx1,nindx2 
+           !write(6,*)' in copyfrommrc; img1..2:  ',img1,img2 
 
 C          OPEN NEXT SET OF I/O FILES, UPDATES NINDX1 & NINDX2 
            CALL NEXTFILES(NINDX1,NINDX2,  ILIST1,ILIST2, 
@@ -255,9 +265,9 @@ C          OPEN NEXT SET OF I/O FILES, UPDATES NINDX1 & NINDX2
 
            !if (irtflg .ne. 0) then
            !write(6,'(A,4i6)') 
-!     &        ' Nextfiles img1,img2,irtflg:',img1,img2,irtflg
+           !&        ' Nextfiles; img1,img2,irtflg: ',img1,img2,irtflg
            !write(6,'(A,4i6)') 
-!     &        ' Nextfiles nindx1,nindx2:',nindx1,nindx2
+           !&        ' Nextfiles; nindx1,nindx2: ',nindx1,nindx2
            !endif
 
            IF (IRTFLG .NE. 0) EXIT      ! ERROR / END OF INPUT STACK
diff --git src/copytojpg.f src/copytojpg.f
index 66a31b01..dd36fc85 100644
--- src/copytojpg.f
+++ src/copytojpg.f
@@ -6,13 +6,15 @@ C                  ECHO                            APR 16 ArDean Leith
 C                  WORKS ON VOLUME SLICES NOW      JAN 18 ArDean Leith
 C                  WORKS ON MRC IMAGES NOW         DEC 19 ArDean Leith
 C                  EXTRACTED DISP()                JAN 20 ArDean Leith
+C                  RENAMED GRAY                    OCT 25 ArDean Leith
+C
 C **********************************************************************
 C=* AUTHOR: A. LEITH                                                   *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2020  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@health.ny.gov                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -63,10 +65,13 @@ C--*********************************************************************
         LOGICAL               :: CALLERRT = .TRUE.
         LOGICAL               :: erri2
 
-        CHARACTER(LEN=17)     :: FILTMP = 'JUNK_FOR_JPG.gray' 
+        CHARACTER(LEN=17)     :: FILTMP    = 'jnk_temp_jpg.gray' 
+        CHARACTER(LEN=5)      :: ENDIANMSB = ' msb ' 
+        CHARACTER(LEN=5)      :: ENDIANLSB = ' lsb ' 
+        CHARACTER *5          :: ENDIAN
  
         INTEGER               :: lnblnkn
-
+ 
         ISLICE = 1
         IF (NZ > 1) THEN
 C          THIS IS A VOLUME
@@ -126,22 +131,33 @@ C          GET NAME FOR JPEG FILE
         CALL INTTOCHAR(NX, STRNX, NC2,1)
         CALL INTTOCHAR(NY, STRNY, NC3,1)
 
+        ENDIAN = ENDIANMSB
+        !!!IF (
+        ENDIAN = ENDIANLSB
+
         IF (VERBOSET) THEN
-           WRITE(COMLIN,8005) STRNX(:NC2),STRNY(:NC3),
+           WRITE(COMLIN,8005) STRNX(:NC2),STRNY(:NC3),ENDIAN,
      &                        FILTMP,FILNEW(1:NLETN)
+     
 8005       FORMAT( 
      &     ' convert -verbose -depth 32 -size ',A,'x',A, 
      &     ' -define quantum:format=floating-point ',
-     &     '-define quantum:scale=65536.0 -endian msb ',
-     &     A,' ',A )
+     &     '-define quantum:scale=65536.0 -endian ',A,
+     &     ' ',A,' ',A )
+
+cc 2025   &     '-define quantum:scale=65536.0 -endian msb ',
+
         ELSE
-           WRITE(COMLIN,8006) STRNX(:NC2),STRNY(:NC3),
+           WRITE(COMLIN,8006) STRNX(:NC2),STRNY(:NC3),ENDIAN,
      &                        FILTMP,FILNEW(1:NLETN)
+     
 8006       FORMAT( 
      &     ' convert -depth 32 -size ',A,'x',A, 
      &     ' -define quantum:format=floating-point ',
-     &     '-define quantum:scale=65536.0 -endian msb ',
-     &     A,' ',A, ' >& /dev/null' )
+     &     '-define quantum:scale=65536.0 -endian',A,' ',
+     &     A,' ',A, '  >& /dev/null' )
+
+cc 2025   &     '-define quantum:scale=65536.0 -endian msb ',
 
         ENDIF
 
diff --git src/copytomrc.f src/copytomrc.f
index cb4568b8..a31cb159 100644
--- src/copytomrc.f
+++ src/copytomrc.f
@@ -1,7 +1,7 @@
 
 C ++********************************************************************
 C
-C COPYTOMRC    MODIFIED FROM COPYMRC               FEB 02 ArDean Leith         
+C COPYTOMRC    MODIFIED FROM COPYMRC               FEB 02 ArDean Leith  
 C              ISSWAB ADDED                        JUL 02 ArDean Leith
 C              FLIP QUESTION                       MAR 03 ArDean Leith
 C              BAD IRECMRC4 & FLIP                 SEP 03 ArDean Leith
@@ -21,14 +21,15 @@ C              BOTLEFT OPTION REINTRODUCED         SEP 16 ArDean Leith
 C              CREATES LITTLE ENDED FILES ONLY     JAN 18 ArDean Leith
 C              GETLAB PARAMETERS                   NOV 19 ArDean Leith
 C              REWRITE                             DEC 19 ArDean Leith
+C              FIXED STACKS                        OCT 25 ArDean Leith
 C
 C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2019  Health Research Inc.,                         *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@health.ny.gov                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -45,7 +46,7 @@ C=*                                                                    *
 C **********************************************************************
 C 
 C COPYTOMRC    (LUNSPI,LUNMRC,NX,NY,NZ)
-C COPYTOMRC_STK(LUNSPI,LUNMRC,NX,NY,NZ) 
+C COPYTOMRC_STK(LUNSPI,LUNMRC,NX,NY,NZ)    !!! NEVER USED
 C                                                                    
 C PURPOSE: COPY FROM SPIDER TO MRC FILE FORMAT
 C
@@ -56,6 +57,48 @@ C               1 : INTEGER*2 (SIGNED)
 C               2 : REALS
 C               6 : INTEGER*2 (UNSIGNED)
 C
+C  CALL TREE:
+C  IF ('CP....')   
+C     |
+C  COPY1
+C     |
+C  IF ('CP TO MRC')    SPIDER FILE(S) TO MRC IMAGE(S) OR VOLUME(S)
+C     |
+C  COPYTOMRC
+C     |
+C     OPEN FIRST SPIDER INPUT FILE
+C     OPFILES(0,LUNSPI,LUNDOC,LUNXM1,  
+C     &       .TRUE.,FILNAM1,NLET1, 'E',
+C     &       IFORM1,NX1,NY1,NZ1,NSTACK1,
+C     &       'SPIDER INPUT FILE NAME OR TEMPLATE (e.g. SPI_STK@*)~~9'
+C     &       TRUE., ILIST1,NILMAX, 
+C     &       NOT_USED,NGOT1,IMG1, IRTFLG) 
+C     |
+C     FILERD (FILNAM2,NLET2,NULL,  
+C     &       'MRC OUTPUT FILE NAME OR TEMPLATE (e.g. MRC_STK@*.mrc)~'
+C     &       IRTFLG)
+C     OPEN FIRST MRC OUTPUT FILE 
+C     OPFILES(LUNSPI,LUNMRC,LUNDOC,LUNXM2, 
+C     &       .FALSE.,FILNAM2,NLET2,DISP,
+C     &       IFORM1,NX1,NY1,NZ1,NSTACK2,
+C     &       FILNAM2,
+C     &       .TRUE., ILIST2,NILMAX, 
+C     &       NOT_USED,NGOT2,IMG2, IRTFLG) 
+C       |
+C     LOOP
+C       REDLIN
+C        |
+C       WRTLIN
+C        |
+C       OPEN NEXT SPIDER INPUT & MRC OUTPUT FILES
+C        |
+C       NEXTFILES(NINDX1,NINDX2,  ILIST1,ILIST2,   
+C               .FALSE., LUNXM1,LUNXM2,
+C               NGOT1,NGOT2,    NSTACK1,NSTACK2,  
+C               LUNSPI,LUNSPI,LUNMRC, FILNAM1,FILNAM2,
+C               IMG1,IMG2, IRTFLG)
+C        |
+C     END LOOP
 C23456789012345678901234567890123456789012345678901234567890123456789012
 C***********************************************************************
 
@@ -94,7 +137,7 @@ C***********************************************************************
       CHARACTER (LEN=4)        :: CAXIS,CSTR
       INTEGER                  :: ICOMM,MYPID,MPIERR
       INTEGER                  :: IFORM1,NX1,NY1,NZ1,NSTACK1,NSTACK2
-      INTEGER                  :: NDUM,NGOT1,NGOT2,IMG1,IMG2,NILMAX,IVAL
+      INTEGER                  :: NGOT1,NGOT2,IMG1,IMG2,NILMAX,IVAL
       INTEGER                  :: MAXIM1,MAXIM2,NLET1,NLET2
       INTEGER                  :: LENT,NOT_USED,IRECIN
 
@@ -115,37 +158,35 @@ C***********************************************************************
 
 C     OPEN FIRST INPUT FILE, DISP = 'E' DOES NOT STOP ON ERROR
       MAXIM1 = 0
+      IMG1   = 0
       PROMPT =
-     &     'SPIDER INPUT FILE NAME OR TEMPLATE (e.g. SPI_STK@**)~~9'
+     &     'SPIDER INPUT FILE NAME OR TEMPLATE (e.g. SPI_STK@*)~~9'
       CALL OPFILES(0,LUNSPI,LUNDOC,LUNXM1,  
-     &               .TRUE.,FILNAM1,NLET1, 'E',
+     &               .TRUE.,FILNAM1,NLET1, 'O',
      &               IFORM1,NX1,NY1,NZ1,NSTACK1,
      &               PROMPT,
      &              .TRUE., ILIST1,NILMAX, 
-     &               NDUM,NGOT1,IMG1, IRTFLG) 
+     &               NOT_USED,NGOT1,IMG1, IRTFLG) 
 
 
+#if defined(SP_DBUGIO)
+      write(3,*)' ------- RETURNED TO: COPYTOMRC --------'
+      write(3,*)' In copytomrc; nx1,ny1,nz1: ',nx1,ny1,nz1
+      write(3,*)' '
+
+#endif
+
       CALL LUNGETIS_MRC(LUNSPI,IS_MRC,IRTFLG)      
       CALL LUNGETISBARE(LUNSPI,IS_BARE,IRTFLG)
 
       IF (IS_MRC) THEN
-         CALL ERRT(101,'OPERATION DOES NOT READ MRC FILES',NDUM)
+         CALL ERRT(101,'OPERATION DOES NOT READ MRC FILES',IDUM)
          GOTO 999
       ENDIF
 
-      !write(3,'(A,4i6)')' In nstack1,ngot1,img1:',nstack1,ngot1,img1
-
-      CALL FILERD(FILNAM2,NLET2,NULL,
-     &       'MRC OUTPUT FILE NAME OR TEMPLATE (e.g. **@MRC_STK.mrc)~',
-     &       IRTFLG)
-      IF (IRTFLG .NE. 0) GOTO 999
-
-      IF (INDEX(FILNAM2,'.mrc') <= 0 .AND.
-     &    INDEX(FILNAM2,'.MRC') <= 0) THEN
-         CALL ERRT(101,
-     &     'OUTPUT FILE NAME MUST HAVE MRC/mrc EXTENSION',NDUM)
-         GOTO 999
-      ENDIF
+#if defined(SP_DBUGIO)
+      !write(3,'(A,4i6)')' In nstack1; ngot1,img1:',nstack1,ngot1,img1
+#endif
 
 
 C     FIND HEADER VALUES FOR THE MRC FILE
@@ -164,15 +205,13 @@ C     LEGACY INPUT TRAP
       IF (MRCMODE == 16) MRCMODE = 6   ! 16 BIT UNSIGNED INT
       IF (MRCMODE == 32) MRCMODE = 2   ! 32 BIT FLOATING POINT
 
-      WRITE(NOUT,*) ' ' 
-      WRITE(NOUT,*) ' MRC DATA ORIGIN     UL: UPPER LEFT, ',
+       WRITE(NOUT,*) ' MRC DATA ORIGIN     UL: UPPER LEFT, ',
      &              ' LL: LOWER LEFT  '
       IF (NZ1 > 1) THEN
-         WRITE(NOUT,*) ' MRC HANDEDNESS  L: LEFT, ',
-     &                 '        R:  RIGHT '
+         WRITE(NOUT,*) ' MRC HANDEDNESS  L: LEFT, ','        R:  RIGHT '
       ENDIF
 
-      CAXIS(1:2) = 'UL'        ! DEFAULT
+      CAXIS = 'UL  '        ! DEFAULT
 
       IF (NZ1 <= 1) THEN
          CALL RDPRMC(CSTR,NC,.TRUE.,'MRC DATA ORIGIN (UL/LL)',
@@ -231,7 +270,7 @@ C        NEED FMIN & FMAX (SIG IN COMMON: MASTER)
          FMAXT = FMAX
          FAVT  = AV
          FSIGT = SIG
-C     UNFININISHED HERE !!!!!!!!!!!!!!!!!!!
+C        UNFININISHED HERE !!!!!!!!!!!!!!!!!!!
 
       ELSEIF (MRCMODE == 0  .AND. MAXIM1 < 0 ) THEN
 C        8 BIT SIGNED INTEGER IMAGE OR VOLUME (NOT WHOLE STACK)
@@ -274,6 +313,7 @@ C        NEED FMIN & FMAX (SIG IN COMMON: MASTER)
             I4VAL = FMIN
             CALL ERRT(102,'POSSIBLE 16 BIT INTEGER UNDERFLOW',I4VAL)
             GOTO 999
+
          ELSEIF (FMAX > HUGE(I2VAL)) THEN 
             I4VAL = FMAX
             CALL ERRT(102,'POSSIBLE 16 BIT INTEGER OVERFLOW',I4VAL)
@@ -307,58 +347,69 @@ C          NOTHING IN SPIDER HEADER?
       ENDIF
       IF (IRTFLG .NE. 0) RETURN
 
-      NSTACK2 =  1   ! UNUSED
-      DISP    = 'U'  ! NEW OUTPUT FILE        
+      WRITE(NOUT,*) ' ' 
+      NSTACK2 =  1   ! UNUSED, NOT SENT
+      DISP    = 'N'  ! NEW OUTPUT FILE        
 
 C     OPEN FIRST OUTPUT FILE 
-      IMG2 = IMG1
+      IMG2   = IMG1         ! DEFAULT
+      PROMPT =
+     &    'MRC OUTPUT FILE NAME OR TEMPLATE (e.g. *@file_stk.mrc)~'
+
       CALL OPFILES(LUNSPI,LUNMRC,LUNDOC,LUNXM2, 
-     &              .FALSE.,FILNAM2,NLET2,DISP,
+     &              .TRUE.,FILNAM2,NLET2,DISP,
      &              IFORM1,NX1,NY1,NZ1,NSTACK2,
-     &              FILNAM2,
-     &              .TRUE., ILIST2,NILMAX, 
-     &              NDUM,NGOT2,IMG2, IRTFLG) 
+     &              PROMPT,
+     &              .FALSE., ILIST2,NILMAX, 
+     &              NOT_USED,NGOT2,IMG2, IRTFLG) 
 
-      !write(3,'(A,4i6)')' In copytomrc nstack2,ngot2:',nstack2,ngot2
-      !write(3,'(A,i6,A)')' In copytomrc img2:',img2
-      !write(3,*)         ' In copytomrc caxis:',caxis
+#if defined (SP_DBUGIO)
+      write(3,*)' In copytomrc; nx1,ny1,nz1:    ', nx1,ny1,nz1
+      write(3,*)' In copytomrc; nstack2,nilmax: ', nstack2,nilmax
+      write(3,*)' In copytomrc; ngot2,img2:     ', ngot2,img2
+      write(3,*)' '
+#endif
 
       CALL LUNSETMODE_MRC(LUNMRC,MRCMODE,IRTFLG)
+
       CALL LUNSETHAND_MRC(LUNMRC,CAXIS,IRTFLG)
+
       CALL LUNSETPIXSIZES_MRC(LUNMRC,SCALEX,SCALEY,SCALEZ,IRTFLG)
+
       CALL LUNWRTHED_MRC(LUNMRC,IRTFLG)
 
-C     SETS LUNMRCNBYT(LUN) = NBYT
       CALL LUNSETPOS_MRC(LUNMRC,IMG1,IRTFLG)
 
+C     SETS LUNMRCNBYT(LUN) = NBYT    ! COMMENTED OUT??
+
 C     DO NOT REPORT FILE INFO IF WHOLE STACK
       IF (NSTACK1 > 0 .AND. NSTACK2 >= 0) VERBOSE = .FALSE. 
 
       NINDX1 = 1
       NINDX2 = 1
-      DO                ! LOOP OVER ALL IMAGES/STACKS
+      DO                ! LOOP OVER ALL IMAGES or IMAGE STACKS
 
 C        COPY THE DESIRED NUMBER OF DATA RECORDS FROM EACH FILE
-         DO IRECIN = 1,NY1*NZ1
+         DO IRECIN = 1,NY1*NZ1   ! NUMBER OF RECORDS COPIED
 
-C           READ EACH ROW OF SPIDER INPUT FILE 
+C           READ EACH ROW OF SPIDER INPUT FILE  (READS INPUT DATA)
             CALL REDLIN(LUNSPI,BUF,NX1,IRECIN)
 
 C           WRITE EACH ROW OF SPIDER INPUT FILE 
             IF (MRCMODE == 2) THEN
-C              32 BIT FLOATING POINT  
+C              32 BIT FLOATING POINT            (WRITES OUTPUT DATA)
                CALL WRTLIN_MRC(LUNMRC,BUF,NX1,IRECIN,MYPID,IERR)
 
             ELSEIF (MRCMODE == 0 ) THEN
-C              8 BIT SIGNED INTEGER
+C              8 BIT SIGNED INTEGER            (WRITES OUTPUT DATA)
                CALL WRTLIN_MRC(LUNMRC,BUF,NX1,IRECIN,MYPID,IERR)
  
             ELSEIF (MRCMODE == 1) THEN
-C              16 BIT SIGNED INTEGER
+C              16 BIT SIGNED INTEGER            (WRITES OUTPUT DATA)
                CALL WRTLIN_MRC(LUNMRC,BUF,NX1,IRECIN,MYPID,IERR)
  
             ELSEIF (MRCMODE == 6) THEN
-C              16 BIT UNSIGNED INTEGER
+C              16 BIT UNSIGNED INTEGER            (WRITES OUTPUT DATA)
                CALL WRTLIN_MRC(LUNMRC,BUF,NX1,IRECIN,MYPID,IERR)
  
             ENDIF
@@ -375,14 +426,27 @@ C              16 BIT UNSIGNED INTEGER
          ENDDO     ! END OF: DO IRECIN = 1,NY*NZ
 
 
-C        OPEN NEXT SET OF I/O FILES, UPDATES NINDX1 & NINDX2 
-         !write(3,*)' In copytomrc, calling nextfiles:',nindx1,nindx2 
+C        OPEN NEXT SET OF I/O FILES, UPDATES NINDX1 & NINDX2
 
+#if defined (SP_DBUGIO)
+         write(3,*)' In copytomrc; calling nextfiles:',nindx1,nindx2
+         write(3,*) ' ==================  next set ===================='
+#endif
+                    
          CALL NEXTFILES(NINDX1,NINDX2,  ILIST1,ILIST2, 
      &                  .FALSE., LUNXM1,LUNXM2,
      &                  NGOT1,NGOT2,    NSTACK1,NSTACK2,  
      &                  LUNSPI,LUNSPI,LUNMRC, FILNAM1,FILNAM2,
      &                  IMG1,IMG2, IRTFLG)
+
+#if defined (SP_DBUGIO)
+         write(3,*)' After nextfiles; ngot1,nstack1,img1: ',
+     &                                ngot1,nstack1,img1
+         write(3,*)' After nextfiles; ngot2,nstack2,img2: ',
+     &                                ngot2,nstack2,img2
+         write(3,*)' After nextfiles; irtflg:             ', irtflg
+#endif
+
          IF (IRTFLG .NE. 0) EXIT      ! ERROR / END OF INPUT STACK
       ENDDO
 
@@ -397,237 +461,3 @@ C        OPEN NEXT SET OF I/O FILES, UPDATES NINDX1 & NINDX2
 
       END
 
-
-
-
-
-C **********************************************************************
-C
-C COPYTOMRC_STK  'CP TO MRC' STACKS               JUN 16 ArDean Leith
-C
-C **********************************************************************
-C 
-C COPYTOMRC_STK(LUNSPI,LUNMRC,SPIPAT,ILIST,NIMG, MAXIM,NX,NY,NZ)
-C                                                                      
-C PURPOSE: CONVERTS SPIDER IMAGE STACK TO MRC FORMAT, CRUDELY WRITTEN!!
-C          CREATES NATIVE X386 BYTE ORDER MRC FILES 
-C
-C NOTES: DATA MODE IN MRC FILE : 2  (32 BIT FLOATING POINT)
-C        ONLY CREATES 32 BIT REAL STACKS AS NORMALIZATION DIFFICULT FOR
-C        LARGE MRC STACKS.
-C
-C       CREATE A NEW HEADER FOR THE MRC FILE 2014
-C       DMAX < DMIN                         MAX & MIN UNDETERMINED
-C       DMEAN < (SMALLER OF DMIN and DMAX)  DMEAN     UNDETERMINED
-C       RMS < 0.0                           RMS       UNDETERMINED
-C
-C       TYPE           ISPG       MZ
-C       IMAGE            0         1
-C       IMAGE STACK      0      >= 1
-C       VOLUME           1      = NZ
-C       VOLUME STACK    401     = NZ / # OF SINGLE VOLUMES
-C
-C23456789012345678901234567890123456789012345678901234567890123456789012
-C***********************************************************************
-
-        SUBROUTINE COPYTOMRC_STK(LUNSPI,LUNMRC,SPIPAT,
-     &                           ILIST,NIMG,MAXIM,IMGNUMOUT,
-     &                           NX,NY,NZ)
- 
-C       COPY STACKS FROM SPIDER TO MRC FILE FORMAT 
-
-        IMPLICIT NONE
-
-        INCLUDE 'CMBLOCK.INC'
-        INCLUDE 'CMLIMIT.INC'
- 
-        INTEGER                 :: IERR
-        COMMON /IOERR/  IERR       ! LEGACY REDLIN ERROR FLAG
-
-        REAL                    :: BUFIN
-        COMMON /IOBUF/  BUFIN(NBUFSIZ)
-
-        INTEGER LUNARA,LUNSTK,LUNARB,LUNFLIP
-        COMMON /LUNARA/ LUNARA(100),LUNSTK(100),LUNARB(100),LUNFLIP(100)
-
-        INTEGER                 :: LUNSPI,LUNMRC, NIMG,MAXIM,NX,NY,NZ
-        CHARACTER(LEN=*)        :: SPIPAT
-        INTEGER                 :: ILIST(*)
-        INTEGER                 :: IMGNUMOUT
-
-        REAL                    :: FIXLENBUF(256)
-        REAL                    :: FLIPBUF(NX)
-
-        CHARACTER(LEN=MAXNAM)   :: MRCFILE
-        CHARACTER(LEN=4)        :: CSAXIS
-        LOGICAL                 :: ISSWABT
-
-        LOGICAL                 :: isswab,BOTLEFT
-        INTEGER                 :: lnblnkn
-
-        INTEGER *8              :: IPOSMRC
-        INTEGER                 :: ISTARTX,ISTARTY,ISTARTZ
-        REAL                    :: ORIGX,ORIGY,ORIGZ
-        INTEGER                 :: IRTFLG,MODE,NX4
-        INTEGER                 :: NSYMBT,MACHST,NE,IOFFSET 
-        INTEGER                 :: NCHAR,LENT,ILEN,IBOTLEFT
-        INTEGER                 :: NOT_USED
-        INTEGER                 :: IRECIN,ILOCIN,IRECINT
-        REAL                    :: RMS,FMINT,FMAXT,FAVT,FSIGT
-        REAL                    :: UNUSED,SCALE,SCALEX,SCALEY,SCALEZ
-        INTEGER                 :: NLET,IGO,MZ,IVERSION
-        INTEGER                 :: NINDX,NGOT,IBITS,NSYMBYT,ISPG
-
-        LOGICAL, PARAMETER      :: FOUROK = .FALSE.
-        INTEGER, PARAMETER      :: LUNXM  = 0
-
-
-C       OPEN NEW MRC STACK FILE FOR STREAM ACCESS, LITTLE ENDED
-        CALL OPSTREAMFILE(.TRUE.,MRCFILE,DATEXC,LUNMRC,
-     &                    'UNFORMATTED','NL',
-     &                    'MRC OUTPUT',.TRUE.,IRTFLG)
-        IF (IRTFLG .NE. 0) GOTO 9999
-
-        IVERSION = 20140
-        IBOTLEFT = 1               
-        CALL RDPRI2S(IVERSION,IBOTLEFT,NOT_USED,
-     &    'MRC VERSION (0 or 20140), ORIGIN AT BOTTOM LEFT (YES==1)',
-     &    IRTFLG)
-        IF (IRTFLG .NE. 0) GOTO 9999
-
-        BOTLEFT = (IBOTLEFT == 1)   ! USUAL MRC BOTTOM!!
-        IF (IVERSION .NE. 20140 ) IVERSION = 0
-  
-C       MODE IS 32 BIT FLOATING POINT MRC IMAGE
-        MODE    = 2                ! FLOATING POINT IMAGE
-
-        ISTARTX = 0
-        ISTARTY = 0
-        ISTARTZ = 0
-
-C       ORIGIN ON X,Y & Z AXIS  (MAKE THIS ALWAYS ZERO) 
-        ORIGX   = 0.0
-        ORIGY   = 0.0
-        ORIGZ   = 0.0
-
-C       TRY TO GET SPIDER IMAGE SCALE VALUE (MAY NOT BE SET?)
-        CALL GETLAB(LUNSPI,21,1,SCALEX,IRTFLG)
-        SCALEY  = SCALEX
-        SCALEZ  = SCALEX
-
-        IF (SCALEX > 0) THEN
-           WRITE(NOUT,*) ' PIXEL SIZE (A) FOR ALL AXES (HEADER ',
-     &                   ' LOCATION=21): ',SCALEX
-        ELSEIF (NZ == 1) THEN
-
-           SCALEX = 1.0
-           SCALEY = 1.0
-           SCALEZ = 1.0
-           CALL RDPRM2S(SCALEX,SCALEY,NOT_USED,
-     &              'PIXEL SIZE (A) FOR  X & Y AXES',IRTFLG)
-        ELSE
-           SCALEX = 1.0
-           SCALEY = 1.0
-           SCALEZ = 1.0
-           CALL RDPRM3S(SCALEX,SCALEY,SCALEZ,NOT_USED,
-     &              'PIXEL SIZE (A) FOR X, Y, & Z AXES',IRTFLG)
-        ENDIF
-
-C       SET UNDETERMINED IMAGE STATISTICS (FASTER)
-        IF (IVERSION >= 20140) THEN
-           FMINT =  0    
-           FMAXT = -1
-           FAVT  = -2
-           FSIGT = -1
-        ELSE
-           FMINT =  0    ! UNDETERMINED SHUD BE: FMINT =  0 FOR MRC 2014
-           FMAXT =  0    ! UNDETERMINED SHUD BE: FMAXT = -1
-           FAVT  =  0    ! UNDETERMINED SHUD BE: FAVT  = -2
-           FSIGT = -1    ! UNDETERMINED SHUD BE: FSIGT = -1
-        ENDIF
-
- 
-        NSYMBYT = 0            ! NO ADDED HEADER LOCATIONS
-        ISSWABT = .FALSE.
-
-C       CREATE MRC HEADER. 
-        CALL SETHEDCCP4_NEW(FIXLENBUF, NX,NY,NZ, NIMG, MODE,IVERSION,
-     &                  ISTARTX,ISTARTY,ISTARTZ, 
-     &                  ORIGX,ORIGY,ORIGZ, 
-     &                  SCALEX,SCALEY,SCALEZ, 
-     &                  FMINT,FMAXT,FAVT,FSIGT,
-     &                  ISSWABT,NSYMBYT, IRTFLG)
-        IF (IRTFLG .NE. 0) GOTO 9999
-
-C       WRITE HEADER OF 1024 BYTES (256 FLOATS) TO MRC FILE
-        IPOSMRC = 1  
-        WRITE(LUNMRC, POS=IPOSMRC,IOSTAT=IERR) FIXLENBUF
-
-        IF (IERR .NE. 0) THEN
-           LENT = lnblnkn(MRCFILE)
-           ILEN = 256
-           WRITE(NOUT,99) IERR,IPOSMRC,ILEN,LUNMRC,MRCFILE(:LENT)
-99         FORMAT( '  *** ERROR(',I4,') WRITING POSITION: ',I12,
-     &              ' LENGTH: ', I9,' UNIT: ',I3,' FILE: ',A)
-           GOTO 9999
-        ENDIF
-
-        IOFFSET = 1024
-        NINDX   = IMGNUMOUT
-        NGOT    = NIMG
-        NX4     = NX * 4
-          
-C       LOOP OVER ALL IMAGES IN SPIDER STACK
-        DO             ! LOOP OVER ALL IMAGES IN SPIDER STACK
-
-C          SET STARTING POSITION FOR MRC DATA
-           IPOSMRC = (IMGNUMOUT-1)  ! KLUDGE FOR INTEGER *8 PRESERVE
-           IPOSMRC = IPOSMRC * NX * NY 
-           IPOSMRC = IPOSMRC * 4
-           IPOSMRC = IOFFSET + IPOSMRC + 1
-
-c          write(6,'(2x,A,3i6,i12)') '  nindx,ilist,imgnumout,iposmrc:',
-c     &                          nindx,ilist(nindx),imgnumout,iposmrc
-
-           DO IRECIN = 1,NY*NZ
-
-C             READ EACH ROW OF SPIDER INPUT FILE 
-
-
-              IF (BOTLEFT) THEN
-                 IRECINT = (NY * NZ) - IRECIN + 1    ! BOTTEM LEFT 
-              ELSE
-                 IRECINT = IRECIN
-              ENDIF  
-              CALL REDLIN(LUNSPI,BUFIN,NX,IRECINT)
-
-C             PUT ROW OUT TO MRC FILE
-              WRITE(LUNMRC, POS=IPOSMRC,IOSTAT=IERR) BUFIN(1:NX)
-
-              IF (IERR .NE. 0) THEN
-                LENT = lnblnkn(MRCFILE)
-                WRITE(NOUT,99) IERR,IPOSMRC,NX,LUNMRC,MRCFILE(:LENT)
-                GOTO 9999
-              ENDIF
-              IPOSMRC = IPOSMRC + NX4
-
-           ENDDO     ! END OF: DO IRECIN = 1,NY*NZ
-
-C          OPEN NEXT SPIDER INPUT FILE, UPDATES NINDX 
-           CALL NEXTFILE(NINDX, ILIST, 
-     &                  FOUROK, LUNXM,
-     &                  NGOT,   MAXIM,   
-     &                  LUNSPI, 0,
-     &                  SPIPAT, 'O',
-     &                  IMGNUMOUT, IRTFLG) 
-         
-           IF (NINDX > MAXIM) EXIT    ! FINISHED 
-           IF (IRTFLG .NE. 0) EXIT    ! ERROR
-
-        ENDDO
-                      
-9999    CLOSE(LUNSPI)
-        CLOSE(LUNMRC)
-
-        END
-
diff --git src/copytostk.f src/copytostk.f
index 4a8d032b..f66b7759 100644
--- src/copytostk.f
+++ src/copytostk.f
@@ -101,7 +101,8 @@ C       OPEN FIRST INPUT STACK TO GET SIZING NEEDED FOR OUTPUT FILE
         CLOSE(LUN1)
 
         nlet1 = nlet + 1
-        !write(6,*)'  opened filolds:',nlet1,filolds(1:nlet1)
+        !write(6,*)'  Opened first in:',nlet1,filolds(1:nlet1)
+       write(3,*)'  Opened first input stack:',filolds
 
         IMG2GO = 1
         CALL RDPRI1S(IMG2GO,NOT_USED,
@@ -124,9 +125,6 @@ C	OPEN OUTPUT STACK
            GOTO 9999
         ENDIF
 
-
-        !write(6,*)'  Opened filnew:',nlet2,filnew(1:nlet2)
-
         IMG2 = IMG2GO   ! STARTING OUTPUT IMAGE NUMBER
 
 C       LOOP OVER ALL INPUT STACKS (1...NSTKS)
@@ -143,8 +141,8 @@ C          OPEN BARE INPUT STACK
            CALL OPFILEC(0,ASKNAM,FILOLDS,LUN1,'O',LTYPE,
      &                  LX,LY,LZ,NSTACK1,' ',FOUROK,IRTFLG)
            
-c          write(3,*)'  Opened bare input stack:',filolds(1:nlet+5), 
-c     &                  ' nstack1:',nstack1,irtflg
+           !write(3,*)'  Opened bare input stack:',nstack1,filolds                  
+
            IF (IRTFLG .NE. 0) RETURN
 
 C          MUST CONTAIN  SAME SIZE AND TYPE OF IMAGES/VOLUMES
@@ -160,10 +158,14 @@ C             OPEN NEXT IMAGE IN INPUT STACK
               NSTACK1_1 = 0            ! STACKED IMAGE
               CALL INTTOCHAR(IMG1,CNUM,NLETC,1)
               FILOLDS = FILOLD(1:NLET) // '@' // CNUM(1:NLETC)
+
+              !write(3,*)'  ========== Opening stacked input:',lun1,filolds 
+
               CALL OPFILEC(0,ASKNAM,FILOLDS,LUN1,'O',LTYPE,
      &                  LX,LY,LZ,NSTACK1_1,' ',FOUROK,IRTFLG)
-c             write(3,*)'  Opened stacked input :',filolds(1:nlet+5), 
-c&                  ' nstack1_1:',nstack1_1,irtflg
+
+              !write(3,*)'  Opened stacked input:',nstack1_1,filolds 
+
               IF (IRTFLG .NE. 0) RETURN
 
 C             GET OVERALL HEADER FROM THE NEW STACK FILE
@@ -189,9 +191,9 @@ C             PUT IMAGE INUSE IN THIS IMAGE'S HEADER OBJECT
 C             PUSH HEADER OBJECT INFO INTO NEW STACKED FILE
               CALL LUNWRTHED(LUN2,NX,IMG2,IRTFLG)
 
-c             write(3,*)'  In copytostk 2, img2,irtflg:',img2,irtflg,ny
-c             call lungethedoff(lun2,nx,img2, lunaraoff,lunstkoff,irtflg)
-c             write(3,*)'  In copytostk 3 --:',img2,lunaraoff,lunstkoff
+              !write(3,*)'  In copytostk 2, img2,irtflg:',img2,irtflg,ny
+              !call lungethedoff(lun2,nx,img2, lunaraoff,lunstkoff,irtflg)
+              !write(3,*)'  In copytostk 3 --:',img2,lunaraoff,lunstkoff
 
 C             COPY THE DATA RECORDS
               DO IREC = 1,NY * NZ
diff --git src/disp.f src/disp.f
index b078d124..9c1c87ae 100644
--- src/disp.f
+++ src/disp.f
@@ -1,15 +1,18 @@
 
+
 C++*********************************************************************
 C
-C  DISP.F  -- EXTRACTED FROM COPYTOJPED            Jan 20 ArDean Leith
+C  DISP.F  -- EXTRACTED FROM COPYTOJPED           Jan 2020 ArDean Leith
+C          -- IRTFLG 654321                       Oct 2025 ArDean Leith
+C          -- REMOVE MRC EXTENSION                Oct 2025 ArDean Leith
 C
 C **********************************************************************
 C=* AUTHOR: A. LEITH                                                   *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2020  Health Research Inc.,                         *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@health.ny.gov                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -49,9 +52,9 @@ C--*********************************************************************
         CHARACTER(LEN=160)    :: COMLIN
  
         CHARACTER(LEN=1)      :: NULL = CHAR(0)
-        LOGICAL               :: VERBOSET,WANTOUT
+        LOGICAL               :: VERBOSET,WANTOUT,SAYIT
         INTEGER               :: NX,NY,NZ,MAXIM,ITYPE,IRTFLG,NLET,NLETC
-        INTEGER               :: lnblnkn,NLETO
+        INTEGER               :: lnblnkn,NLETO,IGOEXT,NDUM
 
         INTEGER, PARAMETER    :: LUN1   = 14 
         INTEGER, PARAMETER    :: LUN2   = 15 
@@ -65,35 +68,70 @@ C--*********************************************************************
 
 C       OPEN INPUT FILE, WHOLE STACK NOT ALLOWED
         MAXIM = 0
+        ITYPE = 0   ! ?
         CALL OPFILEC(0,.TRUE.,FILOLD,LUN1,'O',ITYPE,
      &               NX,NY,NZ,MAXIM,'SPIDER OR MRC INPUT',
      &               .FALSE.,IRTFLG)
         IF (IRTFLG .NE. 0) RETURN
 
+        IF (NZ > 1) THEN
+           CALL ERRT(101,'CAN NOT DISPLAY A VOLUME',NDUM)
+           RETURN
+        ENDIF
+
+#if defined (SP_DBUGIO)
+        nletc = lnblnkn(filold)
+        write(3,*)' In disp; nletc,filold: ',nletc,filold(:nletc)
+#endif
+
         IF (IMAMI .NE. 1) 
      &      CALL NORM3(LUN1,NX,NY,NZ,FMAX,FMIN,AV)
 
 C       IF MRC AND ORIGIN IS 'LL' FLIP ORIGIN FOR DISPLAY
         CALL LUNFLIPORG_MRC(LUN1,NX,NY,NZ,.FALSE.,IRTFLG)
 
-C       JPEG OUTPUT FILE NAME
+C       CREATE JPEG OUTPUT FILE NAME
         NLET   = lnblnkn(FILOLD)
+        IGOEXT = SCAN(FILOLD,'.')
+        IF(IGOEXT > 0 .AND. IGOEXT < NLET) NLET = IGOEXT - 1
+
+#if defined (SP_DBUGIO)
+        write(3,*)' In disp; nlet,filold(:nlet): ',nlet,filold(:nlet)
+#endif
+
         FILNEW = FILOLD(:NLET) // '.jpg'
         NLET   = NLET + 4
 
+       ! FILNEW = 'jnk_temp_for_display.jpg'
+       ! NLET   = lnblnkn(FILNEW)
+
+#if defined (SP_DBUGIO)
+        write(3,*)' In disp; nlet,filnew(:nlet): ', nlet,filnew(:nlet)
+#endif
+
 C       CONVERT IMAGE FILE INTO JPG FILE
-        VERBOSET = .FALSE.
+C       COPYTOJPG HAS A DELAY NEAR END SINCE AN INTERMEDIATE FILE .gray
+C       IS CREATED TO HANDLE FLOATING POINTS AND NEGATIVE VALUES
+
+        !!!!!!!!!!!!!VERBOSET = .FALSE.
+        VERBOSET = .TRUE.
         CALL COPYTOJPG(LUN1,LUN2,FILNEW,NX,NY,NZ, VERBOSET,IDELAY)
 
-        IRTFLG = -999   ! KEEP LOWERCASE
+        IRTFLG = 654321   ! KEEP LOWERCASE AND ACCEPT <CR>
         CALL RDPRMC(OPTIONS,NLETO,.TRUE.,
      &          'IMAGEMAGICK DISPLAY OPTIONS (or <CR>)',NULL,IRTFLG)
 
         WRITE(COMLIN,90) OPTIONS(1:NLETO),FILNEW(1:NLET)
 90      FORMAT( ' display ', A,' ',A, ' &' )
 
-C       DO NOT ECHO COMLIN
-        CALL CSVMS(COMLIN,.FALSE.,IRTFLG)
+#if defined (SP_DBUGIO)
+        write(3,*)' In disp; comlin: ',comlin
+        !sayit = .TRUE.
+#endif
+
+C       SAYIT: ECHO COMLIN TO OUTPUT
+        SAYIT = .FALSE.
+        CALL CSVMS(COMLIN,SAYIT,IRTFLG)
 
         END
 
@@ -130,7 +168,7 @@ C       ----------------- DISP_RELION ---------------------------------
      &              NULL,IRTFLG)
         IF (IRTFLG .NE. 0) RETURN
 
-        WRITE(COMLIN,90) ,FILELINE(1:NLET1), OPTIONS(1:NLET2)
+        WRITE(COMLIN,90) FILELINE(1:NLET1), OPTIONS(1:NLET2)
 90      FORMAT( ' relion_display --i ', A,' ',A, ' &' )
 
 C       DO NOT ECHO COMLIN
diff --git src/filget.f src/filget.f
index fe53bb49..a3722e9c 100644
--- src/filget.f
+++ src/filget.f
@@ -12,7 +12,6 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2011  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
diff --git src/filget_at.f src/filget_at.f
index 80e05ea2..2cb5e698 100644
--- src/filget_at.f
+++ src/filget_at.f
@@ -8,7 +8,6 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2011  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@health.ny.gov                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -56,7 +55,7 @@ C
 C     APPEND IMAGE NUMBER TO BARE STACK FILE NAME
 C     (INTTOCHAR ALSO RETURNS NEW VALUE FOR NLET)
 C
-C     ***@STK.MRC or aaa/***@STK.MRC
+C     ???@STK.MRC or aaa/???@STK.MRC   ! GFORT DID NOT ACCEPT * HERE Sept 2025
 C        @STK.MRC or aaa/@STK.MRC
 C         IMG***.MRC ??
 
diff --git src/four_fq.good src/four_fq.good
deleted file mode 100644
index 52655714..00000000
--- src/four_fq.good
+++ /dev/null
@@ -1,1086 +0,0 @@
-C++*********************************************************************
-C
-C  FOUR_FQ.F
-C             OPFILEC                              FEB 03 ARDEAN LEITH    
-C             COS                                  JUL 12 G. KISHCHENKO    
-C             FQ Q PARAMS                          OCT 12 ARDEAN LEITH    
-C             RAISED SINC                          OCT 13 ARDEAN LEITH    
-C             CREATED FROM FOUR1A                  NOV 14 ARDEAN LEITH    
-C             VOLUME IOPT 12 & 13 TRAP for ifort   JUN 15 ARDEAN LEITH    
-C             VOLUME FILTER BUG                    MAY 17 ARDEAN LEITH    
-C       
-C **********************************************************************
-C=*                                                                    *
-C=* This file is part of:   SPIDER - Modular Image Processing System.  *
-C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2018  Health Research Inc.,                         *
-C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@wadsworth.org                                        *
-C=*                                                                    *
-C=* SPIDER is free software; you can redistribute it and/or            *
-C=* modify it under the terms of the GNU General Public License as     *
-C=* published by the Free Software Foundation; either version 2 of the *
-C=* License, or (at your option) any later version.                    *
-C=*                                                                    *
-C=* SPIDER is distributed in the hope that it will be useful,          *
-C=* but WITHOUT ANY WARRANTY; without even the implied warranty of     *
-C=* merchantability or fitness for a particular purpose.  See the GNU  *
-C=* General Public License for more details.                           *
-C=* You should have received a copy of the GNU General Public License  *
-C=* along with this program. If not, see <http://www.gnu.org/licenses> *
-C=*                                                                    *
-C **********************************************************************
-C
-C FOUR_FQ 
-c
-C PURPOSE:  APPLIES FOURIER FILTERS TO 2-D OR 3-D REAL PICTURES
-C            'FQ Q'   : QUICK FILTERING (IN CORE, 2-D OR 3-D)
-C            'FQ QNP' : QUICK FILTERING (IN CORE, 2-D OR 3-D) NO PAD
-C
-C NOTE:  APPEARS TO HAVE UNDOCUMENTED AND UNTESTED ELLIPTICAL 
-C        FILTRATION FOR OPTIONS: 1,2,3,4.   THIS WILL GIVE BAD 
-C        ERRORS IF PERSON ENTERS MORE THAN ONE VALUE ON THE INPUT
-C        PARAMETER LINE AS IT IS USED FOR ELLIPSES. al nov 2014
-C
-C        SUBSTITUTION OF PRECALCULATED INTERMEDIATE VARIABLES NOT
-C        USEFULL FOR SPEED SINCE TIME IS DOMINATED BY FFT. SEE RCS
-C        VERSIONS FOR TESTING THIS
-C
-C        'FF' (ffilts.f)            SETS X1 TO: (NX  / 2)**2 BUT
-C        'FQ' (four_fq.f or fq_q.f) SETS X1 TO: (NXF / 2)**2 WHERE
-C             NX  IS X DIMENSION OF POSSIBLY PADDED IMAGE
-C             NXF IS SLIGHTLY LARGER DUE TO MIXED RADIX FOURIER PAD
-C        SO THEY GIVE SLIGHTLY DIFFERENT RESULTS.  I SUSPECT THAT
-C        'FF' IS ACTUALLY CORRECT?
-C
-C23456789012345678901234567890123456789012345678901234567890123456789012
-C--*********************************************************************
-
-        SUBROUTINE FOUR_FQ
-
-        IMPLICIT NONE
-        INCLUDE 'CMBLOCK.INC' 
-        INCLUDE 'CMLIMIT.INC'
-
-        CHARACTER (LEN=MAXNAM) :: FILNAM
-
-        REAL, ALLOCATABLE      :: BB(:,:,:)
-       
-        INTEGER                :: N2X,N2Y,N2Z,LSD
-        INTEGER                :: NX,NY,NZ
-        INTEGER                :: MAXIM,IOPT,IRTFLG,NOT_USED
-        INTEGER                :: IDUM,NE,IPADTYPE
-        INTEGER                :: NMAX,NGOT,INV,I,J,K,IRECT
-        REAL                   :: ORD,FP,FS,PARM1T,PARM2T,AVET
-        REAL                   :: PARM1,PARM2,PARM3,PADVAL
-        REAL                   :: BFPS(4)
-        INTEGER                :: IWANTFOU,NLETF,ITYPE
-        LOGICAL                :: WANTFOU
-        CHARACTER (LEN=1)      :: NULL = CHAR(0)
-
-        REAL, PARAMETER        :: EPS = 0.882
-        REAL, PARAMETER        :: AA  = 10.624
-
-        INTEGER, PARAMETER     :: LUN1 = 21
-        INTEGER, PARAMETER     :: LUN2 = 22
-
-C       OPEN REAL OR FOURIER SPACE INPUT FILE
-        MAXIM = 0
-        CALL OPFILEC(0,.TRUE.,FILNAM,LUN1,'O',IFORM,NX,NY,NZ,
-     &             MAXIM,'INPUT',.TRUE.,IRTFLG)
-        IF (IRTFLG .NE. 0) RETURN
-        AVET = AV      ! FROM CMBLOCK
-
-        IF (IFORM .NE. 1 .AND. IFORM .NE. 3) THEN
-           WRITE(NOUT,*) '  OPERATION PROCESSING FOURIER INPUT'
-           CALL ERRT(101,'OPERATION DOES NOT ACCEPT FOURIER INPUT',IDUM)
-           GOTO 999
-
-        ELSEIF (IFORM == 1 .AND. NY == 1) THEN
-           CALL ERRT(101,'OPERATION DOES NOT WORK ON 1D INPUT',IDUM)
-           GOTO 999
-        ENDIF
-        
-        CALL FILERD(FILNAM,NLETF,NULL,'OUTPUT',IRTFLG)
-        IF (IRTFLG. NE. 0) GOTO 999
- 
- 1000   WRITE(NOUT,90)
- 90     FORMAT
-     &  ('  1 - LOW-PASS,                2 - HIGH-PASS'         ,/,
-     &   '  3 - GAUSS.  LOW-PASS,        4 - GAUSS.  HIGH-PASS' ,/,
-     &   '  5 - FERMI   LOW-PASS         6 - FERMI   HIGH-PASS' ,/,
-     &   '  7 - BUTTER. LOW-PASS,        8 - BUTTER. HIGH-PASS' ,/,
-     &   '  9 - RAISED COS. LOW-PASS,   10 - RAISED COS. HIGH-PASS' ,/,
-     &   ' 13 - RAISED SINC WINDOW,     14 - B FACTOR')
-
-        IWANTFOU = 0
-        CALL RDPRI2S(IOPT,IWANTFOU,NOT_USED,'FILTER TYPE (1-14)',IRTFLG)
-        IF (IRTFLG. NE. 0) GOTO 999
-        
-        IF (IOPT < 1 .OR. IOPT > 14) THEN
-           CALL ERRT(102,'ILLEGAL VALUE FOR FILTER TYPE',IOPT)
-           GOTO 1000
-        ENDIF
-
-       IF (NZ > 1 .AND. IOPT == 13 ) THEN
-           CALL ERRT(101,'OPTION NOT IMPLEMENTED FOR VOLUMES',IOPT)
-           GOTO 1000
-        ENDIF
-         
-        WANTFOU = (IWANTFOU == 1)
-
-        PARM2 = 0.0
-        PARM3 = 0.0
-        BFPS  = 0.0
-
-        IF (IOPT == 5 .OR. IOPT == 6)  THEN
-C          FERMI DISTRIBUTION FILTER ****************************
-
-           PARM1 = 0.25
-           CALL RDPRM1S(PARM1,NOT_USED,
-     &        'FILTER RADIUS (IN FREQUENCY OR PIXEL UNITS)',IRTFLG)
-           IF (IRTFLG .NE. 0) RETURN
-
-           IF (PARM1 < 0.0 .OR. PARM1 > 1.0) 
-     &         PARM1 = 0.5 * PARM1 / (NX/2)     ! RADIUS INPUT
-
-           CALL RDPRM1S(PARM3,NOT_USED,
-     &                     'TEMPERATURE (0=CUTOFF)',IRTFLG)
-
-C          EXPONENTIAL FOR HIGH-PASS OPTION
-           IF (IOPT == 6) PARM3 = -PARM3
- 
-        ELSEIF (IOPT == 7  .OR. IOPT == 8) THEN
-C          BUTTERWORTH  FILTER ********************************
-
-           NMAX = 4
-           CALL RDPRA(
-     &        'LOWER & UPPER LIMITING FREQ. (IN FREQ OR PIXEL UNITS)',
-     &        NMAX,0,.FALSE.,BFPS,NGOT,IRTFLG)
-           IF (IRTFLG .NE. 0) RETURN
-
-           ORD = 2.0 * ALOG10(EPS / SQRT(AA**2 - 1.0) )
-
-           IF (BFPS(1) > 1.0) THEN
-C             RADIUS INPUT
-              PARM1 = BFPS(1) / NX
-              PARM2 = BFPS(2) / NX
-           ELSE
-C             FREQUENCY INPUT
-              PARM1 = BFPS(1)
-              PARM2 = BFPS(2)
-           ENDIF
-
-           IF (BFPS(3) == 0.0 .AND. BFPS(4) == 0.0) THEN
-C             BUTTERWORTH CIRCULAR FILTER
-
-              PARM3 = ORD / ALOG10(PARM1 / PARM2)
-              PARM1 = PARM1 / EPS**(2. / PARM3)
-
-           ELSE
-C             BUTTERWORTH ELLIPTIC FILTER
-C             LOW-PASS  IOPT=11,  HIGH-PASS IOPT=12
-
-              IOPT = IOPT + 4
-              IF (NZ > 1 ) THEN
-                 CALL ERRT(101,
-     &              'OPTION NOT IMPLEMENTED FOR VOLUMES',IOPT)
-                 GOTO 1000
-              ENDIF
-           ENDIF
-
-           !write(6,*) 'ord,parm1:',parm3,parm1
-
-        ELSEIF ( IOPT == 9  .OR. IOPT == 10)  THEN
-C          RAISED COSINE FILTER ********************************
-
-           PARM1 = 0.25
-           PARM2 = -9999999
-           CALL RDPRM2S(PARM1,PARM2,NOT_USED,
-     &       'LOWER & UPPER LIMITING FREQ. (IN FREQ OR PIXEL UNITS)',
-     &        IRTFLG)
-           IF (IRTFLG .NE. 0) RETURN
-
-           IF (PARM1 < 0.0 .OR. PARM1 > 1.0) 
-     &         PARM1 = 0.5 * PARM1 / (NX/2)     ! RADIUS INPUT
-
-           IF (PARM2 == -9999999) THEN
-              ! SAME AS PARM1
-              PARM2 = PARM1
-
-           ELSEIF  (PARM2 < 0.0 .OR. PARM2 > 1.0) THEN
-              ! RADIUS INPUT
-              PARM2 = 0.5 * PARM2 / (NY/2)   
-           ENDIF
-
-        ELSEIF (IOPT == 14)  THEN
-C          B FACTOR FILTER  ************************************
-
-           WRITE(NOUT,*)
-     &         ' NORMALIZES AMPLITUDES BY A "B" TEMPERATURE FACTOR'
-           WRITE(NOUT,*)' AMP = AMP*D*(EXP(BF**2))'
-
-           PARM1 = -200
-           CALL RDPRM1S(PARM1, NOT_USED,'B FACTOR',   IRTFLG)
-           IF (IRTFLG .NE. 0) RETURN
-
-           PARM2 = 1.0
-           CALL RDPRM1S(PARM2, NOT_USED,'D MULTIPLIER', IRTFLG)
-           IF (IRTFLG .NE. 0) RETURN
-
-           CALL RDPRM1S(PARM3, NOT_USED,'FREQUENCY CUTOFF',  IRTFLG)
-           IF (IRTFLG .NE. 0) RETURN
-
-           PARM3 = PARM3**2
-         
-
-        ELSE
-C          ALL OTHER FILTERS *************************************
-C          LOW-PASS,  HIGH-PASS,  GAUSS.LOW-PASS,  GAUSS.HIGH-PASS
-C          RAISED SINC WINDOW 
-
-           PARM1T = 0.25
-           PARM2T = -9999999
-           CALL RDPRM2S(PARM1T,PARM2T,NOT_USED,
-     &        'FILTER RADIUS (IN FREQUENCY OR PIXEL UNITS)',IRTFLG)
-           IF (IRTFLG .NE. 0) RETURN
-
-           PARM1 = PARM1T
-           IF (PARM1T < 0.0 .OR. PARM1T > 1.0) THEN
-              PARM1 = 0.5 * PARM1 / (NX/2)     ! RADIUS INPUT
-              WRITE(NOUT,'(A,F8.4)') '  Frequency: ',PARM1
-           ENDIF
-
-           IF (PARM2T == -9999999) THEN
-              ! DEFAULTS PARM2 SAME AS PARM1
-              PARM2 = PARM1
-
-           ELSEIF  (PARM2T < 0.0 .OR. PARM2T > 1.0) THEN
-C             RADIUS INPUT FOR PARM2
-              PARM2 = 0.5 * PARM2T / (NY/2)   
-           ENDIF
-
-        ENDIF
-
-
-C       IPADTYPE: 0 == NONE,  1== ZEROPAD, 2==BORDERPAD, 3==AVG PAD
-        IPADTYPE = 2    ! PAD WITH ZEROES
-
-        IF ( INDEX(FCHAR,'NP') > 0)  THEN
-C          NO PADDING
-           IPADTYPE = 0    ! NO PADDING
-           N2X      = NX
-           N2Y      = NY
-           N2Z      = NZ
-
-        ELSE
-C          2x PADDING
-           N2X = 2 * NX
-           IF (NY > 1)  THEN
-              N2Y = 2 * NY
-           ELSE
-              N2Y = 1
-           ENDIF
-           IF (NZ > 1)  THEN
-              N2Z = 2 * NZ
-           ELSE
-              N2Z = 1
-           ENDIF
-        ENDIF
-
-        LSD = N2X + 2 - MOD(N2X,2)
-         
-        ALLOCATE (BB(LSD,N2Y,N2Z), STAT=IRTFLG)           
-        IF (IRTFLG .NE. 0) THEN 
-           CALL ERRT(46,'FOUR_FQ; BB',LSD*N2Y*N2Z)
-           GOTO 999
-        ENDIF
-
-
-        IF (IPADTYPE == 0) THEN
-
-C          NO PADDING AT ALL, EXCEPT FOR FFT PAD IN BUFFER
-           PADVAL = 0
-
-C          LOAD IMAGE/VOLUME INTO FFT PADDED BUFFER
-           CALL REDNPADVOL(LUN1,PADVAL, 
-     &                  NX, NY, NZ, LSD,N2Y,N2Z,
-     &                  BB,IRTFLG)
-           IF (IRTFLG .NE. 0) GOTO 999 
-
-        ELSEIF (IPADTYPE == 1) THEN
-C          USE ZERO AS PADDING VALUE
-           PADVAL = 0.0
-
-C          LOAD IMAGE/VOLUME INTO FFT PADDED BUFFER
-           CALL REDNPADVOL(LUN1,PADVAL, 
-     &                  NX, NY, NZ, LSD,N2Y,N2Z,
-     &                  BB,IRTFLG)
-           IF (IRTFLG .NE. 0) GOTO 999 
-
-        ELSEIF (IPADTYPE == 3) THEN
-C          USE AVE FROM IMAGE AS PADDING VALUE
-           PADVAL = AVET
-
-C          LOAD IMAGE/VOLUME INTO FFT PADDED BUFFER
-           CALL REDNPADVOL(LUN1,PADVAL, 
-     &                  NX, NY, NZ, LSD,N2Y,N2Z,
-     &                  BB,IRTFLG)
-           IF (IRTFLG .NE. 0) GOTO 999 
- 
-        ELSEIF (IPADTYPE == 2) THEN
-C          USE AVERAGE OF BORDER VALUES AS PADDING VALUE
-
-C          LOAD IMAGE/VOLUME INTO FFT PADDED BUFFER
-           CALL READV(LUN1,BB, LSD,N2Y, NX,NY,NZ)
-
-C          DETERMINE PADDING VALUE & PAD IMAGE/VOLUME
-           IF (IFORM == 1) THEN
-              PADVAL = 
-     &          (SUM(BB(1:NX,1,1))   + SUM(BB(1:NX,NY,1)) +
-     &           SUM(BB(1,2:NY-1,1)) + SUM(BB(NX,2:NY-1,1)) ) / 
-     &           REAL(2*(NX+NY)-4)
-
-C             PAD IMAGE
-c$omp         parallel do private(j)
-	      DO J=1,N2Y
-	         BB(NX+1:N2X,J,1) = PADVAL
-	      ENDDO
-
-c$omp         parallel do private(j)
-	      DO J=NY+1,N2Y
-	         BB(1:NX,J,1) = PADVAL
-	      ENDDO
-
-           ELSE
-              PADVAL =
-     &          (SUM(BB(1:NX,1:NY,1))     + SUM(BB(1:NX,1:NY,NZ))   +
-     &           SUM(BB(1:NX,1,2:NZ-1))   + SUM(BB(1:NX,NY,2:NZ-1)) +
-     &           SUM(BB(1,2:NY-1,2:NZ-1)) + SUM(BB(NX,2:NY-1,2:NZ-1)))
-     &         / REAL( 4 * (NX+NY+NZ) - 16)
-
-C             PAD VOLUME
-c$omp         parallel do private(k)
-	      DO K = 1,NZ
- 	         BB(NX+1:N2X, 1:NY,     K) = PADVAL
- 	         BB(1:N2X,    NY+1:N2Y, K) = PADVAL
-              ENDDO
-
-c$omp         parallel do private(k)
-	      DO K=NZ+1,N2Z
-	         BB(1:N2X, 1:N2Y, K) = PADVAL
-	      ENDDO
-	   ENDIF
-
-        ENDIF
-
-        !write(6,*) ' pad:',padval
-
-C       FORWARD FFT, FFT PADDED
-        INV = 1
-        CALL FMRS(BB,N2X,N2Y,N2Z, 0.0D0, .TRUE.,.TRUE.,INV,IRTFLG)
-        IF (INV == 0) THEN
-           IRTFLG = 1
-           GOTO 999
-        ENDIF
-
-        IF (IFORM == 1)  THEN
-C          IMAGE
-           WRITE(NOUT,"(A,I0,A,I0)")
-     &                '  Dimensions used: ',N2X,' x ',N2Y
-
-           CALL FQ2(IOPT, PARM1,PARM2,PARM3,BFPS, BB, 
-     &              LSD,N2X,N2Y, NX,NY, IRTFLG)
-        ELSE
-C          VOLUME
-           WRITE(NOUT,"(A,I0,A,I0,A,I0)") 
-     &           '  Dimensions used: ',N2X,' x ',N2Y,' x ',N2Z
-
-           CALL FQ3(IOPT, PARM1,PARM2,PARM3,BFPS, BB, 
-     &              LSD,N2X,N2Y,N2Z, NX,NY,NZ, IRTFLG)
-        ENDIF
-
-C       OPEN OUTPUT FILE
-        MAXIM = 0
-        ITYPE = IFORM
-
-        IF (WANTFOU) THEN
-           IF (IFORM == 1)  THEN
-C             NON-FOURIER IMAGE
-              ITYPE = -11
-              IF (MOD(NX,2) == 0)   ITYPE = -12
-           ELSEIF (IFORM == 3)  THEN
-C             NON-FOURIER VOLUME
-              ITYPE = -21
-              IF (MOD(NX,2) == 0)  ITYPE = -22
-           ENDIF
-
-           CALL OPFILEC(LUN1,.FALSE.,FILNAM,LUN2,'U',ITYPE,N2X,N2Y,N2Z,
-     &                  MAXIM,' ',.TRUE.,IRTFLG)
-           IF (IRTFLG. NE. 0) GOTO 999
-
-C          STORE FILTERED FFT
-           CALL WRTVOL(LUN2,N2X,N2Y,1,N2Z,BB,IRTFLG) 
-           GOTO 999
-
-        ENDIF
-
-        CALL OPFILEC(LUN1,.FALSE.,FILNAM,LUN2,'U',ITYPE,NX,NY,NZ,
-     &               MAXIM,' ',.FALSE.,IRTFLG)
-        IF (IRTFLG. NE. 0) GOTO 999
-
-
-C       INVERSE FFT,  POSSIBLY PADDED
-        INV = -1         ! INVERSE FFT
-        CALL FMRS(BB, N2X,N2Y,N2Z, 0.0D0, .TRUE.,.TRUE.,INV,IRTFLG)
-        IF (INV == 0) THEN
-           CALL ERRT(101,'USING FFTW',NE)
-           GOTO 999 
-        ENDIF
-
-        !write(6,*) ' sum3:',sum(bb(1:nx, 1:ny, 1))
-
-C       STORE FILTERED IMAGE
-        IRECT = 1
-        DO K=1,NZ
-           DO J=1,NY
- 	      CALL WRTLIN(LUN2,BB(1,J,K),NX,IRECT)
-              IRECT = IRECT + 1
-           ENDDO
-	ENDDO
-
-999     IF (ALLOCATED(BB)) DEALLOCATE(BB)
-
-        CLOSE(LUN1)
-        CLOSE(LUN2)
-       
-        END
-
-
-
-C++*********************************************************************
-C
-C FQ2.F                                         12/22/94  
-C                RDPRAF REMOVED                 DEC 2005 ARDEAN LEITH 
-C                COSINE FILTER                  JUL 2012 G. KISHCHENKO 
-C                INCORE WITHOUT LUNS            OCT 2012 ARDEAN LEITH 
-C                FREQ + PIXELS                  NOV 2012 G. KISHCHENKO 
-C                PARM2 BUG                      DEC 2012 ARDEAN LEITH 
-C                FREQ UNIT CUTOFF = 1           AUG 2013 ARDEAN LEITH 
-C                RAISED SINC                    FEB 2014 ARDEAN LEITH 
-C                FROM FQ_Q                      NOV 2014 ARDEAN LEITH 
-C        
-C **********************************************************************
-C=*                                                                    *
-C=* This file is part of:   SPIDER - Modular Image Processing System.  *
-C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2014, Health Research Inc.,                         *
-C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@wadsworth.org                                        *
-C=*                                                                    *
-C=* SPIDER is free software; you can redistribute it and/or            *
-C=* modify it under the terms of the GNU General Public License as     *
-C=* published by the Free Software Foundation; either version 2 of the *
-C=* License, or (at your option) any later version.                    *
-C=*                                                                    *
-C=* SPIDER is distributed in the hope that it will be useful,          *
-C=* but WITHOUT ANY WARRANTY; without even the implied warranty of     *
-C=* merchantability or fitness for a particular purpose.  See the GNU  *
-C=* General Public License for more details.                           *
-C=* You should have received a copy of the GNU General Public License  *
-C=* along with this program. If not, see <http://www.gnu.org/licenses> *
-C=*                                                                    *
-C **********************************************************************
-C
-C FQ2(IOPT,PARM1,PARM2,PARM3,BFPS,B, LSD,N2X,N2Y, NX,NY, IRTFLG)
-C
-C PURPOSE: QUICK FILTERING OF REAL-SPACE IMAGE FILE BY FFT
-C
-C PARAMETERS:
-C        IOPT          TYPE OF FILTER
-C        PARM1..       FILTER PARAMETERS
-C        BFPS          FILTER PARAMETERS
-C        B             BUFFER 
-C        LSD           X DIMENSION OF FOURIER FILE
-C        NX,NY         DIMENSIONS OF REAL-SPACE FILE
-C        N2X,N2Y       DIMENSIONS OF PADDED FILE
-C
-C23456789012345678901234567890123456789012345678901234567890123456789012  
-C--*******************************************************************
-
-        SUBROUTINE FQ2(IOPT, PARM1,PARM2,PARM3,BFPS, 
-     &                  B, LSD,N2X,N2Y, NX,NY, IRTFLG)
-        
-        IMPLICIT NONE
-        INCLUDE 'CMBLOCK.INC'
-
-        INTEGER            :: IOPT      
-        REAL               :: PARM1,PARM2,PARM3
-        REAL               :: BFPS(4)
-        REAL               :: B(LSD,N2Y)
-        INTEGER            :: LSD,N2X,N2Y
-        INTEGER            :: NX,NY,IRTFLG
-
-        REAL               :: ZEROTERM
-        REAL               :: ORD,PARM1SQ,PARM2SQ
-
-        REAL               :: X1,Y1
-        REAL               :: F,F2,FPE,FSE,ORDT,PARMT,FSQ,EXPCORR
-        INTEGER            :: J,I,IX,IY, NR2
-        
-        REAL, PARAMETER    :: PI  = 3.14159265358979323846
-        REAL, PARAMETER    :: EPS = 0.882
-
-        NR2     = N2Y / 2
-        X1      = FLOAT(N2X/2)**2
-        Y1      = FLOAT(NR2)  **2
-
-        ORD     = PARM3       ! FOR BUTTERWORTH FILTER
-        PARM1SQ = PARM1**2
-        PARM2SQ = PARM2**2
-      
-
-C       KEEP ZERO TERM FOR HIGH PASS OPTIONS
-        ZEROTERM = B(1,1)
-
-        !write(6,*) ' sum1:',sum(b(1:n2x, 1:n2y)),zeroterm
-
-c$omp  parallel do private(j,i,iy,ix,f,f2,fpe,fse,ordt,parmt,
-c$omp&                     fsq,expcorr)
-        DO J=1,N2Y
-
-           IY = (J-1)
-           IF (IY > NR2) IY = IY - N2Y
-
-           DO I=1,LSD,2
-
-              IX = (I-1) / 2
-
-              IF (IOPT == 1) THEN
-C                LOWPASS *************************************
-
-                 IF (0.25 * (FLOAT(IX*IX)/X1/PARM1SQ +
-     &                       FLOAT(IY*IY)/Y1/PARM2SQ) > 1.0) THEN
-
-                    B(I,  J) = 0.0
-                    B(I+1,J) = 0.0
-                 ENDIF
-
-              ELSEIF (IOPT == 2) THEN   
-C                HIGH PASS ***********************************
-
-                 IF ( (IX.NE.0 .OR. IY.NE.0) .AND.
-     &                0.25 * (FLOAT(IX*IX)/X1/PARM1SQ + 
-     &                        FLOAT(IY*IY)/Y1/PARM2SQ) <= 1.0) THEN
-
-                    B(I,  J) = 0.0
-                    B(I+1,J) = 0.0
-                 ENDIF
-
-              ELSEIF(IOPT == 3)  THEN
-C                GAUSSIAN LOW PASS ***************************
-
-                 F = 0.125 * (FLOAT(IX*IX)/X1/PARM1SQ +
-     &                        FLOAT(IY*IY)/Y1/PARM2SQ)
-
-                 IF (F < 16.0)  THEN
-                    F        = EXP(-F)
-                    B(I,  J) = B(I,  J) * F
-                    B(I+1,J) = B(I+1,J) * F
-                 ELSE
-                    B(I,  J) = 0.0
-                    B(I+1,J) = 0.0
-                 ENDIF
-
-              ELSEIF (IOPT==4)  THEN    
-C                GAUSSIAN HIGH PASS **************************
-
-                 IF (IX .NE. 0 .OR. IY .NE. 0)  THEN
-                    F = 0.125 * (FLOAT(IX*IX)/X1/PARM1SQ +
-     &                           FLOAT(IY*IY)/Y1/PARM2SQ)
-
-                    IF (F < 16.0)  THEN
-                       F        = 1.0 - EXP(-F)
-                       B(I,  J) = B(I,  J) * F
-                       B(I+1,J) = B(I+1,J) * F
-                    ENDIF
-                 ENDIF
-
-              ELSEIF (IOPT == 5 .OR. IOPT == 6)  THEN
-C                FERMI DISTRIBUTION FILTER *******************
-              
-                 F = (0.5 * SQRT(FLOAT(IX*IX)/X1 +
-     &                           FLOAT(IY*IY)/Y1) - PARM1) / PARM3
-
-                 F        = AMIN1(AMAX1(F,-10.0), 10.0)
-                 F        = (1.0/(1.0 + EXP(F)))
-
-                 B(I,  J) = B(I,  J) * F
-                 B(I+1,J) = B(I+1,J) * F
-
-              ELSEIF (IOPT == 7) THEN
-C                BUTTERWORTH LOWPASS FILTER ******************
-
-                 F        = 0.5 * SQRT(FLOAT(IX*IX)/X1 +
-     &                                 FLOAT(IY*IY)/Y1)
-
-                 F        = SQRT(1.0 / (1.0 + (F/PARM1)**ORD))
-
-                 B(I,J)   = B(I,  J) * F
-                 B(I+1,J) = B(I+1,J) * F
-
-              ELSEIF (IOPT == 8) THEN
-C                BUTTERWORTH HIGHPASS FILTER *****************
-        
-                 IF (IX.NE.0 .OR. IY.NE. 0) THEN
-                    F = 0.5 * SQRT(FLOAT(IX*IX)/X1 +
-     &                             FLOAT(IY*IY)/Y1)
-
-                    F = (1.0 - SQRT(1.0 / (1.0+(F/PARM1)**ORD)))
-
-                    B(I,  J) = B(I,  J) * F
-                    B(I+1,J) = B(I+1,J) * F
-                 ENDIF
-
-
-              ELSEIF (IOPT == 9) THEN
-C                RAISED COSINE LOWPASS FILTER ******************
-
-                 F = 0.5 * SQRT(FLOAT(IX*IX)/X1 +
-     &                          FLOAT(IY*IY)/Y1)
-
-                 F = (F - PARM1) / (PARM2 - PARM1)
-
-                 IF (F < 0) THEN
-                    F2 = 1
-                 ELSEIF (F > 1) THEN
-                    F2 = 0
-                 ELSE
-                    F2 = 0.5 * (1 + COS(PI*F))
-                 ENDIF
-
-                 B(I,  J) = B(I,  J) * F2
-                 B(I+1,J) = B(I+1,J) * F2
-
-              ELSEIF (IOPT == 10) THEN
-C                RAISED COSINE HIGHPASS FILTER ******************
-
-                 F = 0.5 * SQRT(FLOAT(IX*IX)/X1 +
-     &                          FLOAT(IY*IY)/Y1)
-
-                 F = (F - PARM1) / (PARM2 - PARM1)
-
-                 IF (F < 0) THEN
-                    F2 = 0
-                 ELSEIF (F > 1) THEN
-                    F2 = 1
-                 ELSE
-                    F2 = 0.5 * (1 - COS(PI*F))
-                 ENDIF
-
-                 B(I,  J) = B(I,  J) * F2
-                 B(I+1,J) = B(I+1,J) * F2
-
-              ELSEIF (IOPT == 11) THEN 
-C                BUTTERWORTH ELLIPTIC LOWPASS FILTER *********  
-C                CALCULATE EFFECTIVE FP AND FS IN A GIVEN 
-C                DIRECTION ON THE PLANE
-
-                 IF (IX.NE.0 .OR. IY.NE.0) THEN
-
-                    FPE = ATAN2(BFPS(1)*SQRT(FLOAT(IY*IY)/Y1),
-     &                          BFPS(3)*SQRT(FLOAT(IX*IX)/X1))
-                    FPE = SQRT((BFPS(1)*COS(FPE))**2 + 
-     &                         (BFPS(3)*SIN(FPE))**2)
-
-                    FSE = ATAN2(BFPS(2)*SQRT(FLOAT(IY*IY)/Y1),
-     &                          BFPS(4)*SQRT(FLOAT(IX*IX)/X1))
-                    FSE = SQRT((BFPS(2)*COS(FSE))**2 + 
-     &                         (BFPS(4)*SIN(FSE))**2)
-
-                    ORDT     = ORD  /ALOG10(FPE / FSE)
-                    PARMT    = FPE/ EPS**(2. / ORDT)
-
-                    F        = 0.5*SQRT(FLOAT(IX*IX)/X1+FLOAT(IY*IY)/Y1)
-                    F        = SQRT(1.0 / (1.0 + (F/PARMT)**ORDT))
-
-                    B(I,  J) = B(I,  J) * F
-                    B(I+1,J) = B(I+1,J) * F
-                 ENDIF
-
-              ELSEIF (IOPT == 12) THEN
-C                BUTTERWORTH ELLIPTIC HIGHPASS FILTER ********* 
-
-                 IF (IX .NE. 0 .OR. IY.NE. 0) THEN
-
-                    FPE = ATAN2(BFPS(1)*SQRT(FLOAT(IY*IY)/Y1),
-     &                          BFPS(3)*SQRT(FLOAT(IX*IX)/X1))
-                    FPE = SQRT((BFPS(1)*COS(FPE))**2 +
-     &                         (BFPS(3)*SIN(FPE))**2)
-
-                    FSE = ATAN2(BFPS(2)*SQRT(FLOAT(IY*IY)/Y1),
-     &                          BFPS(4)*SQRT(FLOAT(IX*IX)/X1))
-                    FSE = SQRT((BFPS(2)*COS(FSE))**2 + 
-     &                         (BFPS(4)*SIN(FSE))**2)
-
-                    ORDT     = ORD / ALOG10(FPE / FSE)
-                    PARMT    = FPE / (EPS)**(2. / ORDT)
-
-                    F        = 0.5*SQRT(FLOAT(IX*IX)/X1+FLOAT(IY*IY)/Y1)
-                    F        = (1.0-SQRT(1.0/(1.0+(F/PARMT)**ORDT)))
-
-                    B(I,  J) = B(I,  J) * F
-                    B(I+1,J) = B(I+1,J) * F
-                 ENDIF
-
-              ELSEIF (IOPT == 13) THEN
-C                RAISED SINC WINDOW **************************
-                 F = 0.5 * SQRT(FLOAT(IX*IX)/X1/PARM1SQ +
-     &                          FLOAT(IY*IY)/Y1/PARM2SQ)
-
-                 IF (F <= 0.0001) THEN
-                    F2 = 1
-                 ELSEIF (F >= 1.0) THEN
-                    F2 = 0
-                 ELSE
-                    F2 = SIN(PI*F) / (PI*F)
-                 ENDIF
-
-                 B(I,  J) = B(I,  J) * (1 + 9 * F2)
-                 B(I+1,J) = B(I+1,J) * (1 + 9 * F2)
-
-              ELSEIF (IOPT == 14) THEN
-C                B FACTOR FILTER **************************
-
-                 FSQ = (FLOAT(IX*IX) / X1 + 
-     &                  FLOAT(IY*IY) / Y1) * 0.25
-
-                 IF (FSQ < PARM3)  THEN
-                    EXPCORR  = EXP(FSQ * PARM1)
-
-                    B(I,  J) = B(I,  J) * PARM2 * EXPCORR
-                    B(I+1,J) = B(I+1,J) * PARM2 * EXPCORR
-                 ENDIF
-
-              ENDIF
-           ENDDO
-        ENDDO
-
-C       RESTORE ZERO TERM FOR HIGH PASS OPTIONS
-        IF (IOPT == 2 .OR. IOPT == 4 .OR. 
-     &      IOPT == 6 .OR. IOPT == 8)     B(1,1) = ZEROTERM
-
-        !write(6,*) ' sum2:',sum(b(1:n2x, 1:n2y))
-
-        IRTFLG = 0
-
-        END
-
-
-
-
-
-
-
-
-C++*********************************************************************
-C
-C FQ_3.F                                        12/22/94  
-C                RDPRAF REMOVED                 DEC 2005 ARDEAN LEITH 
-C                COSINE FILTER                  JUL 2012 G. KISHCHENKO 
-C                INCORE WITHOUT LUNS            OCT 2012 ARDEAN LEITH 
-C                FREQ + PIXELS                  NOV 2012 G. KISHCHENKO 
-C                PARM2 BUG                      DEC 2012 ARDEAN LEITH 
-C                FREQ UNIT CUTOFF = 1           AUG 2013 ARDEAN LEITH 
-C                RAISED SINC                    FEB 2014 ARDEAN LEITH 
-C                FROM FQ_Q                      NOV 2014 ARDEAN LEITH 
-C                VOLUME Z1 FILTER BUG           MAY 2017 ARDEAN LEITH    
-C        
-C **********************************************************************
-C=*                                                                    *
-C=* This file is part of:   SPIDER - Modular Image Processing System.  *
-C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2017, Health Research Inc.,                         *
-C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@wadsworth.org                                        *
-C=*                                                                    *
-C=* SPIDER is free software; you can redistribute it and/or            *
-C=* modify it under the terms of the GNU General Public License as     *
-C=* published by the Free Software Foundation; either version 2 of the *
-C=* License, or (at your option) any later version.                    *
-C=*                                                                    *
-C=* SPIDER is distributed in the hope that it will be useful,          *
-C=* but WITHOUT ANY WARRANTY; without even the implied warranty of     *
-C=* merchantability or fitness for a particular purpose.  See the GNU  *
-C=* General Public License for more details.                           *
-C=* You should have received a copy of the GNU General Public License  *
-C=* along with this program. If not, see <http://www.gnu.org/licenses> *
-C=*                                                                    *
-C **********************************************************************
-C
-C FQ_3(IOPT,PARM1,PARM2,PARM3,BFPS, B, LSD,N2X,N2Y, NX,NY, IRTFLG)
-C
-C PURPOSE: QUICK FILTERING OF REAL-SPACE IMAGE FILE BY FFT
-C
-C PARAMETERS:
-C        IOPT          TYPE OF FILTER
-C        PARM1..       FILTER PARAMETERS
-C        BFPS          FILTER PARAMETERS
-C        B             BUFFER 
-C        LSD           X DIMENSION OF FOURIER FILE
-C        NX,NY,NZ      DIMENSIONS OF REAL-SPACE FILE
-C        N2X,N2Y,N2Z   DIMENSIONS OF PADDED FILE
-C
-C23456789012345678901234567890123456789012345678901234567890123456789012  
-C--*******************************************************************
-
-        SUBROUTINE FQ3(IOPT, PARM1,PARM2,PARM3,BFPS, 
-     &                  B, LSD,N2X,N2Y,N2Z, NX,NY,NZ, IRTFLG)
-        
-        IMPLICIT NONE
-        INCLUDE 'CMBLOCK.INC'
-
-        INTEGER            :: IOPT       
-        REAL               :: PARM1,PARM2,PARM3
-        REAL               :: BFPS(4)
-        REAL               :: B(LSD,N2Y,N2Z)
-        INTEGER            :: LSD,N2X,N2Y,N2Z
-        INTEGER            :: NX,NY,NZ,IRTFLG
-
-        REAL               :: ORD,PARM1SQ,PARM2SQ
-
-        REAL               :: X1,Y1,Z1
-        REAL               :: F,F2,FPE,FSE,ORDT,PARMT,FSQ,EXPCORR
-        REAL               :: ZEROTERM
-        INTEGER            :: K,J,I, IX,IY,IZ, NR2,NL2
-        
-        REAL, PARAMETER    :: PI  = 3.14159265358979323846
-        REAL, PARAMETER    :: EPS = 0.882
-
-        NR2     = N2Y / 2
-        NL2     = N2Z / 2
-
-        X1      = FLOAT(N2X/2)**2
-        Y1      = FLOAT(NR2)  **2
-        Z1      = FLOAT(NL2)  **2
-
-        ORD     = PARM3
-        PARM1SQ = PARM1**2
-        PARM2SQ = PARM2**2
-      
-
-        IF (IOPT == 11 .OR. IOPT == 12) THEN 
-C          BUTTERWORTH ELLIPTIC LOWPASS FILTER *********       
-C          BUTTERWORTH ELLIPTIC HIGHPASS FILTER *********      
-           CALL ERRT(101,
-     &        'OPTION NOT IMPLEMENTED FOR VOLUMES',IOPT)
-           RETURN
-        ENDIF
-
-C       KEEP ZERO TERM FOR HIGH PASS OPTIONS
-        ZEROTERM = B(1,1,1)
-
-c$omp   parallel do private(i,j,k,ix,iy,iz,f,f2,fpe,fse,ordt,parmt,
-c$omp&                      fsq,expcorr)
-      
-        DO K=1,N2Z
-
-           IZ = (K-1)
-           IF (IZ > NR2) IZ = IZ - N2Z
-
-           DO J=1,N2Y
-              IY = (J-1)
-              IF (IY > NR2) IY = IY - N2Y
-
-              DO I=1,LSD,2
-                 IX = (I-1) / 2
-
-                 IF (IOPT == 1) THEN
-C                   LOWPASS *************************************
-                    IF (0.25 * (FLOAT(IX*IX)/X1/PARM1SQ +
-     &                          FLOAT(IY*IY)/Y1/PARM2SQ +
-     &                          FLOAT(IZ*IZ)/Z1/PARM2SQ) > 1.0) THEN
-
-                       B(I,  J,K) = 0.0
-                       B(I+1,J,K) = 0.0
-                    ENDIF
-
-                 ELSEIF (IOPT == 2) THEN        
-C                   HIGH PASS ***********************************
-                    IF ( (IX.NE.0 .OR. IY .NE.0 .OR. IZ .NE. 0) .AND.
-     &                 0.25 * (FLOAT(IX*IX)/X1/PARM1SQ + 
-     &                         FLOAT(IY*IY)/Y1/PARM2SQ +
-     &                         FLOAT(IZ*IZ)/Z1/PARM2SQ) <= 1.0) THEN
-
-                       B(I,  J,K) = 0.0
-                       B(I+1,J,K) = 0.0
-                    ENDIF
-
-                 ELSEIF(IOPT == 3)  THEN
-C                   GAUSSIAN LOW PASS ***************************
-                    F = 0.125 * (FLOAT(IX*IX)/X1/PARM1SQ +
-     &                           FLOAT(IY*IY)/Y1/PARM2SQ +
-     &                           FLOAT(IZ*IZ)/Z1/PARM2SQ)
-
-                    IF (F < 16.0)  THEN
-                       F           = EXP(-F)
-                       B(I,  J,K) = B(I,  J,K) * F
-                       B(I+1,J,K) = B(I+1,J,K) * F
-                    ELSE
-                       B(I,  J,K) = 0.0
-                       B(I+1,J,K) = 0.0
-                    ENDIF
-
-                 ELSEIF (IOPT==4)  THEN 
-C                   GAUSSIAN HIGH PASS **************************
-
-                    IF (IX .NE. 0 .OR. IY .NE. 0 .OR. IZ .NE. 0)THEN
-                       F = 0.125 * (FLOAT(IX*IX)/X1/PARM1SQ +
-     &                              FLOAT(IY*IY)/Y1/PARM2SQ +
-     &                              FLOAT(IZ*IZ)/Z1/PARM2SQ)
-
-                       IF (F < 16.0)  THEN
-                          F          = 1.0 - EXP(-F)
-                          B(I,  J,K) = B(I,  J,K) * F
-                          B(I+1,J,K) = B(I+1,J,K) * F
-                       ENDIF
-                    ENDIF
-
-                 ELSEIF (IOPT == 5 .OR. IOPT == 6)  THEN
-C                   FERMI DISTRIBUTION FILTER *******************
-              
-                    F = (0.5 * SQRT(FLOAT(IX*IX)/X1 +
-     &                              FLOAT(IY*IY)/Y1 +
-     &                              FLOAT(IZ*IZ)/Z1)-PARM1) / PARM3
-
-                    F        = AMIN1(AMAX1(F,-10.0), 10.0)
-                    F        = 1.0 / (1.0 + EXP(F))
-
-                    B(I,  J,K) = B(I,  J,K) * F
-                    B(I+1,J,K) = B(I+1,J,K) * F
-
-                 ELSEIF (IOPT == 7) THEN
-C                   BUTTERWORTH LOWPASS FILTER ******************
-
-                    F        = 0.5 * SQRT(FLOAT(IX*IX)/X1 +
-     &                                    FLOAT(IY*IY)/Y1 +
-     &                                    FLOAT(IZ*IZ)/Z1)
-
-                    F           = SQRT(1.0/ (1.0 + (F / PARM1)**ORD) )
-
-                    B(I,  J,K) = B(I,  J,K) * F
-                    B(I+1,J,K) = B(I+1,J,K) * F
-
-                 ELSEIF (IOPT == 8) THEN
-C                   BUTTERWORTH HIGHPASS FILTER *****************
-        
-                    IF (IX.NE.0 .OR. IY.NE. 0 .OR. IZ.NE. 0) THEN
-                       F = 0.5 * SQRT(FLOAT(IX*IX)/X1 +
-     &                                FLOAT(IY*IY)/Y1 +
-     &                                FLOAT(IZ*IZ)/Z1)
-   
-                       F = 1.0 - SQRT(1.0/ (1.0 + (F / PARM1)**ORD))
-
-                       B(I,  J,K) = B(I,  J,K) * F
-                       B(I+1,J,K) = B(I+1,J,K) * F
-                    ENDIF
-
-
-                 ELSEIF (IOPT == 9) THEN
-C                   RAISED COSINE LOWPASS FILTER ******************
-
-                    F = 0.5 * SQRT(FLOAT(IX*IX)/X1 +
-     &                             FLOAT(IY*IY)/Y1 +
-     &                             FLOAT(IZ*IZ)/Z1)
-
-C                   F = (F-FP) / (FS-FP)
-                    F = (F-PARM1) / (PARM2 - PARM1)
-
-                    IF (F < 0) THEN
-                       F2 = 1
-                    ELSEIF (F > 1) THEN
-                       F2 = 0
-                    ELSE
-                       F2 = 0.5 * (1 + COS(PI*F))
-                    ENDIF
-
-                    B(I,  J,K) = B(I,  J,K) * F2
-                    B(I+1,J,K) = B(I+1,J,K) * F2
-
-                 ELSEIF (IOPT == 10) THEN
-C                   RAISED COSINE HIGHPASS FILTER ******************
-
-                    F = 0.5 * SQRT(FLOAT(IX*IX)/X1 +
-     &                             FLOAT(IY*IY)/Y1 +
-     &                             FLOAT(IZ*IZ)/Z1)
-
-                    F = (F-PARM1) / (PARM2 - PARM1)
-
-                    IF (F < 0) THEN
-                       F2 = 0
-                    ELSEIF (F > 1) THEN
-                       F2 = 1
-                    ELSE
-                       F2 = 0.5 * ( 1 - COS(PI * F))
-                    ENDIF
-
-                    B(I,  J,K) = B(I,  J,K) * F2
-                    B(I+1,J,K) = B(I+1,J,K) * F2
-
-                 ELSEIF (IOPT == 13) THEN
-C                   RAISED SINC WINDOW **************************
-
-                    F = 0.5 * SQRT(FLOAT(IX*IX)/X1/PARM1SQ +
-     &                             FLOAT(IY*IY)/Y1/PARM2SQ +
-     &                             FLOAT(IZ*IZ)/Z1/PARM2SQ)
-
-                    IF (F <= 0.0001) THEN
-                       F2 = 1
-                    ELSEIF (F >= 1.0) THEN
-                       F2 = 0
-                    ELSE
-                       F2 = SIN(PI * F) / (PI * F)
-                    ENDIF
-   
-                    B(I,  J,K) = B(I,  J,K) * (1 + 9 * F2)
-                    B(I+1,J,K) = B(I+1,J,K) * (1 + 9 * F2)
-   
-                 ELSEIF (IOPT == 14) THEN
-C                   B FACTOR FILTER **************************
-
-                    FSQ = (FLOAT(IX*IX) / X1 + 
-     &                     FLOAT(IY*IY) / Y1 +
-     &                     FLOAT(IZ*IZ) / Z1) * 0.25
-      
-                    IF (FSQ < PARM3)  THEN
-                       EXPCORR    = EXP(FSQ * PARM1)
-
-                       B(I,J,K)   = B(I,J,K)  * PARM2 * EXPCORR
-                       B(I+1,J,K) = B(I+1,J,K)* PARM2 * EXPCORR
-                    ENDIF
-
-                 ENDIF
-              ENDDO
-           ENDDO
-        ENDDO
-
-C       RESTORE ZERO TERM FOR HIGH PASS OPTIONS
-        IF (IOPT == 2 .OR. IOPT == 4 .OR. 
-     &      IOPT == 6 .OR. IOPT == 8) 
-     &     B(1,1,1) = ZEROTERM
-
-        IRTFLG = 0
-
-        END
-
-
-C  B FACTOR FOR 64X64 IMAGE (INCREASES AMPLITUDES NEAR ORIGIN)
-C    X1 = (NX/2)*2 = 32
-C
-C    IX     FSQ      B*FSQ
-C     1     1/1024   B/1024
-C    64     1/16     B/16
-
-
-
-
diff --git src/getdefocus.f src/getdefocus.f
index cb7f36e7..c68b4a65 100644
--- src/getdefocus.f
+++ src/getdefocus.f
@@ -1,5 +1,7 @@
 C **********************************************************************
 C *  GETDEFOCUS.F
+C *  THIS CODE IS A MESS!  SEGFAULTS and COMPILER ERRORS!! 
+C *  I ABANDONED TRYING TO FIX IT! al
 C=**********************************************************************
 C=* From: SPIDER - MODULAR IMAGE PROCESSING SYSTEM                     *
 C=* Copyright (C)2002, L. Joyeux & P. A. Penczek                       *
@@ -45,6 +47,9 @@ CC==X is X coordinates!
       	REAL       VALUE(NUMBER), ENV(NUMBER), VALUE2(NUMBER),X(NUMBER)
       	REAL      PS, CS, LAMBDA, CONTRAST, DZLOW1, DZHIGH1, DZINC, DZ
      	 REAL      DZLOW, DZHIGH,XXX,XSCORE
+
+C        GFORT WILL NOT ACCEPT REAL PARAMETERS FOR LOOPING   Sept 2025 al
+      	INTEGER      IDZLOW, IDZHIGH,IDZINC, IDZ
       	REAL      GETDEFOCUS
 	COMMON /SEARCH_RANGE/ DZLOW1,DZHIGH1,NMB
       	INTEGER          I, J, L, ISTART,ISTOP,ISWI
@@ -61,16 +66,25 @@ CC==X is X coordinates!
         ENDIF
 
         DO
-           DO DZ = DZLOW, DZHIGH, DZINC
+C           GFORT WILL NOT ACCEPT REAL PARAMETERS FOR LOOPING   Sept 2025 al
+            IDZLOW  = DZLOW    ! buggy change of limits ,,, redefined below al
+	    IDZHIGH = DZHIGH 
+	    IDZINC  = DZINC
+	    
+            DO IDZ  = IDZLOW, IDZHIGH, IDZINC
+	      DZ    = IDZ
+	      
               CALL CTF_SIGNAL1(VALUE,X,NUMBER, PS, CS, 
      &                      LAMBDA, DZ, CONTRAST)
 
               IF (ISWI.EQ.0) THEN
                   DO L = ISTART, ISTOP
-                     DIFF=DIFF+(VALUE(L)*DBLE(VALUE(L))*ENV(L)-
-CCC=CHECK ENVELOPE EFFECT
-C		DIFF=DIFF+(VALUE(L)*DBLE(VALUE(L))-
-     &                    DBLE(VALUE2(L)))**2
+		  
+CCC                     DIFF=DIFF+(VALUE(L)*DBLE(VALUE(L))*ENV(L)-
+CCC=CHECK ENVELOPE EFFECT  was buggy?? sept 2025
+
+ 		        DIFF = DIFF+(VALUE(L)*DBLE(VALUE(L))-
+     &                      DBLE(VALUE2(L)))**2
                   ENDDO
                   IF (DIFF<DIFFMIN .OR. DZ .EQ. DZLOW) THEN
                      GETDEFOCUS = DZ
diff --git src/getfilenum.f src/getfilenum.f
index 458814cf..2a635eb1 100644
--- src/getfilenum.f
+++ src/getfilenum.f
@@ -3,13 +3,14 @@ C++*********************************************************************
 C
 C GETFILENUM.F  -- NEW JAN 1999                   AUTHOR: ARDEAN LEITH
 C                  EXTRACTED FROM LUNSETHDR AUG 02 ARDEAN LEITH
+C
 C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@wadsworth.org                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -23,43 +24,53 @@ C=* General Public License for more details.                           *
 C=* You should have received a copy of the GNU General Public License  *
 C=* along with this program. If not, see <http://www.gnu.org/licenses> *
 C=*                                                                    *
-C *******************************************************************C **********************************************************************
-C
+C **********************************************************************
 C
-C    GETFILENUM(FILNAM,IMGNUM,CALLERRT,IRTFLG)  
+C    GETFILENUM(FILNAM,IMGNUM,NDIGITS,CALLERRT,IRTFLG)  
 C
 C    PURPOSE:    FINDS FILE NUMBER AT END OF FILENAME
 C    
-C    PARAMETERS:     FILNAM    CHAR. VARIABLE FILE NAME         (SENT)
-C                    IMGNUM    NUMBER IN FILE NAME               (RET.)
-C                    NDIGITS   NUMBER OF DIGITS                  (RET.)
-C                    CALLERRT  CALL ERRT IF ERROR               (SENT)
-C                    IRTFLG    ERROR FLAG                       (RET.)
+C    PARAMETERS: FILNAM    CHAR. VARIABLE FILE NAME             (SENT)
+C                IMGNUM    NUMBER IN FILE NAME                   (RET)
+C                NDIGITS   NUMBER OF DIGITS                      (RET)
+C                CALLERRT  CALL ERRT IF ERROR                   (SENT)
+C                IRTFLG    ERROR FLAG                            (RET)
+C
+C    CALLED BY:      deletf.f    filgen.f     openinstk.f 
+C                    openstk.f   to_peaks.f 
 C
 C23456789 123456789 123456789 123456789 123456789 123456789 123456789 12
 C--*********************************************************************
  
        SUBROUTINE GETFILENUM(FILNAM,IMGNUM,NDIGITS,CALLERRT,IRTFLG)
 
+       IMPLICIT  NONE
+
        INCLUDE 'CMBLOCK.INC'
 
-       CHARACTER *(*) FILNAM
-       CHARACTER *1   CHARI
-       LOGICAL        CALLERRT
-    
+       CHARACTER *(*) :: FILNAM
+       LOGICAL        :: CALLERRT
+       INTEGER        :: IMGNUM,NDIGITS,IRTFLG
+
+       CHARACTER *1   :: CHARI
+       INTEGER        :: NLET,IGO,I,NE
+       INTEGER        :: lnblnkn
+
+
 C      FIND NUMBER OF CHAR. IN FILNAM
        NLET   = LNBLNKN(FILNAM)
+
        IGO    = NLET - 1
        IMGNUM = 0
 
 C      EXTRACT IMGNUM FROM FILENAME
        DO I = NLET,1,-1
           CHARI = FILNAM(I:I)
-          IF (CHARI .LT. '0' .OR. CHARI .GT. '9') GOTO 10
+          IF (CHARI .LT. '0' .OR. CHARI .GT. '9') EXIT
           IGO = I 
        ENDDO
 
-10     NDIGITS = NLET - IGO + 1
+       NDIGITS = NLET - IGO + 1
        IF (NDIGITS .LE. 0 .OR. NDIGITS .GT. 10) THEN
 C         NO NUMBER AT END OF FILNAM OR > 10 DIGITS
           IRTFLG = -1
@@ -69,7 +80,8 @@ C         NO NUMBER AT END OF FILNAM OR > 10 DIGITS
        READ(FILNAM(IGO:NLET),'(I10)',ERR=999) IMGNUM
        IRTFLG = 0
        RETURN
-     
+ 
+    
 999    WRITE(NOUT,*) '*** CAN NOT GET FILE NUMBER FROM: ',FILNAM(:NLET)
        IF (CALLERRT) THEN
           CALL ERRT(100,'GETFILENUM',NE)
@@ -80,4 +92,393 @@ C         NO NUMBER AT END OF FILNAM OR > 10 DIGITS
        END
 
 
+C++*********************************************************************
+C
+C GET_FILNAM_NSTK   NEW OCT 2005                 OCT 2025 ArDean Leith
+C               
+C **********************************************************************
+C=*                                                                    *
+C=* This file is part of:   SPIDER - Modular Image Processing System.  *
+C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
+C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
+C=* Email:                                                             *
+C=*                                                                    *
+C=* SPIDER is free software; you can redistribute it and/or            *
+C=* modify it under the terms of the GNU General Public License as     *
+C=* published by the Free Software Foundation; either version 2 of the *
+C=* License, or (at your option) any later version.                    *
+C=*                                                                    *
+C=* SPIDER is distributed in the hope that it will be useful,          *
+C=* but WITHOUT ANY WARRANTY; without even the implied warranty of     *
+C=* merchantability or fitness for a particular purpose.  See the GNU  *
+C=* General Public License for more details.                           *
+C=* You should have received a copy of the GNU General Public License  *
+C=* along with this program. If not, see <http://www.gnu.org/licenses> *
+C=*                                                                    *
+C ************************* GET_FILNAM_NSTK ****************************
+C
+C   GET_FILNAM_NSTK(FILNAM,FIL_NOAT, FIL_DIRS,FIL_BASE,FIL_EXT,
+C                   IS_MRC,LOCAST, IS_STK,NSTK_FLG, IRTFLG)
+C
+C   PURPOSE:    FINDS STACKED IMG  NUMBER IN FILENAME
+C    
+C   PARAMETERS: FILNAM     CHAR. VARIABLE FILE NAME            (SENT)
+C               FIL_NOAT   CHAR. VARIABLE FILE NAME             (RET)
+C               FIL_DIRS   CHAR. VARIABLE FILE NAME             (RET)
+C               FIL_BASE   CHAR. VARIABLE FILE NAME             (RET)
+C               FIL_EXT    CHAR. VARIABLE FILE NAME             (RET)
+C               IS_MRC     NUMBER IN FILE NAME                  (RET)
+C               LOCAST     LOCATION OF * IN FILE NAME           (RET)
+C               IS_STK     IS A STACK                   (SENT or RET)
+C               NSTK_FLG   STACK IMG NUMBER FROM FILE NAME      (RET)
+C                            -2 :  NOT A STACK   (NO @)
+C                            -1 :  AST IN STACK   
+C                             0 :  BARE STACK
+C                            >1 :  STACKED IMAGE NUMBER
+C
+C               IRTFLG     ERROR FLAG                       (RET.)
+C  
+C     IF PRESENT, EXTRACT STACK FILENAME AND NUMBER e.g. from
+C     056@file.mrcs       or file3321@100.mrcs  or /dir/fileaa@21 or
+C     /dir/fileaa@21.mrcs or /dir/056@file         etc 
+C
+C23456789 123456789 123456789 123456789 123456789 123456789 123456789 12
+C--*********************************************************************
+
+      SUBROUTINE GET_FILNAM_NSTK(FILNAM,
+     &                      FIL_NOAT,FIL_DIRS,FIL_BASE,FIL_EXT,
+     &                      IS_MRC, LOCAST, IS_STK, NSTK_FLG,IRTFLG)
+
+      IMPLICIT NONE
+
+      INCLUDE 'CMBLOCK.INC'
+      INCLUDE 'CMLIMIT.INC'
+
+      CHARACTER(LEN=*)              :: FILNAM,FIL_DIRS,FIL_BASE,FIL_EXT
+      CHARACTER(LEN=*),INTENT(OUT)  :: FIL_NOAT
+      LOGICAL                       :: IS_MRC,IS_STK
+      INTEGER                       :: LOCAST,NSTK_FLG,IRTFLG
+
+      LOGICAL               :: GOT_EXT, IS_MRCS
+      INTEGER               :: LOCAT
+
+      INTEGER               :: LOCSLASH,NLEN,IGO,LOCDOT,IENDB,IASTSB4
+      INTEGER               :: LOCEXT,IERR,NE,IDIGS,ILENT
+      CHARACTER(LEN=1)      :: NULL = CHAR(0)
+ 
+      INTEGER               :: lnblnkn
+
+
+      NLEN = lnblnkn(FILNAM)
+
+C     FIND ENDING LOCATION OF  DIRECTORY(S) IN FILNAM_AT
+      LOCSLASH = INDEX(FILNAM(1:NLEN),'/',BACK=.TRUE.)
+
+C     STRIP OFF DIRECTORY(S)
+      FIL_DIRS = NULL
+      FIL_BASE = NULL
+
+      IF (LOCSLASH > 0) THEN
+          FIL_DIRS = FILNAM(1:LOCSLASH)
+          FIL_BASE = FILNAM(LOCSLASH+1:NLEN) 
+      ENDIF
+
+#if defined (SP_DBUGIO)
+      write(3,*)' In get_filnam_nstk  0000000'
+      write(3,*)' In get_filnam_nstk; locslash:',locslash
+
+      ilent = lnblnkn(filnam)
+      write(3,*)' In get_filnam_nstk; filnam: ',   filnam(1:ilent)
+      ilent = lnblnkn(fil_dirs)
+      write(3,*)' In get_filnam_nstk; fil_dirs: ', fil_dirs(1:ilent)
+#endif
+
+
+C     FIND LOCATION OF EXTENSION IN FILNAM
+      LOCDOT   = INDEX(FILNAM(1:NLEN),'.',BACK=.TRUE.)
+
+C     EXTRACT  EXTENSION FROM FILNAM
+      GOT_EXT  = (LOCDOT > 0)
+
+      FIL_EXT  = NULL
+ 
+      IF (GOT_EXT) THEN
+C        GET FILE EXTENSION
+         FIL_EXT  = FILNAM(LOCDOT+1:NLEN)
+
+C        STRIP OFF EXTENSION FROM FIL_BASE
+         LOCEXT   = INDEX(FIL_BASE,'.',BACK=.TRUE.)
+         FIL_BASE = FIL_BASE(1:LOCEXT-1)
+      ENDIF
+               
+      IS_MRC = .FALSE.
+      IF  ( ( INDEX(FIL_EXT,'mrc') > 0) .OR. 
+     &      ( INDEX(FIL_EXT,'MRC') > 0) ) THEN
+        IS_MRC = .TRUE.
+      ENDIF
+
+      IS_MRCS = .FALSE.
+      IF  ( ( INDEX(FIL_EXT,'mrcs') > 0) .OR. 
+     &      ( INDEX(FIL_EXT,'MRCS') > 0) ) THEN
+        IS_MRC = .TRUE.
+      ENDIF
+
+
+#if defined (SP_DBUGIO)
+      write(3,*)' In get_filnam_nstk; ismrc,ismrcs:', is_mrc,is_mrcs
+ 
+      ilent = lnblnkn(fil_ext)
+      write(3,*)' In get_filnam_nstk; fil_ext: ',  fil_ext(1:ilent) 
+      ilent = lnblnkn(fil_base)
+      write(3,*)' In get_filnam_nstk; fil_base: ', fil_base(1:ilent) 
+#endif
+
+      IENDB   = lnblnkn(FIL_BASE)
+      LOCAT   = INDEX(FIL_BASE(1:IENDB),'@')
+
+#if defined (SP_DBUGIO)
+      write(3,*)' In get_filnam_nstk; iendb,nlen:',iendb,nlen
+      write(3,*)' In get_filnam_nstk; locslash,locdot,locat:',
+     &                                locslash,locdot,locat 
+        
+#endif
+      
+
+      IRTFLG   = 0
+
+      IF (LOCAT <= 0 .AND. (.NOT. IS_MRCS)) THEN
+
+#if defined (SP_DBUGIO)
+         write(3,*)' In get_filnam_nstk  0000000 '      
+#endif
+
+         IS_STK    = .FALSE.
+         FIL_NOAT  = FILNAM
+         NSTK_FLG  = -2   ! NOT A STACK
+         GOTO 999         !RETURN
+
+      ELSEIF (LOCAT <= 0 .AND. IS_MRCS ) THEN
+
+#if defined (SP_DBUGIO)
+         write(3,*)' In get_filnam_nstk  1111111 ' 
+#endif
+
+         IS_STK    = .TRUE.
+         FIL_NOAT  = FILNAM
+         NSTK_FLG  = 1      ! MRCS STACK WITHOUT @
+         GOTO 999           ! RETURN
+
+      ELSEIF (LOCAT == 1 ) THEN
+C        BARESTACK AT START OF FILE BASENAME
+
+#if defined (SP_DBUGIO)
+         write(3,*)'  In GET_FILNAM_NSTK  2222222 '
+#endif
+ 
+         IS_STK    = .TRUE.
+         NSTK_FLG  = 0      ! BARESTACK
+         FIL_BASE  = FIL_BASE(2:IENDB)
+
+         ILENT     = lnblnkn(FIL_NOAT)
+         IF (GOT_EXT) FIL_NOAT = FIL_NOAT(1:ILENT) // '.' // FIL_EXT
+         GOTO 999   
+
+      ELSEIF (LOCAT == IENDB ) THEN
+C        BARESTACK AT END OF FILE BASENAME
+
+#if defined (SP_DBUGIO)
+         write(3,*)' In get_filnam_nstk    3333333 '
+#endif
+
+         IS_STK    = .TRUE.
+         NSTK_FLG  = 0      ! BARESTACK
+         FIL_BASE  = FIL_BASE(1:IENDB-1) // NULL
+
+         ILENT     = lnblnkn(FIL_DIRS)
+         FIL_NOAT  = FIL_DIRS(1:ILENT) // FIL_BASE 
+         ILENT     = lnblnkn(FIL_NOAT)
+         IF (GOT_EXT) FIL_NOAT = FIL_NOAT(1:ILENT) // '.' // FIL_EXT
+         GOTO 999    
+
+      ENDIF
+
+#if defined (SP_DBUGIO)
+      !write(3,*)' In get_filnam_nstk  3333333  to   4444444 '
+#endif
+   
+      IASTSB4 = VERIFY(FIL_BASE(1:LOCAT-1),'*',.TRUE.) 
+      IF ((LOCAT > 1) .AND. (IASTSB4 == 0)) THEN
+C        ONLY '*'s  AT START OF FILE BASENAME
+
+#if defined (SP_DBUGIO)
+         write(3,*)' In get_filnam_nstk 4444444 '
+#endif
+
+         IS_STK    = .TRUE.
+         NSTK_FLG  = -1      ! (*)@
+
+         ILENT     = lnblnkn(FIL_DIRS)
+         FIL_NOAT  = FIL_DIRS(1:ILENT) // FIL_BASE(LOCAT+1:IENDB) 
+
+         ILENT     = lnblnkn(FIL_NOAT)
+         IF (GOT_EXT) FIL_NOAT = FIL_NOAT(1:ILENT) // '.' // FIL_EXT
+         GOTO 999    
+      ENDIF
+
+#if defined (SP_DBUGIO)
+      !write(3,*)' In get_filnam_nstk    4444444 to  5555555 '
+#endif
+
+      IASTSB4 = VERIFY(FIL_BASE(LOCAT+1:IENDB),'*') 
+      IF ((LOCAT > 1) .AND. (IASTSB4 == 0)) THEN
+C        ONLY '*'s  AT END OF FILE BASENAME
+
+#if defined (SP_DBUGIO)
+         !write(3,*)' In get_filnam_nstk   5555555 '
+         !write(3,*)' In get_filnam_nstk; ilent: ',  ilent
+         !write(3,*)' In get_filnam_nstk; iastsb4,locat: ',    iastsb4,locat
+         !write(3,*)' In get_filnam_nstk; fil_base ',fil_base(1:locat)
+#endif
+
+         IS_STK    = .TRUE.
+         NSTK_FLG  = -1       ! @(*)
+
+         !!FIL_BASE  = FIL_BASE(1:LOCAT-1) // NULL
+
+         ILENT     = lnblnkn(FIL_DIRS)
+         FIL_NOAT  = FIL_DIRS(1:ILENT) // FIL_BASE 
+         ILENT     = lnblnkn(FIL_NOAT)
+         IF (GOT_EXT) FIL_NOAT = FIL_NOAT(1:ILENT) // '.' // FIL_EXT
+
+         GOTO 999  
+      ENDIF
+
+
+#if defined (SP_DBUGIO)
+      !write(3,*)' In get_filnam_nstk    5555555   TO  6666666 '
+#endif
+
+      IDIGS = VERIFY(FIL_BASE(1:LOCAT-1),'1234567890') 
+
+      IF ((LOCAT > 1) .AND. (IDIGS == 0)) THEN
+C        ONLY DIGITS  AT START OF FILE BASENAME BEFORE @
+ 
+#if defined (SP_DBUGIO)
+        write(3,*)' In get_filnam_nstk   6666666 '
+#endif
+
+         READ(FIL_BASE(1:LOCAT-1),'(I10)',IOSTAT=IERR) NSTK_FLG
+         IF (IERR .NE. 0) THEN
+             WRITE(NOUT,*)
+     &          '*** CAN NOT GET STK NUMBER FROM: ',FIL_BASE(1:LOCAT)
+             CALL ERRT(100,'GET_FILNAM_NSTK',NE)
+             IRTFLG = 1
+             RETURN
+         ENDIF
+
+         IS_STK    = .TRUE.
+
+         ILENT     = lnblnkn(FIL_DIRS)
+         FIL_NOAT  = FIL_DIRS(1:ILENT) // FIL_BASE(LOCAT+1:)
+ 
+         ILENT     = lnblnkn(FIL_NOAT)
+         IF (GOT_EXT) FIL_NOAT = FIL_NOAT(1:ILENT) // '.' // FIL_EXT
+
+         GOTO 999    !RETURN
+      ENDIF
+
+#if defined (SP_DBUGIO)
+      !write(3,*)' In get_filnam_nstk    6666666 to  7777777  '
+#endif
+
+
+      IDIGS = VERIFY(FIL_BASE(LOCAT+1:IENDB),'1234567890') 
+      IF ((LOCAT < IENDB) .AND. (IDIGS == 0)) THEN
+C        ONLY DIGITS  AT END OF FILE BASENAME AFTER @
+ 
+#if defined (SP_DBUGIO)
+        write(3,*)' In get_filnam_nstk    7777777 '
+        write(3,*)' In get_filnam_nstk; locat,idigs,iendb:',
+     &                                  locat,idigs,iendb
+        ilent = lnblnkn(fil_base)
+        write(3,*)' In get_filnam_nstk; fil_base ', 
+     &                                  fil_base(locat+1:ilent)
+c
+c        write(3,*)' In get_filnam_nstk; fil_base(:locat-1):',
+c     &                                  fil_base(:locat-1)
+c
+c        write(3,*)' In get_filnam_nstk; fil_base(locat+1:iendb) ',
+c     &                                  fil_base(locat+1:iendb)
+c
+c        ilent = lnblnkn(fil_base)
+c        write(3,*)' In get_filnam_nstk; fil_base ', 
+c     &                                  fil_base(locat+1:ilent)
+
+#endif
+
+        READ(FIL_BASE(LOCAT+1:IENDB),'(I10)',IOSTAT=IERR) NSTK_FLG
+
+        IF (IERR .NE. 0) THEN
+            WRITE(NOUT,*)
+     &        '*** CAN NOT GET STK NUMBER FROM: ',FIL_BASE(LOCAT:IENDB)
+            CALL ERRT(100,'get_filnam_nstk',NE)
+            IRTFLG = 1
+            RETURN
+        ENDIF
+
+        IS_STK    = .TRUE.
+
+        ILENT     = lnblnkn(FIL_DIRS)
+        FIL_NOAT  = FIL_DIRS(1:ILENT) // FIL_BASE(1:LOCAT-1)
+ 
+        ILENT     = lnblnkn(FIL_NOAT)
+        IF (GOT_EXT) FIL_NOAT = FIL_NOAT(1:ILENT) // '.' // FIL_EXT
+    
+        GOTO 999    
+ 
+      ENDIF
+
+      write(3,*) '  Should not get to this line!!!!!! '
+
+ 999  CONTINUE
+
+      LOCAST    = INDEX(FIL_NOAT,'*')
+
+#if defined (SP_DBUGIO)
+
+      write(3,*)'  '
+      !ilent = lnblnkn(fil_noat)
+      !write(3,*)' In get_filnam_nstk; lnblnkn fil_noat: ', ilent
+      !ilent = len(fil_noat)
+      !write(3,*)' In get_filnam_nstk; ilent fil_noat: ', ilent
+      !write(3,*)' End get_filnam_nstk; fil_noat: ',    fil_noat(:ilent)
+
+      ilent = lnblnkn(fil_noat)
+      write(3,*)' End get_filnam_nstk; fil_noat: ', fil_noat(1:ilent)
+
+      ilent = lnblnkn(fil_dirs)
+      write(3,*)' End get_filnam_nstk; fil_dirs: ', fil_dirs(1:ilent)
+
+      ilent = lnblnkn(fil_base)
+      write(3,*)' End get_filnam_nstk; fil_base: ', fil_base(1:ilent)
+
+      ilent = lnblnkn(fil_ext)
+      write(3,*)' End get_filnam_nstk; fil_ext:  ', fil_ext(1:ilent)
+
+      write(3,*)' End get_filnam_nstk; locast:   ', locast
+
+      write(3,*)' End get_filnam_nstk; nstk_flg,irtflg: ',
+     &                                 nstk_flg,irtflg
+   
+      write(3,*)' '
+
+
+
+        
+#endif
+
+      END
+
+
 
diff --git src/getlbno.f src/getlbno.f
index 4568855d..b41fa6ad 100644
--- src/getlbno.f
+++ src/getlbno.f
@@ -8,9 +8,9 @@ C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2015  Health Research Inc.,                         *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@wadsworth.org                                        *
+C=* Email: spider@health.ny.gov                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -43,11 +43,18 @@ C--*********************************************************************
         CHARACTER(LEN=80) :: TEMP1
         LOGICAL           :: ISDIGI
 
-        LBNO   = -1
-        IRTFLG = 0
+        INTEGER           :: LBNO,IRTFLG
+        INTEGER           :: NCHAR1,IGO,NCHAR
+
+
+        IRTFLG = 0        ! UNUSED?
+        LBNO   = -1       ! ERROR RETURN
 
 C       FIND LAST NON-BLANK            
         NCHAR1 = lnblnk(STRING)
+        
+C       WHAT IF IT IS ZERO?
+        IF (NCHAR1 .LE. 0) RETURN
 
         TEMP1 = STRING(1:NCHAR1)
         CALL SSUPCAS(TEMP1)
@@ -61,9 +68,13 @@ C       FIND LAST NON-BLANK
            NCHAR = 3
         ENDIF 
 
+        !write(3,*)' In getlbno: igo,temp1,string:', igo, temp1,string
+
         READ(TEMP1(IGO+2:IGO+2+NCHAR-1),8000) LBNO
 8000    FORMAT(I6)
 
+        !write(3,*)' In getlbno: string,lbno:', temp1,string
+
 	END
 
 
diff --git src/getnexttoken.f src/getnexttoken.f
index add04fa5..8f03420f 100644
--- src/getnexttoken.f
+++ src/getnexttoken.f
@@ -12,7 +12,6 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2011  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -323,8 +322,10 @@ C      FILLS TOKENS ARRAY WITH CONSECUTIVE TOKENS FROM A LINE
        IMPLICIT NONE
        INCLUDE 'CMBLOCK.INC'
 
-       CHARACTER(LEN=NLET)      :: RECLIN          ! TOKEN LINE  (SENT)
+
        INTEGER                  :: NLET            ! LINE LENGTH (SENT)
+       CHARACTER(LEN=NLET)      :: RECLIN          ! TOKEN LINE  (SENT)
+
        INTEGER                  :: MAXLENTOK,NTOKSMAX  ! (SENT)
        CHARACTER(LEN=MAXLENTOK) :: TOKENS(NTOKSMAX)! TOKEN FIELDS
        LOGICAL                  :: INSIDE          ! DELIM IS INSIDE (SENT)
@@ -393,7 +394,8 @@ C      WILL PARTITION SUCH FIELDS INTO MULTIPLE TOKENS.
        IMPLICIT NONE
        INCLUDE 'CMBLOCK.INC'
 
-       CHARACTER(LEN=NLET)      :: RECLIN          ! TOKEN LINE  (SENT)
+C       BUGGY 2025??CHARACTER(LEN=NLET)      :: RECLIN          ! TOKEN LINE  (SENT)
+       CHARACTER(LEN=*)      :: RECLIN          ! TOKEN LINE  (SENT)
        INTEGER                  :: NLET            ! LINE LENGTH (SENT)
        INTEGER                  :: MAXLENTOK,NTOKSMAX  ! (SENT)
        CHARACTER(LEN=MAXLENTOK) :: TOKENS(NTOKSMAX)! TOKEN FIELDS
diff --git src/inttochar.f src/inttochar.f
index dbfe92dd..978e628c 100644
--- src/inttochar.f
+++ src/inttochar.f
@@ -2,15 +2,16 @@
 C++*********************************************************************
 C
 C INTTOCHAR.F   -- NEW 7 Jan 99 ArDean Leith
-CC                 AVOIDS SGI'S MEMORY LEAK aug 02 ArDean Leith
-
+C                  AVOIDS SGI'S MEMORY LEAK aug 2002  ArDean Leith
+C                  DEBUG OUTPUT             sep 2025  ArDean Leith
+C
 C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2010  Health Research Inc.,                         *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@wadsworth.org                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -32,8 +33,8 @@ C    PURPOSE:       CONVERT INTEGER TO A CHARACTER STRING
 C
 C    PARAMETERS:
 C        NUMBER     INTEGER NUMBER                                (SENT)
-C        STRING     OUTPUT STRING                                 (SENT) 
-C        NLET       NUMBER OF CHARAcTERS IN OUTPUT STRING         (RET.)
+C        STRING     OUTPUT STRING                                 (RET.) 
+C        NLET       NUMBER OF CHARACTERS IN OUTPUT STRING         (RET.)
 C                   (<0 INDICATES ERROR)
 C        MINLEN     MINIMUM LENGTH OF OUTPUT STRING               (SENT)
 C
@@ -46,9 +47,14 @@ C--*********************************************************************
 
         SUBROUTINE INTTOCHAR(NUMBER,STRING,NLET,MINLEN)
 
-        CHARACTER (LEN=*) ::       STRING
-        INTEGER, PARAMETER::       MAXSTR = 10
-        CHARACTER (LEN=MAXSTR) ::  CTEMP,CZEROS
+        INTEGER                :: NUMBER,NLET,MINLEN
+        CHARACTER (LEN=*)      :: STRING
+
+        INTEGER, PARAMETER     :: MAXSTR = 10
+        CHARACTER (LEN=MAXSTR) :: CTEMP,CZEROS
+
+        INTEGER                :: NZ,IGO
+
 
         DATA CZEROS/'0000000000'/
 
@@ -60,11 +66,17 @@ C       FIND NUMBER OF LEADING ZEROS (IF ANY)
 
         IGO  = (MAXSTR-NLET+1)
         NLET = NLET + NZ
+        
+c        write(6,*) ' Inttochar  number,minlen,nlet,nz: ', 
+c     &                          number,minlen,nlet,nz
 
 C       CHECK FOR OVERFLOW OF STRING
         IF (NLET .GT. LEN(STRING) .OR. NLET .GT. MAXSTR) GOTO 999
 
 C       I10 MUST BE SAME AS MAXSTR!!
+
+c       write(3,*)' inttochar maxstr: ',maxstr
+
         WRITE(CTEMP,'(I10)',ERR=999) NUMBER
 
         IF (NZ .GT. 0) THEN
@@ -74,6 +86,9 @@ C          MUST PREFIX ZERO'S
            STRING = CTEMP(IGO:MAXSTR) 
         ENDIF
 
+c       write(6,*) ' inttochar number,nlet,string,nlet:',
+c       &                      number,nlet,string,nlet
+
         RETURN
 
 C       ERROR RETURN
diff --git src/listhedmrc.f src/listhedmrc.f
index 891fc210..61b19a50 100644
--- src/listhedmrc.f
+++ src/listhedmrc.f
@@ -1,15 +1,17 @@
 
 C **********************************************************************
 C 
-C  LISTHEDMRC   NEW FOR MRC SUPPORT             OCT 2019  ArDean Leith
-C                                                                     
+C  LISTHEDMRC  NEW FOR MRC SUPPORT              OCT 2019  ArDean Leith
+C              ADDED SPIDER SPECIFIC LOCS       OCT 2025  ArDean Leith
+C                 (NOT IN FILE)                                         
+C                        
 C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2019  Health Research Inc.,                         *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@health.ny.gov                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -40,21 +42,23 @@ C
 C  1    NX          # OF COLUMNS    (FASTEST CHANGING IN MAP)
 C  2    NY          # OF ROWS
 C  3    NZ          # OF SECTIONS   (SLOWEST CHANGING IN MAP)
+C
 C  4    MODE        DATA TYPE
-C                   0   IMAGE:  8-BIT BYTES RANGE -128 -->127 (SIGNED)                  
-C                   1   IMAGE: 16-BIT INTEGERS HALFWORDS                
-C                   2   IMAGE: 32-BIT REALS                    
-C                   6   IMAGE: UNSIGNED 8-BIT BYTES RANGE 0 -->255        
-C                   3   TRANSFORM: COMPLEX 16-BIT INTEGERS (UNSUPPORTED)   
-C                   4   TRANSFORM: COMPLEX 32-BIT REALS    (UNSUPPORTED)     
-C  5    NXSTART     # OF FIRST COLUMN  IN MAP 
-C  6    NYSTART     # OF FIRST ROW     IN MAP       
-C  7    NZSTART     # OF FIRST SECTION IN MAP       
+C                   0   IMAGE:  8-BIT BYTES RANGE -128 -->127 (SIGNED)   
+C                   1   IMAGE: 16-BIT INTEGERS HALFWORDS     
+C                   2   IMAGE: 32-BIT REALS    
+C                   6   IMAGE: UNSIGNED 8-BIT BYTES RANGE 0 -->255  
+C                   3   TRANSFORM: COMPLEX 16-BIT INTEGERS (UNSUPPORTED)
+C                   4   TRANSFORM: COMPLEX 32-BIT REALS    (UNSUPPORTED)
+C    
+C  5    NXSTART     # OF FIRST COLUMN  IN MAP
+C  6    NYSTART     # OF FIRST ROW     IN MAP
+C  7    NZSTART     # OF FIRST SECTION IN MAP  
 C  8    MX          # OF INTERVALS ALONG X
 C  9    MY          # OF INTERVALS ALONG Y
 C 10    MZ          # OF INTERVALS ALONG Z    (>1 FOR STACK)
 C 11-13 CELLA       CELL DIMENSIONS IN ANGSTROMS
-C 14-16 CELLB       CELL ANGLES IN DEGREES  (PHI,THETA,PSI)                        
+C 14-16 CELLB       CELL ANGLES IN DEGREES  (PHI,THETA,PSI)            
 C 17    MAPC        AXIS CORRESPONDING TO COLUMNS  (1,2,3 FOR X,Y,Z)
 C 18    MAPR        AXIS CORRESPONDING TO ROWS     (1,2,3 FOR X,Y,Z)
 C 19    MAPS        AXIS CORRESPONDING TO SECTIONS (1,2,3 FOR X,Y,Z)
@@ -99,12 +103,12 @@ C        RMS   < 0.0                         RMS       UNDETERMINED
 C
 C     Bytes 213 and 214 contain 4 `nibbles' (half-bytes) indicating 
 C     the representation of float, complex, integer and character 
-C     datatypes. Bytes 215 and 216 are unused. The CCP4 library contains 
-C     a general representation of datatypes, but in practice it is 
+C     datatypes. Bytes 215 and 216 are unused. The CCP4 library contains
+C     a general representation of data types, but in practice it is 
 C     safe to use 0x44 0x44 0x00 0x00 for little endian machines, and 
 C     0x11 0x11 0x00 0x00 for big endian machines. The CCP4 library 
 C     uses this information to automatically byte-swap data if 
-C     appropriate, when tranferring data files between machines.  
+C     appropriate, when tranferring data files between machines.
 C
 C23456789012345678901234567890123456789012345678901234567890123456789012
 CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
@@ -114,6 +118,7 @@ CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
 C     IMPLICIT NONE
 
 #include "LUNHDR.INC"
+
       INCLUDE 'CMBLOCK.INC'
       INCLUDE 'CMLIMIT.INC'
 
@@ -126,6 +131,8 @@ C     IMPLICIT NONE
       LOGICAL               :: BIGENDFILE,SAMEENDFILE
       CHARACTER(LEN=MAXNAM) :: FILNAM
       CHARACTER(LEN=800)    :: LABELS
+      CHARACTER(LEN=80)     :: OUTSTR
+      
       CHARACTER(LEN=4)      :: CSTR
       CHARACTER(LEN=1)      :: NULL = CHAR(0)
         
@@ -140,12 +147,15 @@ C     IMPLICIT NONE
       REAL                  :: PIXSIZX,PIXSIZY,PIXSIZZ
       REAL                  :: ORX,ORY,ORZ
       INTEGER               :: IANGLE,IMGSTATS,NLABL,IVERSION
+      INTEGER               :: IXTRA29,IXTRA30,IXTRA31,IXTRA32
       CHARACTER(LEN=4)      :: MAP 
       CHARACTER(LEN=4)      :: CAXIS,EXTTYP
 
       INTEGER               :: LNBLNKN    ! FUNCTION
       LOGICAL               :: ISMRCFILE  ! FUNCTION
 
+      integer               :: idsp,isbare,img_in_stats,nstack    
+
 
 C     OPEN INPUT FILE
       CALL OPFILEC(0,.TRUE.,FILNAM,LUN,'O',ITYPE,
@@ -209,8 +219,11 @@ C     POINT TO HEADER OBJECT
 
       ISPG     = MRC_HEADER(23) 
       NSYMBT   = MRC_HEADER(24) 
+
+C     GET CONTENT OF EXTRA HEADER LOCATION: 25  (AS INTEGER) 
       IMGSTATS = MRC_HEADER(25)                     ! SPIDER DEFINED
 
+C     GET CONTENT OF EXTRA HEADER LOCATION: 26  (AS CHAR STRING) 
       CAXIS    = TRANSFER(MRC_HEADER(26),CSTR(1:4)) ! SPIDER DEFINED
 
 C     GET EXTTYP (NOW 'MRCO')
@@ -219,6 +232,12 @@ C     GET EXTTYP (NOW 'MRCO')
 C     GET VERSION NUMBER 
       IVERSION = MRC_HEADER(28) 
 
+C     GET CONTENT OF EXTRA HEADER LOCATION: 29-32 (AS INTEGERS) 
+      IXTRA29  = MRC_HEADER(29) ! NOT REPORTED BELOW 
+      IXTRA30  = MRC_HEADER(30) ! NOT REPORTED BELOW 
+      IXTRA31  = MRC_HEADER(31) ! NOT REPORTED BELOW 
+      IXTRA32  = MRC_HEADER(32) ! NOT REPORTED BELOW
+
 C     GET IANGLE
       IANGLE   = MRC_HEADER(42)
 
@@ -244,6 +263,7 @@ C     GET MAP TYPE
       RMS      = TRANSFER(MRC_HEADER(55),FVAL) ! DEVIATION FROM MEAN       
       NLABL    = MRC_HEADER(56)
 
+       
       IF (NLABL > 0) THEN
 C        GET LABELS
          CALL LUNGETLABELS_MRC(LUN,NLABL,LABELS,IRTFLG)
@@ -273,6 +293,7 @@ C     WRITE OUT CONVERSION INFORMATION
          WRITE(NOUT,*)' On little ended architecture,',
      &                ' Reading little ended file.'
       ENDIF
+      WRITE(NOUT,*)'  '
 
 
 C     WRITE OUT HEADER INFORMATION
@@ -282,28 +303,33 @@ C     WRITE OUT HEADER INFORMATION
       IF     (MRCMODE == 0) THEN
         WRITE(NOUT,*) ' Data type (Mode) ..........................' //
      &               '    0: 8-bit signed integers, Range -128 --> 127'
+
       ELSEIF (MRCMODE == 1) THEN
         WRITE(NOUT,*) ' Data type .................................' //
-     &                '     1: 16-bit signed integers'
+     &                '      1: 16-bit signed integers'
+
       ELSEIF (MRCMODE == 2) THEN
         WRITE(NOUT,*) ' Data type ................................ ' //
-     &                '     2: 32-bit reals '
+     &                '      2: 32-bit reals '
+
       ELSEIF (MRCMODE == 3) THEN
         WRITE(NOUT,*) ' Data type  ................................' //
-     &                '     3: Complex 16-bit integers'
+     &                '      3: Complex 16-bit integers'
+
       ELSEIF (MRCMODE == 4) THEN
         WRITE(NOUT,*) ' Data type  ................................' //
-     &                '     4: Complex 32-bit reals'
+     &                '      4: Complex 32-bit reals'
+
       ELSEIF (MRCMODE == 6) THEN
         WRITE(NOUT,*) ' Data type  ................................' //
-     &                '    6 : 16-bit unsigned integers'
+     &                '      6 : 16-bit unsigned integers'
       ENDIF
 
       WRITE(NOUT,1001) NX,NY,NZ
-1001  FORMAT(2X,'Columns, rows, sections ..................  ',3(I7,1X))
+1001  FORMAT(2X,'Columns, rows, sections (NX,NY,NZ) ....... ',3(I7,1X))
 
       WRITE(NOUT,1003) NXSTART,NYSTART,NZSTART
-1003  FORMAT(2X,'Starting columns, rows, sections ......... ',3I7)
+1003  FORMAT(2X,'Starting column, row, section ............ ',3I7)
 
       WRITE(NOUT,1004) MX,MY,MZ 
 1004  FORMAT(2X,'Intervals (MX,MY,MZ) .....................  ',3I7)
@@ -321,13 +347,13 @@ C     WRITE OUT HEADER INFORMATION
 1007  FORMAT(2X,'Fast, medium, slow axes .................. ',3I7)
 
       WRITE(NOUT,1008) DMIN,DMAX  
-1008  FORMAT(2X,'Min & max  density ....................... ',2F23.11)
+1008  FORMAT(2X,'Min & max  density .......................',2F23.11)
 
       WRITE(NOUT,1009) DMEAN,RMS
-1009  FORMAT(2X,'Mean & RMS density ....................... ',2F23.11)
+1009  FORMAT(2X,'Mean & RMS density .......................',2F23.11)
 
       WRITE(NOUT,1092) ANG1,ANG2,ANG3,ANG4,ANG5,ANG6
-1092  FORMAT(2X,'Angles (Phi,Theta,Psi) ...............     ',6F8.2)
+1092  FORMAT(2X,'Angles (Phi,Theta,Psi) ...................   ',6F8.2)
 
       WRITE(NOUT,1010) ORX,ORY,ORZ
 1010  FORMAT(2X,'Origins .................................. ',3F10.2)
@@ -336,12 +362,13 @@ C     WRITE OUT HEADER INFORMATION
 1011  FORMAT(2X,'Space group, extra header bytes .......... ',2I7)
 
       WRITE(NOUT,1091) IMGSTATS 
-1091  FORMAT(2X,'Image used for stats ** .................. ',2I7)
+1091  FORMAT(2X,'Image or volume in DMIN,DMAX ** ........... ',I7)
+
       WRITE(NOUT,1012) CAXIS 
 1012  FORMAT(2X,'Data origin ** ..........................        ',A)
 
       WRITE(NOUT,1013) MACHST
-1013  FORMAT(2X,'Machine stamp ............................ ',I12)
+1013  FORMAT(2X,'Machine stamp ............................',I12)
 
       WRITE(NOUT,1014) MAP
 1014  FORMAT(2X,'Map type..................................       ',A)
@@ -350,19 +377,43 @@ C     WRITE OUT HEADER INFORMATION
 1015  FORMAT(2X,'MRC version ..............................     ',I7)
 
       WRITE(NOUT,1016) EXTTYP 
-1016  FORMAT(2X,'ExtType .....................................    ',A)
+1016  FORMAT(2X,'ExtType ..................................       ',A)
 
-      WRITE(NOUT,1017) NLABL 
-1017  FORMAT(2X,'Number of labels ......................... ',I7)
+      WRITE(NOUT,1022) NLABL
+1022  FORMAT(2X,'Number of labels .........................  ',I7)
+
+      idsp    = mrc_header(257)
+      isbare  = mrc_header(258)
+      imgnum  = mrc_header(258)
+      nstack  = mrc_header(260)
+
+      WRITE(NOUT,*) ' '
+
+      WRITE(NOUT,1018) idsp 
+1018  FORMAT(2X,'Old or New File    (OLD: 0) (NEW: 1) ** .... ',I7)
+
+      WRITE(NOUT,1019)  isbare  
+1019  FORMAT(2X,'Bare stack         (1: TRUE)         ** .... ',I7)
+
+      WRITE(NOUT,1020) imgnum 
+1020  FORMAT(2X,'Image in header    (-2: NOT A STACK) ** .... ',I7)
+
+      WRITE(NOUT,1021) nstack 
+1021  FORMAT(2X,'Max image in stack (-2: NOT A STACK) ** .... ',I7)
+
+      WRITE(NOUT,*) ' '
 
       IF (NLABL > 0) THEN
          IEND = lnblnkn(LABELS)
 
-         WRITE(NOUT,1031)
-1031     FORMAT('  Labels:')
-
-         WRITE(NOUT,1032) LABELS(1:IEND)
-1032     FORMAT(3X,100(A80))
+         DO ILABL = 1,NLABL 
+            ILOC = (ILABL - 1) * 80 + 1
+            OUTSTR = LABELS(ILOC: ILOC+80)
+            OUTSTR = ADJUSTL(OUTSTR)
+            OUTSTR = TRIM(OUTSTR)  
+            WRITE(NOUT,1031) ILABL,OUTSTR
+1031        FORMAT('  Label:', I5,'     ',A80)
+         ENDDO
       ENDIF
 
       WRITE(NOUT,*) ' '
@@ -370,3 +421,4 @@ C     WRITE OUT HEADER INFORMATION
       CLOSE(LUN)
 
       END
+
diff --git src/lnblnkn.f src/lnblnkn.f
index d3f9066d..c1239973 100644
--- src/lnblnkn.f
+++ src/lnblnkn.f
@@ -1,14 +1,14 @@
 C++*********************************************************************
 C
 C LNBLNKN.F   -- NEW FEB 1999                       AUTHOR: ARDEAN LEITH
-C                ADDED TAB TRAP NOV 00                      ARDEAN LEITH                        
+C                ADDED TAB TRAP NOV 00                      ARDEAN LEITH C                BUG FIXED      SEP 25                      TAPU          
 C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2010  Health Research Inc.,                         *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@wadsworth.org                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -37,19 +37,31 @@ C--*********************************************************************
        INTEGER FUNCTION LNBLNKN(STRING)
 
        CHARACTER *(*) STRING
+       INTEGER        LENN,LENB,IDX
 
 C      FIND LOCATION OF LAST NON-NULL, PRINTING CHARACTER IN STRING
- 
        LNBLNKN = lnblnk(STRING)
+
+C      Check for null character inside string
        LENN    = INDEX(STRING,CHAR(0)) 
        IF (LENN .GE. 1 .AND. LENN .LE. LNBLNKN) LNBLNKN = LENN - 1
 
-       IF (LNBLNKN .GT. 0 .AND. STRING(LNBLNKN:LNBLNKN) .LE. CHAR(32))
-     &    THEN
+C      If lnblnkn is 0, then string(lnblnkn:lnblnkn) below will be invalid
+       IF (LNBLNKN .LE. 0) THEN
+          LNBLNKN = 0
+          RETURN
+       ENDIF
+
+C      IF (STRING(LNBLNKN:LNBLNKN) .LE. CHAR(32)) THEN
+       IF (ICHAR(STRING(LNBLNKN:LNBLNKN)) .LE. 32) THEN
 C         LAST POSITION IS STILL NON PRINTING
           LENB = LNBLNKN
-          DO LNBLNKN = LENB,1,-1
-             IF (STRING(LNBLNKN:LNBLNKN) .GT. CHAR(32)) RETURN
+          DO IDX = LENB,1,-1
+C            IF (STRING(LNBLNKN:LNBLNKN) .GT. CHAR(32)) THEN
+             IF (ICHAR(STRING(idx:idx)) .GT. 32) THEN
+                LNBLNKN = IDX
+                RETURN
+             ENDIF
           ENDDO
           LNBLNKN = 0 
        ENDIF
diff --git src/lunsethdr.f src/lunsethdr.f
index b610b9fa..640586a7 100644
--- src/lunsethdr.f
+++ src/lunsethdr.f
@@ -16,14 +16,15 @@ C                LABBYT >= 10000000) TRAP       MAR 2011  ArDean Leith
 C                MAXNAM                         JUL 2014  ArDean Leith
 C                EM2EM BUG RECOVERY SUPPORT     AUG 2014  ArDean Leith
 C                MRC SUPPORT                    MAY 2019  ArDean Leith
+C                MRC SUPPORT FIXED              SEP 2025  ArDean Leith
 C                    
 C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2019 Health Research Inc.,                          *
+C=* Copyright 1985-2025 Health Research Inc.,                          *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@health.ny.gov                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -53,10 +54,10 @@ C     ------------------------- LUNSETLAB -----------------------------
 C     ------------------------- LUNGETLAB -----------------------------
 C     ------------------------- LUNGETTYPE ----------------------------
 C     ------------------------- LUNSETTYPE ----------------------------
-C     ------------------------- LUNGETISTACK ----------------------------
-C     ------------------------- LUNSETISTACK ----------------------------
+C     ------------------------- LUNGETISTACK --------------------------
+C     ------------------------- LUNSETISTACK --------------------------
 C     ------------------------- LUNGETSTK -----------------------------
-C     ------------------------- LUNSET25 ---------------------------
+C     ------------------------- LUNSET25 ------------------------------
 C     ------------------------- LUNSETINUSE ---------------------------
 C     ------------------------- LUNGETINUSE ---------------------------
 C     ------------------------- LUNGETMAXIM ---------------------------
@@ -88,7 +89,9 @@ C     ------------------------- LUNWRTINDX ----------------------------
 C     ------------------------- LUNGETINDXTOP -------------------------
 C     ------------------------- LUNSETINDXTOP -------------------------
 C     ------------------------- LUNSETVALS ----------------------------
-C     ------------------------- LUNSETIMGOFF -------------------------
+C     ------------------------- LUNSETIMGOFF --------------------------
+C     ------------------------- LUNSETFLIP ----------------------------
+C     ------------------------- LUNGETFLIP ----------------------------
 C      
 C     STATIC LOCATION    257 -- IDSP
 C                        258 -- ISBARE
@@ -118,7 +121,7 @@ C     INITIALIZES OFFSETS IN LUNARA,LUNSTK,LUNARB & LUNFLIP ARRAYS
 
       INTEGER  :: LUN,IVALA,IVALSTK,IVALLUN,IVALFLIP,IRTFLG
 
-      INTEGER  :: LUNARA(100),LUNSTK(100),LUNARB(100),LUNFLIP(100)
+      INTEGER  ::     LUNARA(100),LUNSTK(100),LUNARB(100),LUNFLIP(100)
       COMMON /LUNARA/ LUNARA,LUNSTK,LUNARB,LUNFLIP
 
       LUNARA(LUN)  = IVALA
@@ -141,8 +144,8 @@ C     OVERALL HEADER TO ENSURE THAT LUNGETHEDOFF SUCCEEDS
 
       INTEGER      :: LUN,NX,IMGNUM,IRTFLG 
 
-      INTEGER      :: LUNARA(100),LUNSTK(100),LUNARB(100) 
-      COMMON /LUNARA/ LUNARA,LUNSTK,LUNARB
+      INTEGER      :: LUNARA(100),LUNSTK(100),LUNARB(100),LUNFLIP(100)  
+      COMMON /LUNARA/ LUNARA,LUNSTK,LUNARB,LUNFLIP
 
       INTEGER      :: IERR 
       COMMON /IOERR/  IERR
@@ -154,12 +157,14 @@ C     OVERALL HEADER TO ENSURE THAT LUNGETHEDOFF SUCCEEDS
 C     SET PROPER  OFFSET IN LUNSTK
       LUNSTKSAV   = LUNSTK(LUN)
       LABRECSAV   = LUNARA(LUN)
-      !write(3,*) ' In labrecsav:',lunstksav,labrecsav,lun
+      !write(6,*) ' In labrecsav:',lunstksav,labrecsav,lun
 
 C     FIND PROPER IMGNUM OFFSET 
       CALL LUNGETHEDOFF(LUN,NX,IMGNUM,
      &                  LUNARA(LUN),LUNSTK(LUN),IRTFLG)
-      !write(3,*) ' In lunredhdr, imgnum:',imgnum
+
+      !write(6,*) ' In lunredhdr, imgnum--------:',imgnum
+
       IF (IRTFLG .NE. 0) RETURN
 
 C     POINT TO HEADER OBJECT
@@ -190,7 +195,9 @@ C        LENT IS REMAINING LENGTH OF HEADER TO BE FILLED
 
 C     REPLACE OFFSETS IN LUNARA & LUNSTK    
       LUNARA(LUN) = LABRECSAV
-      LUNSTK(LUN) = LUNSTKSAV 
+      LUNSTK(LUN) = LUNSTKSAV
+ 
+      ! write(6,*) ' In lunredhed:',lun,header(27)
 
       END
 
@@ -331,7 +338,8 @@ C     SHOULD ONLY BE CALLED FOR STACKS!
 
       INCLUDE 'CMBLOCK.INC'
 
-      COMMON /LUNARA/ LUNARA(100),LUNSTK(100),LUNARB(100)
+      INTEGER  ::     LUNARA,LUNSTK,LUNARB,LUNFLIP
+      COMMON /LUNARA/ LUNARA(100),LUNSTK(100),LUNARB(100),LUNFLIP(100)
 
 C     GET RECORD INFO (CAN BE FROM OVERALL HEADER)
       CALL LUNGETLAB(LUN,LABREC,INDXREC,NRECS,NDUM1,NDUM2,IRTFLG)
@@ -387,6 +395,7 @@ C     ------------------------- LUNGETTYPE ----------------------------
 #include "LUNHDR.INC"
 
       INTEGER   :: LUN,ITYPE,IRTFLG 
+      LOGICAL  :: IS_MRC
 
 C     DETERMINE IF MRC OR SPIDER HEADER OBJECT
       CALL LUNGETIS_MRC(LUN,IS_MRC,IRTFLG)
@@ -573,8 +582,8 @@ C     WRITES HEADER OBJECT TO SPECIFIED IMAGE HEADER
 
 #include "LUNHDR.INC"
 
-      INTEGER      :: LUNARA,LUNSTK,LUNARB
-      COMMON /LUNARA/ LUNARA(100),LUNSTK(100),LUNARB(100)
+      INTEGER ::      LUNARA,LUNSTK,LUNARB,LUNFLIP
+      COMMON /LUNARA/ LUNARA(100),LUNSTK(100),LUNARB(100),LUNFLIP(100)
 
       INCLUDE 'CMBLOCK.INC'
 
@@ -583,6 +592,7 @@ C     WRITES HEADER OBJECT TO SPECIFIED IMAGE HEADER
 
       INTEGER  :: LUN,NX,IMGNUM,IRTFLG
 
+
       INTEGER  :: LUNSTKSAV,LABRECSAV,IRECT,ILOC,LENT
       LOGICAL  :: IS_MRC
 
@@ -664,14 +674,19 @@ C     ------------------------- LUNGETINUSE ----------------------------
 #include "LUNHDR.INC"
 
       INTEGER  :: LUN,INUSE,IRTFLG
+      integer  :: iwas
 
 C     POINT TO HEADER OBJECT
       CALL LUNGETOBJ(LUN,HEADER,IRTFLG)
       IF (IRTFLG .NE. 0) RETURN
  
+      iwas = inuse
+ 
 C     GET STACK RELATED LOCATIONS
       INUSE = HEADER(27) 
 
+C      write(6,*)' In getinuse, lun,hd27--99:',
+C     &            lun,header(27),iwas,' -->',inuse 
       IRTFLG = 0
       END
 
@@ -682,6 +697,7 @@ C     ------------------------- LUNSETINUSE ----------------------------
 #include "LUNHDR.INC"
 
       INTEGER  :: LUN,INUSE,IRTFLG
+      LOGICAL  :: IS_MRC
 
 C     DETERMINE IF MRC OR SPIDER HEADER OBJECT
       CALL LUNGETIS_MRC(LUN,IS_MRC,IRTFLG)
@@ -744,6 +760,7 @@ C     ------------------------- LUNSETMAXIM ----------------------------
 #include "LUNHDR.INC"
 
       INTEGER  :: LUN,MAXIM,IRTFLG
+      LOGICAL  :: IS_MRC
 
 C     DETERMINE IF MRC OR SPIDER HEADER OBJECT
       CALL LUNGETIS_MRC(LUN,IS_MRC,IRTFLG)
@@ -793,7 +810,8 @@ C     COMPLICATED SINCE I DO NOT WANT TO ALTER CURRENT FILE HEADER OBJECT
       INCLUDE 'CMLIMIT.INC'
       COMMON /IOBUF/ BUF(NBUFSIZ)
 
-      COMMON /LUNARA/ LUNARA(100),LUNSTK(100),LUNARB(100)
+      INTEGER ::      LUNARA,LUNSTK,LUNARB,LUNFLIP
+      COMMON /LUNARA/ LUNARA(100),LUNSTK(100),LUNARB(100),LUNFLIP(100)
 
       COMMON /IOERR/  IERR
 
@@ -1003,7 +1021,7 @@ C     GET RETURN VALUES
       IRTFLG = 0
       END
 
-C     ------------------------- LUNGETPIXSIZ ----------------------------
+C     ------------------------- LUNGETPIXSIZ -------------------------
 
       SUBROUTINE LUNGETPIXSIZ(LUN,PIXSIZ,IRTFLG)
 
@@ -1033,7 +1051,7 @@ C     GET RETURN VALUES
       IRTFLG = 0
       END
 
-C     ------------------------- LUNSETPIXSIZ ----------------------------
+C     ------------------------- LUNSETPIXSIZ -------------------------
 
       SUBROUTINE LUNSETPIXSIZ(LUN,PIXSIZ,IRTFLG)
 
@@ -1474,8 +1492,14 @@ C        NOTE THAT ALPHA-NUMERICAL DATA (ABCD) WILL BE WRITTEN (DCBA)
 
 C     RECOVER TITLE FROM CLINE
       FILETITLE = CLINE(21:180)
+      !write(6,*) 'In lungettitle - cline(21:180):',cline(21:180),'||'
+      !write(6,*) 'In lungettitle - filetitle:',filetitle,'||'
+
       LENTIT    = lnblnkn(FILETITLE)
 
+      !write(6,*) 'In lungettitle - lentit:',lentit
+      !write(6,*) 'In lungettitle - filetitle:',filetitle,'||'
+
       IRTFLG = 0
       END
 
@@ -1599,7 +1623,7 @@ C     ------------------------- LUNSAYINFO ----------------------------
       CHARACTER * 2    TYPE
       CHARACTER *12    CDAT
       CHARACTER *8     CTIM
-      CHARACTER *160   CTIT
+      CHARACTER *160   CTIT_LOCAL
 
       CHARACTER(LEN=MAXNAM):: FILNAM
 
@@ -1662,8 +1686,17 @@ C     RETRIEVE CURRENT FILENAME (INCLUDES IMGNUM IF STACKED IMAGE)
 
 C     RECOVER FILE DATE, TIME & TITLE FROM HEADER
       CALL LUNGETDATE(LUN,CDAT,CTIM,IRTFLG)
-      CALL LUNGETTITLE(LUN,CTIT,LENTIT,IRTFLG)
+
+c     write(6,*)'In lunsayinfo - lun,lentit,irtflg: ',lun,lentit,irtflg
+c     ctit_local = 'cow'
+c     write(6,*)'In lunsayinfo - ctit_local:',ctit_local,'}}'
+
+      CALL LUNGETTITLE(LUN,CTIT_LOCAL,LENTIT,IRTFLG)
       
+c     write(6,*)' In lunsayinfo - lun,lentit,irtflg: ',
+c     &                           lun,lentit,irtflg
+c     write(6,*)'In lunsayinfo - ctit_local: ',ctit_local(1:lentit),'||'
+
 C     GET RECORD INFO
       CALL LUNGETLAB(LUN,LABREC,INDXREC,NRECS,LABBYT,LENBYT,IRTFLG)
 
@@ -1716,7 +1749,8 @@ C           FILENAME BUT NO TITLE
          ELSE IF (LENT > 0 .AND. LENT < 70) THEN
 C           HAS FILENAME AND TITLE THAT FIT ON ONE LINE
             IF (MYPID <= 0) THEN
-               WRITE(NOUT,*) ' ',FILNAM(:NLET),'     /',CTIT(:LENTIT)
+               WRITE(NOUT,*) ' ',FILNAM(:NLET),
+     &                       '     /',CTIT_LOCAL(:LENTIT)
             ENDIF
 
 
@@ -1726,8 +1760,8 @@ C           FILENAME AND TITLE DO NOT FIT ON SINGLE LINE
             LENT = MIN(80,LENTIT)
 
             IF (MYPID <= 0) THEN
-               WRITE(NOUT,*) ' ',CTIT(1:LENT)
-               IF (LENTIT > 80)  WRITE(NOUT,*) ' ',CTIT(81:LENTIT)
+               WRITE(NOUT,*) ' ',CTIT_LOCAL(1:LENT)
+               IF (LENTIT > 80) WRITE(NOUT,*) ' ',CTIT_LOCAL(81:LENTIT)
             ENDIF
 
          ENDIF
@@ -1797,7 +1831,7 @@ C           SIMPLE IMAGE
       END
 
 
-C     ------------------------- LUNSETCOMMON ----------------------------
+C     ------------------------- LUNSETCOMMON -------------------------
 
       SUBROUTINE LUNSETCOMMON(LUN,IRTFLG)
 
@@ -1805,6 +1839,8 @@ C     ------------------------- LUNSETCOMMON ----------------------------
 
       INCLUDE 'CMBLOCK.INC'
 
+      INTEGER           :: LUN,IRTFLG
+
       CHARACTER(LEN=12) :: CDUM
       CHARACTER(LEN=1)  :: NULL = CHAR(0)
 
@@ -1853,7 +1889,7 @@ C     DATE NOT PASSED IN COMMON ANY MORE AS COMMON IS ONLY 10 CHAR.
 C     RECOVER ANGLES
       CALL LUNGETANG(LUN,IANGLE,PHI,THETA,PSI,XOFF,YOFF,ZOFF, 
      &               KANGLE,IRTFLG)
-      IF (IRTFLG .NE. 0) RETURN
+      IF (IRTFLG .NE.  0) RETURN
 
 C     SET REGISTER VALUES AS NEEDED
       CALL REG_SET(1,FLOAT(NSAMC),  NULL, IRTFLG)
@@ -1888,6 +1924,7 @@ C           LABBYT, LABREC, NREC, DATE, TIME, IMGNUM, INUSE
       REAL, POINTER           :: HEADERT(:) 
 
       IRTFLG = 1
+      ! write(6,*)'In lunsethdr; call lungetobj; lun,lunt: ',lun,lunt
 
 C     POINT TO HEADER OBJECT
       CALL LUNGETOBJ(LUN,HEADER,IRTFLG)
@@ -1897,6 +1934,8 @@ C     POINT TO HEADER OBJECT
 C        COPY ALL HEADER BUFFER SPACES UP TO LENBUF
 C        POINT TO TRANSFER HEADER OBJECT
 
+         !write(6,*)' In lunsethdr; call lungetobj; lunt: ',lunt
+
          CALL LUNGETOBJ(LUNT,HEADERT,IRTFLG)
          IF (IRTFLG .NE. 0) THEN
            CALL ERRT(102,'LUNGETOBJ FAILED FOR LUN:',LUNT)
@@ -1960,7 +1999,8 @@ C     CLEARS ALL INDEX RECORDS
 
 #include "LUNHDR.INC"
 
-      COMMON /LUNARA/ LUNARA(100),LUNSTK(100),LUNARB(100)
+      INTEGER  ::     LUNARA,LUNSTK,LUNARB,LUNFLIP
+      COMMON /LUNARA/ LUNARA(100),LUNSTK(100),LUNARB(100),LUNFLIP(100)
 
       INCLUDE 'CMBLOCK.INC'
 
@@ -2020,7 +2060,9 @@ C     ----------- LUNWRTINDX --------------------------------------
 C     SETS INDEX FOR A SPECIFIED IMGNUM 
 
       INCLUDE 'CMBLOCK.INC'
-      COMMON /LUNARA/ LUNARA(100),LUNSTK(100),LUNARB(100)
+
+      INTEGER  ::     LUNARA,LUNSTK,LUNARB,LUNFLIP
+      COMMON /LUNARA/ LUNARA(100),LUNSTK(100),LUNARB(100),LUNFLIP(100)
  
       INTEGER :: INDXBUF(NX)
 
@@ -2082,10 +2124,11 @@ C     RETURNS INDEX FOR A SPECIFIED IMGNUM
 
       INCLUDE 'CMBLOCK.INC'
 
-      COMMON /LUNARA/ LUNARA(100),LUNSTK(100),LUNARB(100)
+      INTEGER  ::     LUNARA,LUNSTK,LUNARB,LUNFLIP
+      COMMON /LUNARA/ LUNARA(100),LUNSTK(100),LUNARB(100),LUNFLIP(100)
  
       INTEGER  :: LUN,IMGNUM,INDX,NX,IRTFLG
-
+      
 C     AUTOMATIC ARRAY
       INTEGER  :: INDXBUF(NX)
 
@@ -2144,7 +2187,7 @@ C     POINT TO HEADER OBJECT
       IF (IRTFLG .NE. 0) RETURN
 
 C     SET INUSE RELATED LOCATION
-      HEADER(25) = -1 
+      HEADER(25) =  -1 
 
       IRTFLG = 0
       END
@@ -2223,12 +2266,11 @@ C     SETS DUPLICATE LUN OPEN  IN LUNARB(LUN)
       INTEGER  :: LUN,LUNB,IRTFLG
 
       INTEGER  :: LUNARA,LUNSTK,LUNARB,LUNFLIP
-
       COMMON /LUNARA/ LUNARA(100),LUNSTK(100),LUNARB(100),LUNFLIP(100)
 
       LUNARB(LUN) = LUNB
 
-      !write(3,*) ' In lunsetlunb, lun,lunb: ',lun,lunb,lunarb(lun)
+      !write(6,*) ' In lunsetlunb, lun,lunb: ',lun,lunb,lunarb(lun)
 
       IRTFLG      = 0
       END
@@ -2243,7 +2285,6 @@ C     GETS DUPLICATE LUN OPEN  IN LUNARB(LUN)
       INTEGER  :: LUN,LUNB,IRTFLG
 
       INTEGER  :: LUNARA,LUNSTK,LUNARB,LUNFLIP
-
       COMMON /LUNARA/ LUNARA(100),LUNSTK(100),LUNARB(100),LUNFLIP(100)
 
       LUNB   = LUNARB(LUN)
@@ -2261,11 +2302,10 @@ C     SETS FLIP IN LUNFLIP(LUN)
       INTEGER  :: LUN,IFLIP,IRTFLG
 
       INTEGER  :: LUNARA,LUNSTK,LUNARB,LUNFLIP
-
       COMMON /LUNARA/ LUNARA(100),LUNSTK(100),LUNARB(100),LUNFLIP(100)
 
       LUNFLIP(LUN) = IFLIP
-
+      
       IRTFLG       = 0
       END
 
diff --git src/lunsetmrchdr.f src/lunsetmrchdr.f
index 3f0262be..124c3780 100644
--- src/lunsetmrchdr.f
+++ src/lunsetmrchdr.f
@@ -1,15 +1,21 @@
-C++*********************************************************************
+C++********************************************************************
+C
+C LUNSETMRCHDR.F  DERIVED FROM LUNSETHDR.F        JUN 2019 ArDean Leith
+C                 NATIVE MRC FILE SUPPORT         JUL 2019 ArDean Leit
+C                 NVIDIA COMPILER CHANGES         SEP 2025 Tapu Shaikh
+C                 NVIDIA COMPILER CHANGES UNDONE  SEP 2025 ArDean Leith
+C                 DEBUG OUTPUT CHANGED,CTIT_LOCAL SEP 2025 ArDean Leith
+C                 NBYT, NBYT_PER_VAL CONFUSED     SEP 2025 ArDean Leith
+C                 DEBUG OUTPUT ADDED              OCT 2025 ArDean Leith
+C                 LUNSETFILE SET (27)             OCT 2025 ArDean Leith
 C
-C LUNSETMRCHDR.F    DERIVED FROM LUNSETHDR.F    JUN 2019  ArDean Leith
-C                   NATIVE MRC FILE SUPPORT     JUL 2019  ArDean Leith
-C                    
 C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2020 Health Research Inc.,                          *
+C=* Copyright 1985-2025 Health Research Inc.,                          *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@health.ny.gov                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -69,7 +75,8 @@ C     ------------------------- LUNSETNSTACK_MRC -------------------
 C     ------------------------- LUNSETCOMMON_MRC ------------------- 
 C     ------------------------- LUNGETLABELS_MRC ------------------- 
 C     ------------------------- LUNSAYINFO_MRC --------------------- 
-C
+C     ------------------------- LUNGETMODSIZES_MRC -----------------
+
 C  REAL LOCATIONS:      
 C
 C      CELLAX   = TRANSFER(MRC_HEADER(11),FVAL)  ! PIXEL SIZE * NX
@@ -104,7 +111,7 @@ C      ORZ      = TRANSFER(MRC_HEADER(52),FVAL)
 C
 C      MAP      = TRANSFER(MRC_HEADER(53),CSTR(1:4))
 C
-C      RMS      = TRANSFER(MRC_HEADER(55),FVAL) ! DEVIATION FROM MEAN DENSITY          
+C      RMS      = TRANSFER(MRC_HEADER(55),FVAL) ! DEVIATION FROM MEAN DENSITY   
 C
 C
 C
@@ -180,6 +187,9 @@ C     READS MRC IMAGE HEADER FROM FILE INTO MRC HEADER OBJECT
 
       INTEGER * 8  :: IPOSMRC
 
+      character(len=4) :: caxis
+
+ 
 C     INCLUSION FOR OPTIONAL MPI INITIALIZATION.  
       INTEGER      :: MYPID = -1
 #include "MPI_INIT.INC"
@@ -207,7 +217,13 @@ C       ALWAYS BROADCASTS IF ONLYONE_RED IS .TRUE. WHEN USING MPI
       ENDIF
 #endif
 
-      !write(3,*)' In lunredhed_mrc, mrc_header:',mrc_header(1:9)
+
+
+#if defined(SP_DBUG)
+       caxis = transfer(mrc_header(26),caxis) 
+       write(3,*)' In lunredhed_mrc, mrc_header: ',mrc_header(26)
+       write(3,*)' In lunredhed_mrc, caxis:',caxis
+#endif
 
       IF (MYPID <= 0 .AND. IRTFLG .NE. 0 .AND. CALLERRT) THEN
          CALL ERRT(102,'I/O ERROR ON FILE HEADER',IRTFLG)
@@ -222,17 +238,18 @@ C     ----------- LUNWRTHED_MRC ---------------------------------------
 
       SUBROUTINE LUNWRTHED_MRC(LUN,IRTFLG)
 
-C     WRITES HEADER OBJECT INTO FILE'S MRC IMAGE HEADER
+C     WRITES HEADER OBJECT INTO MRC FILE'S HEADER (ONLY HAS 1 HEADER)
 
 #include "LUNHDR.INC"
 
       INTEGER    :: LUN,IRTFLG
 
-      INTEGER *8 :: IPOSMRC 
+      INTEGER *8 :: IPOSMRC = 1    ! LONG INTEGER
       real       :: fval
 
 C     INCLUSION FOR OPTIONAL MPI INITIALIZATION.  
-      INTEGER      :: MYPID = -1
+      INTEGER    :: MYPID = -1
+
 #include "MPI_INIT.INC"
 
 C     POINT TO HEADER OBJECT
@@ -240,14 +257,20 @@ C     POINT TO HEADER OBJECT
       IF (IRTFLG .NE. 0) RETURN
 
 C     WRITE HEADER RECORD FROM MRC_HEADER INTO MRC FILE 
-      IPOSMRC = 1
 
       IF (MYPID <= 0) 
      &    WRITE(LUN, POS=IPOSMRC,IOSTAT=IRTFLG) MRC_HEADER(1:256)
-      !write(3,*)' In lunwrthed_mrc, header(25): ',mrc_header(25),lun   
 
-#ifdef USE_MPI
+#if defined(SP_DBUGIO)
+      write(3,*) ' '
+      write(3,*) ' In lunwrthed_mrc; iposmrc,irtflg: ',iposmrc,irtflg
+      write(3,*) ' In lunwrthed_mrc; header(25): ',    mrc_header(25)
+      write(3,*) ' '
+      !CALL BACKTRACE
+#endif
+
 
+#ifdef USE_MPI
       IF (ONLYONE_RED) THEN
 C       ALWAYS BROADCASTS IF ONLYONE_RED IS .TRUE. WHEN USING MPI
         CALL BCAST_MPI('LUNWRTHED_MRC','MRC_HEADER',MRC_HEADER,256,'I',
@@ -256,9 +279,11 @@ C       ALWAYS BROADCASTS IF ONLYONE_RED IS .TRUE. WHEN USING MPI
      &                  ICOMM,MPIERR)
       ENDIF
 #endif
+
       !fval = transfer(mrc_header(20),fval)
 
       IF (MYPID <= 0 .AND. IRTFLG .NE. 0) THEN
+
          CALL ERRT(102,'WRITING TO MRC FILE HEADER',IRTFLG)
          IRTFLG = 1
       ENDIF
@@ -296,11 +321,11 @@ C     POINT TO HEADER OBJECT
 
 C     ------------------ LUNGETPOSINFO_MRC ----------------------------
 
-      SUBROUTINE LUNGETPOSINFO_MRC(LUN,NBYT,IHEDLEN,IRTFLG)
+      SUBROUTINE LUNGETPOSINFO_MRC(LUN,NBYT_PER_VAL,IHEDLEN,IRTFLG)
 
 #include "LUNHDR.INC"
      
-      INTEGER         :: LUN,NBYT,IHEDLEN,IRTFLG
+      INTEGER         :: LUN,NBYT_PER_VAL,IHEDLEN,IRTFLG
 
       INTEGER         :: NSYMBT,MRCMODE
 
@@ -320,33 +345,68 @@ C     CALCULATE NUMBER OF BYTES IN AN IMAGE VALUE (<0 == UNSIGNED)
       MRCMODE = MRC_HEADER(4)
 
       IF     (MRCMODE == 0) THEN
-         NBYT =  1           ! SIGNED    8 BIT INTEGER*1 
+         NBYT_PER_VAL =  1         ! SIGNED    8 BIT INTEGER*1
+ 
       ELSEIF (MRCMODE == 1) THEN
-         NBYT =  2           ! SIGNED   16 BIT INTEGER*2
+         NBYT_PER_VAL =  2         ! SIGNED   16 BIT INTEGER*2
+
       ELSEIF (MRCMODE == 6) THEN
-         NBYT = -2           ! UNSIGNED 16 BIT INTEGER*2
+         NBYT_PER_VAL = -2         ! UNSIGNED 16 BIT INTEGER*2
+
       ELSEIF (MRCMODE == 2) THEN
-         NBYT =  4           ! REAL*4  
+         NBYT_PER_VAL =  4         ! REAL*4
+  
       ELSE
-         NBYT   = 0          ! NOT A VALID MRC FILE
+         NBYT_PER_VAL = 0          ! NOT A VALID MRC FILE
          IRTFLG = 1
+         RETURN
       ENDIF
 
       IRTFLG = 0
       END
 
+
+C     ------------------ LUNSET_HEDPOS_MRC ----------------------------
+
+      SUBROUTINE LUNSET_HEDPOS_MRC(LUN,IRTFLG)
+
+      IMPLICIT NONE
+     
+      INTEGER        :: LUN,IRTFLG
+
+      INTEGER * 8    :: LUNMRCPOS 
+      INTEGER        :: LUNMRCNBYT
+      COMMON /LUNMRC/   LUNMRCPOS(100),LUNMRCNBYT(100)
+
+      INTEGER        :: LUNARA,LUNSTK,LUNARB,LUNFLIP
+      COMMON /LUNARA/   LUNARA(100),LUNSTK(100),LUNARB(100),LUNFLIP(100)
+
+      INTEGER        :: NX,NY,NZ
+
+      CALL LUNGETSIZE_MRC(LUN,NX,NY,NZ,IRTFLG)
+      IF (IRTFLG .NE. 0) RETURN
+
+      LUNARA(LUN)    = NX
+
+C     NO STACK OFFSET NEEDED
+      LUNMRCPOS(LUN) = 1
+
+      IRTFLG = 0
+      END
+
 C     ------------------ LUNSETPOS_MRC ----------------------------
 
       SUBROUTINE LUNSETPOS_MRC(LUN,IMGNUM,IRTFLG)
 
       IMPLICIT NONE
      
-      INTEGER         :: LUN,IMGNUM,IRTFLG
+      INTEGER        :: LUN,IMGNUM,IRTFLG
 
-      INTEGER * 8     :: LUNMRCPOS 
-      INTEGER         :: LUNMRCNBYT
-      COMMON /LUNMRC/    LUNMRCPOS(100),LUNMRCNBYT(100)
-      INTEGER         :: LUNARA,LUNSTK,LUNARB,LUNFLIP
+      INTEGER * 8    :: LUNMRCPOS 
+      INTEGER        :: LUNMRCNBYT
+      COMMON /LUNMRC/   LUNMRCPOS(100),LUNMRCNBYT(100)
+
+      INTEGER        :: LUNARA,LUNSTK,LUNARB,LUNFLIP
       COMMON /LUNARA/   LUNARA(100),LUNSTK(100),LUNARB(100),LUNFLIP(100)
 
       INTEGER         :: NBYT,IHEDLEN,NBYT_PER_VAL,NBYT_PER_REC
@@ -359,16 +419,16 @@ C     THIS IS NOT A STANDARD MRC DEFINED HEADER POSITION!!
       IF (IRTFLG .NE. 0) RETURN
 
 C     GET NUMBER OF BYTES IN AN IMAGE VALUE AND HEADER LENGTH
-      CALL LUNGETPOSINFO_MRC(LUN,NBYT,IHEDLEN,IRTFLG)
+      CALL LUNGETPOSINFO_MRC(LUN,NBYT_PER_VAL,IHEDLEN,IRTFLG)
       IF (IRTFLG .NE. 0) RETURN
 
 C     NZ IS ADJUSTED FOR RELION .mrcs FILES IF NEEDED
       CALL LUNGETSIZE_MRC(LUN,NX,NY,NZ,IRTFLG)
       IF (IRTFLG .NE. 0) RETURN
 
-      LUNMRCNBYT(LUN) = NBYT       ! PRESERVES NEGATIVE FOR SIGN
+      LUNMRCNBYT(LUN) = NBYT_PER_VAL  ! PRESERVES NEGATIVE FOR SIGN
 
-      NBYT_PER_VAL    = ABS(NBYT)   
+      NBYT_PER_VAL    = ABS(NBYT_PER_VAL)   
       NBYT_PER_REC    = NBYT_PER_VAL * NX
 
  
@@ -380,6 +440,7 @@ C        ORIGIN AT UPPER LEFT, POSITION AT ONE RECORD BEFORE IMAGE
          IF (IMGNUM <= 1) THEN
 C          NO STACK OFFSET NEEDED
            LUNMRCPOS(LUN) = IHEDLEN - NBYT_PER_REC + 1
+
          ELSE
 C          STACKED FILE OFFSET NEEDED 
            LUNMRCPOS(LUN) = IHEDLEN + 
@@ -406,13 +467,12 @@ C          STACKED FILE OFFSET NEEDED
          ENDIF   ! END OF: IF (IMGNUM <= 1)
       ENDIF
 
-      !write(3,*) ' In lunsetpos_mrc, imgnum,lunmrcpos(lun): ',
-      !&                               imgnum,lunmrcpos(lun)
-
-      !write(3,*)' In lunsetpos_mrc, ihedlen,nx,ny,nz,nbyt,imgnum:',
-      !&                              ihedlen,nx,ny,nz,nbyt,imgnum
-      !write(3,*)' In lunsetpos_mrc, nbyt_per_rec:', nbyt_per_rec
-      !write(3,*)' In lunsetpos_mrc lunmrcpos:',lunmrcpos(lun)
+      !write(3,*)' In lunsetpos_mrc; imgnum,lunmrcpos(lun): ',
+      !&                             imgnum,lunmrcpos(lun)
+      !write(3,*)' In lunsetpos_mrc; ihedlen,nx,ny,nz,nbyt,imgnum: ',
+      !&                             ihedlen,nx,ny,nz,nbyt,imgnum
+      !write(3,*)' In lunsetpos_mrc; nbyt_per_rec: ', nbyt_per_rec
+      !write(3,*)' In lunsetpos_mrc; lunmrcpos: ',lunmrcpos(lun)
 
       IRTFLG = 0
       END
@@ -423,13 +483,14 @@ C     ------------------------- LUNFLIPORG_MRC ------------------------
 
 #include "LUNHDR.INC"
 
-      INTEGER         :: LUN,NX,NY,NZ,IRTFLG
-      LOGICAL         :: RESET
+      INTEGER        :: LUN,NX,NY,NZ,IRTFLG
+      LOGICAL        :: RESET
 
-      INTEGER * 8     :: LUNMRCPOS 
-      INTEGER         :: LUNMRCNBYT
-      COMMON /LUNMRC/    LUNMRCPOS(100),LUNMRCNBYT(100)
-      INTEGER         :: LUNARA,LUNSTK,LUNARB,LUNFLIP
+      INTEGER * 8    :: LUNMRCPOS 
+      INTEGER        :: LUNMRCNBYT
+      COMMON /LUNMRC/   LUNMRCPOS(100),LUNMRCNBYT(100)
+
+      INTEGER        :: LUNARA,LUNSTK,LUNARB,LUNFLIP
       COMMON /LUNARA/   LUNARA(100),LUNSTK(100),LUNARB(100),LUNFLIP(100)
 
       CHARACTER(LEN=4)  :: CAXIS
@@ -455,7 +516,7 @@ C       GET AXIS ORIGIN IN FILE NOT A STANDARD MRC DEFINED POSITION!!
 
         IF (CAXIS(1:1) == 'L') THEN    
 C         ORIGIN AT LOWER LEFT, BUT POSITION AT ONE RECORD BEFORE IMAGE
-
+          NBYT_PER_REC   = LUNMRCNBYT(LUN)
           LUNMRCPOS_SAV  = LUNMRCPOS(LUN)
           LUNMRCPOS(LUN) = LUNMRCPOS(LUN) - NZ * NY * NBYT_PER_REC
 
@@ -480,7 +541,13 @@ C     PURPOSE:  QUERIES HEADER LOCATION THAT SPECIFIES MRC FILE
       INTEGER         :: LUNMRCNBYT
       COMMON /LUNMRC/    LUNMRCPOS(100),LUNMRCNBYT(100)
 
-      IS_MRC = (LUNMRCPOS(LUN) .NE. 0)
+C     Handle invalid index (LUN=0, etc.)  Sept 2025
+      IF (LUN >= LBOUND(LUNMRCPOS, 1) .AND. 
+     &    LUN <= UBOUND(LUNMRCPOS, 1)) THEN
+          IS_MRC = (LUNMRCPOS(LUN) .NE. 0)
+      ELSE
+          IS_MRC = .FALSE.
+      ENDIF
 
       IRTFLG = 0
       END
@@ -499,12 +566,17 @@ C     POINT TO HEADER OBJECT
       MAPC = MRC_HEADER(17)
       MAPR = MRC_HEADER(18)
       MAPS = MRC_HEADER(19)
-      ! write(6,*) ' In lungetmap_mrc, map c,r,s: ',mapc,mapr,maps
+
+#if defined(SP_DBUG)
+        write(3,*) ' In lungetmap_mrc; mrc_header 17,18,19:  ',
+     &        mrc_header(17),' ',mrc_header(18),' ',mrc_header(19)      
+        write(3,*) ' In lungetmap_mrc; map c,r,s: ',mapc,mapr,maps
+#endif
 
       IRTFLG = 0
       END
 
-C     ------------------------- WHICH_HAND_MRC ----------------------------
+C     ------------------------- WHICH_HAND_MRC ------------------------
 
       SUBROUTINE WHICH_HAND_MRC(LUN,FILNAM,CAXIS,IRTFLG)
 
@@ -521,29 +593,41 @@ C               BEFORE LUNSETPOS_MRC
 
       LOGICAL             :: ISMRCSFILE
 
-C     SET AXIS ORIGIN LOCATION & VOLUME HANDEDNESS BEFORE LUNSETPOS_MRC
+C     SET AXIS ORIGIN LOCATION & VOLUME HANDEDNESS BEFORE 
+C              CALLING LUNSETPOS_MRC
 
 C     SEE IF RELION COMPATIBLE IMAGE/STACK (ALWAYS 'UL L')
       ISMRCSFILE = (INDEX(FILNAM,'.MRCS') > 1  .OR.
      &              INDEX(FILNAM,'.mrcs') > 1)
+        
+#if defined(SP_DBUG)
+      write(3,*)' In lunwhichhand_mrc; ismrcsfile: ',ismrcsfile
+      write(3,*)' In lunwhichhand_mrc; caxis   1111111: ',caxis
+#endif
 
       IF (ISMRCSFILE) THEN
 C        RELION COMPATIBLE IMAGE/STACK (ALWAYS 'UL L')
          CAXIS = 'UL L'
+
          CALL LUNSETHAND_MRC(LUN,CAXIS,IRTFLG)
-       
+         !write(3,*)' In which_hand_mrc; called sethand 22222: ',caxis
+      
       ELSE
 C        SEE IF FILE HEADER ALREADY HAS CAXIS SET
          CALL LUNGETHAND_MRC(LUN,CAXIS,IRTFLG)
          IF (IRTFLG .NE. 0) RETURN
 
          IF (INDEX(CAXIS,'L') == 0) THEN
-C           CAXIS DOES NOT CONTAIN: 'UL L', 'UL R', 'LL L' or 'LL R' (ALWAYS HAS L)
+C           CAXIS DOES NOT CONTAIN: 'UL L', 'UL R', 'LL L' or 'LL R'
+C                (ALWAYS HAS L)
+
 C           SET ORIGIN & HANDEDNESS TO CURRENT DEFAULT MRC_AXIS
             CAXIS = MRC_AXIS
             CALL LUNSETHAND_MRC(LUN,CAXIS,IRTFLG)
-         ENDIF       
-      ENDIF
+
+            !write(3,*)' In which_hand_mrc; called sethand 3333: ',caxis
+        ENDIF       
+      ENDIF 
 
       END     
 
@@ -567,7 +651,9 @@ C     POINT TO HEADER OBJECT
 
       MRC_HEADER(26) = TRANSFER(CAXIS(1:4),I4V)
 
-      !write(3,*)' In lunsethand_mrc, caxis: ',mrc_header(26),caxis
+#if defined(SP_DBUG)
+      write(3,*)' In lunsethand_mrc; in header(26) caxis: ',caxis
+#endif
 
       IRTFLG = 0
       END
@@ -591,7 +677,8 @@ C     POINT TO HEADER OBJECT
       IF (IRTFLG .NE. 0) RETURN
 
       CAXIS(1:4) = TRANSFER(MRC_HEADER(26),CSTR(1:4))
-      !write(3,*)' In lungethand_mrc, lun,caxis: ',lun,caxis
+
+      !write(3,*)' In lungethand_mrc; lun,caxis: ',lun,caxis
 
       IRTFLG = 0
       END
@@ -675,12 +762,10 @@ C               123456789 123456789 123456789 123456789
          MRC_HEADER(INOW) = TRANSFER(CVAL(1:4),I4V)
       ENDDO
 
-      !write(3,*)' In lunsetstk_mrc, iversion: ',mrc_header(23),nstack
-
       IRTFLG = 0
       END
 
-C     ------------------------- LUNSETMODSIZ_MRC ----------------------------
+C     ------------------------- LUNSETMODSIZ_MRC -----------------------
 
       SUBROUTINE LUNSETMODSIZ_MRC(LUN,MRCMODE,NX,NY,NZMRC,
      &                            MX,MY,MZ,IRTFLG)
@@ -701,23 +786,18 @@ C     POINT TO HEADER OBJECT
       MRC_HEADER(9)  = MY    ! NO. OF INTERVALS ALONG Y
       MRC_HEADER(10) = MZ    ! NO. OF INTERVALS ALONG Z (>1 = STACK)
 
-      !write(6,*) ' In lunsetmodsiz_mrc: ',mrcmode,nx,ny,nz,mx,my,mz
+      !write(3,*) ' In lunsetmodsiz_mrc: ',mrcmode,nx,ny,nz,mx,my,mz
 
       IRTFLG = 0
       END
 
-C     ------------------------- LUNSETMODE_MRC ----------------------------
+C     ------------------------- LUNSETMODE_MRC ------------------------
 
       SUBROUTINE LUNSETMODE_MRC(LUN,MRCMODE,IRTFLG)
 
 #include "LUNHDR.INC"
 
-      INTEGER         :: LUN,MRCMODE,IRTFLG
-
-      INTEGER * 8     :: LUNMRCPOS 
-      INTEGER         :: LUNMRCNBYT
-      COMMON /LUNMRC/    LUNMRCPOS(100),LUNMRCNBYT(100)
-
+      INTEGER  :: LUN,MRCMODE,IRTFLG
 
 C     POINT TO HEADER OBJECT
       CALL LUNGETOBJ_MRC(LUN,MRC_HEADER,IRTFLG)
@@ -725,34 +805,33 @@ C     POINT TO HEADER OBJECT
 
       MRC_HEADER(4) = MRCMODE
 
-      !write(3,*) ' In lunsetmode_mrc: ',mrcmode
+      !write(3,*) ' In lunsetmode_mrc; mrcmode: ',mrcmode
 
       IRTFLG = 0
       END
 
 
-C     ------------------------- LUNGETMODSIZ_MRC ----------------------
+C     ------------------------- LUNGETMODSIZES_MRC --------------------
 
-      SUBROUTINE LUNGETMODSIZ_MRC(LUN,MRCMODE,NX,NY,NZMRC,
-     &                            MX,MY,MZ,IRTFLG)
+      SUBROUTINE LUNGETMODSIZES_MRC(LUN,NX,NY,NZ,
+     &                                  MX,MY,MZ,IRTFLG)
 
 #include "LUNHDR.INC"
 
-      INTEGER  :: LUN,MRCMODE,NX,NY,NZMRC,MX,MY,MZ,IRTFLG
+      INTEGER  :: LUN,NX,NY,NZ, MX,MY,MZ,IRTFLG
 
 C     POINT TO HEADER OBJECT
       CALL LUNGETOBJ_MRC(LUN,MRC_HEADER,IRTFLG)
       IF (IRTFLG .NE. 0) RETURN
 
-      MRCMODE = MRC_HEADER(4)
       NX      = MRC_HEADER(1)
       NY      = MRC_HEADER(2)
-      NZMRC   = MRC_HEADER(3)  ! NO. OF IMAGES IN RELION mrcs FILES!
+      NZ      = MRC_HEADER(3)  ! NO. OF IMAGES IN RELION mrcs FILES! 
       MX      = MRC_HEADER(8)  ! NO. OF INTERVALS ALONG X
       MY      = MRC_HEADER(9)  ! NO. OF INTERVALS ALONG Y
       MZ      = MRC_HEADER(10) ! NO. OF INTERVALS ALONG Z (>1 = STACK)
 
-      !write(6,*) ' In lungetmodsiz_mrc: ',mrcmode,nx,ny,nz,mx,my,mz
+      !write(3,*) ' In lungetmodsizes_mrc: ',mrcmode,nx,ny,nz,mx,my,mz
 
       IRTFLG = 0
       END
@@ -771,12 +850,12 @@ C     POINT TO HEADER OBJECT
 
       MRCMODE = MRC_HEADER(4)
 
-      !write(6,*) ' In lungetmod_mrc: ',mrcmode
+      !write(3,*) ' In lungetmod_mrc; mrcmode: ',mrcmode
 
       IRTFLG = 0
       END
 
-C     ------------------------- LUNGETVIN_MRC ----------------------------
+C     ------------------------- LUNGETVIN_MRC -------------------------
 
       SUBROUTINE LUNGETVIN_MRC(LUN,IVERSION,ISPG,NSYMBT,NLABL,IRTFLG)
 
@@ -796,7 +875,7 @@ C     (23)  ISPG == 401      STACK OF EM VOLUMES
       NSYMBT   = MRC_HEADER(24)  ! NO. OF ADDITIONAL HEADER BYTES
       NLABL    = MRC_HEADER(56)  ! NO. OF LABELS
 
-      ! write(6,*) ' In lungetvin_mrc, iversion', iversion
+      ! write(3,*) ' In lungetvin_mrc; iversion', iversion
 
       IRTFLG = 0
       END
@@ -821,7 +900,7 @@ C     (23)  ISPG == 401      STACK OF EM VOLUMES
       MRC_HEADER(24) = NSYMBT ! NUMBER OF ADDITIONAL HEADER BYTES
       MRC_HEADER(56) = NLABL  ! NO. OF LABELS
 
-      !write(3,*) ' In lunsetvin_mrc, iversion', iversion,ispg
+      !write(3,*) ' In lunsetvin_mrc; iversion', iversion,ispg
 
       IRTFLG = 0
       END
@@ -846,7 +925,6 @@ C     GET ISBARE FROM HEADER OBJECT STATIC LOCATION
       IRTFLG = 0
       END
 
-
 C     --------------------- LUNSETISBARE_MRC -------------------------
 
       SUBROUTINE LUNSETISBARE_MRC(LUN,ISBARE,IRTFLG)
@@ -872,23 +950,33 @@ C     SET ISBARE IN MRC HEADER OBJECT (STATIC AREA)
 
 C     ------------------------- LUNSETFILE_MRC -----------------------
 
-      SUBROUTINE LUNSETFILE_MRC(LUN,FILNAM,DSP,IRTFLG)
+      SUBROUTINE LUNSETFILE_MRC(LUN,FILNAM, DSP,IRTFLG)
 
 #include "LUNHDR.INC"
 
       INTEGER                :: LUN,IRTFLG
       CHARACTER(LEN=*)       :: FILNAM
       CHARACTER(LEN=1)       :: DSP
+      CHARACTER(LEN=1)       :: NULL = CHAR(0)
 
-      INTEGER                :: NLET
+      INTEGER                :: NLET,LOCDOT
+      CHARACTER(LEN=4)       :: FIL_EXT
 
-      IF (FILNAM(1:1) .NE. CHAR(0)) THEN
+      IF (FILNAM(1:1) .NE. NULL) THEN
 C        SET CURRENT FILENAME IN HEADER OBJECT 
          NLET           = LNBLNKN(FILNAM)
          LUNFILNAM(LUN) = FILNAM(1:NLET)
+
+#if defined(NEVER_SP_DBUGIO)
+C23456
+         write(3,*) '  '
+         ilent = lnblnkn(filnam)
+         write(3,*)' In lunsetfile; filnam: ', filnam(1:ilent)
+         write(3,*)' In lunsetfile; lunfilnam(lun): ', lunfilnam(lun)
+#endif
       ENDIF
 
-      IF (DSP .NE. CHAR(0)) THEN
+      IF (DSP .NE. NULL) THEN
 
 C        POINT TO HEADER OBJECT
          CALL LUNGETOBJ_MRC(LUN,MRC_HEADER,IRTFLG)
@@ -898,8 +986,24 @@ C        SET DSP IN STATIC HEADER OBJECT
          MRC_HEADER(257) = 0
          IF (DSP == 'N') MRC_HEADER(257) = 1
 
+         IF (FILNAM(1:1) .NE. NULL) THEN
+            NLET     = LNBLNKN(FILNAM)
+            LOCDOT   = INDEX(FILNAM(1:NLET),'.',BACK=.TRUE.)
+
+            IF (LOCDOT > 0) THEN
+               FIL_EXT = FILNAM(LOCDOT+1:NLET)
+               NLET    = lnblnkn(FIL_EXT)
+
+               IF (NLET < 4) FIL_EXT(4:4) = ' '         
+               MRC_HEADER(27) = TRANSFER(FIL_EXT(1:4),I4V)
+            ENDIF
+         ENDIF
+
+
       ENDIF
 
+
+
       IRTFLG = 0
       END
 
@@ -954,11 +1058,13 @@ C     ------------------------- LUNSET_STATSIMG_MRC -------------------
 
       INTEGER  :: LUN,IMGSTATS,IRTFLG
 
+C     IMGSTATS IS THE CURRENT STACKED OR MAIN IMAGE NUMBER IN STATS
+
 C     POINT TO MRC HEADER OBJECT
       CALL LUNGETOBJ_MRC(LUN,MRC_HEADER,IRTFLG)
       IF (IRTFLG .NE. 0) RETURN
 
-      !write(3,*)' In lunset_statsimg_mrc, imgstats: ',imgstats
+      !write(3,*)' In lunset_statsimg_mrc; imgstats: ',imgstats
           
 C     SET MRC_HEADER VALUE
       MRC_HEADER(25) = IMGSTATS ! LOCATION: 25  IMGNUM FOR STATISTICS
@@ -973,6 +1079,7 @@ C     ------------------------- LUNGET_STATSIMG_MRC -------------------
 #include "LUNHDR.INC"
 
       INTEGER  :: LUN,IMGSTATS,IMGNUM,NSTACK,IRTFLG
+C     IMGSTATS IS THE CURRENT STACKED OR MAIN IMAGE NUMBER IN STATS
 
 C     POINT TO MRC HEADER OBJECT
       CALL LUNGETOBJ_MRC(LUN,MRC_HEADER,IRTFLG)
@@ -986,18 +1093,20 @@ C     GET MRC_HEADER VALUE
       IRTFLG = 0
       END
 
-C     ------------------------- LUNSETSTATS_MRC ----------------------------
+C     ------------------------- LUNSETSTATS_MRC -----------------------
 
       SUBROUTINE LUNSETSTATS_MRC(LUN,IMAMIT,FMINT,FMAXT,AVT,SIGT,IRTFLG)
 
 #include "LUNHDR.INC"
 
       INTEGER  :: LUN,IMAMIT,IRTFLG
-      REAL     :: FMINT,FMAXT,AVT,SIGT
+      REAL     :: FMINT,FMAXT,AVT,SIGT,f21
 
       INTEGER  :: MZ,NSTACK,IMGNUM,IVERSION,IMGSTATS
       INTEGER  :: I4V
 
+C     IMGSTATS IS THE CURRENT STACKED OR MAIN IMAGE NUMBER IN STATS
+
 C     POINT TO MRC HEADER OBJECT
       CALL LUNGETOBJ_MRC(LUN,MRC_HEADER,IRTFLG)
       IF (IRTFLG .NE. 0) RETURN
@@ -1027,24 +1136,22 @@ C        NEED IMGNUM FOR IMGSTATS
 
       ENDIF
 
-      !write(3,*)' In lunsetstats_mrc, imgnum,stats:',imgnum,imgstats
-
-
 C     SET NUMBER OF IMAGE IN STATS
       CALL LUNSET_STATSIMG_MRC(LUN,IMGSTATS,IRTFLG)
       IF (IRTFLG .NE. 0) RETURN
        
+
       IRTFLG = 0
       END
 
-C     ------------------------- LUNGETSTATS_MRC ----------------------------
+C     ------------------------- LUNGETSTATS_MRC -----------------------
 
       SUBROUTINE LUNGETSTATS_MRC(LUN,IMAMIT,FMINT,FMAXT,AVT,SIGT,IRTFLG)
 
 #include "LUNHDR.INC"
 
       INTEGER  :: LUN,IMAMIT,IRTFLG
-      REAL     :: FMINT,FMAXT,AVT,SIGT
+      REAL     :: FMINT,FMAXT,AVT,SIGT,f21
 
       INTEGER  :: IMGSTATS,IMGNUM,NSTACK
 
@@ -1061,7 +1168,7 @@ C     GET MRC_HEADER VALUES
 C     MRC FILE ENCODES IMAMI IN RELATIVE VALUES FOR MIN/MAX      
       IMAMIT = 1
       IF (FMAXT < FMINT) IMAMIT = 0
-      IF (AVT   < FMINT) IMAMIT = 0
+      IF (AVT   < FMINT)  IMAMIT = 0
       IF (SIGT  < 0.0)   IMAMIT = 0
 
 C     IF ALL ZERO STATISTICS ARE PROBABLY NOT SET!! 
@@ -1074,6 +1181,20 @@ C     ARE STATS FOR THE CURRENT MRC IMAGE?
 C        THIS IS A MRC STACKED IMAGE BUT IMG NOT = IMG IN STATISTICS
          IMAMIT = 0
          !FMAXT  = FMINT - 1
+
+#if defined(SP_DBUG)
+!      f21 = TRANSFER(mrc_header(21),f21)
+
+!      write(3,'(A,I5,2X,F8.1,2X,F8.2)')
+!     &     '  In lunGetstats_mrc; lun,fmaxt,mrc_header(21):',
+!     &        lun,fmaxt,f21
+
+!      write(3,'(A,I5,2X,3(2x,I8))')
+!     &     '  In lunGetstats_mrc; nstack,imgnum,imgstats,imamit:',
+!     &                            nstack,imgnum,imgstats,imamit
+C      write(3,*)'  '
+#endif
+
          CALL LUNSETSTATS_MRC(LUN,IMAMIT,FMINT,FMAXT,AVT,SIGT,IRTFLG)
 
       ELSEIF (NSTACK > 1 .AND. IMGNUM < 0 ) THEN
@@ -1082,9 +1203,24 @@ C        THIS IS A MRC STACK BUT NO IMAGE SPECIFIED
          FMAXT  = FMINT - 1
       ENDIF
 
-      !write(3,*)' In lungetstats_mrc stats:',fmint,fmaxt,avt,sigt
-      !write(3,*)' In lungetstats_mrc fmin,fmax,imami:',fmint,fmaxt,imamit
-      !write(3,*)' In lungetstats_mrc imgstats,imgnum: ',imgstats,imgnum
+#if defined(SP_DBUG)
+
+!      f21 = TRANSFER(mrc_header(21),f21)
+!      write(3,'(A,I5,2X,F8.1,2X,F8.2)')
+!     &     '  In lunGetstats_mrc; lun,fmaxt,mrc_header(21):',
+!     &        lun,fmaxt,f21
+
+!      write(3,'(A,3I7)')
+!     &     '  In lunGetstats_mrc;  mrc_header 17,18,19: ',
+!     &         mrc_header(17),mrc_header(18),mrc_header(19)
+
+!      write(3,'(A,I5,2X,3(2x,I8))')
+!     &     '  In lunGetstats_mrc; nstack,imgnum,imgstats,imamit:',
+!     &                            nstack,imgnum,imgstats,imamit
+
+!      write(3,*)' Leaving lunGetstats_mrc ------'
+!      write(3,*)'  '
+#endif
 
       IRTFLG = 0
       END
@@ -1127,6 +1263,26 @@ C     PUT UNKNOWN STAT'S IMAGE NUMBER IN FILE HEADER
       CALL LUNSET_STATSIMG_MRC(LUN,0,IRTFLG)
       IF (IRTFLG .NE. 0) RETURN
 
+#if defined(SP_BACK)
+      CALL BACKTRACE 
+#endif
+ 
+#if  defined(SP_DBUG)
+      f21 = TRANSFER(mrc_header(21),f21)
+!      write(3,'(A,I5,2X,F8.1,2X,F8.2)')
+!     &     '  In lunZerostats_mrc; lun,fmax,mrc_header(21):',
+!     &        lun,fmax,f21
+
+!      write(3,'(A,3I7)')
+!     &     '  In lunZerostats_mrc;  mrc_header 17,18,19: ',
+!     &         mrc_header(17),mrc_header(18),mrc_header(19)
+
+!      write(3,*)' Leaving lunZerostats_mrc ------'
+!      write(3,*)'  '
+#endif
+
+
+
       IRTFLG = 0
       END
 
@@ -1200,11 +1356,11 @@ C     POINT TO HEADER OBJECT
       CELLAY = PIXSIZ * NY
       CELLAZ = PIXSIZ * NZ
 
-c      write(3,*) ' In lunsetpixsiz_mrc, nx...: ',nx,ny,nz
-c      write(3,*) ' In lunsetpixsiz_mrc, sizex...: ',
-c     &                                   sizex,sizey,sizez
-c      write(3,*) ' In lunsetpixsiz_mrc, cellax...: ',
-c     &                                   cellax,cellay,cellaz
+!      write(3,*) ' In lunsetpixsiz_mrc, nx...: ',nx,ny,nz
+!      write(3,*) ' In lunsetpixsiz_mrc, sizex...: ',
+!     &                                  sizex,sizey,sizez
+!      write(3,*) ' In lunsetpixsiz_mrc, cellax...: ',
+!     &                                  cellax,cellay,cellaz
 
 
 C     SET HEADER VALUES FOR PIXEL SIZE * NO. PIXELS IN CELL
@@ -1240,14 +1396,14 @@ C     POINT TO HEADER OBJECT
       CELLAY = SIZEY * NY
       CELLAZ = SIZEZ * NZ
 
-c      write(3,*) ' In lunsetpixsiz_mrc, nx...: ',nx,ny,nz
-c      write(3,*) ' In lunsetpixsiz_mrc, sizex...: ',
-c     &                                   sizex,sizey,sizez
-c      write(3,*) ' In lunsetpixsiz_mrc, cellax...: ',
-c     &                                   cellax,cellay,cellaz
+!      write(3,*) ' In lunsetpixsiz_mrc; nx...: ',nx,ny,nz
+!      write(3,*) ' In lunsetpixsiz_mrc; sizex...: ',
+!     &                                  sizex,sizey,sizez
+!      write(3,*) ' In lunsetpixsiz_mrc; cellax...: ',
+!     &                                  cellax,cellay,cellaz
 
 
-C     SET HEADER VALUES FOR PIXEL SIZE * NO. PIXELS IN CELL
+!     SET HEADER VALUES FOR PIXEL SIZE * NO. PIXELS IN CELL
       MRC_HEADER(11) = TRANSFER(CELLAX, IV4)
       MRC_HEADER(12) = TRANSFER(CELLAY, IV4)
       MRC_HEADER(13) = TRANSFER(CELLAZ, IV4)
@@ -1256,8 +1412,7 @@ C     SET HEADER VALUES FOR PIXEL SIZE * NO. PIXELS IN CELL
       END
 
 
-
-C     ------------------------- LUNSETANGS_MRC ----------------------------
+!     ------------------------- LUNSETANGS_MRC ------------------------
 
       SUBROUTINE LUNSETANGS_MRC(LUN,NANG,ANGS,IRTFLG)   !UNUSED??
 
@@ -1287,7 +1442,7 @@ C     SET HEADER VALUES FOR ANGLES
       IRTFLG = 0
       END
 
-C     ------------------------- LUNGETANGS_MRC ----------------------------
+C     ------------------------- LUNGETANGS_MRC ------------------------
 
       SUBROUTINE LUNGETANGS_MRC(LUN,NANG,ANGS,IRTFLG)  !! UNUSED
 
@@ -1317,7 +1472,7 @@ C     RETRIEVE HEADER VALUES FOR ANGLES
       IRTFLG = 0
       END
 
-C     ------------------------- LUNGETSIZE_MRC ----------------------------
+C     ------------------------- LUNGETSIZE_MRC ------------------------
 
       SUBROUTINE LUNGETSIZE_MRC(LUN,NX,NY,NZ,IRTFLG)
 
@@ -1352,12 +1507,12 @@ C     RETRIEVE CURRENT FILENAME (INCLUDES IMGNUM IF STACKED IMAGE)
      &    INDEX(FILNAM(1:NLET),'.MRCS') > 0) THEN 
          NZ = 1    ! RELION MRC IMAGE STACK
       ENDIF
-      !write(3,*) ' In lunsetmrchdr, filnam:',filnam(1:nlet), nz
+      !write(3,*) ' In lunsetmrchdr; filnam: ',filnam(1:nlet), nz
 
       IRTFLG = 0
       END
 
-C     ------------------------- LUNGETVALS_R_MRC ------------------------
+C     ------------------------- LUNGETVALS_R_MRC ----------------------
 
       SUBROUTINE LUNGETVALS_R_MRC(LUN,IGO,NVAL,BUFOUT,IRTFLG)
 
@@ -1422,7 +1577,7 @@ C     GET REAL RETURN VALUES
       IRTFLG = 0
       END
 
-C     ------------------------- LUNSETVALS_R_MRC ------------------------
+C     ------------------------- LUNSETVALS_R_MRC ----------------------
 
       SUBROUTINE LUNSETVALS_R_MRC(LUN,IGO,NVAL,BUFVALS,IRTFLG)
 
@@ -1473,7 +1628,7 @@ C     HACK FOR TRANSLATING MRC IAPLOC INSTEAD OF SPIDER LOCATIONS
 
 C     SET HEADER VALUES WRITTEN AS I*4
       DO I = IGOMRC,IEND
-         !write(6,*) ' bufvals: ',jenis(i),bufvals(i-igomrc+1)
+         !write(3,*) ' Bufvals: ',jenis(i),bufvals(i-igomrc+1)
 
          IF (JENIS(I) == 2) THEN
             MRC_HEADER(I) = TRANSFER(BUFVALS(I-IGOMRC+1),I4V)   
@@ -1492,7 +1647,7 @@ C           CONVERT REAL VALUE TO INTEGER
       IRTFLG = 0
       END
 
-C     ------------------------- LUNGETTYPE_MRC ----------------------------
+C     ------------------------- LUNGETTYPE_MRC ------------------------
 
       SUBROUTINE LUNGETTYPE_MRC(LUN,ITYPE,IRTFLG)
 
@@ -1513,65 +1668,75 @@ C     RETURN FILE TYPE USING SPIDER'S CONVENTION
       IRTFLG = 0
       END
 
-C     ------------------------- LUNGETSTK_MRC----------------------------
+C     ------------------------- LUNGETSTK_MRC -------------------------
 
-       SUBROUTINE LUNGETSTK_MRC(LUN,MZ,NSTACK,IMGNUM,IRTFLG)
+       SUBROUTINE LUNGETSTK_MRC(LUN,MZ,NSTK,ISTK,IRTFLG)
 
 #include "LUNHDR.INC"
 
-      INTEGER   :: LUN,MZ,NSTACK,IMGNUM,IRTFLG
+      INTEGER   :: LUN,MZ,NSTK,IMGNUM,IRTFLG
 
 C     POINT TO MRC HEADER OBJECT
       CALL LUNGETOBJ_MRC(LUN,MRC_HEADER,IRTFLG)
       IF (IRTFLG .NE. 0) RETURN
 
 C     GET RETURN VALUES
-      MZ     = MRC_HEADER(10)    ! CAN BE NSTACK 
-      IMGNUM = MRC_HEADER(259)   ! CURRENT IMAGE IN HEADER
-      NSTACK = MRC_HEADER(260)   ! NUMBER OF IMAGES/VOLUMES IN STACK
+      MZ   = MRC_HEADER(10)    ! CAN BE NSTK 
+      ISTK = MRC_HEADER(259)   ! CURRENT IMG/VOL IN HEADER
+      NSTK = MRC_HEADER(260)   ! NUMBER OF IMAGES/VOLUMES IN STACK
 
       IRTFLG = 0
       END
 
-C     ------------------------- LUNSETSTK_MRC----------------------------
+C     ------------------------- LUNSETSTK_MRC--------------------------
 
-      SUBROUTINE LUNSETSTK_MRC(LUN,IMGNUM,NSTACK,IRTFLG)
+      SUBROUTINE LUNSETSTK_MRC(LUN,ISTK,NSTK,IRTFLG)
 
 #include "LUNHDR.INC"
 
-      INTEGER  :: LUN,IMGNUM,NSTACK,IRTFLG
+      INTEGER  :: LUN,ISTK,NSTK,IRTFLG
 
 C     POINT TO MRC HEADER OBJECT
       CALL LUNGETOBJ_MRC(LUN,MRC_HEADER,IRTFLG)
       IF (IRTFLG .NE. 0) RETURN
 
 C     SET STACK RELATED STATIC HEADER VALUES
-      MRC_HEADER(259) = IMGNUM  ! CURRENT IMAGE IN HEADER
-      MRC_HEADER(260) = NSTACK  ! NUMBER OF IMAGES/VOLUMES IN STACK
+      MRC_HEADER(259) = ISTK  ! CURRENT IMG/VOL IN HEADER
+      MRC_HEADER(260) = NSTK  ! NUMBER OF IMAGES/VOLUMES IN STACK
  
-      ! write(3,*)' In lunsetstk_mrc, nstack: ',nstack
+      ! write(3,*)' In lunsetstk_mrc; istk,nstk: ',istk,nstk
 
       IRTFLG = 0
       END
 
-C     ------------------------- LUNGETNSTACK_MRC----------------------------
+C     ------------------------- LUNGETNSTACK_MRC ----------------------
 
-       SUBROUTINE LUNGETNSTACK_MRC(LUN, NX,NY,NZ,MZ,NSTACK,IRTFLG)
+       SUBROUTINE LUNGETNSTACK_MRC(LUN, NX,NY,NZ, NZ3,NSTK_FLG,IRTFLG)
 
-C      PURPOSE: GET SPIDER'S NSTACK FROM MRC HEADER INFO 
+C      PURPOSE: GET SPIDER'S NSTACK FROM MRC HEADER INFO (NOT FILE)
 C               MRC FILES LACK STANDARD ENCODING FOR STACK SIZE
 C               AND SOME VOLUMES LOOK LIKE STACKS SO THIS IS COMPLEX!!
-
-C      RETURNS:   NZ   MZ    NSTACK 
+C
+C      RETURNS:   NX,NY,NZ, NZ3,NSTK_FLG 
+C
+C      VARIABLES FOR MRC 2014
+C                 ISPG (23)   NZ (3)     MZ (10)
+C       IMAGE           0      1          1
+C       IMAGE STACK     0     NSTK       NSTK
+C       VOLUME (Z)      1     NZ         NZ
+C       VOLUME STACK  401     NZ*NSTK    NZ/NSTK
+       
+C      IMPLICIT NONE
 
 #include "LUNHDR.INC"
       INCLUDE 'CMLIMIT.INC'
 
-      INTEGER                :: LUN,NX,NY,NZ,MZ,NSTACK,IRTFLG
+      INTEGER                :: LUN,NX,NY,NZ, MZ,NSTK_FLG,IRTFLG
 
       CHARACTER (LEN=MAXNAM) :: FILNAM     
       CHARACTER (LEN=1)      :: DSP
-      INTEGER                :: NZMRC,NLET,IVERSION,ISPG
+      CHARACTER (LEN=4)      :: cloc27
+      INTEGER                :: NZ3,NLET,IVERSION,ISPG
 
       INTEGER                :: lnblnkn   ! FUNCTION
 
@@ -1582,69 +1747,154 @@ C     POINT TO MRC HEADER OBJECT
 C     GET HEADER VALUES
       NX       = MRC_HEADER(1) 
       NY       = MRC_HEADER(2) 
-      NZMRC    = MRC_HEADER(3)   ! NO. OF IMAGES IN RELION mrcs FILES!
-      MZ       = MRC_HEADER(10)  ! CAN BE EITHER NSTACK OR NZ 
+      NZ3      = MRC_HEADER(3)   ! NO. OF IMAGES IN RELION mrcs FILES!
+
+      MZ       = MRC_HEADER(10)  ! CAN BE EITHER NSTK OR NZ 
+      cloc27   = TRANSFER(MRC_HEADER(27),cloc27)   
       IVERSION = MRC_HEADER(28)
       ISPG     = MRC_HEADER(23)
-      !write(3,*)' In lungetnstack, :', iversion,ispg
-      !write(3,*)' In lungetnstack, :', nzmrc,mz,nz,nstack
+
+#if defined(SP_DBUGIO)
+C23456
+      write(3,*)  '  '
+      write(3,*)' In lungetnstack; iversion,ispg: ', iversion,ispg
+      write(3,*)' In lungetnstack; nz3,mz:        ', nz3,mz
+#endif
 
 C     GET CURRENT FILE NAME FROM LUNFILNAM COMMON
       CALL LUNGETFILE_MRC(LUN,FILNAM,NLET,DSP,IRTFLG)
       IF (IRTFLG .NE. 0) RETURN
-      !write(3,*)' In lungetnstack, nlet,filnam:', nlet,filnam(1:nlet)
 
-      IF (INDEX(FILNAM(1:NLET),'.mrcs') > 0 .OR.
-     &    INDEX(FILNAM(1:NLET),'.MRCS') > 0) THEN
-C        HACK FOR RELION mrcs IMAGE STACKS HAVING NZ > 1
+#if defined(SP_DBUGIO)
+C23456
+      write(3,*)' In lungetnstack; dsp,nlet:        ', dsp,nlet
+      write(3,*)' In lungetnstack; filnam:          ', filnam(1:nlet)
+#endif
+
+
+      IF (IVERSION >= 20140 .AND. ISPG == 0) THEN
+C        IMAGE OR IMAGES STACK
+
+         IF (NZ3 == 1 .AND. MZ == 1) THEN ! --------------------
+C           SINGLE IMAGE FILE - MRC VERSION 20140
+            NZ       = 1
+            NSTK_FLG = -2
+
+#if defined(SP_DBUGIO)
+            write(3,*)' In lungetnstack 11; nz,nstk_flg:', nz,nstk_flg
+#endif
+
+         ELSEIF (NZ3 == 1 .AND. MZ > 1) THEN  ! ------------
+C           IMAGE STACK FILE IN - MRC VERSION 20140
+            NZ       = 1
+            NSTK_FLG = MZ
+
+#if defined(SP_DBUGIO)
+            write(3,*)' In lungetnstack 22; nz,nstk_flg:', nz,nstk_flg
+#endif
+         ENDIF
+
+
+      ELSEIF (IVERSION >= 20140 .AND. ISPG == 1) THEN  ! ------------
+C        SINGLE VOLUME FILE - MRC VERSION 20140
+         NZ       = NZ3  ! nz3=348 mz=348  ispg=1 ll 
+         NSTK_FLG = -2
+
+#if defined(SP_DBUGIO)
+         write(3,*)' In lungetnstack 33; nz,nstk_flg:', nz,nstk_flg
+#endif
+
+
+      ELSEIF (IVERSION >= 20140 .AND. ISPG >= 401 ) THEN ! ----------
+C        STACK OF VOLUMES IN FILE - MRC VERSION 20140
+
+         NZ       = MZ
+         NSTK_FLG = NZ3 / MZ
+
+#if defined(SP_DBUGIO)
+         write(3,*)' In lungetnstack 44; nz,nstk_flg:', nz,nstk_flg
+#endif
+
+
+
+      ELSEIF (INDEX(FILNAM(1:NLET),'.mrcs') > 0 .OR.
+     &        INDEX(FILNAM(1:NLET),'.MRCS') > 0) THEN ! ----------
+
+C        MAY NEED HACK FOR RELION mrcs IMAGE STACKS HAVING NZ > 1
 C        IN RELION  THIS WAS A STACK OF IMAGES NOT A VOLUME
-         NZ     = 1        ! DO NOT WANT TO OVERWRITE THIS??
-         NSTACK = NZMRC    ! WAS NZ IN FILE
+C          NZ       = 1        
+C          MZ       = 1
+C          NSTK_FLG = NZ3      ! WAS NZ IN FILE
+
+         NZ       = 1
+         NSTK_FLG = NZ3
+
+#if defined(SP_DBUGIO)
+         write(3,*)' In lungetnstack 55; nz,nstk_flg:', nz,nstk_flg
+#endif 
+ 
 
       ELSEIF (INDEX(FILNAM(1:NLET),'.map') > 0 .OR.
-     &        INDEX(FILNAM(1:NLET),'.MAP') > 0) THEN
+     &        INDEX(FILNAM(1:NLET),'.MAP') > 0) THEN  ! ----------
 C        HACK FOR EMD VOLUME 
-         NZ     = NZMRC    ! DO NOT WANT TO OVERWRITE THIS??
-         NSTACK = -2       ! WAS NZ IN FILE
-         !write(3,*)' In lungetnstack 1, :', nz,nstack
 
-      ELSEIF (INDEX(FILNAM(1:NLET),'@') > 0 .AND. 
-     &        NZMRC == 1 .AND. MZ == 1) THEN
+         NZ       = NZ3      ! 
+         NSTK_FLG = -2       ! ???????
+
+#if defined(SP_DBUGIO)
+         write(3,*)' In lungetnstack 66; nz,nstk_flg:', nz,nstk_flg
+#endif
+
+      ELSEIF (INDEX(FILNAM(1:NLET),'@') >0 .AND. 
+     &        NZ3 == 1 .AND. MZ == 1) THEN            ! ----------
 C        HACK FOR IMAGE STACKS CONTAINING ONLY ONE IMAGE
-         NZ     = 1        ! 
-         NSTACK = 1        !  
-         !write(3,*)' In lungetnstack 2, :', nz,nstack
-
-      ELSEIF (ISPG == 0 .AND. MZ > 1 .AND. IVERSION == 20140) THEN
-C        STACK OF IMAGES IN NEW MRC FORMAT VERSION
-         NZ     = 1
-         NSTACK = MZ
-         !write(3,*)' In lungetnstack 3, :', nz,nstack
-
-      ELSEIF (ISPG >= 410) THEN
-C        STACK OF VOLUMES IN NEW MRC FORMAT VERSION
-         NZ     = NZMRC
-         NSTACK = MZ
-         !write(3,*)' In lungetnstack 4, :', nz,nstack
-
-      ELSEIF (MZ > 1 .AND. NZMRC == MZ) THEN
-C        VOLUME 
-         NZ     = NZMRC
-         NSTACK = -2
-         !write(3,*)' In lungetnstack 5, :', nz,nstack
+         NZ       = 1        ! 
+         NSTK_FLG = 1        ! 
+ 
+#if defined(SP_DBUGIO)
+         write(3,*)' In lungetnstack 77; nz,nstk_flg:', nz,nstk_flg
+#endif
 
-      ELSE
+      ELSEIF (MZ > 1 .AND. NZ3 == MZ) THEN            ! ----------
+C        SINGLE VOLUME                            
+         NZ       = NZ3
+         NSTK_FLG = -2     ! NOT STACK, RETURN NEGATIVE (-2)
+
+#if defined(SP_DBUGIO)
+         write(3,*)' In lungetnstack 88; nz,nstk_flg:', nz,nstk_flg
+#endif
+
+      ELSE                                            ! ----------
 C        VOLUME/IMAGE.  NOT A STACK
-         NZ     = NZMRC
-         NSTACK = -2     ! NOT STACK, RETURN NEGATIVE (-2)
-         !write(3,*)' In lungetnstack 6, :', nz,nstack
+         NZ       = NZ3
+         NSTK_FLG = -2     ! NOT STACK, RETURN NEGATIVE (-2)
+
+#if defined(SP_DBUGIO)
+         write(3,*)' In lungetnstack 99; nz,nstk_flg:', nz,nstk_flg
+#endif
       ENDIF
 
-      !write(3,*)' In lungetnstack, ispg,nz,nstack:',ispg,nz,nstack
+
+#if defined(SP_DBUGIO)
+C23456  
+      write(3,*)' In lungetnstack 99999; dsp,nlet: ', dsp,nlet
+      write(3,*)' In lungetnstack 99999; filnam:   ', filnam(1:nlet)
+      write(3,*)' In lungetnstack 99999; iversion,ispg:', iversion,ispg
+      write(3,*)' In lungetnstack 99999; loc27:        ', loc27
+
+      write(3,*)' In lungetnstack 99999, nz,mz:    ', nz,mz
+      write(3,*)' In lungetnstack 99999, nstk_flg; ', nstk_flg
+      write(3,*)  '    '
+#endif
+
       IRTFLG = 0
       END
 
-C     ------------------------- LUNSETNSTACK_MRC----------------------------
+
+
+
+
+C     -------------------- LUNSETNSTACK_MRC --------------------------
 
        SUBROUTINE LUNSETNSTACK_MRC(LUN, NZ,NSTACK,IRTFLG)
 
@@ -1681,7 +1931,7 @@ C        A RELION COMPATIBLE IMAGE STACK
          NZMRC  = NSTACK         
          MZ     = 1
 
-      ELSEIF (NSTACK >= 1 .AND. NZ == 1 .AND.
+      ELSEIF (NSTACK >= 1 .AND. NZ == NSTACK .AND.
      &        IVERSION == 20140 .AND. ISPG == 0) THEN
 C        A 2014 STANDARD STACK OF IMAGES
          NZMRC  = NZ                     
@@ -1828,51 +2078,87 @@ C     SET RESERVED REGISTER VALUES AS NEEDED (SELDOM USED NOW??)
       IRTFLG = 0
       END
 
-C     ------------------------- LUNGETLABELS_MRC ----------------------------
+C     ------------------------- LUNGETLABELS_MRC -----------------------
 
       SUBROUTINE LUNGETLABELS_MRC(LUN,NLABL,LABELS,IRTFLG)
 
 #include "LUNHDR.INC"
 
       INTEGER            :: LUN,NLABL,IRTFLG 
-      CHARACTER(LEN=800) :: LABELS
+C     CHARACTER(LEN=800) :: LABELS    ; GFORT COMPILER ERROR SEPT 2025
+      CHARACTER(LEN=*)   :: LABELS
 
       INTEGER            :: INOW,I,IGO,IEND,IFLIP
+      INTEGER            :: IGOL,IENDL,IGOH,IENDH,IL
+
       CHARACTER(LEN=4)   :: CSTR
 
 C     POINT TO MRC HEADER OBJECT
       CALL LUNGETOBJ_MRC(LUN,MRC_HEADER,IRTFLG)
       IF (IRTFLG .NE. 0) RETURN
 
-      IF (NLABL > 0) THEN
-C        GET LABELS
+      IRTFLG = 1    ! Default error return Sept 2025
 
-         INOW = 1
-         DO I = 57,56 + NLABL * 20      ! 57...57+2*20
-            LABELS(INOW:INOW+3) = TRANSFER(MRC_HEADER(I),CSTR(1:4))
-            INOW = INOW + 4
-         ENDDO
+      !write(3,*)' In lungetlabels_mrc, nlabl:',nlabl
 
-         CALL LUNGETFLIP(LUN,IFLIP,IRTFLG)
-         IF (IFLIP == 1 ) THEN
-            IEND = NLABL * 80
-            CALL REVERSEBYTES(LABELS,IEND,IRTFLG)
-         ENDIF
+      IF (NLABL < 0 .OR. NLABL > 80) THEN
+          write(3,*) ' In lungetlabels_mrc, Bad nlabl: ',nlabl
+          RETURN  ! Stop if we would overflow
+      ENDIF
 
-C        STRIP LEADING BLANKS FROM LABELS (UNTIDY HACK)
-         DO ILAB=1,NLABL
-            IGO  = (ILAB - 1) * 80 + 1
-            IEND = IGO + 80 - 1
-            DO I = IGO,IEND
-               IF (LABELS(I:I) .NE. ' ') THEN
-                   LABELS(IGO:IEND) = LABELS(I:IEND)
-                  EXIT
-               ENDIF
-            ENDDO
-         ENDDO
+C     GET THE EXISTING NLABL LABELS
+
+      IGOL  = 1
+      IENDL = NLABL * 20
+
+      IGOH  = 57
+      IENDH = 56 + NLABL * 20
+
+      IL    = -3
+
+      !write(3,*)' In lungetlabels_mrc, len(labels):',len(labels)
+      !write(3,*)' In lungetlabels_mrc, nlabl,igoh,iendh,il: ',
+      !&                                 nlabl,igoh,iendh,il 
+ 
+      DO IH = IGOH,IENDH      ! 57...57+2*20
+
+        IL = IL + 4
+
+        !write(3,*)' In lungetlabels_mrc, ih,il:',ih,il
  
+        LABELS(IL:IL+3) = TRANSFER(MRC_HEADER(IH),CSTR(1:4))
+
+        !write(3,*)' In lungetlabels_mrc, ih,il,labels: ',
+        !&                                ih,il,labels(il:il+3) 
+      ENDDO
+      IGOL  = 1
+
+      !write(3,*)' In lungetlabels_mrc, labels(1:80): ',
+      !&                                labels(1:80) 
+
+      CALL LUNGETFLIP(LUN,IFLIP,IRTFLG)
+
+      IF (IFLIP == 1 ) THEN
+c        write(3,*) ' In lungetlabels, iflip: ',iflip
+
+         IEND = NLABL * 80
+         CALL REVERSEBYTES(LABELS,IEND,IRTFLG)
       ENDIF
 
+C     STRIP LEADING BLANKS FROM LABELS (UNTIDY HACK)
+      DO ILAB = 1,NLABL
+         IGO  = (ILAB - 1) * 80 + 1
+         IEND = IGO + 80 - 1
+         IF (IEND > LEN(LABELS)) RETURN   ! Stop if overflow
+
+         DO I = IGO,IEND
+            IF (LABELS(I:I) .NE. ' ') THEN
+                LABELS(IGO:IEND) = LABELS(I:IEND)
+                EXIT
+            ENDIF
+         ENDDO
+      ENDDO
+
       IRTFLG = 0
       END
 
@@ -1883,7 +2169,8 @@ C     ------------------------- LUNSAYINFO_MRC ------------------------
       INCLUDE 'CMLIMIT.INC'
       INCLUDE 'CMBLOCK.INC'
 
-      INTEGER              :: LUN,SAYIT,IRTFLG
+      INTEGER              :: LUN,IRTFLG
+      LOGICAL              :: SAYIT
 
       INTEGER              :: ITYPE,NSTACK,NX,NY,NZ,IMGNUM
       INTEGER              :: LENLABEL1,HEDBYT
@@ -1909,7 +2196,11 @@ C     SET ICOMM AND MYPID
 
 C     RETRIEVE SPIDER'S ITYPE  
       CALL LUNGETTYPE_MRC(LUN,ITYPE,IRTFLG)
-      !write(6,*) 'In lunsayinfo_mrc,  type:',itype
+
+#if defined(SP_DBUGIO)
+C23456      
+      !write(3,*) 'In lunsayinfo_mrc   0 | type:',itype
+#endif
 
 C     RETRIEVE MRC MODE 
       CALL LUNGETMODE_MRC(LUN,MRCMODE,IRTFLG)
@@ -1928,18 +2219,31 @@ C     RETRIEVE MRC MODE
 
 C     RETRIEVE CURRENT HEADER NSTACK & IMGNUM
       CALL LUNGETSTK_MRC(LUN,MZ,NSTACK,IMGNUM,IRTFLG)
-      !write(3,*)' In lunsayinfo,  mz,nstack,imgnum 1:',mz,nstack,imgnum
+
+#if defined(SP_DBUGIO)
+C23456      
+      write(3,*)' In lunsayinfo_mrc  1 | mz,nstack,imgnum: ',
+     &                                   mz,nstack,imgnum
+#endif
 
 C     RETRIEVE SIZE
       CALL LUNGETNSTACK_MRC(LUN, NX,NY,NZ,MZ,NSTACK,IRTFLG)
-      !write(3,*)' In lunsayinfo,  mz,nstack,imgnum 2:',mz,nstack,imgnum
+
+#if defined(SP_DBUGIO)
+C23456      
+      write(3,*)' In lunsayinfo_mrc   2 | nz,mz,nstack:     ',
+     &                                    nz,mz,nstack 
+#endif
 
       IF     (ITYPE == 1 .AND. NSTACK > 0) THEN
           TYPEF = 'MRC-' // MODE_STR // ' S2'
+
       ELSEIF (ITYPE == 3 .AND. NSTACK > 0) THEN
           TYPEF = 'MRC-' // MODE_STR // ' S3'
+
       ELSEIF (ITYPE == 1) THEN
           TYPEF = 'MRC-' // MODE_STR // ' 2'
+
       ELSEIF (ITYPE == 3) THEN
           TYPEF = 'MRC-' // MODE_STR // ' 3'
       ENDIF
@@ -1951,7 +2255,14 @@ C     GET DATA ORIGIN & HANDEDNES
 
 C     RETRIEVE CURRENT FILENAME (INCLUDES IMGNUM IF STACKED IMAGE)
       CALL LUNGETFILE_MRC(LUN,FILNAM,NLET,DSP,IRTFLG)
-      !write(3,*) ' In lungetfile, nlet,filnam:', nlet,filnam(1:nlet)
+
+#if defined(SP_DBUGIO)
+C23456
+      write(3,*)' In lunsayinfo_mrc   3 | nlet,filnam: ',
+     &                                    nlet,filnam(1:nlet)
+
+      write(3,*) ' '
+#endif
       
 C     GET HEADER EXTRA LENGTH = NSYMBT 
       CALL LUNGETVIN_MRC(LUN,IVERSION,ISPG,NSYMBT,NLABL,IRTFLG)
@@ -1998,7 +2309,17 @@ C           SIMPLE IMAGE
       ENDIF     ! END OF USE_SPIRE
 
 
-      !write(3,*) ' In lunsayinfo - imgnum,nstack,mz:',imgnum,nstack,mz
+#if defined(SP_DBUGIO)
+      write(3,*) ' '
+      write(3,*)' In lunsayinfo_mrc   4 | imgnum,nstack,mz: ',
+     &                                    imgnum,nstack,mz
+      write(3,*)' In lunsayinfo_mrc   4 | filnam: ',filnam(:nlet)
+      write(3,*) ' '
+#endif
+
+
+
+
       IF (VERBOSE .AND. IFOUND .NE. -4) THEN
 C         PRINT FILE OPENING INFORMATION
 
@@ -2013,7 +2334,8 @@ C           HAS FILENAME BUT NO LABEL1
          ELSEIF (LENT > 0 .AND. LENT < 70) THEN
 C           HAS FILENAME AND LABEL1 THAT FIT ON ONE LINE
             IF (MYPID <= 0) THEN
-             WRITE(NOUT,*) ' ',FILNAM(:NLET),'     /',LABEL1(:LENLABEL1)
+               WRITE(NOUT,*) ' ',FILNAM(:NLET),'     /',
+     &                       LABEL1(1:LENLABEL1)
             ENDIF
 
          ELSEIF (LENT > 0) THEN
@@ -2025,7 +2347,14 @@ C           HAS FILENAME AND LABEL1 THAT DO NOT FIT ON SINGLE LINE
             ENDIF
          ENDIF
 
-      !write(3,*)' In lunsayinfo - imgnum,nstack,mz:',imgnum,nstack,mz
+
+#if defined(SP_DBUGIO)
+         write(3,*)' In lunsayinfo_mrc   5 | imgnum,nstack,mz:',
+     &                                       imgnum,nstack,mz
+         write(3,*) '  '
+#endif
+
+
 
          IF (NSTACK >= 0 .AND. IMGNUM == 0 .AND. NZ > 1) THEN
 C           OVERALL STACKED VOLUME FILE
@@ -2054,8 +2383,37 @@ C           STACKED VOLUME
      &                ' HEADER BYTES: ',I0,'  AXIS:(',A,')')
             ENDIF
 
+         ELSE IF (IMGNUM == 1 .AND. NSTACK < 0 ) THEN
+C           SIMPLE IMAGE
+
+#if defined(SP_DBUGIO)
+            write(3,*)' In lunsayinfo_mrc   6 | nz,mz:',
+     &                                          nz,mz
+            write(3,*)' In lunsayinfo_mrc   6 | imgnum,nstack:',
+     &                                          imgnum,nstack
+            write(3,*) ' '
+#endif
+
+            IF (MYPID <= 0) THEN
+               WRITE(NOUT,921)TYPEF(:LT),NX,NY,  DTP,
+     &                        HEDBYT,CAXIS(:2)
+921            FORMAT('  (',A,') ',2(I0,1X), 2X,A,
+     &                ' HEADER BYTES: ',I0,'  AXIS:(',A,')')
+            ENDIF
+
+
+
          ELSE IF (IMGNUM > 0) THEN
 C           STACKED IMAGE
+
+#if defined(SP_DBUGIO)
+            write(3,*)' In lunsayinfo_mrc  7 | nz,mz:',
+     &                                         nz,mz
+            write(3,*)' In lunsayinfo_mrc  7 | imgnum,nstack:',
+     &                                         imgnum,nstack
+            write(3,*) ' '
+#endif
+
             IF (MYPID <= 0) THEN
                WRITE(NOUT,920)TYPEF(:LT),NX,NY, IMGNUM, DTP,
      &                        HEDBYT,CAXIS(:2)
@@ -2063,6 +2421,7 @@ C           STACKED IMAGE
      &                ' HEADER BYTES: ',I0,'  AXIS:(',A,')')
             ENDIF
 
+
          ELSE IF (NZ > 1) THEN
 C           SIMPLE VOLUME
             IF (MYPID <= 0) THEN
diff --git src/makeall src/makeall
old mode 100755
new mode 100644
diff --git src/nextversion.f src/nextversion.f
index d7648d7a..0dacc805 100644
--- src/nextversion.f
+++ src/nextversion.f
@@ -1,20 +1,20 @@
  
 C++*********************************************************************
 C
-C NEXTVERSION.F                                                  3/2/94
-C                       ADDED CXNUMB                AUG 00 ARDEAN LEITH
-C                       NEXTRESULTS IN BIN DIR      FEB 09 ARDEAN LEITH
-C                       OUTPUT FORMATTING           AUG 14 ARDEAN LEITH
-C                       OUTPUT FORMATTING,DELETE    JAN 16 ARDEAN LEITH
+C NEXTVERSION.F         ORIGINAL                  3/2/94
+C                       ADDED CXNUMB              AUG 2000 ARDEAN LEITH
+C                       NEXTRESULTS IN BIN DIR    FEB 2009 ARDEAN LEITH
+C                       OUTPUT FORMATTING         AUG 2014 ARDEAN LEITH
+C                       OUTPUT FORMATTING,DELETE  JAN 2016 ARDEAN LEITH
 C
 C **********************************************************************
-C *  AUTHOR: MAHIEDDINE LADJADJ                                            *
+C=*  AUTHOR: MAHIEDDINE LADJADJ                                        *
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2016  Health Research Inc.,                         *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@wadsworth.org                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -89,10 +89,21 @@ C          RESULTS EXTENSION SET BY CALLER
 
 C       SET DEFAULT VALUE USING LAST 3 DIGITS OF SYSTEM CLOCK
         CALL SYSTEM_CLOCK(INUMB,IDUM,IDUM)
+
+        !write(6,*)' In nextversion 1; inumb,nchar: ',inumb,nchar
+
         INUMB                   = MOD(INUMB,1000)
+
+        !write(6,*)' In nextversion 2; inumb,nchar: ',inumb,nchar
+
         FILOUT(NCHAR+1:NCHAR+1) = '.' 
+
+        !write(6,*)' In nextversion 3; inumb,nchar: ',inumb,nchar,nlet
+
         CALL INTTOCHAR(INUMB,FILOUT(NCHAR+2:NCHAR+4),NLET,3)
 
+        !write(6,*)' In nextversion 4; nchar,filout: ',nchar, filout
+
 #ifndef SP_IBMSP3
 C       OMIT THIS FOR NOW ON PARALLEL ARCH. al Oct 00
 
@@ -137,9 +148,6 @@ C       READ THE FILE FILENAME.NBR' FOUND AND STORED IN SPIDER_JUNK.TMP
 C       DELETE THE TEMP FILE.
         CLOSE(LUNT,STATUS='DELETE')
 
-C       DELETE THE TEMP FILE.
-cc      SCRIPT = 'rm -f SPIDER_JUNK.TMP' // NULL
-cc      CALL system(SCRIPT)  NO LONGER NEEDED AFTER STATUS=DELETE
 
 #endif
 
diff --git src/norm3.f src/norm3.f
index 9d771fc7..2bc3b3bb 100644
--- src/norm3.f
+++ src/norm3.f
@@ -8,14 +8,15 @@ C           ERROR MESSAGES                         NOV 10 ArDean Leith
 C           NORMVALSP ADDED                        AUG 11 ArDean Leith
 C           NORMVALSP ADDED                        AUG 11 ArDean Leith
 C           USED SETPRMB, IMPLICIT                 JUL 19 ArDean Leith
+C           ADDED DEBUG OUTPUT                     OCT 25 ArDean Leith
 C
 C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2019  Health Research Inc.,                         *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@health.ny.gov                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -42,7 +43,7 @@ C        FMAX         MAXIMUM OF VOLUME                        (RET.)
 C        FMIN         MINIMUM OF VOLUME                        (RET.)
 C        AV           AVERAGE OF VOLUME                        (RET.)
 C
-C    NOTE:    THIS USES UNLABELED COMMON!!
+C    NOTE:    THIS USES LEGACY UNLABELED COMMON!!
 C             SIG RETURNED IN COMMON  (LEGACY ISSUE)
 C
 C--*********************************************************************
@@ -51,23 +52,24 @@ C--*********************************************************************
 
       IMPLICIT NONE
 
-      INTEGER          :: LUN,NX,NY,NZ
-      REAL             :: FMAX,FMIN,AV
+      INTEGER            :: LUN,NX,NY,NZ,nynz
+      REAL               :: FMAX,FMIN,AV
 
-      REAL             :: BUF        
-      COMMON BUF(1)
+      INTEGER, PARAMETER :: MAX_UNLABELED_COM = 5000000
+C     Sept 2025 al to fix for Gfort warning on threaded use
+      REAL , SAVE        :: BUF(MAX_UNLABELED_COM) ! LEGACY COMMON BLOCK
 
-      INTEGER          :: NSAMC,NROWC,IREC,NLABEL,IFORM,IMAMI,IHIST
-      REAL             :: FMAXC,FMINC,AVC,SIG
+      INTEGER            :: NSAMC,NROWC,IREC,NLABEL,IFORM,IMAMI,IHIST
+      REAL               :: FMAXC,FMINC,AVC,SIG
       COMMON /MASTER/NSAMC,NROWC,IREC,NLABEL,IFORM,IMAMI,FMAXC,FMINC,
      &                    AVC,SIG,IHIST
 
-      INTEGER          :: LUNT,NIN,NOUT
+      INTEGER            :: LUNT,NIN,NOUT
       COMMON /UNITS/LUNT,NIN,NOUT
 
-      DOUBLE PRECISION :: DAV,DAV2,DTOP,FNALL,DTEMP
-      REAL             :: B,DIFF 
-      INTEGER          :: NE,IRECT,K
+      DOUBLE PRECISION   :: DAV,DAV2,DTOP,FNALL,DTEMP
+      REAL               :: B,DIFF 
+      INTEGER            :: NE,IRECT,K
 
       FNALL = FLOAT(NX) * FLOAT(NY) * FLOAT(NZ)
       IF (FNALL <= 0) THEN
@@ -76,6 +78,12 @@ C--*********************************************************************
          RETURN
       ENDIF
 
+#if defined(SP_DBUGIO)
+      nynz = ny * nz
+      write(3,'(A,5i6)')   '  In norm3; nx,ny,nz,nynz: ',nx,ny,nz,nynz
+      write(3,'(A,f12.2)') '  In norm3; fnall: ',fnall
+#endif
+
       DAV  = 0.0
       DAV2 = 0.0
 
@@ -83,7 +91,9 @@ C--*********************************************************************
       FMAX = -FMIN
 
       DO IRECT = 1,NY*NZ
+
          CALL REDLIN(LUN,BUF,NX,IRECT)
+
          DO K = 1,NX
             B    = BUF(K)
             FMAX = MAX(B,FMAX)
@@ -94,11 +104,11 @@ C--*********************************************************************
       ENDDO
 
       AV    = DAV / FNALL
-      AVC   = AV
-      FMAXC = FMAX
-      FMINC = FMIN
+      AVC   = AV            ! SET IN COMMON /MASTER/
+      FMAXC = FMAX          ! SET IN COMMON /MASTER/
+      FMINC = FMIN          ! SET IN COMMON /MASTER/
 
-      DTOP  = DAV2 - DAV * DAV / FNALL
+      DTOP  = DAV2 - DAV * DAV / FNALL   ! NOT IN COMMON /MASTER/
 
       DIFF  = FMAX - FMIN
       IF (DIFF <= TINY(DIFF)) THEN
@@ -117,21 +127,26 @@ C        DIVISION BY ZERO
 
       ELSE
 C        CAN CALCULATE SIG
-         SIG = DSQRT( DTOP / DBLE(FNALL - 1.0))
+         SIG = DSQRT( DTOP / DBLE(FNALL - 1.0)) ! NOT IN COMMON /MASTER/
       ENDIF
 
+C     VALUES ARE SET IN COMMON BY NAME ABOVE ! SET IN COMMON /MASTER/
+
 
-      !write(6,*)' In norm3, before setprmb, fmin,fmax: ',fmin,fmax
+#if defined(SP_DBUGIO)
+      write(3,'(A,5(2x,i6),f8.2)')
+     &     '  In norm3; lun,nx,ny,irect,k,b: ',lun,nx,ny,irect,k,b
 
-C     VALUES ARE SET IN COMMON BY NAME ABOVE
+      write(3,90) fmin,fmax,av,sig
+90    format('  Fmin: ', 1PG10.3,
+     &       '  Fmax: ', 1PG10.3,
+     &       '  Av: ',   1PG12.5,
+     &       '  Sig: ',  1PG12.5)
 
-C     WRITE(3,90) FMIN,FMAX,AV,SIG
-90    FORMAT('  FMIN: ', 1PG10.3,
-     &       '  FMAX: ', 1PG10.3,
-     &       '  AV: ',   1PG12.5,
-     &       '  SIG: ',  1PG12.5)
+      write(3,*)' In norm3; Calling setprmb; lun,fmax: ',lun,fmax
+#endif
 
-C     SET VALUES IN FILE HEADER
+C     PLACE STAT VALUES IN FILE HEADER
       CALL SETPRMB(LUN,FMAX,FMIN,AV,SIG)
 
       END
diff --git src/openfil.f src/openfil.f
index 020410a5..50a91b19 100644
--- src/openfil.f
+++ src/openfil.f
@@ -16,14 +16,15 @@ C               OPENINLN INTEGER*8               OCT 2010 ArDean Leith
 C               NZ LIMITED TO 100000 BUG         JAN 2015 ArDean Leith 
 C               MRC SUPPORT                      MAY 2019 ArDean Leith
 C               OPEN ON 2 LUNS RECODED           AUG 2019 ArDean Leith
+C               FLIP FLAG IN LUNFLIP FIXED       SEP 2025 ArDean Leith
 C
 C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2019  Health Research Inc.,                         *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@health.ny.gov                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -103,20 +104,20 @@ C                |
 C                ? Inline stack
 C                |-------------> OPNINSTK ----> ...
 C
-C       NOTE: SHOULD NEVER BE CALL WITH MRC FILES     
+C       NOTE: SHOULD NEVER BE CALLED WITH MRC FILES     
 C
 C23456789 123456789 123456789 123456789 123456789 123456789 123456789 12
 C--*********************************************************************
 
-	SUBROUTINE OPENFIL(LUNT,FILNAM,LUNSENT,NX,NY,NZ,NSTACK,
+        SUBROUTINE OPENFIL(LUNT,FILNAM,LUNSENT,NX,NY,NZ,NSTACK,
      &                     ITYPE,DISP,KEEPEXT,IRTFLG)
 
         INCLUDE 'CMLIMIT.INC'
         INCLUDE 'CMBLOCK.INC'
         INCLUDE 'LABLOCK.INC'
 
-        INTEGER                      :: LUNARA,LUNSTK,LUNARB
-        COMMON /LUNARA/ LUNARA(100),LUNSTK(100),LUNARB(100)
+        INTEGER                      :: LUNARA,LUNSTK,LUNARB,LUNFLIP
+        COMMON /LUNARA/ LUNARA(100),LUNSTK(100),LUNARB(100),LUNFLIP(100)
 
         INTEGER                      :: LUNT,LUNSENT
         CHARACTER(LEN=*)             :: FILNAM
@@ -127,12 +128,11 @@ C--*********************************************************************
 
         CHARACTER(LEN=MAXNAM)        :: FILNM
         CHARACTER(LEN=2*MAXNAM)      :: MSG
-        CHARACTER(LEN=1)             :: NULL = CHAR(0)
         LOGICAL                      :: EX,CALLERRT,OPENED
         INTEGER, PARAMETER           :: I_8 = SELECTED_INT_KIND(12)
-	INTEGER(KIND=I_8)            :: NWORDS_8
+        INTEGER(KIND=I_8)            :: NWORDS_8
         INTEGER(KIND=I_8), PARAMETER :: ZERO_8 = 0
-        INTEGER                      :: LUN
+        INTEGER                      :: LUN,IFLIP
 
         LOGICAL                      :: IS_MRC
 
@@ -145,36 +145,36 @@ C       INCLUSION FOR OPTIONAL MPI INITIALIZATION. MAY ALTER MYPID
 C       SET FLAG FOR ERRONEOUS RETURN
         IRTFLG = 1
        
-C	CHECK IF USER WANTS TO USE THE IN-LINE BUFFER.
+C        CHECK IF USER WANTS TO USE THE IN-LINE BUFFER.
         INLNED = 0
         IF (FILNAM(1:1) == '_') THEN
-C	   USE AN IN-LINE BUFFER.
+C           USE AN IN-LINE BUFFER.
            CALL INLNBUF(FILNAM,NLET,INLNED,IRTFLGT)
            IF (IRTFLGT .NE. 0)  RETURN
 
-	   IF (DISP == 'U' .OR. DISP == 'N') THEN
-	      EX = .FALSE.
-	   ELSE
-	      EX = .TRUE.
-	   ENDIF
+           IF (DISP == 'U' .OR. DISP == 'N') THEN
+              EX = .FALSE.
+           ELSE
+              EX = .TRUE.
+           ENDIF
            FILNM = FILNAM(1:NLET)
 
         ELSE
 C          USE REGULAR FILE
            INLNED = 0
-	   LUNC   = LUN
+           LUNC   = LUN
 
 C          NULLIFY THE INLINE POINTER (CLOSEINLN IS INSIDE OPENINLN.F)
            CALL CLOSEINLN(LUN,IRTFLGT)
 
-           !write(3,*) ' In openfil, keepext,filnam:',keepext,filnam
+           !write(3,*)' In openfil, keepext,filnam:',keepext,filnam
 
            IF (KEEPEXT) THEN
               FILNM = FILNAM
               NLET  = lnblnk(FILNM)
            ELSE
               CALL FILNAMANDEXT(FILNAM,DATEXC,FILNM,NLET,.TRUE.,IRTFLGT)
-	      IF (IRTFLGT .NE.0) RETURN
+              IF (IRTFLGT .NE.0) RETURN
            ENDIF
            !write(3,*) ' In openfil, filnm: ',filnm(:nlet),disp
 
@@ -202,7 +202,7 @@ C       LUNARB(LUN) = LUN
 
         CALLERRT = (DISP(1:1) .NE. 'Z' .AND. DISP(1:1) .NE. 'E')
 
-10	IF (DISP == 'U' .OR. DISP == 'N') THEN
+10      IF (DISP == 'U' .OR. DISP == 'N') THEN
 C         USER WANTS A NEW FILE TO WRITE INTO ---------------------- NEW
 
           IF (EX) THEN
@@ -217,7 +217,7 @@ C           BE REPLACED.  OLD FILES ARE DELETED FIRST
      &         CALL BCAST_MPI('OPENFIL','IER',IER,1,'I',ICOMM)
 #endif
 
-	    IF (IER .NE. 0) THEN
+            IF (IER .NE. 0) THEN
                MSG =  'OPENFIL; DELETING FILE: ' // FILNM(1:NLET)
                CALL ERRT(101,MSG,NE)
                RETURN
@@ -237,8 +237,13 @@ C         SET FILE'S FMIN.... TO AVOID FLT. PT. ERROR ON DEC
 C         DOES NOT ALTER STATS: FMIN... IN COMMON BLOCK
           CALL LUNSETSTAT(LUN,0,0.0,0.0,0.0,0.0,IRTFLGT)
 
-	  IF (INLNED == 0) THEN
-C	     REGULAR FILE, NOT INLINE FILE
+C         SET NATIVE-ENDDEDNESS OF NEW FILE
+          IFLIP = 0  ;      
+C         CALL LUNGETFLIP(LUNT,IFLIP,IRTFLG) ! bug fixed sept 2025
+          CALL LUNSETFLIP(LUN, IFLIP,IRTFLG)
+
+          IF (INLNED == 0) THEN
+C             REGULAR FILE, NOT INLINE FILE
 
              LENREC = LENOPENFILE(NX*4)
              IF (MYPID <= 0) THEN
@@ -281,7 +286,7 @@ C            SAVE ISTACK IN NON-VOLATILE PART OF HEADER OBJECT
              CALL OPENINLN(LUN,INLNED,.TRUE.,NX,NWORDS_8,
      &                     .TRUE.,IRTFLGT)
              IF (IRTFLGT .NE. 0)  RETURN
-	  ENDIF
+          ENDIF
           !write(3,*)' In openfil,opened filnm: ', filnm(1:nlet)
 
 C         PUSH HEADER OBJECT INFO INTO NEW FILE
@@ -293,18 +298,18 @@ C         PUSH HEADER OBJECT INFO INTO NEW FILE
 
 C         --------------------------------------------------------- OLD
 
-	ELSEIF (DISP == 'O' .OR. DISP == 'K' .OR.
+        ELSEIF (DISP == 'O' .OR. DISP == 'K' .OR.
      &          DISP == 'Z' .OR. 
      &          DISP == 'E' .OR. DISP == 'M') THEN
 
 C         FILE EXISTS, AND IS ACCESSED WITH 'OLD', OPEN THE FILE
 
-	  IF (.NOT. EX) THEN
+          IF (.NOT. EX) THEN
 C            ERROR -- FILE DOES NOT EXIST, BUT BEING OPENED WITH 'OLD
              IF (MYPID <= 0)
      &          WRITE(NOUT,*) '*** FILE NOT FOUND: ',FILNM(1:NLET)
 
-C	     FOR DISP=Z, DO NOT STOP THE BATCH JOB BY CALLING ERRT
+C             FOR DISP=Z, DO NOT STOP THE BATCH JOB BY CALLING ERRT
              IF (CALLERRT) THEN
                 MSG = 'OPENFIL; FILE NOT FOUND: ' // FILNM(1:NLET)
                 CALL ERRT(101,MSG,NE)
@@ -326,10 +331,14 @@ C            SEE IF FILE ALREADY OPEN ON DIFFERENT LUN THAN CURRENT
              IF (MYPID <= 0) THEN
                 INQUIRE(FILE=FILNM(1:NLET),IOSTAT=IRTFLG,OPENED=OPENED,
      &                  NUMBER=LUNOPENED)
-
-c                write(3,*)  ' Inquire file: ',filnm(1:nlet),
-c     &                      '  Opened:',opened,' On lun:',lunopened,
-c     &                      '  Irtflg: ',irtflg  
+                   
+                !if (opened) then
+                !write(3,*) ' In openfil, Inquired: ',filnm(1:nlet)
+                !write(3,*) ' In openfil, Inquired: ',filnm(1:nlet),
+                !&                     '  Opened:',opened,' On lun:',lunopened,
+                !&                     '  Irtflg: ',irtflg  
+                !endif
+                                
              ENDIF   ! END OF: MYPID <= 0
 
 #ifdef USE_MPI
@@ -338,7 +347,7 @@ c     &                      '  Irtflg: ',irtflg
                CALL BCAST_MPI('OPENFIL','OPENED',   OPENED, 1,'L',ICOMM)
                CALL BCAST_MPI('OPENFIL','LUNOPENED',LUNOPENED,
      &                         1,'I',ICOMM)
-             ENDIF
+             ENDIF  ! END OF: (ONLYONE_RED)
 #endif
 
              IF (OPENED) THEN
@@ -350,12 +359,20 @@ C               MUST REDIRECT OLD LUNS TO CURRENT LUN BEFORE OPENING
                       CALL LUNSETLUNB(I,LUN,IRTFLG)
                    ENDIF
                 ENDDO                      
-             ENDIF
-             !write(3,*)' In openfil, lun,lunopened: ',lun,lunopened
+             ENDIF   ! END OF: IF(OPENED)
+             
+             !write(3,*)' In openfil, ------------ A ----------'
+             !write(3,*)' In openfil, lun,lunopened,mypid:',lun,lunopened,mypid
+
 
 C            NOW WE CAN OPEN THIS FILE ON LUN
              IF (MYPID <= 0) THEN
                LENREC = LENOPENFILE(256*4)  ! USED FOR SPIDER FILE
+
+               !write(3,*)  ' In openfil, ------------ B ----------'
+               !write(3,*)' In openfil, opening now on lun:',lun 
+               !write(3,*)' --------------- END OF B --------' 
+
                OPEN(LUN,FILE=FILNM(1:NLET),STATUS='OLD',
      &               ACCESS='DIRECT',
      &               FORM='UNFORMATTED',RECL=LENREC,IOSTAT=IER)
@@ -374,7 +391,12 @@ C              UNKNOWN OPENING ERROR
              ENDIF  ! END OF: IER .NE. 0 
              !write(3,*)' In openfil, filnm:', filnm(1:nlet)
 
-          ENDIF     ! END OF:  IF (INLNED .EQ. 0)
+          ENDIF   ! END OF:  IF (INLNED .EQ. )
+
+          !write(3,*)' In openfil, ------------ C ----------'
+          !write(3,*)' In openfil, callin lunredhed on lun:',lun 
+          !write(3,*)' In openfil, callin lunredhed on lun:',lun 
+          !write(3,*)' --------------- END OF C --------' 
 
 C         READ OVERALL HEADER FROM SPIDER FILE 
           CALL LUNREDHED(LUN,256,0,.TRUE.,IRTFLGT)
@@ -400,9 +422,11 @@ C         NEED NX VALUE
           CALL LUNGETSIZE(LUN,NX,NY,NZ,IRTFLGT)
           IF (IRTFLGT .NE. 0) RETURN
 
-          !write(3,*)' In openfil, nx,itype:',nx,itype
-          !print *,  'Reading header of: ',filnm(:nlet)
-          !print *,  'nx...: ',lun,nx,ny,nz,itype
+          !write(3,*)' In openfil --------------- D --------'
+          !write(3,*)' Read header of: ',filnm(:nlet)
+          !write(3,*)' In openfil, lun,itype:',lun,itype
+          !write(3,*)' In openfil, Nx...: ',lun,nx,ny,nz,itype
+          !write(3,*)' -------   END of D  -------- ' 
 
           IF (ITYPE == 0 .OR. 
      &          NX <= 0       .OR. NY <= 0       .OR. NZ <= 0 .OR.
@@ -414,11 +438,16 @@ C           FLIP BYTES IN HEADER OBJECT
             CALL LUNFLIPHDR(LUN,IRTFLGT)
             CALL LUNSETFLIP(LUN,1,IRTFLG)
 
+            !write(3,*)' In openfil --------------- E --------OK '
+            !write(3,*)' In openfil, lun,lunflip(lun):',lun,lunflip(lun)
+            !write(3,*)' --------------- END OF E --------' 
+
 C           NEED ITYPE & SIZE
             CALL LUNGETTYPE(LUN,ITYPE,IRTFLGT)
             CALL LUNGETSIZE(LUN,NX,NY,NZ,IRTFLGT)
-            IF (IRTFLGT .NE. 0) RETURN
 
+            IF (IRTFLGT .NE. 0) RETURN
+ 
             IF (ITYPE == 0 ) THEN
 C              PROBABLY NOT A SPIDER IMAGE
                IF (CALLERRT) THEN
@@ -455,7 +484,7 @@ C              PROBABLY NOT A SPIDER IMAGE
                ENDIF
                IRTFLG = 5   ! RETURN ERROR FLAG FOR NON-SPIDER IMAGE
 
-             ELSEIF (NY > 1000000) THEN
+            ELSEIF (NY > 1000000) THEN
 C              PROBABLY NOT A SPIDER IMAGE
                IF (CALLERRT) THEN
                  CALL ERRT(102,
@@ -463,34 +492,48 @@ C              PROBABLY NOT A SPIDER IMAGE
                ENDIF
                IRTFLG = 5   !RETURN ERROR FLAG FOR NON-SPIDER IMAGE
 
-             ELSEIF (NZ > 1000000) THEN
+            ELSEIF (NZ > 1000000) THEN
 C              PROBABLY NOT A SPIDER IMAGE
                IF (CALLERRT) THEN
                  CALL ERRT(102,
      &                 'INVALID HEADER, NZ (LIMIT=10000000)',NZ)
                ENDIF
                IRTFLG = 5   ! RETURN ERROR FLAG FOR NON-SPIDER IMAGE
-            ENDIF
 
+            ENDIF
+            !write(3,*)' In openfil, callerrt,irtflg:',callerrt,irtflg
+             
             IF (IRTFLG == 5) THEN
 C              RETURN ERROR FLAG FOR NON-SPIDER IMAGE
                FILNAM = FILNM(1:NLET)
                RETURN
             ENDIF 
 
+
             IF (VERBOSE) 
      &         WRITE(NOUT,*) ' NON-NATIVE BYTE ORDERED SPIDER FILE'
           ENDIF
 
+C         FIND NATIVE-ENDDEDNESS OF INPUT     
+          CALL LUNGETFLIP(LUN,IFLIPIN,IRTFLG)
+
+          !write(3,*)' In openfil --------------- F --------'
+          !write(3,'(a,4i6)')'  In openfil: lun,iflipin,: ', lun,iflipin 
+          !write(3,*)' --------------- END OF F --------' 
 
           IF (INLNED == 0) THEN
 C            REOPEN SPIDER FILE WITH FINAL RECORD LENGTH
              CLOSE(LUN)
              LENREC = LENOPENFILE(NX*4)
              IF (MYPID <= 0) THEN
-  	        OPEN(LUN,FILE=FILNM(1:NLET),STATUS='OLD',
+        
+                !write(3,*)'  7777777 In openfil: lun,filnm: ', lun,filnm
+
+                  OPEN(LUN,FILE=FILNM(1:NLET),STATUS='OLD',
      &                  FORM='UNFORMATTED',
      &                  ACCESS='DIRECT',IOSTAT=IER,RECL=LENREC)
+c               SET ENDDEDNESS OF INPUT     
+                CALL LUNSETFLIP(LUN,IFLIPIN,IRTFLG)
              ENDIF
 #ifdef USE_MPI
              IF (ONLYONE_RED) THEN
@@ -509,8 +552,16 @@ C            REOPEN SPIDER FILE WITH FINAL RECORD LENGTH
            CALL ERRT(101,MSG,NE)
            RETURN
         ENDIF    ! END OF:  (DISP == 'O' .OR. ......
+        
+        !write(3,*)' In openfil --------------- G --------'
+C       FIND NATIVE-ENDDEDNESS OF INPUT     
+        CALL LUNGETFLIP(LUN,IFLIPIN,IRTFLG)
+          
+        !write(3,'(a,4i6)')'  In openfil: lun,iflipin,: ', lun,iflipin 
+        !write(3,'(a,4i6)')'  In opfiles: lun(lun): ',lunflip(lun) 
+        !write(3,*)' --------------- END OF G LEAVING OPENFIL --------' 
 
-2000	CONTINUE
+2000        CONTINUE
 
 C       SAVE ISTACK IN NON-VOLATILE PART OF HEADER OBJECT
         CALL LUNGETISTACK(LUN,ISTACK,IRTFLGT)
@@ -544,8 +595,8 @@ C          NOT A STACK, RETURN -2
            NSTACK = -2
         ENDIF
 
-C       SET FLAG FOR NORMAL RETURN	
+C       SET FLAG FOR NORMAL RETURN        
         IRTFLG = 0
 
-	END
+        END
 
diff --git src/openfil_mrc.f src/openfil_mrc.f
index 139d6c89..0e7f9b1d 100644
--- src/openfil_mrc.f
+++ src/openfil_mrc.f
@@ -1,14 +1,17 @@
-C++*********************************************************************
+C***********************************************************************
 C
 C OPENFIL_MRC.F ADAPTED FROM OPENFIL             MAY 2019 ArDean Leith
+C               BUGS FIXED lnblnkn               SEP 2025 ArDean Leith 
+C               DEBUG OUTPUT                     OCT 2025 ArDean Leith
+C               REMOVED  GETMRCIMGNUM            OCT 2025 ArDean Leith
 C
 C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2020  Health Research Inc.,                         *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@health.ny.gov                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -24,30 +27,31 @@ C=* along with this program. If not, see <http://www.gnu.org/licenses> *
 C=*                                                                    *
 C **********************************************************************
 C
-C  OPENFIL_MRC(LUNT,FILNAM_AT,NLET,NX,NY,NZ,NSTACK, ITYPE,DSP,IRTFLG
+C  OPENFIL_MRC(LUNT,FILNAM,NLET,NX,NY,NZ, NSTK_FLG, ITYPE,DSPT,IRTFLG
 C
-C  PURPOSE:       OPEN NEW OR OLD MRC DATA FILE FOR RANDOM 
-C                 ACCESS READING/WRITING.  
+C  PURPOSE:        OPEN NEW OR OLD MRC DATA FILE FOR RANDOM ACCESS(IO)
+C                  ONLY USED IN: OPFILEC!
 C
 C  PARAMETERS:
-C        LUNT       UNIT NUMBER FOR FILNAM_AT                   (SENT)
-C        FILNAM_AT  FULL FILE NAME (STACKS HAVE @)              (SENT)
-C        NX,NY,NZ   DIMENSIONS OF IMAGE                 (SENT OR RET.)
-C        NSTACK     STACK INDICATOR                      (SENT / RET.)
-C                     ON INPUT: 
-C                        FOR NEW FILE  0 : NOT A STACK, 
-C                                     >0 : STACK
-C                     ON OUTPUT: 
-C                        <0 :  NOT A STACK 
-C               ????     =0 :  BARE STACK (NO IMAGE SPECIFIED)????
-C                        >0 :  CURRENT STACK SIZE
+C        LUNT      UNIT NUMBER FOR FILNAM                       (SENT)
+C        FILNAM    FULL FILE NAME                      
+C                    (STACKS HAVE @ EXCEPT FOR MRCS)            (SENT)
+C
+C        NX,NY,NZ  DIMENSIONS OF IMAGE/VOL               (SENT OR RET)
+C
+C        NSTK_FLG  STACK INDICATOR  (NOT SENT)                   (RET)
+C                  ON OUTPUT: 
+C                     -2 :  NOT A STACK   (NO @)
+C                     -1 :  AST FOR NSTK  (@* or *@)   
+C                     =0 :  BARE STACK (NO IMAGE SPECIFIED)
+C                     >0 :  CURRENT STACK SIZE
 C 
-C        ITYPE      SPIDER FILE TYPE SPECIFIER.                 (RET.)
-C        DSPT       CHARACTER VAR. CONTAINING DISPOSITION       (SENT)
+C        ITYPE     SPIDER FILE TYPE SPECIFIER.                   (RET)
+C        DSPT      CHAR VAR. CONTAINING DISPOSITION             (SENT)
 C     
-C        IRTFLG     ERROR RETURN FLAG.                          (RET.)
-C                     0 : NORMAL RETURN
-C                     1 : ERROR RETURN
+C        IRTFLG    ERROR RETURN FLAG.                            (RET)
+C                    0 : NORMAL RETURN
+C                    1 : ERROR RETURN
 C  VARIABLES:
 C
 C  CALL TREE:   
@@ -57,7 +61,7 @@ C
 C23456789 123456789 123456789 123456789 123456789 123456789 123456789 12
 C--*********************************************************************
 
-      SUBROUTINE OPENFIL_MRC(LUNT,FILNAM_AT,NLET,NX,NY,NZ,NSTACK,
+      SUBROUTINE OPENFIL_MRC(LUNT,FILNAM,NLET,NX,NY,NZ, NSTK_FLG,
      &                       ITYPE, DSPT,IRTFLG)
 
       IMPLICIT NONE
@@ -65,23 +69,28 @@ C--*********************************************************************
       INCLUDE 'CMBLOCK.INC'
       INCLUDE 'CMLIMIT.INC'
 
-      CHARACTER(LEN=*)        :: FILNAM_AT
-      INTEGER                 :: LUNT,NLET, NX,NY,NZ,NSTACK,ITYPE
+      CHARACTER(LEN=*)        :: FILNAM
+      INTEGER                 :: LUNT,NLET, NX,NY,NZ,NSTK_FLG,ITYPE
       INTEGER                 :: IRTFLG
       CHARACTER(LEN=1)        :: DSP,DSPT
 
-      CHARACTER (LEN=MAXNAM)  :: FILNAM
-      INTEGER                 :: LUN,NE,I,MAXIM
+      CHARACTER(LEN=MAXNAM)   :: FIL_NOAT,FIL_DIRS,FIL_BASE
+      CHARACTER(LEN=4)        :: FIL_EXT
+      INTEGER                 :: LOCAT, LOCAST, IMGNUM,NSTK_MAX
+      LOGICAL                 :: IS_MRC,IS_STK,ISBARESTK
+ 
+      INTEGER                 :: LUN,NE,I,MAXIM,ilent
       CHARACTER(LEN=2)        :: DISP
       CHARACTER(LEN=4)        :: CAXIS
 
       INTEGER                 :: MRCMODE
       REAL                    :: SCALEX,SCALEY,SCALEZ
       LOGICAL                 :: ISBARE,EX,ISOPEN
-      INTEGER                 :: IMGNUM,LOCAT,LUNOP,LENT 
-      LOGICAL                 :: WANTUL,ISMRCSFILE
+      INTEGER                 :: LUNOP,LENT,IMGNUMT,MZT
+      LOGICAL                 :: WANTUL
 
-      LOGICAL                 :: ISDIGI,lnblnkn  ! FUNCTIONS
+      LOGICAL                 :: ISDIGI   ! FUNCTIONS
+      INTEGER                 :: lnblnkn  ! FUNCTIONS  
 
 
 C     WANT TO OPEN OLD OR NEW MRC FILE FOR STREAM ACCESS
@@ -89,194 +98,257 @@ C     WANT TO OPEN OLD OR NEW MRC FILE FOR STREAM ACCESS
       LUN = LUNT
       DSP = DSPT      ! MAY BE ALTERED BELOW
 
-C     ALL MRC STACKS WILL HAVE AN @ IN NAME
-      LOCAT = INDEX(FILNAM_AT,'@')
-       
-
-      IF (LOCAT <= 0) THEN
-C        NOT SPECIFIED AS A STACK
-         IMGNUM = -1
-         NSTACK = -2
-         FILNAM = FILNAM_AT      
-      ELSE
-C        GET STACKED IMAGE NUMBER (ZERO IF BARESTACK)
-C        OUTPUTS IMGNUM    0 : BARE STACK
-C                         -1 : NOT A STACK   (NO @)
-C                         >1 : STACKED IMAGE NUMBER
-
-         CALL GETMRCIMGNUM(FILNAM_AT,LOCAT, FILNAM,IMGNUM,IRTFLG)
-         IF (IRTFLG .NE. 0) RETURN
 
-         NSTACK = 1
-         IF (IMGNUM > 0) NSTACK = IMGNUM
-         !write(3,*)' In openfil_mrc - imgnum,nstack:',imgnum,nstack
-
-      ENDIF
-      !write(3,*)' In openfil_mrc, filnam :',filnam
+#if defined(SP_DBUGIO)
+      !ilent = len(filnam)
+      !write(3,*)' In openfil_mrc, ilent for filnam: ',ilent
+      !ilent = len(fil_noat)
+      !write(3,*)' In openfil_mrc, ilent for fil_noat: ',ilent
+      if (dsp == 'N') then
+         write(3,*)' In openfil_mrc, nx,ny,nz: ',nx,ny,nz
+         write(3,*)' '
+      endif
+#endif
+
+C     GET_FILNAM_NSTK RETURNS NSTK_FLG AND OTHER STACK INFO
+C                  -2 :  NOT A STACK   (NO @)
+C                  -1 :  AST FOR NSTK  (@* or *@)   
+C                   0 :  BARE STACK    (@ OR MRCS WITHOUT @)
+C                  >0 :  STACKED IMAGE NUMBER
+
+      CALL GET_FILNAM_NSTK(FILNAM,FIL_NOAT,FIL_DIRS,FIL_BASE,FIL_EXT,
+     &                     IS_MRC,LOCAST, IS_STK ,NSTK_FLG, IRTFLG)
+
+#if defined(SP_DBUGIO)
+      write(3,*)' In openfil_mrc, get_filnam_nstk returned ----------'
+      write(3,*)' In openfil_mrc; got is_mrc,locast: ',is_mrc,locast
+      write(3,*)' In openfil_mrc; got is_stk,nstk_flg: ',is_stk,nstk_flg
+      ilent = len(fil_noat)
+      write(3,*)' In openfil_mrc; got fil_noat: ',fil_noat(:ilent)
+      write(3,*) '  '
+#endif
       
 C     CREATE A MRC HEADER OBJECT FOR THIS LUN (CAN REUSE EXISTING)
       CALL LUNNEWHED_MRC(LUN,IRTFLG)
       IF (IRTFLG .NE. 0) RETURN
-
-C     PUT FILENAME AND DSP IN STATIC AREA OF THE HEADER OBJECT
-      CALL LUNSETFILE_MRC(LUN,FILNAM,DSP,IRTFLG)
-      IF (IRTFLG .NE. 0) RETURN
-
-c     PUT ISBARE IN STATIC (OFF-FILE) AREA OF THE HEADER OBJECT
-      ISBARE = (IMGNUM == 0)
+          
+C     PUT ISBARE IN STATIC (OFF-FILE) AREA OF THE HEADER OBJECT
+      ISBARE = (NSTK_FLG == 0)
       CALL LUNSETISBARE_MRC(LUN,ISBARE,IRTFLG)
       IF (IRTFLG .NE. 0) RETURN
 
       EX = .FALSE.
-      IF (DSP == 'N' .AND. LOCAT > 0) THEN
+      IF (DSP == 'N') THEN
 C        MAY BE OPENING A NEW IMAGE IN AN EXISTING STACK?
 C        SEE IF THE MRC STACK ALREADY EXISTS
          INQUIRE(FILE=FILNAM,EXIST=EX,OPENED=ISOPEN,NUMBER=LUNOP)
-      ENDIF
 
-      IF (DSP == 'O' .OR. (DSP == 'N' .AND. EX)) THEN
-C        OPEN AN ALREADY EXISTING MRC FILE
-         CALL OPENFIL_O_MRC(LUN,FILNAM,NLET,DSP,IMGNUM,
-     &                      NX,NY,NZ,NSTACK,  IRTFLG)
+         IF (ISOPEN .AND. LUNOP .NE. LUN) THEN
+            LENT = lnblnkn(FILNAM)
+            WRITE(NOUT,98) LUN,FILNAM(:LENT),LUNOP
+98          FORMAT('  *** ERROR FILE: ',A, 
+     &             ' ALREADY OPEN ON UNIT: ',I3)
+            IRTFLG = 1
+            RETURN
+         ENDIF
+      ENDIF
 
-C        HACK TO HANDLE .mrcs files with bad NZ (REMOVED 6/30/20) al
+      IF (DSP == 'O' .OR. (DSP == 'N' .AND. EX)) THEN  !-----------
+C        OPEN AN ALREADY EXISTING MRC FILE, RETURNS NSTK_FLG
+
+#if defined (SP_DBUGIO)
+         write(3,*)' In openfil_mrc; B4 openfil_o_mrc -------'
+#endif
+
+         IMGNUM = 0    ! NOT USED
+C        NSTK_FLG      IS NOT NEEDED BY OR SENT TO: OPENFIL_O_MRC ???
+         CALL OPENFIL_O_MRC(LUN,FIL_NOAT,NLET,DSP,IMGNUM,
+     &                     NX,NY,NZ, NSTK_FLG,IRTFLG)
+
+#if defined (SP_DBUGIO)
+        !ilent = lnblnkn(fil_noat)
+        !write(3,*)' Back openfil_mrc; fil_noat: ',fil_noat(:ilent)
+         write(3,*)' Back in openfil_mrc; imgnum, nz:', 
+     &                                    imgnum, nz
+         write(3,*)' Back in openfil_mrc; nstk_flg,irtflg:', 
+     &                                    nstk_flg,irtflg
+         write(3,*)' Back in openfil_mrc; Calling lungetstk_mrc '
+         write(3,*)'  '
+#endif
+
+         CALL LUNGETSTK_MRC(LUN,MZT,NSTK_MAX,IMGNUMT,IRTFLG)
     
-         !write(3,*)' In openfil_mrc, after openfil_o_mrc irtflg:',irtflg
-         !write(3,*)' In openfil_mrc, after openfil_o_mrc filnam:',filnam
-         !write(3,*)' In openfil_mrc, after openfil_o_mrc imgnum:',imgnum
-         !write(3,*)' In openfil_mrc, nstack: ',nstack
-         !write(3,*)' In openfil_mrc - nz,nstack:', nz,nstack
-
-      ELSEIF (DSP == 'N') THEN
-C        OPEN AND INITIALIZE A NEW MRC FILE
-
-         SCALEX  = 1.0    ! ?????????
-         SCALEY  = 1.0
-         SCALEZ  = 1.0
-         MRCMODE = 2      ! USE 32 BIT REALS ALWAYS FOR NOW???
-         
-         CALL OPENFIL_N_MRC(LUN,FILNAM,
-     &                      MRCMODE,
-     &                      NX,NY,NZ,NSTACK,
-     &                      SCALEX,SCALEY,SCALEZ,IRTFLG)
-      ENDIF
-      IF (IRTFLG .NE. 0) RETURN
+#if defined (SP_DBUGIO)
+         write(3,*)' Back in openfil_mrc; mzt,imgnum: ',mzt,imgnum
+         write(3,*)' Back in openfil_mrc; nstk_max,irtflg: ',
+     &                                    nstk_max,irtflg
+#endif
+
+         IF (NSTK_MAX > 0) THEN
+            NSTK_MAX = MAX(IMGNUM,NSTK_MAX)   ! USED BELOW
+         ENDIF
 
-C     SET IMGNUM AND NSTACK IN STATIC AREA OF FILE HEADER
-      CALL LUNSETSTK_MRC(LUN,IMGNUM,NSTACK,IRTFLG)
-      IF (IRTFLG .NE. 0) RETURN
-     
-C     SET AXIS ORIGIN LOCATION & VOLUME HANDEDNESS BEFORE LUNSETPOS_MRC
-      CALL WHICH_HAND_MRC(LUN,FILNAM,CAXIS,IRTFLG)
+#if defined (SP_DBUGIO)
+         write(3,*)' In openfil_mrc; nstk_max: ', nstk_max
+         write(3,*)' '
+#endif
 
-C     SET READ/WRITE FILE OFFSETS FOR THIS IMAGE IN LUN COMMON 
-      CALL LUNSETPOS_MRC(LUN,IMGNUM,IRTFLG)
-      IF (IRTFLG .NE. 0) RETURN
 
-      IF (FCHAR(1:2) .NE.  '31' .OR. FCHAR(4:5) .ne.  'HE') THEN
-C        WRITE HEADER INTO FILE TO PRESERVE ANY ALTERED VALUES
-         CALL LUNWRTHED_MRC(LUN,IRTFLG)
-         IF (IRTFLG .NE. 0) THEN
-            LENT = lnblnkn(FILNAM)
-            WRITE(NOUT,99) IRTFLG,LUN,FILNAM(:LENT)
-99          FORMAT( '  *** ERROR(',I4,') ON UNIT: ',I3,' FILE: ',A)
-            RETURN
-         ENDIF
-      ENDIF
+      ELSEIF (DSP == 'N') THEN  !---------------------------------
+C        OPEN AND INITIALIZE A NEW MRC FILE AND IMAGE
 
+         SCALEX   = 1.0    ! ?????????
+         SCALEY   = 1.0
+         SCALEZ   = 1.0
+         MRCMODE  = 2      ! USE 32 BIT REALS ALWAYS FOR NOW???
 
-C     GET IMAGE TYPE (2D/3D or FOURIER) (RETURNED TO CALLER)
-      CALL LUNGETTYPE_MRC(LUN,ITYPE,IRTFLG)
-      IF (IRTFLG .NE. 0) RETURN
+         IMGNUM   = 1
+         IF (NSTK_FLG > 0) IMGNUM = NSTK_FLG
+         NSTK_MAX = IMGNUM
 
-C     PUT COMMON VALUES INTO COMMON AREA (NOT NEEDED IN FUTURE?)
-      CALL LUNSETCOMMON_MRC(LUN,IRTFLG)
-      IF (IRTFLG .NE. 0) RETURN
 
-C     WRITE FILE OPENING INFO TO RESULTS/TERMINAL
-      CALL LUNSAYINFO_MRC(LUN,.TRUE.,IRTFLG)
-      
-C     SET FLAG FOR NORMAL RETURN	
-      IRTFLG = 0
+#if defined (SP_DBUGIO)
+         ilent = lnblnkn(fil_noat)
+         write(3,*)' In openfil_mrc, B4 openfil_n_mrc; ilent: ',ilent 
 
-      !write(6,*)' In openfil_mrc, ret. itype,iform: ',itype,iform
-      !write(3,*)' In openfil_mrc, ret. irtflg: ',irtflg
-      
-      END
+         write(3,*)' In openfil_mrc, B4 openfil_n_mrc; fil_noat: ',
+     &                                           fil_noat(:ilent)
 
+         write(3,*)' In openfil_mrc, B4 openfil_n_mrc; nz,nstk_flg: ',
+     &                                                 nz,nstk_flg
+#endif
 
-C     ------------------- GETMRCIMGNUM ---------------------------------
+         CALL OPENFIL_N_MRC(LUN,FIL_NOAT,
+     &                      MRCMODE,
+     &                      NX,NY,NZ, NSTK_FLG,
+     &                      SCALEX,SCALEY,SCALEZ,IRTFLG)
 
-      SUBROUTINE GETMRCIMGNUM(FILNAM_AT,LOCAT, FILNAM,IMGNUM,IRTFLG)
+         NSTK_MAX = MAX(IMGNUM,NSTK_MAX)
 
-C     IMGNUM         0  :  BARE STACK
-C                   -1  :  NOT A STACK   (NO @)
-C                   >1  :  STACKED IMAGE NUMBER
+#if defined (SP_DBUGIO)
+         write(3,*) '      '
+         write(3,*)' In openfil_mrc; nstk_flg:      ',nstk_flg 
+         write(3,*)' In openfil_mrc; irtflg,imgnum: ',irtflg,imgnum 
+         write(3,*)' In openfil_mrc; nstk_max       ', nstk_max 
+#endif
 
-      IMPLICIT NONE
+      ENDIF     !--------------------------------------------
+
+      IF (IRTFLG .NE. 0) RETURN
 
-      INCLUDE 'CMBLOCK.INC'
-      INCLUDE 'CMLIMIT.INC'
 
-      CHARACTER(LEN=*)    :: FILNAM_AT,FILNAM
-      INTEGER             :: NLET,NSTACK,IMGNUM,MAXIM,IRTFLG
 
-      INTEGER             :: LOCAT,LOCSLASH,NLEN,NDIGITS,IGO  
 
-      LOGICAL             :: ISDIGI,lnblnkn
 
+#if defined (SP_DBUGIO)
+      write(3,*) '     '
+      ilent = lnblnkn(filnam)
+      write(3,*)' In openfil_mrc, filnam:           ',filnam(:ilent)
+      write(3,*)' In openfil_mrc; nstk_flg:         ',nstk_flg 
+      write(3,*)' In openfil_mrc; irtflg,imgnum:    ',imgnum 
+      write(3,*)' In openfil_mrc; nstk_max          ', nstk_max 
+#endif
 
-C     IF PRESENT, EXTRACT STACK FILENAME AND NUMBER e.g. 056@file.mrcs
+C     SET IMGNUM AND NSTK_MAX IN STATIC AREA OF FILE HEADER
+      CALL LUNSETSTK_MRC(LUN,IMGNUM,NSTK_MAX,IRTFLG)
+      IF (IRTFLG .NE. 0) RETURN
+     
+#if defined (SP_DBUGIO)
+      write(3,*)' In openfil_mrc;  After lunsetstk_mrc ' 
+#endif
+
+C     IF (FCHAR(1:2) .NE.  '31' .AND. FCHAR(4:5) .NE.  'HE') THEN
+C     IF (FCHAR(1:2) .NE.  '31') THEN
+C     IF (FCHAR(4:5) .NE.  'HE') THEN
+C
+      IF ((FCHAR(1:2) == '31' .AND. FCHAR(4:5) == 'HE') .OR.
+     &    (FCHAR(4:9) == 'FROM M')) THEN 
 
-      LOCAT = INDEX(FILNAM_AT,'@')
-      NLEN  = lnblnkn(FILNAM_AT)
+C        DO NOT WRITE HEADER INTO FILE, JUST SET READ/WRITE POSITION
+         CALL LUNSET_HEDPOS_MRC(LUN,IRTFLG)
       
-      IF (LOCAT <= 0) THEN
-         IMGNUM = -1           ! NOT A STACK
-         IRTFLG = 0
-         RETURN
+#if defined (SP_DBUGIO)
+         write(3,*)  ' '
+         write(3,*)' In openfil_mrc; After lunset_hedpos_mrc  '
+         write(3,*) '  '
+#endif
+         IF (IRTFLG .NE. 0) THEN
+            LENT = lnblnkn(FILNAM)
+            WRITE(NOUT,99) IRTFLG,LUN,FILNAM(:LENT)
+99          FORMAT( '  *** ERROR(',I4,') ON UNIT: ',I3,' FILE: ',A)
+            RETURN
+         ENDIF
 
-      ELSEIF (ISDIGI(FILNAM_AT(LOCAT-1:LOCAT-1) )) THEN
- 
-C        EXTRACT IMAGE NUMBER WITHIN STACK FILE
+      ELSE
 
-         LOCSLASH = INDEX(FILNAM_AT(1:LOCAT),'/',BACK=.TRUE.)
-         IGO      = 1 
-         IF (LOCSLASH > 0) IGO = LOCSLASH + 1
+C        SET AXIS ORIGIN LOCATION & VOLUME HANDEDNESS BEFORE SETPOS
+         CALL WHICH_HAND_MRC(LUN,FIL_NOAT,CAXIS,IRTFLG)
+         IF (IRTFLG .NE. 0) RETURN
+
+#if defined (SP_DBUGIO)
+         write(3,*)  '  '
+         write(3,*)' In openfil_mrc; After which_hand_mrc '
+         ilent = lnblnkn(fil_noat)
+         write(3,*)' In openfil_mrc, fil_noat: ',fil_noat(:ilent)
+         write(3,*)' In openfil_mrc, caxis:    ',caxis
+#endif
 
-         CALL GETFILENUM(FILNAM_AT(IGO:LOCAT-1),IMGNUM,
-     &                   NDIGITS,.TRUE.,IRTFLG)
+C        SET READ/WRITE FILE OFFSETS FOR THIS IMAGE IN LUN COMMON 
+         CALL LUNSETPOS_MRC(LUN,NSTK_FLG,IRTFLG)
          IF (IRTFLG .NE. 0) RETURN
 
-         !write(6,*)' In getmrcimgnum - imgnum,ndigits:',imgnum,ndigits
-         !write(6,*)' In getmrcimgnum - stack name:',filnam_at(1:nlen)
-         !write(6,*)' In getmrcimgnum - igo,locat:',igo,locat
+#if defined (SP_DBUGIO)
+         write(3,*)  ' '
+         write(3,*)' In openfil_mrc; After lunsetpos_mrc  '
+         write(3,*) '  '
+#endif
 
-         IF (IMGNUM <= 0) THEN
-            WRITE(NOUT,*) 'STACK NAME:',FILNAM_AT(1:NLEN)
-            CALL ERRT(102,'STACKS START WITH IMAGE: 1 NOT',IMGNUM)
-            IRTFLG = 1
+C        WRITE HEADER INTO FILE TO PRESERVE ANY ALTERED VALUES
+         CALL LUNWRTHED_MRC(LUN,IRTFLG)
+
+         IF (IRTFLG .NE. 0) THEN
+            LENT = lnblnkn(FILNAM)
+            WRITE(NOUT,99) IRTFLG,LUN,FILNAM(:LENT)
             RETURN
          ENDIF
+      ENDIF
 
-         FILNAM = FILNAM_AT(1:IGO-1) // FILNAM_AT(LOCAT+1:NLEN)
+  
+#if defined (SP_DBUGIO)
+      write(3,*)' In openfil_mrc; After lunwrthed_mrc ' 
+      write(3,*)' ' 
+#endif
 
-      ELSE
-C        NO NUMBER BEFORE @ INDICATES BARE STACK
-         IMGNUM = 0
-         IF (LOCAT > 1)  THEN
-           FILNAM = FILNAM(1:LOCAT-1) // FILNAM_AT(LOCAT+1:NLEN)
-         ELSE
-           FILNAM = FILNAM_AT(2:NLEN)
-         ENDIF
-      ENDIF
-      
-      NLET  = lnblnkn(FILNAM)
-      !write(3,*)' In getmrcimgnum - filnam_at:',filnam_at(1:25)
-      !write(6,*)' In getmrcimgnum - filnam_at: ',filnam_at(:nlen)
-      !write(6,*)' In getmrcimgnum - filnam   : ',filnam(:nlet),irtflg
+C     GET IMAGE TYPE (2D/3D or FOURIER) (RETURNED TO CALLER)
+      CALL LUNGETTYPE_MRC(LUN,ITYPE,IRTFLG)
+      IF (IRTFLG .NE. 0) RETURN
+
+C     PUT COMMON VALUES INTO COMMON AREA (NOT NEEDED IN FUTURE?)
+      CALL LUNSETCOMMON_MRC(LUN,IRTFLG)
+      IF (IRTFLG .NE. 0) RETURN
+
+C     WRITE FILE OPENING INFO TO RESULTS/TERMINAL
+
+      !!!!!!!!!!!NSTK_FLG = IMGNUM
 
+#if defined (SP_DBUGIO)
+      write(3,*)' In openfil_mrc; imgnum,nstk_flg: ',
+     &                            imgnum,nstk_flg 
+      write(3,*)' In openfil_mrc; Call lunsayinfo_mrc; lun: ',lun
+      write(3,*)' '
+#endif
+
+      CALL LUNSAYINFO_MRC(LUN,.TRUE.,IRTFLG)
+      
+C     SET FLAG FOR NORMAL RETURN	
       IRTFLG = 0
+
+#if defined (SP_DBUGIO)
+       write(3,*)'    '
+       write(3,*)' LEAVING openfil_mrc; imgnum,nstk_flg : ',
+     &                                  imgnum,nstk_flg  
+#endif
+      
       END
 
 
@@ -296,7 +368,7 @@ C     ------------------------- ISMRCFILE  ----------------------------
 
 C      IF IT IHAS .MRC, .MRCS, OR .MAP IT IS LIKELY TO BE MRC FILE 
        ISMRCFILE = (INDEX(FILNAM(1:NLETI),'.MRC') > 0 .OR.
-     &              INDEX(FILNAM(1:NLETI),'.mrc') > 0 .OR.
+     &              INDEX(FILNAM(1:NLETI),'.mrc') > 0  .OR.
      &              INDEX(FILNAM(1:NLETI),'.map') > 0 .OR.
      &              INDEX(FILNAM(1:NLETI),'.MAP') > 0)
 
diff --git src/openfil_n_mrc.f src/openfil_n_mrc.f
index 173b41a1..dfe1f833 100644
--- src/openfil_n_mrc.f
+++ src/openfil_n_mrc.f
@@ -1,14 +1,15 @@
 C++*********************************************************************
 C
 C OPENFIL_N_MRC.F ADAPTED FROM OPENFIL           MAY 2019 ArDean Leith
+C                 DEBUG OUTPUT                   OCT 2025 ArDean Leith
 C
 C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2020   Health Research Inc.,                         *
+C=* Copyright 1985-2025   Health Research Inc.,                        *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@health.ny.gov                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -24,46 +25,70 @@ C=* along with this program. If not, see <http://www.gnu.org/licenses> *
 C=*                                                                    *
 C **********************************************************************
 C
-C  OPENFIL_N_MRC(LUN,FILNAM,DATEXT, MRCMODE, NX,NY,NZ,NSTACK,
+C  OPENFIL_N_MRC(LUN,FILNAM,DATEXT, MRCMODE, NX,NY,NZ, NSTK_FLG,
 C                SCALEX,SCALEY,SCALEZ,IRTFLG
 C
 C  PURPOSE: OPEN NEW MRC FILE FOR STREAM ACCESS, LITTLE ENDED
 C
 C  PARAMETERS:
-C       LUN       LOGICAL UNIT NUMBER FOR FILNAM.               (SENT)
-C       FILNM     CHARACTER ARRAY, CONTAINING FILE NAME WITH @  (SENT)
-C       FILNAM    CHARACTER ARRAY, CONTAINING FILE NAME NO @    (SENT)
-C       LUN       LOGICAL UNIT NUMBER FOR FILNAM.               (SENT)
-C       NX,NY,NZ  DIMENSIONS OF IMAGE                   (SENT OR RET.)
-C       NSTACK    STACK INDICATOR                        (SENT / RET.)
-C                   ON INPUT: 
-C                     -2 : NOT A STACK  
-C                     >0 : MRC STACK
-C                   ON OUTPUT: 
-C                     -1  :  NOT A STACK 
-C                     >=0 :  MAX IMAGE NUMBER NOW IN STACK.
+C       LUN           LOGICAL UNIT NUMBER FOR FILNAM            (SENT)
+C       FILNAM        CHAR  ARRAY, CONTAINING FILE NAME NO @    (SENT)
+C       LUN           LOGICAL UNIT NUMBER FOR FILNAM            (SENT)
+C       NX,NY,NZ      DIMENSIONS OF IMAGE/VOL             (SENT & RET)
+C
+C       NSTK_FLG      STACK INDICATOR                     (SENT / RET)
+C                     ON INPUT: 
+C                       -2 :  AST FOR NSTK  (@* or *@)   
+C                       -1 :  NOT A STACK   (NO @)
+C                        0 :  BARE STACK    (@)
+C                       >1 :  STACKED MRC IMAGE/VOLUME? NUMBER
+C
+C                     ON OUTPUT: 
+C                       -1 :  NOT A STACK 
+C                      >=0 :  MAX IMAGE NUMBER NOW IN STACK
 C 
-C       IRTFLG    ERROR RETURN FLAG.                            (RET.)
-C                   0 : NORMAL RETURN
-C                   1 : ERROR RETURN
+C       IRTFLG        ERROR RETURN FLAG.                         (RET)
+C                       0 : NORMAL RETURN
+C                       1 : ERROR RETURN
 C
-C  VARIABLES: ITYPE (TYPE)  FILE TYPE SPECIFIER. 
-C               +1    R     2-D IMAGE
-C               +3    R3    3-D VOLUME FILE
+C  VARIABLES: 
+C        ITYPE     (TYPE)  FILE TYPE SPECIFIER. 
+C             +1     R     2-D IMAGE
+C             +3     R3    3-D VOLUME FILE
 C
-C        ISPG == 0        IMAGE OR IMAGE STACK
-C        ISPG == 1        VOLUMES
-C        ISPG == 401      STACK OF EM VOLUMES
+C        ISPG == 0         IMAGE OR IMAGE STACK
+C        ISPG == 1         VOLUMES
+C        ISPG == 401       STACK OF EM VOLUMES  if Version = 20140
 C
-C        MZ   ==  1       IMAGE 
-C        MZ   >=  1       IMAGE STACK
-C        MZ   == NZ       VOLUME
-C        MZ   NZ/NUMVOLS  VOLUME STACK
+C        MZ   ==  1        IMAGE 
+C        MZ   >=  1        IMAGE STACK
+C        MZ   == 1            IMAGE STACK
+C        MZ   == NZ        VOLUME
+C        MZ   NZ/NUMVOLS   VOLUME STACK
 C
 C        DMAX  < DMIN                        MAX & MIN UNDETERMINED
 C        DMEAN < (SMALLER OF DMIN and DMAX)  DMEAN     UNDETERMINED
 C        RMS   < 0.0                         RMS       UNDETERMINED
 C
+C  MRC FILE HEADER:
+C     MZ identifies the # of sections along Z in 
+C     each of the volumes that are in a volume stack
+C
+C     2014 MRC STANDARD (IVERSION = 20140)    
+C                       ISPG(23)  NZ(3)          MZ(10)
+C       Single image       0       1              1
+C       Image stack        0       1              >= 1
+C       Single volume      1      >1 (#SLICES)    = NZ
+C       Volume stack      401     >1*#VOLS        = NZ / #VOLS  
+C
+C     RELION STANDARD -  MRCS     (IVERSION = 1)
+C                        ISPG     NZ             MZ
+C       Single image       0       1              1
+C       Image stack        0       1              >= 1
+C       Single volume      0      >1 (#SLICES)    = NZ??
+C       No Volume stack    0      >1*#VOLS        = NZ / #VOLS  
+C
+C
 C  CALL TREE:   
 C     OPFILEC --> OPENFIL_MRC --> OPENFIL_O_MRC -->
 C                             --> OPENFIL_N_MRC -->
@@ -73,7 +98,7 @@ C--*********************************************************************
 
       SUBROUTINE OPENFIL_N_MRC(LUN,FILNAM,
      &                         MRCMODE,
-     &                         NX,NY,NZ,NSTACK,
+     &                         NX,NY,NZ, NSTK_FLG,
      &                         SCALEX,SCALEY,SCALEZ,IRTFLG)
  
 C     PURPOSE: OPEN NEW MRC FILE FOR STREAM ACCESS, LITTLE ENDED
@@ -84,19 +109,30 @@ C     PURPOSE: OPEN NEW MRC FILE FOR STREAM ACCESS, LITTLE ENDED
       INCLUDE 'CMLIMIT.INC'
  
       INTEGER                 :: LUN,MRCMODE
-      CHARACTER(LEN=*)        :: FILNAM
-      INTEGER                 :: NX,NY,NZ,NSTACK
+
+      CHARACTER(LEN=*),INTENT(IN) :: FILNAM
+
+      INTEGER                 :: NX,NY,NZ, NSTK_FLG
       REAL                    :: SCALEX,SCALEY,SCALEZ
       INTEGER                 :: IRTFLG
 
       LOGICAL                 :: WANTUL,IS_MRCS 
       INTEGER                 :: NLABL,NSYMBT,MACHST,NE,IOFFSET
-      INTEGER                 :: MX,MY,MZ,IVERSION,NZMRC
-      INTEGER                 :: NSYMBYT,ISPG
+      INTEGER                 :: MX,MY,MZ,IVERSION
+      INTEGER                 :: NSYMBYT,ISPG,LNBLNKN,ILENT
+
       CHARACTER(LEN=1)        :: NULL = CHAR(0)
 
 
-      !write(3,*)' In openfil_n_mrc, filnam,nstack: ',filnam,nz,nstack
+      ILENT = LNBLNKN(FILNAM)
+
+#if defined (SP_DBUGIO)
+      write(3,*)'  '
+      write(3,*)' In openfil_n_mrc; nx,ny,nz,nstk_flg: ', 
+     &                              nx,ny,nz,nstk_flg
+      !write(3,*)' In openfil_n_mrc; ilent:  ',ilent
+       write(3,*)' In openfil_n_mrc; filnam: ',filnam(1:ilent)
+#endif
 
 C     OPEN NEW MRC FILE FOR STREAM ACCESS, LITTLE ENDED
 
@@ -113,69 +149,95 @@ C     SO: MZ = NZ / NUMBER OF VOLUMES
 C     I AM TRYING TO HANDLE ALL COMMON FOULED UP MRC STACKS
       MX  = NX
       MY  = NY
-
-      !write(3,*)' In openfil_n_mrc, filnam: ',filnam,nx,ny,nz,nstack
-
+ 
 C     SEE IF USER WANTS RELION COMPATIBLE IMAGE/STACK
       IS_MRCS = (INDEX(FILNAM,'MRCS') > 1  .OR.
      &           INDEX(FILNAM,'mrcs') > 1)
 
-      !write(3,*)' In openfil_n_mrc, filnam: ',is_mrcs, nstack
-      IF ( IS_MRCS .OR. (NZ > 1 .AND. NSTACK > 1) )  THEN
+#if defined (SP_DBUGIO)
+      write(3,*)' In openfil_n_mrc, is_mrcs: ',is_mrcs
+#endif
+
+C     PUT FILENAME IN STATIC AREA OF THE HEADER OBJECT
+      CALL LUNSETFILE_MRC(LUN,FILNAM,NULL,IRTFLG)
+      IF (IRTFLG .NE. 0) RETURN
+
+      IF ( IS_MRCS .OR. (NZ > 1 .AND. NSTK_FLG > 1) )  THEN
 C        HACK TO CREATE RELION COMPATIBLE STACKS
          IVERSION = 1
-         ISPG     = 0    
-         NZMRC    = MAX(NSTACK,1)        ! NUMBER OF IMAGES 
-         MZ       = NSTACK
-         !write(3,*)' In openfil_n_mrc, ismrcs,nstack,nzmrc: ', is_mrcs, nstack,nzmrc
-      ELSEIF (NZ == 1 .AND. NSTACK < 0) THEN
+         ISPG     = 0
+         NZ       = MAX(NSTK_FLG,1)    ! NUMBER OF IMAGES NOT SLICES!
+         MZ       = NZ
+
+#if defined (SP_DBUGIO)
+         write(3,*)' In openfil_n_mrc, is_mrcs,nz: ',is_mrcs,nz
+#endif
+ 
+      ELSEIF (NZ == 1 .AND. NSTK_FLG < 0) THEN
 C        JUST A SINGLE IMAGE
          IVERSION = 20140        
          ISPG     = 0    
-         NZMRC    = 1           ! IMAGE           
-         MZ       = 1
-         NSTACK   = -2
-      ELSEIF (NZ == 1 .AND. NSTACK >= 1) THEN
+         NZ       = 1            ! IMAGE (NOT A VOLUME OR STACK)        
+         MZ       = 1            ! IMAGE (NOT A VOLUME)
+         NSTK_FLG = -2           ! NOT A STACK
+
+
+#if defined (SP_DBUGIO)
+         write(3,*)' In openfil_n_mrc, nz,nstk_flg: ',nz,nstk_flg
+#endif
+
+      ELSEIF (NZ == 1 .AND. NSTK_FLG >= 1) THEN
 C        A 2014 STANDARD IMAGE STACK
          IVERSION = 20140        
          ISPG     = 0    
-         NZMRC    = NZ          ! IMAGE           
-         MZ       = NSTACK
-      ELSEIF (NZ > 1 .AND. NSTACK < 0 ) THEN
-C        SINGLE VOLUME
+         NZ       = 1            ! IMAGE (NOT A VOLUME) (SINGLE SLICE) 
+         MZ       = NSTK_FLG     ! STACK SIZE, NUMBER OF IMAGES IN STACK
+
+      ELSEIF (NZ > 1 .AND. NSTK_FLG < 0 ) THEN
+C        A 2014 SINGLE VOLUME
          IVERSION = 20140
          ISPG     = 1    
-         NZMRC    = NZ          ! NUMBER OF IMAGES??
-         MZ       = NZ
-         NSTACK   = -2
-         !write(3,*)' In openfil_n_mrc, nstack,nzmrc: ', nstack,nzmrc,nz
-      ELSEIF (NZ > 1 .AND. NSTACK > 0 ) THEN
-C        STACK OF EM VOLUMES
-         IVERSION = 20140       ! SO NZ IS NOT FOR STACK
+C        MZ       = MZ           ! VOLUME 
+         NSTK_FLG = -1           ! NOT A STACK
+
+      ELSEIF (NZ > 1 .AND. NSTK_FLG > 0 ) THEN
+C        A 2014 STACK OF EM VOLUMES  (WHAT SOFTWARE USES VOLUME STACKS?)
+         IVERSION = 20140        ! SO NZ IS NOT FOR STACK
          ISPG     = 401    
-         NZMRC    = NZ          ! NUMBER OF VOLUMES
-         MZ       = NZ * NSTACK
-         NSTACK   = MZ          ! STACK SIZE
+C        NZ       = NZ           ! NUMBER OF VOLUMES
+         MZ       = NZ * NSTK_FLG
+         NSTK_FLG = MZ           ! STACK SIZE  (MASY BE WRONG)
+
       ELSE 
-         CALL ERRT(102,'BAD STACK OR VOLUME PARAMETERS',NSTACK)
+         CALL ERRT(102,'BAD STACK OR VOLUME PARAMETERS',NSTK_FLG)
          IRTFLG = 1
          RETURN
       ENDIF
-
-      !write(3,*)' In openfil_n_mrc, set:', nx,ny,nz,MX,MY,MZ
-
+ 
 C     MODE IS ALWAYS 32 BIT REAL FOR NEW FILES (FOR NOW)
-      CALL LUNSETMODSIZ_MRC(LUN,MRCMODE,NX,NY,NZMRC,
+      CALL LUNSETMODSIZ_MRC(LUN,MRCMODE,NX,NY,NZ,
      &                                  MX,MY,MZ,IRTFLG)
       IF (IRTFLG .NE. 0) RETURN
 
+#if defined (SP_DBUGIO)
+      write(3,*)' End openfil_n_mrc; nstk_flg: ', nstk_flg
+      write(3,*)' end openfil_n_mrc; nx,ny,NZ: ', nx,ny,nz
+      write(3,*)' End openfil_n_mrc; mx,my,mz: ', mx,my,mz
+#endif
+
+
 C     SET EXTRA HEADER BYTES, NO. OF LABELS USED, VERSION, ETC
       NSYMBT = 0                      ! RESET BY LUNSETXXX_MRC
       NLABL  = 1                      ! RESET BY LUNSETXXX_MRC
-      !write(3,*)' In oprnfil_n, set:', iversion,ispg,nzmrc,mz,nstack
+
       CALL LUNSETVIN_MRC(LUN,IVERSION,ISPG,NSYMBT,NLABL,IRTFLG)
       IF (IRTFLG .NE. 0) RETURN
 
+#if defined (SP_DBUGIO)
+      !write(3,*)' End openfil_n; iversion,ispg,nlabl: ',
+      ! &                         iversion,ispg,nlabl
+#endif
+
 C     SET:  N?START,CELLANGS,AXES,NSYMBYT,MAP,MACHST,LABELS,...
       CALL LUNSETXXX_MRC(LUN,IRTFLG)
       IF (IRTFLG .NE. 0) RETURN
diff --git src/openfil_o_mrc.f src/openfil_o_mrc.f
index 49e79c52..f8085971 100644
--- src/openfil_o_mrc.f
+++ src/openfil_o_mrc.f
@@ -1,14 +1,17 @@
 C++*********************************************************************
 C
 C OPENFIL_O_MRC.F   ADAPTED FROM OPENFIL         MAY 2019 ArDean Leith
+C                   NLABEL BUG                   SEP 2025 ArDean Leith
+C                   DEBUG OUTPUT ADDED           SEP 2025 ArDean Leith
+C                   IRTFLG AND NLABL CHANGED     SEP 2025 ArDean Leith
 C
 C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2019  Health Research Inc.,                         *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@health.ny.gov                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -24,27 +27,51 @@ C=* along with this program. If not, see <http://www.gnu.org/licenses> *
 C=*                                                                    *
 C **********************************************************************
 C
-C  OPENFIL_O_MRC(LUNT,FILNAM,NLET,IMGNUM, NX,NY,NZ,NSTACK, IRTFLG)
+C  OPENFIL_O_MRC(LUNT,FILNAM,NLET,DSP,IMGNUM,
+C                NX,NY,NZ, NSTK_FLG, IRTFLG)
 C
 C  PURPOSE: OPEN EXISTING MRC DATA FILE FOR READ/WRITE  
 C
 C  PARAMETERS:
 C       LUNT     LOGICAL UNIT NUMBER FOR FILNAM.                (SENT)
 C       FILNAM   FILE NAME (NO @)                               (SENT)
-C       NLET     LENGTH OF FILE NAME                            (RET.)
+C       NLET     LENGTH OF FILE NAME                            (SENT)
 C       DSP      OLD OR NEW FILE                                (SENT)
 C       IMGNUM   IMAGE NUMBER IF STACKED                        (SENT)
-C       NX,NY,NZ DIMENSIONS OF IMAGE                            (RET.)
-C       NSTACK   STACK INDICATOR                                (RET.)
+C
+C       NX,NY    X & Y DIMENSIONS OF IMAGE/VOL                  (RET)
+C       NZ       Z  DIMENSION OF VOL OR MRCS_NSTK               (RET)
+C       NSTK_FLG STACK INDICATOR                                (RET)
 C                   -2  :  NOT A STACK 
-C                   >=0 :  MAX IMAGE NUMBER NOW IN STACK.
-C       IRTFLG   ERROR RETURN FLAG.                             (RET.)
+C                   -1  :  AST FOR NSTK  (@* or *@) 
+C                    0  :  BARE STACK    (@)
+C                   >=0 :  MAX IMAGE NUMBER NOW IN STACK
+C
+C       GET_IMG_STK  GETS NSTK_FLG: NSTK or NOT or BARE 
+C                  -2 :  NOT A STACK   (NO @)
+C                  -1 :  AST FOR NSTK  (@* or *@)   
+C                   0 :  BARE STACK    (@)
+C                  >1 :  STACKED IMAGE NUMBER
+C
+C       IRTFLG   ERROR RETURN FLAG.                             (RET)
 C                   0 : NORMAL RETURN
 C                   1 : ERROR RETURN
 C
-C  VARIABLES:
-C       (23) ISPG == 0     CONTAINS IMAGE OR IMAGE STACK
-C       (23) ISPG == 1     CONTAINS VOLUMES
+C  VARIABLES:  
+C           (FOR MRC 2014)
+C                 ISPG (23)   NZ (1)     MZ (10)
+C       IMAGE           0      1          1
+C       IMAGE STACK     0     NSTK       NSTK
+C       VOLUME (Z)            NZ         NZ
+C       VOLUME STACK  401     NZ*NSTK    NZ/NSTK
+C
+C           (FOR MRCS)
+C                 ISPG (23)   NZ (1)     MZ (10)
+C       IMAGE           0     1          1
+C       IMAGE STACK     0     NSTK       1
+C       VOLUME (Z)            NZ         NZ
+C
+C       (23) ISPG == 1     CONTAINS SINGLE VOLUME
 C       (23) ISPG == 401   CONTAINS STACK OF EM VOLUMES
 C       (24) NSYMBT        NO. OF EXTRA SYMMETRY, ETC. BYTES
 C       (56) NLABL         NO. OF 80 CHAR TEXT LABELS IN #57..256
@@ -57,7 +84,7 @@ C23456789 123456789 123456789 123456789 123456789 123456789 123456789 12
 C--*********************************************************************
 
       SUBROUTINE OPENFIL_O_MRC(LUNT,FILNAM,NLET,DSP,IMGNUM,
-     &                         NX,NY,NZ,NSTACK, IRTFLG)
+     &                         NX,NY,NZ, NSTK_FLG, IRTFLG)
 
       IMPLICIT NONE
 
@@ -66,11 +93,12 @@ C--*********************************************************************
 
       CHARACTER(LEN=*)        :: FILNAM
       CHARACTER(LEN=1)        :: DSP
-      INTEGER                 :: LUNT,NLET,IMGNUM, NX,NY,NZ,NSTACK
+      INTEGER                 :: LUNT,NLET,IMGNUM
+      INTEGER                 :: NX,NY,NZ,NSTK_FLG
       INTEGER                 :: IRTFLG
 
       INTEGER                 :: LUN,NE
-      INTEGER                 :: I,NZMRC,MX,MY,MZ
+      INTEGER                 :: I,MX,MY,MZ
       INTEGER                 :: IVERSION,NSYMBT,IHEDLEN,NLABL,NBYT
       CHARACTER(LEN=1)        :: ENDED
       CHARACTER(LEN=2)        :: DISP
@@ -83,7 +111,7 @@ C--*********************************************************************
       REAL                    :: SCALEX,SCALEY,SCALEZ
       INTEGER                 :: IMAMIT
       REAL                    :: FMINT,FMAXT,AVT,SIGT
-      INTEGER                 :: ISPG,INOW,IGO,IEND,ILAB
+      INTEGER                 :: ISPG,INOW,IGO,IEND,ILAB,iflip
       LOGICAL                 :: ENDOK
       INTEGER                 :: LOCAT   
       INTEGER                 :: MAPC,MAPR,MAPS
@@ -99,40 +127,63 @@ C     PURPOSE:  OPEN EXISTING MRC FILE FOR STREAM ACCESS
            
       LUN = LUNT
 
-C     SET READ TO CONVERT TO LITTLE ENDEDNESS
+C     SET READ FOR NATIVE LITTLE ENDIANNESS  
       DISP(1:1) = 'O'
       ENDED     = 'L'
       DISP(2:2) = ENDED
 
-      !write(3,*)' In openfil_o_mrc, nlet,filnam:',nlet,filnam(:nlet)
-      !write(3,*)' In openfil_o_mrc, imgnum:',imgnum
+#if defined (SP_DBUGIO)
+      write(3,*)' In openfil_o_mrc; imgnum:   ', imgnum
+      write(3,*)' In openfil_o_mrc; filnam:   ', filnam(:nlet)
+      write(3,*)' In openfil_o_mrc; disp:     ', disp
+      write(3,*)'   '
+      write(3,*)' In openfil_o_mrc; calling loadhed_mrc    '
+      write(3,*)'  '
+#endif
 
-C     OPEN EXISTING FILE, CREATE HEADER OBJECT, AND CHECK ENDEDNESS 
-      !write(6,*)' In openfil_o_mrc, call loadhed_mrc, disp:',disp
+C     OPEN EXISTING FILE, READ HEADER & LOAD IN HEADER OBJECT  
       CALL LOADHED_MRC(LUN,FILNAM,NLET,DISP,IRTFLG)
-      
+
+#if defined (SP_DBUGIO)
+      write(3,*)' In openfil_o_mrc; After calling loadhed_mrc 111  '
+#endif
+
 C     DETERMINE CURRENT FILE ENDED-NESS AS READ IN
       CALL LUNGETMAP_MRC(LUN,MAPC,MAPR,MAPS,IRTFLG)
-      !write(3,*)' In openfil_o_mrc, mapc,r,s: ',mapc,mapr,maps
 
+#if defined (SP_DBUGIO)
+      write(3,*)' In openfil_o_mrc; mapc,mapr,maps: ',mapc,mapr,maps
+#endif
+
+C     CHECK ENDIANNESS 
       ENDOK = ((MAPC == 1) .OR. (MAPR == 1) .OR. (MAPS == 1))
-      IF (ENDOK)  CALL LUNSETFLIP(LUN,0,IRTFLG)
+      IF (ENDOK)  THEN
+
+         CALL LUNSETFLIP(LUN,0,IRTFLG)   ! NO FLIP NEEDED
 
-      IF (.NOT. ENDOK) THEN
+      ELSE
 C        NOT RIGHT ENDEDNESS, TRY CONVERT FROM BIG ENDED 
         
          ENDED     = 'B'
          DISP(2:2) = ENDED
 
-C        OPEN FILE, CREATE HEADER OBJECT AND CHECK ENDEDNESS 
+ 
+C        OPEN FILE, CREATE HEADER OBJECT 
 
-         !write(6,*)' In openfil_o_mrc, call loadhed_mrc, disp:',disp
+#if defined(SP_DBUGIO)
+         write(3,*)' In openfil_o_mrc, Call loadhed_mrc, disp:',disp
+#endif
+
+C        OPEN EXISTING FILE, READ HEADER & LOAD IN HEADER OBJECT  
          CLOSE (LUN)
          CALL LOADHED_MRC(LUN,FILNAM,NLET,DISP, IRTFLG)
 
 C        DETERMINE CURRENT FILE ENDED-NESS AS READ IN
          CALL LUNGETMAP_MRC(LUN,MAPC,MAPR,MAPS,IRTFLG)
-         !write(3,*)' In openfil_o_mrc, mapc,r,s: ',mapc,mapr,maps
+
+#if defined(SP_DBUGIO)
+         write(3,*)' In openfil_o_mrc; mapc,mapr,maps: ',mapc,mapr,maps
+#endif
 
          ENDOK = ((MAPC == 1) .OR. (MAPR == 1) .OR. (MAPS == 1))
 
@@ -144,21 +195,31 @@ C           MUST FLIP FILE CONTENTS WHEN READ IN
          ENDIF
 
       ENDIF
-      
+
       IF (MYPID <= 0 .AND. IRTFLG .NE. 0) THEN        
 C         NEITHER ENDEDNESS SEEMS OK --> OPENING ERROR 
-          MSG = 'OPENFIL_O_MRC; OPENING FILE: ' // FILNAM(1:NLET)
+
+                           WRITE(NDAT,904) MAPC,MAPR,MAPS
+          IF (NDAT .NE. 6) WRITE(6,904)    MAPC,MAPR,MAPS
+904       FORMAT(' *** HEADER MAPC,MAPR,MAPS: ',I8,' ',I8,' ',I8,
+     &           ' ARE NONSENSE ')
+
+          MSG = 'OLD FILE HEADER NOT MRC/MAP:  ' // FILNAM(1:NLET)
           CALL ERRT(101,MSG,NE)
-          IRTFLG =1
+          IRTFLG = 1
           RETURN
       ENDIF
 
-C     GET IMAGE/VOLUME SIZE PARAMETERS AND MODE
-      CALL LUNGETMODSIZ_MRC(LUN,MRCMODE,NX,NY,NZMRC, MX,MY,MZ,IRTFLG)
+C     PUT FILNAM IN COMMON LUN HEADER
+      CALL LUNSETFILE_MRC(LUN,FILNAM(1:NLET),NULL,IRTFLG)
+
+C     GET FILE  MODE
+      CALL LUNGETMODE_MRC(LUN,MRCMODE,IRTFLG)
       IF (IRTFLG .NE. 0) RETURN        
 
-      !write(6,*)' In openfil_o_mrc, mrcmode: ',mrcmode
-      !write(3,*)' In openfil_o_mrc, size (x,y,z),mz: ',nx,ny,nzmrc,mz
+#if defined(SP_DBUGIO)
+      write(3,*)' In openfil_o_mrc; mrcmode: ',mrcmode
+#endif
 
       IF (MYPID <= 0 .AND. (MRCMODE == 3 .OR. MRCMODE == 4)) THEN
          CALL ERRT(102,'UNSUPPORTED MRC TRANSFORM FILE, MODE',MRCMODE)
@@ -166,95 +227,169 @@ C     GET IMAGE/VOLUME SIZE PARAMETERS AND MODE
          RETURN
       ENDIF
 
-      !write(3,*)' In openfil_o_mrc, imgnum,mz: ',imgnum,mz
+C     GET MRC FILE PARAMETERS: IVERSION,ISPG,NSYMBT,NLABL
+      CALL LUNGETVIN_MRC(LUN,IVERSION,ISPG,NSYMBT,NLABL,IRTFLG)
 
+#if defined (SP_DBUGIO)
+      write(3,*)' In openfil_o_mrc; iversion,ispg: ', iversion,ispg
+      write(3,*)' In openfil_o_mrc; nsymbt, nlabl: ', nsymbt, nlabl
+#endif
+      IF (IRTFLG .NE. 0) RETURN 
+       
 C     READ NLABL LABELS FROM FILE (<= 800 CHAR)
       CALL LUNGETLABELS_MRC(LUN,NLABL,LABELS,IRTFLG)
-      IF (IRTFLG .NE. 0) RETURN        
+      IF (IRTFLG .NE. 0) RETURN
 
-C     GET MRC FILE PARAMETERS: IVERSION,ISPG,NSYMBT,NLABL
-      CALL LUNGETVIN_MRC(LUN,IVERSION,ISPG,NSYMBT,NLABL,IRTFLG)
-      !write(3,*)' In openfil_o_mrc, ispg,iversion: ', ispg,iversion
-      !write(6,*)' In openfil_o_mrc, nsymbt, nlabl: ', nsymbt, nlabl
+#if defined (SP_DBUGIO)
+      write(3,*)' In openfil_o_mrc; nlabl: ',nlabl
+      !write(3,*)' In openfil_o_mrc; First label: ' ,labels(1:80)
+      call lungetflip(lun,iflip,irtflg)
+      write(3,*)' In openfil_o_mrc, iflip: ',iflip
+#endif
+
+C     GET MRC FILE PARAMETERS: NZ,MZ, & NSTK_FLG
+C               (SHOULD HANDLE .mrcs FILES OK)
+
+C     GET IMAGE/VOLUME SIZE PARAMETERS AND MODE
+      CALL LUNGETMODSIZES_MRC(LUN,NX,NY,NZ, 
+     &                        MX,MY,MZ,IRTFLG)
       IF (IRTFLG .NE. 0) RETURN        
-  
-C     GET MRC FILE PARAMETERS:  NZ,MZ, & NSTACK.(HANDLES .mrcs FILES OK)
-      CALL LUNGETNSTACK_MRC(LUN, NX,NY,NZ,MZ,NSTACK,IRTFLG)
+
+
+      CALL LUNGETNSTACK_MRC(LUN, NX,NY,NZ, MZ, NSTK_FLG,IRTFLG)
       IF (IRTFLG .NE. 0) RETURN        
 
-      !write(3,*)' In openfil_o_mrc, filnam: ',filnam(1:nlet)
-      !write(3,*)' In openfil_o_mrc, nz,mz,nstack: ',nz,mz,nstack !!!!!
-      !write(3,*)' In openfil_o_mrc,imgnum,mz,nstack: ',imgnum,mz,nstack
+C     NZ FROM FILE IS NOT VOLUME DIMENSION IF MRC VERSION: 2014*
+C                 ISPG (23)   NZ (1)     MZ (10)
+C       IMAGE           0      1          1
+C       IMAGE STACK     0     NSTK       NSTK
+C       VOLUME (Z)            NZ         NZ
 
-C     BARE STACK REFERENCE WITHOUT '@' ALLOWED FROM 'ST' & 'LI'
-      IF (MZ > 1 .AND. IMGNUM < -1 ) THEN 
-C        BARE STACK REFERENCE NOT ALLOWED WITHOUT '@' NORMALLY
-         CALL ERRT(101,'STACK INDICATOR (@) MISSING',NE)
-         IRTFLG = 3
-         RETURN
+
+#if defined (SP_DBUGIO)
+      write(3,*)' In openfil_o_mrc  88 ; nx,ny:    ', nx,ny
+      write(3,*)' In openfil_o_mrc; 88 ; ispg:     ', ispg 
+      write(3,*)' In openfil_o_mrc  88 ; nz,mz:    ', nz,mz
+      write(3,*)' In openfil_o_mrc; 88 ; nstk_flg: ', nstk_flg
+#endif
+
+      IF (NSTK_FLG > = 0) THEN
+         IMGNUM = NSTK_FLG
       ENDIF
 
+#if defined (SP_DBUGIO)
+      write(3,*)' In openfil_o_mrc; imgnum,nstk_flg: ',imgnum,nstk_flg
+#endif
+
+C      BARE STACK REFERENCE WITHOUT '@' ALLOWED FROM 'ST' & 'LI'  ?????
+C      IF (MZ > 1 .AND. IMGNUM == 0 ) THEN 
+C        BARE STACK REFERENCE NOT ALLOWED WITHOUT '@' NORMALLY
+C         CALL ERRT(101,'STACK INDICATOR (@) MISSING',NE)
+C         IRTFLG = 3
+C         RETURN
+C      ENDIF
+
 C     ENSURE STACKED IMAGE EXISTS
-      IF (DSP == 'O' .AND. (IMGNUM > 1 .AND. IMGNUM > NSTACK)) THEN
+      IF (DSP == 'O' .AND. (IMGNUM > 1 .AND. IMGNUM > NSTK_FLG)) THEN
          CALL ERRT(102,'IMAGE EXCEEDS HIGHEST IMAGE IN STACK',MZ)
          IRTFLG = 1
          RETURN        
       ENDIF
 
-      !write(3,*)' In openfil_o_mrc, dsp :'  , dsp 
-      !write(3,*)' In openfil_o_mrc, imgnum:', imgnum 
-      !write(3,*)' In openfil_o_mrc, nstack:', nstack
+C     UPDATE MZ AND NSTK_FLG IN MRC HEADER FOR NEW STACKED IMAGE
 
-C     UPDATE MZ AND NSTACK IN MRC HEADER FOR NEW STACKED IMAGE
       IF (DSP == 'N' .AND.
-     &    IMGNUM > 1 .AND. 
-     &    (NSTACK > 0 .or. MZ == 1) .AND. 
-     &    IMGNUM > NSTACK) THEN
+     &    IMGNUM  > 1 .AND. 
+     &    (NSTK_FLG > 0 .or. MZ == 1) .AND. 
+     &    IMGNUM > NSTK_FLG) THEN
+
+         NSTK_FLG = IMGNUM
+      
          ! EXTENDING STACK WITH A NEW IMAGE/VOLUME
-         !write(3,*)' In openfil_o_mrc2, dsp,imgnum:', dsp,imgnum,nstack
-         NSTACK = IMGNUM      
-         CALL LUNSETNSTACK_MRC(LUN, NZ,NSTACK,IRTFLG)
+
+#if defined (SP_DBUGIO)
+         write(3,*)' In openfil_o_mrc 2 Set|   nz,nstk_flg: ',  
+     &                                         nz,nstk_flg
+         write(3,*)' In openfil_o_mrc 2; Calling lunsetnstack ----'
+#endif
+
+         CALL LUNSETNSTACK_MRC(LUN, NZ, NSTK_FLG,IRTFLG)
          IF (IRTFLG .NE. 0) RETURN        
       ENDIF
 
+
 C     SET SPIDER IFORM IN COMMON CMBLOCK
       IFORM = 2
       IF (NZ > 1) IFORM = 3 
 
-C     SET IMGNUM AND NSTACK IN STATIC HEADER
-      !write(6,*)' In openfil_o_mrc - imgnum,nstack:',imgnum,nstack 
-      CALL LUNSETSTK_MRC(LUN,IMGNUM,NSTACK,IRTFLG)
+C     SET IMGNUM AND NSTK_FLG IN STATIC HEADER
+
+#if defined (SP_DBUGIO)
+      write(3,*)'  '
+      write(3,*)' In openfil_o_mrc 3  Set| imgnum,nstk_flg: ',
+     &                                     imgnum,nstk_flg
+      write(3,*)' In openfil_o_mrc 3  Calling lunsetstk ----'
+#endif
+ 
+      CALL LUNSETSTK_MRC(LUN,IMGNUM,NSTK_FLG,IRTFLG)
       IF (IRTFLG .NE. 0) RETURN        
 
-      IF (FCHAR(4:5) ==  'HE' .AND.  FCHAR(1:2) ==  '31') THEN
+#if defined (SP_DBUGIO)
+      write(3,*)' In openfil_o_mrc| fchar(1:2),fchar(4:5): ',
+     &                              fchar(1:2),'  ',fchar(4:5)
+      write(3,*) '    '
+#endif
+
+      IF (FCHAR(1:2) == '31' .AND. FCHAR(4:5) == 'HE') THEN
+
+C     IF (FCHAR(4:5) ==  'HE' .AND.  FCHAR(1:2) ==  '31') THEN
 C        SPECIAL KLUDGE FOR 'MRC HED' SO IT DOESN'T ALTER STATS
-C        SET FLAG FOR NORMAL RETURN	
+C        SET FLAG FOR NORMAL RETURN
+
+#if defined (SP_DBUGIO)
+         write(3,*)' In openfil_o_mrc; special return for MRC HED '
+         write(3,*)'    '
+#endif
+
          IRTFLG = 0
          RETURN
       ENDIF
 
 C     ADJUST FMIN...  FOR DIFFERENT MRC HEADER POSSIBILITIES
 C     DOES NOT PUT FILE VALUES FOR FMIN... INTO COMMON: CMBLOCK   
-C     FILE VALUES FOR FMIN... INTO COMMON: CMBLOCK SET LATER IN LUNSETCOMMON   
+C     FILE VALUES FOR FMIN... IN COMMON: CMBLOCK SET LATER WITH  
+C     LUNSETCOMMON
+
       CALL LUNGETSTATS_MRC(LUN,IMAMIT,FMINT,FMAXT,AVT,SIGT,IRTFLG)
       IF (IRTFLG .NE. 0) RETURN        
  
-      !write(3,*)' In openfil_o_mrc imami,fmin:',imami,fmin 
+#if defined (SP_DBUGIO)
+      write(3,*)' In openfil_o_mrc 4  Got imamit,fmaxt: ',imamit,fmaxt 
+#endif
 
-C     ENSURE THAT STAT'S IMAGE NUMBER IS SET CORRECTLY     
-      IF (IMAMI == 1 .AND. NSTACK <= 0) THEN
+C     ENSURE THAT STAT'S IMAGE NUMBER IS SET CORRECTLY 
+    
+      IF (IMAMIT == 1 .AND. NSTK_FLG <= 0) THEN
 C        NOT A STACK, SO FMIN/FMAX SHOULD BE OK FOR THIS MRC FILE
          CALL LUNSET_STATSIMG_MRC(LUN,1,IRTFLG)
 
-      ELSEIF (IMAMI == 0) THEN
-C        NO IDENTIFIABLE STATS IN MRC IMAGE 
-         !write(3,*)'In openfil_o_mrc, fmin,fmax,imami:',fmin,fmax,imami
+      ELSEIF (IMAMIT == 0) THEN
+C        NO IDENTIFIABLE STATS IN MRC IMAGE
+ 
+#if defined (SP_DBUGIO)
+         write(3,*)' In openfil_o_mrc 5; imamit: ',imamit
+         write(3,*)' In openfil_o_mrc 5; Calling lunset_statsimg '
+         write(3,*)'  '
+#endif
 
          CALL LUNSET_STATSIMG_MRC(LUN,0,IRTFLG)
+
       ENDIF
 
-      !write(6,*)' In openfil_o_mrc - iform,nz: ',iform,nz,nstack 
-      !write(6,*)' In openfil_o_mrc - nx,ny,nz: ',nx,ny,nz,nstack 
+#if defined (SP_DBUGIO)
+      write(3,*)' From openfil_o_mrc; iform:    ', iform 
+      write(3,*)' from openfil_o_mrc; nx,ny,nz: ', nx,ny,nz 
+#endif
 
 C     SET FLAG FOR NORMAL RETURN	
       IRTFLG = 0
@@ -268,6 +403,8 @@ C     ------------------- LOADHED_MRC ---------------------------------
 
 C     COPY MRC FILE HEADER INTO: MRC HEADER
 
+C     DISP  IS INPUT FOR OPSTREAMFILE USE
+
       IMPLICIT NONE
 
       INCLUDE 'CMBLOCK.INC'
@@ -285,17 +422,19 @@ C     INCLUSION FOR OPTIONAL MPI INITIALIZATION.
 
 C     WANT TO OPEN EXISTING MRC FILE FOR STREAM ACCESS
         
-c     write(6,*)' Opening old MRC file: ',FILNAM(1:nlet),
-c     &          '  Convert:',disp  
-
-      IRTFLG = 999   ! DO NOT ECHO OPENING INFO
+      IRTFLG  = 0
+      !IRTFLG = 999   ! DO NOT ECHO OPENING INFO  (sept 2025 al)
       CALL OPSTREAMFILE(.FALSE.,FILNAM(1:NLET),NULL,LUN,
      &                  'UNFORMATTED',DISP,' ',.TRUE.,IRTFLG)
 
-      !write(6,*)' Opened  old MRC file: ',FILNAM(1:nlet),
-c     &           '  Convert:',DISP,' Irtflg: ',irtflg  
+#if defined(NEVER_SP_DBUGIO)
+C23456  
+      write(3,*)' Opened old file; Disp,irtflg: ',disp,irtflg  
+      write(3,*)' Opened old file:              ',filnam(1:nlet)
+#endif
       IF (IRTFLG .NE. 0) RETURN
 
+
 #ifdef USE_MPI
       IF (ONLYONE_RED) THEN
          CALL BCAST_MPI('OPENFIL_MRC','IRTFLG',IRTFLG,1,'I',ICOMM)
@@ -308,13 +447,14 @@ c     &           '  Convert:',DISP,' Irtflg: ',irtflg
       IF (IRTFLG .NE. 0) RETURN
 
 C     READ OVERALL HEADER FROM MRC FILE 
+
       CALL LUNREDHED_MRC(LUN,.TRUE.,IRTFLG)
 
       IF (IRTFLG .NE. 0 .AND. MYPID <= 0) THEN
          WRITE(NOUT,*) '*** ERROR READING HEADER OF: ',FILNAM(:NLET)
          IF (IRTFLG .NE. 0) RETURN
       ENDIF
-     
+
       END
 
 
diff --git src/openinstk.f src/openinstk.f
index ae6f7faa..27508f3a 100644
--- src/openinstk.f
+++ src/openinstk.f
@@ -16,7 +16,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2012  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@wadsworth.org                                        *
+C=* Email: spider@health.ny.gov                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
diff --git src/openstk.f src/openstk.f
index 0eff05f9..aecf195d 100644
--- src/openstk.f
+++ src/openstk.f
@@ -17,9 +17,9 @@ C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2016  Health Research Inc.,                         *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@wadsworth.org                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -81,6 +81,7 @@ C--*********************************************************************
         CHARACTER (LEN=MAXNAM)   :: FILNOAT,FILNPE
         CHARACTER (LEN=2*MAXNAM) :: MSG
 	LOGICAL                  :: EX,ISDIGI,CALLERRTRED,INDXD
+        INTEGER                  :: IMUSED
 
 #ifdef USE_MPI
         include 'mpif.h'
@@ -272,8 +273,16 @@ C	      FOR DISP=Z, DO NOT STOP THE BATCH JOB BY CALLING ERRT
            ENDIF
 
 C          OPEN EXISTING OVERALL STACK FILE, RETURNS MAXIM IN NSTACK
+
+           !write(3,*)'    '
+           !write(3,*)' --------- open old before openfil------------------'
+
 	   CALL OPENFIL(0,FILNOAT,LUN, NX,NY,NZ,NSTACK,
      &                  ITYPE,'O',.FALSE.,IRTFLGT)
+
+           !write(3,*)' --------- open old after openfil------------------'
+           !write(3,*)' In openstk,lun,nstack,irt.:',lun,nstack,irtflgt
+
            IF (IRTFLGT .NE. 0)  RETURN
 
            IF (NSTACK <= -2) THEN
@@ -297,19 +306,23 @@ C             STOP IF REQUESTED IMAGE NOT IN STACK
 C          SET OFFSET INTO LUNSTK FOR THIS STACKED IMAGE
 
            CALL LUNSETIMGOFF(LUN,IMGNUM,NX,IRTFLGT)
-           IF (IRTFLGT .NE. 0) RETURN
+           !write(3,*)' In openstk,lun,imgnum,nx,irt:',lun,imgnum,irtflgt
+            IF (IRTFLGT .NE. 0) RETURN
 
 C          GET SPECIFIED IMAGE HEADER FROM STACK FILE LOCATION
            CALL LUNREDHED(LUN,NX,IMGNUM,CALLERRTRED,IRTFLGT)
+
+           !write(3,*)' In openstk,lun,imgnum,tred+++:',lun,imgnum,callerrtred
+
            IF (IRTFLGT .NE. 0) RETURN
 
 C          RECOVER IMAGE PARAMETERS FROM SPECIFIC IMAGE HEADER
 
 C          GET IMUSED FOR THIS CURRENT IMAGE
+           IMUSED = IMGNUM
            CALL LUNGETINUSE(LUN,IMUSED,IRTFLGT)
 
-
-           !write(6,*) '  in openstk, imgnum,imused:',imgnum,imused
+           !write(3,*)' In openstk,lun,imgnum,imused----:',lun,imgnum,imused
 
            IF (IMUSED .NE. IMGNUM) THEN
 C             NO EXISTING IMAGE WITHIN STACK??
@@ -318,6 +331,8 @@ C             NO EXISTING IMAGE WITHIN STACK??
 C                SOME VERY OLD STACKS DID NOT HAVE IMGNUM IN THEM
                  CALL LUNGET25(LUN,IVAL,IRTFLGT)
 
+                 !write(3,*)' After lunget25,lun,ival,irtflgt:',lun,ival,irtflgt
+
                  IF (IVAL .NE. 1) THEN
 C                   STACK MAY LACK IMAGE OR HAS BAD EM2EM HEADER
 
@@ -325,7 +340,7 @@ C                   GET RECORD INFO (CAN BE FROM OVERALL HEADER)
                     CALL LUNGETLAB(LUN,NDUM1,NDUM2,NRECS,
      &                                 NDUM3,NDUM4,IRTFLGT)
 
-                    !write(6,*) '  imgnum,nrecs:',imgnum,nrecs,disp
+                    !write(3,*)' In openstk, imgnum,nrecs,disp:',imgnum,nrecs,disp(1:1)
 
                     IF (IMGNUM > 0 .AND. NRECS <= 0 .AND.
      &                   DISP == 'Z') THEN
diff --git src/opfilec.f src/opfilec.f
index f1f8cf02..9eae39cc 100644
--- src/opfilec.f
+++ src/opfilec.f
@@ -14,14 +14,15 @@ C                        FOURIER ERRT            DEC 2010 ArDean Leith
 C                        KEEPEXT LOGIC           JUN 2014 ArDean Leith
 C                        INDEX(FILNAM,'.' BUG    AUG 2014 ArDean Leith
 C                        MRC SUPPORT             MAY 2019 ArDean Leith
+C                        DEBUG OUTPUT ADDED      SEP 2025 ArDean Leith 
 C
 C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2019  Health Research Inc.,                         *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@health.ny.gov                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -37,8 +38,9 @@ C=* along with this program. If not, see <http://www.gnu.org/licenses> *
 C=*                                                                    *
 C **********************************************************************
 C
-C  OPFILEC(LUNT,ASKNAM,FILNAM,LUN,DISPT,NX,NY,ITYPE,NZ,
-C          MAXIM,PROMPT,FOUROK,IRTFLG)
+C
+C  OPFILEC(LUNT,ASKNAM,FILNAM,LUN,DISPT,ITYPE,
+C          NX,NY,NZ,MAXIM, PROMPT,FOUROK,IRTFLG)
 C
 C  PURPOSE:         SOLICITS SPIDER OR MRC FILE NAME AND OPENS FILE
 C  
@@ -64,11 +66,12 @@ C                   'U'  -   IT IS NOT KNOWN IF THE FILE EXISTS.
 C                            NX, NY, NZ, AND ITYPE MUST 
 C                            BE SENT.  IF THE FILE ALREADY EXISTS, IT 
 C                            WILL BE REPLACED.
-C                   'K & M'-    NO LONGER USED.
+C                   'K & M'-    NO LONGER USED
+C
 C        ITYPE      IFORM FOR FILE                        (SENT OR RET) 
 C        NX         IMAGE SIZE                            (SENT OR RET)
 C        NY         IMAGE SIZE                            (SENT OR RET)
-C        NZ         IMAGE SIZE                            (SENT OR RET)
+C        NZ         VOLUME SIZE                           (SENT OR RET)
 C        MAXIM      STACK INDICATOR                          (SENT/RET)
 C                   ON INPUT (IF NEW):
 C                        0 IS FOR SPECIFIC IMAGE           
@@ -76,11 +79,11 @@ C                       +1 STACK
 C                       -1 INDEXED STACK                               
 C                   ON INPUT (IF EXISTING):
 C                        0 IS FOR SPECIFIC IMAGE ONLY         
-C                       <0 or >0 ALLOWS WHOLE STACK OPERATION                              
+C                       <0 or >0 ALLOWS WHOLE STACK OPERATION            C                  
 C                   ON OUTPUT:
 C                       -2 NON-STACK IMAGE                
 C                       -1 STACKED IMAGE                  
-C                     >= 0 IS CURRENT MAX. IMAGE NO. FOR STACK             
+C                     >= 0 IS CURRENT MAX. IMAGE NO. FOR STACK           C  
 C        PROMPT     PROMPT FOR FILNAME                           (SENT)
 C                       AT END:  ~  SKIPS FILE ON PROMPT
 C                                ~7 CAN OPEN A STACK WITHOUT @
@@ -137,36 +140,46 @@ C23456789012345678901234567890123456789012345678901234567890123456789012
 C--*********************************************************************
 
         SUBROUTINE OPFILEC(LUNT,ASKNAM,FILNAM,LUN,DISPT,ITYPE,
-     &                  NX,NY,NZ,MAXIM,PROMPT,FOUROK,IRTFLG)
+     &                  NX,NY,NZ,MAXIM, PROMPT,FOUROK,IRTFLG)
 
         IMPLICIT NONE
 
         INCLUDE 'CMBLOCK.INC'
         INCLUDE 'CMLIMIT.INC'
 
+        integer           :: lunara,lunstk,lunarb,lunflip,iflip
+        common /lunara/ lunara(100),lunstk(100),lunarb(100),lunflip(100)
+
+
         CHARACTER (LEN=*) :: FILNAM,PROMPT,DISPT
         INTEGER           :: LUNT,LUN,ITYPE,NX,NY,NZ,MAXIM,IRTFLG
         LOGICAL           :: ASKNAM,FOUROK
 
-        INTEGER           :: LENP,NLETI,NBUFSIZT,IRTFLGT,NE
-        INTEGER           :: NSTACK
+        INTEGER           :: LENP,NLETI,NBUFSIZT,IRTFLGT,NE, IRTFLG26
+        INTEGER           :: NSTACK,NSTK_FLG, ilent
         CHARACTER (LEN=1) :: DSP,DISP
         LOGICAL           :: OPSTKNOAT,KEEPEXT
         CHARACTER (LEN=1) :: NULL = CHAR(0)
 
         INTEGER           :: lnblnkn,lnblnk
-        LOGICAL           :: ISMRCFILE
+        LOGICAL           :: ISMRCFILE          ! FUNCTION
+        LOGICAL           :: ISMRC            
 
 C       HACK TO OPEN NEW FILES GREATER THAN NBUFSIZ (DANGEROUS)
         DISP = DISPT
         IF (DISP(1:1) == 'B') DISP = 'U'
-        !write(3,*)' In opfilec, itype: ',itype
+
+C       HACK TO OPEN MRC FILE WITHOUT RESETTING HEADER VALUES
+        IRTFLG26   = 1                    ! NEVER USED!
+        IF (IRTFLG == 26) IRTFLG26 = 26   ! NEVER USED!!
+
+        !write(3,*)' In opfilec; itype: ',itype
 
         LENP = lnblnkn(PROMPT)
-C       CAN PASS ~7  AT END OF PROMTP TO OPEN* TO OPEN A STACK WITHOUT @
+C       CAN PASS ~7 AT END OF PROMTP TO OPEN* TO OPEN A STACK WITHOUT @
         OPSTKNOAT = (PROMPT(LENP-1:LENP) == '~7')
 
-C       CAN PASS ~9  AT END OF PROMTP TO OPEN* TO KEEP INCOMING EXTENSION
+C       CAN PASS ~9 AT END OF PROMTP TO OPEN* TO KEEP INCOMING EXTENSION
         KEEPEXT = (PROMPT(LENP-1:LENP) == '~9')
 
         KEEPEXT = (KEEPEXT      .AND. 
@@ -181,9 +194,11 @@ C       SET DEFAULT ERROR RETURN IRTFLG
            CALL ERRT(102,'PGM. ERROR: LUN MUST BE 1...100',LUN)
            RETURN
         ENDIF
-        !write(3,*)' In opfilec, asknam,keepext: ',asknam,keepext
-        !write(3,*)' In opfilec, itype,dispt: ',itype,disp
-        !write(3,*)' In opfilec, filnam(:20): ',filnam(1:20)
+
+#if defined (SP_DBUGIO)
+        write(3,*)' In opfilec; asknam,keepext: ', asknam,keepext
+        write(3,*)' In opfilec; itype,disp:     ', itype,disp
+#endif
 
         IF (ASKNAM) THEN
 C          SOLICIT FILE NAME, KEEPS EXTENSION IF PROMPT ENDS WITH: ~9 
@@ -193,6 +208,11 @@ C          SOLICIT FILE NAME, KEEPS EXTENSION IF PROMPT ENDS WITH: ~9
            NLETI = lnblnk(FILNAM)
         ENDIF
 
+#if defined (SP_DBUGIO)
+        write(3,*)' In opfilec; filnam(1:nleti):   ', filnam(1:nleti)
+#endif
+
+
         DSP = 'O'
         IF (DISP(1:1) .NE. 'O' .AND. 
      &      DISP(1:1) .NE. 'Z' .AND.
@@ -204,28 +224,55 @@ C          HACK TO OPEN FILES GREATER THAN NBUFSIZ (DANGEROUS)
            IF (DISPT(1:1) == 'B') NBUFSIZT = HUGE(NBUFSIZT)
 
 C          CHECK THAT NECESSARY SIZE... INFO IS HERE
+
+           !write(3,*)' In opfilec; itype,nx,ny,nz: ',itype,nx,ny,nz
+
            CALL OPENCHK(NX,NY,NZ,ITYPE,NBUFSIZT,IRTFLGT)
+           !write(3,*)' In opfilec; irtflgt: ',irtflgt
+
            IF (IRTFLGT .NE. 0) RETURN    
-           DSP = 'N'
+           DSP =  'N'
         ENDIF
 
-        IF (ISMRCFILE(FILNAM)) THEN
+        ISMRC = ISMRCFILE(FILNAM)
+
+
+
+        IF (ISMRC) THEN
+
+C          WANT TO OPEN OLD OR NEW MRC FILE FOR STREAM ACCESS xxxxxxxx
+
+#if defined (SP_DBUGIO)
+           !write(3,*)' In opfilec; nx,ny,nz: ',nx,ny,nz
+           ilent = lnblnkn(filnam)
+           write(3,*)' In opfilec; filnam:   ',filnam(1:ilent)
+           write(3,*)' In opfilec; Calling openfil_mrc --------'
+           write(3,*)' ' 
+#endif
 
-C          WANT TO OPEN OLD OR NEW MRC FILE FOR STREAM ACCESS
-           CALL OPENFIL_MRC(LUN,FILNAM,NLETI,NX,NY,NZ,NSTACK,ITYPE,
-     &                      DSP,IRTFLG)
+           NSTK_FLG =  0   ! UNUSED BY OPENFIL_MRC  ON INPUT
+           CALL OPENFIL_MRC(LUN,FILNAM,NLETI,NX,NY,NZ, NSTK_FLG,
+     &                      ITYPE, DSP,IRTFLG)
            IF (IRTFLG .NE. 0) RETURN
-           IFORM = ITYPE
-           MAXIM = NSTACK
 
-           RETURN           ! END OF MRC CODE
+           MAXIM = NSTK_FLG
+
+#if defined (SP_DBUGIO)
+           write(3,*)' In opfilec; nz,maxim: ', nz,maxim
+           write(3,*)' Finished in opfilc  for MRC , Returning ------ '
+           write(3,*)'   '  
+#endif
+           RETURN           ! END OF MRC CODE xxxxxxxxxxxxxxxxxxxxxxx
+
 
         ELSE
-C          WANT TO OPEN NEW OR OLD SPIDER FILE
+C          WANT TO OPEN OLD OR NEW SPIDER FILE
+           !write(3,*)' In opfilc Calling: lunnewhdr'
 
 C          CREATE A NEW HEADER OBJECT FOR THIS LUN, SET LUN FOR SPIDER
            CALL LUNNEWHDR(LUN,IRTFLGT)
            IF (IRTFLGT .NE. 0) RETURN
+           !write(3,*)' In opfilc after callin: lunnewhdr'
 
 C          PUT FILENAME AND DSP IN OFF-FILE AREA OF THE HEADER OBJECT
            CALL LUNSETFILE(LUN,FILNAM,DSP,IRTFLGT)
@@ -235,31 +282,42 @@ C          PUT ISBARE IN STATIC AREA OF HEADER OBJECT
            CALL LUNBAREFILE(LUN,FILNAM,IRTFLGT)
            IF (IRTFLGT .NE. 0) RETURN
 
+           !write(3,*)' In opfilc Callin: lunsetluns: ', lun
+
 C          MAKE SURE THE STACK OFFSET IS ALWAYS ZEROED, LUNARB SET ...
            CALL LUNSETLUNS(LUN,0,0,LUN,0,IRTFLGT)
            IF (IRTFLGT .NE. 0) RETURN
 
+           !write(3,*)' In opfilc after set luns; filnam: ',filnam
+
            IRTFLG = 0
            IF (INDEX(FILNAM,'@') == 0) THEN
 
-C             NOT AN IMAGE STACK, BUT MAY BE AN INLINE FILE. 
-C             NOTE: THIS IS THE PATH FOR 'REGULAR' SPIDER IMAGE FILES.
+C             NOT AN IMAGE STACK, BUT MAY BE AN INLINE or 'REGULAR'                    SPIDER FILE.
 
-              !write(3,*)' In opfilec, call openfil itype:',itype,nstack
+#if defined (SP_DBUGIO)
+              !write(3,*)' In opfilec, B4 openfil itype,nstack:',
+      !&                                           itype,nstack
+              !write(3,*)' In opfilec, B4 openfil disp: ',disp
+              !write(3,*)' In opfilec; B4 openfil  ---------------'
+#endif
+  
               NSTACK = 0
-	      CALL OPENFIL(LUNT,FILNAM,LUN,NX,NY,NZ,NSTACK,
+              CALL OPENFIL(LUNT,FILNAM,LUN,NX,NY,NZ,NSTACK,
      &                     ITYPE,DISP(1:1),KEEPEXT,IRTFLG)
 
-              !write(3,*)' In opfilec, openfil returned filnam:',filnam
-              !write(3,*)' In opfilec, nstack,irtflg:',nstack,irtflg
+#if defined (SP_DBUGIO)
+              !write(3,*)' In opfilec; got filnam:',filnam
+              !write(3,*)' In opfilec; nstack,irtflg: ',nstack,irtflg
+#endif
 
               IF (IRTFLG .NE. 0) RETURN
 
 C             RETURNS NSTACK -2 FOR NON-STACK or MAXIM
 
               IF (NSTACK >= 0 .AND. .NOT. OPSTKNOAT ) THEN 
-C                BARE STACK REFERENCE ALLOWED WITHOUT '@' FROM 'ST' & 'LI'
-C                BARE STACK REFERENCE NOT ALLOWED WITHOUT '@' NORMALLY
+C                BARE STACK REF ALLOWED WITHOUT '@' FROM 'ST'& 'LI'
+C                BARE STACK REF NOT ALLOWED WITHOUT '@' NORMALLY
                  CALL ERRT(101,'STACK INDICATOR (@) MISSING',NE)
                  IRTFLG = 3
                  RETURN
@@ -274,10 +332,20 @@ C             INLINE IMAGE STACK ACCESS WANTED
            ELSE
 C             WANT TO ACCESS A FILE BASED SPIDER IMAGE STACK
               NSTACK = MAXIM
+
+#if defined (SP_DBUGIO)
+              !write(3,*)' In opfilc;; lunt,lun,nstack: ',
+              !&     lunt,lun,nstack,itype,'  ',filnam(:33)
+#endif
+
               CALL OPENSTK(LUNT,FILNAM,LUN,NX,NY,NZ,
      &                     NSTACK,ITYPE,DISP(1:1),IRTFLG)
 
-           ENDIF
+#if defined (SP_DBUGIO)
+              !write(3,*)' In opfilc; filnam: ',filnam
+#endif
+
+            ENDIF
 
 C
 C          RETURN IF THERE IS ANY ERROR OPENING FILE IN OPEN*
@@ -287,22 +355,37 @@ C          RETURN IF THERE IS ANY ERROR OPENING FILE IN OPEN*
      &          DISP(1:1) == 'Z'  .OR. 
      &          DISP(1:1) == 'E') .AND.
      &          ITYPE < 0 .AND. .NOT. FOUROK) THEN
-C             CAN NOT USE EXISTING FOURIER FILE
+C            CAN NOT USE EXISTING FOURIER FILE
              CALL ERRT(101,'OPERATION DOES NOT ACCEPT FOURIER FILES',NE)
              IRTFLG = 2
              RETURN
 
            ELSEIF (.NOT. OPSTKNOAT .AND. 
      &             MAXIM == 0 .AND. NSTACK >= 0) THEN
-C             THIS OPERATION DOES NOT ACCEPT WHOLE STACKS 
+C            THIS OPERATION DOES NOT ACCEPT WHOLE STACKS 
              CALL ERRT(101,'OPERATION DOES NOT WORK ON WHOLE STACKS',NE)
-              IRTFLG = 4
-              RETURN
+             IRTFLG = 4
+             RETURN
            ENDIF
 
            IFORM = ITYPE
-           MAXIM = NSTACK
+           MAXIM = NSTACK 
+
+#if defined (SP_DBUGIO)
+           !write(3,*)' End opfilc; maxim,nstack: ',maxim,nstack
+           !call lungetflip(lunt,iflip,irtflg)
+           !write(3,*)' In opfilec: lunt,iflip: ',     lunt,iflip
+           !write(3,*)' In opfilec: lunflip(lunt): ',  lunflip(lunt) 
+           !write(3,*)' Leaving opfilc; iform,maxim: ',iform,maxim
+           !write(3,*)' ------------ LEAVING OPFILC --------'
+#endif
 
-        ENDIF   ! END OF: SPIDER FILE
+        ENDIF      ! END OF: SPIDER FILE
 
         END
+
+
+
+
+
+
diff --git src/opfiles.f src/opfiles.f
index 55886f33..7e4ba99c 100644
--- src/opfiles.f
+++ src/opfiles.f
@@ -1,8 +1,8 @@
  
 C++*********************************************************************
 C                                                                      
-C  OPFILES.F   NEW                              12/15/06  ArDean Leith    
-C              BAD NUMBRT() TRAP                05/21/09  ArDean Leith  
+C  OPFILES.F   NEW                              12/15/06  ArDean Leith
+C              BAD NUMBRT() TRAP                05/21/09  ArDean Leith 
 C              ASKNAM, PROMPTEX                 12/06/10  ArDean Leith 
 C              NX...                            03/26/12  ArDean Leith 
 C              COPY NON SPIDER INPUT            05/26/14  ArDean Leith 
@@ -11,14 +11,16 @@ C              LOCAST, ASKLIST FOR ILIST        10/02/14  ArDean Leith
 C              DO NOT CHECK .MRC FOR XMIPP       7/25/19  ArDean Leith
 C              MRC SUPPORT                       8/05/19  ArDean Leith
 C              COMMENTS                          2/06/20  ArDean Leith
+C              DEBUG OUTPUT ADDED, NTOT SET 0    9/26/25  ArDean Leith 
+C              ADDED CALL TREE                  10/16/25  ArDean Leith
 C
-C ********************************************************************** 
+C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2020  Health Research Inc.,                         *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@health.ny.gov                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -32,9 +34,9 @@ C=* General Public License for more details.                           *
 C=* You should have received a copy of the GNU General Public License  *
 C=* along with this program. If not, see <http://www.gnu.org/licenses> *
 C=*                                                                    *
-C ********************************************************************** 
+C **********************************************************************
 C 
-C  CONTAINS:  OPFILES, GETOLDIMG, GETNEWIMG, NEXTFILE, NEXTFILES 
+C  CONTAINS: OPFILES, GETOLDIMG, GETNEWIMG, NEXTFILE, NEXTFILES
 C
 C  OPFILES(LUNCP,LUNIMG,LUNDOC,LUNXM,  ASKNAM,FILPAT,NLET, DISP,
 C          ITYPE,NX,NY,NZ,MAXIM, PROMPT,
@@ -49,15 +51,16 @@ C           COMPLETE THE IMPLEMENTATION IN MORE OPERATIONS
 C           ALSO WORKS FOR MRC FILES NOW
 C
 C  PARAMETERS:
-C        LUNCP      UNIT TO COPY HEADER VALUES FROM               (SENT)
-C        LUNIMG     UNIT TO OPEN FILE ON                          (SENT)
-C        LUNDOC     UNIT TO OPEN LIST DOC FILES ON                (SENT)
-C        LUNXM      UNIT TO OPEN XMIPP SELFILE ON                 (SENT)
-C        ASKNAM     FLAG TO ASK FOR FILE NAME                     (SENT)
-C        FILPAT     FILE NAME PATTERN                             (RET)
-C        NLET       CHARS IN FILE NAME PATTERN                    (RET)
-C        DISP       CHARACTER CONTAINING ONE OF THE               (SENT) 
-C                   FOLLOWING DISPOSITION SPECIFICATIONS:
+C        LUNCP     UNIT TO COPY HEADER VALUES FROM               (SENT)
+C        LUNIMG    UNIT TO OPEN FILE ON                          (SENT)
+C        LUNDOC    UNIT TO OPEN LIST DOC FILES ON                (SENT)
+C        LUNXM     UNIT TO OPEN XMIPP SELFILE ON                 (SENT)
+C        ASKNAM    FLAG TO ASK FOR FILE NAME                     (SENT)
+C        FILPAT    FILE NAME PATTERN                             (RET)
+C        NLET      CHARS IN FILE NAME PATTERN                    (RET)
+C        DISP      CHARACTER CONTAINING ONE OF THE              (SENT)
+C 
+C                  FOLLOWING DISPOSITION SPECIFICATIONS:
 C                   'O'   -  FILE IS ASSUMED TO EXIST.  DIMENSIONS,
 C                            ITYPE AND HEADER INFO (IN COMMON) ARE 
 C                            RETURNED TO THE CALLING PROGRAM. 
@@ -70,16 +73,19 @@ C                   'N'  -   WANT NEW FILE. SEND NX, NY, NZ & ITYPE.
 C                   'U'  -   IT IS NOT KNOWN IF THE FILE EXISTS.  
 C                            SEND NX, NY, NZ & ITYPE. IF FILE 
 C                            ALREADY EXISTS, IT WILL BE REPLACED.
-C        ITYPE      IFORM FOR FILE                        (SENT OR RET) 
-C        NX,NY,NZ   IMAGE SIZE                            (SENT OR RET)
+C        ITYPE     IFORM FOR FILE                        (SENT OR RET) 
+C
+C        NX,NY,NZ  IMG/VOL SIZE                          (SENT OR RET)
 C
-C        MAXIM      STACK INDICATOR                          (SENT/RET)
+C        MAXIM     STACK INDICATOR OR NUMBER FOR IMAGES     (SENT/RET)
 C                   ON INPUT: STACK INDICATOR IF DISP == 'I'     (SENT)
 C                   ON OUTPUT:                                    (RET)
 C                       -2 A NON-STACK IMAGE                
 C                       -1 A SINGLE STACKED IMAGE                  
-C                     >= 0 CURRENT MAX. IMAGE NO. IN STACK             
-C        PROMPT     PROMPT FOR FILNAME                           (SENT)
+C                     >= 0 NSTK:  CURRENT MAX. IMAGE NO. IN STACK 
+C                   IF NOT STACK MAXIM IS NUMBER IN LIST
+C            
+C        PROMPT    PROMPT FOR FILNAME                           (SENT)
 C                     IF NOT (ASKNAM) THIS IS FILE NAME          (SENT)
 C                     ~ (TILDE) IN LAST CHAR. SAYS SKIP
 C                       "FILE" AT END OF PROMPT
@@ -88,68 +94,74 @@ C                        NEXT-TO-NEXT-TO LAST
 C                        ACCEPTS AN EXTENSION
 C                        (OTHERWISE DISCARDED!)
 C                     ~6 KEEPS OLD DATE/TIME
-C        FOUROK     CAN USE EXISTING FOURIER FILES?              (SENT)
-C        ILIST      IMAGE NUMBER LIST                             (RET)
+C
+C        FOUROK    CAN USE EXISTING FOURIER FILES?              (SENT)
+C
+C        ILIST     IMAGE NUMBER LIST                             (RET)
 C                     IF NIMAXT < 0 MUST BE SENT
 C                     NOT USED IF SINGLE IMAGE/SELFILE 
-C        NIMAXT     MAX LENGTH OF IMAGE NUMBER LIST              (SENT)
+C
+C        NIMAXT    MAX LENGTH OF IMAGE NUMBER LIST              (SENT)
 C                     <0 MEANS DO NOT ASK FOR LIST
-C        NTOT:      # OF IMAGES IN IMAGE NUMBER LIST              (RET)
-C                   ZERO FOR SINGLE IMAGE AND NO * 
-C        IMGNUM     IMAGE NUMBER THAT IS CURRENTLY OPEN      (SENT/RET)
-C                   ON INPUT:   IF (BARESTACK) IS # WANTED
-C                   ON OUTPUT:  <0 IS SELFILE IN USE 
-C        ILIST      IMAGE NUMBER LIST                             (RET)
-C                     IF NIMAXT < 0 MUST BE SENT
-C                     UNUSED IF SINGLE IMAGE/SELFILE 
-C        UNUSED     UNUSED PARAMETER                                (?)
-C        NTOT       # OF IMAGES IN IMAGE NUMBER LIST              (RET)
-C                     ZERO FOR SINGLE IMAGE AND NO * 
-C        IRTFLG     ERROR FLAG (0 IS NORMAL)                      (RET)
+C
+C        UNUSED    UNUSED PARAMETER                                (?)
+C
+C        NTOT:     # OF IMAGES IN IMAGE NUMBER LIST              (RET)
+C                     ZERO FOR SINGLE IMAGE AND NO *
+C 
+C        IMGNUM    IMAGE NUMBER THAT IS CURRENTLY OPEN      (SENT/RET)
+C                     ON INPUT:  IF (BARESTACK) IS # WANTED
+C                     ON OUTPUT: <0 IS SELFILE IN USE 
+C
+C        IRTFLG    ERROR FLAG (0 IS NORMAL)                      (RET)
 C                      -1 GOTO PREVIOUS QUESTION
 C                      -5 NOT A SPIDER OR MRC FILE
-C 
+C
 C  CALL TREE:
 C
-C     OPFILES 
-C        v
-C     FILERD
-C        v 
-C     FILELIST
-C        |  Templated stack: STK@*** 
-C        ` ---> FILNAMANDEXT --> OPFILEC --> GETOLDIMG
-C        |                               --> GETNEWIMG
+C     OPFILES Uses (E.G. STK@*)~~9  prompt for filename
+C        v    '~9' in last 3 char. of prompt accepts ext. on filename 
 C        |
-C        |  Whole barestack: STK@     
-C        ` ---> FILNAMANDEXT --> OPFILEC --> GETOLDIMG
-C        |                               --> GETNEWIMG
+C        |
+C        ` ->  FILERD  
+C        |        ` ->  ECHONAME
+C 
+C        ` ->  FILELIST
+C        |
+C        |  Templated stack: stk@* 
+C        |    ` ---> FILNAMANDEXT --> OPFILEC --> GETOLDIMG
+C        |                                    --> GETNEWIMG
+C        |
+C        |  Whole barestack: stk@     
+C        |    ` ---> FILNAMANDEXT --> OPFILEC --> GETOLDIMG
+C        |                                    --> GETNEWIMG
 C        | 
-C        |  File template:   IMG***  
-C        ` ---> FILGET       --> OPFILEC  
+C        |  File template:   img***  
+C        |     ` ---> FILGET      --> OPFILEC  
 C        | 
-C        |  Simple file:    IMG001
-C        ` --------------------> OPFILEC  
+C        |  Simple file:    img001
+C        |    ` --------------------> OPFILEC  
 C        | 
 C        |  MRC file:       *.MRC or *.MRCS
-C        ` -> OPFILES_MRC
-C           |
-C           |  Templated stack:  **@STK.MRC
-C           ` ---> FILGET_AT --> OPFILEC --> OPENFIL_MRC --> OPENFIL_O_MRC 
-C           |                                            --> OPENFIL_N_MRC
-C           |
-C           |  Whole barestack:  @STK.MRC 
-C           ` ---> FILGET_AT --> OPFILEC --> OPENFIL_MRC --> OPENFIL_O_MRC
-C           |                                            --> OPENFIL_N_MRC
-C           | 
-C           |  File template:    IMG***.MRC
-C           ` ---> FILGET_AT --> OPFILEC --> OPENFIL_MRC --> OPENFIL_O_MRC
-C           |                                            --> OPENFIL_N_MRC
-C           | 
-C           |  Simple file:      IMG001.MRC
-C           ` -----------------> OPFILEC --> OPENFIL_MRC --> OPENFIL_O_MRC  
-C                                                        --> OPENFIL_N_MRC
+C             ` -> OPFILES_MRC
+C             |
+C             | Templated stack:  *@stk.MRC
+C             |  ` ---> FILGET_AT --> OPFILEC --> OPENFIL_MRC --> OPENFIL_O_MRC
+C             |                                            `  --> OPENFIL_N_MRC
+C             |
+C             |  Whole barestack:  @stk.MRC 
+C             |   ` ---> FILGET_AT --> OPFILEC --> OPENFIL_MRC --> OPENFIL_O_MRC
+C             |                                                --> OPENFIL_N_MRC
+C             | 
+C             |  File template:    img***.MRC
+C             |   ` ---> FILGET_AT --> OPFILEC --> OPENFIL_MRC --> OPENFIL_O_MRC
+C             |                                                --> OPENFIL_N_MRC
+C             | 
+C             |  Simple file:      img001.MRC
+C             |   ` -----------------> OPFILEC --> OPENFIL_MRC --> OPENFIL_O_MRC
+C                                                              --> OPENFIL_N_MRC
 C
-C23456789 123456789 123456789 123456789 123456789 123456789 123456789 12 
+C23456789 123456789 123456789 123456789 123456789 123456789 123456789 12
 C--********************************************************************* 
 
        SUBROUTINE OPFILES(LUNCP,LUNIMG,LUNDOC,LUNXM,
@@ -162,20 +174,20 @@ C--*********************************************************************
        IMPLICIT NONE
        INCLUDE 'CMBLOCK.INC' 
        INCLUDE 'CMLIMIT.INC' 
- 
+       
        INTEGER                   :: LUNCP,LUNIMG,LUNDOC
        LOGICAL                   :: ASKNAM
        CHARACTER(LEN=*)          :: FILPAT 
        INTEGER                   :: NLET
        CHARACTER(LEN=1)          :: DISP
-       INTEGER                   :: ITYPE,NX,NY,NZ,MAXIM
+       INTEGER                   :: ITYPE,NX,NY,NZ,MAXIM,NSTK_FLG
        CHARACTER(LEN=*)          :: PROMPT 
        LOGICAL                   :: FOUROK
        INTEGER                   :: ILIST(*)
        INTEGER                   :: NIMAXT,UNUSED,NTOT,IMGNUM, IRTFLG
 
        INTEGER                   :: LUNOP,NLETT,LOCTILDE,LOCAT,LOCAST
-       INTEGER                   :: IMGWANT,IMGNUMIN,LENE,I
+       INTEGER                   :: IMGWANT,IMGNUMIN,LENE,I,IFLIPIN
        INTEGER                   :: NIMAXP,LUNXM,NDUM
        LOGICAL                   :: ISOPEN,GOTFILE
        LOGICAL                   :: SAYIT,ASKLIST
@@ -187,14 +199,13 @@ C--*********************************************************************
        CHARACTER (LEN=1)         :: DISPT 
        CHARACTER (LEN=1)         :: NULL = CHAR(0)
 
-       LOGICAL                   :: IS_MRC,IS_BARE
+       LOGICAL                   :: IS_MRC, IS_BARE
        LOGICAL                   :: ISMRCFILE    ! FUNCTION 
 
        INTEGER                   :: LNBLNKN      ! FUNCTION
-
+  
        LOCTILDE = INDEX(PROMPT,'~') ! unfinished
 
-       !write(3,*)' In opfiles, imgnum: ',imgnum
 
        IF (ASKNAM .AND. PROMPT == NULL) THEN
 C         ASK FOR FILE NAME, CAN ACCEPT EXTENSION
@@ -204,11 +215,11 @@ C         ASK FOR FILE NAME, CAN ACCEPT EXTENSION
      &        DISP == 'U') THEN
 C            NEW FILE, USE DEFAULT PROMPT
              PROMPTEX = 
-     &          'OUTPUT FILE NAME OR TEMPLATE (E.G. STK@****)~~9'
+     &          'OUTPUT FILE NAME OR TEMPLATE (E.G. stk-file@*)~~9'
           ELSE
 C            OLD FILE, USE DEFAULT PROMPT
              PROMPTEX = 
-     &          'INPUT FILE NAME OR TEMPLATE (E.G. STK@****)~~9'
+     &          'INPUT FILE NAME OR TEMPLATE (E.G. stk-file@*)~~9'
           ENDIF
        
           CALL FILERD(FILPAT,NLET,NULL,PROMPTEX,IRTFLG)
@@ -228,20 +239,19 @@ C         USE FILENAME SENT IN: PROMPT
  
        LOCAT    = INDEX(FILPAT(1:NLET),'@')   
        LOCAST   = INDEX(FILPAT(1:NLET),'*')
-       
-       !write(3,*)' locast,locat:',locast,locat,filpat(1:nlet)
-       !write(6,*)' ilist:',ilist(1)
-       !write(6,*)' locast,locat,nstack:',locast,locat,maxim
-       !write(3,*)' in opfiles, nimaxt:',nimaxt
-
+     
        ASKLIST = (NIMAXT > 0)   ! ASK FOR IMAGE NUMBER(S)
        NIMAXP  = ABS(NIMAXT)    ! ILIST DIMENSION, IF ILIST IN USE
  
-       !write(3,*)' in opfiles, nimaxt: ',nimaxt
-       !write(3,*)' in opfiles, asklist: ',asklist
-       !write(3,*)' In opfiles, imgnum: ',imgnum
-
-       IMGWANT = MAX(1,IMGNUM)   ! DEFAULT IMAGE NUMBER               
+       !write(3,*)' In opfiles; locast,locat:   ', locast,locat
+       !write(3,*)' In opfiles; nstack:         ', nstack
+       !write(3,*)' In opfiles; nimaxt:         ', nimaxt
+       !write(3,*)' In opfiles; imgnum:         ', imgnum
+       !write(3,*)' In opfiles, nimaxt:         ',nimaxt
+       !write(3,*)' In opfiles, locast,asklist: ',locast,asklist 
+
+       IMGWANT = MAX(1,IMGNUM)   ! DEFAULT IMAGE NUMBER 
+       NTOT    = 0               ! DEFAULT NUMBER UNUSED        
        
        IF (LOCAST > 0 .AND. ASKLIST) THEN
 C         GET LIST OF IMAGES FROM DOC. FILE OR INPUT LINE
@@ -260,10 +270,14 @@ C         ILIST CONTAINS TEMPLATED SERIES,
 C         START WITH FIRST FILE IN THIS SERIES
           IMGWANT = ILIST(1)
           NTOT    = NIMAXP
-          !write(3,*)' In opfiles, imgwant bb: ',imgwant
-
+ 
        ELSEIF (.NOT. ASKLIST) THEN
           NTOT = NIMAXP
+
+       ELSEIF (LOCAST == 0 .AND. ASKLIST .AND. 
+     &        (IMGWANT < 0 .OR.  IMGWANT > 10000000)) THEN
+C         SIMPLE FILE NAME 
+          IMGWANT = 0
        ENDIF
 
        IF (IMGWANT < 0 .OR. IMGWANT > 10000000) THEN
@@ -272,33 +286,79 @@ C         START WITH FIRST FILE IN THIS SERIES
           RETURN
        ENDIF
 
-       !write(3,*)' In opfiles, nimaxt: ',nimaxt
-       !write(3,*)' In opfiles, ilist: ',ilist(1:5)
-       !write(3,*)' In opfiles, asklist,nimaxp: ',asklist,nimaxp
-       !write(3,*)' In opfiles, maxim,ntot,imgwant: ',maxim,ntot,imgwant
 
 C      SEE IF THIS IS A MRC FILE
        IS_MRC = ISMRCFILE(FILPAT)
 
-       !write(3,*)' In opfiles, imgwant cc: ',imgwant
+
+#if defined (SP_DBUGIO)
+       write(3,*)'   '
+       write(3,*)' In opfiles; asklist,nimaxp: ', 
+     &                         asklist,nimaxp 
+       write(3,*)' In opfiles; filpat: ',filpat(1:36)
+       write(3,*)' In opfiles; ntot,ilist(:2): ', ntot,ilist(1:2)
+       write(3,*)' In opfiles; locast:         ', locast
+       write(3,*)' In opfiles; is_mrc:         ', is_mrc
+      !write(3,*)' In opfiles; imgnum,imgwant: ', imgnum,imgwant
+       write(3,*)'    '
+#endif
+
+
        IF (IS_MRC) THEN
-C         OPEN MRC FILE
+C         OPEN MRC FILE ----------------------------
+
+#if defined (SP_DBUGIO)
+          write(3,*)' In opfiles xxxx ; Calling opfiles_mrc -----'
+#endif
+
+C        FOR OPFILES_MRC:
+C          IMGNUM   IMAGE NUMBER                    (SENT/RET)
+C                   ON INPUT:   IMAGE NUMBER THAT IS WANTED
+C                   ON OUTPUT:  >=0 IMAGE NUMBER CURRENTLY OPEN 
+C                                <0 IS SELFILE IN USE 
+C
+C          NSTK_FLG STACK INDICATOR                  (SENT/RET)
+C                   ON INPUT: STACK INDICATOR IF DISP == 'I' (SENT)
+C                   ON OUTPUT:                       (RET)
+C                       -2 NON-STACK IMAGE                
+C                       -1 STACKED IMAGE WITH * 
+c                        0 BARE STACK                  
+C                     >= 0 IS CURRENT MAX. IMAGE NO. FOR STACK           C                          IF NOT A STACK, THIS IS NUMBER IN LIST
+
+          NSTK_FLG = MAXIM 
+
           CALL OPFILES_MRC(LUNCP,LUNIMG,LUNDOC,
      &                     FILPAT,NLET, DISP,
-     &                     ITYPE,NX,NY,NZ,MAXIM,
-     &                     IMGWANT, IRTFLG) 
-          
-          IMGNUM = IMGWANT
+     &                     ITYPE,NX,NY,NZ, NSTK_FLG,
+     &                     IMGWANT, IRTFLG)
+ 
+          IMGNUM = IMGWANT      ! RETURNED BELOW
+          MAXIM  = NSTK_FLG     ! RETURNED BELOW
+
+#if defined (SP_DBUGIO)
+          write(3,*)' From opfiles_mrc: ' 
+          write(3,*)' Opfiles returns: nz:      ', nz 
+          write(3,*)' Opfiles returns: maxim:   ', maxim 
+          write(3,*)' Opfiles returns: ntot:    ', ntot 
+          write(3,*)' Opfiles returns: imgnum:  ', imgnum 
+          write(3,*)' Opfiles returns: irtflg:  ', irtflg 
+          write(3,*)'   ' 
+#endif
 
           RETURN
-       ENDIF
+       ENDIF  ! -------------- end of mrc --------------------
+
+
+
 
        IMGNUMIN = IMGNUM
        IMGNUM   = 0 
-       !write(3,*) ' In opfiles - imgnum 0: ',imgnum
+
+       !write(3,*) ' In opfiles NOT MRC - imgnum 0: ',imgnum
+       !write(3,*) ' In opfiles; locat,locast: ',locat,locast
 
        IF (LOCAT > 0 .AND. LOCAST > LOCAT) THEN
-C         TEMPLATED STACKED FILE: STK@**** -------------- _9@* or STK@**
+C         TEMPLATED STACKED FILE: STK@* -------------- _9@* or STK@*
 
           FILNAM = FILPAT(1:LOCAT)
             
@@ -317,18 +377,17 @@ C            CONCATENATE EXTENSION ONTO FILNAM
              ENDIF
           ENDIF
 
-          !write(6,*) ' In opfiles - imgwant,imgnum1: ',imgwant,imgnum
+          !write(3,*)'In opfiles - imgwant,imgnum1: ',imgwant,imgnum
 
 C         OPEN THE STACK FILE HEADER 
           MAXIM  = 1  
-	  CALL OPFILEC(LUNCP,.FALSE.,FILNAM,LUNIMG,DISP,
+          CALL OPFILEC(LUNCP,.FALSE.,FILNAM,LUNIMG,DISP,
      &                 ITYPE,NX,NY,NZ, 
-     & 		       MAXIM,' ',FOUROK,IRTFLG) 
-	  IF (IRTFLG .NE. 0) GOTO 9000 
-
-          !write(6,*) ' In opfiles - locast: ',locat,locast,filnam
-          !write(6,*) ' In opfiles - imgwant,imgnum2: ',imgwant,imgnum
+     &                 MAXIM,' ',FOUROK,IRTFLG) 
+          IF (IRTFLG .NE. 0) GOTO 9000 
 
+          !write(3,*) ' In opfiles - locast: ',locat,locast,filnam
+          !write(3,*) ' In opfiles - imgwant,imgnum2: ',imgwant,imgnum
 
 C         OPEN FIRST FILE IN STACK SERIES
           IMGWANT  = ILIST(1)
@@ -338,7 +397,6 @@ C         OPEN FIRST FILE IN STACK SERIES
               GOTO 9000
           ENDIF
 
-
 C         THIS IS NOT A BARE STACK FILE
           CALL LUNSETISBARE(LUNIMG,.FALSE.,IRTFLG)
 
@@ -346,12 +404,12 @@ C         THIS IS NOT A BARE STACK FILE
           IF (DISP == 'U' .OR. DISP == 'N') THEN
 C            WANT A NEW SPIDER STACK FILE FOR OUTPUT
 
-             !write(6,*) ' In opfiles - imgwant,imgnum: ',imgwant,imgnum
+             !write(3,*)' In opfiles  imgwant,imgnum: ',imgwant,imgnum
 
              CALL GETNEWIMG(LUNCP,LUNIMG,LUNDOC,FILPAT,IMGWANT,
      &                      SAYIT,IMGNUM,IRTFLG)
 
-             !write(6,*) ' In opfiles - imgwant,imgnum3: ',imgwant,imgnum
+             !write(3,*) ' In opfiles mgwant,imgnum3:',imgwant,imgnum
 
           ELSE
 C            WANT TO USE EXISTING SPIDER STACK FILE
@@ -363,9 +421,8 @@ C            WANT TO USE EXISTING SPIDER STACK FILE
 C         RETRIEVE CURRENT MAXIMUM IMAGE NUMBER FROM OVERALL HEADER
           CALL LUNGETMAXIM(LUNIMG,MAXIM,IRTFLG)
 
-          !write(6,'(a,a,a,i6,a,i6,a,i6)')' opened templated stack: ',
-!     &          filpat(1:nlet),' at image: ',imgnum, 
-!     &          '  maxim: ',maxim
+          !write(3,'(a,a,a,i6,a,i6,a,i6)')' opened templated stack: ',
+          !&      filpat(1:nlet),' at image: ',imgnum,'  maxim: ',maxim
 
        ELSEIF (LOCAT == NLET) THEN
 C         WHOLE BARESTACK:  STK@  --------------------------_9@ or STK@
@@ -395,8 +452,8 @@ C             OPEN NEW BARE INDEXED STACK
 
           CALL OPFILEC(LUNCP,.FALSE.,FILPAT,LUNIMG,DISPT,
      &                 ITYPE,NX,NY,NZ, 
-     & 		       MAXIM,'INPUT',FOUROK,IRTFLG) 
-	  IF (IRTFLG .NE. 0) GOTO 9000
+     &                 MAXIM,'INPUT',FOUROK,IRTFLG) 
+          IF (IRTFLG .NE. 0) GOTO 9000
 
 C         OPEN FIRST FILE IN STACK, UNLESS SPECIFIED FOR NEW BARE STACK
           IMGWANT = 1
@@ -411,10 +468,11 @@ C            NEW BARE STACK, OPEN REQUESTED FILE IN STACK
              CALL GETNEWIMG(LUNCP,LUNIMG,LUNDOC,FILPAT,IMGWANT,
      &                      SAYIT,IMGNUM,IRTFLG)
              IF (IRTFLG .NE. 0) GOTO 9000
-         
+  
+       
           ELSE
 C            EXISTING BARE STACK, OPEN FIRST FILE IN STACK
-	     CALL GETOLDIMG(LUNIMG,LUNDOC,FILPAT, IMGWANT,
+             CALL GETOLDIMG(LUNIMG,LUNDOC,FILPAT, IMGWANT,
      &                      SAYIT,FOUROK,IMGNUM,IRTFLG)
              IF (IRTFLG .NE. 0) GOTO 9000
 
@@ -431,11 +489,12 @@ C            CREATE IMAGE NUMBER LIST IN: ILIST
           ENDIF
 
           !write(3,*)' Opened bare stack:',filpat(1:nlet),' img:',imgnum
-          !write(6,*)' Opened imgnum, stack:',imgnum,filpat(1:nlet)
+          !write(3,*)' Opened imgnum, stack:',imgnum,filpat(1:nlet)
           !write(3,*)' Opened imgwant,ntot:',imgwant,imgnum,ntot
 
+
        ELSEIF (LOCAST > 0) THEN
-C         A SIMPLE FILE TEMPLATE: IMG*** ----------------------- IMG***
+C         A SIMPLE TEMPLATED FILE: IMG*** -------------------- IMG***
 
 C         FIND IMGNUM FOR FIRST FILE IN THE SERIES
           IMGNUM = ILIST(1)
@@ -447,67 +506,103 @@ C         FIND IMGNUM FOR FIRST FILE IN THE SERIES
 
 C         SUBSTITUTE IMGNUM INTO FILPAT 
           CALL  FILGET(FILPAT,FILNAM,NLET,IMGNUM,IRTFLG)
-	  IF (IRTFLG .NE. 0) GOTO 9000 
+          IF (IRTFLG .NE. 0) GOTO 9000 
 
 C         OPEN FIRST FILE IN THE SERIES
           MAXIM = 0 
-	  CALL OPFILEC(LUNCP,.FALSE.,FILNAM,LUNIMG,DISP,
+          CALL OPFILEC(LUNCP,.FALSE.,FILNAM,LUNIMG,DISP,
      &                 ITYPE,NX,NY,NZ, 
-     & 		       MAXIM,' ',FOUROK,IRTFLG) 
-	  IF (IRTFLG .NE. 0) GOTO 9000 
+     &                 MAXIM,' ',FOUROK,IRTFLG) 
+          IF (IRTFLG .NE. 0) GOTO 9000 
+
+#if defined(SP_DBUGIO)
+          write(3,*)' In opfiles; filpat,imgnum,ntot: ',
+     &                            filpat(:nlet),imgnum,ntot
+          write(3,*)' In opfiles; filnam: ', filnam(:nlet)
+#endif
 
-          !write(6,*)' Opened templated file: ',filpat(1:nlet),
-          !&              '  for:',ntot,' images.'
 
        ELSE
-C         SINGLE SIMPLE INPUT FILE: IMG001 -------------------- IMG001
-C         OR XMIPP SELFILE LISTING FILE: SELX ----------------- SELFILE
-C         OR TRYING TO COPY NON-SPIDER FILE   ----------------- NONSPIFILE
+C         SINGLE INPUT FILE: IMG001 ------------------------ IMG001
+C         SINGLE STACKED FILE: IMGSTK ---------------------- IMGSTK@1
+C         OR XMIPP SELFILE LISTING FILE: SELX -------------- SELFILE
+C         OR TRY TO COPY NON-SPIDER FILE   ----------------- NONSPIFILE
+
+#if defined(SP_DBUGIO)
+          !write(3,*) ' In opfiles ; Simple file: ',filpat(:nlet)
+#endif
                
 C         CHECK FOR XMIPP SELFILE LIST
           IF (LUNXM > 0 .AND. .NOT. ISMRCFILE(FILPAT) ) THEN
-             !write(6,*)' Filpat for openxmsel: ',filpat(:nlet) 
+             !write(3,*)' Filpat for openxmsel: ',filpat(:nlet) 
              CALL OPENXMSELFILE(FILPAT,LUNXM,FILNAM,NLET,NTOT,IRTFLG)
-             !write(6,*)' Filnam from openxmsel: ',ntot,':',filnam(:nlet) 
-
+             !write(3,*)' Filnam from openxmsel: ',ntot,':', filnam(:nlet) 
              INQUIRE(FILE=FILNAM(:NLET),EXIST=GOTFILE)
            
              IF (NTOT > 0 .AND. GOTFILE) THEN
 C               OPEN FIRST FILE IN XMIPP SELFILE LIST
                 MAXIM = 0  
-	        CALL OPFILEC(LUNCP,.FALSE.,FILNAM(:NLET),LUNIMG,DISP,
+                CALL OPFILEC(LUNCP,.FALSE.,FILNAM(:NLET),LUNIMG,DISP,
      &                       ITYPE,NX,NY,NZ, 
-     & 		             MAXIM,'dum~9',FOUROK,IRTFLG) 
-	        IF (IRTFLG .NE. 0) GOTO 9000 
+     &                              MAXIM,'dum~9',FOUROK,IRTFLG) 
+                IF (IRTFLG .NE. 0) GOTO 9000 
 
                 IMGNUM     = -1
-                !write(6,*)' Opened selfile image: ',filnam(1:nlet) 
+                !write(3,*)' Opened selfile image: ',filnam(1:nlet) 
                 RETURN
 
              ENDIF
           ENDIF
 
-C         SINGLE SIMPLE INPUT FILE: IMG001 ------------------ IMG001
+C         SINGLE SIMPLE  INPUT FILE: IMG001   ----------------- IMG001
+C         SINGLE STACKED INPUT FILE: IMGSTK@3 ----------------- IMGSTK@3
+
+#if defined(SP_DBUGIO)
+          !write(3,*)' In opfiles, filpat,itype:     ',filpat(1:nlet)
+          !write(3,*)' In opfiles, itype,nx:',itype,nx
+           write(3,*)' In opfiles, Calling opfilec,  disp: ',disp
+#endif
 
-          !write(3,*)' In opfiles, simple file: ',filpat(1:nlet),itype,nx 
           MAXIM = 0  
-	  CALL OPFILEC(LUNCP,.FALSE.,FILPAT,LUNIMG,DISP,
+          CALL OPFILEC(LUNCP,.FALSE.,FILPAT,LUNIMG,DISP,
      &                 ITYPE,NX,NY,NZ, 
-     & 		       MAXIM,PROMPT,FOUROK,IRTFLG) 
+     &                 MAXIM,PROMPT,FOUROK,IRTFLG) 
 
+#if defined(SP_DBUGIO)
+         !write(3,*)' Back In opfiles, Opened: ',irtflg,filpat(1:nlet)
+          write(3,*)' Back from opfiles, itype,irtflg: ',itype,irtflg
+#endif
+ 
 C         RETURN FILENAME WITH ANY EXTENSION IF NOT SPIDER IMAGE
           IF (IRTFLG == 5) NLET = lnblnkn(FILPAT)
-	  IF (IRTFLG .NE. 0) GOTO 9000 
+          IF (IRTFLG .NE. 0) GOTO 9000 
 
           NTOT       = 0
           IMGNUM     = 1
 
-          !write(3,*)' In opfiles, Opened simple: ',filpat(1:nlet)
-       ENDIF
+#if defined(SP_DBUGIO)
+          !write(3,*)' In opfiles, Opened simple : ',filpat(1:nlet)
+          !write(3,*)' In opfiles: itype,nimaxt: ',
+          !&                       itype,nimaxt 
+          !find native-enddedness of input     
+          !call lungetflip(luncp,iflipin,irtflg)
+          !write(3,*)' In opfiles: luncp,iflipin: ',luncp,iflipin
+#endif
+ 
+      ENDIF
+
+#if defined(SP_DBUGIO)
+          write(3,*)' Opfiles returning: maxim:  ', maxim 
+          write(3,*)' Opfiles returning: ntot:   ', ntot 
+          write(3,*)' Opfiles returning: imgnum: ', imgnum 
+          write(3,*)' Opfiles returning: irtflg: ', irtflg 
+          write(3,*)' Opfiles returning for SPIDER  -----------------'
+          write(3,*)'    ' 
+#endif
 
-9000   RETURN
+9000  RETURN
 
-       END 
+      END 
  
 
 
@@ -529,24 +624,23 @@ C    PARAMETERS:
 C        LUN        LUN NUMBER FOR FILNAM                         (SENT)
 C        LUNXM      LUN FOR XM SELFILE                            (SENT) 
 C        FILPAT     FILENAME PATTERN                              (SENT)
-C        NWANT      IMAGE NUMBER WANTED (<0 IS SELFILE)           (SENT) 
+C        NWANT      IMAGE NUMBER WANTED (<0 IS SELFILE)           (SENT)
 C        SAYIT      SAY FILE OPENING INFO.                        (SENT)
-C        FOUROK     FOURIER INPUT OK FLAG                         (SENT) 
-C        NGOT       IMAGE NUMBER FOUND                            (RET.) 
+C        FOUROK     FOURIER INPUT OK FLAG                         (SENT)
+C        NGOT       IMAGE NUMBER FOUND                            (RET.)
 C        IRTFLG     ERROR RETURN FLAG.                            (RET.)
 C                   IRTFLG = -1    END OF FILE BEFORE NWANT
 C                   IRTFLG =  0    NORMAL RETURN, IMAGE IS STACK
 C                   IRTFLG =  2    IMAGE NOT IN USE
 C
-C
-C  CALL TREE:
+C    CALL TREE:
 C
 C       GETOLDIMG 
 C          |
 C          |  Templated simple image:  IMG*** 
 C          ` ---> FILGET --> OPFILEC  
 C          |                         
-C          |  Templated stacked image: STK@*(**     
+C          |  Templated stacked image: STK@*     
 C          ` ---> LUN***
 C          | 
 C          |  Whole image stack: STK@  
@@ -558,7 +652,7 @@ C
 C23456789 123456789 123456789 123456789 123456789 123456789 123456789 12
 C--*********************************************************************
  
-	SUBROUTINE GETOLDIMG(LUN,LUNXM,FILPAT,NWANT, SAYIT,
+        SUBROUTINE GETOLDIMG(LUN,LUNXM,FILPAT,NWANT, SAYIT,
      &                       FOUROK,NGOT,IRTFLG)
 
         INCLUDE 'CMLIMIT.INC'
@@ -586,9 +680,8 @@ C--*********************************************************************
 C       IS THIS A MRC FILE SET
         CALL LUNGETIS_MRC(LUN,IS_MRC,IRTFLG)
 
-
-        !write(6,*)' locast,locat:',locast,locat,nlet,filpat(1:nlet)
-        !write(6,*)' getoldimg, nwant,: ',nwant,':',filpat(1:nlet)
+        !write(3,*)' locast,locat:',locast,locat,nlet,filpat(1:nlet)
+        !write(3,*)' getoldimg, nwant,: ',nwant,':',filpat(1:nlet)
         
         IF (NWANT < 0) THEN
 C          XMIPP SELFILE SIMPLE IMAGE ------------------------- SELAAA
@@ -600,21 +693,21 @@ C          RECOVER EXISTING IMAGE SIZE & TYPE
  
 C          LOAD FILNAM FROM SELFILE
            CALL GETNEXT_XMSEL(LUNXM,.TRUE.,FILNAM,NLET,IRTFLG)
-	   IF (IRTFLG .NE. 0) RETURN 
+           IF (IRTFLG .NE. 0) RETURN 
 
 C          OPEN EXISTING FILE: FILNAM  (HAS EXTENSION)
            MAXIM = 0  
-	   CALL OPFILEC(0,.FALSE.,FILNAM(:NLET),LUN,'O',ITYPE,
+           CALL OPFILEC(0,.FALSE.,FILNAM(:NLET),LUN,'O',ITYPE,
      &                 NX,NY,NZ, 
-     & 		       MAXIM,'~9',FOUROK,IRTFLG) 
-	   IF (IRTFLG .NE. 0) RETURN 
+     &                        MAXIM,'~9',FOUROK,IRTFLG) 
+           IF (IRTFLG .NE. 0) RETURN 
 
 C          NEW IMAGE SIZE SHOULD BE SAME AS PREVIOUS FILE
            CALL SIZCHK(NULL,NX1,NY1,NZ1,ITYPE1,
      &                      NX ,NY, NZ, ITYPE, IRTFLG)
-	   IF (IRTFLG .NE. 0) RETURN 
+           IF (IRTFLG .NE. 0) RETURN 
  
-           !write(6,*)' Opened old xmipp selfile file: ',filnam(1:nlet)
+           !write(3,*)' Opened old xmipp selfile file: ',filnam(1:nlet)
 
            NGOT   = NWANT   
            IRTFLG = 0
@@ -628,20 +721,20 @@ C          TEMPLATED SIMPLE IMAGE --------------------------- IMG***
            CLOSE(LUN)    ! USUALLY STILL OPEN
  
            CALL  FILGET(FILPAT,FILNAM,NLET,NWANT,IRTFLG)
-	   IF (IRTFLG .NE. 0) RETURN 
+           IF (IRTFLG .NE. 0) RETURN 
 
            MAXIM = 0  
-	   CALL OPFILEC(0,.FALSE.,FILNAM,LUN,'O',ITYPE,
+           CALL OPFILEC(0,.FALSE.,FILNAM,LUN,'O',ITYPE,
      &                 NX,NY,NZ, 
-     & 		       MAXIM,' ',FOUROK,IRTFLG) 
-	   IF (IRTFLG .NE. 0) RETURN 
+     &                        MAXIM,' ',FOUROK,IRTFLG) 
+           IF (IRTFLG .NE. 0) RETURN 
 
 C          IMAGE SIZE SHOULD BE SAME
            CALL SIZCHK(NULL,NX1,NY1,NZ1,ITYPE1,
      &                      NX ,NY, NZ, ITYPE, IRTFLG)
-	   IF (IRTFLG .NE. 0) RETURN 
+           IF (IRTFLG .NE. 0) RETURN 
 
-           !write(6,*)' Opened old templated file: ',filnam(1:nlet),maxim
+           !write(3,*)' Opened old templated file: ',filnam(1:nlet), maxim
 
            NGOT   = NWANT   
            IRTFLG = 0
@@ -652,19 +745,20 @@ C          IMAGE SIZE SHOULD BE SAME
 C          TEMPLATED STACKED MRC IMAGE ---------------------- **@STK.mrc
 C          BARE STACKED MRC IMAGE      ----------------------   @STK.mrc
            
-          !write(3,*) ' In getoldimg, nwant: ',nwant,locat,locast,filpat
+           !write(3,*)' In getoldimg, nwant: ',nwant,locat,locast,filpat
            CALL GETOLDIMG_MRC(LUN,FILPAT,NWANT,SAYIT,
      &                        FILNAM,NGOT,IRTFLG)
            RETURN
 
         ELSEIF (LOCAT  > 0 .AND. LOCAST > LOCAT) THEN
-C          TEMPLATED STACKED SPIDER IMAGE --------------------- STK@***
+C          TEMPLATED STACKED SPIDER IMAGE --------------------- STK@*
 
 C          MUST LOAD OVERALL HEADER FIRST FOR LUNREDHED (MAY BE MT NOW!)
            CALL LUNGETSIZE(LUN,NX,NY,NZ,IRTFLG)
            CALL LUNREDHED(LUN,NX,0,.FALSE.,IRTFLG)
            IF (IRTFLG .NE. 0) THEN
-              !write(6,*) ' lunredhed,lun,NX,irtflg:',lun,NX,irtflg
+              !write(3,*)' In opfiles lunredhed; lun,nx,irtflg:',
+c    &                                           lun,nx,irtflg
               CALL ERRT(102,'REDHED FAILED ON LUN',LUN) 
               IRTFLG = 2
               RETURN
@@ -675,6 +769,8 @@ C          LOAD SPECIFIED IMAGE HEADER
            IF (IRTFLG == 0) THEN
 C             NEED IMUSED FROM THIS STACKED IMAGE
               CALL LUNGETINUSE(LUN,IMUSED,IRTFLG)
+              !write(3,*)' In opfiles lungetinuse, lun,imused:',
+c     &                                            lun,imused
            ENDIF
            IF (IRTFLG .NE. 0 .OR. IMUSED == 0) THEN
               CALL ERRT(102,'IMAGE NOT IN STACK',NWANT) 
@@ -687,7 +783,8 @@ C             NEED IMUSED FROM THIS STACKED IMAGE
            CALL LUNSETIMNUM(LUN,FILNAM,NWANT,'O',IRTFLG)
            NLET = lnblnkn(FILNAM)
 
-           !write(6,*)' Opened old templated stacked file: ',FILNAM(:NLET)
+           !write(3,*)' Opened old templated stacked file: ',
+           !filnam(:nlet)
 
         ELSEIF (LOCAT == NLET) THEN
 C          WHOLE IMAGE STACK ------------------------------ STK@ or _1@
@@ -725,8 +822,8 @@ C             INCREMENT NGOT AND TRY AGAIN
 
            NLET = lnblnkn(FILNAM)
 
-           !write(6,*)' Opened old bare stacked file: ',FILNAM(1:NLET)
-           !write(6,*)' ngot,NX:',ngot,NX,lun,imused,irtflg
+           !write(3,*)' Opened old bare stacked file: ',filnam(1:nlet)
+           !write(3,*)' Ngot,nx:',ngot,nx,lun,imused,irtflg
         ENDIF
 
 C       SET OFFSETS FOR REDLIN/WRTLIN ON THIS LUN
@@ -739,7 +836,7 @@ C       SET COMMON BLOCK VARIABLES
         CALL LUNSETCOMMON(LUN,IRTFLG)
 
 
-	END
+        END
 
 
 C **********************************************************************
@@ -775,12 +872,12 @@ C          |
 C          |  Whole image stack: STK@  
 C          ` ---> LUNS***  
 C          | 
-C          |  Templated stacked MRC image: *@MRC or *@.MRCS
+C          |  Templated stacked MRC image: file*@MRC or *@file.MRCS
 C          ` ---> GETNEWIMG_MRC    --> OPFILEC  
 C
 C **********************************************************************
 
-	SUBROUTINE GETNEWIMG(LUNCP,LUN,LUNXM,FILPAT,NWANTT, 
+        SUBROUTINE GETNEWIMG(LUNCP,LUN,LUNXM,FILPAT,NWANTT, 
      &                       SAYIT,NGOT,IRTFLG)
 
         IMPLICIT NONE
@@ -824,16 +921,16 @@ C          GET PREVIOUS FILE SIZE AND TYPE (SHOULD BE SAME)
  
 C          LOAD FILE NAME FROM SELFILE
            CALL GETNEXT_XMSEL(LUNXM,.TRUE.,FILNAM,NLET,IRTFLG)
-	   IF (IRTFLG .NE. 0) RETURN 
+           IF (IRTFLG .NE. 0) RETURN 
 
 C          OPEN FILNAM
            MAXIM = 0  
-	   CALL OPFILEC(0,.FALSE.,FILNAM(1:NLET),LUN,'U',ITYPE1,
+           CALL OPFILEC(0,.FALSE.,FILNAM(1:NLET),LUN,'U',ITYPE1,
      &                 NX1,NY1,NZ1, 
-     & 		       MAXIM,'~9',FOUROK,IRTFLG) 
-	   IF (IRTFLG .NE. 0) RETURN 
+     &                        MAXIM,'~9',FOUROK,IRTFLG) 
+           IF (IRTFLG .NE. 0) RETURN 
 
-           !write(6,*)' Opened new Xmipp selfile file: ',filnam(1:nlet)
+           !write(3,*)' Opened new Xmipp selfile file: ',filnam(1:nlet)
 
            NGOT = NWANT   
            RETURN
@@ -849,16 +946,16 @@ C          GET IT FROM OPFILES OR PREVIOUS CALL
  
 C          CREATE FILE NAME
            CALL FILGET(FILPAT,FILNAM,NLET,NWANT,IRTFLG)
-	   IF (IRTFLG .NE. 0) RETURN 
+           IF (IRTFLG .NE. 0) RETURN 
 
            MAXIM = 0
            CLOSE(LUN)    ! MAY BE STILL OPEN FROM FIRST CALL  
-	   CALL OPFILEC(LUNCP,.FALSE.,FILNAM,LUN,'U',ITYPE,
+           CALL OPFILEC(LUNCP,.FALSE.,FILNAM,LUN,'U',ITYPE,
      &                 NX,NY,NZ, 
-     & 		       MAXIM,' ',FOUROK,IRTFLG) 
-	   IF (IRTFLG .NE. 0) RETURN 
+     &                 MAXIM,' ',FOUROK,IRTFLG) 
+           IF (IRTFLG .NE. 0) RETURN 
 
-           !write(6,*)' Opened new templated file: ',filnam(1:nlet)
+           !write(3,*)' Opened new templated file: ',filnam(1:nlet)
 
            NGOT   = NWANT   
            IRTFLG = 0
@@ -866,7 +963,7 @@ C          CREATE FILE NAME
 
         ELSEIF (IS_MRC .AND. LOCAT > 0 .AND. LOCAST < LOCAT) THEN
 
-C          TEMPLATED STACKED MRC IMAGE ---------------------- **@STK.mrc
+C          TEMPLATED STACKED MRC IMAGE ---------------------- *@STK.mrc
 C          BARE MRC IMAGE ------------------------------------ @STK.mrc
            
            CALL GETNEWIMG_MRC(LUN,FILPAT,NWANT,SAYIT,
@@ -875,7 +972,7 @@ C          BARE MRC IMAGE ------------------------------------ @STK.mrc
 
 
         ELSEIF (LOCAT > 0) THEN
-C          STACKED IMAGE ------------------------------- STK@*  or STK@
+C          STACKED IMAGE ------------------------------- STK@ or @STK@
 
            CALL LUNGETISBARE(LUN,ISBARE,IRTFLG)
 
@@ -896,9 +993,9 @@ C             UPDATE OVERALL HEADER WITH MAXIMUM IMAGE NUMBER
 C          NEED ISTACK 
            CALL LUNCOPYSTK(LUN,ISTACK,IRTFLGT)
 
-           !write(6,*)' In getnewimg - isbare,filpat: ',isbare, filpat
-           !write(6,*)' In getnewimg -nwant,maxim,istak: ',nwant,maxim,istack
-
+           !write(3,*)' In getnewimg - isbare,filpat: ',isbare, filpat
+           !write(3,*)' In getnewimg - nwant,maxim,istak: ',  
+c      &                                nwant,maxim,istack
 
           IF (ISTACK < 0) THEN
 C             MAKING A NEW INDEXED STACKED FILE, UPDATE INDX LOCATION
@@ -939,11 +1036,11 @@ C          WRITE OUT FILE OPENING INFO TO SCREEN
 
            NGOT = NWANT
 
-           !write(6,*)' Opened new stacked file: ',FILNAM(1:NLET)
+           !write(3,*)' Opened new stacked file: ',FILNAM(1:NLET)
 
         ENDIF
 
-	END
+        END
 
 
 C++*********************************************************************
@@ -952,12 +1049,12 @@ C  NEXTFILES.F  NEW                              12/15/06 ArDean Leith
 C               OVERUN OUTPUT LIST = -99          1/15/12 ArDean Leith
 C **********************************************************************
 C
-C NEXTFILES(NINDX1, NINDX2, INUMBR1,INUMBR2, 
-C           FOUROK,NLIST1,NLIST2,   
-C           NSTACK1,NSTACK2,   
-C           LUN1,LUNCP,LUN2, FILPAT1,FILPAT2,
-C           IMGNUM1,IMGNUM2,IRTFLG) 
-C
+C  NEXTFILES(NINDX1, NINDX2, INUMBR1,INUMBR2, 
+C            FOUROK,LUNXM1,LUNXM2,
+C            NLIST1,NLIST2,   NSTACK1,NSTACK2,   
+C            LUN1,LUNCP,LUN2, FILPAT1,FILPAT2,
+C            IMGNUM1,IMGNUM2, IRTFLG) 
+C 
 C PURPOSE:  GETS NEXT INPUT AND OUTPUT FILES FOR A STACK ORIENTED 
 C           OPERATION.  STACKS MUST BE OPENED WITH OPFILES!!!
 C
@@ -971,8 +1068,8 @@ C             LUN1             LUN FOR INPUT  (0 = NO FILE IN)   (SENT)
 C             LUNCP            LUN FOR OUTPUT HEADER COPY        (SENT)
 C             LUN2             LUN FOR OUTPUT (0 = NO FILE OUT)  (SENT)
 C             FILPAT,FILPAT2   FILE NAME PATTERNS                (SENT)
-C             IMGNUM1,IMGNUM2  IMAGE NUMBERS                (SENT/RET.)
-C             IRTFLG           ERROR (0 IS OK, -1 IS END STACK)  (RET.)
+C             IMGNUM1,IMGNUM2  IMAGE NUMBERS                 (SENT/RET)
+C             IRTFLG           ERROR (0 IS OK, -1 IS END STACK)   (RET)
 C
 C  CALL TREE:
 C     AFTER OPFILES HAVE BEEN CALLED:
@@ -1012,6 +1109,13 @@ C--*********************************************************************
       NINDX1 = NINDX2 + 1
       NINDX2 = NINDX2 + 1
 
+#if defined (SP_DBUGIO)
+      write(3,*)' In Nextfiles-0; lun1,lun2:       ', lun1,lun2
+      write(3,*)' In Nextfiles-0; nindx1,nindx2:   ', nindx1,nindx2
+      write(3,*)' In Nextfiles-0; nstack1,nstack2: ', nstack1,nstack2
+      write(3,*)' In Nextfiles-0; imgnum1,imgnum2: ', imgnum1,imgnum2
+#endif
+
       IF (LUN1 > 0) THEN  
 C        OPEN NEXT INPUT FILE 
          GOTAST1 = (INDEX(FILPAT1,'*') > 0)
@@ -1051,13 +1155,10 @@ C           OPEN NEXT INPUT FILE
 
          ENDIF
 
-         !write(3,*)' In nextfiles, nwant1: ',nwant1
-         !write(6,'(a,8i5)')' In nextfiles, nwant1: ',
-         !                                  nwant1,lun1,nwant1,imgnum1
          CALL GETOLDIMG(LUN1,LUNXM1,FILPAT1,NWANT1,SAYIT, 
      &                  FOUROK,IMGNUM1,IRTFLG)
 
-         !write(3,*)' gotoldimg, nstacki1,gotast1: ',nstack1,gotast1
+         write(3,*)' Gotoldimg, nwant1,imgnum1: ',nwant1,imgnum1
 
          IF (IRTFLG < 0)    RETURN    ! END OF WHOLE-STACK
          IF (IRTFLG .NE. 0) RETURN    ! ERROR
@@ -1068,7 +1169,6 @@ C           INPUT FROM A BARE STACK
             NINDX2 = IMGNUM1
          ENDIF
       ENDIF
-      ! write(6,*) 'In nextfiles1: l1,l2,irtflg:',lun1,lun2,irtflg
 
 
       IF (LUN2 > 0) THEN  
@@ -1079,10 +1179,17 @@ C        IS THIS IS A BARE STACK OPERATION?  (OK FOR SPIDER & MRC)
          CALL LUNGETISBARE(LUN2,IS_BARE2,IRTFLG)
 
 
-!        !write(6,'(a,8i5)')'  out: nindx2,ngot2,nstack2,imgnum2: ',
-!     &                             nindx2,ngot2,nstack2,imgnum2
-!         write(6,*) 'nextfiles2: l2,imgnum2,gotast2:',
-!     &                         lun2,imgnum2,gotast2
+#if defined (SP_DBUGIO)
+         write(3,*) '  '
+         write(3,*)' In nextfiles2-1; nindx2,inumbr2,nstack2,: ',
+     &                                nindx2,inumbr2,nstack2
+
+         write(3,*)' In nextfiles2-1: imgnum2,gotast2:',
+     &                                imgnum2,gotast2
+         write(3,*) ' '
+
+#endif
+
          IF (IMGNUM2 == -1 .AND. LUNXM2 > 0  ) THEN
 C           XMIPP SELFILE LISTED IMAGE
             NWANT2 = -1
@@ -1093,7 +1200,10 @@ C           MRC OR SPIDER BARE STACK INPUT   (NO LIST AVAILABLE)
 C           BARE STACK INPUT , USE SAME  OUTPUT IMAGE NUMBER
             NWANT2 = IMGNUM1
 
-            !write(3,*)'In nextfiles, :',isbare,nstack2,nwant2
+#if defined (SP_DBUGIO)
+            write(3,*)'  In nextfiles2-2; is_bare2,nstack2,nwant2:', 
+     &                                    is_bare2,nstack2,nwant2
+#endif
 
          ELSEIF (IS_BARE2 ) THEN
 C           MRC OR SPIDER BARE STACK OUTPUT   (NO LIST)
@@ -1105,8 +1215,10 @@ C              BARE STACK INPUT , USE SAME  OUTPUT IMAGE NUMBER
                 NWANT2 = IMGNUM1
             ENDIF
 
-            !write(3,*)'In nextfiles, :',isbare,nstack2,nwant2
-
+#if defined (SP_DBUGIO)
+            write(3,*)'  In nextfiles-3; is_bare2,nstack2,nwant2:', 
+     &                                   is_bare2,nstack2,nwant2
+#endif
 
          ELSEIF (NSTACK2 == -2  .OR.
      &           NSTACK2 == -1  .OR.
@@ -1115,32 +1227,62 @@ C              BARE STACK INPUT , USE SAME  OUTPUT IMAGE NUMBER
 C           NON-STACK IMAGE WITH/WITHOUT TEMPLATE LIST 
             IF (NINDX2 > NLIST2) THEN
 C               OVERUN OUTPUT LIST
-                !write(6,*) 'nindx2 > nlist2',nindx2,nlist2
                 IRTFLG = -99
+                write(3,*) 'In nextfiles-3b nindx2 > nlist2: ',
+     &                      nindx2,nlist2
+                write(3,*) 'In nextfiles-3b irtflg: ', irtflg
                 RETURN
             ENDIF
+
 C           OPEN NEXT OUTPUT FILE 
             NWANT2 = INUMBR2(NINDX2)
          ENDIF
 
-         !write(3,*)' In nextfiles, nwant2,nindx2:',nwant2,nindx2
-         !write(6,'(a,8i5)') 
-         !& ' Calling getnew,nwant2,imgnum2,nstack2:',
-         !                   nwant2,imgnum2,nstack2
+#if defined (SP_DBUGIO)
+         write(3,*)' In nextfiles2 -4; nstack2,nindx2,nwant2; ',
+     &                                 nstack2,nindx2,nwant2
+  
+         write(3,*)' In nextfiles2 -4; is_bare2,nlist2:', 
+     &                                 is_bare2,nlist2
+
+         write(3,*)' In nextfiles2 -4 Calling getnewimg; imgnum2: ',
+     &                                                   imgnum2
+#endif
 
          CALL GETNEWIMG(LUNCP,LUN2,LUNXM2,FILPAT2,NWANT2,
      &                  SAYIT,IMGNUM2,IRTFLG)
 
-         !write(3,'(a,8i5)') ' Getnew,nwant2,imgnum2,nstack2,irtflg:',
-      !&                              nwant2,imgnum2,nstack2,irtflg
+#if defined (SP_DBUGIO)
+         write(3,*)' After Gotnewimg, nwant2,imgnum2: ',
+     &                                nwant2,imgnum2
+#endif
+
+         IF (IRTFLG .NE. 0) then
+           write(3,*)' Leaving nextfiles   !!!!!!!! ; irtflg: ',irtflg
+           RETURN     ! ERROR
+         ENDIF
 
-         IF (IRTFLG .NE. 0) RETURN     ! ERROR
 
       ENDIF
-      !write(3,'(a,5i5)')' In nextfiles, nlist1,nstack1,imgnum1:',
-      !&                                 nlist1,nstack1,imgnum1
-      !write(3,'(a,5i5)')' In nextfiles, ngot2,nstack2,imgnum2:',
-      !&                                 ngot2,nstack2,imgnum2
+
+#if defined (SP_DBUGIO)
+      write(3,*)' Leaving nextfiles; nwant1,nwant2: ',nwant1,nwant2
+
+      write(3,*)' Leaving nextfiles, nlist1,nlist2:',
+     &                               nlist1,nlist2
+
+      write(3,*)' Leaving nextfiles; nstack1,nstack2: ',
+     &                               nstack1,nstack2
+
+      write(3,*)' Leaving nextfiles; imgnum1,imgnum2: ',
+     &                               imgnum1,imgnum2
+
+      write(3,*)' Leaving nextfiles; irtflg: ',irtflg
+      write(3,*)'     '
+
+
+#endif
+
 
       END
 
@@ -1185,7 +1327,7 @@ C          |        |
 C          |        |  Templated simple image:  IMG*** 
 C          |        ` ---> FILGET --> OPFILEC  
 C          |        |                         
-C          |        |  Templated stacked image: STK@*(**     
+C          |        |  Templated stacked image: STK@*     
 C          |        ` ---> LUN***
 C          |        | 
 C          |        |  Whole image stack:       STK@  
@@ -1201,7 +1343,7 @@ C                   |
 C                   |  Templated simple image:  IMG*** 
 C                   ` ---> FILGET --> OPFILEC  
 C                   |                         
-C                   |  Templated stacked image: STK@*(**     
+C                   |  Templated stacked image: STK@*     
 C                   ` ---> LUN***
 C                   | 
 C                   |  Whole image stack:       STK@  
@@ -1246,12 +1388,12 @@ C     IS THIS IS A BARE STACK OPERATION?
       CALL LUNGETISBARE(LUN1,IS_BARE1,IRTFLG)
       IF (IRTFLG .NE. 0) RETURN
 
-C      write(3,*)' In nextfile, gotast, filpat1:  ', gotast,filpat1
-C      write(6,*)' In nextfile, nindx1,isbare:    ',nindx1,is_bare1
-C      write(3,*)' In nextfile, ----------------------: '
-C      write(3,'(A,5i6)')
-C     &         '  In nextfile, num1,nindx1,nlist1,nwant1,nstack1: ',
-C     &                      imgnum1,nindx1,nlist1,nwant1,nstack1
+      !write(3,*)' In nextfile, gotast, filpat1:  ', gotast,filpat1
+      !write(3,*)' In nextfile, nindx1,isbare:    ',nindx1,is_bare1
+      !write(3,*)' In nextfile, ----------------------: '
+      !write(3,'(A,5i6)')
+      !&         '  In nextfile, num1,nindx1,nlist1,nwant1,nstack1: ',
+      !&                      imgnum1,nindx1,nlist1,nwant1,nstack1
 
       IF (IMGNUM1 == -1  .AND. LUNXM1 > 0 ) THEN
 C        XMIPP SELFILE LISTED IMAGE
@@ -1263,8 +1405,8 @@ C        MRC OR SPIDER BARE STACK INPUT   (NO LIST)
          IF (IMGNUM1 < 0) IMGNUM1 = 1
          NWANT1 = IMGNUM1 + 1
 
-C        write(3,'(A,5i6)')'  In nextfile, nwant1,nstack1: ',
-C       &                                  nwant1,nstack1
+         !write(3,'(A,5i6)')'  In nextfile, nwant1,nstack1: ',
+         !&                                 nwant1,nstack1
 
         IF (NWANT1 > NSTACK1) THEN
 C           FINISHED THE WHOLE STACK
@@ -1325,8 +1467,94 @@ C        BARE STACK, OUTPUT IMAGE HAS SAME # AS INPUT ALWAYS
          NINDX1 = IMGNUM1
       ENDIF
 
-      !   write(3,'(a,5i5)')' In nextfile, nlist1,nstack1,imgnum1:',
+      !write(3,'(a,5i5)')' In nextfile, nlist1,nstack1,imgnum1:',
       !&                                   nlist1,nstack1,imgnum1
       END
 
 
+#ifdef NEVER
+      PURE LOGICAL FUNCTION LITTLE_ENDIAN()
+      
+      INTEGER(INT8)  :: J(2)
+      INTEGER(INT16) :: I
+      
+      I = 1
+      J = TRANSFER(SOURCE=I,MOLD=J,SIZE=2)
+      
+      IF (J(1) == 1) THEN
+         LITTLE_ENDIAN = .TRUE.
+      ELSE
+         LITTLE_ENDIAN = .FALSE.
+      ENDIF
+      
+      END FUNCTION
+      
+      
+      SUBROUTINE ENDIAN(LITEND)
+
+C     CHECKS IF THIS IS A LITTLE ENDIAN MACHINE
+C     RETURNS LITEND =.TRUE. IF IT IS, LITEND =.FALSE. IF NOT
+
+      INTEGER*1 J(2)
+      INTEGER*2 I
+      EQUIVALENCE (I,J)
+      
+      LOGICAL LITEND
+
+      I = 1
+      IF (J(1) .EQ. 1) THEN
+         LITEND = .TRUE.
+      ELSE
+         LITEND = .FALSE.
+      ENDIF
+
+      END
+      
+      PROGRAM TESTI
+      ! Posted by Perseus in comp.lang.fortran on 4 July 2005.
+      ! and Paul Van Delst and David Flower on 5 July 2005.
+
+      LOGICAL, PARAMETER :: BIGEND = IACHAR(TRANSFER(1,"A")) == 0
+
+      IF (BIGEND) THEN
+        PRINT *, "BIG ENDIAN"
+      ELSE
+        PRINT *, "LITTLE ENDIAN"
+      ENDIF
+
+END PROGRAM TESTI
+
+PROGRAM DETERMINE_ENDIANNESS
+    IMPLICIT NONE
+    INTEGER :: UNIT, IOSTAT
+    INTEGER(4) :: VALUE
+    CHARACTER(LEN=4) :: BYTES
+
+    ! OPEN THE FILE IN UNFORMATTED MODE
+    OPEN(UNIT=10, FILE="FILE.DAT", FORM="UNFORMATTED", ACCESS="STREAM", STATUS="OLD", IOSTAT=IOSTAT)
+    IF (IOSTAT /= 0) THEN
+        PRINT *, "ERROR OPENING FILE."
+        STOP
+    END IF
+
+    ! READ THE FIRST 4 BYTES (ASSUMING THE FILE STARTS WITH A KNOWN INTEGER)
+    READ(10) VALUE
+    CLOSE(10)
+
+    ! CONVERT THE INTEGER TO BYTES FOR ANALYSIS
+    CALL MOVE_ALLOC(TRANSFER(VALUE, BYTES), BYTES)
+
+    ! CHECK THE BYTE ORDER
+    IF (BYTES == 'EXPECTED_BIG_ENDIAN_BYTES') THEN
+        PRINT *, "FILE IS BIG ENDIAN."
+    ELSE IF (BYTES == 'EXPECTED_LITTLE_ENDIAN_BYTES') THEN
+        PRINT *, "FILE IS LITTLE ENDIAN."
+    ELSE
+        PRINT *, "UNABLE TO DETERMINE ENDIANNESS."
+    END IF
+END PROGRAM DETERMINE_ENDIANNESS
+
+
+
+#endif
+
diff --git src/opfiles_mrc.f src/opfiles_mrc.f
index 4366ac4d..229c9c5f 100644
--- src/opfiles_mrc.f
+++ src/opfiles_mrc.f
@@ -3,14 +3,15 @@ C++*********************************************************************
 C                                                                      
 C  OPFILES_MRC.F    CREATED FROM OPFILES         7/30/19  ArDean Leith
 C                   COMMENTS                     2/06/20  ArDean Leith
+C                   DEBUG OUTPUT ADDED           9/26/25  ArDean Leith
 C
-C ********************************************************************** 
+C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2020  Health Research Inc.,                         *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@health.ny.gov                                        *
+C=*                                                                    *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -24,13 +25,13 @@ C=* General Public License for more details.                           *
 C=* You should have received a copy of the GNU General Public License  *
 C=* along with this program. If not, see <http://www.gnu.org/licenses> *
 C=*                                                                    *
-C ********************************************************************** 
+C **********************************************************************
 C 
 C  CONTAINS: OPFILES_MRC, GETOLDIMG_MRC, GETNEWIMG_MRC 
 C
 C  OPFILES_MRC(LUNCP,LUNIMG,LUNDOC,LUNXM,  
 C              ASKNAM,FILPAT,NLET, DISP,
-C              ITYPE,NX,NY,NZ,MAXIM,FOUROK,
+C              ITYPE,NX,NY,NZ,MAXIM,
 C              IMGNUM, IRTFLG)
 C 
 C  PURPOSE: SOLICITS FILE NAME(S) AND OPENS FILE(S)
@@ -38,14 +39,14 @@ C           SUPPORT ROUTINE FOR CONVERTING OPERATIONS TO
 C           WORK ON WHOLE STACK OR WITH SELECTION DOC FILE.
 C
 C  PARAMETERS:
-C        LUNCP      UNIT TO COPY HEADER VALUES FROM               (SENT)
-C        LUNIMG     UNIT TO OPEN FILE ON                          (SENT)
-C        LUNDOC     UNIT TO OPEN LIST DOC FILES ON                (SENT)
-C        LUNXM      UNIT TO OPEN XMIPP SELFILE ON                 (SENT)
-C        ASKNAM     FLAG TO ASK FOR FILE NAME                     (SENT)
+C        LUNCP      UNIT TO COPY HEADER VALUES FROM              (SENT)
+C        LUNIMG     UNIT TO OPEN FILE ON                         (SENT)
+C        LUNDOC     UNIT TO OPEN LIST DOC FILES ON               (SENT)
+C        LUNXM      UNIT TO OPEN XMIPP SELFILE ON                (SENT)
+C        ASKNAM     FLAG TO ASK FOR FILE NAME                    (SENT)
 C        FILPAT     FILE NAME PATTERN                             (RET)
 C        NLET       CHARS IN FILE NAME PATTERN                    (RET)
-C        DISP       CHARACTER CONTAINING ONE OF THE               (SENT) 
+C        DISP       CHARACTER CONTAINING ONE OF THE              (SENT) C
 C                   FOLLOWING DISPOSITION SPECIFICATIONS:
 C                   'O'   -  FILE IS ASSUMED TO EXIST.  DIMENSIONS,
 C                            ITYPE AND HEADER INFO (IN COMMON) ARE 
@@ -59,28 +60,24 @@ C                   'N'  -   WANT NEW FILE. SEND NX, NY, NZ & ITYPE.
 C                   'U'  -   IT IS NOT KNOWN IF THE FILE EXISTS.  
 C                            SEND NX, NY, NZ & ITYPE. IF FILE 
 C                            ALREADY EXISTS, IT WILL BE REPLACED.
-C        ITYPE      IFORM FOR FILE                         (SENT OR RET) 
-C        NX,NY,NZ   IMAGE SIZE                             (SENT OR RET)
+C        ITYPE      IFORM FOR FILE                        (SENT OR RET) C
+C        NX,NY,NZ   IMAGE SIZE                            (SENT OR RET)
 C
 C        MAXIM      STACK INDICATOR                          (SENT/RET)
 C                   ON INPUT: STACK INDICATOR IF DISP == 'I'     (SENT)
 C                   ON OUTPUT:                                    (RET)
 C                       -2 NON-STACK IMAGE                
-C                       -1 STACKED IMAGE                  
-C                     >= 0 IS CURRENT MAX. IMAGE NO. FOR STACK             
-C        PROMPT     PROMPT FOR FILNAME                            (SENT)
-C                     IF NOT (ASKNAM) THIS IS FILE NAME           (SENT)
-C                     ~ (TILDE) IN LAST CHAR. SAYS SKIP
-C                       "FILE" AT END OF PROMPT
-C                     ~9 IN NEXT TO LAST OR
-C                        NEXT-TO-NEXT-TO LAST
-C                        ACCEPTS AN EXTENSION
-C                        (OTHERWISE DISCARDED!)
-C                     ~6 KEEPS OLD DATE/TIME
-C        IMGNUM     IMAGE NUMBER                              (SENT/RET)
-C                     ON INPUT:   IMAGE NUMBER THAT IS WANTED
-C                     ON OUTPUT:  >=0 IMAGE NUMBER CURRENTLY OPEN 
-C                                 <0 IS SELFILE IN USE 
+C                       -1 STACKED IMAGE WITH * 
+c                        0 BARE STACK                  
+C                     >= 0 IS CURRENT MAX. IMAGE NO. FOR STACK           C                     IF NOT STACK IS NUMBER IN LIST
+C 
+C        ILIST      IMAGE NUMBER LIST                             (RET)
+CC
+C        IMGNUM     IMAGE NUMBER                             (SENT/RET)
+C                   ON INPUT:   IMAGE NUMBER THAT IS WANTED
+C                   ON OUTPUT:  >=0 IMAGE NUMBER CURRENTLY OPEN 
+C                                <0 IS SELFILE IN USE 
+C
 C        IRTFLG     ERROR FLAG (0 IS NORMAL)                      (RET)
 C                      -1 GO TO PREVIOUS QUESTION
 C 
@@ -95,30 +92,31 @@ C           v     If: MRC file: *.MRC or *.MRCS
 C           v 
 C        OPFILES_MRC
 C           |
-C           |   Templated stack: **@STK.MRC
+C           |   Templated stack: *@stk.MRC
 C           ` ---> FILGET_AT --> OPFILEC --> OPENFIL_MRC --> OPENFIL_O_MRC 
 C           |                            --> OPENFIL_MRC --> OPENFIL_N_MRC
 C           |
-C           |   Whole barestack:  @STK.MRC 
+C           |   Whole barestack:  @stk.MRC 
 C           ` ---> FILGET_AT --> OPFILEC --> OPENFIL_MRC --> OPENFIL_O_MRC
 C           |                            --> OPENFIL_MRC --> OPENFIL_N_MRC
 C           | 
-C           |   File template:   IMG***.MRC
+C           |   File template:   img***.MRC
 C           ` ---> FILGET_AT --> OPFILEC --> OPENFIL_MRC --> OPENFIL_O_MRC
 C           |                            --> OPENFIL_MRC --> OPENFIL_N_MRC
 C           | 
-C           |   Simple file:     IMG001.MRC
+C           |   Simple file:     img001.MRC
 C           ` -----------------> OPFILEC --> OPENFIL_MRC --> OPENFIL_O_MRC  
 C                                        --> OPENFIL_MRC --> OPENFIL_N_MRC
 C
-C23456789 123456789 123456789 123456789 123456789 123456789 123456789 12 
+C23456789 123456789 123456789 123456789 123456789 123456789 123456789 12
 C--********************************************************************* 
-
        SUBROUTINE OPFILES_MRC(LUNCP,LUNIMG,LUNDOC,
      &                        FILPAT,NLET, DISP,
      &                        ITYPE,NX,NY,NZ,MAXIM,
      &                        IMGNUM, IRTFLG) 
  
+C      OPFILES NEEDS: MAXIM, IMGNUM
+
        IMPLICIT NONE
 
        INCLUDE 'CMBLOCK.INC' 
@@ -137,8 +135,8 @@ C--*********************************************************************
        CHARACTER (LEN=2*MAXNAM)  :: MESG 
        CHARACTER (LEN=1)         :: NULL = CHAR(0)
 
-       INTEGER                   :: LOCAT,LOCAST,LENE
-       INTEGER                   :: LUNOP,NLETT,I
+       INTEGER                   :: LOCAT,LOCAST,LENE,MZT,NSTACKT
+       INTEGER                   :: LUNOP,NLETT,I,ilent
 
        LOGICAL                   :: ISOPEN,IS_BAREL
        CHARACTER (LEN=MAXNAM)    :: FILNAMT 
@@ -151,13 +149,21 @@ C--*********************************************************************
        LOCAST   = INDEX(FILPAT(1:NLET),'*')
        IS_BAREL = (LOCAT > 1 .AND. FILPAT(LOCAT-1:LOCAT-1) == '/')
        
-       !write(3,*)' In opfiles_mrc,locast,locat,:',locast,locat,is_barel
-       !write(3,*)' In opfiles_mrc, imgnum:',imgnum,filpat
+#if defined (SP_DBUGIO)
+       ilent = lnblnkn(filpat)
+       write(3,*)' '
+       write(3,*)' In opfiles_mrc, nlet:        ', nlet
+       write(3,*)' In opfiles_mrc, filpat:      ', filpat(1:ilent)
+       write(3,*)' In opfiles_mrc; imgnum:      ', imgnum
+       write(3,*)' In opfiles_mrc; locat,locast:', locat,locast
+       write(3,*)' In opfiles_mrc; is_barel:    ', is_barel
+       if (disp == 'n' .or. disp == 'u') then
+          write(3,*)' In opfiles_mrc; nx,ny,nz:    ', nx,ny,nz
+       endif
+#endif
 
        IF (LOCAST > 0 .AND. LOCAST < LOCAT) THEN
-C         TEMPLATED STACKED MRC FILE: ***@STK.MRC --------- **@STK.MRC
-
-          !write(3,*)' In opfiles_mrc, opening: ',filpat(1:nlet)
+C         TEMPLATED STACKED MRC FILE: *@file.MRC ---------  *@file.MRC
         
 C         SUBSTITUTE STACKED IMGNUM INTO FILE NAME PATTERN -> FILNAM 
           CALL FILGET_AT(FILPAT,IMGNUM,FILNAM,NLET,IRTFLG)
@@ -167,41 +173,74 @@ C         OPEN IMGNUM IN EXISTING MRC STACK FILE
           SAYIT  = .TRUE.
           MAXIM  = 0          ! OPEN SPECIFIC IMAGE  
 
-          !write(3,*)' In opfiles_mrc, opening: ',filnam(1:nlet)
+#if defined (SP_DBUGIO)
+          ilent = lnblnkn(filnam)
+          write(3,*)' In opfiles_mrc; Calling opfilec: ',filnam(1:ilent)
+          write(3,*)' In opfiles_mrc;  TEMPLATED STACKED MRC '
+#endif
 
-	  CALL OPFILEC(0,.FALSE.,FILNAM,LUNIMG,DISP,
-     &                 ITYPE,NX,NY,NZ, 
-     & 		       MAXIM,' ',FOUROK,IRTFLG) 
+          CALL OPFILEC(0,.FALSE.,FILNAM,LUNIMG,DISP,
+     &                 ITYPE,NX,NY,NZ, MAXIM,
+     &                 ' ',FOUROK,IRTFLG) 
           IF (IRTFLG .NE. 0) RETURN
-
+        
 C         THIS IS NOT A BARE STACK REQUEST
           CALL LUNSETISBARE_MRC(LUNIMG,.FALSE.,IRTFLG)
 
-          !write(3,*)' In opfiles_mrc, maxim: ',maxim,imgnum
+#if defined (SP_DBUGIO)
+          write(3,*)' In opfiles_mrc; maxim:  ', maxim
+          write(3,*)' In opfiles_mrc;  7777777; imgnum: ', imgnum
+#endif
           RETURN
 
+
+
        ELSEIF (LOCAST > 0) THEN
-C         A SIMPLE FILE TEMPLATE: IMG***.mrc ------------- IMG***.mrc
+C         A SIMPLE TEMPLATED FILE: IMG***.mrc ------------- img***.mrc
 
 C         SUBSTITUTE IMGNUM INTO FILE NAME PATTERN -> FILNAM   
-          CALL  FILGET(FILPAT,FILNAM,NLET,IMGNUM,IRTFLG)
-	  IF (IRTFLG .NE. 0) RETURN 
+          CALL FILGET(FILPAT,FILNAM,NLET,IMGNUM,IRTFLG)
+
+#if defined (SP_DBUGIO)
+          write(3,*)' In opfiles_mrc; maxim:  ', maxim
+          write(3,*)' In opfiles_mrc; imgnum: ', imgnum
+          write(3,*)' In opfiles_mrc; 8888888  irtflg: ', irtflg
+          write(3,*)'   '
+#endif
+          IF (IRTFLG .NE. 0) RETURN 
 
 C         OPEN THE FILE
-          MAXIM = 0 
-	  CALL OPFILEC(LUNCP,.FALSE.,FILNAM,LUNIMG,DISP,
+          MAXIM = -1 
+          CALL OPFILEC(LUNCP,.FALSE.,FILNAM,LUNIMG,DISP,
      &                 ITYPE,NX,NY,NZ, 
-     & 		       MAXIM,' ',FOUROK,IRTFLG) 
-	  IF (IRTFLG .NE. 0) RETURN 
+     &                 MAXIM,' ',FOUROK,IRTFLG) 
+
+#if defined (SP_DBUGIO)
+          write(3,*)' In opfiles_mrc; 9999999  irtflg,maxim: ', 
+     &                                         irtflg,maxim
+#endif
+          IF (IRTFLG .NE. 0) RETURN 
+          
+          CALL LUNSETNSTACK_MRC(LUNIMG, NZ, MAXIM,IRTFLG)
 
 C         THIS IS NOT A BARE STACK REQUEST
           CALL LUNSETISBARE_MRC(LUNIMG,.FALSE.,IRTFLG)
 
-c          write(3,*)' Opened templated file: ',filnam(1:20),
-c     &              '  for:',imgnum
+C         THIS IS NOT A STACK
+          CALL LUNSETSTK_MRC(LUNIMG,0,-2,IRTFLG)
+
+#if defined (SP_DBUGIO)
+          write(3,*)' In opfiles_mrc; 1010101 ;irtflg,maxim:  ',
+     &                                         irtflg,maxim
+          ilent = lnblnkn(filnam)
+          write(3,*)' In opfiles_mrc; Opened templated file; imgnum: ',
+     &                                    imgnum,'  ', filnam(1:ilent)
+          write(3,*) '  '
+#endif
+
 
        ELSEIF (LOCAT == 1 .OR. IS_BAREL) THEN
-C         WHOLE BARESTACK:  @STK.mrc  ---------------------- @STK.mrc
+C         WHOLE BARESTACK:  @file.mrc  ---------------------- @file.mrc
 
 C         SUBSTITUTE STACKED IMGNUM INTO FILE NAME PATTERN -> FILNAM   
           
@@ -214,7 +253,11 @@ C         SUBSTITUTE STACKED IMGNUM INTO FILE NAME PATTERN -> FILNAM
 C         OPEN FIRST FILE IN MRC STACK
           IMGNUM = 1
           MAXIM  = 1
-         !write(3,*)' In opfiles_mrc, filnamnoat: ',filnamnoat(1:nlet)
+
+#if defined (NEVERSP_DBUGIO)
+          ilent = lnblnkn(filnamnoat)
+          write(3,*)' In opfiles_mrc; filnamnoat: ',filnamnoat(1:ilent)
+#endif
 
           INQUIRE(FILE=FILNAMNOAT,OPENED=ISOPEN,NUMBER=LUNOP)
           MESG = '  FILE: ' // FILNAMNOAT(1:NLET)//'  ALREADY OPENED ON' 
@@ -227,40 +270,100 @@ C         OPEN FIRST FILE IN MRC STACK
 
 C         SUBSTITUTE STACKED IMGNUM INTO FILE NAME PATTERN -> FILNAM   
           CALL FILGET_AT(FILPAT,IMGNUM,FILNAM,NLET,IRTFLG)
-          !write(3,*)' In opfiles_mrc, filpat: ',filpat(1:nlet)
-          !write(3,*)' In opfiles_mrc, filnam: ',filnam(1:nlet)
+
+
+#if defined (NEVERSP_DBUGIO)
+          ilent = lnblnkn(filpat)
+          write(3,*)' In opfiles_mrc; filpat: ',filpat(1:ilent)
+          ilent = lnblnkn(filnam)
+          write(3,*)' In opfiles_mrc; filnam: ',filnam(1:ilent)
+#endif
         
 C         OPEN FIRST FILE
           CALL OPFILEC(LUNCP,.FALSE.,FILNAM,LUNIMG,DISP,
      &                 ITYPE,NX,NY,NZ, 
-     & 		       MAXIM,'UNUSED',FOUROK,IRTFLG) 
-	  IF (IRTFLG .NE. 0) RETURN
+     &                       MAXIM,'UNUSED',FOUROK,IRTFLG) 
+          IF (IRTFLG .NE. 0) RETURN
 
 C         THIS WAS A BARE STACK REQUEST
           CALL LUNSETISBARE_MRC(LUNIMG,.TRUE.,IRTFLG)
 
-          !write(3,*)' In opfiles_mrc, opened: ',filnam(1:nlet)
-          !write(3,*)' In opfiles_mrc, imgnum: ',imgnum
+#if defined (SP_DBUGIO)
+          ilent = lnblnkn(filnam)
+          write(3,*)' In opfiles_mrc; Opened: ',filnam(1:ilent)
+          write(3,*)' In opfiles_mrc; imgnum: ',imgnum 
+#endif
+
 
        ELSE
-C         SINGLE SIMPLE INPUT FILE: ------------------------ IMG001.mrc
-C         STACKED IMAGE FILE:  ------------------------------ 2@STK.mrc
-                
-          MAXIM = 0        ! SPECIFIC IMAGE WANTED  
-	  CALL OPFILEC(LUNCP,.FALSE.,FILPAT,LUNIMG,DISP,
-     &                 ITYPE,NX,NY,NZ, 
-     & 		       MAXIM,'UNUSED',FOUROK,IRTFLG) 
+C         SINGLE SIMPLE INPUT FILE: ------------------------ img001.mrc
+C         STACKED IMAGE FILE:  ----------------------------- 2@file.mrc
+C         STACKED IMAGE FILE:  ----------------------------- file@2.mrc
+C         STACKED IMAGE FILE:  ------------------------------ aaa@2.mrc
+                  
+          MAXIM = 0        ! SPECIFIC IMAGE WANTED 
+  
+#if defined (SP_DBUGIO)
+          write(3,*)' In opfiles_mrc; Open stacked or simple image: ',
+     &                                filpat(1:nlet)
+          write(3,*)' In opfiles_mrc; imgnum,maxim: ',imgnum,maxim
+          write(3,*)' In opfiles_mrc; nx,ny,nz:     ', nx,ny,nz
+          write(3,*)' In opfiles_mrc; Calling opfilec for: simp/stk '
+          write(3,*)'  '
+#endif
+
+          CALL OPFILEC(LUNCP,.FALSE.,FILPAT,LUNIMG,DISP,
+     &                ITYPE,NX,NY,NZ, 
+     &                MAXIM,'UNUSED~7~9',FOUROK,IRTFLG) 
+
+#if defined (SP_DBUGIO)
+          ilent = lnblnkn(filpat)
+          write(3,*)'  '
+          write(3,*)' After opfilec ------------- in opfiles_mrc ---'
+          write(3,*)' In opfiles_mrc; nlet,maxim,irtflg: ',
+     &                                nlet,maxim,irtflg
+          write(3,*)' In opfiles_mrc; nx,ny,nz: ', nx,ny,nz
+#endif
 
 C         RETURN FILENAME WITH ANY EXTENSION IF NOT SPIDER IMAGE
           IF (IRTFLG == 5) NLET = lnblnkn(FILPAT)
-	  IF (IRTFLG .NE. 0) RETURN 
 
-          ! write(3,*)' In opfiles_mrc, imami : ',imami
-          ! write(3,*)' In opfiles_mrc, openrf simple file: ',filpat
+          IF (IRTFLG .NE. 0) THEN
+
+#if defined (SP_DBUG)
+            write(3,*)' In opfiles_mrc; non-zero, imgnum,irtflg : ',
+     &                                            imgnum,irtflg
+            ilent = lnblnkn(filpat)
+            write(3,*)' In opfiles_mrc; Opened simple file: ',  
+     &                                          filpat(1:ilent)
+            write(3,*)' In opfiles_mrc; *** Returning irtflg: ',irtflg
+#endif
+            RETURN
+          ENDIF
+
+#if defined (SP_DBUGIO)
+          write(3,*)' In opfiles_mrc   www; imgnum,locat: ',imgnum,locat
+#endif
+
+          IF (LOCAT <= 0 ) THEN
+C            THIS IS NOT A STACK
+             CALL LUNSETSTK_MRC(LUNIMG,IMGNUM,-2,IRTFLG)
+          ENDIF
+    
+#if defined (SP_DBUGIO)
+          write(3,*)' In opfiles_mrc  vvv ; imgnum,irtflg: ',
+     &                                      imgnum,irtflg
+          ilent = lnblnkn(filpat)
+          write(3,*)' In opfiles_mrc; Opened simple: ',filpat(:ilent)
+#endif
+
+       ENDIF    ! 
 
-          IMGNUM = 1
 
-       ENDIF
+#if defined (SP_DBUGIO)
+       write(3,*)' In opfiles_mrc; ### Returning maxim: ',maxim
+       write(3,*)
+#endif
 
        END 
  
@@ -286,7 +389,7 @@ C                   IRTFLG =  2    IMAGE NOT IN USE
 C
 C **********************************************************************
 
-	SUBROUTINE GETNEWIMG_MRC(LUN,FILPAT,NWANT,SAYIT,
+        SUBROUTINE GETNEWIMG_MRC(LUN,FILPAT,NWANT,SAYIT,
      &                           FILNAM,NGOT,IRTFLG)
 
         IMPLICIT NONE
@@ -317,14 +420,14 @@ C **********************************************************************
         LOCAST = INDEX(FILPAT(1:NLET),'*')
         LOCAT  = INDEX(FILPAT(1:NLET),'@')
 
-        !write(3,*)' !!!locast,locat,filpat:',locast,locat,filpat(1:nlet)
+        !write(6,*)'locast,locat,filpat:',locast,locat,filpat(1:nlet)
 
         IMGNUM = NWANT
 
         IF (LOCAST > 1 .or. (LOCAT  > 0 .AND. LOCAST < LOCAT)) THEN
 C          SUBSTITUTE IMGNUM INTO FILE NAME PATTERN -> FILNAM   
            CALL FILGET_AT(FILPAT,IMGNUM,FILNAM,NLET,IRTFLG)
-	   IF (IRTFLG .NE. 0) RETURN 
+          IF (IRTFLG .NE. 0) RETURN 
         ENDIF
 
         IF (LOCAT <= 0 .AND. LOCAST > 1) THEN
@@ -334,20 +437,20 @@ C          NEW IMAGE, NEEDS TO KNOW: ITYPE,NX,NY,NZ!
 C          GET IT FROM OPFILES OR PREVIOUS CALL
 
            CALL LUNGETSIZE_MRC(LUN,NX,NY,NZ,IRTFLG)
-	   IF (IRTFLG .NE. 0) RETURN 
+           IF (IRTFLG .NE. 0) RETURN 
            CALL LUNGETTYPE_MRC(LUN,ITYPE,IRTFLG)
-	   IF (IRTFLG .NE. 0) RETURN 
+           IF (IRTFLG .NE. 0) RETURN 
 
            CLOSE(LUN)    ! MAY BE STILL OPEN FROM FIRST CALL  
 
 C          OPEN NEW FILE
            MAXIM = 0
-	   CALL OPFILEC(LUNCP,.FALSE.,FILNAM,LUN,'U',ITYPE,
+           CALL OPFILEC(LUNCP,.FALSE.,FILNAM,LUN,'U',ITYPE,
      &                  NX,NY,NZ, 
-     & 		        MAXIM,'UNUSED',FOUROK,IRTFLG) 
-	   IF (IRTFLG .NE. 0) RETURN 
+     &                        MAXIM,'UNUSED',FOUROK,IRTFLG) 
+           IF (IRTFLG .NE. 0) RETURN 
 
-           !write(3,*)' In getnewimg_mrc opened new templated file: ',
+           !write(6,*)' In getnewimg_mrc opened new templated file: ',
            !&                 filnam(1:nlet)
 
            NGOT   = NWANT   
@@ -386,7 +489,7 @@ C             SET CURRENT IMGNUM AND NSTACK IN STATIC HEADER
 C          SET OFFSETS FOR REDLIN/WRTLIN FOR IMAGE OPENED ON THIS LUN
            CALL LUNSETPOS_MRC(LUN,IMGNUM,IRTFLG)
            IF (IRTFLG .NE. 0) RETURN
-           !write(3,'(a,8i5)') ' In getnu_mrc22, lun,imgnum:',lun,imgnum
+           !write(6,'(a,8i5)') ' In getnu_mrc22, lun,imgnum:',lun,imgnum
 
 
 C          PUSH HEADER OBJECT INTO FILE TO SAVE STATS, NSTACK, & IMGNUM
@@ -406,12 +509,12 @@ C          WRITE OUT FILE OPENING INFO TO SCREEN
 
            NGOT = IMGNUM
 
-           !write(3,*)' In getnewimg_mrc opened new stacked file: ',
+           !write(6,*)' In getnewimg_mrc opened new stacked file: ',
        !&                 filnam(1:nlet)
 
         ENDIF
 
-	END
+        END
 
 
 C++*********************************************************************
@@ -439,7 +542,7 @@ C
 C23456789 123456789 123456789 123456789 123456789 123456789 123456789 12
 C--*********************************************************************
  
-	SUBROUTINE GETOLDIMG_MRC(LUN,FILPAT,NWANT,SAYIT,
+        SUBROUTINE GETOLDIMG_MRC(LUN,FILPAT,NWANT,SAYIT,
      &                           FILNAM,NGOT,IRTFLG)
 
         IMPLICIT NONE
@@ -469,14 +572,14 @@ C--*********************************************************************
         LOCAST = INDEX(FILPAT(1:NLET),'*')
         LOCAT  = INDEX(FILPAT(1:NLET),'@')
 
-        ! write(3,*)' In getoldimg_mrc locast,locat,nlet,filpat:',
+        ! write(6,*)' In getoldimg_mrc locast,locat,nlet,filpat:',
         !&            locast,locat,nlet,filpat(1:nlet)
-        !write(3,*)' In getoldimg_mrc, nwant,: ',nwant,':',filpat(1:nlet)
+        !write(6,*)' In getoldimg_mrc, nwant,: ',nwant,':',filpat(1:nlet)
 
         IF (LOCAST > 0 .OR. (LOCAST == 0 .AND. LOCAT > 0)) THEN 
 C          SUBSTITUTE STACKED IMGNUM INTO FILE NAME PATTERN -> FILNAM   
            CALL FILGET_AT(FILPAT,NWANT,FILNAM,NLET,IRTFLG)
-	   IF (IRTFLG .NE. 0) RETURN 
+          IF (IRTFLG .NE. 0) RETURN 
         ENDIF
 
         IF (LOCAST > 0 .AND. LOCAT == 0) THEN 
@@ -489,10 +592,10 @@ C          LUNSETFILE, LUNSETPOS_MRC LUNSET_STATSIMG_MRC,
 C          LUNSETISBARE_MRC, LUNSETCOMMON_MRC, LUNSAYINFO_MRC
 
            MAXIM = 0  
-	   CALL OPFILEC(0,.FALSE.,FILNAM,LUN,NULL,ITYPE,
+          CALL OPFILEC(0,.FALSE.,FILNAM,LUN,NULL,ITYPE,
      &                  NX,NY,NZ, 
-     & 		        MAXIM,' ',FOUROK,IRTFLG) 
-	   IF (IRTFLG .NE. 0) RETURN 
+     &                        MAXIM,' ',FOUROK,IRTFLG) 
+          IF (IRTFLG .NE. 0) RETURN 
 
            !write(6,*)' In getoldimg_mrc opened old templated file: ',
            !          filpat(1:nlet), maxim
@@ -511,7 +614,7 @@ C          FIND NUMBER OF IMAGES IN STACK
                 
 C          CHECK IF IMAGE CAN FIT IN STACK
            IF (NWANT > NSTACK) THEN
-             CALL ERRT(102,'GETOLDIMG_MRC, NO SUCH IMAGE',NWANT)
+             CALL ERRT(102,'GETOLDIMG_MRC,  NO SUCH IMAGE',NWANT)
              IRTFLG = 1
              RETURN
            ENDIF
@@ -527,20 +630,20 @@ C          SET FILENAME,  IN LUN - FILENAME
 C          SET AXIS ORIGIN LOCATION & VOLUME HANDEDNESS IF NEEDED
            CALL WHICH_HAND_MRC(LUN,FILNAM,CAXIS,IRTFLG)
 
-C          SET IMAGE OFFSET FOR READ/WRITE
+C          SET IMAGE  OFFSET FOR READ/WRITE
            CALL LUNSETPOS_MRC(LUN,NWANT,IRTFLG)
            IF (IRTFLG .NE. 0) RETURN
 
 C          PUT COMMON VALUES INTO COMMON AREA (NOT NEEDED IN FUTURE?)
            CALL LUNSETCOMMON_MRC(LUN,IRTFLG)
            IF (IRTFLG .NE. 0) RETURN
-           !write(3,*)' In getoldimg_mrc after lunsetcommon: ',filnam(1:nlet)
+           !write(6,*)' In getoldimg_mrc after lunsetcommon: ',filnam(1:nlet)
 
 C          WRITE OUT FILE OPENING INFO IF WANTED
            CALL LUNSAYINFO_MRC(LUN,SAYIT,IRTFLG)
            IF (IRTFLG .NE. 0) RETURN
 
-cc         write(3,*)' In getoldimg_mrc opened old templated stk file: ',
+cc         write(6,*)' In getoldimg_mrc opened old templated stk file: ',
 cc     &               filnam(1:nlet)
 
 C          RETURN IMAGE NUMBER THAT WAS WANTED
@@ -552,5 +655,5 @@ C          RETURN IMAGE NUMBER THAT WAS WANTED
         ENDIF
         IRTFLG = 1
 
-	END
+        END
 
diff --git src/opstreamfile.f src/opstreamfile.f
index a542a579..0974fc0e 100644
--- src/opstreamfile.f
+++ src/opstreamfile.f
@@ -1,15 +1,17 @@
 
-C ++********************************************************************
+C **********************************************************************
 C
 C OPSTREAMFILE  STREAM IO                        FEB 2013 ArDean Leith
 C               CONVERT LITTLE ENDED OPTION      JAN 2018 ArDean Leith
+C               ADDED DEBUG OUTPUT               OCT 2025 ArDean Leith
+C
 C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2019  Health Research Inc.,                         *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@health.ny.gov                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -63,7 +65,7 @@ C***********************************************************************
         INTEGER           :: LENE,IRTFLGT,LUN,IDUM,LENOPEN,LENOPENFILE
         INTEGER           :: LENOPN,LENREC
 
-        CALL SET_MPI(ICOMM,MYPID,MPIERR) ! SETS ICOMM AND MYPID  #ifdef USE_MPI
+        CALL SET_MPI(ICOMM,MYPID,MPIERR) ! SETS ICOMM AND MYPID
 
         SAYIT = (IRTFLG .NE. 999)
 
@@ -121,6 +123,7 @@ C       SET STATUS FOR OPEN
 
         IF (DISP(1:1) == 'S') STATVAR = 'SCRATCH'
 
+
         IF (DISP(1:1) == 'O') THEN
 C          CHECK FOR FILE EXISTENCE 
            IF (MYPID <= 0) THEN
@@ -143,20 +146,35 @@ C          CHECK FOR FILE EXISTENCE
               RETURN
 
            ENDIF
-           STATVAR = 'OLD'
+           STATVAR = 'OLD'  
         ENDIF
 
 C       OPEN FILE FOR STREAM ACCESS
 
-C       COMPUTE RECL UNITS (DIFFERS WITH OS &A COMPILER FLAGS)
+#if defined(SP_DBUG)
+        write(3,*)' In opstreamfile; Disp,Statvar,Formvar: ', 
+     &                               disp,' :',statvar,' :',formvar
+
+        write(3,*)' In opstreamfile; convert_to_big,convert_to_little:',
+     &                           convert_to_big,' :',convert_to_little
+#endif
+
+#if defined(SP_BACK)
+ 
+        !CALL BACKTRACE
+#endif
+
+C       COMPUTE RECL UNITS (DIFFERS WITH OS & COMPILER FLAGS)
         LENOPN = LENOPENFILE(LENREC)
 
         IF (MYPID <= 0) THEN
-           IF (STATVAR == 'SCRATCH') THEN
+
+           IF (STATVAR == 'SCRATCH') THEN   !----- SCRATCH FILE ----
+
               IF (CONVERT_TO_LITTLE) THEN
 C                FORCE OUTPUT TO LITTLE_ENDIAN
 
-	         OPEN(UNIT=LUN,STATUS=STATVAR,
+                 OPEN(UNIT=LUN,STATUS=STATVAR,
      &             CONVERT='LITTLE_ENDIAN',
      &             FORM=FORMVAR, ACCESS='STREAM',
      &             IOSTAT=IRTFLGT)
@@ -164,23 +182,24 @@ C                FORCE OUTPUT TO LITTLE_ENDIAN
               ELSEIF (CONVERT_TO_BIG) THEN
 C                FORCE OUTPUT TO BIG_ENDIAN
 
-	         OPEN(UNIT=LUN,STATUS=STATVAR,
+                 OPEN(UNIT=LUN,STATUS=STATVAR,
      &             CONVERT='BIG_ENDIAN',
      &             FORM=FORMVAR, ACCESS='STREAM',
      &             IOSTAT=IRTFLGT)
 
-	      ELSE
+              ELSE
 
-	         OPEN(UNIT=LUN,STATUS=STATVAR,
+                 OPEN(UNIT=LUN,STATUS=STATVAR,
      &             FORM=FORMVAR, ACCESS='STREAM',
      &             IOSTAT=IRTFLGT)
               ENDIF
-           ELSE
+
+           ELSE    ! ----------- NOT A SCRATCH FILE -------------
 
               IF (CONVERT_TO_LITTLE) THEN
 C               FORCE OUTPUT TO LITTLE_ENDIAN
 
-	        OPEN(UNIT=LUN,FILE=FILNAM(1:NCHAR),STATUS=STATVAR,
+                OPEN(UNIT=LUN,FILE=FILNAM(1:NCHAR),STATUS=STATVAR,
      &             CONVERT='LITTLE_ENDIAN',
      &             FORM=FORMVAR, ACCESS='STREAM', 
      &             IOSTAT=IRTFLGT)
@@ -188,13 +207,13 @@ C               FORCE OUTPUT TO LITTLE_ENDIAN
               ELSEIF (CONVERT_TO_BIG) THEN
 C                FORCE OUTPUT TO BIG_ENDIAN
 
-	         OPEN(UNIT=LUN,FILE=FILNAM(1:NCHAR),STATUS=STATVAR,
+                 OPEN(UNIT=LUN,FILE=FILNAM(1:NCHAR),STATUS=STATVAR,
      &             CONVERT='BIG_ENDIAN',
      &             FORM=FORMVAR, ACCESS='STREAM',
      &             IOSTAT=IRTFLGT)
 
               ELSE
-	         OPEN(UNIT=LUN,FILE=FILNAM(1:NCHAR),STATUS=STATVAR,
+                 OPEN(UNIT=LUN,FILE=FILNAM(1:NCHAR),STATUS=STATVAR,
      &             FORM=FORMVAR, ACCESS='STREAM', 
      &             IOSTAT=IRTFLGT)
 
@@ -207,7 +226,6 @@ C                FORCE OUTPUT TO BIG_ENDIAN
         CALL BCAST_MPI('OPSTREAMFILE','IRTFLGT', IRTFLGT,1, 'I',ICOMM)
 #endif
 
-
         IF (IRTFLGT .NE. 0) THEN
            WRITE(NOUT,90) FORMVAR(1:1), FILNAM(:NCHAR)
  90        FORMAT(' ERROR OPENING (',A1,'): ',A)
@@ -222,6 +240,11 @@ C                FORCE OUTPUT TO BIG_ENDIAN
  
         IRTFLG = 0
 
+#if defined(SP_DBUG)
+        write(3,*)' Leaving opstreamfile; irtflg: ',irtflg
+        write(3,*)
+#endif
+
         END
 
 
diff --git src/pr3d.f src/pr3d.f
index f2b7d585..06c71ccb 100644
--- src/pr3d.f
+++ src/pr3d.f
@@ -17,7 +17,6 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2016  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -85,7 +84,7 @@ C--*********************************************************************
 
         CALL SET_MPI(ICOMM,MYPID,MPIERR)
 
-        WANTSQRTS = (FSCOP == .TRUE.)
+        WANTSQRTS = FSCOP  ! WANTSQRTS = (FSCOP == .TRUE.) ILLEGAL ON GFORT Sept 2025 al
 
 C       INPUT FIRST IMAGE
         MAXIM = 0
diff --git src/pw2sr.f src/pw2sr.f
index fbfa6d19..f57099f4 100644
--- src/pw2sr.f
+++ src/pw2sr.f
@@ -9,7 +9,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2018  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@wadsworth.org                                        *
+C=* Email: spider@health.ny.gov                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -41,8 +41,8 @@ C       FOR FOURIER FILE, LSD = NX+2-MOD(NX,2)   eg: 16=18  17=18
         IMPLICIT NONE
         INCLUDE 'CMBLOCK.INC'
 
+        INTEGER      :: NX,NY,LSD !GFORT ERROR IF NOT BEFOR Q,  Sept 2025 al
         REAL         :: Q(LSD,NY)
-        INTEGER      :: NX,NY,LSD
         CHARACTER    :: MODE
 
         INTEGER      :: J,I,JN,II,JJ,JB,NXD2,NYD2
@@ -238,8 +238,8 @@ C       -------------------- PW2SR ------------------------
         SUBROUTINE  PW2SR(Q,NX,NY,MODE)
 
         IMPLICIT NONE
+        INTEGER      :: NX,NY   !GFORT ERROR IF NOT BEFOR Q,  Sept 2025 al
         REAL         :: Q(NX+2-MOD(NX,2), NY)
-        INTEGER      :: NX,NY
         CHARACTER*1  :: MODE
 
         INTEGER      :: NNNN,NSC,J,I,JJ,II,JB
diff --git src/pw3sr.f src/pw3sr.f
index bb9288bb..c547a31a 100644
--- src/pw3sr.f
+++ src/pw3sr.f
@@ -8,7 +8,6 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2018  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -34,8 +33,8 @@ C--*********************************************************************
         SUBROUTINE PW3SR(Q,NX,NY,NZ,MODE)
 
         IMPLICIT NONE
-        REAL         :: Q(NX+2-MOD(NX,2),NY,NZ)
-        INTEGER      :: NX,NY,NZ
+        INTEGER      :: NX,NY,NZ !GFORT ERROR IF NOT BEFOR Q,  Sept 2025 al
+        REAL         :: Q(NX+2-MOD(NX,2),NY,NZ)!GFORT ERROR,  Sept 2025 al
         CHARACTER    :: MODE
 
         LOGICAL      :: EVENY,EVENZ,WANTLOG,WANT2,WANTPH
diff --git src/qstat.f src/qstat.f
index 47433531..329582c6 100644
--- src/qstat.f
+++ src/qstat.f
@@ -1,18 +1,19 @@
 
 C++*********************************************************************
 C
-C    QSTAT.F           LONG FILE NAMES JAN             89 ArDean Leith
-C                      MODIFIED FOR STACKS             98 ArDean Leith
-C                      ==,NSAM,IMPLICIT                16 ArDean Leith
-C                      (IN HEADER) MSG                 19 ArDean Leith
-C
+C    QSTAT.F           LONG FILE NAMES JAN           1989 ArDean Leith
+C                      MODIFIED FOR STACKS           1998 ArDean Leith
+C                      ==,NSAM,IMPLICIT              2016 ArDean Leith
+C                      (IN HEADER) MSG               2019 ArDean Leith
+C                      DEBUG OUTPUT                  2025 ArDean Leith
+C                      FLOWCHART                     2025 ArDean Leith
 C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2019  Health Research Inc.,                         *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@health.ny.gov                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -36,6 +37,41 @@ C                  NX,NY        X & Y DIMENSIONS OF IMAGE
 C                  NZ           Z DIMENSION  OF IMAGE
 C                  NSTACK       STACK/MAXIM INDICATOR
 C
+C     USED BY: FS 
+C     QSTAT
+C        v
+C     OPFILES Uses (E.G. STK@****)~~9  prompt for filename
+C             '~9' in last 3 char. of prompt accepts extension on filename 
+C        v
+C        ` ->  FILERD  
+C        v      ` ->  ECHONAME 
+C        |
+C        ` ->  FILELIST
+C        v 
+C        |  MRC file:       *.MRC or *.MRCS
+C        ` -> OPFILES_MRC
+C                 |
+C                 |  Templated stack:  **@STK.MRC
+C                 ` ---> FILGET_AT --> OPFILEC --> OPENFIL_MRC --> OPENFIL_O_MRC C                 |                                            --> OPENFIL_N_MRC
+C                 |
+C                 |  Whole barestack:  @STK.MRC 
+C                 ` ---> FILGET_AT --> OPFILEC --> OPENFIL_MRC --> OPENFIL_O_MRC
+C                 |                                            --> OPENFIL_N_MRC
+C                 | 
+C                 |  File template:    IMG***.MRC
+C                 ` ---> FILGET_AT --> OPFILEC --> OPENFIL_MRC --> OPENFIL_O_MRC
+C                 |                                            --> OPENFIL_N_MRC
+C                 | 
+C                 |  Simple file:      IMG001.MRC
+C        |        ` -----------------> OPFILEC --> OPENFIL_MRC --> OPENFIL_O_MRC C        |                                                     --> OPENFIL_N_MRC
+C        | 
+C        v
+C      NORM3
+C        ` -> REDLIN
+C        | 
+C        v
+C      REPORTSTAT
+C
 C--*******************************************************************
 
       SUBROUTINE QSTAT(LUN1,LUNM,LUNDOC,LUNXM1)
@@ -53,7 +89,7 @@ C--*******************************************************************
       INTEGER               :: ILIST1(NIMAX)
       INTEGER               :: NILMAX,NLET1,IFORM1,NX1,NY1,NZ1
       INTEGER               :: NDUM,NGOT1,IMG1,IRTFLG
-      INTEGER               :: NXM,NYM,NZM,MAXIMM,ninndx1,npoint
+      INTEGER               :: NXM,NYM,NZM,MAXIMM,npoint
 
       INTEGER               :: ICOMM, MYPID, MPIERR
       INTEGER               :: NSTACK1, IMAMI1, IFORMM, NINDX1, NLET 
@@ -64,6 +100,8 @@ C--*******************************************************************
 
       CALL SET_MPI(ICOMM,MYPID,MPIERR) ! SETS ICOMM AND MYPID
 
+      !write(6,*)' In qstat 0; --------- 0'
+
 C     OPEN INPUT FILE
       NILMAX = NIMAX
       FOUROK = .TRUE.
@@ -74,16 +112,17 @@ C     OPEN INPUT FILE
      &             FOUROK, ILIST1,NILMAX, 
      &             NDUM,NGOT1,IMG1, IRTFLG)
  
-      !write(6,'(a,8i5)')' nstack1,ngot1,img1:',nstack1,ngot1,img1
-      !write(3,'(a,8i5)')' In qstat; ngot,nstack,img:',nstack1,ngot1,img1
-      !write(3,'(a,8i5)')' In qstat; ilist1:',ilist1(1:5)
+      !write(6,*)' In qstat; ilist1:',ilist1(1:5)
+      !write(6,*)' In qstat; ngot1,nstack1,img1:',ngot1,nstack1,img1
+      !write(6,*)' In qstat; irtflg:',irtflg
+
       IF (IRTFLG .NE. 0) RETURN
       
 
       IMAMI1 = IMAMI   ! FROM CMBLOCK
 
       IF (FCHAR(4:4) == 'M') THEN
-C        FIND STATISTICS UNDER A MASKED AREA
+C        FIND STATISTICS UNDER A MASKED AREA -------------------
 
 C        OPEN MASK INPUT FILE
          CALL OPFILEC(0,.TRUE.,FILNAMM,LUNM,'O',IFORMM,
@@ -99,7 +138,7 @@ C        OPEN MASK INPUT FILE
       ISFIRST = .TRUE.
        
       NINDX1  = 1
-      DO                ! LOOP OVER ALL IMAGES/STACKS
+      DO                ! LOOP OVER ALL IMAGES/STACKS -----------
 
         IF (FCHAR(4:4) == 'M') THEN
            CALL NORMM(LUN1,LUNM,NX1,NY1,NZ1,
@@ -122,7 +161,6 @@ C        OPEN MASK INPUT FILE
            CALL NORM3(LUN1,NX1,NY1,NZ1,FMAX,FMIN,AV)
         ENDIF
 
-        !write(3,'(a,8i5)')' In qstat; ngot,nstack,img:',nstack1,ngot1,img1
         CALL REPORTSTAT(NEWCALC, FMIN,FMAX,AV,SIG)
 
 C       OPEN NEXT INPUT FILE, UPDATE NINDX1 
@@ -132,9 +170,13 @@ C       OPEN NEXT INPUT FILE, UPDATE NINDX1
      &                LUN1,    0,  
      &                FILNAM1, 'O',
      &                IMG1,    IRTFLG)
+
+       !write(6,*)' In qstat; ngot1,nstack1,img1: ',ngot1,nstack1,img1
+       !write(6,*)' In qstat; nindx1,irtflg: ',nindx1,irtflg
+ 
         IF (IRTFLG .NE. 0) EXIT      ! ERROR / END OF INPUT STACK
         IMAMI1 = IMAMI
-
+           
       ENDDO
 
 9999  CLOSE(LUN1)
diff --git src/rawtospider.f src/rawtospider.f
index 410a11a1..bd521110 100644
--- src/rawtospider.f
+++ src/rawtospider.f
@@ -17,7 +17,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2010  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@wadsworth.org                                        *
+C=* Email: spider@health.ny.gov                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -57,6 +57,7 @@ C--*********************************************************************
  
        NULL = CHAR(0)
 
+       !write(6,*) '  in rawtospider, luns:',lunold,lunnew
 C      GET FILENAME FOR EXISTING RAW IMAGE FILE
        CALL FILERD(FILOLD,NLET,DATEXC,'EXISTING RAW~9',IRTFLG)
        IF (IRTFLG .NE. 0) RETURN
@@ -137,6 +138,9 @@ C      OPEN RAW FILE AS DIRECT ACCESS, UNFORMATTED REC.
      &                   ' ',.TRUE.,IRTFLG)
        IF (IRTFLG .NE. 0) GOTO 9999
 
+       !write(6,*) '  in rawtospider, mode,modea:',mode,modea
+
+
        IF (MODE .EQ. 8) THEN
 C         FOR 8 BIT RAW INTEGER INPUT 
           CALL RAW8TOSPI(LUNOLD,LUNNEW,NSAM,NPIX8,IOFFSET,.TRUE.,
diff --git src/rdpr.f src/rdpr.f
index 215a7b51..3917e91a 100644
--- src/rdpr.f
+++ src/rdpr.f
@@ -1,45 +1,47 @@
 
 C++*********************************************************************
 C
-C  RDPR.F -- CREATED 2/8/90 ARDEAN LEITH 
-C	  -- ADD ON-LINE HELP                3/29/93 MAHIEDDINE LADJADJ  
-C         -- CONVERTED FROM READCH                  DEC 96 ARDEAN LEITH
-C         -- F90 CHANGES                            OCT 97 ARDEAN LEITH
-C         -- STRIPS COMMENT                         AUG 99 ARDEAN LEITH
-C         -- LUNDONOW ADDED                         OCT 99 ARDEAN LEITH
-C         -- TRAILING BLANKS IN COMMENT REMOVED     NOV 99 ARDEAN LEITH
-C         -- PUT IN <1> VARIABLE HANDLING           SEP 00 ARDEAN LEITH
-C         -- MULTIPLE VARIABLE SUBSTITUTION         JAN 01 ARDEAN LEITH
-C         -- USED PROC_GETLINE                      JAN 01 ARDEAN LEITH
-C         -- FLAG FOR ; OK                          MAR 01 ARDEAN LEITH
-C         -- ADDED FILNAMSUB                        APR 01 ARDEAN LEITH
-C         -- ADDED VERBOSE FOR ;                    APR 01 ARDEAN LEITH
-C         -- DELAYED PROMPT FOR .NOT. VERBOSE       JUN 01 ARDEAN LEITH
-C         -- MOVED SSUPCASE LATER                   SEP 01 ARDEAN LEITH
-C         -- NO PROMPT FOR .OP COMMENT LINES        MAR 02 ARDEAN LEITH
-C         -- SYMPAR REWRITTEN                       JUN 02 ARDEAN LEITH
-C         -- NO SYMPAR FOR 'RR'                     AUG 02 ARDEAN LEITH
-C         -- '[]' --> '<>'                          SEP 02 ARDEAN LEITH
-C         -- PARAMETERS CHANGED                     APR 05 ARDEAN LEITH
-C         -- [] DEFAULT FOR VARIABLES               OCT 05 ARDEAN LEITH
-C         -- NDOLINE                                MAY 07 ARDEAN LEITH
-C         -- ?prompt?[  FR BUG                      JUN 07 ARDEAN LEITH
-C         -- REMOVED IMCx33 OBSOLETE SYNTAX         JUN 09 ARDEAN LEITH
-C	  -- REMOVED ON-LINE HELP                   AUG 09 ARDEAN LEITH  
-C         -- $DATEXT x11 BUG                        AUG 09 ARDEAN LEITH
-C         -- '@@' SUPPORT                           NOV 09 ARDEAN LEITH
-C         -- NDOLINE                                NOV 09 ARDEAN LEITH
-C         -- VMS COMMAND DOES NOT <> --> []         SEP 10 ARDEAN LEITH
-C         -- ! COMMENT DELIMITER                    DEC 11 ARDEAN LEITH
-C         -- RECURSIVE FILNAMSUB                    MAR 12 ARDEAN LEITH
-C         -- IRTFLG 654321                          MAR 12 ARDEAN LEITH
+C  RDPR.F -- CREATED 2/8/90 ArDean Leith 
+C	  -- ADD ON-LINE HELP               3/29/93 Mahieddine Ladjadj 
+C         -- CONVERTED FROM READCH                 DEC 96 ArDean Leith
+C         -- F90 CHANGES                           OCT 97 ArDean Leith
+C         -- STRIPS COMMENT                        AUG 99 ArDean Leith
+C         -- LUNDONOW ADDED                        OCT 99 ArDean Leith
+C         -- TRAILING BLANKS IN COMMENT REMOVED    NOV 99 ArDean Leith
+C         -- PUT IN <1> VARIABLE HANDLING          SEP 00 ArDean Leith
+C         -- MULTIPLE VARIABLE SUBSTITUTION        JAN 01 ArDean Leith
+C         -- USED PROC_GETLINE                     JAN 01 ArDean Leith
+C         -- FLAG FOR ; OK                         MAR 01 ArDean Leith
+C         -- ADDED FILNAMSUB                       APR 01 ArDean Leith
+C         -- ADDED VERBOSE FOR ;                   APR 01 ArDean Leith
+C         -- DELAYED PROMPT FOR .NOT. VERBOSE      JUN 01 ArDean Leith
+C         -- MOVED SSUPCASE LATER                  SEP 01 ArDean Leith
+C         -- NO PROMPT FOR .OP COMMENT LINES       MAR 02 ArDean Leith
+C         -- SYMPAR REWRITTEN                      JUN 02 ArDean Leith
+C         -- NO SYMPAR FOR 'RR'                    AUG 02 ArDean Leith
+C         -- '[]' --> '<>'                         SEP 02 ArDean Leith
+C         -- PARAMETERS CHANGED                    APR 05 ArDean Leith
+C         -- [] DEFAULT FOR VARIABLES              OCT 05 ArDean Leith
+C         -- NDOLINE                               MAY 07 ArDean Leith
+C         -- ?prompt?[  FR BUG                     JUN 07 ArDean Leith
+C         -- REMOVED IMCx33 OBSOLETE SYNTAX        JUN 09 ArDean Leith
+C         -- REMOVED ON-LINE HELP                  AUG 09 ArDean Leith 
+C         -- $DATEXT x11 BUG                       AUG 09 ArDean Leith
+C         -- '@@' SUPPORT                          NOV 09 ArDean Leith
+C         -- NDOLINE                               NOV 09 ArDean Leith
+C         -- VMS COMMAND DOES NOT <> --> []        SEP 10 ArDean Leith
+C         -- ! COMMENT DELIMITER                   DEC 11 ArDean Leith
+C         -- RECURSIVE FILNAMSUB                   MAR 12 ArDean Leith
+C         -- IRTFLG 654321                         MAR 12 ArDean Leith
+C         -- ADDED DEBUG_IO OUTPUT                 OCT 25 ArDean Leith
+C
 C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2012  Health Research Inc.,                         *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@wadsworth.org                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -58,36 +60,37 @@ C
 C  RDPR(PROMPT,NCHAR,ANS,UPPER,WANTSUB,SAYPRMT,SAYANS,ENDATSEMI,IRTFLG)
 C
 C  PURPOSE: OUTPUTS PROMPT
-C           READS AN ALPHANUMERIC STRING FROM STORED PROC. LINE, TERMINAL,
-C              OR PROMPT.
-C           ECHO & SKIP LINES WHICH ONLY CONTAIN A COMMENT AT START OF LINE
+C           READS AN ALPHANUMERIC STRING FROM STORED PROC. LINE,
+C           TERMINAL,  OR PROMPT.
+C           ECHO & SKIP LINES WHICH ONLY CONTAIN A COMMENT AT 
+C           START OF LINE
 C           HANDLES INTERACTIVE HELP
 C           CAN ECHO LINE TO CURRENT INTERACTIVE DO-LOOP IFLE.
-C           CONVERTS OLD @B01[X11] PROC. ARG. FORMAT TO TO NEW: () ARG.  
+C           CONVERTS OLD @B01[X11] PROC. ARG. FORMAT TO TO NEW: () ARG.
 C           CONVERTS OLD <> VARIABLE FORMAT TO NEW [] VARIABLE FORMAT
-C           CAN INVOKE VARIABLE SUBSTITUTION FOR [string]. 
+C           CAN INVOKE VARIABLE SUBSTITUTION FOR [string].
 C           CAN CONVERT TO UPPERCASE
 C           CONVERTS OLD X REGISTER TO  [] VARIABLE FORMAT
 C           SUBSTITUTES FOR {***[]} AND ${ENV} STRINGS
-C               
-C           RETURNS NCHAR=LENGTH OF STRING WITHOUT TRAILING BLANKS OR COMMENT. 
+C           RETURNS NCHAR=LENGTH OF STRING WITHOUT TRAILING BLANKS
+C           OR COMMENT.
 C           COMMENT IS LIMITED TO 80 CHAR.
 C           VARIABLE VALUE RESPONSE IS LIMITED TO 160 CHAR.
 C             
 C           REGISTER SUBSTITUTION OCCURS IN RDPRINC
 C            
 C  PARAMETERS:  PROMPT    INPUT PROMPT                     (SENT)
-C               NCHAR     LAST NON_BLANK CHAR IN           (RETURNED)
-C                            ANS RESPONSE BEFORE COMMENT
+C               NCHAR     LAST NON_BLANK CHAR IN ANS       (RETURNED)
+C                         RESPONSE BEFORE COMMENT
 C               ANS       USER RESPONSE                    (RETURNED)
 C               GETANS    READ ANSWER (NOT PROMPT)         (SENT)
 C               UPPER     CONVERT TO UPPERCASE             (SENT)
 C               WANTSUB   WANT SYM. PARAMETER SUBSTITUTION (SENT)
-C                             HERE NOW (USUAL)
+C                         HERE NOW                         (USUAL)
 C               SAYPRMT   ECHO PROMPT TO OUTPUT            (SENT)
 C               SAYANS    ECHO RAW ANSWER TO OUTPUT        (SENT)
 C               ENDATSEMI IGNORE SEMICOLON COMMENT         (SENT) 
-C                            (FOR vms.f)
+C                            (FOR vms.f or SYS)
 C               IRTFLG    RETURN FLAG (0 IS NORMAL)        (RETURNED)
 C
 C  CALLED BY:   RDPRMC -> RDPR -> SUBSYMPAR &  SSUPCAS & FILNAMSUB
@@ -109,7 +112,7 @@ C23456789012345678901234567890123456789012345678901234567890123456789012
 C--*********************************************************************
 
       SUBROUTINE RDPR(PROMPT,NCHAR,ANS,
-     &       GETANS,UPPER,WANTSUB,SAYPRMT,SAYANS,ENDATSEMI,STRIP,IRTFLG)
+     &     GETANS,UPPER,WANTSUB,SAYPRMT,SAYANS,ENDATSEMI,STRIP,IRTFLG)
 
       INCLUDE 'CMBLOCK.INC'
 
@@ -127,11 +130,16 @@ C--*********************************************************************
 
       LEGACYREGS = (IRTFLG .NE. -999)  ! DO NOT CONVERT x**
       ACCEPTCR   = (IRTFLG == 654321)  ! ACCEPT <CR> FOR RDPRI & M
-  
-      IDOL = INDEX(PROMPT,'$') - 1
-      IF (IDOL .LE. 0) IDOL = LEN(PROMPT)
 
+#undef SP_DBUGIO
+
+#if defined (SP_DBUGIO)
+      write(3,*)' Starting rdpr; irtflg,acceptcr: ',irtflg,acceptcr
+#endif
       IRTFLG = 0
+ 
+      IDOL = INDEX(PROMPT,'$') - 1
+      IF (IDOL .LE. 0) IDOL = LEN(PROMPT)
 
 10    CONTINUE
 C     PROMPT OUTPUT IS DELAYED IN BATCH TO IGNORE COMMENT / BLANK LINES
@@ -184,12 +192,18 @@ C     (IF ; IS PROCEEDED BY SPACE MAYBE THE USER INPUT A BLANK??)
       NCHARA  = NCHAR           ! NOTHING BEFORE ; FLAG
       IF (LOCSEMI > 0) NCHARA = lnblnk(ANS(1:LOCSEMI-1))
 
-      !write(6,*) 'rdpr, nchara,locsemi:',nchara,locsemi,acceptcr
-      !write(6,*) 'rdpr, ANS(NCHARA:NCHARA):',ANS(NCHARA:NCHARA),':'
+#if defined (SP_DBUGIO)
+      write(3,*)' In rdpr; nchar,nchara,locsemi: ',nchar,nchara,locsemi
+      if (nchara > 0) then
+        write(3,*) ' In rdpr; ans(nchara:nchara): ',ans(nchara:nchara)
+      endif
+#endif
 
-      IF (ACCEPTCR .AND. 
-     &   (NCHARA == 0 .OR. ANS(NCHARA:NCHARA) == '*') ) THEN
+C     IF (ACCEPTCR .AND. 
+C     &  (NCHARA == 0 .OR. ANS(NCHARA:NCHARA) == '*') ) THEN
+C     kludge for use with gfort debugger if nchara <= 0 Oct 2025
 
+      IF (ACCEPTCR .AND. (NCHARA <= 0)) THEN
 C        ACCEPT <CR> or *  RESPONSE BEFORE COMMENT
          IF (MYPID <= 0 .AND. SAYPRMT .AND. COPT == 'B') THEN
             WRITE(NOUT,95)  PROMPT(1:IDOL),': ',ANS(1:NCHAR)
@@ -197,7 +211,15 @@ C        ACCEPT <CR> or *  RESPONSE BEFORE COMMENT
          ENDIF
          NCHAR  = 0
          IRTFLG = 0
-         !write(6,*) 'rdpr, nchar:',nchar,irtflg
+         RETURN
+
+      ELSEIF (ACCEPTCR .AND. ANS(NCHARA:NCHARA) == '*')  THEN
+C        ACCEPT <CR> or *  RESPONSE BEFORE COMMENT
+         IF (MYPID <= 0 .AND. SAYPRMT .AND. COPT == 'B') THEN
+            WRITE(NOUT,95)  PROMPT(1:IDOL),': ',ANS(1:NCHAR)
+         ENDIF
+         NCHAR  = 0
+         IRTFLG = 0
          RETURN
 
       ELSEIF (LOCSEMI == 1 .AND. ENDATSEMI) THEN
@@ -206,7 +228,7 @@ C        NOTHING BEFORE COMMENT
 C           ECHO COMMENT
             IF (SAYPRMT .AND. COPT == 'B') 
      &          WRITE(NOUT,90,ADVANCE='NO')  PROMPT(1:IDOL)
-	    IF (NOUT .NE. 0)  WRITE(NOUT,91) ANS(1:NCHAR)
+            IF (NOUT .NE. 0)  WRITE(NOUT,91) ANS(1:NCHAR)
 91          FORMAT(' ',A)
          ENDIF
 C        READ ANOTHER INPUT LINE
@@ -262,6 +284,7 @@ C        MUST COPY INPUT LINE TO CURRENT INTERACTIVE DO-LOOP FILE
          WRITE(LUNDONOW,*) ANS(1:NCHAR)
          NDOLINE = NDOLINE + 1
          !write(6,*) ' rdpr lundo: ',ANS(1:NCHAR),':',NDOLINE !!!!
+
       ELSEIF ((COPT == 'I' .AND. NDOLINE > 0)) THEN
          NDOLINE = NDOLINE + 1
          !write(6,*) ' rdpr ndoline: ',ANS(:NCHAR),':',NDOLINE !!!!
@@ -400,7 +423,7 @@ C           PROBABLE REGISTER START x or X
 
 
 
-C      *********************** DECOMMENT ********************************
+C      *********************** DECOMMENT *******************************
 
        SUBROUTINE DECOMMENT(CINPUT,NCHAROUT,LOCSEMI)
 
diff --git src/rdprmc.f src/rdprmc.f
index 6af21710..ab40d224 100644
--- src/rdprmc.f
+++ src/rdprmc.f
@@ -1,28 +1,29 @@
 
 C++*********************************************************************
 C
-C    RDPRMC.F -- CREATED FROM RDPRMB.F          08/15/89 ARDEAN LEITH
-C                REWRITTEN                       03/4/98 ARDEAN LEITH
-C                LENGTHENED ANST                11/17/00 ARDEAN LEITH
-C                SKIP BLANK LINE ECHO VERBOSE    03/7/02 ARDEAN LEITH
-C                IQ P SPECIAL LINES             06/26/02 ARDEAN LEITH
-C                NLOG                           11/26/03 ARDEAN LEITH
-C                NO INITIAL BLANKS ON ECHO      03/30/05 ARDEAN LEITH
-C                .OPERATION.... BUG             05/25/05 ARDEAN LEITH
-C                RDPR PARAMETERS                04/14/05 ARDEAN LEITH
-C                TO NOUT ALWAYS                 02/21/06 ARDEAN LEITH
-C                IF (FCHAR(1:2) == 'FR'         07/31/06 ARDEAN LEITH
-C                DEBRAKREG                      09/05/06 ARDEAN LEITH
-C                IF (FCHAR(1:4) == 'FR N'       08/28/09 ARDEAN LEITH
-C                NECHO                          09/20/12 ARDEAN LEITH
+C    RDPRMC.F -- CREATED FROM RDPRMB.F          08/15/89 ArDean Leith
+C                REWRITTEN                       03/4/98 ArDean Leith
+C                LENGTHENED ANST                11/17/00 ArDean Leith
+C                SKIP BLANK LINE ECHO VERBOSE    03/7/02 ArDean Leith
+C                IQ P SPECIAL LINES             06/26/02 ArDean Leith
+C                NLOG                           11/26/03 ArDean Leith
+C                NO INITIAL BLANKS ON ECHO      03/30/05 ArDean Leith
+C                .OPERATION.... BUG             05/25/05 ArDean Leith
+C                RDPR PARAMETERS                04/14/05 ArDean Leith
+C                TO NOUT ALWAYS                 02/21/06 ArDean Leith
+C                IF (FCHAR(1:2) == 'FR'         07/31/06 ArDean Leith
+C                DEBRAKREG                      09/05/06 ArDean Leith
+C                IF (FCHAR(1:4) == 'FR N'       08/28/09 ArDean Leith
+C                NECHO                          09/20/12 ArDean Leith
+C                KLUDGE TO ACCEPT <CR> IN DISP  10/20/25 ArDean Leith 
 C
 C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2014  Health Research Inc.,                         *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@wadsworth.org                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -40,20 +41,22 @@ C **********************************************************************
 C
 C  RDPRMC(ANS,NCHAR,STRIP,PROMPT,CDUM,IRTFLG)
 C
-C  PURPOSE: READ AN ALPHANUMERIC STRING, CHECK FOR ANY SPECIAL OPERATION,
-C           RETURN STRING MINUS ANY LEADING OR TRAILING BLANKS, AND NUMBER
-C           OF CHARACTERS IN STRING AND A ERROR FLAG.  NORMALLY CONVERTS
-C           INPUT TO UPPER CASE.  STRIPS OFF ANY TRAILING SPIDER COMMENT
+C  PURPOSE: READ AN ALPHANUMERIC STRING, CHECK FOR ANY SPECIAL CHARS
+C           IN AN OPERATION,
+C           RETURN STRING MINUS ANY LEADING OR TRAILING BLANKS, AND
+C           NUMBER OF CHARACTERS IN STRING AND A ERROR FLAG.  
+C           NORMALLY CONVERTS INPUT TO UPPER CASE.  
+C           STRIPS OFF ANY TRAILING SPIDER COMMENT
 C
-C  PARAMETERS:  ANS       ANSWER                                    RET.
-C               NCHAR     NUMBER OF CHARACTERS IN THE ANSWER        RET.
-C               STRIP     LOGICAL FLAG TO STRIP BLANKS FROM ANS    SENT
-C               PROMPT    SOLICITATION MESSAGE                     SENT
-C               CDUM                                             (UNUSED)
-C               IRTFLG    RETURN FLAG                          SENT/RET.
+C  PARAMETERS:  ANS       ANSWER                                   RET.
+C               NCHAR     NUMBER OF CHARACTERS IN THE ANSWER       RET.
+C               STRIP     LOGICAL FLAG TO STRIP BLANKS FROM ANS   SENT
+C               PROMPT    SOLICITATION MESSAGE                    SENT
+C               CDUM      (UNUSED)
+C               IRTFLG    RETURN FLAG                          SENT/RET
 C                           (0 IS NORMAL, -1 IS GOTO PREVIOUS
 C                           QUESTION, 1 IS END-OF_FILE) 
-C                           IRTFLG: -999 ON INPUT
+C                           IRTFLG: -999 -654321 ON INPUT
 C                           DOES NOT CONVERT INPUT TO UPPERCASE
 C
 C  CALLED BY:   VERY MANY SPIDER ROUTINES
@@ -63,7 +66,7 @@ C--*********************************************************************
 
         SUBROUTINE RDPRMC(ANS,NCHAR,STRIP,PROMPT,CDUM,IRTFLG)
 
-	INCLUDE 'CMBLOCK.INC' 
+        INCLUDE 'CMBLOCK.INC' 
 
         CHARACTER(LEN=*)     :: ANS,PROMPT,CDUM
         CHARACTER(LEN=161)   :: ANST
@@ -73,9 +76,23 @@ C--*********************************************************************
         CALL SET_MPI(ICOMM,MYPID,MPIERR) ! SETS ICOMM AND MYPID
 
 C       SEE IF WANT TO KEEP LOWER CASE INPUT UNALTERED
-        GETANS    = .TRUE.
         UPPER     = (IRTFLG .NE. -999)
 
+C       KLUDGE TO ACCEPT <CR> IN SUBROUTINE DISP BUT NOT TO UPPERCASE 
+        IF (IRTFLG .EQ. 654321) THEN
+           UPPER = .FALSE.  ! BUT RETAIN IRTFLG FOR RDPR USE
+
+        ELSE IF (IRTFLG .EQ. -999) THEN
+           UPPER  = .FALSE.
+           IRTFLG = 0
+
+        ELSE
+           UPPER  = .TRUE.
+           IRTFLG = 0
+        ENDIF
+
+        GETANS    = .TRUE.
+
 C       WANT TO SUBSTITUTE FOR VARIABLES NOW?
         WANTSUB   = .TRUE. 
         IF ((FCHAR(1:2) == 'FR' .AND. NALPH <= 2) .OR.
@@ -87,8 +104,6 @@ C       WANT TO SUBSTITUTE FOR VARIABLES NOW?
         SAYANS    = .FALSE.
         ENDATSEMI = .TRUE.
 
-        IRTFLG = 0
-
 C       MOVE BLANKS TO THE ANSWER STRING, NECESSARY FOR SOME SPIDER CODE
         LENA = LEN(ANS)
         ANS(1:LENA) = ' '
@@ -103,7 +118,7 @@ C       COMMENT IN FIRST COL. AND READ ANOTHER INPUT LINE
 C          IF NULL ANSWER STRING, MUST RETURN ZERO LENGTH ANSWER
            IF (MYPID <= 0) THEN
               WRITE(NOUT,*) ' '
-	      IF (NLOG .NE. 0) THEN
+              IF (NLOG .NE. 0) THEN
                  WRITE(NLOG,*) ' '
                  NECHO = NECHO + 1
               ENDIF
@@ -116,7 +131,7 @@ C       SET RETURNED ANSWER, TRUNCATE TO FIT LENGTH OF ANS IN CALL
         IF (NCHAR > 0)   ANS(1:NCHAR) = ANST(1:NCHAR)
 
         NLET = NCHAR
-	IF (.NOT. SILENT .AND. MYPID <= 0) THEN
+        IF (.NOT. SILENT .AND. MYPID <= 0) THEN
            IF (NCHAR > 0) THEN
 C             CONVERT [_x**] BACK TO X** FOR ECHO
               CALL DEBRAKXREG(ANST,NLET)
@@ -137,4 +152,4 @@ C             CONVERT [_x**] BACK TO X** FOR ECHO
 
         IF (ANS(1:1) == '^' .AND. NCHAR == 1) IRTFLG = -1
 
-	END
+        END
diff --git src/rdprop.f src/rdprop.f
index 10ecab26..d4f94747 100644
--- src/rdprop.f
+++ src/rdprop.f
@@ -10,14 +10,16 @@ C              @*** VAR INIT BUG                  NOV 2009 ARDEAN LEITH
 C              NECHO                              SEP 2012 ARDEAN LEITH
 C              ! COMMENT BUG                      DEC 2013 ARDEAN LEITH
 C              NO LOAD [] FOR @ LINE              MAY 2014 ARDEAN LEITH
-C              REG_GET_SEL aCESSES GLOBAL BUG     APR 2015 ARDEAN LEITH
+C              REG_GET_SEL ACESSES GLOBAL BUG     APR 2015 ARDEAN LEITH
+C              ANS(IGOBRAK:IGOBRAK) LONGTERM BUG  APR 2025 ARDEAN LEITH
+C
 C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2015  Health Research Inc.,                         *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@wadsworth.org                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -214,28 +216,43 @@ C        MUST COPY INPUT LINE TO CURRENT INTERACTIVE DO-LOOP FILE
          WRITE(LUNDONOW,*) ANS(1:NCHAR)
          NDOLINE = NDOLINE + 1
          !write(6,*) ' rdprop lundo: ',ANS(:NCHAR),':',NDOLINE !!!!
+
       ELSEIF ((COPT == 'I' .AND. NDOLINE > 0)) THEN
          NDOLINE = NDOLINE + 1
          !write(6,*) ' rdprop ndoline: ',ANS(:NCHAR),':',NDOLINE !!!!
       ENDIF
 
 C     CONVERT OLD @b01[..] ARG. FORMAT TO TO NEW: () ARG.  FORMAT
+      !write(3,*) ' In rdprop; nq12:  ', nq12
+      !write(3,*) ' In rdprop; nchar: ', nchar
+      !write(3,*) ' In rdprop; ans(:nchar): ', ans(:nchar)
+
       IPAT   = INDEX(ANS(1:NCHAR), '@') 
-      IQUO   = SCAN(ANS(1:NCHAR), NQ12) 
+      IQUO   = SCAN( ANS(1:NCHAR), NQ12) 
+      !write(3,*) ' rdprop ipat,iqo: ', ipat,iquo
+
       IF (IPAT == 1 .AND. IQUO == 0) THEN
-         IGOBRAK  = SCAN(ANS(1:NCHAR), '([')         ! ( first is ok
-         IF (IGOBRAK > IPAT .AND. ANS(IGOBRAK:IGOBRAK) == '[')THEN
-C           PROBABLY USES OLD @b01[] PROC. ARG. FORMAT 
-            IENDBRAK = INDEX(ANS(1:NCHAR), ']',.TRUE.)
-            CALL GETNEXTTOKEN2(ANS(IGOBRAK:IENDBRAK),1,IGO,IEND)
-            INOT = VERIFY(ANS(IGOBRAK+IGO-1:IEND+IGOBRAK-1), 
-     &                    '[xX0123456789]')
-            IF (INOT == 0) THEN
-C              PROBABLY  @b01[x11...,], [[var]...
-               ANS(IGOBRAK:IGOBRAK)   = '(' 
-               ANS(IENDBRAK:IENDBRAK) = ')'
-            ENDIF
+         IGOBRAK = SCAN(ANS(1:NCHAR), '([')         ! ( first is ok
+
+         !write(3,*) ' In rdprop; igobrak,ipat: ', igobrak,ipat
+         IF (IGOBRAK > 0 ) THEN 
+           !write(3,*) ' In rdprop; ans(igobrak:igobrak):',
+           !&                       ans(igobrak:igobrak)
+
+           IF (IGOBRAK > IPAT .AND. ANS(IGOBRAK:IGOBRAK) == '[')THEN
+C             PROBABLY USES OLD @b01[] PROC. ARG. FORMAT 
+              IENDBRAK = INDEX(ANS(1:NCHAR), ']',.TRUE.)
+              CALL GETNEXTTOKEN2(ANS(IGOBRAK:IENDBRAK),1,IGO,IEND)
+              INOT = VERIFY(ANS(IGOBRAK+IGO-1:IEND+IGOBRAK-1), 
+     &                      '[xX0123456789]')
+              IF (INOT == 0) THEN
+C                PROBABLY  @b01[x11...,], [[var]...
+                 ANS(IGOBRAK:IGOBRAK)   = '(' 
+                 ANS(IENDBRAK:IENDBRAK) = ')'
+              ENDIF
+           ENDIF
          ENDIF
+
       ENDIF
             
 C     SEE IF NEED TO CONVERT OLD x11 REGISTER FORMAT TO [_11]
diff --git src/redlin.f src/redlin.f
index a204781e..197f4c2f 100644
--- src/redlin.f
+++ src/redlin.f
@@ -1,21 +1,23 @@
 
 C++*********************************************************************
-C   REDLIN.F     USED IOSTAT                    12/8/1997 ArDean Leith
-C                F90 CHANGES                    4/7/1998  ArDean Leith
-C                ENDEDNESS                      FEB 2003  ArDean Leith
-C                MPI CHANGES                    OCT 2008  ArDean Leith
-C                REDLIN_SEL                     NOV 2011  ArDean Leith
-C                MRC SUPPORT                    MAY 2019  ArDean Leith
-C                MORE MRC SUPPORT               DEC 2019  ArDean Leith
-C                REDLIN_SEL HANDLES MRC NOW     JUN 2020  ArDean Leith
-C
+C   REDLIN.F   USED IOSTAT                      12/8/1997 ArDean Leith
+C              F90 CHANGES                      4/7/1998  ArDean Leith
+C              ENDEDNESS                        FEB 2003  ArDean Leith
+C              MPI CHANGES                      OCT 2008  ArDean Leith
+C              REDLIN_SEL                       NOV 2011  ArDean Leith
+C              MRC SUPPORT                      MAY 2019  ArDean Leith
+C              MORE MRC SUPPORT                 DEC 2019  ArDean Leith
+C              REDLIN_SEL HANDLES MRC NOW       JUN 2020  ArDean Leith
+C              FIXED MRC MRCTYP NAME CONFUSION  SEP 2025  ArDean Leith
+C              ADD DEBUG OUTPUT                 OCT 2025  ArDean Leith
+C                
 C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2020  Health Research Inc.,                         *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@health.ny.gov                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -58,7 +60,8 @@ C         3   16    INTEGERS  (COMPLEX) FFT    NOT SUPPORTED
 C         4   32    REALS     (COMPLEX) FFT    NOT SUPPORTED      
 C         6   16    INTEGER*2 (UNSIGNED)        -2
 C
-C-**********************************************************************
+C23456789 123456789 123456789 123456789 123456789 123456789 123456789 12
+C--*********************************************************************
 
       SUBROUTINE REDLIN(LUNT,BUF,NB,IREC)
 
@@ -87,7 +90,7 @@ C     INCLUSION FOR OPTIONAL MPI INITIALIZATION.
       INTEGER         :: MYPID = -1
 #include "MPI_INIT.INC"
 
-      IF (ISINLINE(LUNT)) THEN
+      IF (ISINLINE(LUNT))  THEN
 C        USE INLINED BUFFER FOR I/O (SEE OPENINLN.F)
          CALL INLN_REDLIN(LUNT,BUF,NB,IREC)
          RETURN
@@ -96,29 +99,67 @@ C        USE INLINED BUFFER FOR I/O (SEE OPENINLN.F)
 C     FOR LUN EQUIVALENT INPUT == OUTPUT
       LUN = LUNARB(LUNT)
 
-      IF (LUNMRCPOS(LUN) == 0) THEN
+
+#undef SP_DBUGIO
+
+c#if defined(SP_DBUGIO)
+c       if (irec < 2) then
+c         write(3,'(A,5i10)')'  In redlin; lun,lunt,lunmrcpos(lun):',
+c     &                                    lun,lunt,lunmrcpos(lun)  
+c         write(3,'(A,5i6)') '  In redlin; lun,lunflip(lun):',
+c     &                                    lun,lunflip(lun) 
+c         write(3,'(A,5i6)') '  In redlin; nb,irec: ', nb,irec 
+c       endif
+c#endif
+
+      IF (LUNMRCPOS(LUN) == 0) THEN  ! -------- For SPIDER input ------
 
 C       DIRECT ACCESS SPIDER FILE
 C       ADD LUNARA(LUN) (FOR LABEL REC) AND LUNSTK (FOR STACK OFFSET)
 C       TO IREC TO GET THE CORRECT RECORD NUMBER
+
         I = IREC + LUNARA(LUN) + LUNSTK(LUNT)
 
-C       USING IOSTAT; IERR IS SET TO ZERO ON EACH SUCCESSFUL READ. DEC 97 al
+C       USING IOSTAT; IERR ISZEROED ON EACH SUCCESSFUL READ. DEC 97 al
 C       IF USING MPI .AND. ONLYONE_RED IS .FALSE. IT ALWAYS READS
 C       OTHERWISE, USING MPI, READS ONLY ON PROCESSOR MYPID = 0 
 
         IF (MYPID <= 0) READ(LUN,REC=I,IOSTAT=IERR) BUF
 
-      ELSE
+#if defined(SP_DBUGIO)
+        if (irec < 2) then
+          write(3,'(A,5i6)')'  In redlin; lun,nb,i: ',lun,nb,i
+        endif
+#endif
+ 
+
+      ELSE ! --------------------- For MRC input ---------------
 
 C        DIRECT ACCESS MRC FILE
          CALL REDLIN_MRC(LUN,BUF,NB,IREC, MYPID,IERR)
 
-      ENDIF
 
+      ENDIF  ! ------------------ For SPIDER & MRC input ------------
+          
       IF (LUNFLIP(LUN) == 1) THEN
 C        FLIP INPUT BYTES IN BUF ARRAY
-         CALL FLIPBYTESI(BUF,NB,IRTFLG)
+
+#if defined(SP_DBUGIO)
+         if (irec < 2 ) then
+         write(3,'(A,5f16.2)')'  In redlin before flip; buf(1),buf(5):',
+     &                                                  buf(1),buf(5) 
+      endif
+#endif
+
+         CALL FLIPBYTESI(BUF,NB,IRTFLG) 
+
+#if defined(SP_DBUGIO)
+         if (irec < 2 ) then
+         write(3,'(A,5f16.2)')'  In redlin  after flip; buf(1),buf(5):',
+     &                                                  buf(1),buf(5) 
+         endif
+#endif
+ 
       ENDIF
 
 #ifdef USE_MPI
@@ -145,25 +186,26 @@ C     PURPOSE:  READ STREAM ACCESS MRC IMAGE/VOLUME FILE INTO BUF
       REAL            :: BUF(NB)
       INTEGER         :: MYPID,IERR
 
-      INTEGER *8      :: LUNMRCPOS
+      INTEGER *8      :: LUNMRCPOS 
       INTEGER         :: LUNMRCNBYT
       COMMON /LUNMRC/    LUNMRCPOS(100),LUNMRCNBYT(100)
+
       INTEGER         :: LUNARA,LUNSTK,LUNARB,LUNFLIP
       COMMON /LUNARA/   LUNARA(100),LUNSTK(100),LUNARB(100),LUNFLIP(100)
 
-      INTEGER *1      :: I1BUF(NBUFSIZ)
-      INTEGER *2      :: I2BUF(NBUFSIZ)
+      INTEGER *1, SAVE :: I1BUF(NBUFSIZ)
+      INTEGER *2, SAVE :: I2BUF(NBUFSIZ)
 
-      INTEGER         :: NBYT_PER_VAL,NBYT_PER_REC,MRCTYP,NX
-      INTEGER *8      :: IPOSMRC
+      INTEGER          :: NBYT_PER_VAL,NBYT_PER_REC,NX
+
+      INTEGER *8       :: IPOSMRC
 
 C     LUNARA SIGN DENOTES IMAGE ORIGIN
       NX = ABS(LUNARA(LUN))
 
 C     DIFFERENT MRC MODES DIFFER IN DATA LENGTHS
-      MRCTYP       = LUNMRCNBYT(LUN)   
-      NBYT_PER_VAL = ABS(MRCTYP)
-      NBYT_PER_REC = NBYT_PER_VAL * NX
+      NBYT_PER_VAL     = ABS(LUNMRCNBYT(LUN))
+      NBYT_PER_REC     = NBYT_PER_VAL * NX
 
 C     FILE POSITION TO BEGIN READING DEPENDS ON IREC
 
@@ -180,6 +222,24 @@ C        ORIGIN IS UPPER LEFT
          RETURN
       ENDIF
 
+#if defined(SP_DBUGIO)       
+      if (irec < 2 .or. irec .eq. 224) then
+
+        write(3,'(A,5i6)')'  In redlin_mrc; nb,irec:',
+     &                                      nb,irec
+
+        write(3,'(A,5i6)')'  In redlin_mrc; lun,lunara(lun),nx:',
+     &                                      lun,lunara(lun),nx
+
+
+       write(3,'(A,5i6)')'  In redlin_mrc; nbyt_per_val,nbyt_per_rec:',
+     &                                      nbyt_per_val,nbyt_per_rec 
+
+        write(3,'(A,5i10)')'  In redlin_mrc; lunmrcpos(lun),iposmrc:',
+     &                                       lunmrcpos(lun),iposmrc 
+      endif
+#endif
+
 C     READ STREAM ACCESS MRC IMAGE/VOLUME FILE
 
       IF (NBYT_PER_VAL == 4) THEN
@@ -202,24 +262,17 @@ C        MRC FILE CONTAINS 8 BIT INTEGER*1 VALUES
          BUF(1:NB) = I1BUF(1:NB)        ! SPIDER NEEDS REALS
  
       ENDIF
+
+#if defined(SP_DBUGIO)
+      if (irec < 2) then
+        write(3,'(A,i5,3f10.3)')'  In redlin_mrc; irec,buf(1),buf(5):',
+     &                                            irec,buf(1),buf(5) 
+      endif
+#endif
    
       END
 
 
-c      if (irec==1) write(3,'(A,2X,3i9)')
-c     &            '  In redlin, lunflip(lun):',lunflip(lun)
-c      if (irec==1) write(3,'(A,2X,5i9)')
-c     &            '  In redlin, irec,lunmrcpos(),iposmrc:',
-c     &                          irec,lunmrcpos(lun),iposmrc
-c      if (irec==2) write(6,*)' irec,mrctyp,nbyt_per_val,nbyt_per_rec:'
-c     &                        ,irec,mrctyp,nbyt_per_val,nbyt_per_rec,nx
-c      if (irec==1) write(6,*)' irec,lunmrcpos,ipos: ',
-c     &                         irec,lunmrcpos(lun),iposmrc
-c     if (irec==1) write(3,'(A,2X,i9,f8.1)')
-c     &            '  In redlin, i1buf,buf:',i1buf(1),buf(1)
-
-
-
 C     ----------------------------- REDLIN1P  ------------------------
 
 C     SHOULD REPLACE THIS WITH: REDLIN_SEL!!!
@@ -283,6 +336,7 @@ C     USE INLINE BUFFER COMMON AREA
 
 C     INCLUSION FOR OPTIONAL MPI INITIALIZATION.  
       INTEGER    :: MYPID = -1
+
 #include "MPI_INIT.INC"
 
 C     USE REDLIN FOR BOTH SPIDER AND MRC FILES
diff --git src/rfactsd2.f src/rfactsd2.f
index c35b99d7..4a04d803 100644
--- src/rfactsd2.f
+++ src/rfactsd2.f
@@ -19,7 +19,6 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2016  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -351,7 +350,7 @@ C           WRITE GNUPLOT FILE OUTPUT
 
             DO  L=1,INC
                IF (LR(L) .NE. 0) THEN
-                  WRITE(LUNGP,195) ,L,RVAL(L),FSCVAL(L)
+                  WRITE(LUNGP,195) L,RVAL(L),FSCVAL(L)
 195               FORMAT(' ',I5,'  ',F7.2,' ',F10.3)
                ENDIF
            ENDDO
diff --git src/sethedccp4.f src/sethedccp4.f
index f4dab334..b3c3e41d 100644
--- src/sethedccp4.f
+++ src/sethedccp4.f
@@ -16,7 +16,7 @@ C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
 C=* Copyright 1985-2018  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@wadsworth.org                                        *
+C=* Email: spider@health.ny.gov                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -263,244 +263,6 @@ C          WRITE OUT HEADER INFORMATION
 #endif
 
 
-
-
-C ******************************** SETHEDCCP4 *****************************
-
-
-        SUBROUTINE SETHEDCCP4(HEADBUF, NX, NY, NZ,
-     &                        DMIN,DMAX,DMEAN,DSIG, 
-     &                        SCALEX,SCALEY,SCALEZ, IMODE,
-     &                        ISSWABT,NSYMBYT,NIMG,MZ,IRTFLG)
-
-        IMPLICIT NONE
-
-        INCLUDE 'CMBLOCK.INC'
-
-        REAL               :: HEADBUF(*)
-        INTEGER            :: NX,NY,NZ, IMODE
-        REAL               :: DMIN,DMAX,DMEAN,DSIG,SCALE
-        LOGICAL            :: ISSWABT
-        INTEGER            :: NSYMBYT,NIMG,MZ,IRTFLG
-
-        INTEGER            :: ISTARTX,ISTARTY,ISTARTZ,NOT_USED
-        INTEGER            :: MX,MY,IVERSION,MACHST,ISPG,NZMRC 
-        REAL               :: SCALEX,SCALEY,SCALEZ
-        REAL               :: ORIGX,ORIGY,ORIGZ
-        INTEGER            :: NLABEL,I,INOW
-        CHARACTER(LEN=44)  :: LABEL1 
-        CHARACTER(LEN=4)   :: CVAL
-        CHARACTER(LEN=1)   :: BLANK = CHAR(32)
-
-c       NOTE: COPY IMAGE DATA IN REAL*4 FORMAT. 
-        
-        CALL CCPMVI(HEADBUF(1),NX,1)
-        CALL CCPMVI(HEADBUF(2),NY,1)
-C       NZ = MZ * NUMBER OF VOLUMES
-        CALL CCPMVI(HEADBUF(3),NZ,1)
-
-C       COPY IMAGE DATA IN REAL*4 FORMAT.       
-        CALL CCPMVI(HEADBUF(4),IMODE,1)
-
-C       SET START POINTS ON COLUMNS, ROWS, SECTIONS
-
-        WRITE(NOUT,*)' '
-        IF (NZ > 1) THEN
-C          VOLUME
-           WRITE(NOUT,*)' STARTING (X,Y,Z) DEFAULT VALUE: (-(NX/2)+ 1,',
-     &                 ' -(NY/2)+1), -(NZ/2)+1'
-           WRITE(NOUT,*)' (+1 ADDED ONLY IF LENGTH IS ODD) ',
-     &               ' USE <CR> FOR DEFAULT VALUE'
-                
-           ISTARTX = -(NX/2) + (MOD(NX,2))
-           ISTARTY = -(NY/2) + (MOD(NY,2))
-           ISTARTZ = -(NZ/2) + (MOD(NZ,2))
- 
-           CALL RDPRI3S(ISTARTX,ISTARTY,ISTARTZ,NOT_USED,
-     &                 'STARTING X, Y, & Z FOR MRC DATA',IRTFLG)
-
-        ELSE
-C          IMAGE
-           ISTARTZ = -(NZ/2) + (MOD(NZ,2))
-           WRITE(NOUT,*)' STARTING (X & Y) DEFAULT VALUE: (-(NX/2)+ 1,',
-     &                  ' -(NY/2)+1)'
-           WRITE(NOUT,*)' (+1 ADDED ONLY IF LENGTH IS ODD) ',
-     &               ' USE <CR> FOR DEFAULT VALUE'
-                
-           ISTARTX = -(NX/2) + (MOD(NX,2))
-           ISTARTY = -(NY/2) + (MOD(NY,2))
-           ISTARTZ = -(NZ/2) + (MOD(NZ,2))
- 
-           CALL RDPRI2S(ISTARTX,ISTARTY,NOT_USED,
-     &                 'STARTING X & Y FOR MRC DATA',IRTFLG)
-        ENDIF
-
-        CALL CCPMVI(HEADBUF(5),ISTARTX,1)
-        CALL CCPMVI(HEADBUF(6),ISTARTY,1)
-        CALL CCPMVI(HEADBUF(7),ISTARTZ,1)
-
-C       GRID SAMPLING ON X, Y, Z (MX..) SAME AS NX, NY, NZ
-        MX = NX
-        MY = NY
-C       FOR EM, NUMBER OF SECTIONS ALONG Z IN A VOLUME STACK
-C       SO: MZ = NZ / NUMBER OF VOLUMES 
-
-        IF (NZ == 1 .AND. NIMG == 1) THEN
-C          IMAGE
-           ISPG  = 0    
-           MZ    = 1
-           NZMRC = 1            
-        ELSEIF (NZ == 1 .AND. NIMG > 1 ) THEN
-C          IMAGE STACK
-           ISPG  = 0    
-           MZ    = NIMG
-           NZMRC = NIMG        ! NUMBER OF IMAGES 
-        ELSEIF (NZ > 1 .AND. NIMG == 1 ) THEN
-C          VOLUME
-           ISPG  = 1    
-           MZ    = NZ
-           NZMRC = NZ          ! NUMBER OF VOLUMES 
-        ELSEIF (NZ > 1 .AND. NIMG > 1 ) THEN
-C          STACK OF EM VOLUMES
-           ISPG  = 401    
-           MZ    = NZ * NIMG
-           NZMRC = NZ          ! NUMBER OF VOLUMES
-        ELSE 
-           CALL ERRT(102,'BAD STACK OR VOLUME PARAMETERS',NIMG)
-           IRTFLG = 1
-           RETURN
-        ENDIF
-
-
-        CALL CCPMVI(HEADBUF(8), NX,1)
-        CALL CCPMVI(HEADBUF(9), NY,1)
-        CALL CCPMVI(HEADBUF(10),NZMRC,1)
-
-C       CELL AXES (CELLAX..) 
-        IF (SCALEX > 0) THEN
-           WRITE(NOUT,*) ' ANGSTROMS/PIXEL FOR ALL AXES (HEADER ',
-     &                   ' LOCATION=21): ',SCALEX
-        ELSE
-           SCALEX = 1.0
-           SCALEY = 1.0
-           SCALEZ = 1.0
-        ENDIF
-
-        IF (NZ > 1) THEN
-           CALL RDPRM3S(SCALEX,SCALEY,SCALEZ,NOT_USED,
-     &              'ANGSTROMS/PIXEL FOR  X, Y, & Z AXIS',IRTFLG)
-        ELSE
-           CALL RDPRM2S(SCALEX,SCALEY,NOT_USED,
-     &              'ANGSTROMS/PIXEL FOR  X &  Y AXES',IRTFLG)
-        ENDIF
-        IF (IRTFLG .NE. 0) RETURN
-
-        HEADBUF(11) = SCALEX * NX
-        HEADBUF(12) = SCALEY * NY
-        HEADBUF(13) = SCALEZ * NZ
-
-C       CELL ANGLES (CELLBX..) 
-        HEADBUF(14) = 90.0
-        HEADBUF(15) = 90.0
-        HEADBUF(16) = 90.0
-
-C       FAST, MEDIUM, SLOW AXES 
-        CALL CCPMVI(HEADBUF(17),1,1)
-        CALL CCPMVI(HEADBUF(18),2,1)
-        CALL CCPMVI(HEADBUF(19),3,1)
- 
-C       MIN, MAX. & MEAN DENSITY 
-        HEADBUF(20) = DMIN
-        HEADBUF(21) = DMAX
-        HEADBUF(22) = DMEAN
-
-C       SPACE GROUP, # BYTES SYMMETRY 
-        CALL CCPMVI(HEADBUF(23), ISPG,  1)
-        CALL CCPMVI(HEADBUF(24), NSYMBYT,1)
-
-C       ZERO THE EXTRA POSITIONS
-        DO I = 25,49
-           CALL CCPMVI(HEADBUF(I), 0,1)
-        ENDDO
-
-C       PUT IN 'MRCO'
-        CVAL = 'MRCO'
-        CALL CCPMVC(HEADBUF(27),CVAL,ISSWABT)
-
-C       VERSION NUMBER 
-        IVERSION = 20140
-        CALL CCPMVI(HEADBUF(28), IVERSION,1)
-
-C       ORIGIN ON X,Y & Z AXIS 
-        ORIGX = (NX/2) + (MOD(NX,2))
-        ORIGY = (NY/2) + (MOD(NY,2))
-        ORIGZ = (NZ/2) + (MOD(NZ,2))
-
-        WRITE(NOUT,*)' '
-        IF (NZ < 2) THEN
-          WRITE(NOUT,*)' ORIGIN (X,Y) DEFAULT VALUE:((NX/2)+ 1, ',
-     &                 '(NY/2)+1)'
-          WRITE(NOUT,*)'   (+1 ADDED ONLY IF AXIS LENGTH IS ODD)',
-     &                 ' USE <CR> FOR DEFAULT VALUE'
-          CALL RDPRM2S(ORIGX,ORIGY,NOT_USED,
-     &               'X, & Y ORIGIN FOR MRC DATA',IRTFLG)
-        ELSE 
-          WRITE(NOUT,*)' ORIGIN (X,Y,Z) DEFAULT VALUE:((NX/2)+ 1, ',
-     &                 '(NY/2)+1), (NZ/2)+1'
-          WRITE(NOUT,*)'   (+1 ADDED ONLY IF AXIS LENGTH IS ODD)',
-     &                 ' USE <CR> FOR DEFAULT VALUE'
-          CALL RDPRM3S(ORIGX,ORIGY,ORIGZ,NOT_USED,
-     &               'X, Y, & Z ORIGIN FOR MRC DATA',IRTFLG)
-        ENDIF
-        IF (IRTFLG .NE. 0) RETURN
-                
-        HEADBUF(50) = ORIGX
-        HEADBUF(51) = ORIGY
-        HEADBUF(52) = ORIGZ
-
-C       PUT IN 'MAP'
-        CVAL = 'MAP '
-        CALL CCPMVC(HEADBUF(53),CVAL,ISSWABT)
-
-C       SET MACHINE STAMP
-C       MACHST = 286326784    ! FOR BIG ENDIAN DATA
-C       MACHST = 4369         ! FOR LITTLE ENDIAN DATA
-        MACHST = 16708        ! FOR LITTLE ENDIAN DATA
-        CALL CCPMVI(HEADBUF(54),MACHST,1)
- 
-c        write(nout,*) ' map:',cval,headbuf(53)
-c        write(nout,*) ' machst:',machst,headbuf(54)
-
-C       SET RMS (ASSUMING THIS DEFINE SAME AS SIG IN SPIDER??)
-        HEADBUF(55) = DSIG
-
-C       SET NUMBER OF LABELS
-        NLABEL = 1  
-        CALL CCPMVI(HEADBUF(56), NLABEL,1)
-
-C       ZERO ALL LABELS WITH BLANKS
-        CVAL = BLANK // BLANK // BLANK // BLANK
-        DO I = 57,256
-           CALL CCPMVC(HEADBUF(I),CVAL,ISSWABT)
-        ENDDO
-
-C       NOW GO BACK AND ADD IN ONE LABEL
-        LABEL1 = 'Converted from SPIDER to MRC using SPIDER '
-        INOW   = 56
-        DO I = 1,44,4
-           CVAL = LABEL1(I:I+3)
-           INOW = INOW + 1
-           CALL CCPMVC(HEADBUF(INOW),CVAL,ISSWABT)
-        ENDDO
-        
-        IRTFLG = 0
-
-        END
-
-
-
-
-
 C ------------------------- CCPMVC --------------------------
 
 C     PURPOSE:     PACK 4 CHAR INTO A INTEGER OR FLOAT
@@ -528,3 +290,20 @@ C     REVERSE      FLAG TO INVERT STRING                       SENT
 
       END
 
+
+C ------------------------ CCPMVI -------------------------------
+
+      SUBROUTINE CCPMVI (ARR1,ARR2,NUM)
+
+C     PURPOSE:  ASSIGNS THE FIRST NUM WORDS OF ARR2 TO ARR1
+
+      INTEGER  :: NUM
+      REAL     :: ARR1(*),ARR2(*)
+      INTEGER  :: J
+
+      DO J=1,NUM
+         ARR1(J) = ARR2(J)
+      ENDDO
+
+      END
+ 
diff --git src/setval.f src/setval.f
index 04dc76a3..4ab73515 100644
--- src/setval.f
+++ src/setval.f
@@ -249,7 +249,8 @@ C         OUTPUT FILE MUST EXIST, IT IS NOT CREATED HERE.
           CALL LUNGETIS_MRC(LUN2,IS_MRC2,IRTFLG)
           IF (IRTFLG .NE. 0) GOTO 9000
 
-          IF (IS_MRC .NE. IS_MRC2) THEN
+C          IF (IS_MRC .NE. IS_MRC2) THEN !gfort error,  Sept 2025 al
+          IF (IS_MRC .NEQV. IS_MRC2) THEN 
              CALL ERRT(101,'INPUT/OUTPUT MUST BE SAME MRC/SPIDER',IDUM)
              IRTFLG =1
              GOTO 9000
diff --git src/spider.f src/spider.f
index 05a20641..6a7d85f0 100644
--- src/spider.f
+++ src/spider.f
@@ -7,10 +7,10 @@ C                                                                      *
 C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
-C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2020  Health Research Inc.,                         *
+C=* SPIDER System Authors:  Joachim Frank, ArDean Leith & Tapu Shaikh  *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@health.ny.gov                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -75,11 +75,12 @@ C       COMMON BLOCK SPACE RESERVATION USED AT ALBANY, IS NOW ONLY 5 MB.
 C       (MOST ROUTINES NOW USE RUN-TIME ALLOCATION OF MEMORY WHICH 
 C       IS INDEPENDENT OF THE COMMON BLOCK AND MAXDI ASSIGNMENT.
 C       WE USUALLY HAVE > 2 GB RAM AVAILABLE ON ALBANY MACHINES
- 
+C       NAME MAX_UNLABELED_COM IS MORE EASILY SEARCHABLE IN SOURCE FILES
+        INTEGER, PARAMETER  :: MAX_UNLABELED_COM = 5000000
         INTEGER, PARAMETER  :: MAXDI = 5000000
-        INTEGER             :: PLINEGO(MAXDI/5)
-        CHARACTER           :: PDATA(4*4*MAXDI/5)
-        COMMON                 PLINEGO,PDATA
+        INTEGER             :: PLINEGO(MAXDI/5)   ! 1  million ints
+        CHARACTER           :: PDATA(4*4*MAXDI/5) ! 16 million char
+        COMMON                 PLINEGO,PDATA      ! 20 million bytes
 
 C       @@@@@@@@@@@@@@@@@@@  DECLARATIONS @@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 
@@ -159,7 +160,7 @@ C       @@@@@@@@@@@@@@@@@@@@@@@@@@ DATA STATEMENTS @@@@@@@@@@@@@@@@@@@@
 C       @@@@@@@@@@@@@@@@@@@@@@ VERSION INITIALIZATION @@@@@@@@@@@@@@@@@
 
 CHERE               123456789 123456789 123456789 1234567890 
-        DATA CVERS/'VERSION:  UNIX 26.06  ISSUED:  6/30/2020'/
+        DATA CVERS/'VERSION:  UNIX 27.00  ISSUED:  9/26/2025'/
 
         DATA RESULM/'results'/
         DATA LOGM/'LOG'/
@@ -175,7 +176,7 @@ C       SOME DO LOOP PARAMETERS
 
 C       @@@@@@@@@@@@@@@@@@@@@@@@@@@  CODE @@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 
-        IN_PARALLEL = .FALSE.
+        IN_PARALLEL = .FALSE.DEF
         ONLYONE_RED = .TRUE.
         ONLYONE_WRT = .TRUE.
 
@@ -192,22 +193,15 @@ C       NOT USING MPI
         MYPID = -1
 #endif
 
-#ifdef SP_MP
-C       NEEDED BY PGI 2013.10 COMPILER
 
-#ifndef USE_MPI
-#ifndef __APPLE__
-#if defined(SP_IFC) || defined(__INTEL_COMPILER)
-        isiz1 = kmp_get_stacksize()
-        CALL kmp_set_stacksize(65536)
-        isiz2 = kmp_get_stacksize()
-#else
-	isiz1 = omp_get_stack_size()
-	CALL omp_set_stack_size(65536)
-	isiz2 = omp_get_stack_size()
-#endif
-        !write(6,*) ' OMP Stack size: ',isiz1,' -->',isiz2
-#endif
+#ifdef SP_MP
+#ifdef SP_GFORTRAN
+c         isize = omp_get_stack_size()
+c        WRITE(6,*) ' Number of threads -----: ', isize
+c        WRITE(3,*) ' Number of threads -----: ', isize
+c
+c        call omp_set_stack_size(65536)
+c        CALL kmp_set_stacksize(65536)
 #endif
 #endif
 
@@ -239,27 +233,27 @@ C       INITIALIZE SOME COMMON BLOCK DATA ELEMENTS (SEE: setmode.f)
         LEGACYPAR      = .FALSE. ! () IN DO NO LONGER! DEC 2010
         USE_FBS_INTERP = .FALSE. ! NEW JUL 2011
         NECHO          = 0       ! COUNTER FOR LOG FILE OUTPUT
-        MAXDIM         = MAXDI   ! SET SIZE OF COMMON BUFFER
         NUMFFTWTH      = 0       ! NUMBER OF FFTW3 THREADS
         NULL           = CHAR(0)
         NQ12           = CHAR(34) // CHAR(39)   ! QUOTES
         MRC_AXIS       = 'UL L'
+        MAXDIM         = MAX_UNLABELED_COM  ! SET SIZE OF COMMON BUFFER
 
-C       SET ISEED  TO INITIAL "RANDOM" VALUE USING CLOCK
 #if defined (SP_GFORTRAN)  || defined(__GFORTRAN__)
-        CALL RANDOM_SEED(SIZE = N)
-        ALLOCATE(ISEED(N))
-        CALL SYSTEM_CLOCK(COUNT = ICLOCK)
-        ISEED = ICLOCK + 37 * (/ (I - 1, I = 1, N) /)
-        CALL RANDOM_SEED(PUT = ISEED)
-        DEALLOCATE(ISEED)
+         CALL RANDOM_SEED()
+C        ALLOCATE(ISEED(N))
+C        CALL SYSTEM_CLOCK(COUNT = ICLOCK)
+C        ISEED = ICLOCK + 37 * (/ (I - 1, I = 1, N) /)
+C        CALL RANDOM_SEED(PUT = ISEED)
+C        DEALLOCATE(ISEED)
 #else
+C       SET ISEED  TO INITIAL "RANDOM" VALUE USING CLOCK
         CALL DATE_AND_TIME(VALUES=ITIME)       ! GET CURRENT TIME
         ISEED(1) = ITIME(4) * (360000*ITIME(5) + 6000*ITIME(6) + 
      &             100*ITIME(7) + ITIME(8))
         IF (ISEED(1) == 0 .AND. ISEED(2) == 0) THEN
 C          KLUDGE TO PREVENT ERROR ON SOME INTEL PROCESSORS
-           write(0,*) ' Using default random number seed'
+           WRITE(0,*) ' Using default random number seed'
            CALL RANDOM_SEED()
         ELSE
            CALL RANDOM_SEED(PUT = ISEED)
@@ -358,7 +352,7 @@ C           PRINT OUT HEADING WITH VERSION AND RELEASE DATES
 C          GET THE PROJECT AND DATA EXTENSION FROM USER
            NLOG       = 0
            FCHAR(1:3) = 'NC' // CHAR(0)
-           CALL DRIV1(MAXDIM)
+           CALL DRIV1(MAX_UNLABELED_COM)
            NLOG       = NLOGP
         ENDIF
 
@@ -555,7 +549,7 @@ C       RESET FFTW3 CACHE
         CALL FMRS_DEPLAN(IRTFLG)
 
 C       TSWITCH IS MAIN SELECTION PROGRAM FOR OPERATIONS OUTSIDE MAIN
-        CALL TSWITCH(IWHICH,ICOM,MAXDIM,IRTFLG)
+        CALL TSWITCH(IWHICH,ICOM,MAX_UNLABELED_COM,IRTFLG)
  
 C       IF OPERATION FOUND OUTSIDE OF SPIDER MAIN, GET NEXT OPERATION
         IF (IRTFLG == 0) GOTO 5000
diff --git src/star2doc.f src/star2doc.f
index 91361979..9aa93964 100644
--- src/star2doc.f
+++ src/star2doc.f
@@ -9,14 +9,14 @@ C              MAXLENVAR = 40 --> 120            OCT 2015 ARDEAN LEITH
 C              NVARSTAR BUG                      OCT 2015 ARDEAN LEITH
 C              INTEGER OVERFOW HACK              NOV 2015 ARDEAN LEITH
 C              _ NOT _rln                        SEP 2016 ARDEAN LEITH
-C                                                                 
+C              GFORT:  NONNEGATIVE STRING WIDTH  SEP 2025 ARDEAN LEITH 
+                                                               
 C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2016  Health Research Inc.,                         *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@wadsworth.org                                        *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -355,7 +355,9 @@ C           INTERPRET TOKENS AS FLOATS, PLACE IN DLIST
                CTOKEN = ADJUSTL(VARTMP(IWHICH))
                NCHAR  = lnblnkn(CTOKEN)
 
-               READ(CTOKEN(1:NCHAR),'(I)') IDLIST
+C              Gfort Error: Nonnegative width required..  al Sept 2025
+C              READ(CTOKEN(1:NCHAR),'(I)') IDLIST
+               READ(CTOKEN(1:NCHAR),'(I12)') IDLIST
                DLIST(ILOC) = IDLIST
  
                !write(6,*)' Token:',ctoken(1:nchar),i,iloc,idlist
diff --git src/tfed.f src/tfed.f
index 4dea6b33..cedadae6 100644
--- src/tfed.f
+++ src/tfed.f
@@ -4,7 +4,7 @@ C            IMPROPER PS BUG FIXED               SEP   10 ArDean Leith
 C            PROMPTS IMPROVED                    MAY   12 ArDean Leith
 C            CTF ED                              JUN   12 ArDean Leith
 C            DEF. DOC FILE COMMENTS CHANGED      APR   13 ArDean Leith
-C                                                            
+C            GETDEFOCUS VERY BUGGY                                                              
 C=**********************************************************************
 C=* From: SPIDER - MODULAR IMAGE PROCESSING SYSTEM                     *
 C=* Copyright (C)2002, Z. Huang & P. A. Penczek                        *
diff --git src/util2.f src/util2.f
index 122b3cc0..557f73eb 100644
--- src/util2.f
+++ src/util2.f
@@ -227,7 +227,8 @@ C           INPUT BACKGROUND VALUE
         GOTO 9000
 
 C       OPERATION ----------- COPY  ------------------------------ 'CP' 
-3       CALL COPY1(MAXDIM)              
+
+3       CALL COPY1              
         GOTO 9000
 
 C       OPERATION -------- INSERT -------------------------------- 'IN' 
@@ -367,7 +368,7 @@ C       OPEN SECOND INPUT FILE
      &              'TOP LEFT COORDINATES',IRTFLG)
 
         CALL PATCH(LUN1,LUN2,NSAM1,NROW1,NSLICE1, NSAM2,NROW2,
-     &             NSLICE2, NSAMS,NROWS,NSLICES, 0,0,FCHAR(4:4),
+     &             NSLICE2, NSAMS,NROWS,NSLICES, 0,0.0,FCHAR(4:4),
      &             FMIN1,FMAX1,.FALSE.)
 
 C       SET UNDETERMINED STATISTICS FLAG
diff --git src/wrtlin.f src/wrtlin.f
index 47462193..f875c651 100644
--- src/wrtlin.f
+++ src/wrtlin.f
@@ -1,18 +1,21 @@
 
 C++*********************************************************************
-C   WRTLIN.F             IOSTAT ADDED              DEC 97 ArDean Leith
-C                        FILE NAME FOR ERROR       SEP 02 ArDean Leith
-C                        ENDEDNESS                 FEB 03 ArDean Leith
-C                        ONLYONE_WRT               NOV 08 ArDean Leith
-C                        MRC SUPPORT               JUL 19 ArDean Leith
-C                        MORE MRC SUPPORT          DEC 19 ArDean Leith
+C   WRTLIN.F      IOSTAT ADDED                  DEC 1997  ArDean Leith
+C                 FILE NAME FOR ERROR           SEP 2002  ArDean Leith
+C                 ENDEDNESS                     FEB 2003  ArDean Leith
+C                 ONLYONE_WRT                   NOV 2008  ArDean Leith
+C                 MRC SUPPORT                   JUL 2019  ArDean Leith
+C                 MORE MRC SUPPORT              DEC 2019  ArDean Leith
+C                 FIXED MRC NBYT_PER_VAL BUG    SEP 2025  ArDean Leith
+C                 MRC I1BUF UNSAFE IN THREADS   SEP 2025  ArDean Leith
+C
 C **********************************************************************
 C=*                                                                    *
 C=* This file is part of:   SPIDER - Modular Image Processing System.  *
 C=* SPIDER System Authors:  Joachim Frank & ArDean Leith               *
-C=* Copyright 1985-2019  Health Research Inc.,                         *
+C=* Copyright 1985-2025  Health Research Inc.,                         *
 C=* Riverview Center, 150 Broadway, Suite 560, Menands, NY 12204.      *
-C=* Email: spider@health.ny.gov                                        *
+C=* Email:                                                             *
 C=*                                                                    *
 C=* SPIDER is free software; you can redistribute it and/or            *
 C=* modify it under the terms of the GNU General Public License as     *
@@ -57,7 +60,7 @@ C--*********************************************************************
       END MODULE WRTLIN_PIPE_STUFF
 
 
-C     ---------------------- WRTLIN -------------------------------------
+C     ---------------------- WRTLIN ------------------------------------
 
       SUBROUTINE WRTLIN(LUNT,BUF,NB,IREC)
 
@@ -73,6 +76,7 @@ C     USE INLINE BUFFER COMMON AREA
 
       INTEGER         :: IERR,LUNC,NIN,NOUT,NECHO,IFOUND,NPROC,NDAT
       INTEGER         :: LUNARA,LUNSTK,LUNARB,LUNFLIP
+
       COMMON /IOERR/  IERR
       COMMON /UNITS/  LUNC,NIN,NOUT,NECHO,IFOUND,NPROC,NDAT
       COMMON /LUNARA/ LUNARA(100),LUNSTK(100),LUNARB(100),LUNFLIP(100)
@@ -114,6 +118,13 @@ C       TO IREC TO GET THE CORRECT RECORD NUMBER
 
         IERR = 0
         IF (MYPID <= 0) THEN
+
+#if defined (SP_DBUG)
+        if (i < 2) then
+          write(3,*)' In wrtlin; lun,lunflip(lun),nb,i:  ', 
+     &                           lun,lunflip(lun),nb,i 
+        endif
+#endif
            IF (LUNFLIP(LUN) == 0) THEN
               WRITE(LUN,REC=I,IOSTAT=IERR) BUF
            ELSE
@@ -154,7 +165,7 @@ C     PURPOSE:  WRITE BUF TO STREAM ACCESS MRC IMAGE/VOLUME FILE
 
       IMPLICIT NONE
 
-      INCLUDE 'CMLIMIT.INC'   ! NEED: NBUFSIZ
+      INCLUDE 'CMLIMIT.INC'   ! NEED: NBUFSIZ  =  45000
 
       INTEGER         :: LUN,NB,IREC
       REAL            :: BUF(NB)
@@ -163,23 +174,23 @@ C     PURPOSE:  WRITE BUF TO STREAM ACCESS MRC IMAGE/VOLUME FILE
       INTEGER *8      :: LUNMRCPOS
       INTEGER         :: LUNMRCNBYT
       COMMON /LUNMRC/    LUNMRCPOS(100),LUNMRCNBYT(100)
+
       INTEGER         :: LUNARA,LUNSTK,LUNARB,LUNFLIP
       COMMON /LUNARA/   LUNARA(100),LUNSTK(100),LUNARB(100),LUNFLIP(100)
 
-      INTEGER *1      :: I1BUF(NBUFSIZ)
-      INTEGER *2      :: I2BUF(NBUFSIZ)
+      INTEGER *1, SAVE :: I1BUF(NBUFSIZ)
+      INTEGER *2, SAVE :: I2BUF(NBUFSIZ)
 
-      INTEGER         :: I,IX,IRTFLG
-      INTEGER         :: NBYT_PER_VAL,NBYT_PER_REC,MRCMODE,NX,NE
-      INTEGER *8      :: IPOSMRC
+      INTEGER          :: I,IX,IRTFLG
+      INTEGER          :: NBYT_PER_VAL,NBYT_PER_REC,NX,NE
+      INTEGER *8       :: IPOSMRC
 
 C     LUNARA CARRIES NX (PIXELS IN X)
       NX = ABS(LUNARA(LUN))
 
 C     DIFFERENT MRC MODES DIFFER IN DATA LENGTHS
-      MRCMODE      = LUNMRCNBYT(LUN)   
-      NBYT_PER_VAL = ABS(MRCMODE)
-      NBYT_PER_REC = NBYT_PER_VAL * NX
+      NBYT_PER_VAL     = ABS(LUNMRCNBYT(LUN))
+      NBYT_PER_REC     = NBYT_PER_VAL * NX
 
 C     FILE POSITION TO BEGIN WRITING DEPENDS ON IREC AND ORIGIN
 
@@ -205,13 +216,13 @@ C        MRC FILE NEEDS 32 BIT REAL VALUES
 C        MRC FILE NEEDS  16 BIT, INTEGER*2 VALUES        
 
          I2BUF(1:NB) = BUF(1:NB)   
-         IF (MYPID <= 0) WRITE(LUN, POS=IPOSMRC,IOSTAT=IERR) I2BUF(1:NB)
+         IF (MYPID <= 0) WRITE(LUN,POS=IPOSMRC,IOSTAT=IERR) I2BUF(1:NB)
 
       ELSEIF (NBYT_PER_VAL == 1) THEN         
 C        MRC FILE NEEDS   8 BIT INTEGER*1 VALUES 
 
          I1BUF(1:NB) = BUF(1:NB)   
-         IF (MYPID <= 0) WRITE(LUN,POS=IPOSMRC,IOSTAT=IERR)I1BUF(1:NB)
+         IF (MYPID <= 0) WRITE(LUN,POS=IPOSMRC,IOSTAT=IERR) I1BUF(1:NB)
  
       ENDIF
 
